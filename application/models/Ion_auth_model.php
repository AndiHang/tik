<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\105\120\x41\124\x48") or exit("\x4e\157\40\x64\x69\162\x65\x63\x74\x20\x73\143\x72\151\160\164\40\141\143\143\x65\x73\x73\40\x61\x6c\x6c\157\167\145\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto fEYEh; CAy18: $this->load->helper("\x63\157\157\153\151\145"); goto x9szS; c380M: $this->message_start_delimiter = $this->error_start_delimiter; goto sDT2k; wMA6Q: $this->message_end_delimiter = $this->error_end_delimiter; goto qJL2q; FxaQ0: CBn1U: goto ph3ca; gdc0f: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto c380M; M1eag: $this->message_start_delimiter = $this->config->item("\x6d\x65\163\x73\141\x67\x65\137\x73\164\x61\x72\x74\x5f\x64\x65\x6c\x69\x6d\x69\x74\145\x72", "\151\157\x6e\137\141\165\x74\150"); goto bf_do; fEYEh: $this->config->load("\x69\x6f\156\x5f\141\165\164\150", TRUE); goto CAy18; EwNKl: $error_prefix = $form_validation_class->getProperty("\x5f\145\162\x72\157\162\137\160\x72\x65\146\151\x78"); goto LHeCu; BnQ0g: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto wMA6Q; weiq_: $group_name = $this->config->item("\x64\x61\164\141\142\141\163\145\x5f\147\x72\x6f\x75\160\x5f\156\x61\x6d\145", "\x69\x6f\x6e\x5f\x61\165\x74\150"); goto Wr27I; bf_do: $this->message_end_delimiter = $this->config->item("\x6d\x65\x73\x73\141\x67\145\x5f\x65\x6e\144\137\x64\145\154\x69\155\151\x74\x65\x72", "\x69\x6f\156\x5f\141\x75\164\150"); goto n0x8Y; tjYu4: $error_suffix->setAccessible(TRUE); goto BnQ0g; n0x8Y: $this->error_start_delimiter = $this->config->item("\x65\162\162\157\162\x5f\163\x74\141\x72\x74\137\144\145\x6c\x69\155\151\164\145\162", "\151\x6f\x6e\x5f\141\165\x74\150"); goto xROlN; RRhHL: $this->load->library("\146\x6f\162\x6d\137\x76\x61\154\x69\x64\x61\164\x69\157\156"); goto n2h_5; ITBhF: $this->errors = []; goto Dh8zT; LHeCu: $error_prefix->setAccessible(TRUE); goto gdc0f; rSo4Y: $this->db = $CI->db; goto i6iD6; FAbXw: $this->db = $this->load->database($group_name, TRUE, TRUE); goto Qnqay; s7ZYo: $this->tables = $this->config->item("\x74\x61\x62\x6c\145\x73", "\151\x6f\x6e\x5f\141\165\x74\x68"); goto VYXEf; Qnqay: goto UKozg; goto FxaQ0; Wr27I: if (empty($group_name)) { goto CBn1U; } goto FAbXw; UXq4R: I9MzF: goto RRhHL; xROlN: $this->error_end_delimiter = $this->config->item("\145\162\162\157\162\137\145\x6e\x64\137\x64\145\154\151\x6d\x69\164\145\x72", "\x69\x6f\156\137\x61\165\164\150"); goto P79l3; x9szS: $this->load->helper("\144\x61\x74\145"); goto EsFCN; n2h_5: $form_validation_class = new ReflectionClass("\x43\111\137\x46\x6f\x72\155\137\x76\x61\154\151\144\141\164\151\x6f\x6e"); goto EwNKl; qJL2q: pBTzT: goto Gv5NM; sDT2k: $error_suffix = $form_validation_class->getProperty("\137\x65\162\x72\x6f\162\x5f\163\x75\146\146\x69\x78"); goto tjYu4; BIkB7: $this->messages = []; goto ITBhF; VWh9K: $this->join = $this->config->item("\152\157\x69\156", "\151\157\156\x5f\141\165\164\x68"); goto i7Ip7; P79l3: goto pBTzT; goto UXq4R; t8UgR: $this->trigger_events("\x6d\157\144\x65\154\x5f\143\157\x6e\163\x74\x72\x75\143\x74\x6f\x72"); goto y1jrC; ph3ca: $CI =& get_instance(); goto rSo4Y; i6iD6: UKozg: goto s7ZYo; Dh8zT: $delimiters_source = $this->config->item("\x64\x65\x6c\x69\155\x69\164\145\x72\x73\x5f\x73\x6f\165\x72\143\145", "\x69\x6f\x6e\137\141\165\164\x68"); goto fMghX; i7Ip7: $this->hash_method = $this->config->item("\x68\x61\163\x68\137\155\x65\164\150\x6f\144", "\x69\x6f\156\137\x61\x75\x74\150"); goto BIkB7; VYXEf: $this->identity_column = $this->config->item("\151\x64\145\156\x74\151\164\x79", "\151\x6f\156\x5f\141\165\164\150"); goto VWh9K; Gv5NM: $this->_ion_hooks = new stdClass(); goto t8UgR; fMghX: if ($delimiters_source === "\146\157\x72\155\137\166\141\x6c\x69\144\x61\164\151\x6f\156") { goto I9MzF; } goto M1eag; EsFCN: $this->lang->load("\x69\157\x6e\x5f\x61\165\164\x68"); goto weiq_; y1jrC: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto C_6rq; ekIrW: $algo = $this->_get_hash_algo(); goto Vg0hu; XGfjK: return password_hash($password, $algo, $params); goto gvcXh; Vg0hu: $params = $this->_get_hash_parameters($identity); goto fw_KR; gvcXh: EvADj: goto koFA6; afc2N: ASQVv: goto ekIrW; Rnhdh: return FALSE; goto afc2N; koFA6: return FALSE; goto NnrJf; C_6rq: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto ASQVv; } goto Rnhdh; fw_KR: if (!($algo !== FALSE && $params !== FALSE)) { goto EvADj; } goto XGfjK; NnrJf: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto NLL6v; NAqmN: OSGns: goto V7JCv; VimKy: goto OSGns; goto I5sw_; CXvE8: h_Wjk: goto oCboP; I5sw_: ysjv3: goto hRE0M; oy0hr: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto VimKy; hRE0M: return password_verify($password, $hash_password_db); goto NAqmN; DQYxS: return FALSE; goto CXvE8; NLL6v: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto h_Wjk; } goto DQYxS; oCboP: if (strpos($hash_password_db, "\x24") === 0) { goto ysjv3; } goto oy0hr; V7JCv: } public function rehash_password_if_needed($hash, $identity, $password) { goto VpDSV; D94Dq: if ($this->_set_password_db($identity, $password)) { goto lDr9c; } goto mqlmm; NjiIu: if (!password_needs_rehash($hash, $algo, $params)) { goto DLgMJ; } goto D94Dq; SoNJv: if (!($algo !== FALSE && $params !== FALSE)) { goto h47VA; } goto NjiIu; IfoKY: $this->trigger_events(["\x72\x65\x68\x61\x73\150\137\160\141\163\x73\x77\157\162\144", "\x72\x65\x68\141\x73\150\x5f\x70\x61\x73\163\x77\157\x72\144\x5f\163\165\x63\143\x65\163\x73\146\165\x6c"]); goto StIxt; bg_PK: $params = $this->_get_hash_parameters($identity); goto SoNJv; StIxt: yzRlH: goto XsMCn; VpDSV: $algo = $this->_get_hash_algo(); goto bg_PK; ZbU1J: goto yzRlH; goto QbLal; XsMCn: DLgMJ: goto WcsQ8; mqlmm: $this->trigger_events(["\162\x65\x68\x61\x73\x68\137\x70\141\x73\163\167\157\x72\x64", "\x72\145\150\141\163\150\x5f\x70\x61\163\x73\167\x6f\x72\x64\137\x75\x6e\x73\165\x63\143\145\x73\x73\x66\x75\x6c"]); goto ZbU1J; WcsQ8: h47VA: goto lpKo3; QbLal: lDr9c: goto IfoKY; lpKo3: } public function get_user_by_activation_code($user_code) { goto jMLRr; jMLRr: $token = $this->_retrieve_selector_validator_couple($user_code); goto DLlmf; Pk6Qu: VzxOD: goto pCD0o; PQtah: MeJj2: goto Pk6Qu; qmo8e: return $user; goto PQtah; XVQpq: if (!$user) { goto VzxOD; } goto qEMpX; DLlmf: $user = $this->where("\141\143\164\x69\x76\141\164\151\157\156\137\163\145\154\x65\x63\x74\157\x72", $token->selector)->users()->row(); goto XVQpq; pCD0o: return FALSE; goto SumE5; qEMpX: if (!$this->verify_password($token->validator, $user->activation_code)) { goto MeJj2; } goto qmo8e; SumE5: } public function activate($id, $code = FALSE) { goto E0oDB; bklYc: if (!($code === FALSE || $user && $user->id === $id)) { goto xmgqI; } goto E_w8v; E0oDB: $this->trigger_events("\160\x72\x65\137\x61\x63\x74\x69\x76\141\x74\145"); goto R_oA0; oj8Ik: DaPrP: goto QlGhL; zw2b1: if (!($this->db->affected_rows() === 1)) { goto DaPrP; } goto s7yg4; ap45u: $user = $this->get_user_by_activation_code($code); goto bkAB1; s7yg4: $this->trigger_events(["\160\157\x73\x74\137\x61\143\164\151\166\141\x74\x65", "\160\x6f\x73\x74\137\141\x63\x74\151\x76\x61\164\145\x5f\x73\x75\143\143\x65\x73\163\x66\x75\x6c"]); goto Uzt99; QlGhL: xmgqI: goto Qmw5D; mOWh1: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, ["\151\x64" => $id]); goto zw2b1; Uzt99: $this->set_message("\x61\143\x74\151\166\141\164\x65\x5f\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c"); goto acDk6; bkAB1: hGPkm: goto bklYc; Qmw5D: $this->trigger_events(["\x70\157\x73\x74\x5f\x61\x63\164\x69\166\x61\164\145", "\x70\157\163\x74\x5f\x61\143\x74\x69\166\x61\x74\145\x5f\x75\x6e\163\x75\143\143\145\x73\163\146\x75\154"]); goto hSGh1; E_w8v: $data = ["\x61\143\x74\151\166\x61\164\151\157\x6e\137\163\145\154\145\x63\x74\157\x72" => NULL, "\141\x63\x74\151\166\141\164\151\x6f\156\137\x63\x6f\x64\145" => NULL, "\x61\143\x74\x69\x76\x65" => 1]; goto AZIgn; R_oA0: if (!($code !== FALSE)) { goto hGPkm; } goto ap45u; hSGh1: $this->set_error("\141\143\164\151\166\x61\x74\145\x5f\x75\156\163\165\143\143\145\x73\163\146\x75\154"); goto Q3hNx; acDk6: return TRUE; goto oj8Ik; Q3hNx: return FALSE; goto eKVzo; AZIgn: $this->trigger_events("\x65\x78\x74\x72\141\x5f\x77\150\145\162\x65"); goto mOWh1; eKVzo: } public function deactivate($id = NULL) { goto h22x4; pS39r: $return = $this->db->affected_rows() == 1; goto E4qRC; SUMzV: liGDN: goto qUYph; UtKKe: $this->db->update($this->tables["\165\163\145\x72\163"], $data, ["\x69\x64" => $id]); goto pS39r; svF3W: o4YF9: goto qOXgp; UggTn: return FALSE; goto SUMzV; lmfvS: $data = ["\141\143\x74\151\x76\x61\x74\x69\x6f\x6e\137\x73\x65\154\x65\143\164\157\162" => $token->selector, "\x61\x63\164\151\x76\x61\164\151\157\x6e\137\143\x6f\144\145" => $token->validator_hashed, "\x61\x63\x74\151\166\145" => 0]; goto iCP5Z; qOXgp: return $return; goto wM4uj; BTUot: er4QT: goto kUwBK; LN13O: if (!isset($id)) { goto Xky6R; } goto B_BGt; wRSnX: Xky6R: goto skWZQ; WFsfC: goto o4YF9; goto BTUot; iCP5Z: $this->trigger_events("\x65\x78\164\162\141\x5f\167\150\x65\162\x65"); goto UtKKe; h22x4: $this->trigger_events("\144\145\x61\x63\x74\x69\x76\141\164\x65"); goto LN13O; qUYph: goto MNp3w; goto wRSnX; skWZQ: $this->set_error("\144\145\x61\143\164\151\x76\141\164\145\x5f\x75\156\163\165\x63\143\145\163\163\x66\165\154"); goto lwS2J; GWDDi: MNp3w: goto BnxMU; cmM6k: $this->activation_code = $token->user_code; goto lmfvS; BnxMU: $token = $this->_generate_selector_validator_couple(20, 40); goto cmM6k; E4qRC: if ($return) { goto er4QT; } goto pPb3j; lwS2J: return FALSE; goto GWDDi; B_BGt: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto liGDN; } goto YFD4d; pPb3j: $this->set_error("\144\x65\141\x63\164\151\166\141\x74\x65\x5f\x75\156\x73\165\143\143\x65\x73\x73\146\165\154"); goto WFsfC; YFD4d: $this->set_error("\144\145\141\143\164\x69\166\x61\x74\145\137\x63\x75\162\162\x65\x6e\x74\137\x75\x73\x65\x72\137\165\x6e\x73\165\x63\143\x65\163\163\x66\165\154"); goto UggTn; kUwBK: $this->set_message("\144\x65\141\143\164\x69\x76\141\164\x65\x5f\x73\165\143\x63\145\x73\x73\146\x75\x6c"); goto svF3W; wM4uj: } public function clear_forgotten_password_code($identity) { goto vTPSf; Y_ZBe: return FALSE; goto S6DUJ; vTPSf: if (!empty($identity)) { goto MAEkG; } goto Y_ZBe; BJLMK: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, [$this->identity_column => $identity]); goto e6EQw; S6DUJ: MAEkG: goto VIxS5; VIxS5: $data = ["\x66\x6f\162\x67\157\164\x74\145\156\137\160\x61\163\x73\167\x6f\x72\144\x5f\x73\145\154\145\x63\164\x6f\x72" => NULL, "\x66\157\x72\147\157\164\164\145\156\x5f\160\x61\x73\x73\x77\x6f\162\x64\x5f\143\157\144\x65" => NULL, "\x66\x6f\162\x67\x6f\164\x74\x65\x6e\137\160\141\x73\x73\167\157\x72\x64\x5f\164\x69\x6d\x65" => NULL]; goto BJLMK; e6EQw: return TRUE; goto DpTNf; DpTNf: } public function clear_remember_code($identity) { goto XDBUA; a2wlX: $data = ["\x72\x65\155\145\155\x62\x65\x72\x5f\x73\x65\x6c\x65\143\x74\x6f\162" => NULL, "\x72\145\x6d\x65\x6d\142\x65\162\137\x63\157\144\x65" => NULL]; goto V8Grx; XDBUA: if (!empty($identity)) { goto Giw_k; } goto jkTER; DGs0y: return TRUE; goto XpCzJ; mKbVo: Giw_k: goto a2wlX; V8Grx: $this->db->update($this->tables["\165\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto DGs0y; jkTER: return FALSE; goto mKbVo; XpCzJ: } public function reset_password($identity, $new) { goto oVCd_; KjETc: $this->trigger_events(["\160\157\x73\x74\137\143\x68\x61\x6e\x67\x65\137\160\x61\x73\x73\x77\x6f\x72\144", "\160\157\x73\164\137\x63\x68\141\156\x67\x65\137\160\141\163\163\167\157\x72\x64\137\x75\156\163\x75\x63\143\x65\x73\163\146\165\154"]); goto mkYBd; w3Unn: return $return; goto qFudC; LKiYN: $this->trigger_events(["\160\157\163\x74\x5f\143\x68\x61\x6e\147\x65\x5f\x70\141\163\163\167\157\162\x64", "\160\157\x73\x74\137\143\150\x61\x6e\x67\145\x5f\160\x61\163\163\x77\x6f\x72\x64\x5f\x75\156\x73\165\x63\x63\145\x73\163\146\x75\154"]); goto RkPAW; Ka_UF: goto C5W2k; goto BqZnF; So1my: $this->set_message("\160\141\x73\x73\167\x6f\162\x64\x5f\x63\x68\141\x6e\x67\145\137\x73\165\143\x63\145\x73\x73\x66\x75\154"); goto Eem0J; mkYBd: $this->set_error("\160\141\x73\x73\x77\x6f\162\x64\x5f\143\150\x61\x6e\147\145\x5f\165\156\x73\x75\143\x63\145\x73\163\146\x75\154"); goto Ka_UF; BqZnF: SpLcy: goto fuYE0; ipV4u: Io_05: goto cjMJf; Eem0J: C5W2k: goto w3Unn; cjMJf: $return = $this->_set_password_db($identity, $new); goto hCSB5; RkPAW: return FALSE; goto ipV4u; w9332: if ($this->identity_check($identity)) { goto Io_05; } goto LKiYN; hCSB5: if ($return) { goto SpLcy; } goto KjETc; oVCd_: $this->trigger_events("\160\x72\145\x5f\x63\150\141\156\x67\x65\x5f\160\141\x73\163\x77\157\162\x64"); goto w9332; fuYE0: $this->trigger_events(["\160\157\163\x74\137\143\150\141\x6e\x67\145\137\x70\141\x73\163\167\157\x72\x64", "\160\x6f\x73\164\137\143\150\141\156\147\x65\x5f\x70\x61\x73\163\x77\157\x72\x64\x5f\163\165\143\x63\145\163\163\146\165\154"]); goto So1my; qFudC: } public function change_password($identity, $old, $new) { goto xJBlk; BcYCL: if (!($query->num_rows() !== 1)) { goto Vgp2h; } goto s2cwa; m8nBD: if (!$this->verify_password($old, $user->password, $identity)) { goto ddYg2; } goto oVQN_; Mqpbs: $this->trigger_events(["\160\157\163\x74\137\x63\150\x61\156\147\x65\137\160\x61\x73\163\x77\x6f\162\144", "\160\x6f\x73\x74\137\143\150\x61\156\x67\x65\137\x70\141\163\163\x77\x6f\x72\144\x5f\163\x75\x63\143\145\163\163\146\165\154"]); goto VCH7h; hzLhi: return FALSE; goto BgMv3; DY6qx: return FALSE; goto Kf3I4; F0FBj: goto XPi5X; goto QbIqR; T8j50: if ($result) { goto aDryo; } goto UmETg; uGyJR: XPi5X: goto K5ZZ9; BgMv3: Vgp2h: goto Ty3Jh; Ty3Jh: $user = $query->row(); goto m8nBD; Dceyc: ddYg2: goto SsN3H; mmjbf: $query = $this->db->select("\151\144\x2c\x20\160\141\x73\x73\x77\157\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\145\163\x63")->get($this->tables["\x75\x73\x65\162\x73"]); goto BcYCL; yKkRM: $this->trigger_events("\x65\170\164\x72\x61\137\x77\x68\x65\162\x65"); goto mmjbf; UnK8h: $this->set_error("\160\x61\x73\163\x77\157\x72\x64\137\143\150\x61\x6e\x67\145\137\165\156\163\165\143\143\145\163\x73\x66\x75\x6c"); goto hzLhi; xJBlk: $this->trigger_events("\x70\162\x65\137\x63\x68\141\156\147\x65\137\x70\141\x73\x73\167\x6f\x72\144"); goto yKkRM; oVQN_: $result = $this->_set_password_db($identity, $new); goto T8j50; K5ZZ9: return $result; goto Dceyc; QbIqR: aDryo: goto Mqpbs; s2cwa: $this->trigger_events(["\160\157\x73\164\x5f\143\150\141\x6e\x67\x65\137\160\x61\163\x73\x77\x6f\162\x64", "\160\157\163\x74\137\x63\x68\141\x6e\147\x65\137\160\141\x73\163\167\x6f\x72\x64\x5f\165\x6e\163\x75\143\143\x65\163\163\146\x75\x6c"]); goto UnK8h; XRrAv: $this->set_error("\x70\x61\163\x73\167\157\x72\144\x5f\x63\150\141\156\x67\145\137\x75\x6e\163\165\x63\143\x65\x73\x73\x66\x75\154"); goto F0FBj; UmETg: $this->trigger_events(["\160\157\163\x74\x5f\143\x68\x61\156\147\x65\137\160\141\x73\x73\167\157\x72\144", "\x70\x6f\163\164\x5f\143\x68\141\156\147\145\x5f\x70\x61\x73\163\167\157\x72\x64\137\165\156\163\165\x63\x63\x65\x73\x73\x66\165\x6c"]); goto XRrAv; SsN3H: $this->set_error("\x70\x61\x73\163\x77\157\162\144\137\x63\x68\141\x6e\x67\145\x5f\165\x6e\x73\165\143\x63\x65\163\163\146\165\x6c"); goto DY6qx; VCH7h: $this->set_message("\x70\x61\x73\163\x77\157\162\144\x5f\x63\150\141\x6e\147\x65\x5f\x73\x75\143\x63\x65\x73\x73\146\x75\154"); goto uGyJR; Kf3I4: } public function username_check($username = '') { goto Y1jDh; p1VEJ: A0fef: goto vZkRa; Y1jDh: $this->trigger_events("\x75\x73\145\x72\156\x61\x6d\145\137\143\150\145\x63\x6b"); goto HR5Rt; j71Bj: return $this->db->where("\x75\163\x65\162\x6e\141\155\x65", $username)->limit(1)->count_all_results($this->tables["\x75\x73\x65\x72\x73"]) > 0; goto V0aJp; vZkRa: $this->trigger_events("\145\170\164\162\141\x5f\x77\150\145\x72\x65"); goto j71Bj; k4gzy: return FALSE; goto p1VEJ; HR5Rt: if (!empty($username)) { goto A0fef; } goto k4gzy; V0aJp: } public function email_check($email = '') { goto Dlo24; NT9u_: return FALSE; goto KXvS7; kzu0B: return $this->db->where("\145\x6d\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\165\163\x65\162\163"]) > 0; goto AlUYz; Br9lI: if (!empty($email)) { goto IkvDl; } goto NT9u_; KXvS7: IkvDl: goto VONOT; VONOT: $this->trigger_events("\x65\x78\x74\162\x61\x5f\x77\150\x65\x72\x65"); goto kzu0B; Dlo24: $this->trigger_events("\x65\155\141\151\x6c\137\143\x68\x65\x63\x6b"); goto Br9lI; AlUYz: } public function identity_check($identity = '') { goto jqH4O; oC0fI: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\162\x73"]) > 0; goto zrW68; UKL4z: return FALSE; goto FnrjB; FnrjB: eLl71: goto oC0fI; jqH4O: $this->trigger_events("\151\x64\x65\x6e\164\151\164\x79\x5f\x63\150\145\x63\x6b"); goto trXsM; trXsM: if (!empty($identity)) { goto eLl71; } goto UKL4z; zrW68: } public function get_user_id_from_identity($identity = '') { goto xVZYD; jGoPw: return $user->id; goto BrqZZ; kpyVt: M0mOs: goto pPMZ0; pfmxZ: return FALSE; goto kpyVt; bm1u8: return FALSE; goto Y4gDR; pPMZ0: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\162\163"]); goto LhNrr; LhNrr: if (!($query->num_rows() !== 1)) { goto gc3xH; } goto bm1u8; Y4gDR: gc3xH: goto qOCtT; xVZYD: if (!empty($identity)) { goto M0mOs; } goto pfmxZ; qOCtT: $user = $query->row(); goto jGoPw; BrqZZ: } public function forgotten_password($identity) { goto xXkTi; UJcN4: return FALSE; goto TCIUt; ThWVo: $this->trigger_events(["\160\157\163\x74\137\146\x6f\x72\x67\x6f\164\x74\145\156\137\x70\141\163\x73\167\x6f\x72\144", "\x70\157\163\x74\x5f\x66\157\162\x67\x6f\x74\164\x65\x6e\137\160\141\163\163\x77\157\162\x64\137\163\165\x63\x63\145\163\163\146\x75\154"]); goto PAthh; WAIHO: USgmZ: goto URVE0; ZMmvx: $this->db->update($this->tables["\165\163\145\162\163"], $update, [$this->identity_column => $identity]); goto d5God; d5God: if ($this->db->affected_rows() === 1) { goto MUO17; } goto h0CQ8; xXkTi: if (!empty($identity)) { goto Td2ZR; } goto StZaX; kDGDj: $this->trigger_events("\x65\170\164\162\141\137\x77\x68\145\x72\x65"); goto ZMmvx; PAthh: return $token->user_code; goto WAIHO; StZaX: $this->trigger_events(["\x70\157\163\164\137\x66\x6f\162\147\157\x74\x74\x65\156\137\x70\141\163\x73\167\157\x72\144", "\160\157\x73\164\137\146\x6f\x72\x67\x6f\x74\164\145\x6e\137\160\x61\x73\x73\167\x6f\162\x64\x5f\x75\x6e\163\x75\143\x63\x65\x73\x73\x66\165\154"]); goto gntD9; Uz8P0: MUO17: goto ThWVo; TCIUt: goto USgmZ; goto Uz8P0; h0CQ8: $this->trigger_events(["\x70\x6f\163\x74\137\x66\157\x72\x67\157\164\x74\x65\156\137\160\x61\163\163\x77\x6f\162\x64", "\160\157\x73\164\137\146\157\162\147\157\x74\164\x65\156\x5f\x70\x61\x73\163\167\157\162\144\137\x75\x6e\x73\165\143\143\x65\x73\163\146\165\154"]); goto UJcN4; gntD9: return FALSE; goto EKFTc; UqIe1: $update = ["\146\x6f\162\147\157\x74\x74\145\x6e\137\160\141\x73\x73\167\x6f\x72\x64\137\x73\x65\x6c\x65\x63\x74\x6f\162" => $token->selector, "\x66\157\x72\x67\157\164\164\145\156\x5f\160\141\x73\163\x77\x6f\162\144\137\143\157\x64\145" => $token->validator_hashed, "\x66\x6f\x72\x67\157\164\164\145\x6e\x5f\160\141\163\163\167\x6f\x72\x64\x5f\x74\151\x6d\145" => time()]; goto kDGDj; EKFTc: Td2ZR: goto kOShN; kOShN: $token = $this->_generate_selector_validator_couple(20, 80); goto UqIe1; URVE0: } public function get_user_by_forgotten_password_code($user_code) { goto cAJiE; MmhOT: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto klC5o; } goto l3bEc; uih1Q: klC5o: goto z15h2; l3bEc: return $user; goto uih1Q; b59G9: if (!$user) { goto vHeyj; } goto MmhOT; cAJiE: $token = $this->_retrieve_selector_validator_couple($user_code); goto jiY_i; j593v: return FALSE; goto CLXgC; z15h2: vHeyj: goto j593v; jiY_i: $user = $this->where("\x66\157\x72\x67\157\x74\164\145\156\x5f\x70\x61\x73\163\167\157\162\x64\x5f\163\x65\154\145\x63\x74\157\x72", $token->selector)->users()->row(); goto b59G9; CLXgC: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto fDNlI; hCQDV: $query = $this->db->get_where($this->tables["\147\162\x6f\165\x70\x73"], ["\156\x61\155\145" => $this->config->item("\x64\145\146\x61\x75\x6c\164\137\x67\x72\x6f\165\x70", "\x69\x6f\x6e\137\141\x75\164\150")], 1)->row(); goto ShYFG; iS238: $this->set_error("\141\143\143\157\165\156\164\x5f\143\162\x65\x61\x74\151\157\x6e\137\155\151\163\x73\151\156\147\137\x64\x65\x66\x61\x75\x6c\x74\x5f\147\162\x6f\165\x70"); goto JNc3x; fDNlI: $this->trigger_events("\x70\x72\x65\x5f\x72\145\x67\151\163\164\x65\x72"); goto Rcu9g; Q8B5r: $id = $this->db->insert_id($this->tables["\165\163\145\162\163"] . "\x5f\x69\x64\137\x73\145\161"); goto EZAXB; fyRGb: $data = [$this->identity_column => $identity, "\x75\163\145\x72\156\141\x6d\145" => $identity, "\160\x61\x73\163\x77\x6f\162\x64" => $password, "\x65\155\x61\151\154" => $email, "\151\160\x5f\141\x64\x64\x72\145\x73\163" => $ip_address, "\143\x72\145\x61\164\x65\x64\137\157\156" => time(), "\141\x63\164\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto DGbZ5; iXP_l: uqkID: goto orQFc; ShYFG: if (!(!isset($query->id) && empty($groups))) { goto uqkID; } goto bXglF; D3Fom: Uijb9: goto U9VVu; uX8qy: $this->trigger_events("\160\x6f\163\x74\x5f\162\145\147\151\163\x74\145\162"); goto k4oDd; WBgUZ: if (!(!$this->config->item("\x64\x65\x66\141\165\154\164\x5f\147\x72\157\x75\x70", "\151\x6f\156\x5f\141\165\x74\150") && empty($groups))) { goto X7PNM; } goto iS238; JLX1Y: $this->db->insert($this->tables["\165\163\x65\162\163"], $user_data); goto Q8B5r; UqZr4: aqssP: goto fyRGb; k4oDd: return isset($id) ? $id : FALSE; goto WEZYr; B0kX4: syEqm: goto hCQDV; EQLYS: q5bzN: goto x1EAi; ts0vU: if (!($password === FALSE)) { goto aqssP; } goto B6bR6; EZAXB: if (!(isset($default_group->id) && empty($groups))) { goto q5bzN; } goto r66Mo; B6bR6: $this->set_error("\x61\x63\x63\x6f\x75\x6e\x74\137\x63\x72\145\x61\x74\x69\x6f\x6e\x5f\x75\156\x73\x75\143\143\x65\x73\x73\146\x75\x6c"); goto MGbIo; bXglF: $this->set_error("\x61\x63\x63\157\x75\x6e\x74\137\x63\x72\145\141\164\151\157\156\x5f\151\156\x76\x61\x6c\x69\x64\137\x64\145\146\141\165\x6c\164\137\x67\x72\x6f\x75\x70"); goto Kjv1m; fr8wD: $this->trigger_events("\145\170\x74\162\x61\137\x73\145\x74"); goto JLX1Y; DGbZ5: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\x65\x72\x73"], $additional_data), $data); goto fr8wD; dHoUb: $password = $this->hash_password($password); goto ts0vU; JNc3x: return FALSE; goto NLXV8; Vlntg: $ip_address = $this->input->ip_address(); goto dHoUb; r66Mo: $groups[] = $default_group->id; goto EQLYS; U9VVu: kfvbj: goto uX8qy; Rcu9g: $manual_activation = $this->config->item("\155\141\156\x75\x61\x6c\137\141\x63\164\x69\166\141\x74\151\x6f\x6e", "\151\157\x6e\137\x61\x75\x74\x68"); goto Kaljv; RnXZE: $this->set_error("\x61\x63\143\x6f\165\x6e\164\x5f\x63\162\x65\x61\164\151\157\156\137\x64\165\160\154\x69\x63\141\x74\145\137\151\144\145\156\164\x69\164\x79"); goto SWht4; NLXV8: X7PNM: goto fttwv; fttwv: goto syEqm; goto k3Fjq; SWht4: return FALSE; goto B0kX4; Kjv1m: return FALSE; goto iXP_l; MGbIo: return FALSE; goto UqZr4; kSM_L: foreach ($groups as $group) { $this->add_to_group($group, $id); KW3FQ: } goto D3Fom; k3Fjq: FgRv8: goto RnXZE; x1EAi: if (empty($groups)) { goto kfvbj; } goto kSM_L; Kaljv: if ($this->identity_check($identity)) { goto FgRv8; } goto WBgUZ; orQFc: $default_group = $query; goto Vlntg; WEZYr: } public function login($identity, $password, $remember = FALSE) { goto Ggn2d; RDH8b: $this->trigger_events(["\160\x6f\163\164\137\154\x6f\x67\x69\x6e", "\x70\x6f\x73\x74\137\x6c\157\x67\x69\x6e\x5f\x73\x75\143\x63\x65\163\163\146\x75\x6c"]); goto Em1fl; V0WQx: return FALSE; goto o_tKf; lFy4f: uYl08: goto CFHX0; jE4dm: if (!$this->verify_password($password, $user->password, $identity)) { goto uYl08; } goto AYhuJ; F82VO: $this->increase_login_attempts($identity); goto iAxnI; zUCNc: $this->set_error("\154\157\x67\x69\156\137\164\x69\x6d\145\x6f\165\164"); goto m6L9L; BrvRj: $user = $query->row(); goto jE4dm; o_tKf: j81Gr: goto rUozn; bXfTL: $this->set_error("\154\x6f\147\x69\156\137\x75\156\x73\x75\143\143\145\163\163\146\x75\x6c"); goto UjkVI; Wy007: $this->trigger_events("\x70\x6f\163\164\137\154\157\147\x69\156\137\x75\156\x73\x75\143\x63\x65\x73\163\x66\x75\154"); goto haPYq; C3JPL: $this->clear_forgotten_password_code($identity); goto DkYxA; FIWcr: if (!$this->is_max_login_attempts_exceeded($identity)) { goto wc_LY; } goto r0mKc; iYIXh: if ($remember) { goto Pg9hf; } goto xRXvl; PHaa5: return TRUE; goto lFy4f; haPYq: $this->set_error("\154\x6f\147\x69\x6e\137\x75\x6e\x73\165\143\x63\145\163\x73\146\x75\x6c\x5f\156\x6f\164\x5f\141\143\164\x69\166\145"); goto IEQcO; AYhuJ: if (!($user->active == 0)) { goto CJ3F3; } goto Wy007; kCZUT: $this->remember_user($identity); goto FqK4m; jfyKE: $this->set_error("\154\x6f\x67\x69\156\137\165\156\x73\165\x63\143\145\x73\x73\146\165\x6c"); goto V0WQx; xRXvl: $this->clear_remember_code($identity); goto rv4xV; xytBB: $this->update_last_login($user->id); goto rvo9Q; Em1fl: $this->set_message("\154\x6f\147\151\156\x5f\163\165\143\143\145\x73\x73\x66\x75\154"); goto PHaa5; ueJlv: Pg9hf: goto kCZUT; rUozn: $this->trigger_events("\145\170\164\162\x61\x5f\167\150\145\x72\x65"); goto QGTkD; iAxnI: $this->trigger_events("\160\157\x73\164\137\x6c\157\147\151\156\x5f\165\156\163\x75\x63\143\x65\x73\x73\146\x75\x6c"); goto bXfTL; DkYxA: if (!$this->config->item("\x72\x65\155\x65\155\142\x65\x72\137\165\x73\x65\x72\163", "\151\x6f\156\x5f\141\x75\x74\x68")) { goto eJ73h; } goto iYIXh; IEQcO: return FALSE; goto FXyEo; AgtuH: $this->hash_password($password); goto F82VO; EDs4V: $this->session->sess_regenerate(FALSE); goto RDH8b; CFHX0: qOtQh: goto AgtuH; rv4xV: goto cak6A; goto ueJlv; rrunF: wc_LY: goto qhScp; QGTkD: $query = $this->db->select($this->identity_column . "\54\40\x65\155\141\151\x6c\54\40\151\x64\x2c\40\x70\141\163\x73\167\x6f\x72\x64\54\x20\x61\x63\x74\151\166\145\x2c\x20\154\x61\x73\164\x5f\x6c\157\147\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\144\x65\x73\143")->get($this->tables["\165\x73\145\x72\163"]); goto FIWcr; FqK4m: cak6A: goto KxL9m; Ggn2d: $this->trigger_events("\x70\x72\x65\x5f\x6c\x6f\147\x69\x6e"); goto vGxQJ; s_krY: $this->trigger_events("\x70\x6f\163\164\x5f\x6c\157\147\151\x6e\137\x75\156\x73\165\x63\143\x65\x73\x73\146\x75\x6c"); goto zUCNc; w5dEy: $this->set_session($user); goto xytBB; rvo9Q: $this->clear_login_attempts($identity); goto C3JPL; KxL9m: eJ73h: goto sgCt4; vGxQJ: if (!(empty($identity) || empty($password))) { goto j81Gr; } goto jfyKE; FXyEo: CJ3F3: goto w5dEy; m6L9L: return FALSE; goto rrunF; UjkVI: return FALSE; goto k4o24; r0mKc: $this->hash_password($password); goto s_krY; sgCt4: $this->rehash_password_if_needed($user->password, $identity, $password); goto EDs4V; qhScp: if (!($query->num_rows() === 1)) { goto qOtQh; } goto BrvRj; k4o24: } public function recheck_session() { goto uqM6Y; uqM6Y: $recheck = NULL !== $this->config->item("\162\145\143\x68\145\x63\153\137\x74\x69\x6d\145\x72", "\x69\x6f\156\x5f\141\x75\x74\150") ? $this->config->item("\x72\145\x63\150\x65\143\x6b\137\x74\151\x6d\145\x72", "\x69\157\156\137\x61\x75\164\150") : 0; goto ozEr0; jWFJ0: $this->session->set_userdata("\154\141\x73\x74\137\143\x68\x65\143\153", time()); goto FUdhJ; qZL8V: BmmB5: goto vpv9L; a7lKQ: $this->session->unset_userdata([$identity, "\x69\144", "\165\163\145\x72\137\x69\x64"]); goto QFU57; c9NrC: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\144\x65\x6e\164\151\x74\x79"), "\141\x63\164\151\x76\145" => "\x31"])->limit(1)->order_by("\151\x64", "\144\x65\x73\143")->get($this->tables["\x75\163\x65\x72\x73"]); goto i4afC; uTvT7: $last_login = $this->session->userdata("\154\x61\163\x74\x5f\x63\150\x65\x63\x6b"); goto Xfmf7; WjYQC: Lh7Dw: goto qZL8V; gCn4u: $this->trigger_events("\154\x6f\147\157\165\164"); goto GZI7B; A3rlh: Ju6Yq: goto jWFJ0; Xfmf7: if (!($last_login + $recheck < time())) { goto Lh7Dw; } goto c9NrC; QFU57: return FALSE; goto L7SLd; GZI7B: $identity = $this->config->item("\151\x64\145\156\x74\151\x74\171", "\x69\x6f\x6e\x5f\x61\165\x74\150"); goto a7lKQ; i4afC: if ($query->num_rows() === 1) { goto Ju6Yq; } goto gCn4u; vpv9L: return (bool) $this->session->userdata("\151\144\x65\x6e\164\x69\164\x79"); goto smVSZ; ozEr0: if (!($recheck !== 0)) { goto BmmB5; } goto uTvT7; FUdhJ: nPCRM: goto WjYQC; L7SLd: goto nPCRM; goto A3rlh; smVSZ: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto ZRmVn; O5UsS: $attempts = $this->get_attempts_num($identity, $ip_address); goto ZDMyM; ZDMyM: return $attempts >= $max_attempts; goto G8wAK; rzZal: ByNHh: goto FzXvo; a6cVj: $max_attempts = $this->config->item("\x6d\141\x78\x69\x6d\165\155\x5f\154\x6f\x67\151\156\x5f\141\x74\164\x65\155\160\x74\163", "\x69\x6f\x6e\137\x61\x75\x74\x68"); goto nWu0V; G8wAK: stBXA: goto rzZal; nWu0V: if (!($max_attempts > 0)) { goto stBXA; } goto O5UsS; ZRmVn: if (!$this->config->item("\164\162\x61\143\x6b\x5f\x6c\x6f\x67\151\x6e\x5f\141\164\x74\145\x6d\x70\164\163", "\x69\157\156\x5f\141\x75\164\x68")) { goto ByNHh; } goto a6cVj; FzXvo: return FALSE; goto rbPxi; rbPxi: } public function get_attempts_num($identity, $ip_address = NULL) { goto miFJe; DcnEx: $this->db->where("\x69\x70\x5f\x61\144\x64\x72\x65\x73\163", $ip_address); goto GyjUo; S7xga: return $qres->num_rows(); goto EUltt; QUG5d: $this->db->where("\x74\151\x6d\x65\40\76", time() - $this->config->item("\x6c\x6f\143\153\x6f\165\x74\x5f\164\x69\x6d\145", "\151\x6f\x6e\x5f\x61\165\164\150"), FALSE); goto tjeua; xLOHT: if (!$this->config->item("\x74\162\x61\143\153\x5f\154\157\x67\151\156\137\x69\x70\x5f\x61\144\x64\x72\x65\x73\x73", "\151\157\x6e\137\x61\165\164\x68")) { goto c3o00; } goto gIfkv; GyjUo: c3o00: goto QUG5d; EUltt: Em0kq: goto f8FXp; K9e50: $ip_address = $this->input->ip_address(); goto OSLz9; nl4pO: $this->db->select("\x31", FALSE); goto N5C0U; gIfkv: if (isset($ip_address)) { goto YyUlr; } goto K9e50; miFJe: if (!$this->config->item("\x74\x72\x61\x63\153\137\154\157\147\x69\x6e\x5f\x61\164\x74\x65\x6d\x70\164\x73", "\151\x6f\x6e\x5f\141\165\x74\x68")) { goto Em0kq; } goto nl4pO; OSLz9: YyUlr: goto DcnEx; f8FXp: return 0; goto fcZYW; tjeua: $qres = $this->db->get($this->tables["\154\157\x67\x69\x6e\137\x61\164\x74\145\155\x70\x74\163"]); goto S7xga; N5C0U: $this->db->where("\154\157\x67\x69\156", $identity); goto xLOHT; fcZYW: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto uUVL3; qBrqJ: if (!$this->config->item("\164\162\x61\x63\x6b\137\154\x6f\x67\x69\156\137\151\160\x5f\x61\144\144\x72\x65\163\x73", "\151\x6f\x6e\137\x61\165\164\x68")) { goto q11sQ; } goto xx2gd; J_5Iy: $this->db->where("\x69\x70\137\x61\144\x64\162\145\x73\x73", $ip_address); goto UP0pt; Z0XTs: $qres = $this->db->get($this->tables["\154\x6f\147\x69\x6e\x5f\141\164\x74\x65\x6d\160\x74\x73"], 1); goto BBcLl; A0S_c: w5k3A: goto b3Qz8; E5HG7: $this->db->where("\154\157\x67\151\x6e", $identity); goto qBrqJ; ZwLV9: $this->db->select("\164\151\x6d\145"); goto E5HG7; y5z7N: $ip_address = $this->input->ip_address(); goto CtWqz; SR9Fb: $this->db->order_by("\151\144", "\144\x65\x73\143"); goto Z0XTs; xx2gd: if (isset($ip_address)) { goto J1Tjc; } goto y5z7N; CtWqz: J1Tjc: goto J_5Iy; UP0pt: q11sQ: goto SR9Fb; BBcLl: if (!($qres->num_rows() > 0)) { goto w5k3A; } goto g60Kn; g60Kn: return $qres->row()->time; goto A0S_c; uUVL3: if (!$this->config->item("\x74\162\x61\x63\x6b\137\154\x6f\x67\x69\156\x5f\141\164\164\145\x6d\x70\x74\163", "\151\157\x6e\x5f\x61\x75\x74\x68")) { goto tSHEO; } goto ZwLV9; b3Qz8: tSHEO: goto PMi7e; PMi7e: return 0; goto N4Mh2; N4Mh2: } public function get_last_attempt_ip($identity) { goto q1pLr; Ky1Zc: vo07R: goto EBkFf; PF11B: return $qres->row()->ip_address; goto b7_xn; rE_b9: if (!($qres->num_rows() > 0)) { goto z3QDV; } goto PF11B; b7_xn: z3QDV: goto Ky1Zc; tzamb: $this->db->select("\151\x70\x5f\141\144\x64\162\145\x73\163"); goto t_qCx; qSsyj: $qres = $this->db->get($this->tables["\x6c\157\147\x69\156\x5f\141\164\164\x65\x6d\x70\x74\x73"], 1); goto rE_b9; q1pLr: if (!($this->config->item("\x74\162\x61\x63\153\x5f\x6c\157\x67\x69\x6e\137\141\164\164\x65\x6d\x70\164\x73", "\151\x6f\156\x5f\141\x75\164\150") && $this->config->item("\164\x72\x61\143\x6b\x5f\154\157\147\151\156\137\x69\x70\x5f\141\144\x64\x72\145\163\x73", "\x69\x6f\156\x5f\x61\165\x74\x68"))) { goto vo07R; } goto tzamb; bhL_h: $this->db->order_by("\151\x64", "\144\145\163\143"); goto qSsyj; EBkFf: return ''; goto KOmnv; t_qCx: $this->db->where("\x6c\x6f\x67\x69\156", $identity); goto bhL_h; KOmnv: } public function increase_login_attempts($identity) { goto p3__K; DIFYF: $data["\151\x70\137\141\x64\x64\x72\x65\163\x73"] = $this->input->ip_address(); goto XvX94; l1DRW: return FALSE; goto wzH_x; sNeT4: VR1zW: goto l1DRW; aeKbX: $data = ["\x69\160\x5f\141\x64\x64\162\x65\163\x73" => '', "\x6c\x6f\x67\x69\156" => $identity, "\x74\x69\x6d\145" => time()]; goto ZptaL; ZptaL: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\154\x6f\x67\151\156\137\x69\160\x5f\x61\x64\x64\162\x65\x73\163", "\151\157\x6e\137\141\x75\x74\150")) { goto Lykf4; } goto DIFYF; vQ6iI: return $this->db->insert($this->tables["\x6c\157\147\151\x6e\x5f\141\x74\164\x65\155\x70\164\x73"], $data); goto sNeT4; XvX94: Lykf4: goto vQ6iI; p3__K: if (!$this->config->item("\164\162\x61\143\x6b\137\154\157\x67\151\156\x5f\x61\x74\164\145\155\160\x74\x73", "\x69\157\x6e\x5f\141\165\x74\150")) { goto VR1zW; } goto aeKbX; wzH_x: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto EXmb9; I89OT: return FALSE; goto kmZCu; lb84O: mRxB5: goto I89OT; CWDLv: rq7cO: goto JAXR5; DbzvD: $this->db->where("\x69\160\137\141\x64\144\162\x65\163\163", $ip_address); goto CWDLv; EXmb9: if (!$this->config->item("\x74\x72\x61\143\x6b\x5f\x6c\157\x67\151\x6e\137\x61\164\x74\x65\x6d\160\x74\x73", "\x69\x6f\x6e\x5f\x61\165\x74\x68")) { goto mRxB5; } goto cu571; cu571: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\x63\x6b\x6f\x75\x74\x5f\164\x69\x6d\x65", "\x69\157\x6e\137\x61\165\164\150")); goto Ivtgh; JAXR5: $this->db->or_where("\164\151\155\145\x20\x3c", time() - $old_attempts_expire_period, FALSE); goto Zoid4; Zoid4: return $this->db->delete($this->tables["\154\x6f\x67\x69\x6e\x5f\141\164\x74\x65\x6d\x70\164\163"]); goto lb84O; GC6Ev: Fk1c2: goto DbzvD; sRaqC: if (isset($ip_address)) { goto Fk1c2; } goto qcRnf; kABX0: if (!$this->config->item("\x74\162\x61\x63\153\137\154\157\147\151\156\x5f\x69\x70\x5f\x61\144\144\162\x65\x73\x73", "\151\x6f\x6e\x5f\141\165\164\150")) { goto rq7cO; } goto sRaqC; Ivtgh: $this->db->where("\154\x6f\147\x69\156", $identity); goto kABX0; qcRnf: $ip_address = $this->input->ip_address(); goto GC6Ev; kmZCu: } public function limit($limit) { goto dymAY; Soox9: return $this; goto xr4Bv; dymAY: $this->trigger_events("\x6c\x69\x6d\x69\164"); goto Jvo_3; Jvo_3: $this->_ion_limit = $limit; goto Soox9; xr4Bv: } public function offset($offset) { goto ipNtk; lmlON: return $this; goto sibND; ipNtk: $this->trigger_events("\157\x66\146\163\x65\x74"); goto OL1gW; OL1gW: $this->_ion_offset = $offset; goto lmlON; sibND: } public function where($where, $value = NULL) { goto UH1r7; tL5Br: if (is_array($where)) { goto eJnQt; } goto gqDM7; gqDM7: $where = [$where => $value]; goto OqswS; ahqAq: array_push($this->_ion_where, $where); goto IaBsb; OqswS: eJnQt: goto ahqAq; IaBsb: return $this; goto qgxUC; UH1r7: $this->trigger_events("\167\x68\145\162\x65"); goto tL5Br; qgxUC: } public function like($like, $value = NULL, $position = "\142\157\164\x68") { goto kY660; h2wsq: return $this; goto rUCYm; UYcTI: array_push($this->_ion_like, ["\x6c\x69\153\x65" => $like, "\x76\x61\154\165\145" => $value, "\x70\157\x73\x69\x74\151\157\156" => $position]); goto h2wsq; kY660: $this->trigger_events("\x6c\151\x6b\x65"); goto UYcTI; rUCYm: } public function select($select) { goto jRSJY; jRSJY: $this->trigger_events("\163\x65\x6c\145\143\x74"); goto WuIcj; iICUj: return $this; goto ckw7I; WuIcj: $this->_ion_select[] = $select; goto iICUj; ckw7I: } public function order_by($by, $order = "\144\x65\x73\x63") { goto tW2yH; tW2yH: $this->trigger_events("\157\x72\x64\145\162\137\x62\x79"); goto MVlqx; Zs042: $this->_ion_order = $order; goto ctiZN; ctiZN: return $this; goto SITQu; MVlqx: $this->_ion_order_by = $by; goto Zs042; SITQu: } public function row() { goto uXpNO; Wlu4C: return $row; goto ztNzD; uXpNO: $this->trigger_events("\162\157\167"); goto SmJYS; SmJYS: $row = $this->response->row(); goto Wlu4C; ztNzD: } public function row_array() { goto EPWAQ; NCyRg: return $row; goto bnNtW; jvDHX: $row = $this->response->row_array(); goto NCyRg; EPWAQ: $this->trigger_events(["\162\157\x77", "\x72\x6f\x77\x5f\x61\162\x72\141\171"]); goto jvDHX; bnNtW: } public function result() { goto z3F7o; q2ij3: $result = $this->response->result(); goto OvqVJ; OvqVJ: return $result; goto nUZwf; z3F7o: $this->trigger_events("\x72\x65\163\165\x6c\x74"); goto q2ij3; nUZwf: } public function result_array() { goto G_V4_; G_V4_: $this->trigger_events(["\162\x65\163\x75\154\164", "\x72\x65\163\165\x6c\164\x5f\x61\x72\x72\x61\x79"]); goto CsLfG; UrEo5: return $result; goto sfZSw; CsLfG: $result = $this->response->result_array(); goto UrEo5; sfZSw: } public function num_rows() { goto YtnEy; zSf1r: $result = $this->response->num_rows(); goto BBVxa; BBVxa: return $result; goto CTIZE; YtnEy: $this->trigger_events(["\x6e\165\x6d\x5f\162\x6f\x77\x73"]); goto zSf1r; CTIZE: } public function users($groups = NULL) { goto oLVDS; ELekL: $this->db->join($this->tables["\165\x73\145\x72\x73\137\x67\162\157\x75\160\163"], $this->tables["\x75\163\x65\x72\163\x5f\147\x72\x6f\165\x70\163"] . "\x2e" . $this->join["\x75\x73\145\162\x73"] . "\x3d" . $this->tables["\x75\x73\145\162\163"] . "\x2e\x69\144", "\151\156\156\x65\162"); goto A4_u7; Xqf1G: CBURv: goto xF6g2; yRWFf: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto EYAg3; } goto GLcQn; TU6Ig: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\151\x6b\x65"], $like["\x76\141\154\165\x65"], $like["\x70\157\163\x69\x74\151\x6f\156"]); ilJ99: } goto C70qy; KSh57: Jbox4: goto HkiTL; OBt6l: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto SB7q1; } goto gD1XN; akVyv: $this->trigger_events("\x65\x78\x74\162\141\137\x77\x68\x65\162\145"); goto yRWFf; agN8l: $this->db->join($this->tables["\x67\162\157\165\160\x73"], $this->tables["\x75\163\x65\162\x73\x5f\147\162\157\x75\160\163"] . "\x2e" . $this->join["\147\x72\x6f\165\160\163"] . "\x20\x3d\40" . $this->tables["\147\x72\157\165\160\163"] . "\56\151\x64", "\x69\x6e\156\145\162"); goto CP3eH; jBzIm: if (empty($group_ids)) { goto Gvq5u; } goto VTGPw; ayKvJ: nWZ4c: goto jBzIm; W9ljC: $this->response = $this->db->get($this->tables["\165\x73\145\x72\163"]); goto ZZ2Km; CjNsm: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto Jbox4; } goto Zpw8P; xlRG8: HLxEb: goto gSlYC; K4t3k: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto qzCn3; } goto QZqex; G6Z0V: $group_ids = []; goto ph9tV; C70qy: PYp0R: goto n4309; mJxKo: foreach ($groups as $group) { goto DmY3V; gPruu: $group_ids[] = $group; goto vSc1J; dQjmA: $group_names[] = $group; goto bpc9X; JdHmv: q_Vek: goto gPruu; bpc9X: goto Kwy67; goto JdHmv; YRVSO: a2075: goto emzy_; vSc1J: Kwy67: goto YRVSO; DmY3V: if (is_numeric($group)) { goto q_Vek; } goto dQjmA; emzy_: } goto QCS8s; CP3eH: $this->db->where_in($this->tables["\147\162\157\165\x70\x73"] . "\56\x6e\141\155\145", $group_names); goto ayKvJ; VTGPw: $this->db->{$or_where_in}($this->tables["\x75\163\145\x72\163\137\x67\162\157\x75\x70\x73"] . "\x2e" . $this->join["\x67\162\157\x75\160\163"], $group_ids); goto UyhpP; WXPvP: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto E7Roi; } goto TU6Ig; ktZ1x: $groups = [$groups]; goto Xqf1G; xF6g2: if (!(isset($groups) && !empty($groups))) { goto q2Fy_; } goto wHSyW; QZqex: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto GyhxP; osVam: $this->_ion_order_by = NULL; goto XmxDl; X4Wa4: E7Roi: goto CjNsm; ZZ2Km: return $this; goto tPzWE; tJ1O0: $this->_ion_where = []; goto n1luV; gSlYC: if (!isset($groups)) { goto pUD7Q; } goto GLNXH; GyhxP: $this->_ion_order = NULL; goto osVam; gD1XN: $this->db->select([$this->tables["\x75\163\145\x72\x73"] . "\56\x2a", $this->tables["\165\163\x65\162\163"] . "\x2e\x69\144\x20\x61\163\40\x69\x64", $this->tables["\165\163\145\162\x73"] . "\x2e\151\x64\40\141\x73\40\165\x73\x65\x72\x5f\151\144"]); goto pYwKD; oLVDS: $this->trigger_events("\x75\x73\x65\x72\x73"); goto OBt6l; PhEjz: SB7q1: goto wVskD; NjKR0: KFpem: goto tJ1O0; OZ4k2: N_X8P: goto aCxSL; A4_u7: q2Fy_: goto G6Z0V; Dw4Tt: pUD7Q: goto akVyv; wHSyW: $this->db->distinct(); goto ELekL; GLNXH: if (is_array($groups)) { goto CBURv; } goto ktZ1x; n4309: $this->_ion_like = []; goto X4Wa4; XmxDl: qzCn3: goto W9ljC; aCxSL: $this->_ion_select = []; goto xlRG8; GLcQn: foreach ($this->_ion_where as $where) { $this->db->where($where); xeNnW: } goto NjKR0; sXuxp: if (empty($group_names)) { goto nWZ4c; } goto agN8l; ph9tV: $group_names = []; goto mJxKo; DDyrM: Fqma4: goto K4t3k; YeLM1: $this->_ion_limit = NULL; goto mRjY_; UyhpP: Gvq5u: goto Dw4Tt; MYqiZ: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\137\167\150\x65\162\145\137\x69\156" : "\x77\x68\x65\162\145\137\x69\x6e"; goto sXuxp; pYwKD: goto HLxEb; goto PhEjz; HkiTL: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto YeLM1; n1luV: EYAg3: goto WXPvP; Zpw8P: if (!isset($this->_ion_limit)) { goto MxHyG; } goto iovPp; iovPp: $this->db->limit($this->_ion_limit); goto FTFG4; FTFG4: $this->_ion_limit = NULL; goto Mojre; QCS8s: v069L: goto MYqiZ; Stmpc: goto Fqma4; goto KSh57; wVskD: foreach ($this->_ion_select as $select) { $this->db->select($select); n68Ra: } goto OZ4k2; mRjY_: $this->_ion_offset = NULL; goto DDyrM; Mojre: MxHyG: goto Stmpc; tPzWE: } public function user($id = NULL) { goto LbiCx; MFajE: $this->users(); goto sKd1R; TktAf: $this->order_by($this->tables["\x75\163\x65\x72\x73"] . "\x2e\x69\x64", "\x64\x65\x73\x63"); goto deRx8; GJGZf: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\162\137\x69\x64"); goto YtqCy; deRx8: $this->where($this->tables["\x75\163\x65\162\163"] . "\56\x69\144", $id); goto MFajE; sKd1R: return $this; goto flPbs; LbiCx: $this->trigger_events("\x75\163\145\x72"); goto GJGZf; YtqCy: $this->limit(1); goto TktAf; flPbs: } public function get_users_groups($id = FALSE) { goto hy2Q4; hy2Q4: $this->trigger_events("\147\x65\164\x5f\165\163\x65\162\x73\137\x67\162\157\165\x70"); goto eISnk; eISnk: $id || ($id = $this->session->userdata("\x75\163\x65\x72\137\151\144")); goto ntSHS; ntSHS: return $this->db->select($this->tables["\165\x73\x65\162\163\137\147\x72\157\x75\x70\163"] . "\56" . $this->join["\x67\x72\157\x75\x70\x73"] . "\40\x61\x73\x20\x69\x64\x2c\x20" . $this->tables["\x67\x72\x6f\x75\x70\163"] . "\x2e\x6e\x61\x6d\x65\54\40" . $this->tables["\x67\162\157\165\160\163"] . "\x2e\144\x65\x73\x63\x72\x69\160\164\x69\x6f\x6e")->where($this->tables["\x75\x73\x65\162\x73\137\x67\x72\157\165\x70\x73"] . "\x2e" . $this->join["\x75\163\145\x72\x73"], $id)->join($this->tables["\x67\x72\x6f\165\160\x73"], $this->tables["\165\x73\145\x72\x73\x5f\147\162\157\165\160\163"] . "\56" . $this->join["\147\162\157\165\160\163"] . "\x3d" . $this->tables["\147\x72\157\165\160\x73"] . "\56\151\144")->get($this->tables["\x75\x73\x65\162\x73\x5f\x67\162\x6f\x75\x70\163"]); goto IdDQr; IdDQr: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto NYUvx; Wuwj4: $id || ($id = $this->session->userdata("\165\163\x65\x72\x5f\151\x64")); goto A7V6B; DWmRA: return $check_all; goto N2n2r; RlEJQ: Ih4oJ: goto tMlCc; OXn82: $groups_array = $this->_cache_user_in_group[$id]; goto RlEJQ; NYUvx: $this->trigger_events("\151\x6e\137\147\162\157\x75\160"); goto Wuwj4; zBrua: $users_groups = $this->get_users_groups($id)->result(); goto vNKcU; tMlCc: foreach ($check_group as $key => $value) { goto M9jC5; BGLNi: xzDgk: goto ZG_gp; O1uXA: ANZrS: goto BGLNi; CFcXV: if (!(in_array($value, $groups) xor $check_all)) { goto ANZrS; } goto JHLMO; M9jC5: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto CFcXV; JHLMO: return !$check_all; goto O1uXA; ZG_gp: } goto qpC8i; SBz0P: $check_group = [$check_group]; goto gATVY; kKCfa: lDnup: goto OXn82; OX_3_: goto Ih4oJ; goto kKCfa; qpC8i: pstnO: goto DWmRA; vNKcU: $groups_array = []; goto yVtkZ; gATVY: Z38C3: goto fu2or; fu2or: if (isset($this->_cache_user_in_group[$id])) { goto lDnup; } goto zBrua; A7V6B: if (is_array($check_group)) { goto Z38C3; } goto SBz0P; Q2YbE: WBiy2: goto cv22K; yVtkZ: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; WzayJ: } goto Q2YbE; cv22K: $this->_cache_user_in_group[$id] = $groups_array; goto OX_3_; N2n2r: } public function add_to_group($group_ids, $user_id = FALSE) { goto Ku36o; ZLSx2: $user_id || ($user_id = $this->session->userdata("\x75\163\x65\162\x5f\x69\144")); goto Es1rF; Ku36o: $this->trigger_events("\x61\x64\x64\137\164\157\137\x67\162\157\x75\x70"); goto ZLSx2; TDsUo: foreach ($group_ids as $group_id) { goto xQ7Ev; jCTmD: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto gXda9; axlLT: $group_name = $group[0]->name; goto UAaEi; SROiR: $group_name = $this->_cache_groups[$group_id]; goto yw0u1; E03Aw: if (isset($this->_cache_groups[$group_id])) { goto Rb72D; } goto Hnq2n; wqCWZ: fSInS: goto hae69; Hnq2n: $group = $this->group($group_id)->result(); goto axlLT; hae69: cByda: goto VIelA; SI8On: Rb72D: goto SROiR; vyBHW: goto Xv0kj; goto SI8On; gXda9: $return++; goto wqCWZ; xQ7Ev: if (!$this->db->insert($this->tables["\165\x73\145\162\x73\x5f\x67\x72\157\165\160\163"], [$this->join["\147\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\165\x73\x65\162\163"] => (float) $user_id])) { goto fSInS; } goto E03Aw; yw0u1: Xv0kj: goto jCTmD; UAaEi: $this->_cache_groups[$group_id] = $group_name; goto vyBHW; VIelA: } goto Z5KPM; YCJqL: $group_ids = [$group_ids]; goto Thcbc; u_h5r: $return = 0; goto TDsUo; Aj1dj: return $return; goto AMAzN; Es1rF: if (is_array($group_ids)) { goto YjPsg; } goto YCJqL; Z5KPM: d0tfH: goto Aj1dj; Thcbc: YjPsg: goto u_h5r; AMAzN: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto x7NUg; YRpkV: return FALSE; goto HL4zw; BM1Kk: goto f1Tmj; goto mICTm; g62MD: $group_ids = [$group_ids]; goto gvckb; aIJxQ: FPRwg: goto BM1Kk; gvckb: cdCgZ: goto e9jfl; pQnce: $return = TRUE; goto TRASA; mICTm: qd4iV: goto xLo0I; p1i7h: nrUVa: goto pQnce; cvF1Y: $this->_cache_user_in_group[$user_id] = []; goto aIJxQ; Z2di2: if (!empty($user_id)) { goto Zm6V1; } goto YRpkV; xLo0I: if (is_array($group_ids)) { goto cdCgZ; } goto g62MD; HL4zw: Zm6V1: goto EMl5J; e9jfl: foreach ($group_ids as $group_id) { goto mzbza; QEj8m: unset($this->_cache_user_in_group[$user_id][$group_id]); goto vGCo7; mzbza: $this->db->delete($this->tables["\165\x73\x65\x72\x73\x5f\147\162\x6f\165\x70\x73"], [$this->join["\147\x72\157\165\160\163"] => (float) $group_id, $this->join["\x75\x73\x65\x72\163"] => (float) $user_id]); goto caqqU; caqqU: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto heRBd; } goto QEj8m; vGCo7: heRBd: goto IgO4X; IgO4X: P_TVF: goto nzSa2; nzSa2: } goto p1i7h; x7NUg: $this->trigger_events("\162\145\155\x6f\x76\x65\137\x66\x72\157\155\137\147\x72\157\x75\160"); goto Z2di2; EMl5J: if (!empty($group_ids)) { goto qd4iV; } goto BDaSP; TRASA: f1Tmj: goto URTUn; URTUn: return $return; goto JT0Fw; BDaSP: if (!($return = $this->db->delete($this->tables["\165\x73\x65\162\x73\137\x67\x72\x6f\165\x70\x73"], [$this->join["\165\x73\x65\x72\x73"] => (float) $user_id]))) { goto FPRwg; } goto cvF1Y; JT0Fw: } public function groups() { goto Nt79h; Nt79h: $this->trigger_events("\x67\162\157\x75\160\163"); goto I8irV; ChKkW: foreach ($this->_ion_where as $where) { $this->db->where($where); K8uoi: } goto zA8Ke; wcg_W: if (!isset($this->_ion_limit)) { goto zv4yJ; } goto sLYQo; ag_dG: $this->_ion_limit = NULL; goto Kgrei; eMGID: Liml1: goto bwaCO; dkx5M: goto QQNjS; goto eCA62; bwaCO: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto Bipus; } goto wcg_W; qlTBF: $this->_ion_limit = NULL; goto Cu56t; sLYQo: $this->db->limit($this->_ion_limit); goto qlTBF; aMT4G: Om6ZZ: goto leD6S; zA8Ke: Oum6s: goto xp3Wz; Cu56t: zv4yJ: goto dkx5M; Jh1xu: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto aMT4G; Kgrei: $this->_ion_offset = NULL; goto QTrYl; eCA62: Bipus: goto hf15B; QTrYl: QQNjS: goto rM513; I8irV: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto Liml1; } goto ChKkW; hf15B: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto ag_dG; xp3Wz: $this->_ion_where = []; goto eMGID; rM513: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto Om6ZZ; } goto Jh1xu; leD6S: $this->response = $this->db->get($this->tables["\147\x72\157\165\160\x73"]); goto uHfaa; uHfaa: return $this; goto Ba17Y; Ba17Y: } public function group($id = NULL) { goto iDCs3; vvb1w: $this->where($this->tables["\147\162\157\165\160\x73"] . "\56\x69\144", $id); goto nYXEP; iDCs3: $this->trigger_events("\x67\x72\157\x75\160"); goto tPb52; nYXEP: DQNhV: goto M_JZa; tPb52: if (!isset($id)) { goto DQNhV; } goto vvb1w; RfBou: $this->order_by("\151\x64", "\144\145\163\143"); goto lFCiQ; lFCiQ: return $this->groups(); goto G4Jx4; M_JZa: $this->limit(1); goto RfBou; G4Jx4: } public function update($id, array $data) { goto Q_ZVx; YjvNF: $data["\160\141\163\x73\167\x6f\162\x64"] = $this->hash_password($data["\160\x61\x73\x73\x77\157\x72\x64"], $user->{$this->identity_column}); goto zQdoT; ryZT1: $this->db->trans_begin(); goto zGHzU; StYjg: $this->db->trans_rollback(); goto jveNC; Q2ubc: $user = $this->user($id)->row(); goto ryZT1; rKu1F: kCMG3: goto YjvNF; jveNC: $this->set_error("\141\143\x63\x6f\x75\156\x74\137\x63\x72\145\141\164\151\x6f\x6e\x5f\144\x75\160\x6c\x69\143\x61\x74\145\x5f\151\x64\x65\x6e\x74\151\164\x79"); goto eY4XQ; cjh2C: Bj7S1: goto CWasg; AF0XZ: iwcm1: goto dMAt9; ujvgk: return FALSE; goto cjh2C; FBjKO: $this->db->trans_commit(); goto R37iA; koart: $this->db->trans_rollback(); goto v7uu8; cWUfP: unset($data["\x70\141\163\x73\x77\x6f\x72\x64"]); goto mx_ca; OowFQ: return FALSE; goto NGqfu; R37iA: $this->trigger_events(["\x70\x6f\163\164\137\x75\x70\x64\141\x74\145\x5f\165\x73\x65\162", "\x70\157\163\x74\x5f\165\160\x64\141\x74\x65\x5f\x75\x73\145\x72\137\163\x75\143\x63\145\163\163\x66\165\154"]); goto RN5Zv; zQdoT: if (!($data["\160\141\163\163\x77\157\162\144"] === FALSE)) { goto ylGiN; } goto i_gyd; mx_ca: goto iwcm1; goto rKu1F; sBSir: ylGiN: goto AF0XZ; eY4XQ: $this->trigger_events(["\160\157\163\164\137\x75\160\x64\x61\164\145\x5f\165\163\145\x72", "\160\157\x73\x74\x5f\165\160\144\x61\164\145\137\165\x73\145\x72\137\x75\156\x73\165\x63\143\x65\163\x73\146\x75\154"]); goto KspLC; zGHzU: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto Bj7S1; } goto StYjg; i_gyd: $this->db->trans_rollback(); goto r_Iwl; r_Iwl: $this->trigger_events(["\160\x6f\163\x74\x5f\165\x70\144\141\164\x65\137\x75\x73\145\x72", "\160\157\163\x74\137\165\x70\144\141\164\x65\137\x75\163\145\x72\x5f\165\156\x73\x75\x63\143\145\163\x73\x66\x75\154"]); goto CCDJV; mu6Nr: if (!empty($data["\x70\141\163\163\167\x6f\162\x64"])) { goto kCMG3; } goto cWUfP; NQK20: if (!($this->db->trans_status() === FALSE)) { goto vP6ef; } goto koart; Ipx7N: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, ["\151\x64" => $user->id]); goto NQK20; GAjZt: $this->set_error("\165\x70\x64\141\x74\x65\x5f\165\x6e\x73\165\x63\x63\145\163\x73\x66\x75\x6c"); goto OowFQ; I4fAN: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\x73\x73\x77\157\162\x64", $data) || array_key_exists("\145\x6d\x61\x69\x6c", $data))) { goto w1P_d; } goto GBFlE; Q_ZVx: $this->trigger_events("\160\162\145\x5f\165\x70\144\x61\x74\145\x5f\165\x73\145\x72"); goto Q2ubc; KOTBp: return TRUE; goto ecNN5; TQJa9: w1P_d: goto rFJQE; YEw7p: return FALSE; goto sBSir; rFJQE: $this->trigger_events("\x65\170\x74\162\x61\137\167\x68\145\x72\x65"); goto Ipx7N; RN5Zv: $this->set_message("\x75\160\x64\141\x74\145\137\x73\x75\143\x63\x65\163\163\146\x75\154"); goto KOTBp; v7uu8: $this->trigger_events(["\160\x6f\163\x74\x5f\165\x70\144\141\x74\145\x5f\x75\x73\x65\x72", "\160\157\163\x74\137\165\x70\x64\x61\164\145\137\x75\163\x65\162\x5f\x75\156\163\165\x63\143\x65\x73\x73\146\x75\x6c"]); goto GAjZt; NGqfu: vP6ef: goto FBjKO; CCDJV: $this->set_error("\165\x70\144\141\x74\x65\137\x75\x6e\x73\165\143\x63\145\163\x73\146\x75\154"); goto YEw7p; KspLC: $this->set_error("\165\x70\x64\141\x74\145\137\x75\x6e\163\x75\143\143\x65\x73\163\146\165\x6c"); goto ujvgk; CWasg: $data = $this->_filter_data($this->tables["\165\163\145\x72\163"], $data); goto I4fAN; dMAt9: G7pvl: goto TQJa9; GBFlE: if (!array_key_exists("\x70\x61\163\x73\x77\157\x72\144", $data)) { goto G7pvl; } goto mu6Nr; ecNN5: } public function delete_user($id) { goto RQ1fD; aYc2u: $this->set_message("\144\x65\x6c\x65\164\145\x5f\x73\165\143\143\145\163\x73\146\x75\x6c"); goto mmGPA; i3BN7: $this->trigger_events(["\160\157\163\164\137\144\x65\x6c\x65\x74\145\x5f\x75\x73\x65\162", "\160\x6f\x73\164\137\x64\145\x6c\145\x74\x65\137\x75\x73\145\162\137\165\156\163\x75\143\x63\x65\163\163\x66\165\x6c"]); goto zyMuO; zyMuO: $this->set_error("\144\145\x6c\x65\164\145\137\x75\x6e\163\165\x63\x63\x65\163\163\146\x75\154"); goto ja5K2; tTszR: $this->db->trans_rollback(); goto i3BN7; GqK_I: $this->trigger_events(["\160\x6f\163\x74\137\144\x65\x6c\145\164\145\137\x75\x73\145\162", "\x70\157\163\x74\137\144\x65\154\x65\164\145\137\165\x73\145\x72\x5f\x73\165\143\143\x65\x73\163\x66\165\x6c"]); goto aYc2u; alJP_: $this->db->trans_commit(); goto GqK_I; uUP71: rJ4Hb: goto alJP_; Yepa3: $this->db->delete($this->tables["\x75\x73\x65\x72\x73"], ["\151\144" => $id]); goto xMOS9; LWYTc: $this->remove_from_group(NULL, $id); goto Yepa3; RQ1fD: $this->trigger_events("\x70\162\145\137\144\x65\x6c\145\x74\145\x5f\x75\x73\145\x72"); goto QGs9F; mmGPA: return TRUE; goto AT1xd; xMOS9: if (!($this->db->trans_status() === FALSE)) { goto rJ4Hb; } goto tTszR; ja5K2: return FALSE; goto uUP71; QGs9F: $this->db->trans_begin(); goto LWYTc; AT1xd: } public function update_last_login($id) { goto XGBfP; XGBfP: $this->trigger_events("\165\x70\x64\x61\164\x65\137\154\x61\x73\x74\x5f\154\157\x67\151\x6e"); goto AH7Dm; jRM2r: $this->trigger_events("\x65\x78\164\162\x61\x5f\167\150\145\x72\145"); goto evA1p; AH7Dm: $this->load->helper("\144\141\164\145"); goto jRM2r; evA1p: $this->db->update($this->tables["\x75\163\145\162\x73"], ["\x6c\x61\x73\164\137\x6c\157\147\151\156" => time()], ["\151\x64" => $id]); goto e6OOI; e6OOI: return $this->db->affected_rows() == 1; goto yH0pN; yH0pN: } public function set_lang($lang = "\145\156") { goto VrVOw; EQOAN: $expire = $this->config->item("\165\x73\145\x72\137\145\170\x70\151\x72\x65", "\151\x6f\x6e\x5f\x61\x75\164\150"); goto fveLn; bagjJ: sc7OC: goto YJ_q5; YJ_q5: set_cookie(["\x6e\x61\x6d\x65" => "\x6c\x61\156\147\137\143\x6f\x64\x65", "\x76\141\154\x75\x65" => $lang, "\x65\x78\160\x69\x72\145" => $expire]); goto N627Q; fveLn: goto sc7OC; goto XIj3e; siGoJ: $expire = self::MAX_COOKIE_LIFETIME; goto bagjJ; sTPWh: if ($this->config->item("\165\x73\x65\x72\137\145\170\x70\x69\162\145", "\151\157\x6e\x5f\141\x75\x74\150") === 0) { goto aPqye; } goto EQOAN; VrVOw: $this->trigger_events("\x73\x65\x74\x5f\154\x61\156\x67"); goto sTPWh; XIj3e: aPqye: goto siGoJ; N627Q: return TRUE; goto grrLS; grrLS: } public function set_session($user) { goto AB23a; CjDbp: $session_data = ["\151\144\x65\x6e\x74\x69\164\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\x6d\x61\151\154" => $user->email, "\165\x73\145\162\x5f\x69\x64" => $user->id, "\157\x6c\x64\137\x6c\x61\x73\164\137\154\157\147\x69\156" => $user->last_login, "\x6c\141\x73\164\137\x63\x68\x65\x63\x6b" => time()]; goto n5kjp; n5kjp: $this->session->set_userdata($session_data); goto nvJcg; AB23a: $this->trigger_events("\x70\162\x65\137\163\145\x74\137\x73\145\163\x73\151\x6f\x6e"); goto CjDbp; JF45E: return TRUE; goto dxiGg; nvJcg: $this->trigger_events("\x70\x6f\x73\x74\137\x73\x65\x74\x5f\163\x65\163\x73\x69\x6f\x6e"); goto JF45E; dxiGg: } public function remember_user($identity) { goto g2C29; d1B3t: jpFRW: goto vIr4d; ewKUp: $this->trigger_events(["\160\157\163\164\x5f\162\x65\155\x65\155\142\145\162\137\x75\163\145\162", "\162\145\155\145\155\x62\145\x72\137\165\163\x65\x72\x5f\165\x6e\x73\165\143\x63\x65\x73\x73\x66\x75\154"]); goto e_Cbv; AXIhc: if (!($this->db->affected_rows() > -1)) { goto jpFRW; } goto KIk5m; BVM5S: return FALSE; goto OxVxa; G9kEY: set_cookie(["\x6e\x61\x6d\145" => $this->config->item("\162\x65\x6d\145\x6d\x62\145\162\x5f\143\x6f\157\x6b\x69\145\x5f\156\141\155\x65", "\x69\x6f\x6e\137\x61\x75\164\x68"), "\166\x61\154\165\145" => $token->user_code, "\x65\x78\160\x69\x72\145" => $expire]); goto mh0C2; RwOSH: $expire = self::MAX_COOKIE_LIFETIME; goto s_ttn; s_ttn: dfyee: goto G9kEY; KIk5m: if ($this->config->item("\165\163\145\162\x5f\145\x78\160\151\162\x65", "\x69\157\x6e\137\x61\165\164\x68") === 0) { goto EIABA; } goto hTO05; eidRP: $token = $this->_generate_selector_validator_couple(); goto WZGz5; FTFLj: return TRUE; goto d1B3t; hTO05: $expire = $this->config->item("\165\163\145\x72\x5f\145\x78\160\151\162\x65", "\x69\x6f\156\137\x61\165\164\x68"); goto G0Y2Y; mh0C2: $this->trigger_events(["\x70\157\163\x74\x5f\x72\145\155\x65\155\x62\x65\162\137\165\x73\x65\162", "\162\145\x6d\145\155\142\145\x72\137\x75\163\x65\162\x5f\163\165\143\143\x65\x73\163\x66\x75\x6c"]); goto FTFLj; G0Y2Y: goto dfyee; goto sNwIT; vIr4d: Jkp_m: goto ewKUp; WZGz5: if (!$token->validator_hashed) { goto Jkp_m; } goto jh7ov; sNwIT: EIABA: goto RwOSH; e_Cbv: return FALSE; goto YuMqX; NpyNz: if ($identity) { goto Og7Fb; } goto BVM5S; OxVxa: Og7Fb: goto eidRP; jh7ov: $this->db->update($this->tables["\165\163\145\162\163"], ["\x72\x65\155\145\x6d\x62\x65\162\x5f\163\x65\x6c\145\x63\164\157\x72" => $token->selector, "\162\145\x6d\x65\155\x62\145\x72\x5f\x63\157\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto AXIhc; g2C29: $this->trigger_events("\160\162\145\137\x72\145\x6d\145\155\x62\145\162\x5f\x75\x73\145\x72"); goto NpyNz; YuMqX: } public function login_remembered_user() { goto yo88u; ltLUs: sSEQ7: goto sNKhN; f8JHe: $this->session->sess_regenerate(FALSE); goto K2LKD; K2LKD: $this->trigger_events(["\x70\x6f\163\x74\x5f\x6c\157\147\x69\x6e\137\x72\145\x6d\145\155\x62\145\162\145\x64\x5f\x75\163\x65\x72", "\x70\x6f\x73\164\x5f\x6c\x6f\x67\x69\x6e\x5f\162\145\x6d\x65\x6d\x62\145\x72\145\144\137\165\x73\145\x72\137\x73\x75\143\143\145\163\x73\146\165\x6c"]); goto YjQPP; W1Fte: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto sSEQ7; } goto io0vs; kHo_q: $user = $query->row(); goto v9xmT; ONFSL: $query = $this->db->select($this->identity_column . "\54\40\151\x64\54\x20\x65\155\141\x69\154\x2c\x20\x72\145\x6d\x65\x6d\142\x65\x72\137\143\x6f\x64\145\54\x20\154\x61\163\164\137\154\x6f\147\151\156")->where("\x72\x65\x6d\145\155\142\145\162\x5f\x73\145\154\x65\x63\x74\157\x72", $token->selector)->where("\x61\143\x74\x69\x76\145", 1)->limit(1)->get($this->tables["\x75\x73\x65\x72\x73"]); goto NTKeg; B2Wpp: delete_cookie($this->config->item("\x72\x65\155\x65\x6d\142\x65\162\x5f\143\x6f\157\153\151\145\x5f\156\x61\x6d\145", "\x69\x6f\156\137\141\x75\164\150")); goto pvZLs; SLBzW: $this->set_session($user); goto qkgmE; qkgmE: $this->clear_forgotten_password_code($identity); goto YrG6V; sNKhN: wovFm: goto B2Wpp; pvZLs: $this->trigger_events(["\x70\x6f\163\x74\x5f\x6c\x6f\x67\x69\x6e\137\162\x65\x6d\145\x6d\x62\145\x72\x65\x64\137\x75\163\x65\162", "\x70\x6f\163\164\x5f\154\x6f\x67\151\x6e\x5f\x72\145\155\x65\155\142\x65\162\145\x64\x5f\165\163\x65\x72\137\x75\156\163\x75\x63\143\145\x73\x73\146\165\x6c"]); goto Yju5b; PJkt4: return FALSE; goto nCmeL; mJjDW: $this->remember_user($identity); goto fB6PK; YrG6V: if (!$this->config->item("\165\163\x65\x72\137\x65\170\x74\x65\x6e\x64\137\x6f\156\137\x6c\157\147\x69\x6e", "\151\x6f\156\x5f\x61\x75\x74\x68")) { goto F2WzR; } goto mJjDW; NTKeg: if (!($query->num_rows() === 1)) { goto wovFm; } goto kHo_q; io0vs: $this->update_last_login($user->id); goto SLBzW; QM8VL: $remember_cookie = get_cookie($this->config->item("\x72\x65\155\145\155\142\145\x72\x5f\x63\x6f\x6f\153\151\x65\x5f\x6e\141\x6d\145", "\x69\x6f\156\137\x61\x75\164\x68")); goto BWs8Y; BWs8Y: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto Qccod; Qccod: if (!($token === FALSE)) { goto rqldZ; } goto hhNtb; v9xmT: $identity = $user->{$this->identity_column}; goto W1Fte; YjQPP: return TRUE; goto ltLUs; Yju5b: return FALSE; goto iexDA; nCmeL: rqldZ: goto vUJ3E; yo88u: $this->trigger_events("\160\x72\145\x5f\x6c\x6f\x67\x69\x6e\137\x72\145\155\145\155\x62\145\x72\x65\144\x5f\x75\x73\x65\162"); goto QM8VL; fB6PK: F2WzR: goto f8JHe; hhNtb: $this->trigger_events(["\x70\x6f\x73\164\137\154\x6f\147\x69\x6e\x5f\162\145\x6d\x65\x6d\x62\x65\162\145\144\x5f\165\x73\145\162", "\160\157\x73\164\x5f\x6c\157\x67\151\156\x5f\162\x65\155\x65\x6d\x62\x65\162\x65\144\x5f\165\x73\x65\x72\137\x75\x6e\163\165\x63\x63\x65\x73\163\146\165\154"]); goto PJkt4; vUJ3E: $this->trigger_events("\145\x78\x74\x72\x61\x5f\167\150\x65\162\x65"); goto ONFSL; iexDA: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto FFZOA; snKXd: fgB8X: goto WBDjB; ynYwE: $group_id = $this->db->insert_id($this->tables["\x67\162\157\165\x70\163"] . "\x5f\151\144\x5f\x73\x65\161"); goto Mj5Ts; iw34o: $data = array_merge($this->_filter_data($this->tables["\147\x72\157\165\x70\163"], $additional_data), $data); goto snKXd; Mj5Ts: $this->set_message("\147\x72\157\x75\x70\137\143\x72\x65\141\164\x69\x6f\x6e\x5f\x73\165\x63\x63\145\163\x73\x66\165\x6c"); goto FL2AC; spUJU: $data = ["\156\x61\155\x65" => $group_name, "\144\145\x73\143\x72\x69\160\164\151\x6f\156" => $group_description]; goto RvMXT; JcIDF: Y4gna: goto HDvWU; Tc2YX: return FALSE; goto JcIDF; KTxIn: return FALSE; goto iYX_p; lTZ65: if (!($existing_group !== 0)) { goto Xg5_J; } goto IvTzt; f1STt: $this->set_error("\x67\x72\x6f\x75\x70\137\x6e\x61\x6d\145\x5f\x72\x65\161\x75\x69\x72\x65\144"); goto Tc2YX; BhxzI: $this->db->insert($this->tables["\x67\x72\157\165\x70\x73"], $data); goto ynYwE; FL2AC: return $group_id; goto PjuMt; RvMXT: if (empty($additional_data)) { goto fgB8X; } goto iw34o; WBDjB: $this->trigger_events("\x65\170\x74\162\141\x5f\147\x72\157\165\x70\137\163\x65\x74"); goto BhxzI; HDvWU: $existing_group = $this->db->get_where($this->tables["\147\162\157\x75\x70\163"], ["\x6e\x61\x6d\145" => $group_name])->num_rows(); goto lTZ65; FFZOA: if ($group_name) { goto Y4gna; } goto f1STt; IvTzt: $this->set_error("\x67\162\x6f\x75\160\x5f\x61\154\x72\145\141\x64\171\137\x65\170\151\163\164\x73"); goto KTxIn; iYX_p: Xg5_J: goto spUJU; PjuMt: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto FCaMK; RPHJa: $this->set_error("\147\x72\157\x75\160\137\156\x61\x6d\145\x5f\x61\144\155\x69\156\137\x6e\x6f\x74\137\141\x6c\x74\x65\162"); goto Vxton; Ljnsn: $data["\156\141\x6d\145"] = $group_name; goto mz4r_; j41Su: if (!($this->config->item("\x61\x64\155\151\x6e\x5f\147\162\157\x75\160", "\x69\x6f\x6e\137\x61\x75\x74\150") === $group->name && $group_name !== $group->name)) { goto lixqO; } goto RPHJa; xRY6F: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto Tj90D; } goto TtL9A; tuvgZ: if (empty($additional_data)) { goto xsOG0; } goto UZPZb; VYX6y: ICQ5F: goto misDU; misDU: $data = []; goto w9LD9; Y7PaB: lixqO: goto tuvgZ; kMI3_: $this->set_message("\x67\x72\157\x75\x70\137\165\160\x64\x61\164\x65\x5f\163\165\x63\143\145\x73\163\x66\165\x6c"); goto unVo7; Vxton: return FALSE; goto Y7PaB; DNTP6: xsOG0: goto XBQ4Q; DwJFK: $existing_group = $this->db->get_where($this->tables["\x67\162\157\x75\160\163"], ["\x6e\x61\x6d\145" => $group_name])->row(); goto xRY6F; w9LD9: if (empty($group_name)) { goto nbXc1; } goto DwJFK; UZPZb: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\x75\x70\163"], $additional_data), $data); goto DNTP6; Dfuec: $group = $this->db->get_where($this->tables["\x67\162\157\165\160\x73"], ["\151\x64" => $group_id])->row(); goto j41Su; FCaMK: if (!empty($group_id)) { goto ICQ5F; } goto DIFPm; ZnDN0: Tj90D: goto Ljnsn; unVo7: return TRUE; goto lmeI5; XBQ4Q: $this->db->update($this->tables["\147\x72\x6f\x75\x70\x73"], $data, ["\151\x64" => $group_id]); goto kMI3_; DIFPm: return FALSE; goto VYX6y; TtL9A: $this->set_error("\x67\x72\157\x75\160\x5f\141\x6c\x72\x65\x61\x64\x79\x5f\x65\170\x69\163\164\163"); goto mYsPU; mYsPU: return FALSE; goto ZnDN0; mz4r_: nbXc1: goto Dfuec; lmeI5: } public function delete_group($group_id = FALSE) { goto v5HGa; H1TXr: vagn1: goto ZG533; LmvqE: $group = $this->group($group_id)->row(); goto oZlSI; bnk8i: return FALSE; goto H1TXr; DF8pi: return TRUE; goto zpgB7; wl4Xv: $this->set_message("\147\x72\157\x75\x70\137\x64\145\x6c\145\164\145\x5f\163\x75\143\143\145\x73\163\146\165\x6c"); goto DF8pi; aM0IX: $this->db->delete($this->tables["\x75\163\x65\162\x73\x5f\x67\x72\x6f\165\x70\x73"], [$this->join["\147\162\157\x75\160\x73"] => $group_id]); goto AbgJm; ZG533: $this->trigger_events("\x70\162\145\137\x64\x65\154\x65\164\x65\137\x67\162\x6f\x75\x70"); goto kbPyf; jWdKH: $this->db->trans_rollback(); goto IuQ5Z; MUDyA: $this->set_error("\x67\162\x6f\165\x70\137\144\145\x6c\145\x74\145\x5f\156\157\164\141\154\154\x6f\x77\145\144"); goto bnk8i; BM0oe: if (!($this->db->trans_status() === FALSE)) { goto AaLqK; } goto jWdKH; bUVs6: $this->trigger_events(["\x70\x6f\163\x74\x5f\x64\145\154\x65\164\x65\137\x67\162\x6f\x75\x70", "\x70\x6f\163\164\x5f\144\145\x6c\x65\x74\x65\137\x67\162\x6f\x75\160\x5f\x73\x75\143\x63\145\163\163\x66\165\154"]); goto wl4Xv; oZlSI: if (!($group->name == $this->config->item("\141\144\x6d\151\x6e\137\147\x72\157\x75\x70", "\x69\x6f\x6e\137\x61\165\164\150"))) { goto vagn1; } goto HFmLP; HCzGb: return FALSE; goto EreOc; BJfwu: AaLqK: goto Hp1zq; Hp1zq: $this->db->trans_commit(); goto bUVs6; v5HGa: if (!(!$group_id || empty($group_id))) { goto gvoEq; } goto HCzGb; AbgJm: $this->db->delete($this->tables["\x67\x72\157\165\160\163"], ["\151\x64" => $group_id]); goto BM0oe; EreOc: gvoEq: goto LmvqE; HFmLP: $this->trigger_events(["\160\x6f\x73\x74\137\x64\145\154\145\164\x65\137\147\x72\x6f\x75\x70", "\160\157\x73\x74\137\144\145\x6c\145\x74\x65\137\147\x72\157\165\160\137\x6e\x6f\164\141\154\154\157\167\x65\144"]); goto MUDyA; nKeIE: $this->set_error("\x67\x72\157\x75\160\x5f\144\x65\x6c\145\164\145\137\165\156\163\x75\x63\143\x65\x73\163\146\165\154"); goto RorvS; kbPyf: $this->db->trans_begin(); goto aM0IX; IuQ5Z: $this->trigger_events(["\x70\x6f\163\164\x5f\x64\x65\x6c\145\x74\x65\137\x67\162\x6f\165\160", "\x70\x6f\163\x74\137\144\145\154\x65\x74\145\x5f\x67\x72\157\165\x70\x5f\x75\156\163\x75\143\143\145\x73\163\146\165\x6c"]); goto nKeIE; RorvS: return FALSE; goto BJfwu; zpgB7: } public function set_hook($event, $name, $class, $method, $arguments) { goto oJz_l; jyW_S: $this->_ion_hooks->{$event}[$name]->class = $class; goto wF8Ok; oJz_l: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto jyW_S; rbOPt: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto mzrnj; wF8Ok: $this->_ion_hooks->{$event}[$name]->method = $method; goto rbOPt; mzrnj: } public function remove_hook($event, $name) { goto o40zs; oDsDj: tkU33: goto YsB6W; t7R3C: unset($this->_ion_hooks->{$event}[$name]); goto oDsDj; o40zs: if (!isset($this->_ion_hooks->{$event}[$name])) { goto tkU33; } goto t7R3C; YsB6W: } public function remove_hooks($event) { goto QQ2n4; QQ2n4: if (!isset($this->_ion_hooks->{$event})) { goto dAmE3; } goto KgE0x; KgE0x: unset($this->_ion_hooks->{$event}); goto pt9x6; pt9x6: dAmE3: goto Kwrxp; Kwrxp: } protected function _call_hook($event, $name) { goto XxA0u; uQ_e1: nHxtc: goto ZLbrI; aPdzx: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto uQ_e1; tt3mT: $hook = $this->_ion_hooks->{$event}[$name]; goto aPdzx; XxA0u: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto nHxtc; } goto tt3mT; ZLbrI: return FALSE; goto S2ojC; S2ojC: } public function trigger_events($events) { goto mkZ0b; IrfZ4: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); gG6M8: } goto UM4Gb; yny6g: foreach ($events as $event) { $this->trigger_events($event); WHYiW: } goto ST58A; OI0SK: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto kXEYI; } goto IrfZ4; EUn7M: goto nIUVu; goto QHvFV; U8C_F: kXEYI: goto EUn7M; mkZ0b: if (is_array($events) && !empty($events)) { goto av5wq; } goto OI0SK; ST58A: nl7bj: goto YGRhW; UM4Gb: Wjf03: goto U8C_F; QHvFV: av5wq: goto yny6g; YGRhW: nIUVu: goto E1B_X; E1B_X: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto KjWHY; DbyEP: $this->message_end_delimiter = $end_delimiter; goto se0Mr; KjWHY: $this->message_start_delimiter = $start_delimiter; goto DbyEP; se0Mr: return TRUE; goto wNFmE; wNFmE: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto wWUn5; wWUn5: $this->error_start_delimiter = $start_delimiter; goto fcBje; TMrGi: return TRUE; goto uewie; fcBje: $this->error_end_delimiter = $end_delimiter; goto TMrGi; uewie: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto X339Z; ZF3Gl: return $_output; goto GUUfM; zEDrn: pp1eo: goto ZF3Gl; jlRD4: foreach ($this->messages as $message) { goto zb5_Z; zb5_Z: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto nsJ1p; nsJ1p: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto BG7zp; BG7zp: kc9dJ: goto h3zxS; h3zxS: } goto zEDrn; X339Z: $_output = ''; goto jlRD4; GUUfM: } public function messages_array($langify = TRUE) { goto nH7cn; LV5kE: kCerc: goto yyvZZ; lFEPB: zlL8x: goto lZ_OP; nH7cn: if ($langify) { goto kCerc; } goto qz_kB; Ckn0j: return $_output; goto lFEPB; qec7A: foreach ($this->messages as $message) { goto NZSv3; rEwTS: zBOvA: goto FSeNB; lyuIp: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto rEwTS; NZSv3: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\x23\x23"; goto lyuIp; FSeNB: } goto AiXPG; qz_kB: return $this->messages; goto OD83l; OD83l: goto zlL8x; goto LV5kE; yyvZZ: $_output = []; goto qec7A; AiXPG: mpXZa: goto Ckn0j; lZ_OP: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto t2z6t; cDrov: foreach ($this->errors as $error) { goto eeB8u; K7e0T: be9PJ: goto dYroA; lGvpK: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto K7e0T; eeB8u: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\43"; goto lGvpK; dYroA: } goto m5EMi; m5EMi: YZ18W: goto IBKGs; IBKGs: return $_output; goto I6KPO; t2z6t: $_output = ''; goto cDrov; I6KPO: } public function errors_array($langify = TRUE) { goto sJN29; qpuIi: $_output = []; goto VyMYP; mMyyC: return $this->errors; goto gD1Ie; VtQIb: return $_output; goto vSeLT; gD1Ie: goto KuXgc; goto vAILV; sJN29: if ($langify) { goto AD6sh; } goto mMyyC; VyMYP: foreach ($this->errors as $error) { goto xYhl9; JpDc7: fx0Ef: goto NyUXk; OPuuE: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto JpDc7; xYhl9: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\x23\x23"; goto OPuuE; NyUXk: } goto oIYqC; vAILV: AD6sh: goto qpuIi; oIYqC: u26ms: goto VtQIb; vSeLT: KuXgc: goto JfLUL; JfLUL: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto csiTz; pbtVZ: return $this->db->affected_rows() == 1; goto ZSf3F; XBVS8: $data = ["\160\141\163\163\167\157\162\x64" => $hash, "\x72\x65\155\x65\x6d\142\145\162\137\x63\x6f\144\145" => NULL, "\146\x6f\x72\147\157\164\164\145\156\137\x70\141\x73\x73\x77\157\x72\144\137\143\x6f\x64\x65" => NULL, "\x66\x6f\x72\147\x6f\164\x74\145\x6e\x5f\160\x61\163\163\x77\157\162\x64\x5f\x74\x69\155\145" => NULL]; goto hD7wA; RRX9o: yOdlG: goto XBVS8; hD7wA: $this->trigger_events("\145\170\164\x72\141\x5f\x77\150\145\x72\145"); goto NXBY3; NXBY3: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto pbtVZ; wsi3n: if (!($hash === FALSE)) { goto yOdlG; } goto S1fWu; S1fWu: return FALSE; goto RRX9o; csiTz: $hash = $this->hash_password($password, $identity); goto wsi3n; ZSf3F: } protected function _filter_data($table, $data) { goto STyle; aWjbY: return $filtered_data; goto iPJ7P; STyle: $filtered_data = []; goto K42WA; Kaqct: AkeCi: goto aWjbY; Mgiyp: foreach ($columns as $column) { goto udALs; qyulR: FqyWl: goto r9K3l; udALs: if (!array_key_exists($column, $data)) { goto FqyWl; } goto ILJZm; ILJZm: $filtered_data[$column] = $data[$column]; goto qyulR; r9K3l: SlJbR: goto wifal; wifal: } goto h09p2; faiw8: if (!is_array($data)) { goto AkeCi; } goto Mgiyp; h09p2: SCOVC: goto Kaqct; K42WA: $columns = $this->db->list_fields($table); goto faiw8; iPJ7P: } protected function _random_token($result_length = 32) { goto VN0fZ; ksR6K: $result_length = 32; goto g_BSA; MIBwI: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto h8zuS; wrZSt: if (!function_exists("\x6f\160\145\x6e\x73\163\x6c\x5f\162\x61\156\144\157\x6d\x5f\x70\x73\145\165\144\x6f\x5f\142\x79\x74\145\x73")) { goto VLAVz; } goto MIBwI; V37Kf: return FALSE; goto Btrnh; kjydg: HzBB1: goto BlOAq; xt6Sj: W_3Z3: goto wrZSt; jq57_: return bin2hex(random_bytes($result_length / 2)); goto kjydg; VN0fZ: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto VGvvG; } goto ksR6K; g_BSA: VGvvG: goto UB3rt; BlOAq: if (!function_exists("\155\143\x72\x79\x70\x74\137\x63\x72\145\x61\164\145\x5f\x69\x76")) { goto W_3Z3; } goto FGlBm; h8zuS: VLAVz: goto V37Kf; UB3rt: if (!function_exists("\162\x61\x6e\144\x6f\x6d\x5f\x62\171\164\145\163")) { goto HzBB1; } goto jq57_; FGlBm: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto xt6Sj; Btrnh: } protected function _get_hash_parameters($identity = NULL) { goto BPsAw; Tq2AO: switch ($this->hash_method) { case "\142\x63\x72\171\x70\x74": $params = ["\143\x6f\163\164" => $is_admin ? $this->config->item("\142\143\x72\x79\x70\164\137\141\144\x6d\x69\x6e\x5f\143\157\x73\164", "\151\157\156\137\x61\165\164\150") : $this->config->item("\x62\143\162\171\160\164\137\144\x65\146\141\165\x6c\x74\137\x63\x6f\163\164", "\151\x6f\156\137\x61\165\x74\150")]; goto m2j0D; case "\x61\x72\147\157\x6e\62": $params = $is_admin ? $this->config->item("\x61\x72\x67\x6f\156\62\137\141\144\x6d\151\156\x5f\x70\141\162\141\x6d\163", "\x69\x6f\x6e\137\141\x75\164\150") : $this->config->item("\141\162\x67\157\156\x32\137\x64\145\x66\141\165\x6c\x74\x5f\x70\141\162\x61\155\x73", "\x69\x6f\x6e\137\141\x75\164\150"); goto m2j0D; default: } goto rVpyc; zSFHH: $user_id = $this->get_user_id_from_identity($identity); goto pEkUZ; UKdYh: return $params; goto oo0zs; rVpyc: bYL0d: goto cT0Ky; pEkUZ: if (!($user_id && $this->in_group($this->config->item("\x61\x64\155\x69\156\137\147\x72\x6f\165\x70", "\x69\x6f\x6e\137\141\165\x74\x68"), $user_id))) { goto d73tN; } goto FqIJ_; UKPcT: if (!$identity) { goto aL0mo; } goto zSFHH; FqIJ_: $is_admin = TRUE; goto EAJOC; IwB_4: aL0mo: goto qglfq; EAJOC: d73tN: goto IwB_4; BPsAw: $is_admin = FALSE; goto UKPcT; cT0Ky: m2j0D: goto UKdYh; qglfq: $params = FALSE; goto Tq2AO; oo0zs: } protected function _get_hash_algo() { goto baJar; nkhgY: switch ($this->hash_method) { case "\142\x63\x72\171\x70\x74": $algo = PASSWORD_BCRYPT; goto pv5ea; case "\x61\x72\x67\157\x6e\x32": $algo = PASSWORD_ARGON2I; goto pv5ea; default: } goto qt3z7; LMP6W: pv5ea: goto vzOkX; baJar: $algo = FALSE; goto nkhgY; vzOkX: return $algo; goto bJhNq; qt3z7: m_rhU: goto LMP6W; bJhNq: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto WFoAp; oK8QG: $validator = $this->_random_token($validator_size); goto vQ7MY; WFoAp: $selector = $this->_random_token($selector_size); goto oK8QG; vQ7MY: $validator_hashed = $this->hash_password($validator); goto CtIHe; IkDH3: return (object) ["\163\145\154\145\x63\x74\157\162" => $selector, "\x76\x61\x6c\151\144\x61\x74\x6f\162\x5f\150\x61\163\150\145\x64" => $validator_hashed, "\165\x73\145\x72\x5f\x63\x6f\x64\145" => $user_code]; goto dyt0P; CtIHe: $user_code = "{$selector}\x2e{$validator}"; goto IkDH3; dyt0P: } protected function _retrieve_selector_validator_couple($user_code) { goto O2HaV; O2HaV: if (!$user_code) { goto W8CU2; } goto dlIL8; a8JAY: return (object) ["\x73\145\x6c\x65\x63\164\x6f\x72" => $tokens[0], "\166\141\x6c\151\x64\141\164\x6f\162" => $tokens[1]]; goto nFJVC; s6Ofp: W8CU2: goto NnTuS; NnTuS: return FALSE; goto T8KeM; nFJVC: l6T19: goto s6Ofp; WIc4v: if (!(count($tokens) === 2)) { goto l6T19; } goto a8JAY; dlIL8: $tokens = explode("\56", $user_code); goto WIc4v; T8KeM: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto vOWXb; WMvtQ: $result = $this->_set_password_db($identity, $password); goto Zz4Ld; dHjQi: BXum8: goto WMvtQ; nO9a3: return FALSE; goto FFZlS; ZS8uJ: FzOO6: goto eplFt; Y2df5: return FALSE; goto PmnJu; RAgxU: $this->trigger_events(["\x70\x6f\163\x74\137\163\150\141\x31\137\x70\x61\x73\163\167\157\162\x64\137\x6d\x69\x67\x72\x61\164\151\157\x6e", "\160\157\x73\164\137\x73\x68\x61\61\x5f\160\x61\x73\x73\x77\x6f\162\x64\x5f\x6d\151\147\x72\x61\x74\151\157\156\137\165\156\x73\165\143\x63\x65\x73\x73\x66\x75\x6c"]); goto Y2df5; gDWgo: Sj1_e: goto RPoU1; xooL4: if (!($query->num_rows() !== 1)) { goto CpMCn; } goto RAgxU; hPYsg: $this->trigger_events(["\x70\157\x73\x74\137\x73\x68\x61\61\137\160\141\163\163\x77\157\x72\x64\x5f\x6d\x69\147\162\141\x74\151\157\x6e", "\x70\157\x73\x74\x5f\x73\x68\141\61\x5f\x70\x61\163\163\167\x6f\162\x64\x5f\155\151\147\x72\141\x74\151\x6f\x6e\x5f\x75\156\163\165\143\143\x65\163\163\x66\165\x6c"]); goto nO9a3; iyM6B: $hashed_password = sha1($password . $salt_db->salt); goto gDWgo; RPoU1: if ($hashed_password === $hashed_password_db) { goto BXum8; } goto hPYsg; SrGKL: $this->trigger_events(["\160\x6f\x73\164\x5f\163\150\141\x31\x5f\x70\141\163\x73\167\157\x72\144\137\x6d\x69\147\x72\x61\x74\151\x6f\x6e", "\x70\157\x73\x74\x5f\x73\150\141\x31\137\160\x61\x73\163\x77\157\x72\144\x5f\x6d\151\x67\162\141\x74\151\157\x6e\137\165\156\x73\165\x63\x63\x65\163\163\146\x75\154"]); goto zuchr; SlJv_: $salt_length = $this->config->item("\163\x61\x6c\x74\x5f\154\145\x6e\147\164\x68", "\151\x6f\x6e\137\x61\x75\164\x68"); goto IP2w_; pqk5v: $query = $this->db->select("\x73\x61\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\162\163"]); goto HU5wo; WKe1f: DD0Uc: goto pqk5v; DsE1o: $this->trigger_events(["\x70\157\163\x74\137\163\150\141\x31\x5f\160\141\x73\x73\167\x6f\x72\144\137\155\x69\147\x72\141\164\151\157\156", "\160\157\163\x74\137\x73\x68\x61\61\x5f\160\x61\163\x73\167\157\x72\x64\x5f\x6d\151\147\162\x61\x74\151\157\156\x5f\165\x6e\163\165\143\143\145\163\163\146\x75\154"]); goto DHEmU; AddEu: return $result; goto czsJS; DHEmU: goto SmWws; goto Vo9gH; vOWXb: $this->trigger_events("\160\x72\145\x5f\x73\150\141\x31\x5f\x70\x61\163\x73\167\157\162\x64\137\155\151\x67\x72\141\164\151\157\x6e"); goto LMqC7; FFZlS: goto CmQu6; goto dHjQi; E9nRO: $this->trigger_events(["\x70\157\x73\x74\137\x73\150\x61\x31\x5f\x70\x61\x73\163\167\157\162\x64\x5f\155\x69\147\x72\141\164\151\157\x6e", "\x70\x6f\x73\x74\137\x73\x68\141\61\x5f\x70\x61\x73\163\167\x6f\162\x64\137\x6d\151\147\x72\x61\x74\x69\157\x6e\x5f\163\165\x63\143\x65\163\163\x66\x75\154"]); goto a4z5n; a4z5n: SmWws: goto AddEu; HU5wo: $salt_db = $query->row(); goto xooL4; czsJS: CmQu6: goto uMd5s; hRe7Q: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto JZ1PR; Zz4Ld: if ($result) { goto xD5ft; } goto DsE1o; zuchr: return FALSE; goto ZS8uJ; Vo9gH: xD5ft: goto E9nRO; IP2w_: if ($salt_length) { goto FzOO6; } goto SrGKL; LMqC7: if ($this->config->item("\163\164\x6f\162\x65\x5f\163\x61\x6c\x74", "\151\x6f\156\137\x61\165\x74\x68")) { goto DD0Uc; } goto SlJv_; PmnJu: CpMCn: goto iyM6B; eplFt: $salt = substr($hashed_password_db, 0, $salt_length); goto hRe7Q; JZ1PR: goto Sj1_e; goto WKe1f; uMd5s: } }
