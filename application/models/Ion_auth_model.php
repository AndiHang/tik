<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\105\x50\101\124\x48") or exit("\116\157\x20\144\151\x72\x65\143\x74\x20\163\143\x72\x69\160\x74\40\141\x63\143\x65\163\x73\40\x61\154\x6c\x6f\167\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto svOwG; ETbD4: $this->trigger_events("\x6d\x6f\x64\x65\x6c\137\x63\x6f\x6e\x73\164\162\x75\143\164\x6f\x72"); goto tjVig; zUGvC: $group_name = $this->config->item("\x64\x61\x74\x61\x62\141\x73\x65\137\147\x72\x6f\x75\x70\137\x6e\x61\155\145", "\151\157\x6e\137\x61\165\164\150"); goto RkV3H; CLigY: $this->errors = []; goto DSKkF; SAYPJ: $CI =& get_instance(); goto rZL_R; pb_d5: $this->messages = []; goto CLigY; svOwG: $this->config->load("\151\x6f\x6e\x5f\141\165\164\x68", TRUE); goto a6nn8; YwEZF: $error_suffix->setAccessible(TRUE); goto hllfy; Q_a3r: $this->message_start_delimiter = $this->config->item("\155\x65\x73\163\141\147\x65\137\163\x74\141\x72\164\x5f\x64\145\154\151\155\151\164\145\162", "\151\x6f\156\137\x61\x75\x74\150"); goto djxqp; djxqp: $this->message_end_delimiter = $this->config->item("\x6d\x65\x73\163\141\147\x65\137\x65\156\144\x5f\144\x65\154\151\x6d\151\x74\145\x72", "\151\157\x6e\x5f\141\165\x74\x68"); goto NqxKk; hoIF2: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\x72\x6f\x72\x5f\163\x75\146\146\x69\x78"); goto YwEZF; DSKkF: $delimiters_source = $this->config->item("\144\145\154\x69\x6d\151\164\145\x72\x73\137\163\x6f\x75\x72\x63\145", "\151\157\x6e\137\x61\165\x74\x68"); goto uy2ut; xk_EO: goto USWuN; goto fIUYn; a6nn8: $this->load->helper("\143\x6f\157\x6b\x69\x65"); goto C91i_; RkV3H: if (empty($group_name)) { goto NKxC3; } goto n7GkJ; hllfy: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto ybheN; eu6__: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto uw22d; C91i_: $this->load->helper("\144\x61\x74\x65"); goto ORyBC; lw83k: $this->load->library("\x66\157\162\155\137\x76\141\x6c\x69\x64\x61\x74\151\x6f\156"); goto ZmevA; NqxKk: $this->error_start_delimiter = $this->config->item("\145\x72\x72\x6f\162\x5f\163\164\x61\162\164\137\144\x65\154\151\x6d\x69\164\145\x72", "\151\157\156\x5f\x61\x75\164\x68"); goto ZQWII; n7GkJ: $this->db = $this->load->database($group_name, TRUE, TRUE); goto SMIv_; ZQWII: $this->error_end_delimiter = $this->config->item("\x65\162\162\x6f\162\137\145\156\x64\137\144\145\154\x69\x6d\151\x74\145\x72", "\x69\157\156\137\141\165\164\150"); goto xk_EO; DFX09: FHdGH: goto E5GVm; uw22d: $this->message_start_delimiter = $this->error_start_delimiter; goto hoIF2; XAYMJ: $this->hash_method = $this->config->item("\150\141\x73\150\137\x6d\145\x74\x68\x6f\x64", "\x69\157\x6e\137\x61\165\164\x68"); goto pb_d5; ZmevA: $form_validation_class = new ReflectionClass("\103\111\x5f\106\x6f\x72\155\x5f\x76\141\154\151\x64\141\x74\151\157\156"); goto BQmBF; sDEAr: NKxC3: goto SAYPJ; E5GVm: $this->tables = $this->config->item("\x74\141\x62\154\145\163", "\151\157\156\137\141\x75\x74\150"); goto g2MIQ; g2MIQ: $this->identity_column = $this->config->item("\151\x64\x65\156\164\151\164\171", "\x69\x6f\156\x5f\141\x75\x74\x68"); goto UQtqX; ybheN: $this->message_end_delimiter = $this->error_end_delimiter; goto hNKs2; rDrtE: $this->_ion_hooks = new stdClass(); goto ETbD4; SMIv_: goto FHdGH; goto sDEAr; rZL_R: $this->db = $CI->db; goto DFX09; qrbQv: $error_prefix->setAccessible(TRUE); goto eu6__; ORyBC: $this->lang->load("\151\157\156\137\x61\165\x74\150"); goto zUGvC; fIUYn: OFXiI: goto lw83k; BQmBF: $error_prefix = $form_validation_class->getProperty("\137\145\162\162\157\x72\137\160\162\x65\146\x69\x78"); goto qrbQv; UQtqX: $this->join = $this->config->item("\x6a\157\x69\156", "\x69\x6f\156\x5f\x61\x75\x74\150"); goto XAYMJ; hNKs2: USWuN: goto rDrtE; uy2ut: if ($delimiters_source === "\146\157\x72\155\x5f\x76\141\154\x69\144\141\164\151\157\x6e") { goto OFXiI; } goto Q_a3r; tjVig: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto wba4T; ATEVY: return FALSE; goto Le_EM; PoP7K: $algo = $this->_get_hash_algo(); goto x0afJ; Le_EM: r0bjl: goto PoP7K; I_tja: return FALSE; goto lr5qM; pWoe0: loX5J: goto I_tja; Hg22d: return password_hash($password, $algo, $params); goto pWoe0; wba4T: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto r0bjl; } goto ATEVY; x0afJ: $params = $this->_get_hash_parameters($identity); goto rS_p8; rS_p8: if (!($algo !== FALSE && $params !== FALSE)) { goto loX5J; } goto Hg22d; lr5qM: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto dTcbg; Lv0of: return FALSE; goto xFAgF; du_eN: HY8FP: goto WJ373; xFAgF: FAehm: goto BmkUB; BmkUB: if (strpos($hash_password_db, "\44") === 0) { goto OuylH; } goto H6CzP; oBPm9: goto HY8FP; goto Ir31N; Ir31N: OuylH: goto y0mZ7; H6CzP: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto oBPm9; dTcbg: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto FAehm; } goto Lv0of; y0mZ7: return password_verify($password, $hash_password_db); goto du_eN; WJ373: } public function rehash_password_if_needed($hash, $identity, $password) { goto s_LfL; YUOtu: XTTR7: goto gOoo0; gOoo0: Y6_CK: goto UGome; cGxu4: if (!($algo !== FALSE && $params !== FALSE)) { goto SnOj_; } goto JTu6I; dDz6R: if ($this->_set_password_db($identity, $password)) { goto IGmjQ; } goto jfuH7; sokUe: goto XTTR7; goto fP5uj; JTu6I: if (!password_needs_rehash($hash, $algo, $params)) { goto Y6_CK; } goto dDz6R; s_LfL: $algo = $this->_get_hash_algo(); goto VhQeV; UGome: SnOj_: goto pZCl3; VhQeV: $params = $this->_get_hash_parameters($identity); goto cGxu4; eHUPF: $this->trigger_events(["\x72\145\150\141\x73\150\137\x70\x61\x73\163\167\x6f\162\144", "\x72\x65\150\141\163\150\x5f\x70\141\163\x73\167\x6f\162\144\137\163\165\x63\143\145\163\x73\146\x75\154"]); goto YUOtu; jfuH7: $this->trigger_events(["\x72\x65\x68\x61\163\150\x5f\x70\x61\163\163\167\157\162\x64", "\x72\x65\x68\x61\163\150\137\160\141\163\163\167\x6f\x72\144\137\165\x6e\163\165\143\143\x65\163\x73\x66\x75\154"]); goto sokUe; fP5uj: IGmjQ: goto eHUPF; pZCl3: } public function get_user_by_activation_code($user_code) { goto jIqPS; QXZ74: if (!$this->verify_password($token->validator, $user->activation_code)) { goto ZqUHv; } goto R2N8D; QLSQd: ZqUHv: goto trXvD; wQUhJ: return FALSE; goto NRjbS; jIqPS: $token = $this->_retrieve_selector_validator_couple($user_code); goto cTyjq; R2N8D: return $user; goto QLSQd; cTyjq: $user = $this->where("\141\x63\x74\x69\x76\141\x74\x69\x6f\156\137\163\145\x6c\145\x63\x74\157\x72", $token->selector)->users()->row(); goto drNGX; drNGX: if (!$user) { goto rLLPj; } goto QXZ74; trXvD: rLLPj: goto wQUhJ; NRjbS: } public function activate($id, $code = FALSE) { goto Erbvk; UOtPG: if (!($code === FALSE || $user && $user->id === $id)) { goto f88ob; } goto AgdS1; In0Af: $this->db->update($this->tables["\x75\x73\145\x72\163"], $data, ["\151\144" => $id]); goto Bb0iy; idB2Y: f88ob: goto iYjVE; AgdS1: $data = ["\x61\x63\x74\151\x76\141\164\151\157\156\x5f\163\145\154\x65\x63\x74\x6f\x72" => NULL, "\x61\x63\x74\x69\166\x61\164\151\157\156\137\x63\x6f\x64\x65" => NULL, "\141\x63\164\151\x76\145" => 1]; goto EZ9wQ; BAUrf: $this->trigger_events(["\x70\x6f\163\x74\x5f\x61\143\164\151\x76\141\164\x65", "\160\x6f\163\164\137\141\x63\164\x69\166\x61\164\145\x5f\163\x75\143\143\x65\x73\163\146\x75\154"]); goto ikAI5; Bb0iy: if (!($this->db->affected_rows() === 1)) { goto rDZ2U; } goto BAUrf; ikAI5: $this->set_message("\x61\143\x74\151\x76\141\164\x65\137\163\x75\x63\x63\x65\x73\x73\146\x75\154"); goto A35jx; sQ596: if (!($code !== FALSE)) { goto ZDzXC; } goto xUWzw; HJhfo: ZDzXC: goto UOtPG; A35jx: return TRUE; goto GcsMX; Xlwgz: $this->set_error("\x61\x63\x74\151\x76\141\x74\145\x5f\x75\x6e\163\x75\143\143\145\163\163\x66\165\x6c"); goto zHcQy; GcsMX: rDZ2U: goto idB2Y; EZ9wQ: $this->trigger_events("\x65\x78\x74\162\141\x5f\x77\150\145\162\x65"); goto In0Af; iYjVE: $this->trigger_events(["\160\x6f\x73\x74\137\141\x63\164\151\x76\x61\164\145", "\160\x6f\163\x74\137\141\x63\x74\151\x76\141\x74\x65\x5f\x75\156\x73\165\143\x63\x65\x73\x73\x66\165\x6c"]); goto Xlwgz; Erbvk: $this->trigger_events("\x70\162\x65\x5f\141\143\164\151\166\141\164\x65"); goto sQ596; xUWzw: $user = $this->get_user_by_activation_code($code); goto HJhfo; zHcQy: return FALSE; goto hmg03; hmg03: } public function deactivate($id = NULL) { goto jbd1q; QARQ7: L5rTx: goto y8HIa; wktMx: if (!isset($id)) { goto XAGlO; } goto ab2E5; jf0ff: $data = ["\x61\x63\164\151\x76\x61\x74\151\157\156\x5f\x73\145\x6c\x65\x63\x74\157\x72" => $token->selector, "\x61\x63\164\151\166\141\x74\x69\157\156\137\143\x6f\144\x65" => $token->validator_hashed, "\141\x63\x74\x69\166\x65" => 0]; goto lm_RI; x3hog: pOgOo: goto rg95T; f3RVB: $return = $this->db->affected_rows() == 1; goto cLQh_; xzehK: return FALSE; goto YhF01; YhF01: FNwEx: goto sI0Dv; LJFCR: $this->set_error("\144\145\x61\143\164\151\166\x61\164\145\x5f\165\156\x73\x75\143\143\145\163\163\x66\165\x6c"); goto vN7pY; i5DgE: $this->activation_code = $token->user_code; goto jf0ff; MnahO: wILiF: goto jRftl; jbd1q: $this->trigger_events("\x64\x65\141\143\164\151\166\141\164\x65"); goto wktMx; wJaTC: return FALSE; goto x3hog; lm_RI: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\167\x68\145\x72\145"); goto RBPU7; sI0Dv: $token = $this->_generate_selector_validator_couple(20, 40); goto i5DgE; iyJkE: XAGlO: goto u6kBC; O7VQp: $this->set_error("\x64\x65\141\x63\x74\x69\x76\141\164\145\x5f\x63\165\162\162\145\156\164\x5f\165\163\145\x72\x5f\165\x6e\163\165\143\143\145\x73\163\146\x75\x6c"); goto wJaTC; RBPU7: $this->db->update($this->tables["\x75\163\x65\162\x73"], $data, ["\151\x64" => $id]); goto f3RVB; rg95T: goto FNwEx; goto iyJkE; cLQh_: if ($return) { goto L5rTx; } goto LJFCR; u6kBC: $this->set_error("\x64\145\x61\x63\164\151\166\x61\164\145\137\165\x6e\x73\165\x63\x63\x65\163\163\146\165\154"); goto xzehK; vN7pY: goto wILiF; goto QARQ7; y8HIa: $this->set_message("\144\145\141\143\164\151\x76\141\164\x65\x5f\163\165\143\x63\x65\x73\163\146\x75\x6c"); goto MnahO; ab2E5: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto pOgOo; } goto O7VQp; jRftl: return $return; goto JYG7R; JYG7R: } public function clear_forgotten_password_code($identity) { goto th91N; kJ5rc: return FALSE; goto jUn2i; xAN0d: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto ZDC8V; th91N: if (!empty($identity)) { goto rLwnQ; } goto kJ5rc; tFR5U: $data = ["\x66\x6f\x72\x67\x6f\164\164\x65\x6e\137\x70\x61\x73\163\x77\x6f\162\x64\x5f\163\145\x6c\145\x63\164\157\x72" => NULL, "\146\157\162\147\x6f\164\x74\x65\156\x5f\160\x61\x73\163\x77\x6f\162\x64\x5f\x63\x6f\144\145" => NULL, "\146\x6f\162\147\x6f\x74\x74\x65\156\137\160\141\x73\x73\167\157\162\x64\137\x74\x69\155\145" => NULL]; goto xAN0d; ZDC8V: return TRUE; goto Yy6rR; jUn2i: rLwnQ: goto tFR5U; Yy6rR: } public function clear_remember_code($identity) { goto DldvH; Q5rvr: return FALSE; goto DKKDS; DldvH: if (!empty($identity)) { goto Dt172; } goto Q5rvr; DKKDS: Dt172: goto z8gnz; wBQhT: return TRUE; goto iL3QM; z8gnz: $data = ["\x72\145\155\145\155\142\145\162\x5f\163\145\154\x65\x63\x74\x6f\x72" => NULL, "\162\145\155\x65\155\142\145\x72\137\143\x6f\144\145" => NULL]; goto HEWUp; HEWUp: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto wBQhT; iL3QM: } public function reset_password($identity, $new) { goto d4oIL; hoKJW: $this->trigger_events(["\x70\157\x73\164\137\143\x68\141\156\x67\x65\137\160\x61\x73\163\167\157\162\144", "\160\x6f\x73\x74\137\143\150\141\156\147\145\137\x70\x61\x73\x73\167\x6f\162\x64\x5f\163\165\143\x63\x65\x73\163\x66\165\x6c"]); goto ejuP2; hQIPy: if ($return) { goto kZJRu; } goto tJPKT; TODNS: ReD_Z: goto fHKQ5; ejuP2: $this->set_message("\160\x61\x73\x73\167\x6f\162\144\x5f\x63\150\141\156\x67\145\137\x73\165\x63\143\145\163\163\146\165\x6c"); goto mUlLW; fHKQ5: $return = $this->_set_password_db($identity, $new); goto hQIPy; tJPKT: $this->trigger_events(["\160\x6f\x73\x74\137\143\150\141\x6e\x67\x65\137\x70\x61\x73\163\167\x6f\x72\x64", "\160\x6f\163\x74\137\x63\x68\141\x6e\147\x65\137\160\x61\163\163\x77\x6f\x72\144\137\x75\x6e\163\x75\x63\x63\145\163\163\x66\x75\x6c"]); goto CQQou; d4oIL: $this->trigger_events("\160\162\x65\137\143\150\x61\156\147\x65\x5f\x70\x61\x73\163\x77\x6f\x72\144"); goto iu0FZ; CQQou: $this->set_error("\160\141\163\x73\x77\157\162\144\137\x63\x68\x61\156\147\x65\137\165\x6e\163\165\x63\143\x65\163\x73\146\165\x6c"); goto VXEol; ny5ZS: return FALSE; goto TODNS; iu0FZ: if ($this->identity_check($identity)) { goto ReD_Z; } goto RMmq8; VXEol: goto ABxuf; goto OZ58N; mUlLW: ABxuf: goto wcpb1; wcpb1: return $return; goto ghuVv; RMmq8: $this->trigger_events(["\x70\157\x73\164\137\x63\x68\x61\156\x67\145\x5f\x70\x61\163\x73\167\x6f\x72\144", "\x70\x6f\x73\164\137\143\150\141\156\x67\x65\137\160\x61\163\163\x77\x6f\x72\144\137\x75\156\x73\165\x63\x63\x65\x73\x73\x66\x75\x6c"]); goto ny5ZS; OZ58N: kZJRu: goto hoKJW; ghuVv: } public function change_password($identity, $old, $new) { goto jQvBH; xkV29: E0E1g: goto fryAV; MpDH_: return FALSE; goto vT3jk; sfQdX: $user = $query->row(); goto l5MUf; k342Z: $this->set_error("\160\x61\163\163\167\157\162\x64\137\143\150\x61\x6e\147\x65\x5f\x75\156\x73\x75\x63\143\145\x73\x73\146\x75\x6c"); goto ZoBi6; ZoBi6: goto trt_d; goto hB7qv; PLrIx: return $result; goto xkV29; xIHmq: $query = $this->db->select("\x69\x64\54\40\160\x61\163\163\167\x6f\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\145\163\143")->get($this->tables["\165\x73\x65\x72\163"]); goto GMmd3; l5MUf: if (!$this->verify_password($old, $user->password, $identity)) { goto E0E1g; } goto WzOQZ; Xgiad: $this->set_message("\160\x61\x73\x73\167\157\x72\144\137\143\x68\141\x6e\147\x65\137\x73\x75\x63\143\x65\x73\163\x66\x75\x6c"); goto iMpQm; fryAV: $this->set_error("\x70\141\x73\163\x77\x6f\162\x64\137\x63\150\x61\156\x67\145\x5f\165\x6e\163\165\143\x63\145\163\163\146\x75\x6c"); goto esCH9; geYdQ: $this->trigger_events(["\160\x6f\x73\164\137\x63\x68\141\x6e\147\x65\137\x70\141\x73\163\x77\157\162\144", "\160\x6f\163\164\x5f\143\150\x61\x6e\x67\x65\x5f\160\141\163\x73\x77\157\162\144\x5f\163\165\143\143\145\x73\x73\x66\165\154"]); goto Xgiad; Vrw2k: $this->trigger_events(["\x70\157\x73\164\x5f\143\x68\141\156\x67\145\137\160\x61\163\x73\167\157\x72\x64", "\x70\157\x73\x74\137\x63\x68\141\156\x67\x65\137\160\141\163\163\167\157\x72\144\137\x75\x6e\x73\165\143\143\x65\x73\163\x66\x75\x6c"]); goto k342Z; WzOQZ: $result = $this->_set_password_db($identity, $new); goto s6iTs; uwshi: $this->set_error("\x70\x61\x73\163\167\157\x72\144\x5f\x63\x68\141\x6e\147\x65\137\x75\x6e\x73\165\x63\143\145\x73\163\146\165\154"); goto MpDH_; hB7qv: UM3tT: goto geYdQ; s6iTs: if ($result) { goto UM3tT; } goto Vrw2k; vT3jk: IhRvO: goto sfQdX; esCH9: return FALSE; goto KtfJJ; GMmd3: if (!($query->num_rows() !== 1)) { goto IhRvO; } goto uVnyq; iMpQm: trt_d: goto PLrIx; uVnyq: $this->trigger_events(["\x70\x6f\163\x74\x5f\143\x68\141\156\147\x65\137\160\141\x73\x73\167\157\162\x64", "\x70\157\163\164\x5f\x63\150\141\x6e\147\145\137\x70\x61\163\163\x77\157\x72\144\x5f\x75\156\x73\x75\x63\x63\145\163\163\146\165\x6c"]); goto uwshi; PZoy5: $this->trigger_events("\x65\x78\x74\162\141\137\x77\150\145\162\145"); goto xIHmq; jQvBH: $this->trigger_events("\x70\x72\145\x5f\143\150\x61\156\x67\145\x5f\160\141\x73\163\167\157\x72\x64"); goto PZoy5; KtfJJ: } public function username_check($username = '') { goto lpSDa; lpSDa: $this->trigger_events("\165\x73\x65\x72\156\141\155\145\137\x63\150\145\143\153"); goto mu0RG; uL8UZ: hCHHQ: goto zgCyx; vf2ER: return $this->db->where("\x75\x73\x65\x72\156\x61\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\165\x73\145\162\163"]) > 0; goto qfQCn; zgCyx: $this->trigger_events("\145\170\x74\x72\x61\x5f\167\x68\145\x72\x65"); goto vf2ER; mu0RG: if (!empty($username)) { goto hCHHQ; } goto Go9qB; Go9qB: return FALSE; goto uL8UZ; qfQCn: } public function email_check($email = '') { goto gIXs0; k3Lnh: if (!empty($email)) { goto ijwss; } goto BkBB7; IkoMa: $this->trigger_events("\145\x78\164\162\141\x5f\x77\150\x65\162\x65"); goto b_kYg; BkBB7: return FALSE; goto Rzv_2; Rzv_2: ijwss: goto IkoMa; gIXs0: $this->trigger_events("\145\155\141\151\154\137\143\x68\145\143\x6b"); goto k3Lnh; b_kYg: return $this->db->where("\145\155\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\x73"]) > 0; goto tq0OW; tq0OW: } public function identity_check($identity = '') { goto s3Oxd; QJOjv: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\145\162\163"]) > 0; goto fZbkW; w60NO: return FALSE; goto QPyx3; QPyx3: Th3pQ: goto QJOjv; s3Oxd: $this->trigger_events("\151\x64\145\156\x74\151\x74\171\x5f\x63\150\145\x63\x6b"); goto xwfrJ; xwfrJ: if (!empty($identity)) { goto Th3pQ; } goto w60NO; fZbkW: } public function get_user_id_from_identity($identity = '') { goto aFNx0; rw6Fk: if (!($query->num_rows() !== 1)) { goto cKsBs; } goto e_SnW; CT3ti: $query = $this->db->select("\x69\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\x72\163"]); goto rw6Fk; q6j3H: return $user->id; goto qZuNX; aFNx0: if (!empty($identity)) { goto iZWjF; } goto lcZua; GohtZ: $user = $query->row(); goto q6j3H; e_SnW: return FALSE; goto ERYpP; lcZua: return FALSE; goto TnqgX; TnqgX: iZWjF: goto CT3ti; ERYpP: cKsBs: goto GohtZ; qZuNX: } public function forgotten_password($identity) { goto w4_6A; EpFCJ: $update = ["\146\157\x72\147\x6f\164\164\145\156\x5f\x70\141\x73\163\x77\x6f\162\144\x5f\x73\145\x6c\145\143\x74\157\162" => $token->selector, "\146\157\x72\x67\x6f\164\x74\145\156\137\x70\141\163\x73\167\x6f\x72\144\137\x63\157\x64\145" => $token->validator_hashed, "\146\x6f\162\147\157\x74\164\x65\x6e\137\x70\141\163\x73\167\157\162\x64\x5f\164\x69\x6d\145" => time()]; goto MNxRu; w4_6A: if (!empty($identity)) { goto a1VZH; } goto INeSY; luHy1: goto di1tg; goto GRfGz; cTY7P: $this->trigger_events(["\160\x6f\163\164\x5f\146\157\162\147\157\x74\x74\145\156\x5f\160\x61\163\163\167\x6f\x72\x64", "\x70\157\x73\164\x5f\x66\157\162\x67\157\164\x74\x65\x6e\137\160\141\x73\x73\167\x6f\x72\144\x5f\x73\165\x63\x63\x65\163\x73\x66\x75\x6c"]); goto OO7BG; MNxRu: $this->trigger_events("\145\x78\164\x72\141\x5f\167\x68\145\x72\145"); goto L6pA0; MFK6i: di1tg: goto Q7OdQ; OO7BG: return $token->user_code; goto MFK6i; INeSY: $this->trigger_events(["\160\157\163\164\x5f\x66\x6f\x72\147\x6f\x74\164\145\x6e\137\160\141\163\163\x77\157\x72\x64", "\x70\x6f\163\x74\137\x66\157\x72\147\x6f\164\164\x65\156\137\160\141\163\163\x77\157\x72\144\x5f\165\x6e\163\x75\x63\143\145\163\163\146\165\x6c"]); goto h2vd3; BgPsi: if ($this->db->affected_rows() === 1) { goto kPlM7; } goto uUc9i; GRfGz: kPlM7: goto cTY7P; L6pA0: $this->db->update($this->tables["\x75\x73\x65\162\163"], $update, [$this->identity_column => $identity]); goto BgPsi; uUc9i: $this->trigger_events(["\160\157\163\x74\x5f\x66\157\162\x67\x6f\x74\164\145\x6e\x5f\160\141\x73\x73\x77\x6f\x72\x64", "\160\157\163\x74\x5f\x66\x6f\162\x67\157\164\x74\145\x6e\137\x70\141\163\163\x77\157\162\144\x5f\x75\x6e\x73\165\143\x63\x65\x73\163\146\165\x6c"]); goto P3I3f; UxA6o: a1VZH: goto oJqC1; oJqC1: $token = $this->_generate_selector_validator_couple(20, 80); goto EpFCJ; h2vd3: return FALSE; goto UxA6o; P3I3f: return FALSE; goto luHy1; Q7OdQ: } public function get_user_by_forgotten_password_code($user_code) { goto Ub__t; Mpi2d: $user = $this->where("\146\x6f\162\x67\x6f\164\x74\145\156\x5f\160\141\163\x73\x77\x6f\162\144\137\163\x65\154\x65\x63\x74\x6f\x72", $token->selector)->users()->row(); goto Q7VAk; J7H24: XX3wX: goto lkPmQ; lkPmQ: return FALSE; goto fey4x; Ub__t: $token = $this->_retrieve_selector_validator_couple($user_code); goto Mpi2d; KcnQs: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto p8dIO; } goto CYFDR; Q7VAk: if (!$user) { goto XX3wX; } goto KcnQs; CYFDR: return $user; goto YA4yj; YA4yj: p8dIO: goto J7H24; fey4x: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto C2A7k; kudWS: if ($this->identity_check($identity)) { goto F5cQB; } goto GGAmS; Zwlt7: if (!(!isset($query->id) && empty($groups))) { goto J32s0; } goto CnRTT; uEEpr: goto m4j1e; goto tvxBL; KBnlt: $groups[] = $default_group->id; goto smhKG; YH7U8: $this->set_error("\141\x63\143\x6f\165\x6e\164\x5f\143\x72\145\141\x74\x69\157\x6e\137\x75\x6e\163\165\x63\x63\x65\163\x73\146\165\x6c"); goto Elhv2; oIItA: $manual_activation = $this->config->item("\155\141\x6e\165\x61\x6c\137\141\x63\x74\151\x76\x61\164\151\157\156", "\151\x6f\x6e\x5f\x61\x75\164\150"); goto kudWS; H6Uil: sDx1z: goto vh3si; xBIXf: $this->trigger_events("\x70\157\163\x74\137\x72\145\x67\151\x73\164\145\x72"); goto qyNh2; zPtmI: return FALSE; goto d0W8i; QtihX: $this->db->insert($this->tables["\165\163\x65\162\x73"], $user_data); goto Thu_i; OkWQ7: if (!(isset($default_group->id) && empty($groups))) { goto WrtH1; } goto KBnlt; Hcewy: m4j1e: goto yNnbX; kkGMh: if (empty($groups)) { goto tP9SB; } goto xPFa5; C2A7k: $this->trigger_events("\160\162\x65\x5f\162\x65\x67\x69\163\x74\x65\x72"); goto oIItA; xPFa5: foreach ($groups as $group) { $this->add_to_group($group, $id); WZkHT: } goto QA3Na; oSXaS: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\145\162\x73"], $additional_data), $data); goto DP5RN; q_zAf: $this->set_error("\x61\143\143\157\165\156\164\x5f\x63\162\x65\x61\x74\151\x6f\156\137\144\x75\x70\154\x69\143\x61\x74\x65\x5f\151\144\145\156\164\151\x74\x79"); goto d0vPQ; d0W8i: LCEGa: goto uEEpr; Pu0Fo: $default_group = $query; goto qNh9Y; cQXTf: $password = $this->hash_password($password); goto ACABl; GGAmS: if (!(!$this->config->item("\144\x65\146\141\165\154\x74\x5f\147\x72\157\x75\160", "\x69\x6f\x6e\x5f\x61\x75\164\150") && empty($groups))) { goto LCEGa; } goto zmmpO; qyNh2: return isset($id) ? $id : FALSE; goto S5UwN; Thu_i: $id = $this->db->insert_id($this->tables["\x75\163\x65\x72\x73"] . "\x5f\x69\x64\137\x73\145\161"); goto OkWQ7; DP5RN: $this->trigger_events("\145\170\x74\162\141\x5f\163\x65\x74"); goto QtihX; r0QTg: tP9SB: goto xBIXf; QA3Na: B3Q9C: goto r0QTg; vh3si: $data = [$this->identity_column => $identity, "\x75\163\145\x72\156\141\155\145" => $identity, "\x70\141\163\x73\167\157\162\144" => $password, "\x65\x6d\x61\151\x6c" => $email, "\151\x70\x5f\141\x64\144\162\145\163\x73" => $ip_address, "\143\162\145\141\164\x65\x64\x5f\x6f\x6e" => time(), "\141\x63\164\x69\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto oSXaS; zmmpO: $this->set_error("\141\143\x63\x6f\165\156\x74\137\x63\x72\x65\141\164\151\x6f\156\137\155\x69\x73\163\151\x6e\147\137\144\x65\146\141\x75\x6c\x74\137\147\x72\157\x75\160"); goto zPtmI; d0vPQ: return FALSE; goto Hcewy; ACABl: if (!($password === FALSE)) { goto sDx1z; } goto YH7U8; qNh9Y: $ip_address = $this->input->ip_address(); goto cQXTf; tvxBL: F5cQB: goto q_zAf; CnRTT: $this->set_error("\x61\x63\143\x6f\x75\x6e\x74\x5f\x63\x72\x65\x61\x74\x69\x6f\156\137\151\156\x76\141\x6c\151\x64\137\x64\145\x66\x61\x75\154\x74\137\147\x72\157\165\x70"); goto GsDFo; Elhv2: return FALSE; goto H6Uil; GsDFo: return FALSE; goto AYa6g; AYa6g: J32s0: goto Pu0Fo; smhKG: WrtH1: goto kkGMh; yNnbX: $query = $this->db->get_where($this->tables["\x67\x72\157\x75\160\x73"], ["\156\141\155\145" => $this->config->item("\144\145\146\141\165\154\x74\x5f\147\162\157\165\160", "\x69\x6f\156\137\x61\x75\164\x68")], 1)->row(); goto Zwlt7; S5UwN: } public function login($identity, $password, $remember = FALSE) { goto TORB8; s1_Qp: $user = $query->row(); goto GBjr_; EPx6V: return FALSE; goto N089s; mwtRb: $query = $this->db->select($this->identity_column . "\x2c\40\145\155\x61\x69\154\54\x20\151\144\54\40\x70\x61\x73\163\x77\x6f\162\x64\x2c\x20\x61\143\164\x69\x76\145\x2c\x20\154\141\x73\164\137\x6c\x6f\147\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\x73\143")->get($this->tables["\x75\163\x65\x72\x73"]); goto Lds9q; aX5Gy: goto R2tqd; goto g2K7G; i3H3A: $this->set_error("\x6c\x6f\x67\151\156\137\165\156\163\x75\143\x63\145\x73\x73\x66\165\154\x5f\156\157\164\137\141\143\x74\151\166\145"); goto nsJxF; hI6kB: ERQPw: goto aPiSq; K7rfQ: $this->set_error("\154\x6f\x67\x69\x6e\x5f\165\156\x73\x75\x63\x63\145\x73\x73\146\165\x6c"); goto Yn9zP; EF6GB: R2tqd: goto hI6kB; S1oHz: if (!$this->config->item("\162\x65\x6d\x65\155\142\145\x72\x5f\x75\x73\145\x72\x73", "\x69\x6f\x6e\137\x61\x75\x74\150")) { goto ERQPw; } goto GIn2L; mRSnQ: $this->trigger_events("\160\157\x73\164\137\x6c\157\147\x69\156\137\165\156\x73\x75\143\x63\145\163\x73\146\165\154"); goto fgOt6; BF2Lx: $this->session->sess_regenerate(FALSE); goto Fqvwc; QKP30: $this->clear_login_attempts($identity); goto tzZqr; Fqvwc: $this->trigger_events(["\160\157\x73\x74\137\154\157\x67\x69\x6e", "\x70\x6f\163\x74\x5f\x6c\157\147\151\156\137\x73\165\x63\143\x65\x73\163\146\x75\154"]); goto fuA03; Yn9zP: return FALSE; goto iJEpS; fJqCB: $this->trigger_events("\160\157\x73\164\x5f\154\157\147\151\x6e\x5f\165\156\x73\165\143\x63\145\163\163\x66\165\154"); goto K7rfQ; g2K7G: tjquE: goto Awju2; xbrQL: $this->trigger_events("\160\157\x73\x74\x5f\x6c\x6f\x67\x69\156\137\165\156\163\165\x63\x63\x65\163\x73\146\x75\154"); goto i3H3A; Q_Aw9: $this->set_session($user); goto JW4p7; N089s: EvKrj: goto ubhkg; aPiSq: $this->rehash_password_if_needed($user->password, $identity, $password); goto BF2Lx; LfQbU: return FALSE; goto Pc219; Rb9x1: $this->increase_login_attempts($identity); goto fJqCB; GBjr_: if (!$this->verify_password($password, $user->password, $identity)) { goto KE2IT; } goto NckAh; ig3yF: $this->clear_remember_code($identity); goto aX5Gy; ubhkg: $this->trigger_events("\145\x78\164\x72\x61\137\x77\150\x65\162\145"); goto mwtRb; JW4p7: $this->update_last_login($user->id); goto QKP30; NckAh: if (!($user->active == 0)) { goto B1rim; } goto xbrQL; nsJxF: return FALSE; goto SxKFc; tzZqr: $this->clear_forgotten_password_code($identity); goto S1oHz; eL3lM: mgn46: goto x_iZo; HR0wW: $this->set_error("\x6c\x6f\x67\x69\156\x5f\165\x6e\163\165\143\x63\x65\x73\x73\x66\165\154"); goto EPx6V; x_iZo: $this->hash_password($password); goto Rb9x1; TPAiH: return TRUE; goto TmDVc; fuA03: $this->set_message("\x6c\157\x67\x69\x6e\137\163\165\143\x63\145\163\x73\x66\165\154"); goto TPAiH; TmDVc: KE2IT: goto eL3lM; SxKFc: B1rim: goto Q_Aw9; TORB8: $this->trigger_events("\x70\x72\145\x5f\x6c\157\147\x69\x6e"); goto yc9jT; Pc219: yQNQV: goto H5eUz; X90Dq: $this->hash_password($password); goto mRSnQ; yc9jT: if (!(empty($identity) || empty($password))) { goto EvKrj; } goto HR0wW; fgOt6: $this->set_error("\x6c\157\147\151\156\x5f\164\x69\155\x65\x6f\x75\x74"); goto LfQbU; Awju2: $this->remember_user($identity); goto EF6GB; H5eUz: if (!($query->num_rows() === 1)) { goto mgn46; } goto s1_Qp; Lds9q: if (!$this->is_max_login_attempts_exceeded($identity)) { goto yQNQV; } goto X90Dq; GIn2L: if ($remember) { goto tjquE; } goto ig3yF; iJEpS: } public function recheck_session() { goto V3RaC; wdHqB: sXh75: goto ce7Li; bDTdx: $identity = $this->config->item("\151\144\145\x6e\x74\151\x74\171", "\151\x6f\156\x5f\141\165\x74\150"); goto jLJjd; xmSsE: $this->trigger_events("\154\x6f\x67\157\x75\x74"); goto bDTdx; KJSmy: if ($query->num_rows() === 1) { goto LuYAi; } goto xmSsE; ce7Li: return (bool) $this->session->userdata("\x69\x64\145\x6e\164\x69\164\171"); goto u0oLm; V3RaC: $recheck = NULL !== $this->config->item("\162\145\143\x68\x65\143\x6b\137\x74\151\155\x65\162", "\x69\157\x6e\137\x61\165\x74\x68") ? $this->config->item("\162\145\143\x68\x65\143\x6b\137\164\x69\155\x65\x72", "\151\x6f\156\137\x61\x75\x74\150") : 0; goto InKUp; InKUp: if (!($recheck !== 0)) { goto sXh75; } goto mjD3y; AuS15: SOcC2: goto wdHqB; B31m5: goto I__te; goto c7ciK; XOoTL: I__te: goto AuS15; jLJjd: $this->session->unset_userdata([$identity, "\151\144", "\x75\x73\x65\x72\x5f\x69\144"]); goto CcCBD; kp7uI: if (!($last_login + $recheck < time())) { goto SOcC2; } goto kKO4M; mjD3y: $last_login = $this->session->userdata("\154\x61\163\164\137\143\x68\x65\x63\153"); goto kp7uI; CcCBD: return FALSE; goto B31m5; c7ciK: LuYAi: goto HIeHf; kKO4M: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\144\145\x6e\164\151\x74\x79"), "\x61\x63\164\x69\166\145" => "\x31"])->limit(1)->order_by("\151\x64", "\x64\x65\163\x63")->get($this->tables["\165\x73\x65\x72\x73"]); goto KJSmy; HIeHf: $this->session->set_userdata("\154\141\163\x74\x5f\143\x68\145\x63\153", time()); goto XOoTL; u0oLm: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto GomBK; GomBK: if (!$this->config->item("\x74\162\141\x63\x6b\137\x6c\x6f\x67\151\x6e\x5f\141\x74\164\145\x6d\x70\164\x73", "\151\157\x6e\137\x61\x75\x74\x68")) { goto ac0LX; } goto LLaYd; E55jJ: return $attempts >= $max_attempts; goto whk2U; v3cep: $attempts = $this->get_attempts_num($identity, $ip_address); goto E55jJ; hybMI: return FALSE; goto EyssB; uORb2: if (!($max_attempts > 0)) { goto pbjsm; } goto v3cep; OuOCE: ac0LX: goto hybMI; whk2U: pbjsm: goto OuOCE; LLaYd: $max_attempts = $this->config->item("\x6d\x61\x78\151\x6d\x75\155\137\154\157\x67\x69\x6e\137\141\164\x74\x65\x6d\x70\x74\x73", "\151\157\x6e\137\141\x75\x74\x68"); goto uORb2; EyssB: } public function get_attempts_num($identity, $ip_address = NULL) { goto eJ6uy; JhGw8: afITW: goto kkWW9; J3vGx: h2jVR: goto MOp9b; PEsHO: return $qres->num_rows(); goto JhGw8; JTbze: if (isset($ip_address)) { goto KOj6y; } goto d_rKg; e1YXM: if (!$this->config->item("\x74\162\x61\x63\x6b\137\154\157\x67\151\x6e\x5f\151\x70\137\141\144\144\162\145\x73\x73", "\151\157\x6e\137\x61\165\x74\150")) { goto h2jVR; } goto JTbze; kkWW9: return 0; goto aCNpQ; klQ56: $this->db->select("\61", FALSE); goto vrRV0; eJ6uy: if (!$this->config->item("\x74\162\x61\x63\x6b\137\154\x6f\x67\x69\156\x5f\x61\164\164\x65\x6d\x70\164\x73", "\151\157\x6e\137\x61\165\164\150")) { goto afITW; } goto klQ56; R3Uxb: $this->db->where("\x69\160\137\141\144\x64\x72\x65\163\x73", $ip_address); goto J3vGx; dddLS: KOj6y: goto R3Uxb; vrRV0: $this->db->where("\x6c\x6f\x67\x69\156", $identity); goto e1YXM; d_rKg: $ip_address = $this->input->ip_address(); goto dddLS; jvv8U: $qres = $this->db->get($this->tables["\x6c\x6f\x67\151\x6e\x5f\x61\x74\x74\145\155\160\164\163"]); goto PEsHO; MOp9b: $this->db->where("\164\151\155\145\x20\x3e", time() - $this->config->item("\154\x6f\x63\x6b\x6f\165\164\x5f\x74\x69\155\x65", "\151\157\156\137\x61\x75\x74\150"), FALSE); goto jvv8U; aCNpQ: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto PWwH0; XigPB: if (!$this->config->item("\164\162\141\143\153\137\154\157\147\151\156\137\x69\x70\137\x61\x64\144\162\145\x73\163", "\151\157\x6e\137\141\x75\x74\x68")) { goto z9gLF; } goto YMpOX; EZ9gY: $qres = $this->db->get($this->tables["\154\x6f\147\x69\x6e\137\x61\x74\x74\145\x6d\160\x74\163"], 1); goto uGMpl; mqsSH: x2AMM: goto CBSzt; uGMpl: if (!($qres->num_rows() > 0)) { goto sR4pY; } goto Jj20_; YMpOX: if (isset($ip_address)) { goto x2AMM; } goto VJTzo; jknJA: return 0; goto H5vKh; Gc9k1: frvxD: goto jknJA; mrTXc: $this->db->order_by("\151\x64", "\x64\x65\x73\x63"); goto EZ9gY; h7lsX: $this->db->where("\154\157\147\x69\x6e", $identity); goto XigPB; XngUC: sR4pY: goto Gc9k1; d80B8: $this->db->select("\164\151\155\145"); goto h7lsX; Jj20_: return $qres->row()->time; goto XngUC; CBSzt: $this->db->where("\x69\x70\x5f\141\144\144\162\x65\x73\x73", $ip_address); goto BP8bd; VJTzo: $ip_address = $this->input->ip_address(); goto mqsSH; BP8bd: z9gLF: goto mrTXc; PWwH0: if (!$this->config->item("\164\162\141\143\153\137\154\x6f\x67\x69\156\x5f\141\x74\164\x65\x6d\x70\164\x73", "\x69\157\x6e\137\x61\165\x74\150")) { goto frvxD; } goto d80B8; H5vKh: } public function get_last_attempt_ip($identity) { goto o9tbd; o9tbd: if (!($this->config->item("\x74\162\141\x63\x6b\137\154\x6f\147\x69\x6e\137\141\164\x74\145\155\x70\164\163", "\x69\x6f\156\x5f\x61\165\164\x68") && $this->config->item("\164\x72\141\x63\153\137\x6c\157\x67\x69\156\137\151\160\137\141\144\144\162\x65\x73\163", "\x69\157\x6e\137\141\x75\164\150"))) { goto jQBSa; } goto Kg0OR; Kg0OR: $this->db->select("\x69\x70\137\x61\x64\x64\x72\145\163\x73"); goto hqysz; lyebv: return $qres->row()->ip_address; goto lS0ZT; LvWFV: if (!($qres->num_rows() > 0)) { goto A9JDL; } goto lyebv; lS0ZT: A9JDL: goto lq6Z3; aXdjU: $this->db->order_by("\151\x64", "\x64\x65\163\x63"); goto QMhv4; hqysz: $this->db->where("\x6c\157\147\151\156", $identity); goto aXdjU; vd_wT: return ''; goto GHyb2; lq6Z3: jQBSa: goto vd_wT; QMhv4: $qres = $this->db->get($this->tables["\x6c\157\147\x69\x6e\137\x61\164\164\x65\x6d\x70\164\x73"], 1); goto LvWFV; GHyb2: } public function increase_login_attempts($identity) { goto xGWur; gwEg9: $data = ["\x69\x70\x5f\141\144\x64\x72\145\x73\x73" => '', "\154\157\x67\x69\x6e" => $identity, "\x74\151\x6d\145" => time()]; goto AYtUG; AYtUG: if (!$this->config->item("\164\162\x61\x63\153\137\154\157\147\x69\x6e\x5f\x69\160\x5f\141\144\144\162\x65\x73\x73", "\151\x6f\156\x5f\141\165\164\x68")) { goto sY17p; } goto q_z0R; PMRb2: return $this->db->insert($this->tables["\x6c\157\x67\151\156\x5f\x61\164\x74\145\155\x70\x74\x73"], $data); goto Vhvyw; vtzSj: sY17p: goto PMRb2; Fv9Pq: return FALSE; goto cDQ7_; Vhvyw: iLJH7: goto Fv9Pq; xGWur: if (!$this->config->item("\x74\162\141\x63\x6b\x5f\x6c\x6f\x67\x69\x6e\137\x61\x74\164\x65\x6d\160\x74\x73", "\151\157\156\x5f\x61\x75\x74\150")) { goto iLJH7; } goto gwEg9; q_z0R: $data["\x69\160\x5f\x61\x64\x64\162\x65\163\x73"] = $this->input->ip_address(); goto vtzSj; cDQ7_: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto SK8MY; LXNva: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\143\x6b\x6f\165\x74\x5f\164\151\155\x65", "\x69\x6f\156\137\x61\165\x74\150")); goto TuTwM; BvOGn: if (isset($ip_address)) { goto CBu2r; } goto TdfjS; Nv6eU: CBu2r: goto p1a4y; UY6gz: return FALSE; goto klAS4; p1a4y: $this->db->where("\151\160\137\141\x64\144\162\x65\163\x73", $ip_address); goto RkwMc; hnyJS: $this->db->or_where("\164\x69\155\145\x20\x3c", time() - $old_attempts_expire_period, FALSE); goto jzKbi; TdfjS: $ip_address = $this->input->ip_address(); goto Nv6eU; RkwMc: ttfYL: goto hnyJS; TuTwM: $this->db->where("\x6c\x6f\147\151\156", $identity); goto zsJkb; ylhs5: pCq5X: goto UY6gz; jzKbi: return $this->db->delete($this->tables["\154\x6f\x67\x69\156\x5f\x61\164\164\x65\155\160\164\x73"]); goto ylhs5; SK8MY: if (!$this->config->item("\x74\162\x61\143\x6b\137\x6c\x6f\147\x69\156\x5f\x61\164\164\x65\x6d\160\x74\163", "\x69\157\x6e\x5f\141\165\x74\x68")) { goto pCq5X; } goto LXNva; zsJkb: if (!$this->config->item("\x74\162\x61\x63\153\x5f\154\x6f\x67\x69\156\x5f\x69\x70\x5f\x61\144\x64\162\145\x73\x73", "\151\157\x6e\137\141\x75\x74\150")) { goto ttfYL; } goto BvOGn; klAS4: } public function limit($limit) { goto oz5zy; oz5zy: $this->trigger_events("\x6c\151\155\151\164"); goto Du64C; MwAHx: return $this; goto lk2gU; Du64C: $this->_ion_limit = $limit; goto MwAHx; lk2gU: } public function offset($offset) { goto B4N0b; n2dpj: $this->_ion_offset = $offset; goto gTj0R; gTj0R: return $this; goto f5_f1; B4N0b: $this->trigger_events("\x6f\x66\146\x73\x65\164"); goto n2dpj; f5_f1: } public function where($where, $value = NULL) { goto OfLPw; MulXb: $where = [$where => $value]; goto vxiYJ; OfLPw: $this->trigger_events("\167\x68\x65\162\145"); goto indmt; vxiYJ: PJLNv: goto FtetK; indmt: if (is_array($where)) { goto PJLNv; } goto MulXb; FtetK: array_push($this->_ion_where, $where); goto tZMZD; tZMZD: return $this; goto eRQ_j; eRQ_j: } public function like($like, $value = NULL, $position = "\x62\157\x74\x68") { goto rY668; hCB34: array_push($this->_ion_like, ["\154\x69\153\145" => $like, "\166\x61\154\165\x65" => $value, "\x70\157\163\151\x74\x69\x6f\156" => $position]); goto zzwoX; zzwoX: return $this; goto wfpiK; rY668: $this->trigger_events("\154\x69\x6b\x65"); goto hCB34; wfpiK: } public function select($select) { goto I3QpI; BYQD8: $this->_ion_select[] = $select; goto Kz9m7; I3QpI: $this->trigger_events("\163\x65\x6c\145\143\164"); goto BYQD8; Kz9m7: return $this; goto Jhqd5; Jhqd5: } public function order_by($by, $order = "\x64\x65\x73\x63") { goto HFPrN; hBlHE: return $this; goto joTpI; HFPrN: $this->trigger_events("\x6f\162\x64\x65\x72\x5f\142\x79"); goto I5QzL; I5QzL: $this->_ion_order_by = $by; goto BLUIo; BLUIo: $this->_ion_order = $order; goto hBlHE; joTpI: } public function row() { goto wfddq; MMAbr: $row = $this->response->row(); goto qoO1_; wfddq: $this->trigger_events("\162\x6f\167"); goto MMAbr; qoO1_: return $row; goto UAM9_; UAM9_: } public function row_array() { goto lmvjS; lmvjS: $this->trigger_events(["\x72\x6f\167", "\162\157\x77\x5f\141\162\x72\141\x79"]); goto HIVUJ; HIVUJ: $row = $this->response->row_array(); goto nFNZd; nFNZd: return $row; goto sZ9aY; sZ9aY: } public function result() { goto qxqIJ; otNBE: return $result; goto muneO; tcm3x: $result = $this->response->result(); goto otNBE; qxqIJ: $this->trigger_events("\162\x65\x73\165\x6c\x74"); goto tcm3x; muneO: } public function result_array() { goto mFE_t; Zwepd: $result = $this->response->result_array(); goto LvmGM; mFE_t: $this->trigger_events(["\162\145\x73\x75\154\164", "\x72\145\x73\x75\x6c\x74\x5f\141\x72\162\x61\171"]); goto Zwepd; LvmGM: return $result; goto bRH0F; bRH0F: } public function num_rows() { goto g5RGe; g5RGe: $this->trigger_events(["\156\165\x6d\137\162\157\167\163"]); goto tnjOj; KEJeu: return $result; goto mQk50; tnjOj: $result = $this->response->num_rows(); goto KEJeu; mQk50: } public function users($groups = NULL) { goto od2L9; HIYCR: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\137\x77\150\x65\162\x65\x5f\x69\156" : "\x77\x68\x65\x72\x65\x5f\x69\x6e"; goto nTQ51; vkH0i: foreach ($this->_ion_where as $where) { $this->db->where($where); hnv8B: } goto wANWZ; od2L9: $this->trigger_events("\165\163\x65\162\163"); goto fLGd5; w9Xu4: $this->db->limit($this->_ion_limit); goto l14N1; D2KOb: return $this; goto NU02j; Inagc: if (!(isset($groups) && !empty($groups))) { goto okVdg; } goto xS9zU; xBdh7: brsrl: goto cZwdE; QoJdx: if (!isset($this->_ion_limit)) { goto UeOS2; } goto w9Xu4; bgJUV: $this->_ion_limit = NULL; goto Si37u; wANWZ: AiU_Z: goto Rgscl; x95Vj: UeOS2: goto GRsVS; jnTwm: UlTrX: goto WhJQ3; npKAB: $this->_ion_order = NULL; goto WWgKq; X6GSJ: $this->trigger_events("\x65\170\x74\x72\141\137\x77\x68\145\x72\x65"); goto Wsk4n; H8FWF: $this->db->{$or_where_in}($this->tables["\x75\x73\x65\x72\163\x5f\x67\162\157\x75\x70\x73"] . "\56" . $this->join["\147\162\157\x75\x70\x73"], $group_ids); goto e0Kcl; Lno9B: $group_names = []; goto athUM; Lic0a: cKyep: goto MchNe; Si37u: $this->_ion_offset = NULL; goto GjaHj; t3kCa: $group_ids = []; goto Lno9B; YTpZK: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto brsrl; } goto QoJdx; tRpMv: $this->db->join($this->tables["\x67\162\157\x75\160\163"], $this->tables["\165\163\145\162\x73\137\x67\162\157\x75\160\x73"] . "\x2e" . $this->join["\147\162\x6f\165\x70\163"] . "\x20\75\x20" . $this->tables["\147\x72\157\165\160\x73"] . "\56\x69\x64", "\x69\x6e\156\145\162"); goto w7NfH; athUM: foreach ($groups as $group) { goto L41aP; L41aP: if (is_numeric($group)) { goto U1UZv; } goto eKAB9; nQuF9: i8QSf: goto QE8iZ; k1J0W: U1UZv: goto F3yqC; VirCh: kCKz9: goto nQuF9; eKAB9: $group_names[] = $group; goto Bmo2a; F3yqC: $group_ids[] = $group; goto VirCh; Bmo2a: goto kCKz9; goto k1J0W; QE8iZ: } goto lItiT; xHBN3: if (is_array($groups)) { goto Z0k7U; } goto Vcn71; wjroq: FffdV: goto YTpZK; Vcn71: $groups = [$groups]; goto D9CjZ; KJumE: goto IZ50a; goto gXOGI; Iv6yf: $this->response = $this->db->get($this->tables["\165\x73\x65\162\163"]); goto D2KOb; Rgscl: $this->_ion_where = []; goto bk70y; Yoocb: if (!isset($groups)) { goto xx7jO; } goto xHBN3; ZgswW: Ls4qd: goto T6Lrl; lItiT: jR8wg: goto HIYCR; e0Kcl: hrQxk: goto g6QRV; cZwdE: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto bgJUV; Wsk4n: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto sk4sV; } goto vkH0i; l14N1: $this->_ion_limit = NULL; goto x95Vj; tPyku: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\151\153\145"], $like["\166\141\154\x75\145"], $like["\x70\157\163\151\164\151\157\x6e"]); ccFV5: } goto jnTwm; WWgKq: $this->_ion_order_by = NULL; goto cSSnX; nTQ51: if (empty($group_names)) { goto Ls4qd; } goto tRpMv; SEZZg: $this->db->select([$this->tables["\x75\x73\145\x72\163"] . "\56\x2a", $this->tables["\x75\x73\x65\162\163"] . "\x2e\151\144\40\x61\x73\40\x69\x64", $this->tables["\165\x73\x65\x72\163"] . "\x2e\151\144\40\141\x73\40\x75\x73\145\x72\x5f\151\144"]); goto KJumE; GRsVS: goto JFRgv; goto xBdh7; bk70y: sk4sV: goto XZXs5; w7NfH: $this->db->where_in($this->tables["\x67\162\157\165\x70\x73"] . "\56\156\141\x6d\x65", $group_names); goto ZgswW; xS9zU: $this->db->distinct(); goto KHp87; D9CjZ: Z0k7U: goto Inagc; T6Lrl: if (empty($group_ids)) { goto hrQxk; } goto H8FWF; XZXs5: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto FffdV; } goto tPyku; gXOGI: HIGBE: goto RpHiQ; MchNe: $this->_ion_select = []; goto jkG6i; WhJQ3: $this->_ion_like = []; goto wjroq; cSSnX: oJVSy: goto Iv6yf; jkG6i: IZ50a: goto Yoocb; l44_h: okVdg: goto t3kCa; CVxH4: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto npKAB; g6QRV: xx7jO: goto X6GSJ; fLGd5: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto HIGBE; } goto SEZZg; KHp87: $this->db->join($this->tables["\165\x73\145\162\163\x5f\147\x72\157\x75\x70\x73"], $this->tables["\x75\163\145\x72\x73\137\147\x72\157\165\x70\163"] . "\x2e" . $this->join["\x75\163\145\x72\x73"] . "\x3d" . $this->tables["\165\x73\x65\162\163"] . "\x2e\151\144", "\x69\156\x6e\x65\x72"); goto l44_h; RpHiQ: foreach ($this->_ion_select as $select) { $this->db->select($select); zh9ds: } goto Lic0a; GjaHj: JFRgv: goto JnjdZ; JnjdZ: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto oJVSy; } goto CVxH4; NU02j: } public function user($id = NULL) { goto Z6SOO; Iuimj: $this->where($this->tables["\165\163\145\x72\x73"] . "\x2e\x69\144", $id); goto Xnwnb; Xnwnb: $this->users(); goto h06oA; Z6SOO: $this->trigger_events("\x75\163\145\162"); goto K3R33; h06oA: return $this; goto KP91l; gsK6j: $this->limit(1); goto Qg1ad; Qg1ad: $this->order_by($this->tables["\x75\163\x65\162\163"] . "\x2e\x69\x64", "\x64\x65\163\x63"); goto Iuimj; K3R33: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\x72\x5f\x69\x64"); goto gsK6j; KP91l: } public function get_users_groups($id = FALSE) { goto ihWW7; ihWW7: $this->trigger_events("\x67\145\x74\137\x75\163\x65\x72\x73\137\147\x72\157\165\x70"); goto Tcyoy; Tcyoy: $id || ($id = $this->session->userdata("\165\x73\x65\162\137\x69\144")); goto zQxv0; zQxv0: return $this->db->select($this->tables["\165\163\145\x72\x73\x5f\147\x72\x6f\165\x70\163"] . "\56" . $this->join["\147\x72\x6f\165\x70\163"] . "\x20\141\x73\40\x69\x64\x2c\40" . $this->tables["\x67\x72\157\165\x70\x73"] . "\x2e\156\141\x6d\145\x2c\x20" . $this->tables["\147\162\x6f\165\x70\163"] . "\x2e\144\145\163\x63\162\x69\x70\x74\151\x6f\156")->where($this->tables["\x75\163\145\162\x73\x5f\x67\x72\x6f\x75\x70\163"] . "\x2e" . $this->join["\165\x73\145\162\x73"], $id)->join($this->tables["\x67\x72\157\x75\160\x73"], $this->tables["\x75\x73\x65\x72\x73\x5f\x67\x72\157\165\x70\163"] . "\x2e" . $this->join["\147\x72\x6f\x75\x70\163"] . "\75" . $this->tables["\147\x72\157\165\160\163"] . "\56\151\x64")->get($this->tables["\165\x73\x65\x72\x73\137\147\x72\x6f\x75\x70\x73"]); goto NdQ50; NdQ50: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto hKWK2; S1drO: foreach ($check_group as $key => $value) { goto y66as; y66as: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto PoHCZ; XnIiw: ueumA: goto aQnmV; PoHCZ: if (!(in_array($value, $groups) xor $check_all)) { goto noMoK; } goto ZHAak; AszoV: noMoK: goto XnIiw; ZHAak: return !$check_all; goto AszoV; aQnmV: } goto pfNOQ; acdaB: $check_group = [$check_group]; goto FwZQP; MOwkb: $this->_cache_user_in_group[$id] = $groups_array; goto xgkfa; XHuNY: if (isset($this->_cache_user_in_group[$id])) { goto C144F; } goto FeS6k; hKWK2: $this->trigger_events("\x69\x6e\137\x67\162\157\165\160"); goto zOjpR; j9y8c: $groups_array = $this->_cache_user_in_group[$id]; goto usXHq; orERH: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; UjLkD: } goto qSo1y; FwZQP: NHDle: goto XHuNY; zOjpR: $id || ($id = $this->session->userdata("\165\x73\x65\162\137\151\144")); goto Srb_z; LisOs: C144F: goto j9y8c; FeS6k: $users_groups = $this->get_users_groups($id)->result(); goto igwLy; xgkfa: goto pf4ge; goto LisOs; pfNOQ: GtjbX: goto fJ5c0; qSo1y: e1EfB: goto MOwkb; igwLy: $groups_array = []; goto orERH; fJ5c0: return $check_all; goto ugU7d; usXHq: pf4ge: goto S1drO; Srb_z: if (is_array($check_group)) { goto NHDle; } goto acdaB; ugU7d: } public function add_to_group($group_ids, $user_id = FALSE) { goto MYLPv; wAYdB: $return = 0; goto vM22r; Xpc5K: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\162\137\x69\x64")); goto sQpL7; r9anL: return $return; goto dwYgL; vM22r: foreach ($group_ids as $group_id) { goto jwvZY; DIQ6w: goto Wzrff; goto Qc1r7; hycjV: if (isset($this->_cache_groups[$group_id])) { goto VUp_u; } goto ZDEWa; Qc1r7: VUp_u: goto wwOsV; bYmLe: Wzrff: goto gjh_N; jwvZY: if (!$this->db->insert($this->tables["\x75\163\145\x72\163\x5f\x67\162\157\x75\x70\x73"], [$this->join["\x67\162\x6f\165\x70\x73"] => (float) $group_id, $this->join["\165\163\145\162\163"] => (float) $user_id])) { goto nOWdW; } goto hycjV; qpXIE: $return++; goto Sk2AT; ZDEWa: $group = $this->group($group_id)->result(); goto Kgl6Z; hZOsu: JLbZn: goto Jkw_A; gjh_N: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto qpXIE; wwOsV: $group_name = $this->_cache_groups[$group_id]; goto bYmLe; Kgl6Z: $group_name = $group[0]->name; goto fFW2d; Sk2AT: nOWdW: goto hZOsu; fFW2d: $this->_cache_groups[$group_id] = $group_name; goto DIQ6w; Jkw_A: } goto eoO4H; MYLPv: $this->trigger_events("\x61\144\x64\137\164\x6f\137\x67\162\157\165\x70"); goto Xpc5K; eoO4H: UQdp6: goto r9anL; sQpL7: if (is_array($group_ids)) { goto OIcV9; } goto hO7kL; hO7kL: $group_ids = [$group_ids]; goto Nzflb; Nzflb: OIcV9: goto wAYdB; dwYgL: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto orCrq; cGBah: return FALSE; goto cA8mP; QVlJt: if (!($return = $this->db->delete($this->tables["\165\x73\x65\162\x73\137\x67\x72\157\x75\x70\163"], [$this->join["\x75\x73\x65\162\x73"] => (float) $user_id]))) { goto BubpE; } goto UeMXy; C0kmz: BubpE: goto NvEmN; UeMXy: $this->_cache_user_in_group[$user_id] = []; goto C0kmz; yF7EE: foreach ($group_ids as $group_id) { goto KAnMS; boS44: EKqkH: goto YH9_V; hDKJS: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto EKqkH; } goto oXUAi; YH9_V: u0IzK: goto M7eve; KAnMS: $this->db->delete($this->tables["\x75\163\145\x72\163\137\x67\162\157\x75\160\x73"], [$this->join["\x67\x72\157\165\160\x73"] => (float) $group_id, $this->join["\165\x73\145\162\x73"] => (float) $user_id]); goto hDKJS; oXUAi: unset($this->_cache_user_in_group[$user_id][$group_id]); goto boS44; M7eve: } goto HsI5r; KpDFs: $group_ids = [$group_ids]; goto nxbqO; HsI5r: yWLOY: goto ig3JV; KaP_D: if (!empty($user_id)) { goto ocaHO; } goto cGBah; NvEmN: goto iJ5sz; goto g5Zip; zHfgv: if (is_array($group_ids)) { goto ogmNO; } goto KpDFs; pEpF5: iJ5sz: goto hwe1O; nxbqO: ogmNO: goto yF7EE; g5Zip: VOViD: goto zHfgv; hwe1O: return $return; goto e8LKC; ig3JV: $return = TRUE; goto pEpF5; r25RJ: if (!empty($group_ids)) { goto VOViD; } goto QVlJt; orCrq: $this->trigger_events("\x72\x65\155\157\x76\145\x5f\146\x72\157\155\x5f\147\x72\157\x75\160"); goto KaP_D; cA8mP: ocaHO: goto r25RJ; e8LKC: } public function groups() { goto Ucosz; kL9qh: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto TDni7; f7_jT: $this->_ion_offset = NULL; goto DzB21; DzB21: rzrYO: goto Q5AE3; LWp2H: $this->_ion_where = []; goto edveR; HRXI4: vKwCi: goto nMDkc; Ucosz: $this->trigger_events("\147\x72\157\165\160\x73"); goto Bey8U; TDni7: $this->_ion_limit = NULL; goto f7_jT; Bey8U: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto nqt2q; } goto XL11X; f1Yx0: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto HRXI4; edveR: nqt2q: goto Km0mE; nMDkc: $this->response = $this->db->get($this->tables["\x67\x72\x6f\x75\160\163"]); goto tzjms; LyLdp: nMXAG: goto LWp2H; tzjms: return $this; goto zMJBI; eP3ds: if (!isset($this->_ion_limit)) { goto Vuv6a; } goto anzDg; eqsbW: Vuv6a: goto Bizg8; Km0mE: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto cdEre; } goto eP3ds; bXhJX: $this->_ion_limit = NULL; goto eqsbW; XL11X: foreach ($this->_ion_where as $where) { $this->db->where($where); bSn7d: } goto LyLdp; anzDg: $this->db->limit($this->_ion_limit); goto bXhJX; Q5AE3: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto vKwCi; } goto f1Yx0; h6AiX: cdEre: goto kL9qh; Bizg8: goto rzrYO; goto h6AiX; zMJBI: } public function group($id = NULL) { goto BqTe3; BqTe3: $this->trigger_events("\147\162\x6f\x75\x70"); goto EHfos; CO1lT: $this->order_by("\x69\x64", "\x64\x65\x73\x63"); goto jTs57; cfl0y: HH_4S: goto TDtnS; jTs57: return $this->groups(); goto IjZHl; EHfos: if (!isset($id)) { goto HH_4S; } goto EklM3; EklM3: $this->where($this->tables["\x67\x72\x6f\x75\160\x73"] . "\56\x69\144", $id); goto cfl0y; TDtnS: $this->limit(1); goto CO1lT; IjZHl: } public function update($id, array $data) { goto gMpBq; T5IIp: return FALSE; goto R9bjx; qk2uT: return FALSE; goto VKDuj; XFupA: $this->trigger_events(["\x70\157\163\x74\137\165\160\144\x61\164\145\137\x75\163\x65\162", "\x70\x6f\163\x74\137\x75\x70\144\x61\164\x65\137\x75\163\x65\x72\x5f\165\x6e\163\x75\x63\143\145\x73\163\x66\165\x6c"]); goto guDV3; sw0WS: $this->set_error("\141\143\143\x6f\165\x6e\164\137\x63\x72\x65\x61\x74\x69\157\x6e\137\144\x75\160\x6c\x69\x63\x61\x74\x65\137\x69\144\145\156\164\x69\164\171"); goto yF6Rl; gJZbd: $this->db->trans_rollback(); goto x93Se; Ap4CW: $this->db->trans_commit(); goto nY54L; z41t_: uorM1: goto lyv6n; fLZxY: $this->set_message("\165\x70\144\141\x74\x65\137\163\165\143\143\145\x73\x73\x66\x75\154"); goto GXjWB; LVmQM: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto iJpGj; } goto i8QvJ; SOPs2: $this->db->trans_begin(); goto LVmQM; yF6Rl: $this->trigger_events(["\x70\x6f\163\164\137\x75\160\x64\x61\x74\145\x5f\x75\x73\x65\x72", "\x70\157\x73\164\137\x75\x70\x64\141\x74\x65\137\165\163\x65\x72\137\165\156\x73\165\143\x63\145\163\x73\146\165\x6c"]); goto t88as; p8d08: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\163\x73\167\157\162\144", $data) || array_key_exists("\x65\x6d\x61\151\x6c", $data))) { goto KeUDK; } goto slqil; Jh6IQ: $this->set_error("\x75\160\144\141\x74\145\137\x75\x6e\x73\x75\143\143\145\163\163\x66\165\x6c"); goto jgtvk; N16EP: $data = $this->_filter_data($this->tables["\x75\x73\145\x72\x73"], $data); goto p8d08; lyv6n: vwen4: goto tv2Rf; K5BP_: $user = $this->user($id)->row(); goto SOPs2; M9cln: goto uorM1; goto OcXul; guDV3: $this->set_error("\165\160\144\141\164\145\137\165\x6e\x73\165\143\143\x65\163\x73\146\165\154"); goto qk2uT; t88as: $this->set_error("\x75\x70\144\141\x74\x65\137\x75\156\x73\x75\x63\143\x65\x73\x73\146\x75\154"); goto T5IIp; OcXul: H_qhA: goto mBdKY; uWPxO: $this->db->trans_rollback(); goto XFupA; tv2Rf: KeUDK: goto CEL3l; slqil: if (!array_key_exists("\160\x61\x73\163\x77\x6f\162\x64", $data)) { goto vwen4; } goto RaGVW; nY54L: $this->trigger_events(["\x70\157\x73\164\x5f\165\x70\x64\x61\x74\x65\x5f\x75\163\x65\x72", "\x70\x6f\163\x74\x5f\165\160\x64\141\x74\145\137\x75\x73\x65\162\137\163\x75\143\x63\x65\163\x73\x66\165\154"]); goto fLZxY; RaGVW: if (!empty($data["\x70\141\163\x73\x77\157\162\x64"])) { goto H_qhA; } goto ZOT06; VKDuj: mJAbE: goto z41t_; R9bjx: iJpGj: goto N16EP; mBdKY: $data["\x70\141\163\163\x77\157\x72\x64"] = $this->hash_password($data["\x70\141\163\163\167\x6f\x72\144"], $user->{$this->identity_column}); goto cL3TI; ZGZ3Y: if (!($this->db->trans_status() === FALSE)) { goto hyZER; } goto gJZbd; gMpBq: $this->trigger_events("\160\162\145\x5f\165\x70\144\141\164\x65\137\x75\163\x65\162"); goto K5BP_; CEL3l: $this->trigger_events("\145\170\x74\162\x61\137\x77\150\x65\x72\x65"); goto Q8F8U; jgtvk: return FALSE; goto XfulH; x93Se: $this->trigger_events(["\160\157\163\164\x5f\x75\160\144\x61\164\x65\x5f\x75\163\x65\162", "\x70\157\163\164\137\165\x70\144\141\x74\145\137\x75\163\145\x72\137\x75\156\163\x75\143\143\x65\163\163\146\x75\x6c"]); goto Jh6IQ; XfulH: hyZER: goto Ap4CW; cL3TI: if (!($data["\x70\x61\x73\163\x77\x6f\x72\144"] === FALSE)) { goto mJAbE; } goto uWPxO; ZOT06: unset($data["\160\141\163\x73\167\x6f\162\144"]); goto M9cln; GXjWB: return TRUE; goto pmpdY; i8QvJ: $this->db->trans_rollback(); goto sw0WS; Q8F8U: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, ["\151\144" => $user->id]); goto ZGZ3Y; pmpdY: } public function delete_user($id) { goto qktZn; yTJaZ: $this->db->trans_rollback(); goto mwYuW; iVvb7: if (!($this->db->trans_status() === FALSE)) { goto AABOe; } goto yTJaZ; NVoSN: $this->remove_from_group(NULL, $id); goto nmpqH; mwYuW: $this->trigger_events(["\160\x6f\163\x74\x5f\144\145\x6c\145\x74\145\137\x75\163\145\x72", "\x70\157\x73\x74\x5f\144\145\x6c\145\164\145\137\x75\163\x65\x72\x5f\165\156\x73\x75\143\143\x65\163\x73\x66\x75\154"]); goto VLSQF; VLSQF: $this->set_error("\144\145\x6c\145\164\145\x5f\165\x6e\x73\165\x63\x63\145\x73\163\x66\165\x6c"); goto Sgggq; Sgggq: return FALSE; goto YK5TG; qktZn: $this->trigger_events("\x70\x72\145\137\x64\145\x6c\x65\164\145\x5f\165\x73\x65\x72"); goto hkng_; MLRY8: return TRUE; goto jFyiZ; hkng_: $this->db->trans_begin(); goto NVoSN; vNkGg: $this->set_message("\x64\x65\x6c\x65\x74\145\x5f\163\x75\143\143\x65\x73\163\x66\x75\x6c"); goto MLRY8; fdw4y: $this->db->trans_commit(); goto NpECc; nmpqH: $this->db->delete($this->tables["\x75\163\145\x72\163"], ["\151\x64" => $id]); goto iVvb7; YK5TG: AABOe: goto fdw4y; NpECc: $this->trigger_events(["\160\x6f\x73\x74\x5f\144\145\x6c\x65\x74\145\137\165\x73\x65\162", "\160\157\x73\164\137\x64\145\154\x65\164\x65\x5f\165\x73\x65\162\x5f\x73\x75\143\x63\x65\163\x73\x66\165\x6c"]); goto vNkGg; jFyiZ: } public function update_last_login($id) { goto cQhGP; LXn53: $this->trigger_events("\x65\x78\164\162\141\x5f\167\x68\x65\x72\145"); goto AHt4Q; Q4_i4: $this->load->helper("\144\x61\x74\x65"); goto LXn53; cQhGP: $this->trigger_events("\165\160\144\x61\x74\x65\x5f\x6c\141\x73\x74\137\154\157\x67\151\156"); goto Q4_i4; fGOrZ: return $this->db->affected_rows() == 1; goto W__Ju; AHt4Q: $this->db->update($this->tables["\x75\x73\x65\x72\163"], ["\154\x61\x73\164\137\x6c\x6f\147\151\x6e" => time()], ["\x69\144" => $id]); goto fGOrZ; W__Ju: } public function set_lang($lang = "\145\x6e") { goto GxXnG; ybbLy: return TRUE; goto ANicp; VCKp1: lssdr: goto NJyU0; U3k1b: if ($this->config->item("\x75\x73\x65\x72\137\145\170\x70\x69\162\145", "\x69\157\x6e\x5f\141\x75\x74\x68") === 0) { goto lssdr; } goto l2OP3; BstyO: Ztbis: goto OtCmw; GxXnG: $this->trigger_events("\163\x65\x74\x5f\154\141\x6e\x67"); goto U3k1b; l2OP3: $expire = $this->config->item("\x75\163\x65\162\x5f\145\170\x70\x69\x72\x65", "\151\x6f\156\137\141\x75\x74\150"); goto Xmf08; NJyU0: $expire = self::MAX_COOKIE_LIFETIME; goto BstyO; OtCmw: set_cookie(["\x6e\x61\x6d\x65" => "\x6c\x61\156\x67\x5f\x63\157\x64\x65", "\x76\x61\x6c\x75\145" => $lang, "\145\x78\160\x69\x72\145" => $expire]); goto ybbLy; Xmf08: goto Ztbis; goto VCKp1; ANicp: } public function set_session($user) { goto Q8WKX; GTxhr: return TRUE; goto uz3kD; OfBk7: $this->session->set_userdata($session_data); goto bqiqB; Q8WKX: $this->trigger_events("\x70\x72\145\137\163\x65\164\x5f\x73\x65\x73\x73\151\x6f\x6e"); goto iXNxs; iXNxs: $session_data = ["\x69\x64\x65\x6e\x74\x69\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\151\x6c" => $user->email, "\x75\x73\x65\x72\137\x69\144" => $user->id, "\x6f\x6c\144\137\x6c\x61\163\x74\x5f\154\157\x67\151\x6e" => $user->last_login, "\x6c\x61\x73\x74\137\143\150\x65\x63\x6b" => time()]; goto OfBk7; bqiqB: $this->trigger_events("\x70\x6f\163\x74\137\163\145\164\x5f\x73\145\163\x73\151\x6f\156"); goto GTxhr; uz3kD: } public function remember_user($identity) { goto tpOA4; yRGPG: if ($identity) { goto phSU1; } goto zOOM1; oKcCj: return FALSE; goto ZmOq8; bXymE: $expire = self::MAX_COOKIE_LIFETIME; goto ROLv0; zOOM1: return FALSE; goto oeugV; iM0L5: return TRUE; goto BPI4D; RNPlb: if (!($this->db->affected_rows() > -1)) { goto dANb_; } goto iInWI; bqc6Q: XL7y6: goto bXymE; UBdk3: $expire = $this->config->item("\x75\163\x65\x72\x5f\x65\170\x70\151\x72\x65", "\151\x6f\156\x5f\141\x75\x74\150"); goto O3sRX; tpOA4: $this->trigger_events("\x70\x72\145\137\x72\x65\155\145\155\142\x65\162\137\x75\x73\145\x72"); goto yRGPG; Vjlj2: $this->trigger_events(["\x70\x6f\163\x74\137\x72\x65\155\x65\x6d\142\x65\162\137\165\163\145\x72", "\162\145\155\x65\155\142\145\162\x5f\165\x73\x65\162\137\x75\156\163\165\x63\143\145\163\163\x66\x75\x6c"]); goto oKcCj; acxpJ: kbNjV: goto Vjlj2; FVikp: set_cookie(["\x6e\141\x6d\145" => $this->config->item("\162\x65\x6d\145\x6d\142\x65\x72\137\143\157\157\x6b\x69\145\x5f\x6e\141\155\145", "\x69\x6f\156\x5f\141\165\164\x68"), "\166\141\x6c\165\145" => $token->user_code, "\145\170\x70\151\x72\x65" => $expire]); goto tLXXD; DqNRr: $this->db->update($this->tables["\165\x73\145\x72\163"], ["\162\145\x6d\145\x6d\142\x65\162\x5f\x73\145\154\145\143\164\157\162" => $token->selector, "\162\145\x6d\x65\155\142\x65\x72\x5f\143\x6f\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto RNPlb; BPI4D: dANb_: goto acxpJ; iInWI: if ($this->config->item("\165\163\145\x72\x5f\x65\x78\160\151\x72\145", "\x69\x6f\x6e\x5f\141\x75\164\x68") === 0) { goto XL7y6; } goto UBdk3; tLXXD: $this->trigger_events(["\x70\x6f\x73\x74\x5f\162\x65\x6d\x65\155\x62\x65\x72\x5f\x75\163\145\x72", "\162\x65\x6d\145\x6d\x62\x65\162\137\x75\x73\x65\162\137\163\x75\x63\143\x65\163\x73\146\x75\x6c"]); goto iM0L5; O4pL1: $token = $this->_generate_selector_validator_couple(); goto k0w3T; ROLv0: AStOg: goto FVikp; k0w3T: if (!$token->validator_hashed) { goto kbNjV; } goto DqNRr; oeugV: phSU1: goto O4pL1; O3sRX: goto AStOg; goto bqc6Q; ZmOq8: } public function login_remembered_user() { goto LuSVO; dMn_Z: $this->remember_user($identity); goto rLQMQ; MNgtn: if (!$this->config->item("\165\163\x65\x72\x5f\145\x78\x74\145\x6e\144\137\x6f\156\137\x6c\x6f\147\151\x6e", "\151\157\x6e\x5f\141\165\x74\x68")) { goto RJkc2; } goto dMn_Z; LuSVO: $this->trigger_events("\x70\x72\145\x5f\154\157\x67\x69\x6e\137\162\x65\155\x65\x6d\142\x65\162\x65\x64\137\x75\163\x65\162"); goto iny6G; nOWJc: A2W0F: goto uAeS6; YNEc6: tN7rW: goto nOWJc; LX3lU: knYGX: goto DmaFT; MN4Al: if (!($query->num_rows() === 1)) { goto A2W0F; } goto QZo9h; ndC3k: $this->session->sess_regenerate(FALSE); goto uTiR6; pVn3e: return FALSE; goto LX3lU; wSuY3: $this->trigger_events(["\x70\157\163\164\137\x6c\x6f\147\151\x6e\137\162\x65\155\x65\x6d\x62\145\x72\145\x64\x5f\165\x73\x65\x72", "\x70\157\163\164\x5f\x6c\x6f\147\151\156\137\162\145\x6d\x65\155\142\145\162\x65\144\137\165\163\145\x72\x5f\x75\156\x73\165\143\143\x65\x73\x73\146\x75\154"]); goto csfse; DmaFT: $this->trigger_events("\x65\170\164\162\x61\x5f\x77\x68\145\162\x65"); goto pz4h5; vE1ew: $this->trigger_events(["\x70\x6f\163\164\137\154\157\x67\x69\156\137\x72\x65\x6d\145\x6d\142\145\x72\x65\144\137\x75\x73\x65\162", "\160\157\163\x74\137\154\157\147\x69\156\x5f\162\x65\x6d\x65\155\x62\145\x72\145\x64\137\165\x73\x65\162\x5f\165\156\163\x75\x63\143\x65\163\163\146\165\x6c"]); goto pVn3e; QZo9h: $user = $query->row(); goto FQep2; pz4h5: $query = $this->db->select($this->identity_column . "\54\x20\x69\x64\x2c\x20\145\155\x61\x69\x6c\54\x20\x72\x65\x6d\145\x6d\142\x65\162\x5f\143\x6f\144\145\54\40\x6c\141\163\164\x5f\x6c\x6f\147\151\x6e")->where("\162\x65\x6d\x65\x6d\142\x65\x72\137\163\145\154\x65\x63\x74\157\162", $token->selector)->where("\x61\143\164\x69\x76\145", 1)->limit(1)->get($this->tables["\165\x73\x65\x72\x73"]); goto MN4Al; E40Yn: return TRUE; goto YNEc6; FQep2: $identity = $user->{$this->identity_column}; goto Yuox9; csfse: return FALSE; goto Rfwe1; FyOSn: $this->update_last_login($user->id); goto nML3i; iny6G: $remember_cookie = get_cookie($this->config->item("\162\145\155\145\155\142\145\x72\137\143\x6f\157\153\x69\x65\x5f\156\x61\155\145", "\151\x6f\x6e\x5f\141\x75\164\150")); goto GGskJ; Yuox9: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto tN7rW; } goto FyOSn; N2W9i: if (!($token === FALSE)) { goto knYGX; } goto vE1ew; nML3i: $this->set_session($user); goto cbKVK; GGskJ: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto N2W9i; uTiR6: $this->trigger_events(["\160\x6f\x73\x74\137\154\x6f\x67\151\156\x5f\x72\145\x6d\145\x6d\x62\145\162\x65\x64\137\165\x73\145\x72", "\160\157\163\x74\137\154\x6f\147\x69\x6e\x5f\162\145\155\x65\155\x62\x65\x72\x65\x64\x5f\165\163\x65\x72\x5f\x73\x75\143\143\145\x73\x73\x66\165\154"]); goto E40Yn; cbKVK: $this->clear_forgotten_password_code($identity); goto MNgtn; rLQMQ: RJkc2: goto ndC3k; uAeS6: delete_cookie($this->config->item("\x72\145\155\x65\155\x62\145\x72\137\x63\x6f\157\x6b\151\145\137\156\x61\155\x65", "\x69\157\x6e\x5f\141\165\x74\x68")); goto wSuY3; Rfwe1: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto xgDu6; DC3gn: $this->set_message("\x67\x72\157\x75\160\137\x63\x72\x65\141\x74\x69\157\156\x5f\163\x75\143\143\145\x73\163\x66\x75\154"); goto e524p; m2i0D: $this->db->insert($this->tables["\x67\x72\157\x75\160\x73"], $data); goto Oz0vi; e524p: return $group_id; goto R3kew; N6z6x: $data = ["\156\x61\x6d\x65" => $group_name, "\144\145\x73\143\162\151\160\x74\151\157\156" => $group_description]; goto Y3BtT; JKiKs: lVcAA: goto mIunK; MxLhB: return FALSE; goto czReg; xgDu6: if ($group_name) { goto TInzS; } goto mCexK; Oz0vi: $group_id = $this->db->insert_id($this->tables["\147\x72\157\165\160\x73"] . "\x5f\x69\144\137\163\x65\x71"); goto DC3gn; dz048: if (!($existing_group !== 0)) { goto qAHGl; } goto nKnoD; EnVtF: return FALSE; goto z4Opb; nKnoD: $this->set_error("\x67\162\157\165\160\137\141\x6c\162\x65\141\x64\x79\x5f\x65\170\x69\163\x74\163"); goto EnVtF; M8c3N: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\156\141\155\x65" => $group_name])->num_rows(); goto dz048; trLc3: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\x70\x73"], $additional_data), $data); goto JKiKs; Y3BtT: if (empty($additional_data)) { goto lVcAA; } goto trLc3; czReg: TInzS: goto M8c3N; z4Opb: qAHGl: goto N6z6x; mIunK: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\147\162\157\x75\160\x5f\x73\x65\164"); goto m2i0D; mCexK: $this->set_error("\147\162\x6f\165\160\137\x6e\141\x6d\x65\137\x72\x65\x71\165\x69\162\x65\144"); goto MxLhB; R3kew: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto gLedr; KD6bV: t94xe: goto RO9ii; SsFih: if (!($this->config->item("\141\x64\155\151\x6e\x5f\147\162\x6f\165\x70", "\x69\x6f\156\x5f\x61\165\x74\x68") === $group->name && $group_name !== $group->name)) { goto jEU34; } goto Cau3E; vOgJc: $this->db->update($this->tables["\x67\162\x6f\x75\160\163"], $data, ["\151\x64" => $group_id]); goto k90RC; srEUt: x5A3A: goto vOgJc; M8rGv: $data = array_merge($this->_filter_data($this->tables["\147\162\157\165\x70\163"], $additional_data), $data); goto srEUt; Cau3E: $this->set_error("\x67\x72\x6f\x75\x70\x5f\156\141\155\145\137\141\144\x6d\x69\156\x5f\156\157\x74\x5f\x61\154\164\x65\x72"); goto NRuuV; LvdDb: return TRUE; goto TFEsY; auw5_: if (empty($additional_data)) { goto x5A3A; } goto M8rGv; gmSpE: $group = $this->db->get_where($this->tables["\147\162\157\165\x70\x73"], ["\x69\x64" => $group_id])->row(); goto SsFih; DG3_F: jEU34: goto auw5_; k90RC: $this->set_message("\x67\x72\x6f\165\160\x5f\x75\x70\x64\x61\164\145\137\163\165\143\143\145\x73\x73\x66\165\154"); goto LvdDb; ldkkC: if (empty($group_name)) { goto qPLcE; } goto OxuCo; XpKca: return FALSE; goto KD6bV; USpLK: return FALSE; goto RAZJ_; gLedr: if (!empty($group_id)) { goto t94xe; } goto XpKca; RO9ii: $data = []; goto ldkkC; RAZJ_: aCOE5: goto ExxNd; TLZnF: $this->set_error("\147\162\157\x75\160\137\x61\x6c\162\x65\x61\144\171\137\145\170\x69\x73\164\x73"); goto USpLK; NRuuV: return FALSE; goto DG3_F; OxuCo: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\165\x70\x73"], ["\156\141\x6d\x65" => $group_name])->row(); goto yXoJH; yXoJH: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto aCOE5; } goto TLZnF; ExxNd: $data["\156\x61\x6d\145"] = $group_name; goto xerKe; xerKe: qPLcE: goto gmSpE; TFEsY: } public function delete_group($group_id = FALSE) { goto CVYmO; Wqnaq: $group = $this->group($group_id)->row(); goto k4APc; MaUCw: $this->db->trans_commit(); goto Uu8Tc; CVYmO: if (!(!$group_id || empty($group_id))) { goto EX2RK; } goto Pf22_; yvb7_: $this->set_error("\147\x72\x6f\x75\x70\x5f\144\x65\x6c\145\x74\x65\x5f\x6e\x6f\x74\x61\x6c\x6c\x6f\x77\x65\144"); goto V960d; Pf22_: return FALSE; goto fA6gj; LAvat: $this->db->delete($this->tables["\x75\x73\x65\x72\x73\x5f\x67\162\157\x75\160\x73"], [$this->join["\147\x72\157\x75\x70\x73"] => $group_id]); goto TKbE9; U3YGt: $this->trigger_events(["\160\x6f\x73\164\137\144\145\154\x65\164\x65\x5f\147\x72\157\165\x70", "\x70\157\163\164\137\144\x65\x6c\145\x74\x65\x5f\147\x72\x6f\x75\160\x5f\156\157\164\141\154\154\157\x77\145\144"]); goto yvb7_; uaScq: $this->trigger_events(["\x70\x6f\x73\164\137\x64\145\154\145\x74\145\x5f\x67\x72\157\165\x70", "\x70\x6f\163\164\x5f\144\145\154\145\164\x65\x5f\x67\x72\157\165\160\137\x75\156\163\165\143\x63\145\163\163\146\165\x6c"]); goto DwFIC; hezNk: $this->db->trans_rollback(); goto uaScq; jfhgM: $this->trigger_events("\x70\162\145\137\x64\x65\154\x65\x74\x65\x5f\147\162\157\x75\160"); goto Ln6vL; k4APc: if (!($group->name == $this->config->item("\141\144\x6d\151\x6e\x5f\147\x72\157\165\160", "\151\x6f\156\x5f\141\165\164\150"))) { goto bVBwX; } goto U3YGt; TKbE9: $this->db->delete($this->tables["\147\162\x6f\x75\160\x73"], ["\x69\x64" => $group_id]); goto zuzs7; vvmpB: return FALSE; goto QbOve; QbOve: i_dSe: goto MaUCw; Uu8Tc: $this->trigger_events(["\x70\157\163\164\x5f\x64\x65\x6c\x65\x74\145\x5f\147\162\157\165\160", "\x70\x6f\163\x74\137\x64\145\154\145\x74\145\x5f\x67\162\157\165\x70\x5f\163\165\143\x63\x65\163\x73\146\165\154"]); goto tgi5i; fA6gj: EX2RK: goto Wqnaq; T97Oe: return TRUE; goto YEpS_; Ln6vL: $this->db->trans_begin(); goto LAvat; V960d: return FALSE; goto vEWwI; zuzs7: if (!($this->db->trans_status() === FALSE)) { goto i_dSe; } goto hezNk; tgi5i: $this->set_message("\147\x72\157\x75\160\137\144\x65\x6c\x65\x74\x65\137\x73\x75\143\x63\x65\x73\x73\x66\165\x6c"); goto T97Oe; vEWwI: bVBwX: goto jfhgM; DwFIC: $this->set_error("\x67\x72\157\165\x70\x5f\144\x65\x6c\x65\x74\x65\137\165\156\163\x75\x63\143\x65\x73\163\146\x75\x6c"); goto vvmpB; YEpS_: } public function set_hook($event, $name, $class, $method, $arguments) { goto aW6sk; hYTGO: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto QOBYy; sRzGk: $this->_ion_hooks->{$event}[$name]->class = $class; goto ca1XZ; ca1XZ: $this->_ion_hooks->{$event}[$name]->method = $method; goto hYTGO; aW6sk: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto sRzGk; QOBYy: } public function remove_hook($event, $name) { goto o8S6g; o8S6g: if (!isset($this->_ion_hooks->{$event}[$name])) { goto yp1Hc; } goto lthra; lthra: unset($this->_ion_hooks->{$event}[$name]); goto dokEB; dokEB: yp1Hc: goto Ml9WR; Ml9WR: } public function remove_hooks($event) { goto rHgvR; rHgvR: if (!isset($this->_ion_hooks->{$event})) { goto nh1L8; } goto iQ7kL; enVjf: nh1L8: goto D42h2; iQ7kL: unset($this->_ion_hooks->{$event}); goto enVjf; D42h2: } protected function _call_hook($event, $name) { goto IQwpV; rc0mO: Uyy4O: goto oiC7o; oiC7o: return FALSE; goto sJzOY; mh9SB: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto rc0mO; Lru_6: $hook = $this->_ion_hooks->{$event}[$name]; goto mh9SB; IQwpV: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto Uyy4O; } goto Lru_6; sJzOY: } public function trigger_events($events) { goto WOAlH; innbz: goto AKeit; goto r3odP; OHWgu: rmfBb: goto Ims9_; by5b_: Gco7i: goto qs8FH; pZRBz: foreach ($events as $event) { $this->trigger_events($event); XqtyF: } goto OHWgu; Ims9_: AKeit: goto kvCS8; AzXyS: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto gD6BV; } goto BAulE; BAulE: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); N1dRd: } goto by5b_; r3odP: uCjoo: goto pZRBz; qs8FH: gD6BV: goto innbz; WOAlH: if (is_array($events) && !empty($events)) { goto uCjoo; } goto AzXyS; kvCS8: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto wLLYz; d21Y3: $this->message_end_delimiter = $end_delimiter; goto XnWi2; XnWi2: return TRUE; goto ZZ6wW; wLLYz: $this->message_start_delimiter = $start_delimiter; goto d21Y3; ZZ6wW: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto PPhdS; CFKic: $this->error_end_delimiter = $end_delimiter; goto b1tr8; b1tr8: return TRUE; goto UL1HK; PPhdS: $this->error_start_delimiter = $start_delimiter; goto CFKic; UL1HK: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto kVkOW; jyB2t: return $_output; goto qWVU_; kVkOW: $_output = ''; goto rvz1V; rvz1V: foreach ($this->messages as $message) { goto FqhGt; B7kn2: PSmtK: goto v3Zp9; FqhGt: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\43"; goto ALDIJ; ALDIJ: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto B7kn2; v3Zp9: } goto oAaOG; oAaOG: pvs2b: goto jyB2t; qWVU_: } public function messages_array($langify = TRUE) { goto LRVjk; TdtgM: k8Hic: goto LoNrC; g91bM: foreach ($this->messages as $message) { goto IFcGv; H0uYZ: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto rTuKw; IFcGv: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\43"; goto H0uYZ; rTuKw: pcxAG: goto PbZX3; PbZX3: } goto ECX9e; TqdVU: goto I3p7r; goto TdtgM; ve63y: I3p7r: goto dSj4c; jXnWO: return $_output; goto ve63y; LoNrC: $_output = []; goto g91bM; LRVjk: if ($langify) { goto k8Hic; } goto exuhk; exuhk: return $this->messages; goto TqdVU; ECX9e: n8jkj: goto jXnWO; dSj4c: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto Ow2dI; joF_K: return $_output; goto lagG3; Ow2dI: $_output = ''; goto Rr_km; Rr_km: foreach ($this->errors as $error) { goto xc7Sa; WpU_p: mWOxv: goto LrFHN; xc7Sa: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\43"; goto YyrWg; YyrWg: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto WpU_p; LrFHN: } goto QzKHt; QzKHt: E1LIM: goto joF_K; lagG3: } public function errors_array($langify = TRUE) { goto N4jkG; snCHN: Vptmc: goto QZNgF; nqOqq: return $this->errors; goto eWOCi; eWOCi: goto SEkXU; goto d1h5L; d1h5L: o46EB: goto J3HQ1; J3HQ1: $_output = []; goto J6GwW; J6GwW: foreach ($this->errors as $error) { goto z4wPD; ndPVu: egR0x: goto GdEj6; z4wPD: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto Hxfa6; Hxfa6: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto ndPVu; GdEj6: } goto snCHN; N4jkG: if ($langify) { goto o46EB; } goto nqOqq; QZNgF: return $_output; goto eguIX; eguIX: SEkXU: goto tErZp; tErZp: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto P151a; L2P0U: return FALSE; goto cdP5P; cdP5P: DczoA: goto KvO9L; s1F4T: $this->trigger_events("\x65\170\164\x72\x61\x5f\167\150\145\162\145"); goto oVvYh; wr03t: if (!($hash === FALSE)) { goto DczoA; } goto L2P0U; P151a: $hash = $this->hash_password($password, $identity); goto wr03t; oVvYh: $this->db->update($this->tables["\165\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto In7D0; KvO9L: $data = ["\x70\x61\163\x73\x77\x6f\x72\144" => $hash, "\x72\x65\155\145\x6d\x62\145\x72\x5f\143\157\x64\x65" => NULL, "\x66\157\162\x67\x6f\x74\164\145\x6e\137\x70\141\x73\163\x77\x6f\162\x64\137\143\x6f\144\145" => NULL, "\x66\x6f\x72\x67\157\164\164\145\156\x5f\160\x61\163\x73\167\x6f\x72\144\137\x74\151\x6d\145" => NULL]; goto s1F4T; In7D0: return $this->db->affected_rows() == 1; goto olwYu; olwYu: } protected function _filter_data($table, $data) { goto mGS1x; aGas0: $columns = $this->db->list_fields($table); goto q8m8Z; mGS1x: $filtered_data = []; goto aGas0; q8m8Z: if (!is_array($data)) { goto swisF; } goto eXW1V; BRiAQ: return $filtered_data; goto LWBEZ; NJB4S: swisF: goto BRiAQ; eXW1V: foreach ($columns as $column) { goto d9gRP; d9gRP: if (!array_key_exists($column, $data)) { goto mR_w0; } goto FLoJM; K3g9r: mR_w0: goto OfbVT; OfbVT: vPnfk: goto uz2Tx; FLoJM: $filtered_data[$column] = $data[$column]; goto K3g9r; uz2Tx: } goto k_GAy; k_GAy: MJMPY: goto NJB4S; LWBEZ: } protected function _random_token($result_length = 32) { goto J_Hsu; P4s_i: $result_length = 32; goto k2XIW; Z4z4V: return FALSE; goto a41sH; z9cUz: if (!function_exists("\157\x70\x65\x6e\x73\x73\154\x5f\162\141\x6e\x64\x6f\x6d\x5f\160\163\x65\165\144\x6f\x5f\x62\x79\x74\x65\163")) { goto rYEyx; } goto czR0v; j72mm: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto AoMES; ue_4t: cS6ZT: goto vrC35; QtVM8: if (!function_exists("\162\141\156\144\x6f\155\137\142\171\164\x65\x73")) { goto cS6ZT; } goto gWc7Q; snOwk: rYEyx: goto Z4z4V; czR0v: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto snOwk; k2XIW: wlPGc: goto QtVM8; vrC35: if (!function_exists("\x6d\x63\x72\171\x70\164\x5f\x63\162\145\141\164\x65\x5f\x69\166")) { goto glhrE; } goto j72mm; J_Hsu: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto wlPGc; } goto P4s_i; gWc7Q: return bin2hex(random_bytes($result_length / 2)); goto ue_4t; AoMES: glhrE: goto z9cUz; a41sH: } protected function _get_hash_parameters($identity = NULL) { goto XvvfO; GTeUA: INOTo: goto pEUhj; dEAac: bCaZv: goto F4oUL; oK337: $is_admin = TRUE; goto EesJE; XvvfO: $is_admin = FALSE; goto F4e8Y; Rx4Aw: Wdjb4: goto dEAac; F4oUL: return $params; goto QkiQu; pEUhj: $params = FALSE; goto DeSBD; xE_6K: $user_id = $this->get_user_id_from_identity($identity); goto BKeMa; DeSBD: switch ($this->hash_method) { case "\142\143\162\171\x70\164": $params = ["\143\x6f\x73\x74" => $is_admin ? $this->config->item("\x62\143\x72\171\x70\x74\x5f\141\144\x6d\x69\156\x5f\143\157\163\x74", "\151\x6f\x6e\137\141\x75\x74\150") : $this->config->item("\142\143\x72\x79\x70\x74\137\144\145\x66\141\x75\154\164\137\x63\157\x73\164", "\151\x6f\156\x5f\141\x75\x74\x68")]; goto bCaZv; case "\x61\162\x67\x6f\156\x32": $params = $is_admin ? $this->config->item("\x61\x72\x67\x6f\x6e\x32\137\x61\x64\x6d\x69\x6e\137\160\141\162\x61\155\x73", "\151\x6f\x6e\137\141\165\164\150") : $this->config->item("\141\x72\x67\157\156\x32\x5f\144\145\146\141\165\154\164\x5f\160\141\162\141\155\x73", "\x69\157\156\x5f\141\x75\164\x68"); goto bCaZv; default: } goto Rx4Aw; BKeMa: if (!($user_id && $this->in_group($this->config->item("\x61\x64\155\x69\156\137\x67\162\x6f\165\160", "\151\157\x6e\137\141\165\164\x68"), $user_id))) { goto gB0jt; } goto oK337; EesJE: gB0jt: goto GTeUA; F4e8Y: if (!$identity) { goto INOTo; } goto xE_6K; QkiQu: } protected function _get_hash_algo() { goto PCWYw; PCWYw: $algo = FALSE; goto bIAJ8; bIAJ8: switch ($this->hash_method) { case "\142\143\162\171\160\164": $algo = PASSWORD_BCRYPT; goto ddFJq; case "\x61\162\147\x6f\x6e\x32": $algo = PASSWORD_ARGON2I; goto ddFJq; default: } goto QUS6K; QUS6K: b8KXk: goto VjP90; IopSQ: return $algo; goto Y5vBa; VjP90: ddFJq: goto IopSQ; Y5vBa: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto zESA4; sbxPg: return (object) ["\163\145\x6c\145\143\x74\157\x72" => $selector, "\166\141\154\x69\144\x61\164\157\162\x5f\x68\x61\163\x68\x65\144" => $validator_hashed, "\165\163\x65\x72\x5f\143\x6f\144\x65" => $user_code]; goto BYhik; XvnyE: $validator_hashed = $this->hash_password($validator); goto qIDA3; zESA4: $selector = $this->_random_token($selector_size); goto TI0GC; TI0GC: $validator = $this->_random_token($validator_size); goto XvnyE; qIDA3: $user_code = "{$selector}\56{$validator}"; goto sbxPg; BYhik: } protected function _retrieve_selector_validator_couple($user_code) { goto VX_TU; Q05Yg: if (!(count($tokens) === 2)) { goto acmf1; } goto ar_MY; ar_MY: return (object) ["\x73\145\154\x65\x63\x74\x6f\162" => $tokens[0], "\166\141\x6c\x69\x64\141\x74\x6f\x72" => $tokens[1]]; goto SiUKx; SiUKx: acmf1: goto dhSY7; guU42: return FALSE; goto hUMD9; VX_TU: if (!$user_code) { goto nnANk; } goto Zt76G; Zt76G: $tokens = explode("\56", $user_code); goto Q05Yg; dhSY7: nnANk: goto guU42; hUMD9: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto vU5A5; K91zj: if ($this->config->item("\x73\164\x6f\162\145\x5f\x73\x61\x6c\164", "\151\157\x6e\137\141\165\x74\x68")) { goto ye0xs; } goto D_Usu; fqrRY: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto c05MP; ndybN: $this->trigger_events(["\160\157\163\x74\x5f\163\150\141\x31\137\160\x61\x73\x73\x77\x6f\162\144\x5f\x6d\x69\x67\162\141\x74\x69\157\x6e", "\x70\157\x73\164\x5f\x73\150\x61\61\x5f\x70\141\163\163\x77\x6f\162\144\x5f\x6d\151\x67\x72\141\x74\151\x6f\156\x5f\x73\x75\143\x63\x65\x73\x73\x66\x75\154"]); goto BAnN2; tiLoz: $query = $this->db->select("\163\x61\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\163"]); goto AnbyM; jxQuO: $hashed_password = sha1($password . $salt_db->salt); goto Iy0Je; Q2Wwx: return $result; goto b0oQI; NfWHN: $this->trigger_events(["\x70\157\x73\164\x5f\163\x68\141\61\137\x70\141\163\x73\167\x6f\162\x64\x5f\155\151\147\162\141\x74\151\157\156", "\160\x6f\x73\x74\137\163\x68\x61\61\137\x70\x61\163\x73\167\157\162\144\137\155\151\147\162\x61\164\x69\x6f\156\x5f\165\x6e\x73\x75\x63\x63\x65\163\163\146\165\x6c"]); goto d3LA3; YBM85: goto QupOh; goto GtkwQ; M543Y: $this->trigger_events(["\160\x6f\x73\164\x5f\163\x68\141\x31\137\x70\141\x73\x73\167\157\162\x64\x5f\155\x69\x67\x72\141\164\151\157\x6e", "\160\157\163\x74\137\163\150\x61\61\137\160\141\163\163\x77\x6f\x72\x64\x5f\155\151\147\x72\141\164\151\157\x6e\137\165\x6e\x73\x75\x63\x63\145\163\163\x66\165\154"]); goto kBYKa; F0pZx: $salt = substr($hashed_password_db, 0, $salt_length); goto fqrRY; gQ5gk: ciy_l: goto Gu1MA; Na2zB: if ($hashed_password === $hashed_password_db) { goto ciy_l; } goto M543Y; jqheZ: ye0xs: goto tiLoz; GtkwQ: Yg_SG: goto ndybN; vGWCA: return FALSE; goto klBb2; Xuabn: Rw7cX: goto F0pZx; kBYKa: return FALSE; goto ELGWd; FOJdh: if (!($query->num_rows() !== 1)) { goto VFKbJ; } goto RlPYW; BAnN2: QupOh: goto Q2Wwx; d3LA3: return FALSE; goto Xuabn; klBb2: VFKbJ: goto jxQuO; AnbyM: $salt_db = $query->row(); goto FOJdh; ELGWd: goto O_r7H; goto gQ5gk; QKxQa: if ($salt_length) { goto Rw7cX; } goto NfWHN; b0oQI: O_r7H: goto ea37R; vU5A5: $this->trigger_events("\x70\x72\145\137\163\150\x61\x31\137\x70\141\x73\163\167\157\162\144\x5f\155\x69\147\162\141\x74\151\157\x6e"); goto K91zj; Iy0Je: wY2Lg: goto Na2zB; RlPYW: $this->trigger_events(["\160\157\x73\164\137\163\150\141\61\137\x70\x61\163\163\x77\157\x72\144\x5f\155\151\147\x72\141\164\x69\x6f\x6e", "\160\x6f\x73\164\137\x73\x68\x61\x31\x5f\x70\141\x73\x73\x77\x6f\x72\144\137\155\151\x67\x72\141\x74\151\157\x6e\137\x75\x6e\x73\165\x63\x63\145\x73\x73\x66\165\x6c"]); goto vGWCA; b5DhG: $this->trigger_events(["\x70\157\163\164\x5f\x73\x68\141\61\137\x70\141\163\163\167\157\x72\x64\x5f\x6d\x69\x67\x72\141\x74\x69\x6f\x6e", "\160\x6f\163\164\x5f\x73\150\x61\x31\x5f\160\x61\x73\163\x77\x6f\162\144\137\155\151\147\162\x61\x74\x69\x6f\156\137\165\x6e\163\x75\143\143\145\x73\163\x66\165\154"]); goto YBM85; Gu1MA: $result = $this->_set_password_db($identity, $password); goto z_yDi; z_yDi: if ($result) { goto Yg_SG; } goto b5DhG; D_Usu: $salt_length = $this->config->item("\x73\x61\x6c\x74\137\x6c\x65\x6e\147\x74\150", "\x69\157\x6e\x5f\141\x75\164\x68"); goto QKxQa; c05MP: goto wY2Lg; goto jqheZ; ea37R: } }
