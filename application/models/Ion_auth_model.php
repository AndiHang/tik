<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\x45\120\101\x54\x48") or exit("\x4e\x6f\x20\144\x69\x72\x65\x63\x74\40\x73\143\x72\151\160\164\x20\141\x63\x63\x65\x73\163\40\x61\x6c\x6c\x6f\167\145\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto d2_9Q; NtFgy: eQSCj: goto sW2Nc; JKm2i: goto u12It; goto r8E7B; dmj6y: $group_name = $this->config->item("\144\141\164\141\142\x61\x73\x65\x5f\147\x72\x6f\x75\x70\137\156\141\x6d\x65", "\x69\157\x6e\137\x61\x75\x74\x68"); goto e6Jv5; P2Gu9: $this->load->helper("\144\x61\x74\145"); goto h6c2z; E44jg: $this->_ion_hooks = new stdClass(); goto m1Ogo; MtOCS: $this->message_end_delimiter = $this->error_end_delimiter; goto IP9DI; d4k7B: if ($delimiters_source === "\x66\157\x72\155\x5f\x76\x61\x6c\151\x64\x61\164\151\x6f\x6e") { goto E6smL; } goto L48Mi; KNiCk: $error_suffix = $form_validation_class->getProperty("\x5f\x65\162\162\157\162\x5f\x73\165\x66\146\x69\170"); goto QHyIR; Atk8y: $error_prefix = $form_validation_class->getProperty("\x5f\x65\162\162\157\162\x5f\x70\162\x65\146\151\x78"); goto nPV8n; Go7AT: $this->error_start_delimiter = $this->config->item("\145\162\162\x6f\162\137\163\164\x61\x72\164\137\x64\145\154\x69\x6d\x69\x74\x65\x72", "\x69\157\156\x5f\x61\165\164\150"); goto FwgkE; r8E7B: E6smL: goto DDgkC; L48Mi: $this->message_start_delimiter = $this->config->item("\155\145\163\163\x61\x67\x65\x5f\x73\x74\141\x72\x74\137\144\x65\154\151\x6d\x69\164\x65\x72", "\x69\157\x6e\137\141\x75\x74\x68"); goto rk40Q; m1Ogo: $this->trigger_events("\155\157\x64\145\154\x5f\143\x6f\156\x73\164\162\165\x63\164\x6f\162"); goto BcyKj; sW2Nc: $CI =& get_instance(); goto hvgmO; QHyIR: $error_suffix->setAccessible(TRUE); goto MnTBU; IP9DI: u12It: goto E44jg; ljdht: goto g9bWh; goto NtFgy; h6c2z: $this->lang->load("\x69\157\156\x5f\141\x75\164\150"); goto dmj6y; d2_9Q: $this->config->load("\x69\157\x6e\137\141\x75\164\150", TRUE); goto mCKGZ; WEmow: $this->join = $this->config->item("\152\157\151\156", "\x69\157\156\137\141\x75\x74\x68"); goto budPP; qtJuv: $delimiters_source = $this->config->item("\144\145\154\x69\155\x69\164\x65\x72\x73\137\x73\x6f\x75\x72\143\x65", "\151\157\156\137\x61\x75\164\150"); goto d4k7B; mCKGZ: $this->load->helper("\x63\157\x6f\153\151\x65"); goto P2Gu9; XWUfx: $this->identity_column = $this->config->item("\x69\144\x65\156\164\151\164\x79", "\x69\157\x6e\137\x61\165\164\150"); goto WEmow; nPV8n: $error_prefix->setAccessible(TRUE); goto JeEEH; XgpXl: $this->errors = []; goto qtJuv; s313Y: g9bWh: goto ifn2W; xKEpj: $form_validation_class = new ReflectionClass("\x43\111\x5f\106\157\x72\x6d\x5f\166\x61\x6c\x69\144\x61\x74\x69\x6f\156"); goto Atk8y; e6Jv5: if (empty($group_name)) { goto eQSCj; } goto Q90x4; budPP: $this->hash_method = $this->config->item("\150\141\163\x68\137\x6d\x65\x74\x68\x6f\x64", "\x69\157\156\x5f\x61\165\164\x68"); goto jQ3bu; MnTBU: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto MtOCS; DDgkC: $this->load->library("\146\x6f\162\155\137\166\x61\x6c\151\144\x61\164\x69\157\x6e"); goto xKEpj; Q90x4: $this->db = $this->load->database($group_name, TRUE, TRUE); goto ljdht; JeEEH: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto DH1NK; ifn2W: $this->tables = $this->config->item("\164\x61\x62\154\145\163", "\151\x6f\156\x5f\141\165\x74\150"); goto XWUfx; rk40Q: $this->message_end_delimiter = $this->config->item("\155\x65\163\x73\141\x67\x65\137\145\156\x64\137\x64\145\154\151\x6d\x69\164\145\162", "\151\157\156\137\x61\x75\x74\150"); goto Go7AT; jQ3bu: $this->messages = []; goto XgpXl; hvgmO: $this->db = $CI->db; goto s313Y; FwgkE: $this->error_end_delimiter = $this->config->item("\x65\162\162\157\162\137\x65\156\x64\x5f\144\x65\x6c\x69\155\x69\164\145\162", "\x69\157\x6e\x5f\x61\165\164\x68"); goto JKm2i; DH1NK: $this->message_start_delimiter = $this->error_start_delimiter; goto KNiCk; BcyKj: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto sdyl_; WEfeB: return FALSE; goto mp6Rc; nIwAZ: dlT4n: goto sICwf; Ib986: if (!($algo !== FALSE && $params !== FALSE)) { goto V8wXc; } goto mg82u; sdyl_: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto dlT4n; } goto tQA8A; tQA8A: return FALSE; goto nIwAZ; mg82u: return password_hash($password, $algo, $params); goto biHzY; sICwf: $algo = $this->_get_hash_algo(); goto IYOy0; IYOy0: $params = $this->_get_hash_parameters($identity); goto Ib986; biHzY: V8wXc: goto WEfeB; mp6Rc: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto gvqNf; dHPgB: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto iKs7v; iKs7v: goto fxV15; goto GADrF; fAjSW: return FALSE; goto I84Gi; GADrF: pea99: goto je0aE; doXNe: fxV15: goto S22nj; gvqNf: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto zO3oF; } goto fAjSW; dsC_C: if (strpos($hash_password_db, "\44") === 0) { goto pea99; } goto dHPgB; je0aE: return password_verify($password, $hash_password_db); goto doXNe; I84Gi: zO3oF: goto dsC_C; S22nj: } public function rehash_password_if_needed($hash, $identity, $password) { goto moz12; BKylB: if (!($algo !== FALSE && $params !== FALSE)) { goto fG1Jp; } goto IizNn; IizNn: if (!password_needs_rehash($hash, $algo, $params)) { goto gr3MO; } goto K4RVH; K4RVH: if ($this->_set_password_db($identity, $password)) { goto aL0AP; } goto DGYPJ; yTMau: aL0AP: goto EjGSs; EjGSs: $this->trigger_events(["\162\145\x68\x61\163\x68\x5f\160\141\x73\x73\167\157\x72\x64", "\x72\145\x68\x61\163\150\x5f\160\141\163\163\167\157\x72\144\137\x73\165\143\143\x65\x73\163\146\165\154"]); goto EpebY; XGh63: fG1Jp: goto TPRoK; S370R: goto bb2ZF; goto yTMau; DGYPJ: $this->trigger_events(["\162\x65\150\x61\x73\x68\137\160\x61\x73\x73\x77\157\162\x64", "\162\x65\x68\x61\163\150\x5f\x70\141\x73\x73\167\157\x72\x64\x5f\165\x6e\x73\x75\143\143\x65\x73\163\x66\165\x6c"]); goto S370R; EpebY: bb2ZF: goto MlD1R; MlD1R: gr3MO: goto XGh63; moz12: $algo = $this->_get_hash_algo(); goto Z5mnk; Z5mnk: $params = $this->_get_hash_parameters($identity); goto BKylB; TPRoK: } public function get_user_by_activation_code($user_code) { goto oBnhH; rysQA: return $user; goto AI2TP; hFWO7: if (!$this->verify_password($token->validator, $user->activation_code)) { goto Y8k6t; } goto rysQA; AI2TP: Y8k6t: goto tGVhs; rPusO: $user = $this->where("\141\143\164\x69\x76\x61\x74\x69\157\156\x5f\x73\x65\x6c\x65\x63\x74\x6f\x72", $token->selector)->users()->row(); goto ldd7t; pOhab: return FALSE; goto rD7w4; oBnhH: $token = $this->_retrieve_selector_validator_couple($user_code); goto rPusO; tGVhs: iHwwv: goto pOhab; ldd7t: if (!$user) { goto iHwwv; } goto hFWO7; rD7w4: } public function activate($id, $code = FALSE) { goto W2JJi; W2JJi: $this->trigger_events("\160\162\x65\137\141\x63\x74\151\166\141\164\x65"); goto sct_6; rMP0G: $this->db->update($this->tables["\x75\x73\x65\x72\163"], $data, ["\151\x64" => $id]); goto nxz7G; Dlosl: iGymd: goto Cn7ya; M4fT7: return TRUE; goto Dlosl; mAYsV: $data = ["\141\143\164\x69\166\141\164\x69\157\x6e\x5f\x73\x65\x6c\145\143\x74\x6f\x72" => NULL, "\x61\143\164\151\x76\x61\x74\151\157\x6e\137\x63\157\144\x65" => NULL, "\141\143\x74\151\x76\x65" => 1]; goto A37sd; jdWEL: return FALSE; goto MKEJl; GEjNK: $user = $this->get_user_by_activation_code($code); goto sB_yL; UNtN9: $this->set_error("\x61\143\164\151\166\x61\164\145\x5f\x75\156\x73\165\x63\x63\145\x73\163\x66\165\154"); goto jdWEL; sct_6: if (!($code !== FALSE)) { goto ujS7e; } goto GEjNK; sB_yL: ujS7e: goto Z9WIA; h5aT7: $this->trigger_events(["\160\x6f\x73\164\137\141\x63\164\x69\x76\x61\x74\x65", "\160\157\163\164\x5f\141\x63\164\151\x76\141\x74\x65\137\165\x6e\x73\x75\143\143\x65\163\x73\x66\165\154"]); goto UNtN9; Cn7ya: zw4YP: goto h5aT7; dA8wf: $this->trigger_events(["\x70\x6f\163\x74\137\141\143\x74\x69\166\x61\x74\x65", "\160\x6f\x73\164\x5f\141\143\164\x69\x76\x61\164\145\x5f\163\x75\x63\143\x65\163\163\146\x75\x6c"]); goto TvZWR; Z9WIA: if (!($code === FALSE || $user && $user->id === $id)) { goto zw4YP; } goto mAYsV; TvZWR: $this->set_message("\x61\143\x74\x69\166\141\164\x65\137\163\x75\x63\x63\x65\163\163\x66\165\154"); goto M4fT7; nxz7G: if (!($this->db->affected_rows() === 1)) { goto iGymd; } goto dA8wf; A37sd: $this->trigger_events("\145\x78\164\x72\141\x5f\x77\150\145\x72\x65"); goto rMP0G; MKEJl: } public function deactivate($id = NULL) { goto jABxK; fiELL: $this->set_error("\144\x65\141\x63\x74\151\166\x61\164\x65\x5f\165\156\x73\x75\x63\x63\x65\163\x73\146\165\x6c"); goto DKGVD; oQk_P: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto t7TjL; } goto fgb9I; bE37Z: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $data, ["\x69\144" => $id]); goto Wcdao; X9gpa: $this->activation_code = $token->user_code; goto D8Ct6; XCDxz: t7TjL: goto wA3Hf; uA74u: w_vpk: goto pD5KL; wA3Hf: goto dd1Tj; goto Egowr; Wcdao: $return = $this->db->affected_rows() == 1; goto BgmiW; DKGVD: goto w_vpk; goto JnCK2; pD5KL: return $return; goto FJRPz; ItoMj: dd1Tj: goto Ok9Rm; D8Ct6: $data = ["\141\x63\x74\x69\x76\141\164\x69\x6f\156\137\163\145\x6c\x65\143\x74\157\x72" => $token->selector, "\141\x63\x74\x69\166\141\164\151\157\156\x5f\143\157\x64\x65" => $token->validator_hashed, "\141\x63\164\x69\x76\145" => 0]; goto DZIT6; Ok9Rm: $token = $this->_generate_selector_validator_couple(20, 40); goto X9gpa; JnCK2: Rh6LR: goto TvZDp; Gtgo_: $this->set_error("\x64\145\141\143\164\x69\x76\141\x74\x65\137\165\x6e\x73\x75\x63\x63\145\163\163\x66\165\x6c"); goto N1gQt; Egowr: R8z1y: goto Gtgo_; jABxK: $this->trigger_events("\x64\145\141\x63\164\x69\x76\141\x74\145"); goto gN6at; fgb9I: $this->set_error("\144\145\x61\143\x74\x69\x76\141\x74\x65\137\x63\165\x72\162\x65\156\x74\137\x75\163\145\162\137\165\156\x73\x75\143\143\x65\x73\163\x66\x75\x6c"); goto KLtXt; DZIT6: $this->trigger_events("\145\x78\x74\162\141\x5f\167\x68\x65\x72\145"); goto bE37Z; N1gQt: return FALSE; goto ItoMj; KLtXt: return FALSE; goto XCDxz; TvZDp: $this->set_message("\144\145\141\143\164\x69\166\x61\164\145\137\163\165\x63\x63\x65\x73\x73\146\x75\x6c"); goto uA74u; BgmiW: if ($return) { goto Rh6LR; } goto fiELL; gN6at: if (!isset($id)) { goto R8z1y; } goto oQk_P; FJRPz: } public function clear_forgotten_password_code($identity) { goto Q0p_Z; XtWCI: $data = ["\146\157\x72\x67\157\164\x74\145\x6e\137\160\141\163\163\x77\157\162\144\137\163\x65\x6c\x65\x63\164\x6f\162" => NULL, "\x66\x6f\162\147\157\x74\x74\x65\156\x5f\x70\141\x73\x73\x77\157\x72\x64\x5f\143\x6f\144\145" => NULL, "\x66\157\162\x67\x6f\164\x74\145\156\x5f\160\x61\163\x73\x77\x6f\x72\144\x5f\164\151\x6d\x65" => NULL]; goto BWWxz; Q0p_Z: if (!empty($identity)) { goto Z3A7c; } goto tHnMu; BWWxz: $this->db->update($this->tables["\165\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto eBD_U; NABVv: Z3A7c: goto XtWCI; eBD_U: return TRUE; goto tyokg; tHnMu: return FALSE; goto NABVv; tyokg: } public function clear_remember_code($identity) { goto TXQFI; TXQFI: if (!empty($identity)) { goto WkRr6; } goto DHrYH; Oz2iR: $this->db->update($this->tables["\x75\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto NMpC1; DHrYH: return FALSE; goto BI0kI; SsSND: $data = ["\x72\x65\x6d\145\x6d\x62\145\162\137\x73\x65\154\145\x63\x74\157\162" => NULL, "\x72\x65\x6d\x65\155\x62\145\x72\x5f\143\157\144\145" => NULL]; goto Oz2iR; BI0kI: WkRr6: goto SsSND; NMpC1: return TRUE; goto EOCUk; EOCUk: } public function reset_password($identity, $new) { goto dCnXP; AZ2Ql: $return = $this->_set_password_db($identity, $new); goto c2760; qWqA8: FbQSr: goto UpQsy; MZhAV: $this->trigger_events(["\x70\157\x73\164\137\143\x68\141\x6e\x67\x65\x5f\160\x61\x73\163\x77\157\x72\144", "\160\157\163\164\x5f\143\x68\141\x6e\147\145\137\x70\x61\x73\163\x77\157\x72\x64\137\x75\156\x73\x75\143\x63\x65\x73\x73\x66\x75\154"]); goto CTQfZ; ERPiV: if ($this->identity_check($identity)) { goto AvFUg; } goto rNjQp; UpQsy: return $return; goto yZ02f; KJHwA: kEQ14: goto OLNly; gYZH6: $this->set_message("\160\141\163\x73\x77\157\x72\x64\x5f\x63\x68\141\156\x67\x65\x5f\x73\165\x63\x63\145\x73\163\146\165\154"); goto qWqA8; Cfd32: AvFUg: goto AZ2Ql; c2760: if ($return) { goto kEQ14; } goto MZhAV; VPSVd: return FALSE; goto Cfd32; rNjQp: $this->trigger_events(["\x70\157\x73\x74\137\x63\150\141\x6e\147\145\137\160\141\x73\163\x77\x6f\162\x64", "\160\x6f\163\x74\137\143\x68\141\x6e\x67\145\x5f\160\x61\163\163\167\157\x72\144\137\x75\x6e\x73\165\x63\143\145\163\163\x66\x75\154"]); goto VPSVd; AZsTB: goto FbQSr; goto KJHwA; CTQfZ: $this->set_error("\x70\141\163\163\x77\x6f\x72\144\137\x63\x68\x61\156\x67\x65\x5f\x75\x6e\163\x75\x63\x63\x65\163\163\146\165\154"); goto AZsTB; OLNly: $this->trigger_events(["\x70\x6f\x73\x74\137\x63\x68\x61\x6e\x67\145\x5f\160\141\x73\163\167\157\162\144", "\160\x6f\163\164\137\x63\x68\141\156\147\145\137\160\141\163\x73\167\157\162\x64\137\163\x75\x63\x63\x65\163\x73\146\165\154"]); goto gYZH6; dCnXP: $this->trigger_events("\160\162\145\x5f\143\x68\x61\x6e\147\x65\137\x70\x61\163\163\x77\x6f\162\144"); goto ERPiV; yZ02f: } public function change_password($identity, $old, $new) { goto wCtOn; PfqC0: if ($result) { goto g6vFD; } goto V56YQ; SZr_A: $query = $this->db->select("\151\144\54\x20\160\x61\x73\163\x77\157\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\145\x73\x63")->get($this->tables["\165\x73\x65\x72\163"]); goto znZWs; ve9LM: return FALSE; goto od2gF; ErnTN: $this->set_error("\x70\x61\163\163\x77\157\x72\144\137\143\x68\141\156\147\145\x5f\x75\x6e\x73\x75\143\x63\x65\163\163\x66\165\154"); goto ve9LM; jhZIi: o_Jwx: goto ErnTN; pOL4f: return $result; goto jhZIi; YOHGJ: goto SkgvI; goto Be77d; O5ldO: if (!$this->verify_password($old, $user->password, $identity)) { goto o_Jwx; } goto waHuv; y_ERP: SkgvI: goto pOL4f; rUYrM: $user = $query->row(); goto O5ldO; wCtOn: $this->trigger_events("\x70\x72\x65\137\x63\150\141\156\x67\x65\x5f\x70\x61\163\x73\x77\x6f\x72\x64"); goto JomyJ; Be77d: g6vFD: goto MlJ_c; JomyJ: $this->trigger_events("\x65\x78\164\x72\x61\137\167\150\145\x72\145"); goto SZr_A; jah0b: $this->trigger_events(["\160\x6f\x73\x74\137\143\150\141\x6e\x67\x65\x5f\160\x61\163\163\167\x6f\162\x64", "\x70\x6f\x73\164\x5f\143\150\x61\156\x67\x65\x5f\x70\x61\x73\x73\x77\157\162\144\137\165\x6e\163\165\x63\143\145\x73\163\146\x75\x6c"]); goto s4WXk; MlJ_c: $this->trigger_events(["\160\157\x73\164\137\143\150\x61\156\x67\145\x5f\160\x61\x73\x73\x77\157\x72\144", "\160\x6f\163\164\137\143\150\x61\x6e\x67\145\x5f\160\x61\x73\x73\x77\157\x72\x64\x5f\x73\165\143\143\145\x73\163\x66\x75\154"]); goto IxAtY; waHuv: $result = $this->_set_password_db($identity, $new); goto PfqC0; ssghS: return FALSE; goto SrF4G; s4WXk: $this->set_error("\x70\x61\163\163\167\157\162\x64\x5f\143\150\x61\x6e\x67\145\x5f\x75\156\x73\165\143\x63\145\163\163\x66\165\154"); goto ssghS; IxAtY: $this->set_message("\x70\x61\x73\x73\x77\x6f\162\144\x5f\143\150\141\156\147\145\137\163\x75\x63\143\145\163\x73\x66\165\154"); goto y_ERP; znZWs: if (!($query->num_rows() !== 1)) { goto bscRn; } goto jah0b; SrF4G: bscRn: goto rUYrM; iPTxF: $this->set_error("\160\141\163\x73\x77\157\x72\x64\137\143\x68\x61\x6e\147\x65\x5f\165\x6e\x73\165\x63\143\145\163\163\x66\165\154"); goto YOHGJ; V56YQ: $this->trigger_events(["\x70\157\163\164\137\x63\150\141\156\147\145\x5f\x70\141\163\163\167\x6f\x72\144", "\160\x6f\x73\x74\137\143\x68\141\156\147\145\137\x70\141\x73\163\167\x6f\x72\x64\x5f\165\x6e\x73\x75\143\143\145\x73\x73\x66\x75\154"]); goto iPTxF; od2gF: } public function username_check($username = '') { goto LO1X1; AxPqP: X0srM: goto nYsFE; F0rx1: return $this->db->where("\x75\x73\x65\x72\156\141\x6d\145", $username)->limit(1)->count_all_results($this->tables["\x75\x73\x65\x72\x73"]) > 0; goto gJWkw; TB0lR: return FALSE; goto AxPqP; LO1X1: $this->trigger_events("\x75\x73\145\x72\156\x61\x6d\145\x5f\x63\150\x65\x63\x6b"); goto x0pe5; nYsFE: $this->trigger_events("\x65\x78\x74\x72\141\x5f\167\150\145\162\145"); goto F0rx1; x0pe5: if (!empty($username)) { goto X0srM; } goto TB0lR; gJWkw: } public function email_check($email = '') { goto lNCYH; Z39Vm: oycS3: goto otk17; VI8wR: return FALSE; goto Z39Vm; lNCYH: $this->trigger_events("\145\x6d\x61\x69\154\137\143\150\x65\143\x6b"); goto Orczn; Orczn: if (!empty($email)) { goto oycS3; } goto VI8wR; OsilK: return $this->db->where("\145\x6d\x61\x69\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\145\162\x73"]) > 0; goto Q7k6a; otk17: $this->trigger_events("\x65\170\x74\162\x61\x5f\x77\x68\145\162\x65"); goto OsilK; Q7k6a: } public function identity_check($identity = '') { goto yyXjg; MxeqM: return FALSE; goto nGdAx; RjrC1: if (!empty($identity)) { goto AMIm3; } goto MxeqM; yyXjg: $this->trigger_events("\x69\144\x65\156\x74\x69\x74\x79\x5f\143\150\x65\143\153"); goto RjrC1; ZFl0P: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\x73\x65\162\x73"]) > 0; goto heGSr; nGdAx: AMIm3: goto ZFl0P; heGSr: } public function get_user_id_from_identity($identity = '') { goto t_AO3; J3ZT9: CV8Hn: goto MmJs0; WZfS7: A_3Qy: goto UOspa; P0JB0: if (!($query->num_rows() !== 1)) { goto CV8Hn; } goto RTpnj; t_AO3: if (!empty($identity)) { goto A_3Qy; } goto tvcMO; YsRs4: return $user->id; goto GyI7G; RTpnj: return FALSE; goto J3ZT9; tvcMO: return FALSE; goto WZfS7; UOspa: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\162\163"]); goto P0JB0; MmJs0: $user = $query->row(); goto YsRs4; GyI7G: } public function forgotten_password($identity) { goto KWKjc; PobIR: $this->trigger_events(["\x70\157\163\164\x5f\x66\x6f\x72\147\157\x74\x74\x65\156\137\160\141\163\163\167\157\x72\x64", "\x70\157\163\164\137\146\157\x72\x67\x6f\x74\164\x65\156\x5f\x70\141\x73\163\167\157\162\144\137\x73\x75\x63\143\145\x73\x73\x66\165\x6c"]); goto GzV8M; GzV8M: return $token->user_code; goto e0l6_; Q9UGA: $update = ["\146\x6f\162\147\x6f\164\x74\145\x6e\x5f\x70\141\x73\x73\167\157\162\x64\137\x73\145\154\x65\143\x74\157\162" => $token->selector, "\x66\x6f\162\x67\157\164\164\145\156\137\160\x61\x73\x73\x77\157\162\144\x5f\143\x6f\144\x65" => $token->validator_hashed, "\x66\x6f\x72\x67\x6f\164\164\145\x6e\x5f\160\x61\163\x73\167\x6f\162\144\x5f\164\151\x6d\x65" => time()]; goto NL1v1; ktCEP: $this->trigger_events(["\x70\x6f\163\164\137\146\x6f\x72\x67\x6f\164\164\145\x6e\x5f\160\x61\x73\x73\x77\157\x72\x64", "\160\157\163\164\137\146\157\162\147\157\x74\x74\145\x6e\x5f\160\x61\163\163\167\x6f\162\x64\x5f\165\x6e\x73\165\143\x63\145\x73\x73\x66\165\x6c"]); goto Tzl2t; mWku6: goto vD_aT; goto IBX51; nbuC5: return FALSE; goto mWku6; LQBdL: KqFQY: goto ICdgB; R_o4z: $this->trigger_events(["\160\157\x73\x74\x5f\146\x6f\162\x67\x6f\164\164\145\x6e\137\x70\141\163\163\x77\157\x72\x64", "\160\x6f\163\164\137\146\157\x72\x67\x6f\x74\164\145\x6e\137\160\x61\x73\x73\167\157\162\144\137\x75\x6e\x73\165\x63\x63\145\x73\163\x66\165\154"]); goto nbuC5; ZPaR5: if ($this->db->affected_rows() === 1) { goto q3DlP; } goto R_o4z; ICdgB: $token = $this->_generate_selector_validator_couple(20, 80); goto Q9UGA; KWKjc: if (!empty($identity)) { goto KqFQY; } goto ktCEP; NL1v1: $this->trigger_events("\x65\x78\x74\162\141\x5f\x77\x68\145\162\x65"); goto dxUYA; dxUYA: $this->db->update($this->tables["\165\163\145\x72\163"], $update, [$this->identity_column => $identity]); goto ZPaR5; Tzl2t: return FALSE; goto LQBdL; IBX51: q3DlP: goto PobIR; e0l6_: vD_aT: goto bXlzb; bXlzb: } public function get_user_by_forgotten_password_code($user_code) { goto iYxX1; Prngw: return $user; goto cSkML; iYxX1: $token = $this->_retrieve_selector_validator_couple($user_code); goto T2_Fp; cSkML: EezDB: goto tuqP_; psbhT: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto EezDB; } goto Prngw; Whq6A: if (!$user) { goto sl0jw; } goto psbhT; tuqP_: sl0jw: goto o2tTP; o2tTP: return FALSE; goto E2AjM; T2_Fp: $user = $this->where("\x66\157\162\147\x6f\x74\164\145\156\137\160\141\163\163\x77\x6f\x72\x64\137\163\x65\154\145\143\x74\157\x72", $token->selector)->users()->row(); goto Whq6A; E2AjM: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto PlFm9; PlFm9: $this->trigger_events("\x70\x72\145\137\162\x65\147\x69\163\x74\x65\162"); goto Stb43; BXCui: $data = [$this->identity_column => $identity, "\165\163\x65\x72\156\x61\155\145" => $identity, "\x70\x61\x73\163\x77\157\x72\144" => $password, "\x65\155\x61\x69\x6c" => $email, "\x69\x70\x5f\141\144\x64\162\x65\x73\163" => $ip_address, "\x63\x72\145\141\164\x65\x64\137\x6f\x6e" => time(), "\x61\143\x74\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto h0tNa; EeQ97: $this->set_error("\141\x63\143\157\165\x6e\x74\x5f\143\x72\145\141\164\151\x6f\x6e\137\155\151\163\x73\x69\156\147\x5f\x64\x65\x66\141\165\x6c\164\x5f\x67\162\157\x75\x70"); goto Dl47T; KCjKI: $id = $this->db->insert_id($this->tables["\x75\163\x65\x72\x73"] . "\137\x69\x64\x5f\163\x65\161"); goto najLA; tU8eb: $this->set_error("\x61\143\x63\x6f\165\x6e\164\137\143\162\x65\141\164\151\157\x6e\137\144\x75\160\x6c\x69\143\141\164\145\137\151\x64\145\156\x74\x69\x74\171"); goto DpxDA; QLm_1: if (empty($groups)) { goto MNIta; } goto Ih0qD; JKapd: RSjwY: goto BXCui; Ih0qD: foreach ($groups as $group) { $this->add_to_group($group, $id); XXrwP: } goto g3a0O; FPFA3: $groups[] = $default_group->id; goto ukB9c; Lmy2Z: $this->db->insert($this->tables["\x75\163\145\x72\163"], $user_data); goto KCjKI; nalxy: if (!($password === FALSE)) { goto RSjwY; } goto vAX06; g3a0O: yvh36: goto GkQ_w; vAX06: $this->set_error("\x61\x63\143\157\165\x6e\x74\137\x63\162\145\x61\x74\x69\x6f\156\137\165\156\x73\x75\143\x63\x65\163\163\146\165\x6c"); goto t00K1; h0tNa: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\145\x72\x73"], $additional_data), $data); goto I2xjR; jqlUH: djqAO: goto tU8eb; hdQLK: if (!(!$this->config->item("\144\x65\x66\141\x75\x6c\164\137\147\x72\x6f\165\x70", "\x69\157\x6e\x5f\141\165\164\x68") && empty($groups))) { goto M__IG; } goto EeQ97; MnFFF: Bn0CS: goto OfeS3; OfeS3: $query = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\x73"], ["\x6e\141\x6d\145" => $this->config->item("\x64\145\x66\141\165\x6c\164\137\147\x72\x6f\x75\x70", "\x69\157\156\x5f\141\165\164\x68")], 1)->row(); goto IoWt5; EWShs: $this->set_error("\141\x63\143\x6f\165\x6e\x74\137\x63\x72\145\x61\x74\x69\x6f\x6e\137\x69\156\x76\141\x6c\x69\144\137\x64\145\x66\141\x75\x6c\164\x5f\147\162\157\x75\160"); goto RjETS; x70tB: goto Bn0CS; goto jqlUH; GkQ_w: MNIta: goto gqXHa; Dw9Cg: M__IG: goto x70tB; IoWt5: if (!(!isset($query->id) && empty($groups))) { goto TfpvV; } goto EWShs; Stb43: $manual_activation = $this->config->item("\x6d\x61\156\165\x61\x6c\137\x61\x63\164\x69\166\141\164\x69\x6f\x6e", "\151\157\x6e\137\141\x75\x74\x68"); goto pDxOs; gqXHa: $this->trigger_events("\x70\157\x73\x74\x5f\x72\145\147\151\163\x74\145\x72"); goto uxJzk; najLA: if (!(isset($default_group->id) && empty($groups))) { goto L25Bh; } goto FPFA3; T4CN1: $password = $this->hash_password($password); goto nalxy; Dl47T: return FALSE; goto Dw9Cg; kdhkA: $ip_address = $this->input->ip_address(); goto T4CN1; RjETS: return FALSE; goto IDLX4; DpxDA: return FALSE; goto MnFFF; uxJzk: return isset($id) ? $id : FALSE; goto smb7L; ukB9c: L25Bh: goto QLm_1; WRL5d: $default_group = $query; goto kdhkA; t00K1: return FALSE; goto JKapd; IDLX4: TfpvV: goto WRL5d; pDxOs: if ($this->identity_check($identity)) { goto djqAO; } goto hdQLK; I2xjR: $this->trigger_events("\145\x78\x74\162\141\x5f\x73\x65\x74"); goto Lmy2Z; smb7L: } public function login($identity, $password, $remember = FALSE) { goto Ol6jB; jE7zv: if ($remember) { goto gtH3E; } goto Q2Ste; xAFYn: KFMFg: goto iEtBK; tYJjg: $this->set_error("\x6c\157\x67\151\x6e\137\x75\156\x73\x75\143\143\145\x73\x73\x66\165\154"); goto hq9Qk; d7gdr: $this->trigger_events("\160\x6f\x73\x74\x5f\x6c\157\x67\x69\156\x5f\x75\156\163\x75\x63\143\145\x73\x73\146\165\x6c"); goto uhV85; lt17E: ctd9H: goto TZx9z; B3Tta: $this->session->sess_regenerate(FALSE); goto bLpVW; EZyoM: if (!$this->verify_password($password, $user->password, $identity)) { goto KFMFg; } goto Goy2B; to593: if (!$this->config->item("\x72\x65\155\x65\x6d\142\145\162\137\x75\163\145\162\x73", "\x69\x6f\x6e\x5f\141\165\x74\x68")) { goto ctd9H; } goto jE7zv; VHxSB: $user = $query->row(); goto EZyoM; rYHil: $this->trigger_events("\160\157\163\x74\x5f\x6c\157\x67\151\156\x5f\x75\156\x73\x75\143\143\145\163\163\x66\165\154"); goto PCSLi; uhV85: $this->set_error("\x6c\x6f\147\151\x6e\x5f\x75\156\x73\x75\x63\x63\x65\163\163\x66\x75\x6c\x5f\x6e\157\x74\x5f\141\143\164\x69\166\x65"); goto mwMvK; hq9Qk: return FALSE; goto AgU0s; du13L: $this->set_error("\154\157\147\x69\x6e\x5f\165\x6e\x73\x75\x63\143\x65\x73\163\x66\x75\154"); goto l05Gr; BWYIf: jDeta: goto lt17E; OcPkk: $this->set_session($user); goto cDMQ3; l05Gr: return FALSE; goto u8xeX; Ws9g_: $this->hash_password($password); goto Re6NY; Goy2B: if (!($user->active == 0)) { goto O1dc1; } goto d7gdr; aGeDd: return TRUE; goto xAFYn; lXsY8: if (!($query->num_rows() === 1)) { goto m0Agp; } goto VHxSB; lH4as: $this->remember_user($identity); goto BWYIf; bLpVW: $this->trigger_events(["\160\157\x73\x74\137\x6c\157\x67\x69\156", "\160\157\163\x74\137\x6c\157\x67\151\x6e\x5f\x73\x75\143\143\145\163\x73\146\x75\154"]); goto H3N4X; O6EQj: $this->hash_password($password); goto rYHil; DbpLn: $this->clear_forgotten_password_code($identity); goto to593; AgU0s: k_FIF: goto RR5PF; GiFv4: if (!(empty($identity) || empty($password))) { goto k_FIF; } goto tYJjg; yP5aV: if (!$this->is_max_login_attempts_exceeded($identity)) { goto ZQyf1; } goto O6EQj; eCwKW: $this->clear_login_attempts($identity); goto DbpLn; MQ2Lt: ZQyf1: goto lXsY8; nW6kF: gtH3E: goto lH4as; R5Ew9: O1dc1: goto OcPkk; FwSBV: $query = $this->db->select($this->identity_column . "\x2c\40\x65\x6d\x61\x69\154\54\x20\151\144\x2c\x20\x70\141\163\x73\167\157\x72\x64\54\40\x61\143\164\x69\x76\x65\54\x20\x6c\141\x73\x74\x5f\x6c\157\x67\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\144\145\163\143")->get($this->tables["\x75\163\x65\162\163"]); goto yP5aV; iEtBK: m0Agp: goto Ws9g_; Cg9J3: return FALSE; goto MQ2Lt; Re6NY: $this->increase_login_attempts($identity); goto PBu5b; cDMQ3: $this->update_last_login($user->id); goto eCwKW; PCSLi: $this->set_error("\x6c\x6f\147\x69\156\x5f\x74\x69\155\x65\157\165\x74"); goto Cg9J3; TZx9z: $this->rehash_password_if_needed($user->password, $identity, $password); goto B3Tta; H3N4X: $this->set_message("\x6c\157\147\151\x6e\x5f\163\165\143\143\145\x73\x73\146\x75\154"); goto aGeDd; Q2Ste: $this->clear_remember_code($identity); goto AUQwu; AUQwu: goto jDeta; goto nW6kF; RR5PF: $this->trigger_events("\x65\x78\164\162\x61\x5f\167\x68\145\x72\x65"); goto FwSBV; PBu5b: $this->trigger_events("\x70\157\163\164\137\x6c\x6f\147\151\156\x5f\x75\156\163\x75\143\143\x65\163\x73\x66\x75\x6c"); goto du13L; Ol6jB: $this->trigger_events("\x70\x72\x65\x5f\154\157\147\151\156"); goto GiFv4; mwMvK: return FALSE; goto R5Ew9; u8xeX: } public function recheck_session() { goto QXwRo; Ytmoa: $identity = $this->config->item("\151\144\145\x6e\164\151\x74\171", "\151\157\156\137\141\x75\164\150"); goto Nt_9a; eDGGC: if (!($recheck !== 0)) { goto caEZX; } goto WVVOk; Vky46: $this->session->set_userdata("\154\x61\x73\164\x5f\143\x68\145\x63\x6b", time()); goto gulUm; QXwRo: $recheck = NULL !== $this->config->item("\x72\145\143\x68\145\x63\153\137\164\151\155\145\162", "\151\x6f\x6e\x5f\141\x75\x74\x68") ? $this->config->item("\162\145\143\x68\145\x63\x6b\x5f\x74\x69\155\x65\x72", "\x69\x6f\x6e\x5f\x61\165\x74\150") : 0; goto eDGGC; cG4kw: caEZX: goto pvhPC; Nt_9a: $this->session->unset_userdata([$identity, "\151\x64", "\165\163\x65\x72\x5f\x69\144"]); goto fb3cM; CJ2Ug: I97Ei: goto Vky46; yMFLN: goto IrDHA; goto CJ2Ug; F00NO: if ($query->num_rows() === 1) { goto I97Ei; } goto F31j6; F31j6: $this->trigger_events("\154\157\x67\157\x75\164"); goto Ytmoa; LzPA3: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\144\145\x6e\164\151\x74\x79"), "\141\x63\x74\x69\x76\145" => "\x31"])->limit(1)->order_by("\151\144", "\x64\x65\x73\x63")->get($this->tables["\165\x73\x65\162\x73"]); goto F00NO; J4R9G: if (!($last_login + $recheck < time())) { goto dcVff; } goto LzPA3; pvhPC: return (bool) $this->session->userdata("\x69\x64\145\156\164\151\164\x79"); goto PdwFA; WVVOk: $last_login = $this->session->userdata("\154\x61\163\x74\x5f\143\150\145\143\x6b"); goto J4R9G; fb3cM: return FALSE; goto yMFLN; n9W9f: dcVff: goto cG4kw; gulUm: IrDHA: goto n9W9f; PdwFA: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto qQg_p; OXMRI: return FALSE; goto H7uc2; eDWZT: return $attempts >= $max_attempts; goto kMo87; FBfvC: P9aFx: goto OXMRI; FfS_d: if (!($max_attempts > 0)) { goto x78HB; } goto IZiMB; kMo87: x78HB: goto FBfvC; qQg_p: if (!$this->config->item("\x74\162\x61\x63\x6b\x5f\x6c\157\x67\x69\156\137\141\164\164\x65\x6d\160\x74\163", "\151\157\156\137\x61\165\x74\x68")) { goto P9aFx; } goto lGTw9; lGTw9: $max_attempts = $this->config->item("\x6d\141\x78\151\155\x75\x6d\x5f\x6c\157\x67\151\x6e\137\x61\164\164\x65\x6d\160\164\x73", "\151\157\x6e\x5f\141\165\x74\x68"); goto FfS_d; IZiMB: $attempts = $this->get_attempts_num($identity, $ip_address); goto eDWZT; H7uc2: } public function get_attempts_num($identity, $ip_address = NULL) { goto efa1i; hB2ki: XKVJG: goto QNeE0; hid71: return 0; goto BF_dd; gxfnb: $this->db->select("\61", FALSE); goto ESWuR; QNeE0: $this->db->where("\164\x69\x6d\x65\x20\76", time() - $this->config->item("\154\157\x63\153\157\165\164\137\x74\x69\x6d\x65", "\151\157\156\x5f\x61\165\x74\150"), FALSE); goto zjQS8; efa1i: if (!$this->config->item("\164\x72\141\143\x6b\137\154\x6f\147\151\x6e\137\x61\x74\x74\x65\x6d\160\x74\163", "\x69\x6f\x6e\x5f\141\165\164\150")) { goto Uk5P9; } goto gxfnb; a2EDA: $ip_address = $this->input->ip_address(); goto qr1et; nIsZM: return $qres->num_rows(); goto MhBz5; QQnQs: if (isset($ip_address)) { goto vynaI; } goto a2EDA; MhBz5: Uk5P9: goto hid71; ESWuR: $this->db->where("\x6c\157\147\x69\156", $identity); goto FZMMr; FZMMr: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\x6f\147\x69\x6e\137\x69\x70\137\141\x64\x64\162\x65\163\x73", "\151\157\156\137\141\165\164\x68")) { goto XKVJG; } goto QQnQs; zjQS8: $qres = $this->db->get($this->tables["\x6c\157\147\x69\156\137\x61\x74\x74\145\155\160\x74\163"]); goto nIsZM; qr1et: vynaI: goto jHEAa; jHEAa: $this->db->where("\x69\160\137\x61\x64\x64\x72\x65\x73\x73", $ip_address); goto hB2ki; BF_dd: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto h_gv7; G1Ozg: $this->db->select("\164\x69\155\145"); goto m6wll; ty0q4: k7PR0: goto E2JJP; rJw1U: return 0; goto Dwcv0; kvf1D: Wg0nT: goto WZDes; WJoT8: KdHXV: goto R8g3c; Mt3br: if (!($qres->num_rows() > 0)) { goto KdHXV; } goto WVd7V; Ek6o_: if (isset($ip_address)) { goto Wg0nT; } goto ua9kq; WZDes: $this->db->where("\x69\x70\x5f\141\x64\144\x72\145\x73\163", $ip_address); goto ty0q4; m6wll: $this->db->where("\154\157\x67\151\x6e", $identity); goto eX6Mj; h_gv7: if (!$this->config->item("\x74\x72\141\x63\153\x5f\154\x6f\x67\x69\x6e\137\x61\164\x74\x65\x6d\160\x74\163", "\151\x6f\x6e\x5f\141\x75\164\x68")) { goto FXBl2; } goto G1Ozg; R8g3c: FXBl2: goto rJw1U; E2JJP: $this->db->order_by("\151\x64", "\x64\145\x73\143"); goto p3zIu; ua9kq: $ip_address = $this->input->ip_address(); goto kvf1D; p3zIu: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\137\141\164\164\145\155\160\164\163"], 1); goto Mt3br; WVd7V: return $qres->row()->time; goto WJoT8; eX6Mj: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\154\x6f\147\151\156\137\x69\160\x5f\141\144\x64\x72\145\x73\x73", "\x69\x6f\156\137\141\165\164\x68")) { goto k7PR0; } goto Ek6o_; Dwcv0: } public function get_last_attempt_ip($identity) { goto faFuY; Md1en: return ''; goto L3bxd; seI2B: if (!($qres->num_rows() > 0)) { goto ABH8K; } goto S2MSO; caORn: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto sLby_; JaPx8: Sd3UH: goto Md1en; FebsK: $qres = $this->db->get($this->tables["\154\x6f\x67\151\156\137\141\x74\164\x65\x6d\x70\x74\x73"], 1); goto seI2B; Y3guN: $this->db->select("\151\160\x5f\x61\x64\x64\162\145\163\x73"); goto caORn; S2MSO: return $qres->row()->ip_address; goto W19_o; W19_o: ABH8K: goto JaPx8; sLby_: $this->db->order_by("\151\x64", "\144\145\163\143"); goto FebsK; faFuY: if (!($this->config->item("\164\x72\141\x63\x6b\137\x6c\x6f\x67\151\x6e\137\141\x74\164\x65\x6d\x70\x74\x73", "\x69\157\156\137\x61\x75\x74\150") && $this->config->item("\164\162\141\143\153\x5f\154\157\x67\x69\156\x5f\x69\160\137\141\144\x64\x72\x65\163\163", "\151\x6f\156\137\x61\165\x74\150"))) { goto Sd3UH; } goto Y3guN; L3bxd: } public function increase_login_attempts($identity) { goto tPsvz; iQTlR: $data = ["\x69\160\x5f\141\x64\x64\x72\145\x73\163" => '', "\x6c\157\147\x69\x6e" => $identity, "\164\x69\155\145" => time()]; goto nmOWF; DTx7w: qk02b: goto iz6xI; tPsvz: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\157\147\151\x6e\137\x61\164\x74\x65\x6d\x70\164\x73", "\151\x6f\x6e\137\x61\165\x74\150")) { goto iwhNR; } goto iQTlR; nmOWF: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\x6f\147\x69\156\137\151\x70\137\x61\x64\144\162\145\163\x73", "\151\x6f\x6e\137\141\165\164\x68")) { goto qk02b; } goto uvwO7; uvwO7: $data["\x69\160\x5f\x61\144\x64\162\x65\x73\x73"] = $this->input->ip_address(); goto DTx7w; OOVSY: iwhNR: goto LOX42; iz6xI: return $this->db->insert($this->tables["\x6c\157\147\151\x6e\x5f\x61\164\164\x65\155\160\164\x73"], $data); goto OOVSY; LOX42: return FALSE; goto iV2ZG; iV2ZG: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto Qj3Sb; uCsjv: xDoJc: goto bktV9; QLvX9: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto i2maL; i2maL: if (!$this->config->item("\x74\x72\141\143\x6b\137\x6c\157\147\151\156\x5f\151\160\x5f\141\144\144\162\145\163\163", "\151\x6f\x6e\x5f\141\165\164\150")) { goto rmkgj; } goto WW1Rj; xkEOo: $this->db->where("\151\x70\x5f\x61\144\x64\x72\x65\x73\163", $ip_address); goto xKDf_; xKDf_: rmkgj: goto k4luu; WW1Rj: if (isset($ip_address)) { goto xdP5t; } goto jXjSs; b_lUr: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\x63\153\x6f\165\x74\137\164\151\155\x65", "\x69\157\156\137\x61\165\164\150")); goto QLvX9; xtXil: xdP5t: goto xkEOo; k4luu: $this->db->or_where("\164\151\155\x65\x20\x3c", time() - $old_attempts_expire_period, FALSE); goto mtsck; jXjSs: $ip_address = $this->input->ip_address(); goto xtXil; bktV9: return FALSE; goto TIeHF; Qj3Sb: if (!$this->config->item("\x74\162\x61\143\x6b\137\x6c\x6f\147\x69\x6e\137\141\164\164\145\155\x70\x74\163", "\151\x6f\x6e\x5f\141\165\x74\150")) { goto xDoJc; } goto b_lUr; mtsck: return $this->db->delete($this->tables["\154\157\147\x69\x6e\x5f\x61\x74\164\145\x6d\x70\x74\163"]); goto uCsjv; TIeHF: } public function limit($limit) { goto qxVnJ; s8HZO: $this->_ion_limit = $limit; goto dNgZG; qxVnJ: $this->trigger_events("\154\x69\155\x69\x74"); goto s8HZO; dNgZG: return $this; goto pgS6R; pgS6R: } public function offset($offset) { goto qixu7; qixu7: $this->trigger_events("\157\146\146\x73\x65\x74"); goto Nzkbi; Nzkbi: $this->_ion_offset = $offset; goto vPXBR; vPXBR: return $this; goto wNmdY; wNmdY: } public function where($where, $value = NULL) { goto CCIr4; L1I7h: return $this; goto uatmS; bpV17: KX77U: goto tnwR_; CCIr4: $this->trigger_events("\167\x68\145\x72\145"); goto L87DT; jMdZM: $where = [$where => $value]; goto bpV17; L87DT: if (is_array($where)) { goto KX77U; } goto jMdZM; tnwR_: array_push($this->_ion_where, $where); goto L1I7h; uatmS: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\x68") { goto FrDtn; FrDtn: $this->trigger_events("\154\151\x6b\x65"); goto adPTd; adPTd: array_push($this->_ion_like, ["\x6c\151\x6b\145" => $like, "\x76\141\x6c\165\x65" => $value, "\160\x6f\x73\151\164\151\157\156" => $position]); goto kHcFn; kHcFn: return $this; goto RhI3Y; RhI3Y: } public function select($select) { goto HpCHq; r2wUu: $this->_ion_select[] = $select; goto U6HQ_; HpCHq: $this->trigger_events("\163\145\154\x65\143\164"); goto r2wUu; U6HQ_: return $this; goto NQABG; NQABG: } public function order_by($by, $order = "\144\x65\x73\143") { goto d64YZ; XV3y6: return $this; goto X3Rzl; TbLTz: $this->_ion_order = $order; goto XV3y6; d64YZ: $this->trigger_events("\157\x72\144\x65\162\x5f\x62\171"); goto rIkCd; rIkCd: $this->_ion_order_by = $by; goto TbLTz; X3Rzl: } public function row() { goto TVCuj; iLcg0: $row = $this->response->row(); goto qop6p; TVCuj: $this->trigger_events("\162\157\x77"); goto iLcg0; qop6p: return $row; goto VDau_; VDau_: } public function row_array() { goto CNcjI; CNcjI: $this->trigger_events(["\162\x6f\x77", "\x72\157\167\137\x61\x72\x72\x61\171"]); goto CH3Xv; ZjE_V: return $row; goto g3EJH; CH3Xv: $row = $this->response->row_array(); goto ZjE_V; g3EJH: } public function result() { goto eKB21; eKB21: $this->trigger_events("\x72\x65\163\165\x6c\x74"); goto fXgKc; pZlWC: return $result; goto RVjLi; fXgKc: $result = $this->response->result(); goto pZlWC; RVjLi: } public function result_array() { goto V0Hyl; V0Hyl: $this->trigger_events(["\x72\x65\163\x75\x6c\164", "\162\x65\163\165\x6c\164\x5f\141\x72\162\x61\x79"]); goto D1tzU; Gs_BA: return $result; goto HpAdU; D1tzU: $result = $this->response->result_array(); goto Gs_BA; HpAdU: } public function num_rows() { goto uUQ1S; YUH8N: $result = $this->response->num_rows(); goto Kma9P; Kma9P: return $result; goto VOmvP; uUQ1S: $this->trigger_events(["\x6e\165\x6d\137\162\x6f\x77\x73"]); goto YUH8N; VOmvP: } public function users($groups = NULL) { goto G_KP1; FzYIM: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto BNPHa; dtQY_: R7ghr: goto t2K6W; GYeKX: DiStH: goto FDLCr; jhwMl: $this->_ion_order = NULL; goto YM88n; J2wbv: Ei2A1: goto ht_8Q; ht_8Q: if (!isset($groups)) { goto SXdh8; } goto VF39v; HlvT4: $this->_ion_offset = NULL; goto hrdr3; hiasK: Q1M38: goto FzYIM; BNPHa: $this->_ion_limit = NULL; goto HlvT4; HrAxe: $this->_ion_like = []; goto GYeKX; ql4vV: nOMeV: goto aKMTd; KEPx4: return $this; goto oqyGF; ouXu9: $this->db->distinct(); goto BuNFV; Re0jB: $this->db->limit($this->_ion_limit); goto E_Bph; bRcd6: MshGD: goto Gh97Q; qs2Y8: if (!isset($this->_ion_limit)) { goto uyNhU; } goto Re0jB; WUANd: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\153\x65"], $like["\166\x61\x6c\165\x65"], $like["\160\157\163\x69\x74\x69\157\156"]); pVUr3: } goto btCys; btCys: SVqY0: goto HrAxe; QI_cO: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\167\150\145\x72\145\x5f\x69\x6e" : "\x77\x68\145\x72\145\x5f\151\156"; goto OW8Iv; igNqG: $this->db->{$or_where_in}($this->tables["\165\163\145\x72\163\x5f\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\147\162\157\165\160\x73"], $group_ids); goto EImx1; aLkNT: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto qhxVW; } goto tuu5C; y3wBs: qhxVW: goto RM58I; EImx1: Rwvqk: goto c2O4_; aKMTd: $this->_ion_select = []; goto J2wbv; Rgxlv: foreach ($this->_ion_where as $where) { $this->db->where($where); DkE1E: } goto bRcd6; MhSEW: $this->db->where_in($this->tables["\x67\x72\157\x75\x70\x73"] . "\56\156\x61\x6d\145", $group_names); goto NXFh4; YM88n: $this->_ion_order_by = NULL; goto y3wBs; Zzekm: if (!(isset($groups) && !empty($groups))) { goto vjQSa; } goto ouXu9; xVbga: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto nBkdZ; } goto Rgxlv; kdKo2: nBkdZ: goto ZSGx0; FOuvj: $groups = [$groups]; goto T6Gs2; OW8Iv: if (empty($group_names)) { goto umTTM; } goto woj7X; r6kL3: $group_names = []; goto wDbnL; RM58I: $this->response = $this->db->get($this->tables["\x75\x73\x65\x72\163"]); goto KEPx4; Pelt8: if (empty($group_ids)) { goto Rwvqk; } goto igNqG; nFicI: uyNhU: goto x571W; ZSGx0: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto DiStH; } goto WUANd; G_KP1: $this->trigger_events("\x75\x73\x65\x72\x73"); goto pTrZY; aJhlj: vjQSa: goto cRisQ; pTrZY: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto R7ghr; } goto qJOxQ; woj7X: $this->db->join($this->tables["\x67\x72\157\165\x70\x73"], $this->tables["\x75\163\145\162\163\137\x67\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\x6f\x75\160\163"] . "\x20\x3d\40" . $this->tables["\147\x72\157\165\160\x73"] . "\x2e\x69\144", "\x69\x6e\x6e\x65\162"); goto MhSEW; c2O4_: SXdh8: goto Xkta0; E_Bph: $this->_ion_limit = NULL; goto nFicI; VF39v: if (is_array($groups)) { goto tJQox; } goto FOuvj; hrdr3: g_nh_: goto aLkNT; x571W: goto g_nh_; goto hiasK; cRisQ: $group_ids = []; goto r6kL3; t2K6W: foreach ($this->_ion_select as $select) { $this->db->select($select); ZkC1y: } goto ql4vV; FDLCr: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto Q1M38; } goto qs2Y8; wDbnL: foreach ($groups as $group) { goto bXw6I; bXw6I: if (is_numeric($group)) { goto QqP3C; } goto lW8_t; VZUhb: eTgDm: goto JxWpT; JxWpT: Sjssw: goto uhH1z; Rm077: $group_ids[] = $group; goto VZUhb; BY4tc: goto eTgDm; goto UD0dG; UD0dG: QqP3C: goto Rm077; lW8_t: $group_names[] = $group; goto BY4tc; uhH1z: } goto WPu3r; qJOxQ: $this->db->select([$this->tables["\x75\163\x65\162\163"] . "\x2e\x2a", $this->tables["\165\x73\145\x72\x73"] . "\x2e\x69\144\40\141\x73\x20\x69\x64", $this->tables["\x75\163\145\162\x73"] . "\x2e\x69\x64\x20\141\x73\40\x75\163\145\162\137\151\x64"]); goto XUel1; T6Gs2: tJQox: goto Zzekm; XUel1: goto Ei2A1; goto dtQY_; WPu3r: vaVt7: goto QI_cO; Xkta0: $this->trigger_events("\145\170\164\x72\x61\137\x77\150\x65\162\145"); goto xVbga; NXFh4: umTTM: goto Pelt8; tuu5C: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto jhwMl; BuNFV: $this->db->join($this->tables["\x75\163\x65\x72\163\137\x67\x72\157\x75\x70\163"], $this->tables["\165\x73\x65\162\x73\137\147\x72\157\x75\160\163"] . "\x2e" . $this->join["\165\163\145\x72\163"] . "\75" . $this->tables["\x75\163\x65\162\163"] . "\56\151\144", "\151\x6e\156\x65\x72"); goto aJhlj; Gh97Q: $this->_ion_where = []; goto kdKo2; oqyGF: } public function user($id = NULL) { goto TnURW; BRzG5: return $this; goto lVqq0; UH5ck: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\x65\162\x5f\x69\x64"); goto sZTiU; TnURW: $this->trigger_events("\165\x73\x65\x72"); goto UH5ck; nBePU: $this->order_by($this->tables["\165\163\x65\x72\163"] . "\x2e\151\x64", "\144\145\x73\x63"); goto FpXMt; oojji: $this->users(); goto BRzG5; sZTiU: $this->limit(1); goto nBePU; FpXMt: $this->where($this->tables["\165\163\x65\162\x73"] . "\x2e\151\x64", $id); goto oojji; lVqq0: } public function get_users_groups($id = FALSE) { goto W13AT; FBjaa: $id || ($id = $this->session->userdata("\165\163\145\x72\137\151\144")); goto sSj3g; sSj3g: return $this->db->select($this->tables["\165\x73\145\x72\x73\x5f\147\x72\157\x75\160\163"] . "\56" . $this->join["\147\x72\157\x75\x70\163"] . "\x20\x61\163\x20\151\144\x2c\x20" . $this->tables["\147\162\157\165\x70\163"] . "\x2e\x6e\141\155\145\54\40" . $this->tables["\147\162\157\x75\160\x73"] . "\56\144\x65\163\143\x72\151\x70\x74\151\x6f\156")->where($this->tables["\165\x73\x65\162\163\137\147\162\157\165\160\x73"] . "\x2e" . $this->join["\165\163\145\x72\163"], $id)->join($this->tables["\147\x72\157\165\160\x73"], $this->tables["\165\163\x65\x72\x73\x5f\x67\162\x6f\x75\x70\163"] . "\56" . $this->join["\x67\x72\x6f\x75\160\163"] . "\75" . $this->tables["\x67\162\157\165\160\x73"] . "\x2e\x69\144")->get($this->tables["\x75\x73\x65\x72\163\137\x67\162\x6f\x75\x70\x73"]); goto Mupy5; W13AT: $this->trigger_events("\147\145\x74\x5f\165\x73\x65\x72\x73\137\x67\x72\x6f\x75\160"); goto FBjaa; Mupy5: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto dolcu; dolcu: $this->trigger_events("\151\x6e\137\147\x72\157\x75\160"); goto X33Rn; NIsEB: $this->_cache_user_in_group[$id] = $groups_array; goto zt13n; sf5Cm: Bqb_B: goto q2DCi; Ux9vu: GgECc: goto NIsEB; oHJOE: mzra6: goto HyMFP; NHRS0: if (isset($this->_cache_user_in_group[$id])) { goto mzra6; } goto BggZP; q2DCi: return $check_all; goto J9CII; YQDYA: QreHc: goto oEqJP; zt13n: goto QreHc; goto oHJOE; VWJbY: if (is_array($check_group)) { goto Yomz_; } goto O2Dmo; O2Dmo: $check_group = [$check_group]; goto EaMyq; oEqJP: foreach ($check_group as $key => $value) { goto X6AZ_; X6AZ_: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto h1AfV; h1AfV: if (!(in_array($value, $groups) xor $check_all)) { goto Blfoj; } goto zr1Hp; FWuvA: Blfoj: goto JlJJQ; zr1Hp: return !$check_all; goto FWuvA; JlJJQ: xUhMW: goto gs3Ne; gs3Ne: } goto sf5Cm; BggZP: $users_groups = $this->get_users_groups($id)->result(); goto cGu9b; u7k8e: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; fgU0Y: } goto Ux9vu; HyMFP: $groups_array = $this->_cache_user_in_group[$id]; goto YQDYA; X33Rn: $id || ($id = $this->session->userdata("\165\163\145\162\137\x69\x64")); goto VWJbY; EaMyq: Yomz_: goto NHRS0; cGu9b: $groups_array = []; goto u7k8e; J9CII: } public function add_to_group($group_ids, $user_id = FALSE) { goto fU0rw; r1AYk: if (is_array($group_ids)) { goto SSPYn; } goto AIxT0; WEwFC: $user_id || ($user_id = $this->session->userdata("\x75\163\x65\x72\137\x69\144")); goto r1AYk; cphIk: wOF6v: goto dki8v; zxXXm: SSPYn: goto g8dE8; fU0rw: $this->trigger_events("\141\144\x64\137\x74\x6f\137\147\162\157\x75\160"); goto WEwFC; AIxT0: $group_ids = [$group_ids]; goto zxXXm; iNO8E: foreach ($group_ids as $group_id) { goto YGPhE; wZbXF: $return++; goto kxOfB; Ra7kE: if (isset($this->_cache_groups[$group_id])) { goto oR2XY; } goto D19pA; D19pA: $group = $this->group($group_id)->result(); goto gxRK1; IPC2L: $this->_cache_groups[$group_id] = $group_name; goto cCqvA; gxRK1: $group_name = $group[0]->name; goto IPC2L; MPJMB: B36v2: goto jYtVM; o30Yi: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto wZbXF; YGPhE: if (!$this->db->insert($this->tables["\165\x73\145\x72\x73\137\x67\x72\x6f\165\x70\163"], [$this->join["\147\x72\x6f\x75\160\x73"] => (float) $group_id, $this->join["\x75\163\145\x72\x73"] => (float) $user_id])) { goto QjvPD; } goto Ra7kE; EJy96: oR2XY: goto q3KvS; q3KvS: $group_name = $this->_cache_groups[$group_id]; goto Gatu3; Gatu3: NWsE7: goto o30Yi; cCqvA: goto NWsE7; goto EJy96; kxOfB: QjvPD: goto MPJMB; jYtVM: } goto cphIk; g8dE8: $return = 0; goto iNO8E; dki8v: return $return; goto U1mVL; U1mVL: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto WU4NK; kyPa0: if (!empty($user_id)) { goto zDZDo; } goto KN3wP; GfUtk: foreach ($group_ids as $group_id) { goto UbsYj; iRqCt: unset($this->_cache_user_in_group[$user_id][$group_id]); goto OVwss; blta5: QE961: goto fIp8H; UbsYj: $this->db->delete($this->tables["\165\x73\x65\162\163\137\x67\162\x6f\165\160\x73"], [$this->join["\147\162\x6f\x75\160\163"] => (float) $group_id, $this->join["\x75\163\x65\x72\x73"] => (float) $user_id]); goto ujZAJ; ujZAJ: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto jpr_8; } goto iRqCt; OVwss: jpr_8: goto blta5; fIp8H: } goto A8d_2; nawjl: return $return; goto UkQid; erSRo: if (is_array($group_ids)) { goto EnSyy; } goto dS3rp; fPSK5: iNDp1: goto nawjl; A8d_2: YWmp3: goto sePzq; KN3wP: return FALSE; goto edpuM; sePzq: $return = TRUE; goto fPSK5; Z6ZV2: if (!($return = $this->db->delete($this->tables["\165\x73\145\x72\x73\x5f\147\162\157\x75\160\x73"], [$this->join["\165\163\x65\x72\x73"] => (float) $user_id]))) { goto O6hwy; } goto Ng3J8; ljviF: goto iNDp1; goto qQaqx; qQaqx: G_CJR: goto erSRo; Ng3J8: $this->_cache_user_in_group[$user_id] = []; goto r7T8Q; r7T8Q: O6hwy: goto ljviF; dS3rp: $group_ids = [$group_ids]; goto XbY3t; wvtIi: if (!empty($group_ids)) { goto G_CJR; } goto Z6ZV2; WU4NK: $this->trigger_events("\162\145\155\157\x76\x65\x5f\146\162\x6f\155\137\x67\162\x6f\x75\x70"); goto kyPa0; edpuM: zDZDo: goto wvtIi; XbY3t: EnSyy: goto GfUtk; UkQid: } public function groups() { goto a34sI; rNF7O: $this->_ion_limit = NULL; goto GJD7R; POGxQ: X04d7: goto OtXNt; vEhaB: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto A_hGq; B5llj: XYFRX: goto mhzKT; po1cr: $this->_ion_limit = NULL; goto B9GEI; DABi5: j2vsQ: goto cPQe8; A_hGq: rumqC: goto zjr5c; a34sI: $this->trigger_events("\147\x72\157\165\x70\x73"); goto tS5nw; cPQe8: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto aqVj9; } goto o1iAJ; VhmGH: goto X04d7; goto mbNwF; bXMsQ: foreach ($this->_ion_where as $where) { $this->db->where($where); QXJlU: } goto B5llj; GJD7R: DcEQU: goto VhmGH; o1iAJ: if (!isset($this->_ion_limit)) { goto DcEQU; } goto LZ_OR; zjr5c: $this->response = $this->db->get($this->tables["\147\x72\x6f\x75\x70\x73"]); goto Gbu6o; OtXNt: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto rumqC; } goto vEhaB; YQzAO: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto po1cr; LZ_OR: $this->db->limit($this->_ion_limit); goto rNF7O; Gbu6o: return $this; goto h63R6; tS5nw: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto j2vsQ; } goto bXMsQ; B9GEI: $this->_ion_offset = NULL; goto POGxQ; mbNwF: aqVj9: goto YQzAO; mhzKT: $this->_ion_where = []; goto DABi5; h63R6: } public function group($id = NULL) { goto Pe7SF; anLGV: $this->where($this->tables["\147\x72\x6f\x75\160\163"] . "\56\151\x64", $id); goto u1e4c; xWx8A: $this->limit(1); goto qBpur; njsWV: if (!isset($id)) { goto kn1MN; } goto anLGV; qBpur: $this->order_by("\x69\144", "\x64\145\163\143"); goto Buc8M; Buc8M: return $this->groups(); goto P76G2; Pe7SF: $this->trigger_events("\x67\x72\157\165\160"); goto njsWV; u1e4c: kn1MN: goto xWx8A; P76G2: } public function update($id, array $data) { goto FLOq6; TjV7D: x5Iv0: goto hscEk; Z3AVb: $this->db->trans_rollback(); goto DDC3J; hscEk: $data = $this->_filter_data($this->tables["\x75\x73\x65\x72\163"], $data); goto oZ1_e; N2KOJ: uxJAv: goto JE2o4; Ym62P: $this->db->update($this->tables["\x75\163\x65\x72\163"], $data, ["\x69\144" => $user->id]); goto hWb31; WJXkO: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto x5Iv0; } goto yU4no; oSFxy: M41ye: goto vNBLK; atb3G: return FALSE; goto TjV7D; oZ1_e: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\163\167\x6f\x72\144", $data) || array_key_exists("\145\155\x61\x69\x6c", $data))) { goto JU6UJ; } goto qbVgR; pi8fP: $this->set_error("\165\160\x64\x61\164\145\137\165\x6e\163\x75\x63\x63\145\163\x73\x66\165\154"); goto LjnNq; vNBLK: $data["\x70\x61\163\x73\167\157\x72\x64"] = $this->hash_password($data["\160\x61\163\163\x77\157\162\144"], $user->{$this->identity_column}); goto kmEBD; paABV: return FALSE; goto N2KOJ; JE1aq: $this->db->trans_commit(); goto i7UMK; Ww2fo: $this->trigger_events(["\160\157\x73\x74\137\x75\x70\x64\x61\x74\145\137\165\x73\x65\162", "\x70\x6f\163\x74\x5f\165\160\144\x61\x74\145\x5f\165\x73\x65\162\x5f\165\156\163\165\143\x63\145\163\x73\146\165\154"]); goto pi8fP; IShco: JU6UJ: goto T1Gfw; YKjJm: $this->trigger_events(["\160\x6f\x73\x74\x5f\165\x70\144\x61\164\x65\x5f\165\x73\x65\x72", "\x70\x6f\x73\x74\x5f\165\x70\x64\x61\x74\x65\137\165\x73\145\162\137\x75\x6e\163\x75\x63\x63\145\163\x73\x66\165\154"]); goto kYNrz; WsR8U: $this->set_error("\141\143\143\157\x75\x6e\x74\x5f\143\x72\145\141\x74\x69\157\156\137\144\x75\160\x6c\x69\x63\141\x74\145\137\x69\144\145\156\164\x69\x74\171"); goto YKjJm; kYNrz: $this->set_error("\165\160\144\x61\x74\145\x5f\x75\156\163\x75\x63\x63\x65\163\x73\146\x75\154"); goto atb3G; LjnNq: return FALSE; goto Ntl9p; Ntl9p: pTDZm: goto JE1aq; HyZAs: $this->db->trans_rollback(); goto Ww2fo; JE2o4: WbW6q: goto XATSc; kmEBD: if (!($data["\160\x61\x73\163\x77\157\x72\144"] === FALSE)) { goto uxJAv; } goto Z3AVb; hWb31: if (!($this->db->trans_status() === FALSE)) { goto pTDZm; } goto HyZAs; ft7cy: $this->set_message("\165\160\x64\x61\x74\x65\137\x73\165\x63\x63\145\163\x73\x66\165\x6c"); goto W1kex; qbVgR: if (!array_key_exists("\160\x61\x73\163\167\x6f\162\144", $data)) { goto wP_Pq; } goto UAbMo; FLOq6: $this->trigger_events("\160\x72\145\x5f\165\x70\x64\141\x74\x65\137\x75\163\145\162"); goto Oq2p0; cEhw2: goto WbW6q; goto oSFxy; i7UMK: $this->trigger_events(["\160\157\x73\164\137\165\160\x64\x61\x74\x65\137\x75\163\145\162", "\160\157\x73\164\137\165\x70\144\x61\164\145\137\x75\x73\145\x72\137\x73\165\143\x63\x65\x73\x73\x66\x75\154"]); goto ft7cy; XATSc: wP_Pq: goto IShco; KFbXh: unset($data["\x70\141\x73\163\167\x6f\162\x64"]); goto cEhw2; yU4no: $this->db->trans_rollback(); goto WsR8U; T1Gfw: $this->trigger_events("\x65\170\164\162\x61\x5f\167\150\x65\x72\x65"); goto Ym62P; oGdC2: $this->db->trans_begin(); goto WJXkO; DDC3J: $this->trigger_events(["\160\157\163\164\x5f\x75\160\x64\x61\x74\145\x5f\165\x73\145\162", "\160\x6f\163\164\137\165\160\144\141\x74\x65\137\165\163\145\x72\x5f\x75\x6e\163\x75\143\143\145\163\163\x66\165\154"]); goto FJaKQ; FJaKQ: $this->set_error("\x75\160\x64\141\164\x65\137\165\x6e\x73\165\x63\x63\x65\163\163\146\165\x6c"); goto paABV; Oq2p0: $user = $this->user($id)->row(); goto oGdC2; W1kex: return TRUE; goto hKp9L; UAbMo: if (!empty($data["\x70\141\163\163\x77\x6f\x72\x64"])) { goto M41ye; } goto KFbXh; hKp9L: } public function delete_user($id) { goto jGILB; Q4Z9M: $this->db->trans_rollback(); goto qtg3u; JrEM5: return FALSE; goto nrQ2G; d3DB7: $this->remove_from_group(NULL, $id); goto zQa78; FX3XN: return TRUE; goto bAbEs; qtg3u: $this->trigger_events(["\x70\x6f\x73\164\x5f\144\145\154\x65\x74\x65\x5f\165\163\x65\x72", "\x70\157\163\x74\x5f\144\145\x6c\145\164\x65\x5f\x75\x73\x65\162\137\165\156\x73\x75\143\143\x65\163\163\x66\x75\154"]); goto J9TqZ; K9F0U: $this->set_message("\144\x65\154\145\x74\x65\137\x73\165\x63\x63\145\163\163\x66\x75\x6c"); goto FX3XN; I0q3x: $this->trigger_events(["\160\157\163\164\x5f\144\145\x6c\145\x74\x65\137\165\x73\x65\x72", "\160\x6f\163\x74\x5f\x64\x65\x6c\145\164\145\137\165\163\145\162\x5f\163\165\143\143\x65\163\163\146\x75\154"]); goto K9F0U; nrQ2G: k5PV2: goto Fv4Fd; AFe9n: $this->db->trans_begin(); goto d3DB7; zQa78: $this->db->delete($this->tables["\165\163\145\162\163"], ["\151\x64" => $id]); goto xLFnP; xLFnP: if (!($this->db->trans_status() === FALSE)) { goto k5PV2; } goto Q4Z9M; Fv4Fd: $this->db->trans_commit(); goto I0q3x; J9TqZ: $this->set_error("\x64\145\x6c\145\164\x65\137\x75\x6e\x73\x75\x63\143\x65\163\163\x66\x75\154"); goto JrEM5; jGILB: $this->trigger_events("\160\x72\145\137\x64\x65\x6c\x65\164\145\x5f\165\163\x65\162"); goto AFe9n; bAbEs: } public function update_last_login($id) { goto P7MWJ; k2odW: $this->db->update($this->tables["\165\163\x65\x72\163"], ["\x6c\x61\x73\x74\137\154\157\147\151\156" => time()], ["\x69\x64" => $id]); goto fwbfn; RfprY: $this->load->helper("\x64\141\164\x65"); goto YwE2v; YwE2v: $this->trigger_events("\x65\170\x74\x72\x61\x5f\167\150\x65\162\x65"); goto k2odW; P7MWJ: $this->trigger_events("\165\160\144\141\x74\x65\x5f\x6c\x61\163\164\137\154\x6f\147\151\156"); goto RfprY; fwbfn: return $this->db->affected_rows() == 1; goto iWWqm; iWWqm: } public function set_lang($lang = "\145\156") { goto MguXu; UJkRE: eeOsN: goto tPQ5r; I1Ufb: $expire = $this->config->item("\165\x73\145\x72\x5f\x65\170\160\x69\x72\x65", "\151\x6f\x6e\x5f\141\165\164\x68"); goto ueTIa; QmulW: if ($this->config->item("\165\x73\x65\x72\137\145\x78\160\151\x72\145", "\x69\x6f\x6e\x5f\x61\x75\164\150") === 0) { goto aDaj3; } goto I1Ufb; jISsd: $expire = self::MAX_COOKIE_LIFETIME; goto UJkRE; tPQ5r: set_cookie(["\x6e\x61\155\x65" => "\x6c\141\156\x67\x5f\143\x6f\144\x65", "\x76\x61\x6c\165\x65" => $lang, "\145\x78\x70\x69\162\145" => $expire]); goto RYhfR; ueTIa: goto eeOsN; goto ooHX0; ooHX0: aDaj3: goto jISsd; RYhfR: return TRUE; goto jnL3a; MguXu: $this->trigger_events("\163\145\x74\137\x6c\141\156\x67"); goto QmulW; jnL3a: } public function set_session($user) { goto aC9Df; fIUlg: $this->trigger_events("\160\x6f\x73\164\x5f\x73\x65\x74\x5f\x73\145\x73\163\151\157\x6e"); goto nQDx3; nQDx3: return TRUE; goto hokj2; aC9Df: $this->trigger_events("\x70\162\145\x5f\163\145\164\137\163\x65\x73\163\x69\x6f\156"); goto XtzI9; d6o05: $this->session->set_userdata($session_data); goto fIUlg; XtzI9: $session_data = ["\151\x64\145\x6e\x74\x69\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\x6d\x61\151\x6c" => $user->email, "\x75\x73\145\x72\x5f\x69\144" => $user->id, "\157\x6c\144\137\154\141\163\x74\137\x6c\x6f\147\x69\x6e" => $user->last_login, "\154\x61\x73\164\137\x63\x68\x65\x63\x6b" => time()]; goto d6o05; hokj2: } public function remember_user($identity) { goto b7uBq; DPXN1: set_cookie(["\156\141\x6d\x65" => $this->config->item("\162\145\155\x65\x6d\x62\145\162\137\143\157\x6f\x6b\x69\145\137\156\141\x6d\x65", "\151\x6f\156\x5f\141\165\164\x68"), "\x76\x61\x6c\165\145" => $token->user_code, "\x65\x78\160\151\162\x65" => $expire]); goto aC6K4; MJnV1: $expire = self::MAX_COOKIE_LIFETIME; goto eXmsC; v4qlW: mfM8L: goto Tfnzx; chxSz: if (!$token->validator_hashed) { goto mfM8L; } goto afjH0; HqaPA: return FALSE; goto fnD6e; ATQFC: goto w70Cr; goto bU_lH; Tfnzx: $this->trigger_events(["\x70\x6f\x73\164\137\x72\145\x6d\145\x6d\142\145\x72\137\x75\163\145\162", "\162\145\155\x65\x6d\x62\145\x72\137\x75\163\x65\x72\137\x75\x6e\x73\165\143\x63\x65\163\163\x66\x75\x6c"]); goto HqaPA; F0HB2: if ($this->config->item("\165\x73\x65\x72\x5f\145\170\160\x69\162\x65", "\151\157\x6e\137\141\x75\164\150") === 0) { goto Xp2Ci; } goto v1kD8; v1kD8: $expire = $this->config->item("\165\163\x65\x72\x5f\x65\170\160\x69\162\145", "\x69\x6f\x6e\137\141\x75\164\150"); goto ATQFC; RWvQa: $token = $this->_generate_selector_validator_couple(); goto chxSz; b7uBq: $this->trigger_events("\160\x72\x65\x5f\x72\x65\x6d\145\x6d\x62\x65\162\137\x75\x73\145\x72"); goto rUehE; HUe6A: KS7gU: goto RWvQa; rUehE: if ($identity) { goto KS7gU; } goto rRmB6; rRmB6: return FALSE; goto HUe6A; aC6K4: $this->trigger_events(["\160\157\163\x74\x5f\162\145\155\x65\155\142\145\162\137\165\x73\x65\162", "\162\x65\155\x65\x6d\142\145\162\x5f\165\x73\145\x72\x5f\x73\x75\x63\143\x65\163\163\x66\165\154"]); goto zj1qP; TjCho: GX0oJ: goto v4qlW; bU_lH: Xp2Ci: goto MJnV1; afjH0: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], ["\x72\x65\x6d\x65\155\x62\145\x72\x5f\x73\145\x6c\145\x63\164\157\162" => $token->selector, "\x72\145\x6d\145\x6d\x62\145\x72\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto FLKps; FLKps: if (!($this->db->affected_rows() > -1)) { goto GX0oJ; } goto F0HB2; zj1qP: return TRUE; goto TjCho; eXmsC: w70Cr: goto DPXN1; fnD6e: } public function login_remembered_user() { goto yepNZ; vDnzP: $this->set_session($user); goto ACfCz; AI2xg: if (!$this->config->item("\x75\163\145\x72\x5f\145\x78\164\x65\x6e\144\x5f\x6f\x6e\x5f\x6c\157\147\x69\156", "\151\157\x6e\x5f\141\x75\x74\150")) { goto rVHDl; } goto uPrWs; DCL6b: $this->trigger_events(["\x70\157\163\164\137\x6c\x6f\x67\x69\156\x5f\x72\145\155\145\x6d\142\x65\162\x65\144\x5f\x75\163\x65\162", "\160\157\x73\164\137\x6c\157\147\151\156\137\x72\145\x6d\145\x6d\142\145\x72\x65\x64\137\165\x73\x65\x72\x5f\x73\165\143\x63\145\163\163\x66\165\154"]); goto D1NTG; J5DJQ: $this->update_last_login($user->id); goto vDnzP; qn4PE: bKYMj: goto Ul9jZ; Ul9jZ: tXnBK: goto AWug7; VUVk9: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto bKYMj; } goto J5DJQ; yepNZ: $this->trigger_events("\x70\162\x65\x5f\x6c\x6f\147\x69\156\137\x72\145\x6d\145\x6d\142\145\x72\x65\x64\x5f\165\163\145\x72"); goto l2P4M; rSIfn: if (!($token === FALSE)) { goto KpnJ9; } goto peP7M; l2P4M: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\145\155\x62\145\162\x5f\143\157\x6f\153\x69\x65\137\x6e\141\x6d\x65", "\151\157\x6e\137\141\165\164\x68")); goto Ccsfk; kQoVg: return FALSE; goto fJY2o; fJY2o: KpnJ9: goto uf4BT; js2QS: if (!($query->num_rows() === 1)) { goto tXnBK; } goto LfiSp; uf4BT: $this->trigger_events("\145\170\164\x72\x61\137\x77\x68\145\x72\145"); goto QuveN; LfiSp: $user = $query->row(); goto fNnqe; CJ5oW: $this->trigger_events(["\x70\x6f\x73\x74\137\x6c\x6f\x67\151\x6e\137\162\x65\155\145\155\142\x65\x72\145\x64\x5f\x75\x73\x65\x72", "\160\157\x73\164\137\x6c\157\x67\x69\156\x5f\x72\x65\155\x65\155\x62\145\162\x65\144\x5f\165\163\145\162\137\165\x6e\x73\165\143\143\x65\x73\163\146\165\x6c"]); goto yUcGC; Lyszi: $this->session->sess_regenerate(FALSE); goto DCL6b; D1NTG: return TRUE; goto qn4PE; BuFoQ: rVHDl: goto Lyszi; AWug7: delete_cookie($this->config->item("\162\x65\x6d\x65\155\142\145\162\137\143\x6f\x6f\x6b\151\x65\x5f\x6e\141\155\x65", "\x69\157\156\137\141\165\164\x68")); goto CJ5oW; Ccsfk: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto rSIfn; peP7M: $this->trigger_events(["\x70\157\163\164\x5f\154\x6f\x67\151\x6e\x5f\162\145\x6d\145\155\x62\x65\162\145\x64\x5f\165\x73\145\162", "\160\157\x73\x74\x5f\154\x6f\x67\151\156\137\162\145\155\x65\155\142\145\x72\145\x64\137\165\163\145\x72\x5f\165\x6e\x73\x75\143\x63\145\163\163\146\x75\x6c"]); goto kQoVg; uPrWs: $this->remember_user($identity); goto BuFoQ; ACfCz: $this->clear_forgotten_password_code($identity); goto AI2xg; fNnqe: $identity = $user->{$this->identity_column}; goto VUVk9; QuveN: $query = $this->db->select($this->identity_column . "\54\40\151\x64\54\40\x65\x6d\x61\151\154\54\40\x72\x65\155\x65\x6d\142\145\x72\137\x63\157\144\x65\54\x20\x6c\x61\163\164\x5f\x6c\157\x67\151\156")->where("\x72\x65\x6d\145\155\142\145\162\137\x73\x65\x6c\145\x63\x74\157\x72", $token->selector)->where("\141\143\164\151\x76\x65", 1)->limit(1)->get($this->tables["\x75\163\145\x72\x73"]); goto js2QS; yUcGC: return FALSE; goto PlYXq; PlYXq: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto yYVRz; ViH94: $group_id = $this->db->insert_id($this->tables["\x67\x72\x6f\165\x70\x73"] . "\137\151\x64\x5f\x73\145\161"); goto w4NFR; yHNLJ: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\x75\160\x73"], $additional_data), $data); goto galFM; D9EwX: cYK43: goto RgpJg; NoXWU: return $group_id; goto YbEB7; RgpJg: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\163"], ["\156\x61\x6d\145" => $group_name])->num_rows(); goto TF_oO; I0oT5: return FALSE; goto D9EwX; w4NFR: $this->set_message("\147\x72\157\x75\160\x5f\x63\162\145\x61\x74\151\x6f\x6e\137\x73\x75\143\x63\145\x73\163\146\x75\x6c"); goto NoXWU; kAM0q: XjRT7: goto k8Qcd; k8Qcd: $data = ["\156\x61\155\x65" => $group_name, "\144\145\163\143\x72\x69\160\164\151\x6f\x6e" => $group_description]; goto PBLEM; KqbwN: $this->trigger_events("\145\x78\164\x72\x61\137\147\x72\x6f\165\160\x5f\163\x65\x74"); goto SSIHx; c8XRl: $this->set_error("\x67\162\x6f\x75\160\x5f\156\141\x6d\x65\x5f\x72\145\x71\165\151\162\x65\144"); goto I0oT5; TF_oO: if (!($existing_group !== 0)) { goto XjRT7; } goto D54mQ; SSIHx: $this->db->insert($this->tables["\147\162\157\x75\x70\x73"], $data); goto ViH94; FBaY1: return FALSE; goto kAM0q; galFM: wXy_6: goto KqbwN; yYVRz: if ($group_name) { goto cYK43; } goto c8XRl; PBLEM: if (empty($additional_data)) { goto wXy_6; } goto yHNLJ; D54mQ: $this->set_error("\147\x72\157\165\x70\x5f\141\154\x72\x65\x61\x64\x79\137\145\170\151\163\164\163"); goto FBaY1; YbEB7: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto Lz8GQ; CiI9A: $data = array_merge($this->_filter_data($this->tables["\x67\162\157\165\x70\163"], $additional_data), $data); goto vrQ8T; hPzD8: $existing_group = $this->db->get_where($this->tables["\147\162\x6f\165\160\163"], ["\156\141\155\145" => $group_name])->row(); goto RCi5H; Rul_g: return TRUE; goto WI5IX; RCi5H: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto GEH57; } goto Q5dGM; Q5dGM: $this->set_error("\147\x72\157\x75\160\137\x61\x6c\x72\145\141\144\171\137\145\x78\151\x73\x74\163"); goto vlkJM; GZSFq: return FALSE; goto igxRU; gWxKm: BLBB6: goto wOR7Q; z_PJo: $data["\156\x61\x6d\145"] = $group_name; goto FXFvr; vrQ8T: o2Nso: goto EEahJ; sO21n: $group = $this->db->get_where($this->tables["\x67\162\x6f\x75\x70\x73"], ["\x69\144" => $group_id])->row(); goto BAJyW; EEahJ: $this->db->update($this->tables["\147\162\157\x75\160\163"], $data, ["\151\x64" => $group_id]); goto rfFWr; MITp3: GEH57: goto z_PJo; io1oQ: if (empty($additional_data)) { goto o2Nso; } goto CiI9A; YV0FW: if (empty($group_name)) { goto j0e0v; } goto hPzD8; Lz8GQ: if (!empty($group_id)) { goto BLBB6; } goto qd53k; wOR7Q: $data = []; goto YV0FW; igxRU: SE43X: goto io1oQ; qkCwN: $this->set_error("\147\x72\x6f\165\x70\x5f\156\141\x6d\x65\137\x61\144\155\151\x6e\x5f\x6e\157\164\137\x61\154\x74\x65\162"); goto GZSFq; qd53k: return FALSE; goto gWxKm; vlkJM: return FALSE; goto MITp3; rfFWr: $this->set_message("\x67\162\x6f\165\x70\x5f\x75\x70\x64\141\x74\x65\137\x73\x75\x63\x63\145\163\163\x66\165\x6c"); goto Rul_g; FXFvr: j0e0v: goto sO21n; BAJyW: if (!($this->config->item("\x61\x64\155\151\x6e\137\147\x72\x6f\x75\x70", "\x69\x6f\x6e\x5f\x61\x75\x74\150") === $group->name && $group_name !== $group->name)) { goto SE43X; } goto qkCwN; WI5IX: } public function delete_group($group_id = FALSE) { goto b0SU6; HLunH: $this->db->trans_begin(); goto ne_pX; Y09oN: $this->set_error("\147\162\x6f\x75\x70\137\x64\x65\154\145\164\145\137\x75\x6e\x73\x75\x63\x63\145\x73\163\x66\x75\154"); goto Do6aY; lzej6: $this->trigger_events(["\160\x6f\163\x74\137\x64\x65\x6c\145\164\145\137\x67\162\x6f\165\x70", "\160\x6f\163\x74\x5f\144\145\x6c\x65\164\145\x5f\x67\162\157\165\x70\x5f\165\156\163\x75\x63\143\145\163\163\x66\x75\x6c"]); goto Y09oN; FUD8r: $this->trigger_events(["\160\157\163\164\x5f\x64\x65\154\145\x74\145\137\x67\162\x6f\165\x70", "\160\157\x73\164\x5f\x64\x65\x6c\145\164\145\137\x67\162\x6f\x75\x70\137\x6e\x6f\x74\x61\x6c\154\x6f\x77\145\x64"]); goto N2NWX; sGuQ6: if (!($this->db->trans_status() === FALSE)) { goto eov3o; } goto hV0Bm; pdtvl: if (!($group->name == $this->config->item("\141\144\155\x69\x6e\137\147\x72\157\165\x70", "\151\157\x6e\137\141\x75\164\x68"))) { goto VkZcq; } goto FUD8r; Do6aY: return FALSE; goto bRjlD; cSClr: VkZcq: goto mZmel; ne_pX: $this->db->delete($this->tables["\165\163\x65\162\163\x5f\147\x72\157\165\x70\163"], [$this->join["\147\x72\x6f\x75\160\x73"] => $group_id]); goto jojNk; dljDx: return FALSE; goto cSClr; lE0rL: $this->trigger_events(["\160\157\163\164\137\144\x65\154\145\164\145\137\147\162\157\165\160", "\160\x6f\x73\164\137\x64\145\154\145\x74\145\x5f\x67\x72\157\165\x70\137\163\165\143\143\x65\163\x73\146\x75\x6c"]); goto t05aX; hV0Bm: $this->db->trans_rollback(); goto lzej6; mZmel: $this->trigger_events("\160\162\x65\x5f\144\145\154\145\164\x65\x5f\147\x72\157\165\x70"); goto HLunH; bRjlD: eov3o: goto u4o96; t05aX: $this->set_message("\x67\162\157\165\160\137\144\145\154\145\164\x65\x5f\163\165\x63\x63\145\x73\x73\146\x75\154"); goto miBlt; N2NWX: $this->set_error("\147\x72\157\165\x70\x5f\x64\x65\x6c\x65\x74\145\137\x6e\x6f\x74\141\x6c\154\157\167\x65\144"); goto dljDx; orj1u: cQ2o1: goto bbIUt; jojNk: $this->db->delete($this->tables["\147\162\157\x75\160\x73"], ["\x69\x64" => $group_id]); goto sGuQ6; b0SU6: if (!(!$group_id || empty($group_id))) { goto cQ2o1; } goto RavlY; RavlY: return FALSE; goto orj1u; u4o96: $this->db->trans_commit(); goto lE0rL; miBlt: return TRUE; goto MCXfV; bbIUt: $group = $this->group($group_id)->row(); goto pdtvl; MCXfV: } public function set_hook($event, $name, $class, $method, $arguments) { goto sc6k1; pYqVk: $this->_ion_hooks->{$event}[$name]->method = $method; goto gJXSV; tg0TY: $this->_ion_hooks->{$event}[$name]->class = $class; goto pYqVk; sc6k1: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto tg0TY; gJXSV: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto uauUc; uauUc: } public function remove_hook($event, $name) { goto QKX7p; FtScO: unset($this->_ion_hooks->{$event}[$name]); goto PoVpg; PoVpg: cWFd5: goto kjqs0; QKX7p: if (!isset($this->_ion_hooks->{$event}[$name])) { goto cWFd5; } goto FtScO; kjqs0: } public function remove_hooks($event) { goto RzDnf; W2tZI: c2982: goto fc3V8; mdQn6: unset($this->_ion_hooks->{$event}); goto W2tZI; RzDnf: if (!isset($this->_ion_hooks->{$event})) { goto c2982; } goto mdQn6; fc3V8: } protected function _call_hook($event, $name) { goto PvGJk; Yr8tB: $hook = $this->_ion_hooks->{$event}[$name]; goto QpL3i; jI3Ka: kceuH: goto xLjCy; QpL3i: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto jI3Ka; PvGJk: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto kceuH; } goto Yr8tB; xLjCy: return FALSE; goto REd3o; REd3o: } public function trigger_events($events) { goto P1F8A; aE3EN: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); QnDNw: } goto XSbKg; Nt6V4: goto VWztI; goto zjevv; KqqUy: VWztI: goto ZcVfB; rNyzi: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto AIotj; } goto aE3EN; XSbKg: axxlR: goto kmC6C; kmC6C: AIotj: goto Nt6V4; TQJR7: foreach ($events as $event) { $this->trigger_events($event); SMUtd: } goto oxfxE; zjevv: nZpg_: goto TQJR7; P1F8A: if (is_array($events) && !empty($events)) { goto nZpg_; } goto rNyzi; oxfxE: T1opb: goto KqqUy; ZcVfB: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto Nopik; JUPda: return TRUE; goto YorFe; FcDpY: $this->message_end_delimiter = $end_delimiter; goto JUPda; Nopik: $this->message_start_delimiter = $start_delimiter; goto FcDpY; YorFe: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto jWXHp; H3qVs: return TRUE; goto UM9x7; jWXHp: $this->error_start_delimiter = $start_delimiter; goto gCkvP; gCkvP: $this->error_end_delimiter = $end_delimiter; goto H3qVs; UM9x7: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto Ojk3y; jV52o: return $_output; goto G_7UI; rLalG: foreach ($this->messages as $message) { goto fWMuF; gZTez: sXTiC: goto nSLPB; GZfz7: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto gZTez; fWMuF: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\43\x23"; goto GZfz7; nSLPB: } goto Hti5e; Ojk3y: $_output = ''; goto rLalG; Hti5e: nfDvm: goto jV52o; G_7UI: } public function messages_array($langify = TRUE) { goto Jz5fD; nhXTX: $_output = []; goto OqMqy; vN2Yr: return $_output; goto ixlXq; Tphah: rUmYz: goto nhXTX; Jz5fD: if ($langify) { goto rUmYz; } goto x8AlB; f2iTq: X7wik: goto vN2Yr; ixlXq: lRplz: goto InDf0; VSDe8: goto lRplz; goto Tphah; x8AlB: return $this->messages; goto VSDe8; OqMqy: foreach ($this->messages as $message) { goto L2s7S; R9pCH: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto RMZ01; RMZ01: ed7gd: goto XFO6j; L2s7S: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\43\x23"; goto R9pCH; XFO6j: } goto f2iTq; InDf0: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto GBW7i; GBW7i: $_output = ''; goto S4bAF; W8yQD: uT6Dg: goto DFTA0; S4bAF: foreach ($this->errors as $error) { goto ts_iJ; QVmRz: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto Hf5io; Hf5io: f7LpC: goto TcZ6o; ts_iJ: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto QVmRz; TcZ6o: } goto W8yQD; DFTA0: return $_output; goto Etpd0; Etpd0: } public function errors_array($langify = TRUE) { goto b1ypg; b1ypg: if ($langify) { goto ikUum; } goto Mmpqs; zxq4Y: I3Sfi: goto esNEy; esNEy: return $_output; goto RjuM8; voXc8: ikUum: goto zlQFU; SuBYe: foreach ($this->errors as $error) { goto KFRRD; hIQ7e: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto aPUyL; KFRRD: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\43"; goto hIQ7e; aPUyL: YRM19: goto teyiU; teyiU: } goto zxq4Y; RjuM8: g7umV: goto UP94X; Mmpqs: return $this->errors; goto l8U1r; zlQFU: $_output = []; goto SuBYe; l8U1r: goto g7umV; goto voXc8; UP94X: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto TC0F3; Vahy_: return $this->db->affected_rows() == 1; goto IDvYb; KOb1U: $data = ["\160\141\163\163\167\x6f\162\x64" => $hash, "\x72\x65\x6d\145\155\142\145\x72\137\143\x6f\144\145" => NULL, "\x66\157\162\147\x6f\x74\164\145\x6e\x5f\160\141\x73\163\167\157\x72\x64\137\x63\x6f\x64\145" => NULL, "\146\x6f\162\147\157\164\x74\145\x6e\137\160\x61\x73\163\x77\157\x72\x64\x5f\x74\x69\155\x65" => NULL]; goto kK0XV; hzEz5: if (!($hash === FALSE)) { goto Omc9s; } goto p_Rgg; RWtE0: Omc9s: goto KOb1U; TC0F3: $hash = $this->hash_password($password, $identity); goto hzEz5; mAwit: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto Vahy_; kK0XV: $this->trigger_events("\145\170\164\x72\x61\137\167\150\145\x72\145"); goto mAwit; p_Rgg: return FALSE; goto RWtE0; IDvYb: } protected function _filter_data($table, $data) { goto lRyxF; oHql4: foreach ($columns as $column) { goto i2Oum; zoCvU: Ng1oK: goto L9lxb; i2Oum: if (!array_key_exists($column, $data)) { goto Dy545; } goto KjgSi; KjgSi: $filtered_data[$column] = $data[$column]; goto Fnt4n; Fnt4n: Dy545: goto zoCvU; L9lxb: } goto wTqLQ; mweuw: if (!is_array($data)) { goto pAUhr; } goto oHql4; Co2Il: return $filtered_data; goto W4Jbx; s6t5c: pAUhr: goto Co2Il; wTqLQ: u_lGU: goto s6t5c; lV2sA: $columns = $this->db->list_fields($table); goto mweuw; lRyxF: $filtered_data = []; goto lV2sA; W4Jbx: } protected function _random_token($result_length = 32) { goto allCm; A_io5: if (!function_exists("\155\x63\x72\x79\x70\164\137\x63\x72\x65\141\x74\x65\x5f\151\x76")) { goto PQfav; } goto V9Q2c; JpMJz: P0W8g: goto A_io5; qkf9M: if (!function_exists("\x6f\x70\145\156\163\x73\154\x5f\x72\141\x6e\x64\157\155\137\160\x73\x65\165\144\x6f\137\x62\x79\164\x65\x73")) { goto P8DvD; } goto Y7ExS; z8vN9: return bin2hex(random_bytes($result_length / 2)); goto JpMJz; FB1m0: return FALSE; goto pT0bK; DitT3: PQfav: goto qkf9M; V9Q2c: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto DitT3; xRWeH: m2MNK: goto RRZmo; BlIqh: $result_length = 32; goto xRWeH; RRZmo: if (!function_exists("\x72\141\x6e\x64\x6f\155\x5f\142\x79\x74\145\x73")) { goto P0W8g; } goto z8vN9; allCm: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto m2MNK; } goto BlIqh; Y7ExS: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto C7Z8L; C7Z8L: P8DvD: goto FB1m0; pT0bK: } protected function _get_hash_parameters($identity = NULL) { goto tMoXh; tMoXh: $is_admin = FALSE; goto gSOTF; zOKA7: $user_id = $this->get_user_id_from_identity($identity); goto SeqxA; t1Tiv: mdbGb: goto JzTjy; DKarz: return $params; goto ZlxZY; NuR7T: switch ($this->hash_method) { case "\x62\x63\x72\x79\160\164": $params = ["\x63\x6f\163\x74" => $is_admin ? $this->config->item("\x62\143\162\x79\160\x74\x5f\141\144\155\x69\x6e\137\143\x6f\x73\x74", "\151\x6f\x6e\x5f\x61\x75\164\150") : $this->config->item("\142\143\162\x79\x70\164\137\144\x65\x66\141\x75\154\x74\137\143\157\163\x74", "\x69\x6f\156\137\x61\165\x74\150")]; goto a78qX; case "\141\x72\147\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\x72\x67\157\156\x32\x5f\x61\x64\155\x69\x6e\x5f\160\141\x72\141\x6d\163", "\x69\x6f\156\137\x61\165\x74\150") : $this->config->item("\x61\162\147\x6f\x6e\x32\x5f\144\145\146\x61\165\154\x74\x5f\x70\141\162\x61\155\x73", "\151\x6f\x6e\x5f\x61\165\164\150"); goto a78qX; default: } goto t1Tiv; gSOTF: if (!$identity) { goto t71qU; } goto zOKA7; CdEHV: t71qU: goto c29a0; c29a0: $params = FALSE; goto NuR7T; mjKhM: PS8oj: goto CdEHV; rQ61J: $is_admin = TRUE; goto mjKhM; SeqxA: if (!($user_id && $this->in_group($this->config->item("\x61\x64\x6d\x69\x6e\x5f\x67\x72\x6f\165\160", "\x69\157\156\x5f\141\x75\164\x68"), $user_id))) { goto PS8oj; } goto rQ61J; JzTjy: a78qX: goto DKarz; ZlxZY: } protected function _get_hash_algo() { goto nGNYK; xd9LK: switch ($this->hash_method) { case "\142\x63\x72\171\160\x74": $algo = PASSWORD_BCRYPT; goto shSAp; case "\x61\162\147\x6f\156\x32": $algo = PASSWORD_ARGON2I; goto shSAp; default: } goto gUzcM; uZKhR: shSAp: goto krfHc; krfHc: return $algo; goto c5rhx; nGNYK: $algo = FALSE; goto xd9LK; gUzcM: LD7Y3: goto uZKhR; c5rhx: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto FNcNO; FNcNO: $selector = $this->_random_token($selector_size); goto S6ZWN; S6ZWN: $validator = $this->_random_token($validator_size); goto NhDRq; L2Amk: return (object) ["\x73\145\154\x65\x63\164\x6f\x72" => $selector, "\166\141\154\x69\144\141\x74\157\x72\x5f\150\x61\163\150\x65\144" => $validator_hashed, "\165\x73\x65\162\x5f\143\x6f\144\145" => $user_code]; goto nrgp3; FlCUR: $user_code = "{$selector}\56{$validator}"; goto L2Amk; NhDRq: $validator_hashed = $this->hash_password($validator); goto FlCUR; nrgp3: } protected function _retrieve_selector_validator_couple($user_code) { goto r34e7; AAILZ: $tokens = explode("\56", $user_code); goto a9EbU; ZbL_B: return (object) ["\163\x65\154\145\143\x74\157\162" => $tokens[0], "\166\x61\x6c\151\144\x61\164\157\x72" => $tokens[1]]; goto Bht_F; a9EbU: if (!(count($tokens) === 2)) { goto s7oKK; } goto ZbL_B; Bht_F: s7oKK: goto RCvuV; r34e7: if (!$user_code) { goto kP2w2; } goto AAILZ; RCvuV: kP2w2: goto OKk62; OKk62: return FALSE; goto AoIHg; AoIHg: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto mQNY0; zn4qO: $hashed_password = sha1($password . $salt_db->salt); goto ur9Et; x_tkn: fm5ld: goto yH_UZ; gCsFC: return FALSE; goto ASmqJ; SZJZW: $this->trigger_events(["\x70\157\163\x74\x5f\163\150\x61\61\x5f\x70\141\x73\163\167\157\x72\144\137\x6d\151\147\x72\141\164\x69\x6f\156", "\160\x6f\x73\164\x5f\163\x68\141\61\137\160\x61\x73\x73\x77\157\162\144\x5f\x6d\151\147\x72\x61\x74\x69\x6f\156\137\165\x6e\x73\x75\143\x63\145\x73\x73\x66\x75\154"]); goto Vi3y0; ChX1l: $this->trigger_events(["\x70\x6f\163\164\x5f\x73\x68\141\61\x5f\160\x61\x73\x73\167\157\x72\x64\137\x6d\151\147\x72\x61\x74\151\157\x6e", "\160\157\x73\x74\137\x73\150\141\61\x5f\x70\141\x73\x73\167\157\162\144\x5f\155\x69\x67\x72\x61\x74\x69\x6f\156\x5f\x75\156\x73\165\143\x63\145\x73\x73\x66\x75\x6c"]); goto yx5AJ; Vi3y0: return FALSE; goto Szzri; ur9Et: nocKs: goto h4Zml; pPn1_: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\x68\141\x31\x5f\160\141\x73\163\x77\157\162\x64\x5f\x6d\x69\x67\x72\x61\x74\151\157\x6e", "\160\157\163\164\137\x73\150\x61\x31\x5f\x70\x61\x73\x73\167\157\x72\x64\137\x6d\151\x67\x72\x61\x74\x69\157\156\x5f\x73\x75\x63\x63\145\163\163\x66\x75\154"]); goto NMBBD; mQNY0: $this->trigger_events("\x70\162\x65\137\163\150\141\x31\x5f\x70\x61\163\x73\x77\157\162\144\x5f\x6d\151\147\162\x61\164\x69\157\156"); goto yFiBs; CiMnz: $this->trigger_events(["\x70\x6f\x73\164\x5f\163\x68\141\x31\x5f\160\141\x73\163\x77\157\162\x64\137\x6d\151\147\x72\x61\164\x69\x6f\x6e", "\160\157\163\164\137\163\x68\x61\x31\137\160\141\x73\x73\x77\157\162\x64\137\155\151\147\x72\x61\x74\x69\157\156\x5f\x75\x6e\163\x75\x63\x63\x65\x73\x73\146\x75\154"]); goto huFgE; Qzy3c: if (!($query->num_rows() !== 1)) { goto YrPuz; } goto CiMnz; Th9Rc: $salt_length = $this->config->item("\163\141\x6c\x74\137\x6c\x65\156\147\x74\x68", "\151\157\x6e\137\141\x75\164\150"); goto mWUZy; Myudr: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x73\x68\x61\61\137\160\x61\x73\163\167\157\162\144\x5f\x6d\x69\147\162\141\164\151\157\x6e", "\x70\x6f\x73\x74\x5f\163\150\141\x31\x5f\x70\x61\163\x73\167\157\x72\x64\x5f\x6d\151\x67\x72\141\164\151\157\156\137\x75\x6e\x73\x75\x63\143\x65\x73\163\x66\x75\x6c"]); goto gCsFC; mWh1a: YrPuz: goto zn4qO; Szzri: goto sxFT2; goto DuYHZ; M3lYx: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto ardr2; xMXXE: $salt_db = $query->row(); goto Qzy3c; mWUZy: if ($salt_length) { goto Fs_hx; } goto Myudr; ASmqJ: Fs_hx: goto jUzO0; yH_UZ: $query = $this->db->select("\163\x61\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\x73"]); goto xMXXE; c3N4k: GOOAc: goto pPn1_; hNwrk: return $result; goto xPWyi; NMBBD: uI1C1: goto hNwrk; FEE_u: if ($result) { goto GOOAc; } goto ChX1l; jUzO0: $salt = substr($hashed_password_db, 0, $salt_length); goto M3lYx; xPWyi: sxFT2: goto ZzImL; yFiBs: if ($this->config->item("\163\x74\x6f\162\145\x5f\163\141\154\164", "\x69\157\156\137\x61\x75\164\150")) { goto fm5ld; } goto Th9Rc; FLHs3: $result = $this->_set_password_db($identity, $password); goto FEE_u; h4Zml: if ($hashed_password === $hashed_password_db) { goto G1jZH; } goto SZJZW; DuYHZ: G1jZH: goto FLHs3; yx5AJ: goto uI1C1; goto c3N4k; ardr2: goto nocKs; goto x_tkn; huFgE: return FALSE; goto mWh1a; ZzImL: } }
