<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\105\x50\x41\x54\x48") or exit("\116\x6f\x20\144\x69\162\145\x63\164\40\163\143\162\151\x70\x74\40\x61\143\143\145\x73\x73\40\x61\x6c\154\157\167\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto opaT1; HmG05: goto PnO65; goto kzAin; oDzuq: $error_suffix->setAccessible(TRUE); goto Or9_X; DCnIR: $group_name = $this->config->item("\144\x61\164\141\142\141\x73\145\137\x67\162\157\x75\160\137\156\141\155\x65", "\x69\x6f\156\137\141\x75\164\150"); goto mE_C7; opaT1: $this->config->load("\151\x6f\x6e\137\141\x75\164\150", TRUE); goto hV572; w9drz: $this->load->library("\146\157\x72\x6d\x5f\x76\141\x6c\151\x64\141\x74\151\x6f\x6e"); goto ijLgP; y6VY7: $this->trigger_events("\x6d\x6f\x64\145\x6c\137\143\157\156\163\x74\162\165\x63\164\157\x72"); goto FxRV8; kXoZs: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto UB8O3; ijLgP: $form_validation_class = new ReflectionClass("\103\x49\137\x46\x6f\162\x6d\x5f\166\141\154\x69\x64\141\x74\151\157\156"); goto NaDMK; bBeqV: $this->identity_column = $this->config->item("\x69\144\145\156\x74\151\x74\x79", "\151\157\156\x5f\x61\x75\164\150"); goto CoTUg; CyYBj: $this->lang->load("\151\157\156\x5f\141\x75\x74\x68"); goto DCnIR; ign5_: $this->tables = $this->config->item("\x74\141\142\154\x65\x73", "\x69\x6f\156\x5f\141\165\164\x68"); goto bBeqV; mE_C7: if (empty($group_name)) { goto rDmnV; } goto b6g11; dHGK4: $this->message_end_delimiter = $this->error_end_delimiter; goto wq9MM; vvWNs: $this->_ion_hooks = new stdClass(); goto y6VY7; QC07s: $delimiters_source = $this->config->item("\144\x65\154\x69\x6d\151\x74\145\x72\x73\x5f\163\157\165\x72\x63\x65", "\151\157\x6e\x5f\141\165\x74\150"); goto fJM_s; lq7Lw: goto cB9iZ; goto Ywzgw; CbJcM: $error_suffix = $form_validation_class->getProperty("\x5f\x65\x72\162\x6f\x72\x5f\163\x75\x66\146\151\x78"); goto oDzuq; Ywzgw: rDmnV: goto QYTQ2; rP0YZ: $this->error_start_delimiter = $this->config->item("\x65\x72\x72\157\162\137\x73\x74\x61\x72\164\137\x64\145\x6c\151\155\151\164\x65\x72", "\151\x6f\x6e\x5f\141\x75\x74\150"); goto HcQ4J; uh7J4: $this->db = $CI->db; goto PaS7g; fJM_s: if ($delimiters_source === "\x66\157\x72\x6d\x5f\x76\141\154\151\144\141\164\x69\157\x6e") { goto DCuK6; } goto H99nw; C3INR: $this->message_end_delimiter = $this->config->item("\x6d\145\163\163\x61\147\145\137\145\x6e\x64\137\144\145\x6c\151\x6d\x69\164\145\x72", "\151\157\x6e\x5f\x61\x75\164\150"); goto rP0YZ; NaDMK: $error_prefix = $form_validation_class->getProperty("\x5f\x65\x72\x72\x6f\x72\137\x70\x72\145\x66\151\x78"); goto MRWEE; b6g11: $this->db = $this->load->database($group_name, TRUE, TRUE); goto lq7Lw; PaS7g: cB9iZ: goto ign5_; H99nw: $this->message_start_delimiter = $this->config->item("\x6d\x65\163\163\x61\x67\145\137\x73\x74\x61\162\164\x5f\x64\x65\x6c\151\155\151\164\x65\x72", "\151\x6f\x6e\137\141\165\x74\x68"); goto C3INR; xyaGM: $this->errors = []; goto QC07s; hV572: $this->load->helper("\143\x6f\157\x6b\151\x65"); goto KGKtC; KGKtC: $this->load->helper("\x64\x61\x74\x65"); goto CyYBj; CoTUg: $this->join = $this->config->item("\152\157\x69\156", "\151\x6f\156\137\x61\x75\x74\x68"); goto HtHyP; MRWEE: $error_prefix->setAccessible(TRUE); goto kXoZs; wq9MM: PnO65: goto vvWNs; PiE6U: $this->messages = []; goto xyaGM; HcQ4J: $this->error_end_delimiter = $this->config->item("\x65\x72\162\x6f\162\137\145\x6e\x64\x5f\144\145\154\151\x6d\151\164\145\162", "\151\x6f\x6e\x5f\141\x75\x74\150"); goto HmG05; HtHyP: $this->hash_method = $this->config->item("\x68\141\x73\x68\x5f\x6d\145\164\x68\157\x64", "\151\x6f\x6e\137\141\165\x74\150"); goto PiE6U; Or9_X: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto dHGK4; QYTQ2: $CI =& get_instance(); goto uh7J4; UB8O3: $this->message_start_delimiter = $this->error_start_delimiter; goto CbJcM; kzAin: DCuK6: goto w9drz; FxRV8: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto WFbco; mw937: return FALSE; goto sJXOI; hC7yj: $algo = $this->_get_hash_algo(); goto Oh1OH; u4Ghw: return password_hash($password, $algo, $params); goto L_rXl; WFbco: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto Ly0Eo; } goto aVwbv; Oh1OH: $params = $this->_get_hash_parameters($identity); goto E9vRQ; aVwbv: return FALSE; goto iCeZz; E9vRQ: if (!($algo !== FALSE && $params !== FALSE)) { goto mJJin; } goto u4Ghw; L_rXl: mJJin: goto mw937; iCeZz: Ly0Eo: goto hC7yj; sJXOI: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto zQL9G; EnntI: U6hbU: goto qIadB; mgYtc: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto n_DvT; bOkap: return password_verify($password, $hash_password_db); goto BtR9r; seBeW: ah0HN: goto bOkap; n_DvT: goto g3CVr; goto seBeW; zQL9G: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto U6hbU; } goto g0SZn; g0SZn: return FALSE; goto EnntI; BtR9r: g3CVr: goto gW0uZ; qIadB: if (strpos($hash_password_db, "\44") === 0) { goto ah0HN; } goto mgYtc; gW0uZ: } public function rehash_password_if_needed($hash, $identity, $password) { goto cneTO; nnUHF: kIYU3: goto Gk6WV; a6o51: if (!password_needs_rehash($hash, $algo, $params)) { goto nCmC_; } goto Ib7ee; sqkvo: goto kbPM6; goto nnUHF; GH5pC: nCmC_: goto LYkzg; Jooir: if (!($algo !== FALSE && $params !== FALSE)) { goto ds3nC; } goto a6o51; LYkzg: ds3nC: goto PzAng; Gk6WV: $this->trigger_events(["\x72\145\x68\x61\x73\x68\137\160\141\x73\163\x77\157\x72\x64", "\x72\145\150\x61\x73\x68\x5f\x70\x61\x73\x73\x77\x6f\x72\144\137\x73\x75\143\143\145\x73\x73\146\x75\x6c"]); goto yYtVG; Ib7ee: if ($this->_set_password_db($identity, $password)) { goto kIYU3; } goto hxbCH; cneTO: $algo = $this->_get_hash_algo(); goto i28yt; yYtVG: kbPM6: goto GH5pC; hxbCH: $this->trigger_events(["\162\x65\150\141\x73\150\137\160\x61\163\163\167\x6f\162\x64", "\x72\145\150\x61\x73\150\x5f\160\141\163\x73\167\x6f\x72\144\137\165\156\x73\165\143\x63\145\x73\x73\x66\165\x6c"]); goto sqkvo; i28yt: $params = $this->_get_hash_parameters($identity); goto Jooir; PzAng: } public function get_user_by_activation_code($user_code) { goto iyt9o; Zen1D: return FALSE; goto znemP; OWkDB: GSDEV: goto J_qLC; KydaZ: return $user; goto OWkDB; J_qLC: Ikkdl: goto Zen1D; iyt9o: $token = $this->_retrieve_selector_validator_couple($user_code); goto A5DXj; A5DXj: $user = $this->where("\141\x63\x74\x69\166\x61\164\151\157\156\x5f\163\x65\x6c\145\143\164\x6f\162", $token->selector)->users()->row(); goto C0zM6; yC2_a: if (!$this->verify_password($token->validator, $user->activation_code)) { goto GSDEV; } goto KydaZ; C0zM6: if (!$user) { goto Ikkdl; } goto yC2_a; znemP: } public function activate($id, $code = FALSE) { goto b2v1Z; vmI72: $user = $this->get_user_by_activation_code($code); goto MC4Ay; ip6OA: OlyKo: goto IN4xp; sKqEV: $this->trigger_events("\145\x78\164\162\x61\137\x77\150\145\x72\x65"); goto MO1kt; wROP6: if (!($this->db->affected_rows() === 1)) { goto OlyKo; } goto rTrfT; spm28: return FALSE; goto XuZf2; rTrfT: $this->trigger_events(["\x70\157\163\164\137\141\143\x74\151\x76\141\x74\x65", "\160\157\163\x74\x5f\x61\x63\x74\x69\x76\141\x74\145\x5f\163\165\143\143\145\x73\163\x66\165\154"]); goto Tt7QD; MO1kt: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, ["\x69\144" => $id]); goto wROP6; PMJJO: $this->trigger_events(["\160\157\x73\164\137\x61\143\x74\x69\166\x61\164\x65", "\x70\x6f\163\x74\x5f\x61\x63\164\x69\166\141\164\x65\137\165\156\163\165\x63\x63\x65\163\163\146\165\x6c"]); goto Ws7wP; kmJUc: return TRUE; goto ip6OA; b2v1Z: $this->trigger_events("\160\x72\x65\137\141\x63\x74\x69\166\x61\x74\x65"); goto mZ0Hf; IN4xp: H0L4z: goto PMJJO; b525e: $data = ["\141\143\x74\151\x76\141\x74\x69\157\x6e\x5f\163\145\x6c\x65\143\x74\x6f\162" => NULL, "\x61\x63\x74\x69\166\141\164\x69\157\x6e\x5f\143\x6f\144\x65" => NULL, "\141\x63\x74\x69\x76\145" => 1]; goto sKqEV; Ws7wP: $this->set_error("\x61\x63\164\x69\166\x61\164\x65\x5f\165\x6e\163\x75\x63\x63\x65\163\x73\146\165\154"); goto spm28; mZ0Hf: if (!($code !== FALSE)) { goto OW5sK; } goto vmI72; MC4Ay: OW5sK: goto NEE8F; NEE8F: if (!($code === FALSE || $user && $user->id === $id)) { goto H0L4z; } goto b525e; Tt7QD: $this->set_message("\141\143\x74\151\x76\x61\164\x65\137\x73\165\x63\143\145\x73\x73\x66\165\x6c"); goto kmJUc; XuZf2: } public function deactivate($id = NULL) { goto l8JHE; B3cb7: $this->set_error("\x64\x65\x61\x63\x74\x69\166\141\164\145\137\165\156\163\165\143\x63\x65\163\x73\146\x75\154"); goto B2cDM; Q3s1g: $token = $this->_generate_selector_validator_couple(20, 40); goto C0rYR; wkksp: goto klnmi; goto mTzE6; MJsH0: $this->trigger_events("\145\170\164\x72\x61\137\x77\150\145\x72\x65"); goto JHm6B; doS9b: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto Z153C; } goto ONuTx; l8JHE: $this->trigger_events("\144\x65\x61\x63\164\151\166\x61\x74\x65"); goto hCrL1; C0rYR: $this->activation_code = $token->user_code; goto vV3CA; l0dau: klnmi: goto nhFKP; ONuTx: $this->set_error("\x64\145\141\x63\164\x69\166\x61\164\145\137\143\x75\x72\x72\x65\x6e\164\137\165\163\145\162\137\x75\156\x73\165\x63\x63\145\163\x73\x66\x75\x6c"); goto MkhSX; k8B1R: $this->set_error("\x64\145\x61\143\164\x69\x76\141\164\145\x5f\165\156\163\x75\143\143\x65\163\x73\x66\165\154"); goto wkksp; mTzE6: Sw29o: goto V8nN5; V8nN5: $this->set_message("\144\x65\141\143\164\x69\166\141\x74\145\137\x73\x75\x63\143\x65\163\x73\146\165\154"); goto l0dau; uzOwd: Z153C: goto AQcWd; nhFKP: return $return; goto RlBz9; LEPBt: WWM0s: goto Q3s1g; MkhSX: return FALSE; goto uzOwd; xSYPn: if ($return) { goto Sw29o; } goto k8B1R; AQcWd: goto WWM0s; goto IMo4u; loRCe: $return = $this->db->affected_rows() == 1; goto xSYPn; hCrL1: if (!isset($id)) { goto Dv1Uf; } goto doS9b; B2cDM: return FALSE; goto LEPBt; IMo4u: Dv1Uf: goto B3cb7; JHm6B: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, ["\x69\144" => $id]); goto loRCe; vV3CA: $data = ["\141\x63\164\151\166\x61\164\x69\157\x6e\137\x73\x65\x6c\x65\143\164\x6f\162" => $token->selector, "\x61\x63\164\x69\x76\141\164\x69\x6f\156\x5f\143\x6f\144\x65" => $token->validator_hashed, "\x61\x63\x74\x69\166\145" => 0]; goto MJsH0; RlBz9: } public function clear_forgotten_password_code($identity) { goto YSsuV; KAaNE: $data = ["\146\157\162\147\x6f\x74\164\145\x6e\137\x70\141\163\163\x77\157\162\x64\x5f\163\145\154\x65\x63\x74\157\162" => NULL, "\146\x6f\x72\x67\157\164\x74\145\x6e\x5f\x70\x61\x73\x73\167\157\162\144\137\x63\157\144\145" => NULL, "\146\x6f\x72\147\x6f\x74\x74\x65\x6e\137\x70\x61\163\x73\167\x6f\x72\x64\137\164\x69\155\145" => NULL]; goto CPhCI; G654t: THFxw: goto KAaNE; YL194: return FALSE; goto G654t; CPhCI: $this->db->update($this->tables["\x75\163\145\162\163"], $data, [$this->identity_column => $identity]); goto JDcDT; YSsuV: if (!empty($identity)) { goto THFxw; } goto YL194; JDcDT: return TRUE; goto Alk4s; Alk4s: } public function clear_remember_code($identity) { goto DZmXx; cjhHH: N3Jo_: goto GYhNz; zJxIt: return TRUE; goto nUUm8; IoA8Z: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, [$this->identity_column => $identity]); goto zJxIt; DZmXx: if (!empty($identity)) { goto N3Jo_; } goto NpBIE; NpBIE: return FALSE; goto cjhHH; GYhNz: $data = ["\x72\145\x6d\145\x6d\142\x65\x72\x5f\163\x65\x6c\145\x63\x74\x6f\x72" => NULL, "\x72\145\x6d\x65\155\x62\145\x72\x5f\143\157\x64\x65" => NULL]; goto IoA8Z; nUUm8: } public function reset_password($identity, $new) { goto KGiAG; NwzMG: qyE9t: goto fYWIW; EEnIG: return $return; goto nx7Pm; KWW4t: goto YifuD; goto aoduO; Dbxm6: if ($return) { goto ye5hb; } goto dR7zG; EE0jJ: $this->set_error("\x70\141\163\x73\x77\157\162\144\x5f\143\x68\x61\x6e\x67\x65\x5f\165\156\163\165\143\143\x65\x73\x73\x66\x75\154"); goto KWW4t; PHHw4: $this->trigger_events(["\160\x6f\163\x74\x5f\x63\150\141\156\x67\145\137\160\x61\x73\163\167\157\x72\x64", "\160\x6f\163\164\137\143\150\141\156\147\x65\137\160\141\163\163\x77\157\162\x64\137\x75\x6e\x73\x75\x63\143\145\x73\163\146\x75\154"]); goto JSgVf; JSgVf: return FALSE; goto NwzMG; pguSk: if ($this->identity_check($identity)) { goto qyE9t; } goto PHHw4; IFY17: $this->trigger_events(["\160\157\x73\x74\x5f\x63\x68\141\x6e\147\145\137\x70\x61\163\x73\x77\x6f\x72\144", "\x70\157\x73\164\x5f\x63\150\x61\156\x67\x65\137\160\x61\x73\163\167\157\162\x64\137\163\x75\143\143\x65\163\163\x66\x75\x6c"]); goto mlnLM; KGiAG: $this->trigger_events("\160\x72\x65\x5f\x63\x68\x61\156\147\145\137\160\x61\163\x73\x77\157\x72\x64"); goto pguSk; dR7zG: $this->trigger_events(["\x70\x6f\163\x74\x5f\x63\x68\141\156\147\x65\137\x70\141\x73\163\x77\x6f\x72\x64", "\160\x6f\163\x74\x5f\143\x68\141\x6e\x67\x65\137\160\x61\163\x73\167\x6f\162\x64\x5f\165\x6e\163\165\x63\x63\145\x73\163\x66\165\x6c"]); goto EE0jJ; DXsMa: YifuD: goto EEnIG; mlnLM: $this->set_message("\x70\x61\163\x73\167\157\x72\x64\137\x63\x68\x61\x6e\147\145\x5f\163\x75\143\143\145\x73\x73\x66\x75\154"); goto DXsMa; fYWIW: $return = $this->_set_password_db($identity, $new); goto Dbxm6; aoduO: ye5hb: goto IFY17; nx7Pm: } public function change_password($identity, $old, $new) { goto ZDOTm; PQVor: hzk1V: goto pYIW0; JDk9u: PrBav: goto pn8eZ; mWAN2: if ($result) { goto hzk1V; } goto v0_rC; ZDOTm: $this->trigger_events("\160\162\x65\x5f\x63\x68\x61\156\x67\x65\137\160\x61\x73\x73\x77\157\x72\x64"); goto em8ZV; INn6h: $result = $this->_set_password_db($identity, $new); goto mWAN2; v0_rC: $this->trigger_events(["\160\157\163\164\137\x63\x68\x61\156\147\145\x5f\160\141\x73\x73\x77\157\162\144", "\x70\157\163\164\137\x63\150\141\x6e\x67\x65\x5f\160\x61\163\163\x77\x6f\x72\144\x5f\x75\x6e\x73\x75\x63\x63\x65\x73\x73\146\x75\154"]); goto HKXop; pn8eZ: return $result; goto fAr26; EIt7K: return FALSE; goto eNkBG; R9LjG: if (!$this->verify_password($old, $user->password, $identity)) { goto Aqhvp; } goto INn6h; kFkp0: $this->set_error("\160\x61\163\x73\x77\157\162\x64\137\x63\x68\x61\x6e\147\x65\x5f\x75\x6e\163\165\143\143\145\x73\163\x66\165\154"); goto EIt7K; HKXop: $this->set_error("\160\141\x73\163\x77\x6f\162\x64\x5f\x63\x68\141\156\147\145\137\x75\156\x73\x75\x63\143\145\163\163\x66\165\x6c"); goto e6iGu; hrbu8: gKiA9: goto nHCt7; fAr26: Aqhvp: goto kFkp0; pYIW0: $this->trigger_events(["\x70\157\163\x74\137\143\x68\x61\x6e\147\x65\137\x70\x61\x73\x73\x77\157\162\x64", "\160\x6f\x73\164\x5f\x63\x68\141\x6e\x67\x65\x5f\x70\141\163\x73\167\157\162\144\137\163\165\143\143\145\x73\163\x66\165\x6c"]); goto wQUe1; ecG_8: $this->set_error("\x70\x61\x73\163\x77\x6f\x72\144\137\x63\x68\141\156\147\145\137\165\x6e\x73\165\143\x63\145\163\163\146\x75\154"); goto d_pmt; FN2Zg: $this->trigger_events(["\x70\157\x73\164\137\143\150\141\156\x67\145\137\160\141\163\x73\167\157\x72\144", "\160\157\x73\x74\x5f\x63\x68\x61\156\147\x65\137\160\141\163\x73\167\x6f\162\144\x5f\x75\x6e\x73\x75\143\x63\145\x73\163\146\x75\154"]); goto ecG_8; e6iGu: goto PrBav; goto PQVor; iAqUN: if (!($query->num_rows() !== 1)) { goto gKiA9; } goto FN2Zg; nHCt7: $user = $query->row(); goto R9LjG; n85WP: $query = $this->db->select("\x69\x64\54\40\160\x61\163\163\167\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\145\x73\x63")->get($this->tables["\165\163\145\162\163"]); goto iAqUN; em8ZV: $this->trigger_events("\x65\170\x74\162\x61\137\x77\x68\x65\162\145"); goto n85WP; d_pmt: return FALSE; goto hrbu8; wQUe1: $this->set_message("\x70\x61\x73\163\x77\x6f\x72\144\x5f\x63\150\141\x6e\147\x65\137\x73\165\143\x63\x65\163\163\146\x75\x6c"); goto JDk9u; eNkBG: } public function username_check($username = '') { goto nedyf; NY7mF: return $this->db->where("\x75\163\145\x72\156\141\x6d\145", $username)->limit(1)->count_all_results($this->tables["\165\163\145\x72\x73"]) > 0; goto AqYrG; oRz2V: return FALSE; goto Khupw; nedyf: $this->trigger_events("\x75\163\145\x72\x6e\x61\x6d\x65\137\143\150\145\x63\x6b"); goto wvnpJ; Khupw: nefxd: goto IPaHe; wvnpJ: if (!empty($username)) { goto nefxd; } goto oRz2V; IPaHe: $this->trigger_events("\x65\170\164\x72\141\x5f\167\150\145\x72\x65"); goto NY7mF; AqYrG: } public function email_check($email = '') { goto WiqYU; qzC2R: $this->trigger_events("\x65\x78\x74\162\141\137\167\x68\145\162\145"); goto GmyP4; F8kKO: return FALSE; goto g1VZF; WiqYU: $this->trigger_events("\x65\x6d\141\151\x6c\x5f\143\x68\145\143\x6b"); goto q2ee9; GmyP4: return $this->db->where("\145\155\141\x69\x6c", $email)->limit(1)->count_all_results($this->tables["\165\163\145\x72\x73"]) > 0; goto pM8EX; g1VZF: odAu1: goto qzC2R; q2ee9: if (!empty($email)) { goto odAu1; } goto F8kKO; pM8EX: } public function identity_check($identity = '') { goto fG3Fb; u6woP: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\145\162\x73"]) > 0; goto XkyB7; B2x4q: return FALSE; goto WfdKV; fG3Fb: $this->trigger_events("\151\144\145\156\x74\151\x74\171\x5f\143\150\145\x63\x6b"); goto EdRYx; WfdKV: JTB6X: goto u6woP; EdRYx: if (!empty($identity)) { goto JTB6X; } goto B2x4q; XkyB7: } public function get_user_id_from_identity($identity = '') { goto xSnGf; sGGTu: return $user->id; goto nvUE1; azC5D: BbK60: goto VJcrQ; VJcrQ: $user = $query->row(); goto sGGTu; xSnGf: if (!empty($identity)) { goto b7ZNP; } goto inEQJ; UtKvC: return FALSE; goto azC5D; inEQJ: return FALSE; goto pITCx; pITCx: b7ZNP: goto TLGBg; KR4xU: if (!($query->num_rows() !== 1)) { goto BbK60; } goto UtKvC; TLGBg: $query = $this->db->select("\151\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\x72\x73"]); goto KR4xU; nvUE1: } public function forgotten_password($identity) { goto jEOdl; Nr_CX: $token = $this->_generate_selector_validator_couple(20, 80); goto A1kgz; P227u: if ($this->db->affected_rows() === 1) { goto OOGpW; } goto lBkkW; euFSG: return FALSE; goto wkRlm; A1kgz: $update = ["\146\157\x72\147\x6f\164\x74\x65\x6e\x5f\160\x61\163\163\x77\157\162\144\137\x73\x65\154\145\143\x74\157\162" => $token->selector, "\146\157\x72\x67\x6f\164\164\x65\156\x5f\160\x61\x73\163\x77\157\x72\144\x5f\x63\x6f\x64\x65" => $token->validator_hashed, "\x66\157\x72\x67\x6f\164\x74\145\x6e\x5f\x70\x61\163\163\167\x6f\x72\x64\x5f\164\x69\155\x65" => time()]; goto ay3zs; ay3zs: $this->trigger_events("\145\x78\164\x72\x61\137\167\x68\145\162\x65"); goto iw1Kt; d3vYY: wTUIV: goto s0mMl; BAAU1: $this->trigger_events(["\x70\157\x73\x74\x5f\x66\157\162\147\x6f\164\x74\145\x6e\x5f\x70\x61\x73\x73\167\x6f\x72\144", "\160\x6f\x73\164\137\x66\x6f\x72\x67\157\x74\x74\145\x6e\137\x70\141\x73\x73\167\x6f\x72\144\137\x73\165\x63\x63\x65\163\163\146\x75\x6c"]); goto TC4LK; NrUXB: OOGpW: goto BAAU1; f5S_u: return FALSE; goto X4212; wQJsS: $this->trigger_events(["\160\157\x73\164\x5f\146\x6f\162\147\x6f\164\x74\x65\x6e\x5f\160\x61\x73\x73\167\x6f\162\x64", "\x70\x6f\163\x74\x5f\146\x6f\x72\147\157\164\x74\x65\156\x5f\160\x61\163\x73\167\157\x72\144\137\165\156\163\165\x63\x63\145\x73\163\x66\165\x6c"]); goto f5S_u; X4212: CFiCx: goto Nr_CX; jEOdl: if (!empty($identity)) { goto CFiCx; } goto wQJsS; lBkkW: $this->trigger_events(["\x70\157\x73\x74\137\146\157\x72\147\x6f\x74\164\145\x6e\x5f\160\x61\x73\163\x77\x6f\x72\x64", "\x70\157\x73\x74\137\146\157\x72\147\157\x74\x74\145\x6e\137\160\x61\163\x73\x77\157\162\144\137\165\x6e\163\165\x63\143\145\163\163\146\165\154"]); goto euFSG; TC4LK: return $token->user_code; goto d3vYY; wkRlm: goto wTUIV; goto NrUXB; iw1Kt: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], $update, [$this->identity_column => $identity]); goto P227u; s0mMl: } public function get_user_by_forgotten_password_code($user_code) { goto T3qMp; spN9R: Dy8Zb: goto kVpDE; aZhNp: $user = $this->where("\x66\x6f\x72\147\157\x74\x74\145\x6e\137\x70\141\163\x73\x77\157\x72\144\137\163\x65\154\145\x63\164\x6f\x72", $token->selector)->users()->row(); goto IYmWc; IYmWc: if (!$user) { goto PxxOL; } goto cxZH4; v7ueN: return FALSE; goto xVd3r; cxZH4: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto Dy8Zb; } goto mQnhP; T3qMp: $token = $this->_retrieve_selector_validator_couple($user_code); goto aZhNp; kVpDE: PxxOL: goto v7ueN; mQnhP: return $user; goto spN9R; xVd3r: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto j_XID; Njqn8: if (empty($groups)) { goto crsiP; } goto gcbvp; mPhAK: return FALSE; goto N86VZ; o1hoH: mAq3o: goto Jhxt2; b37yd: $data = [$this->identity_column => $identity, "\165\x73\x65\x72\156\x61\x6d\145" => $identity, "\x70\x61\163\x73\167\157\162\144" => $password, "\x65\x6d\x61\x69\154" => $email, "\151\160\x5f\x61\x64\x64\x72\x65\163\163" => $ip_address, "\x63\162\145\141\x74\x65\x64\137\x6f\x6e" => time(), "\141\143\x74\151\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto tllqJ; aLudb: if (!(!isset($query->id) && empty($groups))) { goto creGW; } goto jHZEU; JfZIr: fPELB: goto vVpn9; iBOFv: $this->set_error("\x61\x63\x63\157\x75\x6e\164\x5f\x63\x72\x65\x61\164\151\x6f\156\x5f\x75\x6e\163\165\x63\x63\x65\x73\x73\x66\165\x6c"); goto mPhAK; vVpn9: crsiP: goto TBWW_; uHXSz: $this->set_error("\x61\x63\143\x6f\165\x6e\164\137\143\162\x65\x61\x74\x69\x6f\156\x5f\x6d\x69\x73\163\x69\x6e\147\x5f\144\145\x66\141\165\154\164\137\147\x72\157\x75\x70"); goto CA87I; gcbvp: foreach ($groups as $group) { $this->add_to_group($group, $id); oMdkC: } goto JfZIr; Aindd: goto mAq3o; goto oKPwh; jHZEU: $this->set_error("\x61\x63\143\157\x75\x6e\164\137\x63\162\145\x61\x74\151\157\x6e\x5f\151\156\166\x61\x6c\151\144\x5f\144\145\x66\141\x75\x6c\x74\137\x67\162\x6f\x75\160"); goto sS02u; DycLh: if ($this->identity_check($identity)) { goto bCLIY; } goto OBa3s; bNFEL: N1ky8: goto Aindd; STxCX: $this->trigger_events("\x65\170\164\162\x61\137\x73\145\x74"); goto CspQH; gXSev: creGW: goto m8IEM; N86VZ: gwqrI: goto b37yd; tllqJ: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\x65\x72\163"], $additional_data), $data); goto STxCX; j_XID: $this->trigger_events("\160\162\145\137\162\x65\147\151\x73\164\x65\x72"); goto R243y; PAmji: $ip_address = $this->input->ip_address(); goto j9S0z; x0kZd: $groups[] = $default_group->id; goto JSyqG; m8IEM: $default_group = $query; goto PAmji; CA87I: return FALSE; goto bNFEL; CspQH: $this->db->insert($this->tables["\165\163\145\162\163"], $user_data); goto H3Az4; j9S0z: $password = $this->hash_password($password); goto VIfoX; Jhxt2: $query = $this->db->get_where($this->tables["\x67\162\x6f\165\160\x73"], ["\x6e\x61\x6d\145" => $this->config->item("\144\145\146\x61\x75\x6c\x74\x5f\147\x72\x6f\165\160", "\x69\x6f\x6e\x5f\141\165\164\x68")], 1)->row(); goto aLudb; GghsC: return FALSE; goto o1hoH; sS02u: return FALSE; goto gXSev; R243y: $manual_activation = $this->config->item("\155\x61\x6e\165\x61\154\x5f\141\x63\164\151\166\141\x74\x69\x6f\x6e", "\151\x6f\156\137\x61\x75\164\x68"); goto DycLh; oKPwh: bCLIY: goto csfBd; csfBd: $this->set_error("\141\x63\143\x6f\165\156\x74\137\x63\162\x65\x61\164\x69\x6f\x6e\137\144\165\x70\154\x69\x63\x61\x74\x65\137\x69\144\145\x6e\164\x69\x74\x79"); goto GghsC; jiwzd: return isset($id) ? $id : FALSE; goto tyeF5; VIfoX: if (!($password === FALSE)) { goto gwqrI; } goto iBOFv; TBWW_: $this->trigger_events("\160\157\163\164\137\162\145\147\x69\x73\164\145\162"); goto jiwzd; H3Az4: $id = $this->db->insert_id($this->tables["\x75\x73\x65\162\163"] . "\x5f\x69\144\137\x73\145\x71"); goto RfN86; OBa3s: if (!(!$this->config->item("\144\145\x66\141\x75\x6c\x74\x5f\147\162\157\x75\x70", "\151\157\156\137\141\x75\x74\x68") && empty($groups))) { goto N1ky8; } goto uHXSz; JSyqG: CWXbx: goto Njqn8; RfN86: if (!(isset($default_group->id) && empty($groups))) { goto CWXbx; } goto x0kZd; tyeF5: } public function login($identity, $password, $remember = FALSE) { goto T6V30; mxQhZ: if (!$this->is_max_login_attempts_exceeded($identity)) { goto GzWJL; } goto KYuMB; kIalX: return TRUE; goto jEg_D; PXsmg: GzWJL: goto FwRBx; o6QZX: PhkGU: goto A9DiO; T6V30: $this->trigger_events("\160\162\x65\x5f\154\157\x67\x69\x6e"); goto mwlCA; tCWkJ: $this->set_error("\x6c\x6f\147\151\156\x5f\x75\156\x73\165\143\143\145\163\x73\146\165\x6c"); goto XkIJw; Mdrgu: $this->session->sess_regenerate(FALSE); goto gd4h9; VcUG0: goto z9tzT; goto o6QZX; mjVUG: $this->set_message("\x6c\157\147\151\x6e\x5f\x73\x75\143\143\145\x73\163\x66\x75\154"); goto kIalX; XkIJw: return FALSE; goto sRPGd; JcZ4L: $this->rehash_password_if_needed($user->password, $identity, $password); goto Mdrgu; yj95K: if (!$this->verify_password($password, $user->password, $identity)) { goto pr6lC; } goto j8MDO; kLB7J: $query = $this->db->select($this->identity_column . "\54\40\x65\155\x61\151\x6c\54\x20\151\144\54\x20\160\x61\163\163\167\157\162\144\54\x20\141\143\x74\151\x76\x65\54\x20\x6c\141\x73\164\x5f\x6c\157\147\x69\156")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\145\x73\143")->get($this->tables["\x75\x73\145\162\163"]); goto mxQhZ; gd4h9: $this->trigger_events(["\160\x6f\163\164\x5f\x6c\157\x67\151\156", "\x70\157\x73\x74\x5f\154\157\147\151\156\137\x73\x75\143\x63\x65\x73\x73\x66\x75\x6c"]); goto mjVUG; A5B7Z: y_Wl7: goto JcZ4L; WkYeU: $this->hash_password($password); goto GIuJM; A9DiO: $this->remember_user($identity); goto i3brW; C9TuK: $this->set_session($user); goto uZEzV; FwRBx: if (!($query->num_rows() === 1)) { goto BdEZK; } goto ejju4; sRPGd: YJK5X: goto WTvp6; yo2jD: return FALSE; goto PeIA3; j8MDO: if (!($user->active == 0)) { goto KiaFx; } goto JdSlk; OHmK0: $this->trigger_events("\x70\157\163\x74\137\x6c\x6f\x67\x69\156\137\x75\156\163\165\x63\x63\145\163\x73\146\165\154"); goto TuaAq; KYuMB: $this->hash_password($password); goto gWOpO; WTvp6: $this->trigger_events("\x65\170\x74\x72\x61\137\x77\150\x65\162\145"); goto kLB7J; jEg_D: pr6lC: goto cg3uZ; P_uzc: return FALSE; goto KnALy; i3brW: z9tzT: goto A5B7Z; fmBoc: if ($remember) { goto PhkGU; } goto z40yP; GIuJM: $this->increase_login_attempts($identity); goto OHmK0; zCLD7: $this->set_error("\154\x6f\x67\151\156\x5f\x74\151\155\145\157\x75\164"); goto rfNdC; cg3uZ: BdEZK: goto WkYeU; z40yP: $this->clear_remember_code($identity); goto VcUG0; gWOpO: $this->trigger_events("\160\x6f\163\164\137\x6c\x6f\147\x69\x6e\x5f\165\156\163\x75\143\x63\145\163\163\146\x75\x6c"); goto zCLD7; TuaAq: $this->set_error("\154\157\147\151\156\137\165\156\163\x75\143\143\145\x73\x73\x66\165\x6c"); goto yo2jD; rfNdC: return FALSE; goto PXsmg; pan2H: $this->clear_forgotten_password_code($identity); goto GUU5N; mwlCA: if (!(empty($identity) || empty($password))) { goto YJK5X; } goto tCWkJ; JdSlk: $this->trigger_events("\160\x6f\163\164\137\154\157\x67\x69\156\x5f\x75\156\163\x75\x63\143\145\x73\x73\146\165\x6c"); goto U0ZBS; uZEzV: $this->update_last_login($user->id); goto wVG8m; wVG8m: $this->clear_login_attempts($identity); goto pan2H; GUU5N: if (!$this->config->item("\x72\x65\x6d\x65\155\142\x65\162\137\165\x73\x65\162\163", "\x69\x6f\x6e\x5f\141\165\x74\x68")) { goto y_Wl7; } goto fmBoc; KnALy: KiaFx: goto C9TuK; U0ZBS: $this->set_error("\x6c\x6f\x67\x69\x6e\137\165\x6e\163\165\x63\143\x65\x73\163\146\x75\x6c\137\x6e\157\x74\137\141\143\x74\151\166\x65"); goto P_uzc; ejju4: $user = $query->row(); goto yj95K; PeIA3: } public function recheck_session() { goto RxR44; dB6js: Fbv9N: goto FaiuL; RdRbM: $this->trigger_events("\x6c\157\147\x6f\165\x74"); goto rIPmE; muAOG: mJybk: goto BIKeM; O7gSK: if ($query->num_rows() === 1) { goto Fbv9N; } goto RdRbM; RxR44: $recheck = NULL !== $this->config->item("\162\x65\x63\150\x65\143\153\137\x74\151\155\x65\162", "\x69\157\156\x5f\x61\x75\164\x68") ? $this->config->item("\x72\145\x63\150\x65\x63\x6b\137\164\x69\x6d\145\162", "\151\x6f\156\x5f\x61\x75\x74\150") : 0; goto Ur9z4; Ur9z4: if (!($recheck !== 0)) { goto PU7Yp; } goto oubxV; oubxV: $last_login = $this->session->userdata("\x6c\141\x73\164\137\x63\150\145\x63\x6b"); goto laVHf; sXR2L: $this->session->unset_userdata([$identity, "\x69\144", "\165\x73\x65\162\137\x69\x64"]); goto ocrXO; FaiuL: $this->session->set_userdata("\x6c\x61\x73\164\x5f\x63\150\x65\143\153", time()); goto HUBo4; kakdL: return (bool) $this->session->userdata("\151\x64\x65\156\x74\151\x74\171"); goto bDI81; ocrXO: return FALSE; goto SXLeQ; HUBo4: UYANS: goto muAOG; SXLeQ: goto UYANS; goto dB6js; NRwed: $query = $this->db->select("\151\x64")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\x6e\x74\x69\x74\x79"), "\x61\143\x74\x69\166\x65" => "\61"])->limit(1)->order_by("\x69\x64", "\x64\145\163\x63")->get($this->tables["\x75\163\x65\x72\x73"]); goto O7gSK; laVHf: if (!($last_login + $recheck < time())) { goto mJybk; } goto NRwed; BIKeM: PU7Yp: goto kakdL; rIPmE: $identity = $this->config->item("\151\144\x65\x6e\x74\x69\x74\x79", "\151\x6f\x6e\x5f\x61\165\164\x68"); goto sXR2L; bDI81: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto AoGgy; vBudh: return $attempts >= $max_attempts; goto WRQym; WRQym: jEQOM: goto fIYne; TydsE: if (!($max_attempts > 0)) { goto jEQOM; } goto kQ8RI; vhbpp: $max_attempts = $this->config->item("\155\141\170\x69\155\x75\155\x5f\x6c\157\x67\x69\156\137\x61\164\x74\145\x6d\x70\x74\x73", "\x69\x6f\x6e\137\141\165\164\x68"); goto TydsE; kQ8RI: $attempts = $this->get_attempts_num($identity, $ip_address); goto vBudh; fIYne: wv6Ow: goto AkIHJ; AoGgy: if (!$this->config->item("\x74\x72\x61\143\153\x5f\x6c\x6f\147\151\156\x5f\141\164\x74\x65\155\x70\x74\x73", "\x69\157\x6e\x5f\141\x75\164\x68")) { goto wv6Ow; } goto vhbpp; AkIHJ: return FALSE; goto pIOhA; pIOhA: } public function get_attempts_num($identity, $ip_address = NULL) { goto gpAoP; gpAoP: if (!$this->config->item("\x74\162\x61\143\x6b\137\x6c\157\147\x69\156\x5f\141\164\164\145\155\x70\164\163", "\x69\157\x6e\x5f\141\165\x74\x68")) { goto kRh5k; } goto F1xkR; P2Jst: iDcS_: goto Y0_1G; wmq34: $ip_address = $this->input->ip_address(); goto P2Jst; e8g11: $qres = $this->db->get($this->tables["\154\x6f\x67\x69\x6e\x5f\x61\164\x74\145\155\x70\x74\163"]); goto jVYEj; iIX6K: $this->db->where("\x74\x69\155\x65\x20\x3e", time() - $this->config->item("\154\x6f\x63\x6b\x6f\x75\164\137\x74\151\x6d\145", "\x69\157\156\137\x61\x75\x74\150"), FALSE); goto e8g11; buIQk: bXJvT: goto iIX6K; jVYEj: return $qres->num_rows(); goto q0aCl; Y0_1G: $this->db->where("\151\160\x5f\x61\x64\x64\x72\x65\x73\163", $ip_address); goto buIQk; XVW7p: return 0; goto RTKMZ; ZzHo5: if (isset($ip_address)) { goto iDcS_; } goto wmq34; q0aCl: kRh5k: goto XVW7p; Syl6l: if (!$this->config->item("\164\162\141\143\153\137\154\157\x67\x69\x6e\x5f\x69\160\137\x61\x64\x64\x72\145\x73\x73", "\x69\157\x6e\x5f\141\165\x74\150")) { goto bXJvT; } goto ZzHo5; umpr1: $this->db->where("\x6c\x6f\x67\x69\156", $identity); goto Syl6l; F1xkR: $this->db->select("\61", FALSE); goto umpr1; RTKMZ: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto xFJHR; wmAu4: ChYDe: goto jVoSM; me7Ve: E9Rt_: goto HDEY9; mXg4w: $qres = $this->db->get($this->tables["\154\x6f\147\151\x6e\x5f\141\x74\164\x65\155\160\x74\x73"], 1); goto Mipkl; f5XGB: return $qres->row()->time; goto xwzE7; xwzE7: DBpUN: goto wmAu4; jVoSM: return 0; goto Q1Zmd; SIXEg: $ip_address = $this->input->ip_address(); goto me7Ve; KkVSe: uxl8e: goto HVWyD; xFJHR: if (!$this->config->item("\164\162\141\x63\153\x5f\x6c\157\147\x69\156\x5f\x61\x74\x74\x65\x6d\160\164\x73", "\151\x6f\156\137\141\x75\164\x68")) { goto ChYDe; } goto NaMVM; HDEY9: $this->db->where("\151\160\137\x61\144\x64\x72\145\x73\x73", $ip_address); goto KkVSe; NaMVM: $this->db->select("\164\x69\155\x65"); goto c3X78; w5gsV: if (isset($ip_address)) { goto E9Rt_; } goto SIXEg; c3X78: $this->db->where("\154\157\147\151\156", $identity); goto cd7vA; cd7vA: if (!$this->config->item("\x74\162\x61\x63\x6b\137\x6c\x6f\x67\151\156\x5f\x69\160\137\141\144\144\162\x65\163\x73", "\x69\x6f\156\x5f\x61\165\x74\x68")) { goto uxl8e; } goto w5gsV; HVWyD: $this->db->order_by("\x69\144", "\x64\145\163\143"); goto mXg4w; Mipkl: if (!($qres->num_rows() > 0)) { goto DBpUN; } goto f5XGB; Q1Zmd: } public function get_last_attempt_ip($identity) { goto stItT; XuJjt: $qres = $this->db->get($this->tables["\154\x6f\x67\151\x6e\x5f\141\x74\x74\x65\155\160\x74\x73"], 1); goto hI9YT; Nkdl4: return $qres->row()->ip_address; goto CS1wv; CS1wv: RBrop: goto i5EdH; W4FuA: return ''; goto NmEsI; hI9YT: if (!($qres->num_rows() > 0)) { goto RBrop; } goto Nkdl4; rbs_f: $this->db->select("\151\x70\x5f\141\x64\x64\162\x65\163\x73"); goto qmQ9T; qmQ9T: $this->db->where("\x6c\157\x67\x69\156", $identity); goto pLR_u; stItT: if (!($this->config->item("\x74\162\141\143\x6b\137\154\157\x67\x69\156\137\141\164\164\145\155\x70\164\x73", "\x69\x6f\156\137\141\x75\164\150") && $this->config->item("\164\162\x61\143\153\137\154\157\147\x69\156\x5f\151\x70\137\x61\144\x64\162\x65\x73\163", "\151\157\156\x5f\141\x75\164\x68"))) { goto jkNou; } goto rbs_f; pLR_u: $this->db->order_by("\151\x64", "\144\145\163\143"); goto XuJjt; i5EdH: jkNou: goto W4FuA; NmEsI: } public function increase_login_attempts($identity) { goto MZbZY; S7hL6: eDgdS: goto evcG7; bqhSe: ILH6D: goto cmxJA; Jb0Ai: if (!$this->config->item("\x74\x72\x61\143\x6b\x5f\154\157\147\x69\156\x5f\151\x70\x5f\x61\x64\x64\162\145\163\163", "\x69\x6f\x6e\137\x61\165\x74\150")) { goto ILH6D; } goto ytPbZ; cmxJA: return $this->db->insert($this->tables["\x6c\x6f\x67\x69\156\x5f\141\164\164\x65\155\x70\164\163"], $data); goto S7hL6; MZbZY: if (!$this->config->item("\x74\x72\x61\143\153\x5f\x6c\157\147\151\x6e\137\x61\x74\x74\145\x6d\160\164\x73", "\151\x6f\x6e\x5f\141\x75\x74\150")) { goto eDgdS; } goto E5nU_; evcG7: return FALSE; goto bH3zE; ytPbZ: $data["\151\160\x5f\x61\144\x64\x72\145\x73\x73"] = $this->input->ip_address(); goto bqhSe; E5nU_: $data = ["\x69\x70\137\141\144\x64\x72\145\x73\163" => '', "\x6c\157\147\x69\156" => $identity, "\x74\x69\x6d\145" => time()]; goto Jb0Ai; bH3zE: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto e7Y1n; gP2tI: return FALSE; goto bwlbn; Qfm0z: $this->db->where("\x69\160\137\141\x64\x64\162\x65\x73\163", $ip_address); goto z24Dx; j2Vm3: $this->db->where("\154\x6f\x67\x69\156", $identity); goto itPNW; z24Dx: V1x1i: goto xVIOH; itPNW: if (!$this->config->item("\x74\162\x61\x63\x6b\x5f\154\x6f\147\151\x6e\137\x69\160\x5f\141\x64\x64\x72\x65\163\163", "\151\x6f\156\x5f\141\165\x74\x68")) { goto V1x1i; } goto i6JjS; hbC9I: x8fLP: goto gP2tI; gwU7F: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\143\x6b\x6f\x75\x74\x5f\164\x69\x6d\145", "\x69\157\x6e\x5f\141\x75\164\150")); goto j2Vm3; xVIOH: $this->db->or_where("\x74\x69\155\x65\x20\74", time() - $old_attempts_expire_period, FALSE); goto eLpqx; i6JjS: if (isset($ip_address)) { goto tiHxf; } goto QVrE7; QVrE7: $ip_address = $this->input->ip_address(); goto BqNvG; eLpqx: return $this->db->delete($this->tables["\154\x6f\147\x69\x6e\x5f\141\164\164\x65\x6d\160\x74\163"]); goto hbC9I; BqNvG: tiHxf: goto Qfm0z; e7Y1n: if (!$this->config->item("\x74\162\x61\x63\x6b\x5f\x6c\157\x67\151\x6e\137\x61\x74\x74\145\x6d\160\164\163", "\151\x6f\x6e\x5f\141\x75\164\150")) { goto x8fLP; } goto gwU7F; bwlbn: } public function limit($limit) { goto IBf2M; fpBsN: return $this; goto p0LgE; hOeaE: $this->_ion_limit = $limit; goto fpBsN; IBf2M: $this->trigger_events("\x6c\151\155\151\x74"); goto hOeaE; p0LgE: } public function offset($offset) { goto JJqGe; V5P2C: $this->_ion_offset = $offset; goto IV1TJ; JJqGe: $this->trigger_events("\157\x66\x66\163\x65\164"); goto V5P2C; IV1TJ: return $this; goto l0uCZ; l0uCZ: } public function where($where, $value = NULL) { goto GlTJm; A3sso: $where = [$where => $value]; goto RGQv7; GlTJm: $this->trigger_events("\167\150\145\162\x65"); goto hITVI; xy3GH: array_push($this->_ion_where, $where); goto sKSCY; RGQv7: tAaJ3: goto xy3GH; hITVI: if (is_array($where)) { goto tAaJ3; } goto A3sso; sKSCY: return $this; goto R0QXz; R0QXz: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\150") { goto dn5Oo; fBn12: array_push($this->_ion_like, ["\x6c\151\x6b\x65" => $like, "\166\141\x6c\x75\145" => $value, "\x70\x6f\163\151\164\151\157\156" => $position]); goto xY7eW; xY7eW: return $this; goto KVC_k; dn5Oo: $this->trigger_events("\x6c\x69\x6b\x65"); goto fBn12; KVC_k: } public function select($select) { goto VmEjl; VmEjl: $this->trigger_events("\x73\145\x6c\x65\x63\164"); goto KtH3p; LKY3x: return $this; goto UCE9J; KtH3p: $this->_ion_select[] = $select; goto LKY3x; UCE9J: } public function order_by($by, $order = "\x64\x65\x73\143") { goto GHbGP; EaKzq: return $this; goto etix2; GHbGP: $this->trigger_events("\x6f\162\144\x65\162\x5f\142\x79"); goto FcOZI; FcOZI: $this->_ion_order_by = $by; goto UOkcE; UOkcE: $this->_ion_order = $order; goto EaKzq; etix2: } public function row() { goto NTJf4; lJTw1: return $row; goto HaGqD; NTJf4: $this->trigger_events("\x72\x6f\x77"); goto xeGsO; xeGsO: $row = $this->response->row(); goto lJTw1; HaGqD: } public function row_array() { goto Ih9YX; TllVy: return $row; goto xtiuM; dz0Kb: $row = $this->response->row_array(); goto TllVy; Ih9YX: $this->trigger_events(["\x72\157\x77", "\x72\157\167\x5f\x61\162\x72\141\171"]); goto dz0Kb; xtiuM: } public function result() { goto qgN3u; ps3Tf: $result = $this->response->result(); goto Tefxd; qgN3u: $this->trigger_events("\x72\x65\163\165\154\164"); goto ps3Tf; Tefxd: return $result; goto Zluff; Zluff: } public function result_array() { goto KGydT; CU5Va: return $result; goto BMAkz; HvmUn: $result = $this->response->result_array(); goto CU5Va; KGydT: $this->trigger_events(["\x72\x65\x73\x75\x6c\x74", "\x72\x65\x73\165\154\164\137\141\x72\162\141\x79"]); goto HvmUn; BMAkz: } public function num_rows() { goto cgd4m; HUk0T: return $result; goto QeHXH; cgd4m: $this->trigger_events(["\156\x75\x6d\x5f\162\157\x77\163"]); goto KsWFc; KsWFc: $result = $this->response->num_rows(); goto HUk0T; QeHXH: } public function users($groups = NULL) { goto FjiKJ; Em3Zi: EhkXj: goto mWvG3; t4NCk: $this->_ion_order = NULL; goto K1CWW; AmPai: $this->response = $this->db->get($this->tables["\x75\163\x65\x72\x73"]); goto tmfwg; IkHIG: NSO0P: goto AmPai; BVGhO: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto lz55u; } goto jZViw; F84A_: $this->db->{$or_where_in}($this->tables["\165\163\x65\162\163\137\147\162\x6f\x75\160\x73"] . "\x2e" . $this->join["\147\x72\x6f\165\x70\163"], $group_ids); goto Em3Zi; aCNlF: $this->_ion_limit = NULL; goto mrzDv; mWvG3: Tpxam: goto b7io9; Y5_8C: if (is_array($groups)) { goto CvcJ4; } goto bu_Yd; S58se: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto LjXEj; } goto ItVX9; uzkKX: foreach ($groups as $group) { goto UgQzm; YHbH0: cG1kK: goto yWibr; V3jMG: Bk0pv: goto HyKRo; yWibr: iVIbI: goto AQCDS; HyKRo: $group_ids[] = $group; goto YHbH0; j1iST: $group_names[] = $group; goto dFK9u; UgQzm: if (is_numeric($group)) { goto Bk0pv; } goto j1iST; dFK9u: goto cG1kK; goto V3jMG; AQCDS: } goto ozkyU; ttqkW: lPN8s: goto aYIaR; FA0sH: $group_names = []; goto uzkKX; fw6rV: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto t4NCk; bu_Yd: $groups = [$groups]; goto p6m1e; PsaJG: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\137\x77\x68\x65\x72\x65\x5f\x69\156" : "\x77\150\145\x72\x65\137\x69\x6e"; goto Bl3oQ; oIHzC: $this->_ion_limit = NULL; goto iLD8Q; Oq1Xm: foreach ($this->_ion_where as $where) { $this->db->where($where); B4FLA: } goto nN7Mj; jZViw: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\153\145"], $like["\x76\x61\154\x75\145"], $like["\x70\x6f\163\x69\x74\x69\157\156"]); bEKEk: } goto ttqkW; wmnna: $this->db->where_in($this->tables["\147\x72\157\165\x70\163"] . "\x2e\156\x61\155\145", $group_names); goto QOEnQ; o5biL: $this->db->limit($this->_ion_limit); goto oIHzC; Qcpvu: JF5L_: goto Ob0_1; dzGM9: if (!(isset($groups) && !empty($groups))) { goto JF5L_; } goto BPKfZ; Ob0_1: $group_ids = []; goto FA0sH; fj65t: foreach ($this->_ion_select as $select) { $this->db->select($select); TdCwS: } goto QWVxr; QG58E: goto sET4r; goto w_0j9; Jwc1H: sET4r: goto YrCL0; ozkyU: HJ5hK: goto PsaJG; RG8O7: e4wGu: goto BVGhO; BPKfZ: $this->db->distinct(); goto PrOlT; HdI3L: $this->_ion_where = []; goto RG8O7; tmfwg: return $this; goto F8KJu; d0271: LjXEj: goto fj65t; ZUvQ2: goto Y93nV; goto d0271; iLD8Q: SWbKq: goto QG58E; b7io9: $this->trigger_events("\x65\x78\164\x72\x61\x5f\167\x68\x65\162\145"); goto ULtLB; nN7Mj: toJLW: goto HdI3L; p6m1e: CvcJ4: goto dzGM9; YrCL0: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto NSO0P; } goto fw6rV; NnubU: if (empty($group_ids)) { goto EhkXj; } goto F84A_; LTkrH: if (!isset($this->_ion_limit)) { goto SWbKq; } goto o5biL; QWVxr: WA16k: goto o_AQ3; QOEnQ: TrarV: goto NnubU; PrOlT: $this->db->join($this->tables["\165\x73\145\162\x73\x5f\147\162\157\165\x70\163"], $this->tables["\165\x73\145\162\163\137\147\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\165\x73\x65\162\163"] . "\75" . $this->tables["\x75\163\x65\162\x73"] . "\56\x69\144", "\151\x6e\156\145\x72"); goto Qcpvu; CO6gf: Y93nV: goto WGmK1; w_0j9: z6GsK: goto dXcaN; zXdpp: $this->db->join($this->tables["\x67\x72\x6f\165\160\163"], $this->tables["\165\x73\x65\x72\x73\x5f\147\x72\x6f\165\x70\x73"] . "\x2e" . $this->join["\147\162\x6f\x75\x70\163"] . "\x20\75\40" . $this->tables["\147\162\157\x75\160\163"] . "\56\x69\x64", "\x69\156\x6e\x65\x72"); goto wmnna; g14Lu: lz55u: goto euZ5J; K1CWW: $this->_ion_order_by = NULL; goto IkHIG; euZ5J: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto z6GsK; } goto LTkrH; ULtLB: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto e4wGu; } goto Oq1Xm; Bl3oQ: if (empty($group_names)) { goto TrarV; } goto zXdpp; o_AQ3: $this->_ion_select = []; goto CO6gf; dXcaN: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto aCNlF; aYIaR: $this->_ion_like = []; goto g14Lu; WGmK1: if (!isset($groups)) { goto Tpxam; } goto Y5_8C; FjiKJ: $this->trigger_events("\x75\x73\145\162\163"); goto S58se; mrzDv: $this->_ion_offset = NULL; goto Jwc1H; ItVX9: $this->db->select([$this->tables["\165\163\145\x72\x73"] . "\x2e\52", $this->tables["\165\x73\145\x72\x73"] . "\x2e\x69\144\x20\141\x73\40\151\144", $this->tables["\165\x73\x65\x72\x73"] . "\x2e\151\144\40\141\x73\40\165\163\x65\x72\137\151\x64"]); goto ZUvQ2; F8KJu: } public function user($id = NULL) { goto gIGz8; JG5VC: $this->limit(1); goto QlR63; VOJR7: return $this; goto xNlrh; CEf79: $this->users(); goto VOJR7; LupcG: $this->where($this->tables["\x75\163\x65\162\163"] . "\56\x69\x64", $id); goto CEf79; v0O8F: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\x65\x72\137\x69\x64"); goto JG5VC; QlR63: $this->order_by($this->tables["\165\x73\x65\x72\163"] . "\56\x69\144", "\144\x65\163\143"); goto LupcG; gIGz8: $this->trigger_events("\165\x73\145\x72"); goto v0O8F; xNlrh: } public function get_users_groups($id = FALSE) { goto TNAAR; TNAAR: $this->trigger_events("\x67\x65\164\x5f\165\x73\145\162\163\x5f\x67\162\157\165\160"); goto oclqg; qmYFt: return $this->db->select($this->tables["\x75\163\145\162\163\137\147\x72\157\165\160\x73"] . "\x2e" . $this->join["\147\162\157\x75\x70\163"] . "\40\141\163\40\151\x64\x2c\x20" . $this->tables["\x67\162\157\165\160\163"] . "\56\156\141\x6d\145\54\x20" . $this->tables["\147\162\x6f\165\x70\x73"] . "\x2e\144\145\163\143\x72\151\160\164\151\x6f\156")->where($this->tables["\165\x73\145\162\x73\x5f\x67\162\157\165\160\x73"] . "\56" . $this->join["\x75\x73\x65\162\163"], $id)->join($this->tables["\147\162\157\165\160\163"], $this->tables["\165\x73\145\x72\x73\137\x67\x72\x6f\x75\x70\x73"] . "\56" . $this->join["\x67\x72\x6f\x75\x70\x73"] . "\75" . $this->tables["\147\162\x6f\165\x70\163"] . "\x2e\x69\x64")->get($this->tables["\165\x73\x65\162\163\137\147\x72\157\165\160\163"]); goto C_Fqq; oclqg: $id || ($id = $this->session->userdata("\x75\163\145\162\x5f\151\144")); goto qmYFt; C_Fqq: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto lAB48; URrVd: mwd3h: goto gTxhh; k9eI1: if (is_array($check_group)) { goto AaEhG; } goto LsTKr; LI33W: $id || ($id = $this->session->userdata("\165\163\x65\162\x5f\151\144")); goto k9eI1; H03sf: goto abguo; goto URrVd; L2pUv: abguo: goto g43BC; u8hLg: $this->_cache_user_in_group[$id] = $groups_array; goto H03sf; HL2Qb: ULFNJ: goto rN0a6; Y_19_: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; L4TjA: } goto QB2f2; LsTKr: $check_group = [$check_group]; goto lKcFI; lKcFI: AaEhG: goto GAaOQ; g43BC: foreach ($check_group as $key => $value) { goto ZLXqF; Mb3tj: rOS9g: goto Wq8eT; ZLXqF: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto guzE_; sugJ6: return !$check_all; goto JwSxc; JwSxc: tbteX: goto Mb3tj; guzE_: if (!(in_array($value, $groups) xor $check_all)) { goto tbteX; } goto sugJ6; Wq8eT: } goto HL2Qb; rN0a6: return $check_all; goto XkrR6; i9_lD: $users_groups = $this->get_users_groups($id)->result(); goto iPY0L; lAB48: $this->trigger_events("\x69\156\x5f\147\162\x6f\x75\160"); goto LI33W; GAaOQ: if (isset($this->_cache_user_in_group[$id])) { goto mwd3h; } goto i9_lD; iPY0L: $groups_array = []; goto Y_19_; QB2f2: kOdIM: goto u8hLg; gTxhh: $groups_array = $this->_cache_user_in_group[$id]; goto L2pUv; XkrR6: } public function add_to_group($group_ids, $user_id = FALSE) { goto GYPR3; N7dV2: if (is_array($group_ids)) { goto Dm3Nj; } goto kcwnu; jV1BE: Dm3Nj: goto xjyCQ; xjyCQ: $return = 0; goto Cu97S; pAXvK: Zwnqr: goto rnjeI; kcwnu: $group_ids = [$group_ids]; goto jV1BE; KK2ho: $user_id || ($user_id = $this->session->userdata("\x75\x73\x65\x72\x5f\x69\x64")); goto N7dV2; rnjeI: return $return; goto eZguF; GYPR3: $this->trigger_events("\141\144\144\x5f\164\157\137\x67\x72\157\x75\x70"); goto KK2ho; Cu97S: foreach ($group_ids as $group_id) { goto ANEXE; GRZDM: INk0v: goto gnycz; h8EgE: $group_name = $group[0]->name; goto nILn8; REORy: if (isset($this->_cache_groups[$group_id])) { goto xQGSa; } goto prMsa; bNXub: $return++; goto FRtrt; P5C4C: ZlmQa: goto pgnJb; ANEXE: if (!$this->db->insert($this->tables["\165\x73\x65\x72\163\137\x67\162\157\x75\160\x73"], [$this->join["\147\x72\157\165\160\163"] => (float) $group_id, $this->join["\165\163\x65\162\163"] => (float) $user_id])) { goto VA6Jy; } goto REORy; vyiIP: xQGSa: goto qidTt; nILn8: $this->_cache_groups[$group_id] = $group_name; goto NnPmJ; gnycz: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto bNXub; NnPmJ: goto INk0v; goto vyiIP; qidTt: $group_name = $this->_cache_groups[$group_id]; goto GRZDM; prMsa: $group = $this->group($group_id)->result(); goto h8EgE; FRtrt: VA6Jy: goto P5C4C; pgnJb: } goto pAXvK; eZguF: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto cZpum; qjIhN: rfhZm: goto zFroV; h4tUc: if (!empty($user_id)) { goto HemKX; } goto YyG4B; LVjZI: C2yyE: goto enkcv; JKT1m: $return = TRUE; goto YK574; ig3S7: $group_ids = [$group_ids]; goto qjIhN; ERCXB: nyCOd: goto JKT1m; enkcv: if (is_array($group_ids)) { goto rfhZm; } goto ig3S7; iwks4: if (!($return = $this->db->delete($this->tables["\x75\x73\x65\x72\x73\137\x67\x72\157\165\x70\163"], [$this->join["\x75\x73\x65\x72\x73"] => (float) $user_id]))) { goto Lkgp5; } goto GmNQs; zFroV: foreach ($group_ids as $group_id) { goto UFBwT; Uf3cA: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto Z7tJ4; } goto LZq_S; azNLh: Z7tJ4: goto gKXXc; UFBwT: $this->db->delete($this->tables["\165\x73\x65\x72\163\x5f\147\162\157\165\160\163"], [$this->join["\147\x72\x6f\165\160\163"] => (float) $group_id, $this->join["\165\163\x65\162\163"] => (float) $user_id]); goto Uf3cA; gKXXc: Y1cYt: goto sFmj6; LZq_S: unset($this->_cache_user_in_group[$user_id][$group_id]); goto azNLh; sFmj6: } goto ERCXB; bXebg: HemKX: goto CEKXw; GmNQs: $this->_cache_user_in_group[$user_id] = []; goto Dx66Z; YK574: IW661: goto vz6I7; BHRJw: goto IW661; goto LVjZI; vz6I7: return $return; goto cSdbc; CEKXw: if (!empty($group_ids)) { goto C2yyE; } goto iwks4; YyG4B: return FALSE; goto bXebg; cZpum: $this->trigger_events("\x72\145\x6d\x6f\166\145\137\146\162\157\x6d\137\147\162\x6f\165\160"); goto h4tUc; Dx66Z: Lkgp5: goto BHRJw; cSdbc: } public function groups() { goto jhBnh; fvqA8: $this->response = $this->db->get($this->tables["\x67\162\157\165\160\163"]); goto MATcW; MATcW: return $this; goto srAxI; sSbSr: Cnuvv: goto ejYc6; jhBnh: $this->trigger_events("\x67\x72\x6f\165\160\163"); goto zIZvN; o9sHv: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto nPd6v; } goto z7b_c; yabYJ: t6k7d: goto vZrVT; bCm_1: foreach ($this->_ion_where as $where) { $this->db->where($where); a6JxC: } goto SpJ4o; zs8hf: AzI4V: goto o9sHv; z7b_c: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto k4sEe; lO3sg: $this->_ion_offset = NULL; goto zs8hf; YJ9sV: $this->_ion_where = []; goto IKYN7; ejYc6: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto OKy_H; zIZvN: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto QJ4jG; } goto bCm_1; OKy_H: $this->_ion_limit = NULL; goto lO3sg; Sxuee: $this->_ion_limit = NULL; goto yabYJ; k4sEe: nPd6v: goto fvqA8; SpJ4o: YWUr9: goto YJ9sV; U88Sn: $this->db->limit($this->_ion_limit); goto Sxuee; SM2ig: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto Cnuvv; } goto aYprm; IKYN7: QJ4jG: goto SM2ig; vZrVT: goto AzI4V; goto sSbSr; aYprm: if (!isset($this->_ion_limit)) { goto t6k7d; } goto U88Sn; srAxI: } public function group($id = NULL) { goto LaTfF; Syx_9: DN91p: goto xSOXI; Ev3lx: $this->order_by("\151\144", "\x64\145\x73\143"); goto YG1JO; YG1JO: return $this->groups(); goto JjX1W; LaTfF: $this->trigger_events("\x67\x72\x6f\165\x70"); goto HZ2Oc; yMVo9: $this->where($this->tables["\147\x72\157\x75\160\x73"] . "\56\x69\144", $id); goto Syx_9; xSOXI: $this->limit(1); goto Ev3lx; HZ2Oc: if (!isset($id)) { goto DN91p; } goto yMVo9; JjX1W: } public function update($id, array $data) { goto DVwVP; caNzY: if (!($this->db->trans_status() === FALSE)) { goto lt8AF; } goto Vdxxh; bQnft: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto n1hRx; } goto f2GqD; eWf_R: $this->set_error("\165\x70\x64\141\164\x65\x5f\x75\156\163\x75\x63\143\x65\163\163\x66\x75\x6c"); goto OX7h0; zv8sN: $this->set_error("\165\160\x64\141\x74\x65\x5f\x75\x6e\163\165\x63\143\x65\163\x73\x66\165\154"); goto ezjf3; tB0cC: $this->db->trans_rollback(); goto ltA9Z; rdZSE: $this->trigger_events(["\160\157\163\164\137\165\x70\144\x61\x74\x65\137\165\163\x65\x72", "\x70\x6f\163\164\137\165\x70\x64\x61\164\x65\x5f\165\163\x65\162\x5f\163\165\x63\x63\145\163\x73\x66\x75\154"]); goto x2lAV; ltA9Z: $this->trigger_events(["\160\x6f\163\164\x5f\x75\160\x64\x61\x74\x65\137\x75\163\x65\162", "\x70\x6f\163\x74\x5f\165\160\144\x61\164\145\137\x75\x73\x65\162\137\x75\156\163\165\143\143\x65\163\163\x66\x75\154"]); goto XYPwA; uQt6g: return TRUE; goto knJfP; rfKn_: QRcdo: goto bmU_I; pqI1I: n1hRx: goto vj_cS; Gx4z0: lt8AF: goto lbh8w; MAS7h: $data["\x70\141\x73\163\x77\157\x72\144"] = $this->hash_password($data["\160\x61\x73\163\167\157\162\x64"], $user->{$this->identity_column}); goto aHizI; aHizI: if (!($data["\x70\141\163\x73\167\x6f\162\x64"] === FALSE)) { goto lxXsf; } goto tB0cC; AZ_Ba: $this->trigger_events(["\x70\157\x73\x74\137\165\160\x64\141\x74\x65\137\165\x73\x65\162", "\160\157\x73\x74\137\165\160\144\x61\164\x65\x5f\x75\163\145\x72\x5f\x75\x6e\x73\x75\143\143\145\163\x73\146\x75\x6c"]); goto eWf_R; bmU_I: $this->trigger_events("\145\170\164\162\x61\137\167\150\145\x72\145"); goto J8RG6; f2GqD: $this->db->trans_rollback(); goto Jqmbu; x2lAV: $this->set_message("\x75\160\x64\141\x74\145\137\x73\x75\143\143\145\x73\x73\x66\x75\x6c"); goto uQt6g; XYPwA: $this->set_error("\165\x70\144\x61\x74\145\137\x75\156\163\x75\x63\x63\145\x73\163\x66\x75\154"); goto BnI93; J6QjE: srAiN: goto MAS7h; sutUE: $this->trigger_events(["\160\157\163\x74\137\x75\160\144\141\164\145\137\165\163\x65\162", "\160\157\163\x74\x5f\x75\x70\x64\x61\x74\x65\137\x75\163\x65\162\x5f\165\x6e\163\165\x63\x63\x65\163\163\x66\x75\154"]); goto zv8sN; c0tmL: $this->db->trans_begin(); goto bQnft; ezjf3: return FALSE; goto Gx4z0; DVwVP: $this->trigger_events("\160\x72\x65\137\x75\x70\x64\x61\x74\145\x5f\x75\163\145\162"); goto WK9St; UdytT: lxXsf: goto l33Ck; vj_cS: $data = $this->_filter_data($this->tables["\x75\163\145\x72\x73"], $data); goto t4l1B; l33Ck: q7Tio: goto FycRx; FycRx: b0eLO: goto rfKn_; Jqmbu: $this->set_error("\141\143\x63\x6f\165\x6e\164\x5f\143\162\x65\x61\x74\151\157\x6e\137\144\x75\x70\154\151\143\x61\164\145\137\x69\x64\145\x6e\x74\151\164\x79"); goto AZ_Ba; M1bBn: if (!array_key_exists("\x70\141\x73\x73\x77\157\x72\x64", $data)) { goto b0eLO; } goto CdsLw; J8RG6: $this->db->update($this->tables["\165\x73\145\x72\163"], $data, ["\x69\x64" => $user->id]); goto caNzY; Vdxxh: $this->db->trans_rollback(); goto sutUE; lbh8w: $this->db->trans_commit(); goto rdZSE; WK9St: $user = $this->user($id)->row(); goto c0tmL; CdsLw: if (!empty($data["\160\x61\163\x73\x77\157\x72\144"])) { goto srAiN; } goto HNP9s; t4l1B: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\x73\163\x77\157\x72\x64", $data) || array_key_exists("\x65\155\141\151\x6c", $data))) { goto QRcdo; } goto M1bBn; OX7h0: return FALSE; goto pqI1I; HNP9s: unset($data["\x70\x61\x73\163\x77\x6f\x72\x64"]); goto hCK9p; hCK9p: goto q7Tio; goto J6QjE; BnI93: return FALSE; goto UdytT; knJfP: } public function delete_user($id) { goto cnTCe; cnTCe: $this->trigger_events("\160\162\x65\x5f\x64\x65\x6c\145\x74\x65\x5f\165\x73\x65\162"); goto P9qxa; LBpDO: $this->trigger_events(["\160\x6f\163\164\137\x64\145\x6c\145\164\145\x5f\x75\163\x65\162", "\x70\157\163\x74\x5f\x64\x65\x6c\x65\164\x65\137\165\163\x65\162\x5f\x73\165\x63\x63\145\163\x73\146\165\154"]); goto nJlRE; P9qxa: $this->db->trans_begin(); goto LV3jp; fXf8y: $this->db->delete($this->tables["\165\x73\x65\x72\x73"], ["\151\144" => $id]); goto N0FNJ; q9YZl: poRaY: goto xCs2M; CfYTp: $this->db->trans_rollback(); goto G7jjS; LV3jp: $this->remove_from_group(NULL, $id); goto fXf8y; G7jjS: $this->trigger_events(["\160\x6f\163\164\137\144\145\x6c\145\x74\x65\137\x75\x73\145\x72", "\160\x6f\163\164\137\144\145\154\145\x74\x65\137\165\163\x65\162\137\165\x6e\x73\x75\x63\143\x65\163\163\146\x75\154"]); goto pwV40; N0FNJ: if (!($this->db->trans_status() === FALSE)) { goto poRaY; } goto CfYTp; fZG7r: return FALSE; goto q9YZl; nJlRE: $this->set_message("\144\145\x6c\145\x74\145\x5f\163\x75\x63\x63\145\x73\x73\x66\x75\154"); goto Zhb2y; Zhb2y: return TRUE; goto yXeyg; xCs2M: $this->db->trans_commit(); goto LBpDO; pwV40: $this->set_error("\144\x65\x6c\145\x74\145\137\165\x6e\163\165\143\143\x65\x73\163\x66\165\154"); goto fZG7r; yXeyg: } public function update_last_login($id) { goto DF8qu; jpFF5: $this->load->helper("\x64\x61\x74\x65"); goto ZC3iC; UFtrT: $this->db->update($this->tables["\165\163\145\162\x73"], ["\154\x61\x73\x74\137\154\x6f\x67\151\x6e" => time()], ["\151\144" => $id]); goto t0WZC; DF8qu: $this->trigger_events("\x75\x70\144\141\x74\x65\x5f\154\141\x73\164\137\154\157\147\x69\x6e"); goto jpFF5; ZC3iC: $this->trigger_events("\x65\170\x74\162\141\x5f\x77\x68\145\162\145"); goto UFtrT; t0WZC: return $this->db->affected_rows() == 1; goto q_qhw; q_qhw: } public function set_lang($lang = "\x65\x6e") { goto gAWYu; Ubr1y: if ($this->config->item("\165\163\145\162\137\x65\x78\x70\151\x72\x65", "\151\157\x6e\x5f\141\x75\x74\x68") === 0) { goto V2cD1; } goto bUMKB; U50es: return TRUE; goto xvHCm; g6nL4: jbhAy: goto sP_tz; sP_tz: set_cookie(["\156\x61\x6d\x65" => "\x6c\141\x6e\147\137\x63\157\x64\145", "\166\141\x6c\165\x65" => $lang, "\x65\x78\160\x69\x72\x65" => $expire]); goto U50es; FAluF: V2cD1: goto GRVLB; GRVLB: $expire = self::MAX_COOKIE_LIFETIME; goto g6nL4; bUMKB: $expire = $this->config->item("\165\x73\x65\162\x5f\x65\170\x70\151\x72\145", "\151\x6f\156\137\141\165\x74\150"); goto VGfbM; gAWYu: $this->trigger_events("\x73\145\164\x5f\154\x61\156\147"); goto Ubr1y; VGfbM: goto jbhAy; goto FAluF; xvHCm: } public function set_session($user) { goto KhPdl; QjFKF: return TRUE; goto RN0mq; E8Ps3: $this->session->set_userdata($session_data); goto ANhgD; ANhgD: $this->trigger_events("\x70\157\163\164\x5f\163\x65\164\x5f\x73\x65\x73\163\x69\x6f\x6e"); goto QjFKF; ATrYC: $session_data = ["\151\144\145\156\164\x69\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\151\154" => $user->email, "\165\163\x65\162\137\151\x64" => $user->id, "\x6f\154\x64\x5f\x6c\141\163\164\x5f\154\x6f\147\151\156" => $user->last_login, "\x6c\141\163\x74\x5f\x63\x68\145\143\153" => time()]; goto E8Ps3; KhPdl: $this->trigger_events("\x70\162\145\137\x73\x65\164\x5f\x73\x65\163\163\151\x6f\156"); goto ATrYC; RN0mq: } public function remember_user($identity) { goto JkhRV; JwOJh: goto pxkmy; goto G5H9s; CLE7N: dxJff: goto q9jg9; fhwLo: $this->trigger_events(["\160\x6f\163\164\x5f\x72\145\155\x65\155\142\x65\x72\x5f\165\163\x65\x72", "\162\x65\155\145\x6d\x62\x65\162\137\x75\x73\x65\162\137\163\165\x63\x63\x65\163\163\x66\165\154"]); goto W3Zq1; U9ieM: $expire = self::MAX_COOKIE_LIFETIME; goto NgKx8; NgKx8: pxkmy: goto gbRjf; G5H9s: SLjDj: goto U9ieM; hFhKK: $this->db->update($this->tables["\x75\163\145\162\163"], ["\162\x65\x6d\145\155\x62\x65\162\137\163\145\x6c\x65\x63\164\157\162" => $token->selector, "\x72\x65\x6d\145\155\x62\145\162\137\143\x6f\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto rCUym; ejXjk: return FALSE; goto cDAjC; FwoDP: return FALSE; goto UbXLW; gbRjf: set_cookie(["\x6e\x61\155\145" => $this->config->item("\162\x65\155\x65\x6d\x62\x65\162\x5f\143\157\x6f\153\x69\x65\137\156\141\x6d\x65", "\x69\157\x6e\x5f\x61\x75\164\150"), "\166\x61\x6c\165\x65" => $token->user_code, "\145\x78\x70\x69\x72\145" => $expire]); goto fhwLo; cDAjC: VeTlN: goto U9AQk; rCUym: if (!($this->db->affected_rows() > -1)) { goto dxJff; } goto Knjvy; kOpnj: if ($identity) { goto VeTlN; } goto ejXjk; JkhRV: $this->trigger_events("\160\x72\145\137\x72\x65\155\145\x6d\x62\x65\162\x5f\x75\163\145\x72"); goto kOpnj; Knjvy: if ($this->config->item("\x75\163\145\162\137\145\x78\x70\x69\162\x65", "\x69\157\156\x5f\141\x75\x74\150") === 0) { goto SLjDj; } goto FFIMi; W3Zq1: return TRUE; goto CLE7N; U9AQk: $token = $this->_generate_selector_validator_couple(); goto MsAEu; q9jg9: gRLaT: goto PooA3; FFIMi: $expire = $this->config->item("\165\x73\x65\x72\x5f\x65\x78\160\151\x72\x65", "\151\157\x6e\x5f\x61\x75\x74\x68"); goto JwOJh; MsAEu: if (!$token->validator_hashed) { goto gRLaT; } goto hFhKK; PooA3: $this->trigger_events(["\160\157\163\164\x5f\x72\145\x6d\145\155\142\x65\162\x5f\165\x73\145\162", "\162\145\155\145\155\142\x65\162\x5f\165\163\145\162\137\165\x6e\163\x75\x63\143\x65\163\x73\x66\x75\154"]); goto FwoDP; UbXLW: } public function login_remembered_user() { goto LZg8r; CoQS3: return FALSE; goto cfTwW; E8gI1: if (!($token === FALSE)) { goto IfXuJ; } goto g8LH1; W8vrx: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto E8gI1; SMEft: $this->clear_forgotten_password_code($identity); goto zUbBh; YTend: MXJE0: goto XgiER; BzRq0: delete_cookie($this->config->item("\162\145\155\145\x6d\x62\x65\162\137\143\157\x6f\x6b\x69\x65\137\156\x61\155\x65", "\x69\x6f\x6e\137\x61\165\164\x68")); goto LTdOw; FiRRg: $query = $this->db->select($this->identity_column . "\54\40\151\144\54\40\x65\155\141\151\154\x2c\x20\162\145\x6d\145\155\142\145\x72\x5f\143\157\x64\x65\54\x20\x6c\x61\163\164\137\x6c\157\x67\151\156")->where("\162\145\x6d\x65\155\x62\145\x72\x5f\163\x65\x6c\145\x63\164\x6f\162", $token->selector)->where("\141\143\164\x69\x76\145", 1)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto OaH6t; vw7d7: $this->update_last_login($user->id); goto dpWmX; LZg8r: $this->trigger_events("\x70\162\x65\x5f\x6c\x6f\147\x69\x6e\137\x72\145\x6d\145\155\142\x65\x72\145\x64\137\x75\163\x65\162"); goto gvZqX; dpWmX: $this->set_session($user); goto SMEft; OaH6t: if (!($query->num_rows() === 1)) { goto VzDT9; } goto DWOQp; g8LH1: $this->trigger_events(["\x70\157\x73\164\137\x6c\157\x67\x69\x6e\x5f\x72\145\155\x65\155\x62\x65\x72\145\144\x5f\x75\x73\x65\x72", "\x70\x6f\x73\x74\137\154\x6f\147\151\156\x5f\162\x65\155\145\155\x62\x65\x72\x65\x64\x5f\x75\163\x65\162\137\165\x6e\163\x75\143\x63\x65\x73\x73\146\165\x6c"]); goto CoQS3; YN_4M: $identity = $user->{$this->identity_column}; goto jLrkB; XgiER: $this->session->sess_regenerate(FALSE); goto ApJM5; aHAdV: QHQIc: goto gQ8Qg; DWOQp: $user = $query->row(); goto YN_4M; gTN1J: return TRUE; goto aHAdV; jLrkB: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto QHQIc; } goto vw7d7; gvZqX: $remember_cookie = get_cookie($this->config->item("\x72\145\155\145\155\x62\x65\x72\137\143\157\157\x6b\151\x65\x5f\156\x61\155\x65", "\151\157\156\x5f\141\x75\x74\150")); goto W8vrx; K63HY: return FALSE; goto u94VV; Ob3De: $this->trigger_events("\x65\170\164\162\x61\x5f\167\x68\145\x72\x65"); goto FiRRg; gQ8Qg: VzDT9: goto BzRq0; zUbBh: if (!$this->config->item("\x75\x73\x65\x72\x5f\x65\170\164\145\156\x64\137\157\156\x5f\154\x6f\x67\x69\x6e", "\x69\x6f\156\137\x61\x75\x74\x68")) { goto MXJE0; } goto nRCXa; ApJM5: $this->trigger_events(["\160\157\x73\x74\137\154\157\x67\151\156\x5f\162\x65\x6d\x65\x6d\x62\145\162\x65\144\x5f\165\163\145\162", "\160\157\163\164\x5f\154\157\147\x69\x6e\x5f\x72\145\155\x65\x6d\x62\145\162\145\144\137\x75\163\x65\162\137\163\x75\143\143\145\163\x73\x66\x75\x6c"]); goto gTN1J; nRCXa: $this->remember_user($identity); goto YTend; cfTwW: IfXuJ: goto Ob3De; LTdOw: $this->trigger_events(["\160\x6f\163\164\137\x6c\x6f\x67\x69\x6e\137\x72\145\155\x65\x6d\x62\145\162\x65\x64\x5f\165\163\145\x72", "\160\157\163\164\137\154\157\x67\x69\156\x5f\162\145\155\145\x6d\x62\x65\x72\x65\144\137\165\x73\145\x72\x5f\165\x6e\x73\x75\x63\x63\x65\163\163\146\x75\154"]); goto K63HY; u94VV: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto lX5fM; DS7SU: Phw5y: goto EXn7c; xRuLD: $this->set_error("\x67\x72\157\165\x70\x5f\141\154\162\x65\x61\x64\171\137\x65\x78\151\163\164\x73"); goto Rq24f; rxgom: $group_id = $this->db->insert_id($this->tables["\x67\x72\157\x75\160\x73"] . "\137\x69\x64\137\x73\x65\161"); goto Y5d5H; hBihQ: $this->set_error("\x67\x72\157\165\160\x5f\x6e\141\155\x65\137\162\145\161\x75\x69\162\x65\x64"); goto d7fNj; a514r: jrHzb: goto Ztpm9; hgqMj: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\x70\x73"], $additional_data), $data); goto a514r; lX5fM: if ($group_name) { goto SeRyN; } goto hBihQ; Rq24f: return FALSE; goto DS7SU; Ztpm9: $this->trigger_events("\145\x78\164\x72\141\x5f\147\x72\157\x75\x70\137\163\x65\x74"); goto EZ3lL; EZ3lL: $this->db->insert($this->tables["\x67\162\157\165\x70\163"], $data); goto rxgom; awbqz: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\165\160\163"], ["\x6e\x61\x6d\x65" => $group_name])->num_rows(); goto WX_f7; d7fNj: return FALSE; goto VqJ1P; WX_f7: if (!($existing_group !== 0)) { goto Phw5y; } goto xRuLD; VqJ1P: SeRyN: goto awbqz; TPUab: if (empty($additional_data)) { goto jrHzb; } goto hgqMj; hnjxQ: return $group_id; goto n0TnX; Y5d5H: $this->set_message("\x67\x72\x6f\165\160\x5f\x63\162\x65\x61\164\x69\x6f\156\137\163\165\143\x63\145\163\x73\x66\x75\x6c"); goto hnjxQ; EXn7c: $data = ["\x6e\141\155\145" => $group_name, "\144\x65\x73\x63\x72\x69\160\164\x69\157\156" => $group_description]; goto TPUab; n0TnX: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto rkMD3; DnBkT: return FALSE; goto L0s2F; MjSZP: return FALSE; goto WU_SP; KxnYq: if (empty($group_name)) { goto vEQla; } goto Kv374; L0s2F: LVX0p: goto CDHkr; gN25p: $group = $this->db->get_where($this->tables["\147\162\157\x75\160\x73"], ["\151\x64" => $group_id])->row(); goto GGOww; I347q: $this->db->update($this->tables["\147\x72\157\x75\160\x73"], $data, ["\151\x64" => $group_id]); goto jZ0_D; jZ0_D: $this->set_message("\147\162\x6f\165\x70\137\165\x70\x64\141\164\145\x5f\163\x75\x63\143\145\163\163\146\x75\154"); goto qLDTW; qLDTW: return TRUE; goto uTFEK; XZSt3: $data["\156\141\x6d\x65"] = $group_name; goto neVHI; fjwwh: e8Uf6: goto I347q; rkMD3: if (!empty($group_id)) { goto LVX0p; } goto DnBkT; KZqJz: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto aEFdj; } goto UI_Bp; cXU9q: $this->set_error("\147\162\157\x75\x70\x5f\156\x61\155\x65\x5f\x61\144\x6d\x69\x6e\x5f\156\x6f\164\x5f\x61\x6c\x74\145\162"); goto KimxH; GGOww: if (!($this->config->item("\x61\144\x6d\x69\156\x5f\147\162\x6f\x75\160", "\151\157\x6e\137\x61\x75\x74\150") === $group->name && $group_name !== $group->name)) { goto TVTLs; } goto cXU9q; WU_SP: aEFdj: goto XZSt3; Kv374: $existing_group = $this->db->get_where($this->tables["\147\x72\157\x75\160\x73"], ["\156\x61\155\x65" => $group_name])->row(); goto KZqJz; GYOY4: if (empty($additional_data)) { goto e8Uf6; } goto Xr6jp; v5LiK: TVTLs: goto GYOY4; neVHI: vEQla: goto gN25p; KimxH: return FALSE; goto v5LiK; UI_Bp: $this->set_error("\x67\162\157\x75\x70\x5f\x61\x6c\162\x65\x61\x64\171\137\x65\x78\x69\x73\x74\x73"); goto MjSZP; Xr6jp: $data = array_merge($this->_filter_data($this->tables["\x67\162\157\x75\x70\163"], $additional_data), $data); goto fjwwh; CDHkr: $data = []; goto KxnYq; uTFEK: } public function delete_group($group_id = FALSE) { goto XadtQ; xiLsL: $this->set_error("\x67\x72\157\165\x70\x5f\x64\x65\154\145\164\145\137\x6e\x6f\164\x61\154\154\157\167\145\x64"); goto I3lkY; qkU7G: $this->db->trans_commit(); goto hkcW0; D7V6d: fKsDG: goto LnEd1; hkcW0: $this->trigger_events(["\160\x6f\163\x74\137\144\x65\154\145\x74\x65\137\147\162\x6f\165\x70", "\x70\157\163\164\137\144\x65\x6c\x65\164\x65\x5f\x67\162\x6f\165\160\x5f\x73\165\x63\x63\x65\163\x73\x66\165\x6c"]); goto E_jiv; Pxk3W: $this->trigger_events(["\x70\157\163\x74\137\144\145\154\145\164\x65\137\x67\162\157\165\160", "\160\157\163\x74\x5f\144\x65\x6c\145\x74\x65\x5f\147\162\157\165\x70\137\156\157\164\141\x6c\x6c\157\x77\145\144"]); goto xiLsL; qqlrK: return TRUE; goto n9Oqb; w4Cxr: if (!($group->name == $this->config->item("\x61\x64\155\x69\156\x5f\147\162\x6f\165\160", "\x69\157\156\137\141\x75\x74\x68"))) { goto MMJk1; } goto Pxk3W; I3lkY: return FALSE; goto l9xyE; oBUvI: $this->db->delete($this->tables["\147\x72\157\165\x70\x73"], ["\151\x64" => $group_id]); goto u0tF3; u0tF3: if (!($this->db->trans_status() === FALSE)) { goto nbIQl; } goto DxYKz; XadtQ: if (!(!$group_id || empty($group_id))) { goto fKsDG; } goto QUy2X; LnEd1: $group = $this->group($group_id)->row(); goto w4Cxr; DUI1D: $this->db->delete($this->tables["\165\163\x65\x72\163\137\x67\162\x6f\x75\160\163"], [$this->join["\147\162\157\x75\x70\x73"] => $group_id]); goto oBUvI; E_jiv: $this->set_message("\147\x72\157\165\160\137\144\145\x6c\x65\x74\x65\137\x73\165\x63\x63\x65\x73\163\x66\165\x6c"); goto qqlrK; P_ia8: return FALSE; goto Zypal; l9xyE: MMJk1: goto HZjG_; DxYKz: $this->db->trans_rollback(); goto o6COu; o6COu: $this->trigger_events(["\x70\x6f\163\x74\137\x64\145\x6c\145\x74\145\137\147\x72\157\165\160", "\x70\157\x73\164\x5f\144\145\x6c\x65\164\145\137\147\162\157\x75\x70\x5f\x75\x6e\x73\165\143\143\145\x73\x73\146\x75\x6c"]); goto V1W4o; QUy2X: return FALSE; goto D7V6d; Zypal: nbIQl: goto qkU7G; HZjG_: $this->trigger_events("\160\x72\x65\137\144\145\154\145\164\145\137\x67\x72\157\165\160"); goto V_WSh; V1W4o: $this->set_error("\147\162\157\165\160\x5f\144\145\x6c\145\x74\x65\137\165\x6e\163\x75\143\143\145\163\163\x66\165\x6c"); goto P_ia8; V_WSh: $this->db->trans_begin(); goto DUI1D; n9Oqb: } public function set_hook($event, $name, $class, $method, $arguments) { goto MLz_Z; zMCFm: $this->_ion_hooks->{$event}[$name]->class = $class; goto RX83i; MLz_Z: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto zMCFm; RX83i: $this->_ion_hooks->{$event}[$name]->method = $method; goto ZOQHx; ZOQHx: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto yqt0J; yqt0J: } public function remove_hook($event, $name) { goto HoCLC; HoCLC: if (!isset($this->_ion_hooks->{$event}[$name])) { goto jSPUC; } goto pEYhe; IHtUe: jSPUC: goto TvJnG; pEYhe: unset($this->_ion_hooks->{$event}[$name]); goto IHtUe; TvJnG: } public function remove_hooks($event) { goto eVyPL; eVyPL: if (!isset($this->_ion_hooks->{$event})) { goto OWd1G; } goto hKsTJ; hKsTJ: unset($this->_ion_hooks->{$event}); goto ePEHQ; ePEHQ: OWd1G: goto ns4JQ; ns4JQ: } protected function _call_hook($event, $name) { goto bS4DA; CmTGV: $hook = $this->_ion_hooks->{$event}[$name]; goto EBoFB; EBoFB: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto xAU8x; pjImg: return FALSE; goto c6wkf; xAU8x: bS9UV: goto pjImg; bS4DA: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto bS9UV; } goto CmTGV; c6wkf: } public function trigger_events($events) { goto wnLiA; eoH5Q: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); IzUjT: } goto UMQBs; wnLiA: if (is_array($events) && !empty($events)) { goto DR37W; } goto NGmkG; q2ToZ: DR37W: goto mQcIv; Jl0wG: Txdqc: goto kani3; kani3: qKj83: goto bZc3v; mQcIv: foreach ($events as $event) { $this->trigger_events($event); iXhhv: } goto Jl0wG; UMQBs: FP4C4: goto mKis7; TLpOr: goto qKj83; goto q2ToZ; NGmkG: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto xP9SR; } goto eoH5Q; mKis7: xP9SR: goto TLpOr; bZc3v: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto FljOA; YZx7f: $this->message_end_delimiter = $end_delimiter; goto o_0X7; o_0X7: return TRUE; goto uYuYY; FljOA: $this->message_start_delimiter = $start_delimiter; goto YZx7f; uYuYY: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto AQiiz; MXqjZ: $this->error_end_delimiter = $end_delimiter; goto StcRC; StcRC: return TRUE; goto Zj6ex; AQiiz: $this->error_start_delimiter = $start_delimiter; goto MXqjZ; Zj6ex: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto zodp8; a_bBu: j1lP2: goto q399X; q399X: return $_output; goto z2RKL; IYgdC: foreach ($this->messages as $message) { goto e_Hq7; RmBfw: UPop9: goto Wudw6; e_Hq7: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto aDYet; aDYet: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto RmBfw; Wudw6: } goto a_bBu; zodp8: $_output = ''; goto IYgdC; z2RKL: } public function messages_array($langify = TRUE) { goto R0yHG; uR3vM: return $this->messages; goto HJ9s3; nLGJE: foreach ($this->messages as $message) { goto BhME5; baugu: gplNN: goto jx8vA; BhME5: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto nRfe4; nRfe4: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto baugu; jx8vA: } goto it0cg; JtzFj: return $_output; goto uq21w; uq21w: N_Yew: goto ecZti; it0cg: McV82: goto JtzFj; OVCxO: poKRG: goto eTagI; eTagI: $_output = []; goto nLGJE; HJ9s3: goto N_Yew; goto OVCxO; R0yHG: if ($langify) { goto poKRG; } goto uR3vM; ecZti: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto DO7Qg; sTDFa: eo4jl: goto rnLxw; DO7Qg: $_output = ''; goto p2h6w; p2h6w: foreach ($this->errors as $error) { goto tCpyd; T9eCc: FKRUt: goto NI0Kv; tCpyd: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\x23"; goto h7hli; h7hli: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto T9eCc; NI0Kv: } goto sTDFa; rnLxw: return $_output; goto QnytJ; QnytJ: } public function errors_array($langify = TRUE) { goto IQJGV; B4CUF: goto L7Q5u; goto zA7YN; zA7YN: LAWTg: goto JY6D3; IQJGV: if ($langify) { goto LAWTg; } goto NPLHE; AWW8B: foreach ($this->errors as $error) { goto LzWBS; LzWBS: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\x23"; goto NfT0z; NfT0z: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto ENWUD; ENWUD: m7i5c: goto d1K9a; d1K9a: } goto i0Hbs; NPLHE: return $this->errors; goto B4CUF; i0Hbs: QBOzP: goto gAhE8; Kagqb: L7Q5u: goto kjdno; gAhE8: return $_output; goto Kagqb; JY6D3: $_output = []; goto AWW8B; kjdno: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto bA2HE; bqVsb: $this->trigger_events("\145\170\x74\x72\x61\137\x77\150\145\162\x65"); goto MOfIM; xqR1j: if (!($hash === FALSE)) { goto RmpKL; } goto aPiuW; MOfIM: $this->db->update($this->tables["\x75\163\x65\x72\163"], $data, [$this->identity_column => $identity]); goto SnpUy; bA2HE: $hash = $this->hash_password($password, $identity); goto xqR1j; dzMTu: RmpKL: goto RRrXU; RRrXU: $data = ["\160\x61\163\x73\167\157\x72\x64" => $hash, "\162\145\x6d\145\x6d\x62\145\162\x5f\143\x6f\x64\145" => NULL, "\x66\x6f\162\x67\x6f\x74\164\x65\x6e\x5f\160\141\163\x73\167\x6f\162\x64\x5f\143\x6f\x64\145" => NULL, "\146\157\162\x67\x6f\164\x74\x65\x6e\x5f\160\x61\x73\163\x77\x6f\x72\144\x5f\164\x69\155\145" => NULL]; goto bqVsb; SnpUy: return $this->db->affected_rows() == 1; goto YXg_2; aPiuW: return FALSE; goto dzMTu; YXg_2: } protected function _filter_data($table, $data) { goto D0ngh; R_hjY: nAASU: goto Rdv0j; Rdv0j: nPBCV: goto IZLH2; NCmpT: foreach ($columns as $column) { goto S1WTg; S1WTg: if (!array_key_exists($column, $data)) { goto q_Gss; } goto JtoFU; gEW2T: q_Gss: goto vZmh_; JtoFU: $filtered_data[$column] = $data[$column]; goto gEW2T; vZmh_: n90Sp: goto ztTMr; ztTMr: } goto R_hjY; D0ngh: $filtered_data = []; goto klK4u; klK4u: $columns = $this->db->list_fields($table); goto O_A3_; IZLH2: return $filtered_data; goto mueQC; O_A3_: if (!is_array($data)) { goto nPBCV; } goto NCmpT; mueQC: } protected function _random_token($result_length = 32) { goto ZO9po; ISQv4: return FALSE; goto J1MhG; uyAD5: e7Hdf: goto AsYOj; AsYOj: if (!function_exists("\162\x61\156\144\x6f\155\x5f\142\171\164\145\163")) { goto mzSgf; } goto DprVl; hyUjh: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto NqNgf; Q04lu: if (!function_exists("\x6f\160\145\x6e\x73\x73\x6c\x5f\162\141\x6e\x64\157\x6d\x5f\160\163\x65\165\144\157\x5f\x62\171\x74\145\163")) { goto kMv0q; } goto EzBUk; SGliX: kMv0q: goto ISQv4; ZyqB5: $result_length = 32; goto uyAD5; d_rLH: mzSgf: goto YZxl4; NqNgf: PxyaS: goto Q04lu; YZxl4: if (!function_exists("\x6d\143\162\x79\x70\164\137\143\x72\145\x61\x74\145\x5f\151\x76")) { goto PxyaS; } goto hyUjh; ZO9po: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto e7Hdf; } goto ZyqB5; DprVl: return bin2hex(random_bytes($result_length / 2)); goto d_rLH; EzBUk: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto SGliX; J1MhG: } protected function _get_hash_parameters($identity = NULL) { goto pXbBB; JdbTP: return $params; goto HnhF9; KANpv: switch ($this->hash_method) { case "\142\143\x72\171\x70\x74": $params = ["\x63\157\163\x74" => $is_admin ? $this->config->item("\x62\143\162\x79\160\164\x5f\141\144\x6d\x69\x6e\137\143\157\163\164", "\x69\x6f\x6e\x5f\x61\165\x74\x68") : $this->config->item("\x62\143\x72\x79\160\164\137\x64\x65\x66\x61\x75\154\164\x5f\x63\157\163\x74", "\151\x6f\x6e\137\x61\165\164\x68")]; goto nx5mP; case "\141\x72\147\157\156\x32": $params = $is_admin ? $this->config->item("\x61\162\147\x6f\156\x32\x5f\x61\144\155\x69\x6e\137\160\x61\x72\141\155\163", "\x69\x6f\x6e\137\141\x75\164\150") : $this->config->item("\x61\x72\x67\x6f\156\62\x5f\x64\x65\146\x61\165\154\164\x5f\x70\x61\x72\141\x6d\163", "\151\x6f\156\137\x61\165\164\x68"); goto nx5mP; default: } goto QLUmb; mJ0AR: nu73r: goto RWYq5; PadKW: $user_id = $this->get_user_id_from_identity($identity); goto xaCDa; BTtNo: nx5mP: goto JdbTP; QLUmb: n1PtU: goto BTtNo; Oz3b_: $is_admin = TRUE; goto Jxnpd; Tfpnu: if (!$identity) { goto nu73r; } goto PadKW; Jxnpd: mmH9b: goto mJ0AR; pXbBB: $is_admin = FALSE; goto Tfpnu; xaCDa: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\151\x6e\x5f\x67\x72\x6f\165\160", "\151\157\x6e\x5f\x61\165\164\150"), $user_id))) { goto mmH9b; } goto Oz3b_; RWYq5: $params = FALSE; goto KANpv; HnhF9: } protected function _get_hash_algo() { goto jRy_I; ciBPn: oC3Tj: goto UnMPe; jRy_I: $algo = FALSE; goto J9cWF; UnMPe: return $algo; goto YV1Jy; J9cWF: switch ($this->hash_method) { case "\x62\143\162\x79\160\x74": $algo = PASSWORD_BCRYPT; goto oC3Tj; case "\141\162\147\x6f\156\x32": $algo = PASSWORD_ARGON2I; goto oC3Tj; default: } goto gEby8; gEby8: WHrOg: goto ciBPn; YV1Jy: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto cWwRt; wFODf: $validator_hashed = $this->hash_password($validator); goto sr74r; ukeBs: $validator = $this->_random_token($validator_size); goto wFODf; JZy8h: return (object) ["\163\145\154\145\143\164\157\162" => $selector, "\166\x61\x6c\x69\x64\141\x74\x6f\162\137\150\x61\x73\x68\x65\144" => $validator_hashed, "\165\x73\x65\x72\137\x63\157\144\x65" => $user_code]; goto MRbHc; cWwRt: $selector = $this->_random_token($selector_size); goto ukeBs; sr74r: $user_code = "{$selector}\x2e{$validator}"; goto JZy8h; MRbHc: } protected function _retrieve_selector_validator_couple($user_code) { goto WuqiI; WuqiI: if (!$user_code) { goto j2SL0; } goto FoIfQ; kAJ6s: if (!(count($tokens) === 2)) { goto x6Gdq; } goto KO_qO; GH5tM: x6Gdq: goto FzCpu; FoIfQ: $tokens = explode("\56", $user_code); goto kAJ6s; FzCpu: j2SL0: goto U0NcZ; U0NcZ: return FALSE; goto c3Cgp; KO_qO: return (object) ["\x73\x65\x6c\145\143\164\157\162" => $tokens[0], "\x76\x61\x6c\x69\144\141\164\x6f\162" => $tokens[1]]; goto GH5tM; c3Cgp: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto Ezo5h; tby6A: WEmtX: goto M7QlI; AU_7z: Y2kJU: goto IHk1T; gb2F4: goto EJmMm; goto Tsm91; n2bz8: return $result; goto eH8VV; lJEqr: kPIGt: goto svTiZ; vZETm: if (!($query->num_rows() !== 1)) { goto Jpw6G; } goto E6eUU; FpEgn: $query = $this->db->select("\x73\x61\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto sfCz1; NutcZ: $hashed_password = sha1($password . $salt_db->salt); goto lJEqr; E6eUU: $this->trigger_events(["\x70\157\163\164\x5f\163\150\141\x31\x5f\x70\x61\x73\163\x77\x6f\162\144\x5f\x6d\151\x67\162\141\x74\x69\157\x6e", "\160\157\x73\x74\137\x73\x68\x61\x31\x5f\x70\x61\163\163\167\x6f\162\144\137\155\x69\x67\x72\141\x74\x69\x6f\x6e\137\165\156\163\x75\143\x63\x65\163\163\x66\165\154"]); goto Bpqep; Xhp07: goto lJT3J; goto AU_7z; svTiZ: if ($hashed_password === $hashed_password_db) { goto C88Kx; } goto u3ipV; pIpfP: $result = $this->_set_password_db($identity, $password); goto IVuxp; CC9cK: if ($this->config->item("\163\164\157\162\x65\137\163\x61\x6c\x74", "\151\157\x6e\x5f\x61\165\164\x68")) { goto TWpyQ; } goto pEizI; lldhs: $this->trigger_events(["\160\x6f\x73\164\137\x73\x68\141\x31\x5f\x70\141\x73\163\167\x6f\x72\x64\x5f\155\x69\147\162\141\164\151\157\x6e", "\160\x6f\163\x74\137\163\x68\x61\61\137\160\x61\163\x73\x77\x6f\162\144\x5f\155\151\147\162\x61\164\x69\x6f\156\137\x75\x6e\163\x75\143\x63\x65\163\163\146\165\154"]); goto PGQl2; PGQl2: return FALSE; goto tby6A; M7QlI: $salt = substr($hashed_password_db, 0, $salt_length); goto SEecW; SEecW: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto oK_kv; AHwML: if ($salt_length) { goto WEmtX; } goto lldhs; IHk1T: $this->trigger_events(["\160\157\x73\164\137\x73\x68\x61\x31\137\160\141\163\x73\167\x6f\x72\144\x5f\155\x69\147\x72\x61\164\x69\x6f\x6e", "\160\157\x73\164\x5f\163\150\x61\61\x5f\x70\141\x73\163\167\x6f\162\x64\x5f\x6d\x69\x67\162\x61\164\151\x6f\x6e\137\x73\165\143\x63\145\x73\x73\146\x75\x6c"]); goto JNLJF; Tsm91: C88Kx: goto pIpfP; JNLJF: lJT3J: goto n2bz8; sfCz1: $salt_db = $query->row(); goto vZETm; Bpqep: return FALSE; goto p9f01; KLT4R: TWpyQ: goto FpEgn; pEizI: $salt_length = $this->config->item("\163\x61\154\164\137\x6c\145\156\x67\x74\150", "\x69\157\x6e\x5f\141\x75\164\x68"); goto AHwML; oK_kv: goto kPIGt; goto KLT4R; G_hzM: return FALSE; goto gb2F4; Ezo5h: $this->trigger_events("\160\x72\145\x5f\163\150\x61\61\x5f\160\x61\163\x73\167\157\x72\144\x5f\x6d\151\x67\162\141\x74\x69\157\x6e"); goto CC9cK; p9f01: Jpw6G: goto NutcZ; u3ipV: $this->trigger_events(["\160\x6f\x73\164\137\163\x68\141\61\x5f\160\x61\163\x73\167\x6f\162\144\137\x6d\151\x67\x72\141\164\151\x6f\156", "\x70\x6f\163\164\137\163\150\141\61\x5f\160\141\x73\163\x77\x6f\x72\x64\x5f\155\x69\147\x72\x61\x74\151\157\156\x5f\165\x6e\163\x75\x63\x63\145\163\163\146\165\154"]); goto G_hzM; eH8VV: EJmMm: goto dTAeW; IVuxp: if ($result) { goto Y2kJU; } goto yX6SP; yX6SP: $this->trigger_events(["\x70\157\x73\x74\137\x73\150\141\61\137\160\x61\163\163\167\x6f\x72\144\137\155\151\147\162\x61\164\151\157\156", "\x70\157\x73\164\x5f\x73\150\x61\x31\x5f\160\141\163\163\167\157\x72\144\137\155\151\147\x72\x61\164\151\x6f\x6e\x5f\165\x6e\x73\165\x63\x63\x65\163\x73\146\165\x6c"]); goto Xhp07; dTAeW: } }
