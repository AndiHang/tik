<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\105\x50\x41\x54\x48") or exit("\x4e\x6f\x20\x64\151\162\145\x63\164\40\163\143\162\x69\160\x74\40\141\x63\x63\x65\163\163\40\141\154\x6c\x6f\x77\x65\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto uH9G3; ZX6pb: $this->message_end_delimiter = $this->error_end_delimiter; goto IK0DC; ZslkK: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto ZX6pb; iHRU7: $this->tables = $this->config->item("\x74\141\x62\154\x65\x73", "\151\157\x6e\x5f\x61\x75\164\x68"); goto OYl6R; KjCwh: $this->_ion_hooks = new stdClass(); goto lB3tr; g09x3: $this->db = $this->load->database($group_name, TRUE, TRUE); goto OWuTG; BNaAx: $CI =& get_instance(); goto XG0YT; gxPCP: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\x72\157\x72\137\163\x75\146\146\151\x78"); goto n2hhL; jGBtG: $error_prefix->setAccessible(TRUE); goto ncDhn; gvX53: $this->messages = []; goto NXUSf; AUxWT: $this->message_end_delimiter = $this->config->item("\155\x65\x73\x73\141\147\x65\137\145\x6e\144\137\144\145\154\151\x6d\x69\x74\x65\162", "\151\x6f\156\x5f\141\165\164\150"); goto zZgxo; Sf7B3: $this->join = $this->config->item("\152\157\151\156", "\x69\157\x6e\137\141\x75\x74\x68"); goto BIRYC; ZIYbq: $this->error_end_delimiter = $this->config->item("\x65\162\x72\157\162\x5f\145\x6e\x64\x5f\144\145\154\151\155\151\164\x65\x72", "\151\157\x6e\x5f\x61\165\164\150"); goto geMOc; lHg_e: Yyzi1: goto iHRU7; Ixys2: $this->load->library("\146\157\162\155\137\x76\141\x6c\x69\x64\141\x74\x69\x6f\x6e"); goto qYmQe; ZHU2P: $this->load->helper("\144\x61\164\x65"); goto YwCAB; BIRYC: $this->hash_method = $this->config->item("\150\141\163\150\137\155\145\x74\150\157\x64", "\x69\157\x6e\137\141\x75\164\x68"); goto gvX53; fkcbb: $group_name = $this->config->item("\x64\x61\164\x61\x62\141\163\x65\x5f\147\x72\x6f\165\x70\137\156\141\155\x65", "\x69\157\156\x5f\141\165\x74\150"); goto kWAP_; kWAP_: if (empty($group_name)) { goto HvwTi; } goto g09x3; OWuTG: goto Yyzi1; goto GlOfd; XG0YT: $this->db = $CI->db; goto lHg_e; NXUSf: $this->errors = []; goto Nqyvj; YwCAB: $this->lang->load("\x69\157\156\137\141\x75\164\150"); goto fkcbb; n2hhL: $error_suffix->setAccessible(TRUE); goto ZslkK; ncDhn: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto qbVCZ; OYl6R: $this->identity_column = $this->config->item("\x69\144\145\x6e\164\x69\164\171", "\151\x6f\x6e\x5f\141\x75\x74\x68"); goto Sf7B3; qbVCZ: $this->message_start_delimiter = $this->error_start_delimiter; goto gxPCP; Pn9tC: if ($delimiters_source === "\x66\157\162\x6d\137\x76\x61\x6c\x69\x64\x61\x74\x69\x6f\156") { goto wX8Z3; } goto KF9D4; eKqQh: wX8Z3: goto Ixys2; Nqyvj: $delimiters_source = $this->config->item("\x64\x65\x6c\151\x6d\x69\164\145\162\x73\137\x73\x6f\165\x72\x63\x65", "\151\157\156\137\141\165\x74\x68"); goto Pn9tC; uI7ae: $error_prefix = $form_validation_class->getProperty("\x5f\x65\162\x72\157\162\x5f\x70\x72\145\146\x69\x78"); goto jGBtG; geMOc: goto Kl7Oj; goto eKqQh; dwstD: $this->load->helper("\x63\x6f\x6f\x6b\151\145"); goto ZHU2P; KF9D4: $this->message_start_delimiter = $this->config->item("\x6d\145\163\163\141\147\x65\x5f\163\x74\x61\162\x74\137\x64\145\x6c\151\155\151\164\x65\x72", "\x69\157\x6e\137\141\x75\x74\150"); goto AUxWT; lB3tr: $this->trigger_events("\155\157\144\145\154\137\x63\157\156\163\x74\162\x75\x63\164\x6f\162"); goto rMwGY; GlOfd: HvwTi: goto BNaAx; zZgxo: $this->error_start_delimiter = $this->config->item("\x65\162\162\x6f\162\x5f\163\164\141\x72\164\x5f\144\x65\x6c\x69\x6d\151\164\145\x72", "\151\x6f\x6e\x5f\x61\x75\x74\x68"); goto ZIYbq; uH9G3: $this->config->load("\x69\x6f\156\137\x61\x75\x74\150", TRUE); goto dwstD; IK0DC: Kl7Oj: goto KjCwh; qYmQe: $form_validation_class = new ReflectionClass("\103\111\x5f\x46\157\x72\155\x5f\x76\x61\154\x69\x64\x61\x74\151\x6f\x6e"); goto uI7ae; rMwGY: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto sCvkp; G53oA: trm3R: goto QlqF4; sCvkp: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto E0h0g; } goto FPE1m; NMOLn: E0h0g: goto Bg9gC; Abzid: $params = $this->_get_hash_parameters($identity); goto ONT48; QlqF4: return FALSE; goto Zsv0Y; Bg9gC: $algo = $this->_get_hash_algo(); goto Abzid; FPE1m: return FALSE; goto NMOLn; CFGcJ: return password_hash($password, $algo, $params); goto G53oA; ONT48: if (!($algo !== FALSE && $params !== FALSE)) { goto trm3R; } goto CFGcJ; Zsv0Y: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto PDP2r; PDP2r: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto GUWPp; } goto TqAAO; tZ_4h: L7X2e: goto GJHdE; JbtV1: if (strpos($hash_password_db, "\x24") === 0) { goto KO00O; } goto PB9wP; la1or: KO00O: goto ijDZR; ZOe7x: GUWPp: goto JbtV1; TqAAO: return FALSE; goto ZOe7x; ijDZR: return password_verify($password, $hash_password_db); goto tZ_4h; PB9wP: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto U8xxB; U8xxB: goto L7X2e; goto la1or; GJHdE: } public function rehash_password_if_needed($hash, $identity, $password) { goto bSHSq; CiDGw: goto dn40k; goto fdMDD; NGCBP: twx5C: goto u00nd; lbAjH: if ($this->_set_password_db($identity, $password)) { goto cObNn; } goto yVouR; YbGh6: if (!($algo !== FALSE && $params !== FALSE)) { goto twx5C; } goto j9JyP; bSHSq: $algo = $this->_get_hash_algo(); goto VAteZ; VAteZ: $params = $this->_get_hash_parameters($identity); goto YbGh6; fdMDD: cObNn: goto BGqLL; wUir1: P9x3v: goto NGCBP; j9JyP: if (!password_needs_rehash($hash, $algo, $params)) { goto P9x3v; } goto lbAjH; yVouR: $this->trigger_events(["\162\x65\150\x61\x73\150\x5f\160\141\163\163\x77\x6f\x72\144", "\162\x65\x68\x61\163\x68\137\160\x61\163\x73\167\x6f\162\x64\137\165\156\x73\x75\x63\143\x65\x73\163\x66\165\154"]); goto CiDGw; BGqLL: $this->trigger_events(["\x72\145\150\x61\163\x68\x5f\x70\141\163\163\167\x6f\x72\144", "\x72\145\x68\x61\163\x68\137\x70\x61\x73\163\167\157\162\144\137\163\165\x63\x63\145\x73\x73\x66\165\154"]); goto PY5lz; PY5lz: dn40k: goto wUir1; u00nd: } public function get_user_by_activation_code($user_code) { goto fW3HN; UtD0e: dpFbW: goto xsSe1; q5KMG: if (!$this->verify_password($token->validator, $user->activation_code)) { goto DZE7J; } goto Jegs1; xsSe1: return FALSE; goto KIv6t; sWPnB: $user = $this->where("\141\143\x74\x69\166\x61\x74\x69\157\156\x5f\163\x65\154\145\x63\164\157\x72", $token->selector)->users()->row(); goto uu_RT; fW3HN: $token = $this->_retrieve_selector_validator_couple($user_code); goto sWPnB; Jegs1: return $user; goto Ox9Cu; Ox9Cu: DZE7J: goto UtD0e; uu_RT: if (!$user) { goto dpFbW; } goto q5KMG; KIv6t: } public function activate($id, $code = FALSE) { goto aLOWC; oe6JO: if (!($code === FALSE || $user && $user->id === $id)) { goto jULEd; } goto xkfEX; IApvr: $this->trigger_events(["\x70\157\x73\x74\137\x61\143\164\x69\166\141\164\x65", "\160\x6f\x73\164\137\141\x63\164\x69\166\x61\x74\x65\x5f\x73\x75\143\143\145\163\x73\146\165\x6c"]); goto auPhj; JNBbg: $this->trigger_events(["\x70\157\163\164\137\141\x63\164\151\166\141\x74\145", "\160\157\163\x74\x5f\x61\143\x74\151\x76\x61\x74\145\137\165\156\x73\x75\143\143\145\x73\x73\x66\x75\x6c"]); goto VQxve; KELDE: return FALSE; goto rBPz_; gW4d6: if (!($code !== FALSE)) { goto XMdzv; } goto g2hZb; Ij9hH: $this->trigger_events("\145\170\164\162\141\137\167\x68\145\x72\145"); goto ZigHZ; aLOWC: $this->trigger_events("\x70\162\x65\x5f\x61\x63\164\x69\166\141\x74\145"); goto gW4d6; ZigHZ: $this->db->update($this->tables["\165\x73\x65\162\163"], $data, ["\151\144" => $id]); goto jfM6T; itMUo: jULEd: goto JNBbg; VQxve: $this->set_error("\x61\143\x74\151\166\141\x74\x65\137\x75\156\163\x75\143\x63\145\163\x73\146\165\x6c"); goto KELDE; g2hZb: $user = $this->get_user_by_activation_code($code); goto bqnF1; jfM6T: if (!($this->db->affected_rows() === 1)) { goto MYgcL; } goto IApvr; pUEBP: return TRUE; goto Uk3Xv; bqnF1: XMdzv: goto oe6JO; Uk3Xv: MYgcL: goto itMUo; auPhj: $this->set_message("\x61\143\164\151\166\x61\164\145\x5f\x73\165\x63\143\x65\163\163\146\x75\154"); goto pUEBP; xkfEX: $data = ["\x61\x63\164\151\x76\x61\164\x69\157\x6e\x5f\x73\145\x6c\x65\x63\164\x6f\162" => NULL, "\141\143\x74\x69\166\x61\x74\x69\x6f\156\137\x63\157\144\x65" => NULL, "\141\143\164\x69\x76\x65" => 1]; goto Ij9hH; rBPz_: } public function deactivate($id = NULL) { goto Uc4Q7; pihUH: $this->db->update($this->tables["\x75\x73\x65\162\163"], $data, ["\x69\x64" => $id]); goto DzSSU; VSwwi: return $return; goto rUBOQ; htAxn: $this->set_message("\144\x65\x61\143\x74\151\x76\x61\x74\x65\x5f\x73\x75\143\x63\x65\163\163\146\x75\x6c"); goto zhArq; CB4it: $token = $this->_generate_selector_validator_couple(20, 40); goto ydtJY; fHkpq: goto Dveqh; goto x2rZw; t1pUl: if (!isset($id)) { goto kZkhW; } goto MOOAn; Uc4Q7: $this->trigger_events("\x64\x65\141\143\x74\151\166\141\164\x65"); goto t1pUl; oe2zK: return FALSE; goto r5AeC; MOOAn: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto flrEC; } goto CWq9D; adOlc: $data = ["\x61\143\x74\x69\166\x61\x74\151\157\x6e\x5f\163\145\x6c\145\143\164\157\162" => $token->selector, "\x61\143\x74\151\x76\141\164\x69\x6f\x6e\137\x63\x6f\x64\145" => $token->validator_hashed, "\141\143\164\x69\166\145" => 0]; goto iyUOM; r5AeC: flrEC: goto msa3l; zhArq: Dveqh: goto VSwwi; msa3l: goto L7XyJ; goto BVGoa; iyUOM: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\x77\x68\x65\x72\x65"); goto pihUH; soIjH: if ($return) { goto ETuNN; } goto HoWCU; x2rZw: ETuNN: goto htAxn; c4DJS: return FALSE; goto MO9iy; ydtJY: $this->activation_code = $token->user_code; goto adOlc; DzSSU: $return = $this->db->affected_rows() == 1; goto soIjH; MO9iy: L7XyJ: goto CB4it; U0gkR: $this->set_error("\x64\145\141\143\164\151\x76\x61\164\x65\x5f\165\x6e\x73\165\x63\x63\x65\x73\x73\146\165\x6c"); goto c4DJS; CWq9D: $this->set_error("\144\x65\x61\143\164\151\x76\141\x74\145\x5f\x63\x75\162\x72\x65\156\164\137\x75\x73\145\162\137\165\156\163\165\143\143\145\x73\163\x66\x75\154"); goto oe2zK; BVGoa: kZkhW: goto U0gkR; HoWCU: $this->set_error("\x64\145\141\x63\164\x69\166\141\x74\145\137\165\156\x73\165\143\143\145\x73\x73\146\x75\154"); goto fHkpq; rUBOQ: } public function clear_forgotten_password_code($identity) { goto nomwg; Yjrn2: $data = ["\x66\157\x72\x67\157\x74\x74\145\x6e\x5f\x70\x61\x73\163\167\x6f\162\x64\137\x73\145\x6c\145\x63\x74\x6f\162" => NULL, "\146\x6f\162\147\157\x74\164\x65\156\x5f\160\x61\x73\x73\167\x6f\162\144\x5f\143\157\x64\x65" => NULL, "\x66\x6f\x72\x67\157\x74\164\x65\x6e\137\160\x61\x73\163\x77\x6f\x72\144\137\164\151\x6d\145" => NULL]; goto H2WRQ; QMiaG: return FALSE; goto ndN87; G2CXe: return TRUE; goto a9dNn; ndN87: zWeM3: goto Yjrn2; nomwg: if (!empty($identity)) { goto zWeM3; } goto QMiaG; H2WRQ: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto G2CXe; a9dNn: } public function clear_remember_code($identity) { goto hD12p; HH1SV: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto zmirY; aYrjb: return FALSE; goto fwdSA; fwdSA: PRX__: goto AyftK; AyftK: $data = ["\162\x65\x6d\x65\x6d\x62\145\162\x5f\x73\x65\154\145\143\164\x6f\162" => NULL, "\x72\x65\x6d\x65\x6d\142\x65\162\137\x63\157\x64\x65" => NULL]; goto HH1SV; zmirY: return TRUE; goto NBOue; hD12p: if (!empty($identity)) { goto PRX__; } goto aYrjb; NBOue: } public function reset_password($identity, $new) { goto vCB5b; YPNxr: QFOS6: goto aM6dn; Lvzdc: P6Iru: goto P5fvF; G1It6: goto FxOif; goto Lvzdc; kQVwX: return $return; goto fT0qE; H3Djx: $this->trigger_events(["\160\157\x73\x74\137\143\150\x61\156\x67\145\137\160\x61\x73\163\x77\157\162\x64", "\x70\x6f\x73\x74\137\x63\150\x61\156\x67\145\x5f\x70\x61\x73\163\x77\157\x72\144\137\x75\x6e\x73\x75\143\x63\x65\x73\163\x66\x75\x6c"]); goto U8GJ2; mPyH0: if ($return) { goto P6Iru; } goto aZJ4d; aM6dn: $return = $this->_set_password_db($identity, $new); goto mPyH0; bLYxd: $this->set_message("\160\x61\163\x73\167\x6f\x72\144\x5f\x63\x68\141\x6e\147\145\x5f\163\x75\143\143\145\163\163\x66\165\x6c"); goto wkpeU; wkpeU: FxOif: goto kQVwX; vCB5b: $this->trigger_events("\160\162\145\137\143\x68\141\156\147\x65\x5f\160\x61\x73\x73\x77\x6f\162\144"); goto Y9qDX; Y9qDX: if ($this->identity_check($identity)) { goto QFOS6; } goto H3Djx; aZJ4d: $this->trigger_events(["\x70\x6f\x73\164\x5f\x63\x68\141\x6e\147\x65\137\160\x61\x73\163\x77\x6f\x72\x64", "\x70\157\163\164\137\x63\x68\141\156\147\145\x5f\x70\141\163\x73\167\157\x72\144\137\x75\156\x73\x75\x63\x63\x65\163\163\x66\x75\154"]); goto SpQZu; U8GJ2: return FALSE; goto YPNxr; P5fvF: $this->trigger_events(["\160\157\163\x74\x5f\143\x68\x61\156\x67\x65\137\x70\141\163\163\x77\x6f\x72\144", "\x70\157\163\164\137\x63\150\141\x6e\x67\145\x5f\x70\x61\x73\x73\x77\157\x72\x64\x5f\x73\x75\x63\143\x65\x73\x73\146\165\154"]); goto bLYxd; SpQZu: $this->set_error("\160\141\x73\x73\167\157\x72\x64\137\x63\x68\141\156\x67\145\x5f\165\x6e\163\165\x63\x63\145\x73\x73\x66\165\154"); goto G1It6; fT0qE: } public function change_password($identity, $old, $new) { goto m0BT5; SFoM0: $this->trigger_events(["\160\157\163\x74\x5f\143\x68\x61\x6e\x67\145\x5f\160\141\163\x73\x77\157\x72\x64", "\160\x6f\163\164\137\x63\150\x61\x6e\147\145\x5f\x70\x61\163\x73\x77\x6f\162\x64\137\x73\x75\143\143\145\163\x73\x66\x75\154"]); goto TDs96; CsfOs: $user = $query->row(); goto mPAZZ; V142N: if (!($query->num_rows() !== 1)) { goto wDoAZ; } goto Tt_3e; zkUwq: return FALSE; goto CgslT; bNjoS: $this->set_error("\x70\141\x73\x73\167\157\x72\144\x5f\x63\x68\141\156\147\x65\137\x75\156\x73\x75\143\x63\x65\x73\x73\x66\165\154"); goto g8bbV; EfUtC: $result = $this->_set_password_db($identity, $new); goto z75y5; lp0H_: ZtaE6: goto KBavO; m0BT5: $this->trigger_events("\160\x72\x65\x5f\143\x68\141\x6e\x67\145\x5f\x70\x61\x73\163\167\x6f\x72\144"); goto Rcr5R; FQrsu: wDoAZ: goto CsfOs; g8bbV: goto ZtaE6; goto qs7Cu; z75y5: if ($result) { goto QhUbk; } goto FcWDd; liFLb: LJVRY: goto jRVmw; qs7Cu: QhUbk: goto SFoM0; FcWDd: $this->trigger_events(["\x70\157\163\x74\x5f\x63\150\141\x6e\147\145\137\x70\141\163\163\167\x6f\162\144", "\160\x6f\163\x74\137\x63\150\141\156\147\145\137\x70\x61\163\x73\x77\157\162\x64\137\165\x6e\x73\x75\143\x63\145\x73\163\146\165\x6c"]); goto bNjoS; WGRZD: return FALSE; goto FQrsu; wmpXr: $query = $this->db->select("\x69\x64\x2c\x20\160\x61\163\x73\167\x6f\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\145\x73\x63")->get($this->tables["\x75\x73\x65\162\x73"]); goto V142N; mPAZZ: if (!$this->verify_password($old, $user->password, $identity)) { goto LJVRY; } goto EfUtC; Rcr5R: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\x77\x68\x65\162\145"); goto wmpXr; Tt_3e: $this->trigger_events(["\x70\x6f\x73\164\137\143\150\x61\x6e\x67\145\137\x70\141\163\163\167\x6f\162\144", "\x70\x6f\x73\164\x5f\x63\150\x61\156\x67\x65\x5f\160\x61\x73\x73\167\157\162\x64\x5f\165\x6e\x73\165\143\143\145\163\x73\x66\165\154"]); goto WFq9n; KBavO: return $result; goto liFLb; jRVmw: $this->set_error("\x70\x61\x73\x73\x77\x6f\162\x64\137\x63\150\141\156\147\145\137\x75\156\163\x75\x63\143\145\163\163\x66\165\x6c"); goto zkUwq; TDs96: $this->set_message("\x70\x61\163\x73\x77\x6f\x72\144\137\x63\x68\x61\x6e\147\x65\137\x73\x75\143\143\145\163\x73\x66\x75\x6c"); goto lp0H_; WFq9n: $this->set_error("\160\141\x73\x73\167\157\x72\144\137\x63\x68\x61\x6e\x67\145\x5f\x75\x6e\x73\165\x63\x63\x65\x73\163\146\165\154"); goto WGRZD; CgslT: } public function username_check($username = '') { goto DLuGT; ohDUi: if (!empty($username)) { goto MdEAP; } goto RvkE_; LiQyF: MdEAP: goto MQSId; oLHBB: return $this->db->where("\165\163\145\162\156\x61\x6d\145", $username)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\x73"]) > 0; goto ryIR0; DLuGT: $this->trigger_events("\165\x73\145\x72\156\x61\155\x65\x5f\143\150\x65\143\153"); goto ohDUi; RvkE_: return FALSE; goto LiQyF; MQSId: $this->trigger_events("\145\x78\164\162\x61\137\167\x68\x65\x72\x65"); goto oLHBB; ryIR0: } public function email_check($email = '') { goto HilMU; ub0CT: if (!empty($email)) { goto HV9Cz; } goto Dvqnf; n1b_N: return $this->db->where("\145\x6d\141\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\163"]) > 0; goto mSoI5; HilMU: $this->trigger_events("\x65\x6d\x61\151\x6c\x5f\143\150\145\143\x6b"); goto ub0CT; shz4G: HV9Cz: goto lPRCX; lPRCX: $this->trigger_events("\145\170\x74\162\x61\x5f\x77\150\x65\162\x65"); goto n1b_N; Dvqnf: return FALSE; goto shz4G; mSoI5: } public function identity_check($identity = '') { goto KsFyE; KsFyE: $this->trigger_events("\x69\144\x65\156\164\x69\x74\x79\x5f\x63\x68\145\143\153"); goto a8mYe; WdMie: ke8LZ: goto LZDMo; a8mYe: if (!empty($identity)) { goto ke8LZ; } goto xP3Xf; xP3Xf: return FALSE; goto WdMie; LZDMo: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\162\x73"]) > 0; goto nj_d3; nj_d3: } public function get_user_id_from_identity($identity = '') { goto kAQNZ; AUvhM: pwBUU: goto ChtpX; Voyq_: if (!($query->num_rows() !== 1)) { goto pwBUU; } goto hKl41; KU1CG: return FALSE; goto MSLZ_; QDNv1: $query = $this->db->select("\151\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\145\162\x73"]); goto Voyq_; kAQNZ: if (!empty($identity)) { goto Jtada; } goto KU1CG; ChtpX: $user = $query->row(); goto ppBN3; ppBN3: return $user->id; goto Y6o5f; MSLZ_: Jtada: goto QDNv1; hKl41: return FALSE; goto AUvhM; Y6o5f: } public function forgotten_password($identity) { goto Wz4fx; RShFI: return FALSE; goto fAHqg; fAHqg: tc0rf: goto jVPRQ; EeBND: $this->db->update($this->tables["\165\163\x65\162\163"], $update, [$this->identity_column => $identity]); goto DaHcJ; JqL36: return $token->user_code; goto BzcLw; Wz4fx: if (!empty($identity)) { goto tc0rf; } goto DqZnw; JiTsF: return FALSE; goto T3hsC; T3hsC: goto mqvXE; goto ouTpV; l0ln3: $this->trigger_events(["\160\157\x73\x74\137\146\x6f\x72\147\157\x74\164\x65\156\x5f\160\x61\x73\163\167\157\162\144", "\160\157\x73\x74\137\x66\x6f\x72\147\157\x74\164\145\156\x5f\x70\141\163\x73\x77\x6f\162\144\137\165\156\x73\x75\x63\143\x65\163\x73\x66\x75\x6c"]); goto JiTsF; HhBgP: $this->trigger_events(["\160\x6f\x73\164\x5f\146\157\162\147\x6f\164\x74\x65\x6e\137\160\x61\x73\x73\x77\157\x72\x64", "\160\x6f\x73\x74\x5f\x66\157\x72\147\x6f\x74\x74\x65\156\x5f\x70\141\x73\163\x77\x6f\162\x64\137\x73\x75\143\143\145\163\163\x66\165\x6c"]); goto JqL36; DqZnw: $this->trigger_events(["\160\x6f\163\x74\137\146\157\x72\147\x6f\164\x74\145\156\x5f\x70\141\163\163\167\x6f\162\x64", "\160\157\163\164\137\146\157\x72\147\157\x74\164\145\156\x5f\x70\x61\x73\x73\167\x6f\162\144\x5f\x75\156\x73\165\143\143\x65\x73\x73\x66\x75\154"]); goto RShFI; jVPRQ: $token = $this->_generate_selector_validator_couple(20, 80); goto i2orc; DaHcJ: if ($this->db->affected_rows() === 1) { goto SB0Ck; } goto l0ln3; ouTpV: SB0Ck: goto HhBgP; i2orc: $update = ["\146\x6f\162\x67\157\164\x74\x65\156\x5f\160\141\x73\163\x77\x6f\x72\144\137\163\145\x6c\x65\x63\x74\x6f\162" => $token->selector, "\146\x6f\162\147\x6f\164\x74\x65\156\x5f\x70\x61\163\163\x77\x6f\x72\144\137\143\157\144\x65" => $token->validator_hashed, "\x66\157\162\x67\x6f\x74\x74\145\156\x5f\160\141\163\x73\167\x6f\x72\x64\137\164\151\x6d\145" => time()]; goto Pw2N1; BzcLw: mqvXE: goto HSof4; Pw2N1: $this->trigger_events("\x65\x78\x74\x72\x61\137\167\150\x65\162\145"); goto EeBND; HSof4: } public function get_user_by_forgotten_password_code($user_code) { goto M6stJ; ahy3o: PpynE: goto qS6Uk; HG5mu: $user = $this->where("\x66\x6f\x72\x67\x6f\164\x74\x65\x6e\137\160\x61\163\x73\x77\157\162\x64\137\x73\x65\154\x65\143\x74\x6f\162", $token->selector)->users()->row(); goto v6RyQ; DLzBS: BT7ar: goto ahy3o; qS6Uk: return FALSE; goto VY3qt; ft3kB: return $user; goto DLzBS; v6RyQ: if (!$user) { goto PpynE; } goto FpHpL; M6stJ: $token = $this->_retrieve_selector_validator_couple($user_code); goto HG5mu; FpHpL: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto BT7ar; } goto ft3kB; VY3qt: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto REod9; fbzzX: $this->set_error("\141\x63\143\x6f\x75\x6e\x74\x5f\143\162\145\x61\164\151\157\x6e\x5f\x69\x6e\166\x61\x6c\151\x64\137\x64\x65\x66\x61\165\x6c\x74\137\x67\162\157\x75\160"); goto LxzKF; IINeU: $this->trigger_events("\145\170\164\162\x61\137\x73\x65\x74"); goto o0ERc; bdODv: if ($this->identity_check($identity)) { goto YqjSj; } goto dayKJ; J7Csv: return isset($id) ? $id : FALSE; goto N6W5v; S9sUc: BmP3Q: goto wuekv; RUkQl: tazU2: goto h1yp6; jJoi4: $default_group = $query; goto rXp0M; COuDs: if (empty($groups)) { goto BmP3Q; } goto zib0u; olnwy: $this->set_error("\x61\143\143\x6f\165\156\x74\137\x63\x72\145\x61\x74\151\x6f\x6e\137\155\151\163\x73\151\156\147\137\144\x65\x66\x61\165\154\164\x5f\x67\162\157\x75\160"); goto mFFET; Gc_Sc: $manual_activation = $this->config->item("\155\x61\156\165\x61\154\137\x61\x63\164\151\166\141\x74\151\157\x6e", "\151\157\x6e\x5f\x61\x75\164\150"); goto bdODv; U14JJ: $this->set_error("\141\143\143\x6f\165\x6e\x74\137\143\x72\x65\141\164\151\157\156\x5f\144\x75\x70\154\151\x63\141\x74\x65\x5f\151\x64\145\x6e\x74\151\164\x79"); goto he99i; OlUgk: $groups[] = $default_group->id; goto egTnN; wuekv: $this->trigger_events("\x70\x6f\163\x74\137\162\x65\147\151\x73\x74\145\x72"); goto J7Csv; dayKJ: if (!(!$this->config->item("\x64\x65\146\141\165\x6c\164\x5f\x67\x72\157\165\160", "\x69\157\x6e\137\x61\165\164\150") && empty($groups))) { goto txAAG; } goto olnwy; B0IiI: $data = [$this->identity_column => $identity, "\165\163\145\x72\x6e\141\x6d\145" => $identity, "\160\141\163\163\x77\x6f\x72\144" => $password, "\145\x6d\141\x69\154" => $email, "\151\160\137\x61\x64\144\162\x65\x73\163" => $ip_address, "\143\x72\145\x61\x74\145\144\x5f\157\x6e" => time(), "\141\x63\164\151\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto Z37bH; crvw8: MvjN4: goto jJoi4; CZ5zo: $id = $this->db->insert_id($this->tables["\x75\x73\145\162\163"] . "\x5f\151\x64\x5f\x73\x65\x71"); goto hVwkH; wClyu: if (!($password === FALSE)) { goto tKUgI; } goto jUvFn; dcx2_: YqjSj: goto U14JJ; huT6f: tKUgI: goto B0IiI; jUvFn: $this->set_error("\141\x63\x63\x6f\165\156\x74\137\x63\162\x65\141\164\151\157\x6e\x5f\165\156\163\165\x63\143\145\x73\x73\146\x75\154"); goto NnNPh; h1yp6: $query = $this->db->get_where($this->tables["\x67\x72\x6f\165\x70\163"], ["\156\x61\155\x65" => $this->config->item("\144\145\146\141\x75\154\164\137\147\x72\157\x75\x70", "\151\x6f\x6e\x5f\141\165\164\150")], 1)->row(); goto vgBqO; mFFET: return FALSE; goto dI3lC; Z37bH: $user_data = array_merge($this->_filter_data($this->tables["\165\163\145\162\x73"], $additional_data), $data); goto IINeU; cqIgb: RXuZv: goto S9sUc; dI3lC: txAAG: goto pckkY; LxzKF: return FALSE; goto crvw8; rXp0M: $ip_address = $this->input->ip_address(); goto LCMk2; NnNPh: return FALSE; goto huT6f; o0ERc: $this->db->insert($this->tables["\x75\163\145\162\163"], $user_data); goto CZ5zo; vgBqO: if (!(!isset($query->id) && empty($groups))) { goto MvjN4; } goto fbzzX; zib0u: foreach ($groups as $group) { $this->add_to_group($group, $id); cZQgT: } goto cqIgb; pckkY: goto tazU2; goto dcx2_; he99i: return FALSE; goto RUkQl; LCMk2: $password = $this->hash_password($password); goto wClyu; egTnN: iVl2N: goto COuDs; hVwkH: if (!(isset($default_group->id) && empty($groups))) { goto iVl2N; } goto OlUgk; REod9: $this->trigger_events("\x70\x72\145\x5f\x72\145\x67\x69\x73\164\x65\x72"); goto Gc_Sc; N6W5v: } public function login($identity, $password, $remember = FALSE) { goto IggsM; x74gR: $this->remember_user($identity); goto y5wF2; sJMch: $this->set_error("\x6c\x6f\x67\151\x6e\137\x75\x6e\163\x75\x63\143\145\163\163\x66\x75\x6c"); goto vJtSh; WRcwz: if (!$this->verify_password($password, $user->password, $identity)) { goto WpQx1; } goto jfqU0; LNTiK: $this->hash_password($password); goto vLCVc; VIpzQ: $this->update_last_login($user->id); goto g4imG; CUl_F: $this->trigger_events(["\160\157\163\164\x5f\x6c\157\147\x69\156", "\x70\157\x73\164\x5f\154\x6f\x67\151\x6e\137\x73\x75\x63\143\x65\163\x73\146\x75\154"]); goto vxOpX; dhIkq: $user = $query->row(); goto WRcwz; nCd32: if ($remember) { goto ieIg3; } goto bAZbw; vLCVc: $this->trigger_events("\160\x6f\x73\164\137\x6c\x6f\147\x69\x6e\x5f\165\156\x73\x75\143\143\x65\x73\x73\146\x75\x6c"); goto IiBw6; tN_sM: return FALSE; goto rCk4C; g4imG: $this->clear_login_attempts($identity); goto y2QdW; E0P83: $this->rehash_password_if_needed($user->password, $identity, $password); goto Nusth; AZ3tj: ieIg3: goto x74gR; rZMO8: Beapn: goto AkQCb; AsK2b: WpQx1: goto GuDi8; vxOpX: $this->set_message("\154\157\147\x69\156\x5f\163\x75\143\143\x65\x73\163\x66\x75\x6c"); goto TuVjR; IiBw6: $this->set_error("\154\157\x67\151\x6e\x5f\x74\151\155\145\157\x75\164"); goto cL9he; TBPvc: $this->set_error("\x6c\x6f\147\151\x6e\137\x75\156\163\165\143\x63\x65\163\163\146\x75\x6c\137\x6e\x6f\x74\x5f\x61\x63\x74\151\x76\x65"); goto hYYP2; zsrgW: if (!$this->config->item("\162\145\155\x65\155\x62\x65\x72\x5f\x75\163\145\162\x73", "\151\x6f\x6e\x5f\141\165\164\x68")) { goto YjtL5; } goto nCd32; y0KeX: $this->set_error("\x6c\x6f\147\x69\x6e\x5f\x75\156\x73\x75\143\x63\145\x73\x73\146\x75\154"); goto tN_sM; QO82O: rzOWE: goto YMeQO; neiD9: if (!$this->is_max_login_attempts_exceeded($identity)) { goto rzOWE; } goto LNTiK; y5wF2: derVL: goto PjUoh; y2QdW: $this->clear_forgotten_password_code($identity); goto zsrgW; QpJ3x: $this->trigger_events("\160\157\x73\x74\137\x6c\x6f\147\x69\x6e\137\x75\156\163\x75\x63\143\145\163\x73\x66\x75\x6c"); goto TBPvc; YMeQO: if (!($query->num_rows() === 1)) { goto xCkjJ; } goto dhIkq; XeOl2: goto derVL; goto AZ3tj; txLxI: $this->trigger_events("\x70\x6f\163\164\x5f\x6c\x6f\x67\x69\156\137\165\x6e\163\x75\x63\143\145\163\163\x66\x75\x6c"); goto y0KeX; AkQCb: $this->trigger_events("\145\170\x74\x72\x61\x5f\167\150\145\162\x65"); goto Ac1pJ; hYYP2: return FALSE; goto qDenE; N3H1T: if (!(empty($identity) || empty($password))) { goto Beapn; } goto sJMch; Z92wj: $this->increase_login_attempts($identity); goto txLxI; IggsM: $this->trigger_events("\160\162\145\137\x6c\x6f\147\151\156"); goto N3H1T; vJtSh: return FALSE; goto rZMO8; Ac1pJ: $query = $this->db->select($this->identity_column . "\54\x20\x65\x6d\141\x69\154\54\x20\151\144\54\40\x70\141\x73\163\167\157\162\144\x2c\40\141\x63\164\151\x76\145\x2c\40\154\x61\163\164\x5f\154\157\147\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\x73\x63")->get($this->tables["\165\x73\145\x72\163"]); goto neiD9; TuVjR: return TRUE; goto AsK2b; qDenE: ekzT2: goto Deu58; GuDi8: xCkjJ: goto JiTB5; PjUoh: YjtL5: goto E0P83; jfqU0: if (!($user->active == 0)) { goto ekzT2; } goto QpJ3x; Deu58: $this->set_session($user); goto VIpzQ; bAZbw: $this->clear_remember_code($identity); goto XeOl2; Nusth: $this->session->sess_regenerate(FALSE); goto CUl_F; JiTB5: $this->hash_password($password); goto Z92wj; cL9he: return FALSE; goto QO82O; rCk4C: } public function recheck_session() { goto zQeGR; eUyCE: $this->session->set_userdata("\x6c\141\x73\x74\137\143\x68\x65\143\x6b", time()); goto VPU6R; zQeGR: $recheck = NULL !== $this->config->item("\162\x65\143\x68\145\x63\x6b\137\164\x69\155\145\x72", "\x69\157\156\137\141\165\x74\150") ? $this->config->item("\162\x65\x63\x68\x65\x63\x6b\137\x74\x69\x6d\145\x72", "\x69\x6f\156\x5f\141\x75\164\150") : 0; goto HK4X6; HK4X6: if (!($recheck !== 0)) { goto Y2TK_; } goto UEDUG; xYQXZ: $identity = $this->config->item("\x69\144\x65\156\164\x69\164\171", "\151\x6f\x6e\137\141\x75\x74\x68"); goto llYUn; HUfsg: jWYi4: goto eUyCE; llYUn: $this->session->unset_userdata([$identity, "\x69\144", "\165\163\x65\x72\x5f\x69\144"]); goto MatCe; iF29s: goto zEkbU; goto HUfsg; iX89g: Y2TK_: goto lzvxn; VPU6R: zEkbU: goto d5WYm; MatCe: return FALSE; goto iF29s; pQkb5: if (!($last_login + $recheck < time())) { goto J546j; } goto NQSz3; KHSEH: if ($query->num_rows() === 1) { goto jWYi4; } goto qCYy5; d5WYm: J546j: goto iX89g; qCYy5: $this->trigger_events("\154\x6f\x67\157\165\164"); goto xYQXZ; lzvxn: return (bool) $this->session->userdata("\x69\144\145\156\164\x69\x74\x79"); goto FYftI; NQSz3: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\x64\145\156\x74\x69\x74\171"), "\x61\143\x74\151\166\145" => "\61"])->limit(1)->order_by("\x69\144", "\x64\x65\x73\x63")->get($this->tables["\x75\x73\x65\162\x73"]); goto KHSEH; UEDUG: $last_login = $this->session->userdata("\154\x61\163\164\137\143\150\145\143\153"); goto pQkb5; FYftI: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto bsAYh; J87cS: $attempts = $this->get_attempts_num($identity, $ip_address); goto rV1hy; D2dQM: KM9Cu: goto m00C8; m00C8: return FALSE; goto bOnsV; fbk29: if (!($max_attempts > 0)) { goto APyNO; } goto J87cS; qiaVT: $max_attempts = $this->config->item("\x6d\x61\170\151\x6d\x75\155\137\154\157\x67\151\x6e\137\x61\164\x74\x65\x6d\x70\x74\163", "\x69\x6f\x6e\137\141\x75\x74\x68"); goto fbk29; rV1hy: return $attempts >= $max_attempts; goto WvInS; WvInS: APyNO: goto D2dQM; bsAYh: if (!$this->config->item("\164\162\141\x63\153\137\x6c\157\147\x69\156\x5f\141\x74\x74\145\155\x70\x74\163", "\x69\x6f\156\137\x61\x75\164\150")) { goto KM9Cu; } goto qiaVT; bOnsV: } public function get_attempts_num($identity, $ip_address = NULL) { goto bF2JD; WHMY3: if (isset($ip_address)) { goto Z7IKP; } goto khchl; WMoQz: gV5yy: goto AGWWz; kqZxm: return $qres->num_rows(); goto WMoQz; khchl: $ip_address = $this->input->ip_address(); goto mFujD; Xnfuy: UcLWq: goto wDqiu; lZ35Q: if (!$this->config->item("\x74\162\x61\143\x6b\x5f\154\157\147\x69\x6e\x5f\x69\160\x5f\x61\144\144\162\x65\163\x73", "\x69\157\x6e\x5f\x61\x75\164\x68")) { goto UcLWq; } goto WHMY3; mFujD: Z7IKP: goto ibSP2; ibSP2: $this->db->where("\151\x70\137\141\x64\x64\x72\145\x73\163", $ip_address); goto Xnfuy; wDqiu: $this->db->where("\x74\x69\x6d\x65\x20\x3e", time() - $this->config->item("\x6c\157\x63\153\x6f\165\164\137\x74\151\155\x65", "\151\157\156\137\x61\165\164\150"), FALSE); goto hdQQn; YR5wO: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto lZ35Q; opw9Z: $this->db->select("\61", FALSE); goto YR5wO; bF2JD: if (!$this->config->item("\164\x72\141\x63\153\137\154\157\147\151\x6e\x5f\x61\164\x74\x65\155\x70\x74\163", "\x69\157\156\137\141\165\164\150")) { goto gV5yy; } goto opw9Z; AGWWz: return 0; goto ieKe3; hdQQn: $qres = $this->db->get($this->tables["\x6c\157\x67\151\x6e\137\141\164\164\145\155\x70\164\x73"]); goto kqZxm; ieKe3: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto c73W8; nk2_D: if (isset($ip_address)) { goto sT9gr; } goto fC8bY; BF0qi: return 0; goto I701j; vO2VC: $this->db->select("\164\x69\155\145"); goto aq8EC; fC8bY: $ip_address = $this->input->ip_address(); goto k1MVd; grJE0: mC3L5: goto BF0qi; cRHKK: $this->db->order_by("\151\144", "\144\x65\163\x63"); goto ywq_O; aq8EC: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto ig3kB; ig3kB: if (!$this->config->item("\164\x72\x61\x63\x6b\137\x6c\157\x67\151\x6e\137\x69\160\137\141\x64\144\x72\145\163\163", "\x69\x6f\x6e\x5f\141\165\164\150")) { goto JMy87; } goto nk2_D; c73W8: if (!$this->config->item("\x74\x72\141\x63\153\137\154\157\147\151\156\137\141\164\x74\145\x6d\160\x74\163", "\151\157\156\x5f\x61\x75\x74\150")) { goto mC3L5; } goto vO2VC; ywq_O: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\137\141\x74\164\x65\155\160\x74\x73"], 1); goto PzkGY; gK7vU: SzuxR: goto grJE0; k1MVd: sT9gr: goto B2XAa; YCu8K: JMy87: goto cRHKK; hQqM3: return $qres->row()->time; goto gK7vU; PzkGY: if (!($qres->num_rows() > 0)) { goto SzuxR; } goto hQqM3; B2XAa: $this->db->where("\x69\160\137\x61\144\x64\162\x65\x73\x73", $ip_address); goto YCu8K; I701j: } public function get_last_attempt_ip($identity) { goto C2d02; MFh6b: return $qres->row()->ip_address; goto MgKnS; MgKnS: UeMNf: goto nDe0k; ovIR9: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto jkrK2; jpxNe: $this->db->select("\151\160\137\x61\x64\144\x72\145\x73\x73"); goto ovIR9; C2d02: if (!($this->config->item("\164\x72\x61\x63\x6b\x5f\154\x6f\x67\151\x6e\x5f\141\x74\164\x65\155\x70\x74\x73", "\x69\157\156\x5f\x61\x75\x74\x68") && $this->config->item("\164\162\x61\143\x6b\x5f\x6c\157\147\151\156\x5f\151\x70\x5f\x61\144\x64\x72\x65\x73\x73", "\x69\x6f\156\137\x61\165\x74\150"))) { goto oY40g; } goto jpxNe; XcbZS: if (!($qres->num_rows() > 0)) { goto UeMNf; } goto MFh6b; jkrK2: $this->db->order_by("\x69\144", "\x64\145\x73\143"); goto cj4Io; nDe0k: oY40g: goto NgXNn; cj4Io: $qres = $this->db->get($this->tables["\154\157\147\x69\x6e\137\141\x74\164\x65\155\x70\x74\163"], 1); goto XcbZS; NgXNn: return ''; goto wnStk; wnStk: } public function increase_login_attempts($identity) { goto wbfeC; y2mvj: $data = ["\x69\160\137\141\x64\x64\162\x65\163\x73" => '', "\x6c\157\147\151\x6e" => $identity, "\x74\151\155\x65" => time()]; goto m7_sg; xI6Y7: return FALSE; goto EReyW; yTisS: bs7Mi: goto lr4UA; m7_sg: if (!$this->config->item("\x74\x72\x61\143\153\137\154\x6f\147\x69\x6e\x5f\x69\160\x5f\x61\144\x64\162\145\x73\x73", "\x69\157\x6e\137\x61\165\x74\x68")) { goto bs7Mi; } goto irrHp; MRqZb: Wg5Zi: goto xI6Y7; irrHp: $data["\151\x70\x5f\x61\144\x64\162\145\163\163"] = $this->input->ip_address(); goto yTisS; wbfeC: if (!$this->config->item("\164\x72\141\x63\x6b\x5f\154\x6f\147\151\x6e\x5f\141\x74\164\145\155\x70\164\x73", "\x69\x6f\156\x5f\141\165\x74\x68")) { goto Wg5Zi; } goto y2mvj; lr4UA: return $this->db->insert($this->tables["\154\157\x67\x69\x6e\137\141\x74\164\x65\x6d\160\x74\163"], $data); goto MRqZb; EReyW: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto EKYfQ; XX66y: GO5fr: goto poER6; L__2g: return $this->db->delete($this->tables["\154\157\147\x69\x6e\x5f\141\164\x74\x65\x6d\160\164\x73"]); goto gauAO; k0uzv: iC0TD: goto fYQK1; nX942: $ip_address = $this->input->ip_address(); goto XX66y; fYQK1: $this->db->or_where("\x74\x69\x6d\x65\40\x3c", time() - $old_attempts_expire_period, FALSE); goto L__2g; ZqgfL: return FALSE; goto kexbv; NNMte: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\143\x6b\157\165\x74\x5f\164\x69\155\x65", "\151\x6f\156\137\x61\165\x74\x68")); goto jqjqO; gauAO: ZauV8: goto ZqgfL; jqjqO: $this->db->where("\x6c\157\147\x69\156", $identity); goto KaGeq; EKYfQ: if (!$this->config->item("\164\162\141\143\153\137\x6c\x6f\x67\x69\156\137\141\164\x74\145\155\160\x74\x73", "\151\157\x6e\x5f\141\x75\164\x68")) { goto ZauV8; } goto NNMte; KaGeq: if (!$this->config->item("\164\x72\141\143\x6b\137\154\x6f\x67\x69\x6e\137\151\160\x5f\141\x64\x64\x72\145\x73\x73", "\x69\x6f\156\x5f\x61\x75\164\150")) { goto iC0TD; } goto rGOxZ; poER6: $this->db->where("\x69\x70\x5f\x61\x64\144\x72\145\163\163", $ip_address); goto k0uzv; rGOxZ: if (isset($ip_address)) { goto GO5fr; } goto nX942; kexbv: } public function limit($limit) { goto G_vce; tWESF: return $this; goto JbCFM; G_vce: $this->trigger_events("\154\x69\155\x69\164"); goto Tuca5; Tuca5: $this->_ion_limit = $limit; goto tWESF; JbCFM: } public function offset($offset) { goto H0hZC; jJ6CO: return $this; goto A2BGl; H0hZC: $this->trigger_events("\x6f\x66\146\x73\x65\x74"); goto HWqFN; HWqFN: $this->_ion_offset = $offset; goto jJ6CO; A2BGl: } public function where($where, $value = NULL) { goto QqkX6; YISJi: array_push($this->_ion_where, $where); goto gpwoJ; gpwoJ: return $this; goto OAl_i; QqkX6: $this->trigger_events("\167\x68\x65\x72\145"); goto I2I3h; K3VUn: $where = [$where => $value]; goto DrGDL; DrGDL: wR8ak: goto YISJi; I2I3h: if (is_array($where)) { goto wR8ak; } goto K3VUn; OAl_i: } public function like($like, $value = NULL, $position = "\142\157\164\150") { goto hd6Nv; hd6Nv: $this->trigger_events("\x6c\x69\153\145"); goto sT0Rb; sT0Rb: array_push($this->_ion_like, ["\x6c\151\153\145" => $like, "\x76\141\x6c\165\x65" => $value, "\160\x6f\163\x69\164\151\x6f\156" => $position]); goto tdxfg; tdxfg: return $this; goto zHW4J; zHW4J: } public function select($select) { goto bTND4; bTND4: $this->trigger_events("\163\x65\154\145\x63\164"); goto p1OFm; cqgHG: return $this; goto owr2N; p1OFm: $this->_ion_select[] = $select; goto cqgHG; owr2N: } public function order_by($by, $order = "\144\x65\x73\143") { goto ECAzm; p116h: $this->_ion_order = $order; goto RUGp0; ECAzm: $this->trigger_events("\x6f\x72\x64\x65\x72\x5f\x62\x79"); goto GgK_s; RUGp0: return $this; goto IXRow; GgK_s: $this->_ion_order_by = $by; goto p116h; IXRow: } public function row() { goto OCXpI; OCXpI: $this->trigger_events("\162\x6f\x77"); goto pU7oY; pU7oY: $row = $this->response->row(); goto Pn0Mb; Pn0Mb: return $row; goto zgPdu; zgPdu: } public function row_array() { goto w53bK; i2UBr: $row = $this->response->row_array(); goto VpekC; w53bK: $this->trigger_events(["\162\x6f\x77", "\162\x6f\167\137\141\x72\162\x61\x79"]); goto i2UBr; VpekC: return $row; goto Xwjbj; Xwjbj: } public function result() { goto J6xJr; J6xJr: $this->trigger_events("\x72\x65\x73\x75\x6c\x74"); goto NSrZ5; NSrZ5: $result = $this->response->result(); goto JE7ZT; JE7ZT: return $result; goto KGdLQ; KGdLQ: } public function result_array() { goto InBBO; e0zC_: $result = $this->response->result_array(); goto WFDEi; InBBO: $this->trigger_events(["\x72\145\163\165\154\x74", "\x72\145\163\165\x6c\x74\137\141\162\162\141\171"]); goto e0zC_; WFDEi: return $result; goto GIilu; GIilu: } public function num_rows() { goto sDpRR; h0xSP: return $result; goto VK5PK; LBeN_: $result = $this->response->num_rows(); goto h0xSP; sDpRR: $this->trigger_events(["\156\x75\x6d\x5f\162\157\x77\163"]); goto LBeN_; VK5PK: } public function users($groups = NULL) { goto zWILE; zG0lv: foreach ($this->_ion_where as $where) { $this->db->where($where); VZSRJ: } goto MACTA; X_8z0: I1IBl: goto WQTqy; Fs7JG: $group_ids = []; goto nnz7g; EBcHT: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto ouHGX; } goto cVZTv; SVdpa: ouHGX: goto oFKYN; L6IhE: foreach ($groups as $group) { goto RVFEX; mCud3: o4aI2: goto EBEWq; EBEWq: $group_ids[] = $group; goto ah3Xm; GwVUz: goto aKP4J; goto mCud3; RVFEX: if (is_numeric($group)) { goto o4aI2; } goto Z7DMe; Z7DMe: $group_names[] = $group; goto GwVUz; ah3Xm: aKP4J: goto tlbHj; tlbHj: tMoP2: goto YS2Ph; YS2Ph: } goto Z8m3v; IIJCg: EtGuc: goto Fs7JG; MACTA: dXfOb: goto A3OFB; OU9kJ: $groups = [$groups]; goto J39JB; etu_P: if (is_array($groups)) { goto nef1u; } goto OU9kJ; nimQw: $this->_ion_like = []; goto IXByj; IXByj: lIa6m: goto ybbPH; GWhIu: $this->db->join($this->tables["\x75\163\x65\x72\x73\x5f\x67\162\x6f\165\x70\163"], $this->tables["\x75\163\145\x72\163\x5f\x67\x72\x6f\165\x70\x73"] . "\x2e" . $this->join["\165\163\x65\162\x73"] . "\x3d" . $this->tables["\165\163\x65\x72\x73"] . "\56\151\x64", "\x69\x6e\x6e\x65\x72"); goto IIJCg; Ktcsd: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\151\x6b\x65"], $like["\166\141\x6c\x75\x65"], $like["\160\x6f\163\x69\x74\x69\157\156"]); RRxXA: } goto amzVG; Bt6oG: $this->_ion_limit = NULL; goto IKhIR; QmNoz: DAo29: goto UVXfe; OYK6j: edUSK: goto vbpXq; q_Xd1: $this->_ion_limit = NULL; goto dHLWi; aWK0w: jfWZL: goto EBcHT; o7EPM: foreach ($this->_ion_select as $select) { $this->db->select($select); fo005: } goto OYK6j; oFKYN: $this->response = $this->db->get($this->tables["\165\x73\145\x72\x73"]); goto S9QCv; w1rAG: if (empty($group_names)) { goto DAo29; } goto L38R_; TWzGF: jp5fA: goto lfu9s; IKhIR: $this->_ion_offset = NULL; goto aWK0w; v5LhK: Pck3w: goto iHKHh; Bic4P: if (!(isset($groups) && !empty($groups))) { goto EtGuc; } goto jqbTV; WQTqy: if (!isset($groups)) { goto Pck3w; } goto etu_P; y8HOu: $this->_ion_order_by = NULL; goto SVdpa; zPbr2: $this->db->where_in($this->tables["\x67\x72\x6f\165\x70\x73"] . "\56\156\x61\x6d\x65", $group_names); goto QmNoz; cVZTv: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto UUJm9; S9QCv: return $this; goto hLFRa; UVXfe: if (empty($group_ids)) { goto okKJl; } goto AB8zK; A3OFB: $this->_ion_where = []; goto TWzGF; iHKHh: $this->trigger_events("\145\170\164\162\x61\137\x77\150\145\x72\145"); goto gmgPp; nnz7g: $group_names = []; goto L6IhE; xi2X2: m5PUF: goto uMRY9; L38R_: $this->db->join($this->tables["\147\x72\x6f\165\x70\x73"], $this->tables["\x75\x73\145\162\163\x5f\147\162\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x67\x72\x6f\165\160\x73"] . "\x20\x3d\x20" . $this->tables["\147\162\157\x75\x70\x73"] . "\x2e\x69\144", "\x69\156\x6e\x65\x72"); goto zPbr2; uMRY9: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto Bt6oG; bgkJN: goto jfWZL; goto xi2X2; vbpXq: $this->_ion_select = []; goto X_8z0; amzVG: dQYom: goto nimQw; h4kae: okKJl: goto v5LhK; gmgPp: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto jp5fA; } goto zG0lv; zxI4z: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto pflJa; } goto GHmSk; UUJm9: $this->_ion_order = NULL; goto y8HOu; jqbTV: $this->db->distinct(); goto GWhIu; AB8zK: $this->db->{$or_where_in}($this->tables["\x75\163\145\x72\x73\137\147\x72\157\165\160\163"] . "\x2e" . $this->join["\x67\162\x6f\165\x70\x73"], $group_ids); goto h4kae; ybbPH: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto m5PUF; } goto iZM5l; Z8m3v: X8LEo: goto iU2wW; dHLWi: f0XQF: goto bgkJN; GHmSk: $this->db->select([$this->tables["\x75\163\145\162\163"] . "\56\52", $this->tables["\x75\x73\145\x72\163"] . "\x2e\151\144\x20\x61\163\40\151\x64", $this->tables["\165\x73\145\x72\x73"] . "\56\151\144\40\x61\x73\40\165\x73\145\162\137\x69\x64"]); goto fJDho; J39JB: nef1u: goto Bic4P; fJDho: goto I1IBl; goto dTfNc; dTfNc: pflJa: goto o7EPM; iU2wW: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\x5f\x77\150\x65\162\145\x5f\151\156" : "\167\150\x65\162\x65\137\x69\x6e"; goto w1rAG; iZM5l: if (!isset($this->_ion_limit)) { goto f0XQF; } goto I2VHc; I2VHc: $this->db->limit($this->_ion_limit); goto q_Xd1; lfu9s: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto lIa6m; } goto Ktcsd; zWILE: $this->trigger_events("\165\x73\145\162\x73"); goto zxI4z; hLFRa: } public function user($id = NULL) { goto ri8in; RkmBe: $this->order_by($this->tables["\165\163\x65\x72\163"] . "\x2e\151\x64", "\144\145\163\x63"); goto VKFBS; ri8in: $this->trigger_events("\x75\163\x65\x72"); goto qFocc; VKFBS: $this->where($this->tables["\x75\x73\x65\162\163"] . "\x2e\151\x64", $id); goto a6ciz; WpvRR: $this->limit(1); goto RkmBe; qFocc: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\145\162\137\151\x64"); goto WpvRR; a6ciz: $this->users(); goto UPywW; UPywW: return $this; goto xvPOM; xvPOM: } public function get_users_groups($id = FALSE) { goto NSSiS; AMLPF: return $this->db->select($this->tables["\165\x73\x65\162\x73\137\147\162\157\x75\x70\163"] . "\x2e" . $this->join["\x67\162\157\x75\x70\x73"] . "\x20\141\163\40\151\x64\54\40" . $this->tables["\x67\162\x6f\165\x70\163"] . "\x2e\156\x61\x6d\145\x2c\x20" . $this->tables["\x67\x72\157\x75\160\163"] . "\x2e\x64\145\x73\x63\x72\x69\x70\164\x69\157\156")->where($this->tables["\x75\x73\145\x72\x73\x5f\147\x72\157\x75\x70\x73"] . "\56" . $this->join["\x75\x73\x65\x72\x73"], $id)->join($this->tables["\147\x72\x6f\165\160\x73"], $this->tables["\165\163\x65\x72\x73\x5f\x67\162\157\x75\x70\163"] . "\56" . $this->join["\x67\x72\x6f\165\x70\x73"] . "\75" . $this->tables["\x67\162\x6f\x75\160\x73"] . "\x2e\x69\x64")->get($this->tables["\x75\163\x65\162\x73\x5f\x67\x72\157\165\x70\x73"]); goto s5VCt; EDucT: $id || ($id = $this->session->userdata("\165\163\145\162\137\151\x64")); goto AMLPF; NSSiS: $this->trigger_events("\147\x65\164\x5f\165\163\x65\162\163\x5f\x67\x72\157\165\160"); goto EDucT; s5VCt: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto ZN9Tc; CGpbu: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; a60zm: } goto HBWDS; mBATs: if (is_array($check_group)) { goto LJhCU; } goto Rb5Nx; ZN9Tc: $this->trigger_events("\151\156\x5f\147\162\157\165\x70"); goto O9zKT; zL3F9: foreach ($check_group as $key => $value) { goto D0U6E; Snyxj: if (!(in_array($value, $groups) xor $check_all)) { goto m8hA6; } goto pevFn; pevFn: return !$check_all; goto iOa96; D0U6E: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto Snyxj; TZavr: fjDh1: goto tEHCp; iOa96: m8hA6: goto TZavr; tEHCp: } goto uhMrJ; F3kvS: $groups_array = []; goto CGpbu; F4pHJ: $groups_array = $this->_cache_user_in_group[$id]; goto yqi5z; O9zKT: $id || ($id = $this->session->userdata("\x75\163\145\x72\x5f\x69\144")); goto mBATs; g8jjb: $users_groups = $this->get_users_groups($id)->result(); goto F3kvS; UM6mz: goto Ue0kc; goto l2TlL; uhMrJ: FKL7K: goto Cxoxf; l2TlL: JVEOM: goto F4pHJ; yqi5z: Ue0kc: goto zL3F9; gBM1V: if (isset($this->_cache_user_in_group[$id])) { goto JVEOM; } goto g8jjb; noNgb: LJhCU: goto gBM1V; HBWDS: hXLxj: goto sJtfP; Rb5Nx: $check_group = [$check_group]; goto noNgb; sJtfP: $this->_cache_user_in_group[$id] = $groups_array; goto UM6mz; Cxoxf: return $check_all; goto I8zlb; I8zlb: } public function add_to_group($group_ids, $user_id = FALSE) { goto rCqFR; NRE7Z: if (is_array($group_ids)) { goto L_qN_; } goto f4kBb; tuH06: foreach ($group_ids as $group_id) { goto gQqhs; meWqa: EHIcN: goto qboGo; gjlFf: if (isset($this->_cache_groups[$group_id])) { goto qYWLq; } goto PsYfD; gQqhs: if (!$this->db->insert($this->tables["\165\x73\145\162\x73\x5f\x67\x72\x6f\165\x70\163"], [$this->join["\x67\162\x6f\x75\160\x73"] => (float) $group_id, $this->join["\165\x73\145\162\163"] => (float) $user_id])) { goto hJKgj; } goto gjlFf; KQ7Ut: g641N: goto VI65f; FocSC: qYWLq: goto yM48n; PsYfD: $group = $this->group($group_id)->result(); goto Nyu1N; xO4ck: hJKgj: goto meWqa; uLREl: goto g641N; goto FocSC; Vol0l: $this->_cache_groups[$group_id] = $group_name; goto uLREl; yM48n: $group_name = $this->_cache_groups[$group_id]; goto KQ7Ut; Nyu1N: $group_name = $group[0]->name; goto Vol0l; VI65f: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto AcewC; AcewC: $return++; goto xO4ck; qboGo: } goto BDakZ; rCqFR: $this->trigger_events("\141\144\144\x5f\164\157\137\147\x72\x6f\165\160"); goto Gh_rk; f4kBb: $group_ids = [$group_ids]; goto yWk2Q; Gh_rk: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\162\137\151\x64")); goto NRE7Z; yWk2Q: L_qN_: goto r8MrA; r8MrA: $return = 0; goto tuH06; IKe2B: return $return; goto GDHXj; BDakZ: V4h9R: goto IKe2B; GDHXj: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto eO9Kn; kM1yh: goto dmsNX; goto P3280; kMxRY: $return = TRUE; goto mRsqr; eO9Kn: $this->trigger_events("\x72\145\155\x6f\x76\145\x5f\x66\162\x6f\x6d\x5f\147\x72\x6f\165\x70"); goto NPR2l; Xw263: eyOGJ: goto nidzh; JkSKI: PYQnl: goto kM1yh; nidzh: foreach ($group_ids as $group_id) { goto VcBny; eC1jH: GXD0m: goto PFbuO; jX7Cc: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto u2TmN; } goto Gk5w0; N4g5e: u2TmN: goto eC1jH; VcBny: $this->db->delete($this->tables["\165\163\x65\x72\x73\x5f\x67\x72\x6f\165\160\163"], [$this->join["\147\x72\157\165\x70\163"] => (float) $group_id, $this->join["\x75\163\145\162\x73"] => (float) $user_id]); goto jX7Cc; Gk5w0: unset($this->_cache_user_in_group[$user_id][$group_id]); goto N4g5e; PFbuO: } goto B3GaA; B3GaA: RbZLy: goto kMxRY; BSNL5: $this->_cache_user_in_group[$user_id] = []; goto JkSKI; WQBa6: Uw1lK: goto HRNWT; mRsqr: dmsNX: goto WCH3u; JiFzz: if (is_array($group_ids)) { goto eyOGJ; } goto N38fV; qR3Ct: if (!($return = $this->db->delete($this->tables["\x75\163\x65\x72\163\137\x67\162\x6f\165\x70\x73"], [$this->join["\165\x73\x65\162\x73"] => (float) $user_id]))) { goto PYQnl; } goto BSNL5; NPR2l: if (!empty($user_id)) { goto Uw1lK; } goto h4ygi; WCH3u: return $return; goto H_y60; N38fV: $group_ids = [$group_ids]; goto Xw263; P3280: LKUd6: goto JiFzz; h4ygi: return FALSE; goto WQBa6; HRNWT: if (!empty($group_ids)) { goto LKUd6; } goto qR3Ct; H_y60: } public function groups() { goto t_cTB; MZIdA: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto BARuz; } goto y0o6M; Jfjds: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto FgZr2; wqlFZ: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto RYn7w; Xo94a: return $this; goto NKHh0; fIon8: goto gDo70; goto pfG25; y0o6M: if (!isset($this->_ion_limit)) { goto FfM_4; } goto v2a9X; v2a9X: $this->db->limit($this->_ion_limit); goto bu4Nw; ZE1cF: gDo70: goto EzYOI; t_cTB: $this->trigger_events("\x67\x72\x6f\x75\160\163"); goto iL39O; pfG25: BARuz: goto Jfjds; DRbyj: FfM_4: goto fIon8; sdFMt: foreach ($this->_ion_where as $where) { $this->db->where($where); nslQE: } goto dRXid; EzYOI: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto Bt7MM; } goto wqlFZ; LlKIu: $this->_ion_offset = NULL; goto ZE1cF; mO9on: VEckw: goto MZIdA; bu4Nw: $this->_ion_limit = NULL; goto DRbyj; GHk0y: $this->response = $this->db->get($this->tables["\x67\x72\157\165\160\163"]); goto Xo94a; RYn7w: Bt7MM: goto GHk0y; Jasy9: $this->_ion_where = []; goto mO9on; FgZr2: $this->_ion_limit = NULL; goto LlKIu; dRXid: RQK00: goto Jasy9; iL39O: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto VEckw; } goto sdFMt; NKHh0: } public function group($id = NULL) { goto CjACL; GKYBd: $this->limit(1); goto ZcgdE; A2wQv: return $this->groups(); goto ETar4; TQBpH: crvMy: goto GKYBd; AbLID: $this->where($this->tables["\x67\162\x6f\x75\x70\x73"] . "\x2e\x69\144", $id); goto TQBpH; ZcgdE: $this->order_by("\x69\144", "\x64\x65\163\143"); goto A2wQv; CjACL: $this->trigger_events("\147\162\157\165\160"); goto MJ7Kl; MJ7Kl: if (!isset($id)) { goto crvMy; } goto AbLID; ETar4: } public function update($id, array $data) { goto Wd65e; XHxYR: return TRUE; goto eMuIy; B0KX3: $this->db->trans_rollback(); goto RUSai; UPrn0: if (!($this->db->trans_status() === FALSE)) { goto Wovdq; } goto echRW; NUvgt: $this->trigger_events(["\x70\x6f\x73\164\x5f\x75\160\x64\x61\164\x65\137\x75\x73\x65\x72", "\160\x6f\x73\x74\137\x75\160\144\141\x74\145\137\165\x73\145\x72\137\165\156\163\x75\x63\143\x65\163\x73\x66\x75\154"]); goto KIXQd; o6ag0: $this->set_error("\x61\x63\x63\157\165\x6e\x74\x5f\143\x72\x65\141\164\151\x6f\156\137\x64\165\x70\x6c\151\143\x61\x74\x65\x5f\x69\144\145\156\164\151\164\171"); goto NUvgt; KIXQd: $this->set_error("\x75\160\144\x61\164\x65\137\165\156\x73\x75\143\143\145\163\163\146\x75\154"); goto NNClY; NNClY: return FALSE; goto Whqbm; sRW6I: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto WxkLc; } goto kqK50; RmnC0: goto TbcEa; goto qrSH7; fUNoU: XBGoM: goto kreEQ; Pv3Za: $this->trigger_events(["\x70\x6f\163\164\x5f\x75\160\144\x61\x74\145\x5f\x75\163\145\162", "\160\157\163\x74\137\165\x70\x64\141\x74\x65\x5f\x75\x73\x65\x72\137\165\x6e\x73\x75\x63\x63\145\x73\x73\146\165\154"]); goto l1dF0; ZW1AQ: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, ["\x69\144" => $user->id]); goto UPrn0; Nzj_j: $this->trigger_events("\145\170\164\162\141\x5f\167\150\x65\x72\145"); goto ZW1AQ; nX6Ql: unset($data["\x70\x61\x73\163\x77\x6f\x72\144"]); goto RmnC0; UXyVh: $this->set_error("\x75\160\x64\141\x74\145\x5f\x75\x6e\163\x75\143\x63\145\163\x73\x66\165\x6c"); goto pp88G; zm28c: return FALSE; goto xnkt9; tAzGH: $user = $this->user($id)->row(); goto aEeR3; pp88G: return FALSE; goto fUNoU; cEL3a: $this->set_message("\165\160\144\141\164\145\x5f\163\165\x63\143\x65\x73\x73\146\165\154"); goto XHxYR; kqK50: $this->db->trans_rollback(); goto o6ag0; qrSH7: gb8uC: goto Ebl23; hJ10c: tBAkq: goto CANaM; Wd65e: $this->trigger_events("\x70\x72\x65\137\165\160\144\141\164\x65\137\165\x73\x65\162"); goto tAzGH; kreEQ: TbcEa: goto hJ10c; CANaM: hI0bl: goto Nzj_j; Whqbm: WxkLc: goto SfwMI; RUSai: $this->trigger_events(["\160\157\163\164\x5f\x75\160\144\x61\164\x65\x5f\165\163\145\x72", "\x70\x6f\163\x74\137\x75\x70\144\141\x74\145\137\165\163\x65\162\x5f\165\x6e\163\165\x63\143\x65\x73\163\146\165\x6c"]); goto UXyVh; xnkt9: Wovdq: goto MDDOc; DkEVB: if (!($data["\x70\141\163\163\167\157\162\x64"] === FALSE)) { goto XBGoM; } goto B0KX3; echRW: $this->db->trans_rollback(); goto Pv3Za; aEeR3: $this->db->trans_begin(); goto sRW6I; NFD06: $this->trigger_events(["\x70\157\x73\164\x5f\165\160\x64\141\164\x65\x5f\165\x73\145\x72", "\160\157\x73\164\137\x75\x70\x64\141\x74\145\x5f\x75\x73\x65\162\137\163\x75\143\143\x65\x73\163\x66\x75\154"]); goto cEL3a; MDDOc: $this->db->trans_commit(); goto NFD06; U47eF: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\x73\167\157\162\144", $data) || array_key_exists("\145\155\x61\x69\154", $data))) { goto hI0bl; } goto l3Hcm; eMCxn: if (!empty($data["\160\141\163\163\167\x6f\x72\x64"])) { goto gb8uC; } goto nX6Ql; l1dF0: $this->set_error("\x75\160\144\141\x74\x65\137\x75\x6e\163\165\143\x63\x65\x73\163\146\165\x6c"); goto zm28c; Ebl23: $data["\x70\x61\163\163\167\157\162\144"] = $this->hash_password($data["\x70\141\163\x73\x77\157\x72\x64"], $user->{$this->identity_column}); goto DkEVB; l3Hcm: if (!array_key_exists("\x70\141\x73\163\167\x6f\162\x64", $data)) { goto tBAkq; } goto eMCxn; SfwMI: $data = $this->_filter_data($this->tables["\165\x73\145\162\x73"], $data); goto U47eF; eMuIy: } public function delete_user($id) { goto B7Lli; GE2p1: $this->db->delete($this->tables["\165\x73\145\x72\x73"], ["\x69\x64" => $id]); goto v07Tv; YCuU2: $this->trigger_events(["\x70\157\x73\164\x5f\x64\x65\154\x65\164\x65\x5f\x75\x73\145\162", "\160\x6f\163\x74\x5f\x64\x65\x6c\145\164\x65\x5f\165\x73\x65\x72\x5f\x73\165\x63\x63\x65\x73\163\146\x75\x6c"]); goto pbddn; pbddn: $this->set_message("\x64\145\154\x65\x74\x65\x5f\x73\x75\x63\x63\x65\163\163\x66\165\x6c"); goto JBoSU; JBoSU: return TRUE; goto HrqUC; QgWUO: $this->trigger_events(["\160\157\163\164\137\x64\x65\x6c\x65\x74\145\x5f\x75\163\x65\x72", "\x70\157\163\x74\137\144\145\x6c\x65\164\x65\137\x75\163\x65\162\137\165\x6e\x73\165\x63\x63\145\x73\x73\x66\x75\154"]); goto r0ZAi; B7Lli: $this->trigger_events("\x70\x72\x65\x5f\x64\x65\154\x65\x74\145\137\x75\163\x65\x72"); goto l_rPI; P1GVl: return FALSE; goto db4rm; aTvlE: $this->db->trans_commit(); goto YCuU2; vtu8P: $this->remove_from_group(NULL, $id); goto GE2p1; l_rPI: $this->db->trans_begin(); goto vtu8P; db4rm: ZqezM: goto aTvlE; v07Tv: if (!($this->db->trans_status() === FALSE)) { goto ZqezM; } goto KLYtg; r0ZAi: $this->set_error("\x64\145\x6c\x65\x74\145\x5f\x75\x6e\163\165\143\x63\145\x73\x73\x66\x75\154"); goto P1GVl; KLYtg: $this->db->trans_rollback(); goto QgWUO; HrqUC: } public function update_last_login($id) { goto H8WtC; an4ke: $this->trigger_events("\x65\x78\164\x72\141\137\x77\x68\145\x72\x65"); goto DUxAD; DUxAD: $this->db->update($this->tables["\x75\x73\x65\x72\163"], ["\x6c\141\x73\164\137\154\157\x67\151\x6e" => time()], ["\x69\x64" => $id]); goto iTOYu; iTOYu: return $this->db->affected_rows() == 1; goto f0XLa; H8WtC: $this->trigger_events("\x75\160\144\141\x74\145\x5f\154\x61\163\164\x5f\x6c\157\147\x69\x6e"); goto ja5LX; ja5LX: $this->load->helper("\x64\141\x74\x65"); goto an4ke; f0XLa: } public function set_lang($lang = "\145\x6e") { goto Tbk3n; Ta8zl: $expire = self::MAX_COOKIE_LIFETIME; goto tVkrE; wO4Mz: n0e2R: goto Ta8zl; KRTHz: return TRUE; goto HTO5g; KG6hv: set_cookie(["\156\x61\x6d\145" => "\x6c\141\156\x67\137\143\x6f\x64\145", "\x76\141\x6c\165\x65" => $lang, "\x65\x78\160\x69\162\x65" => $expire]); goto KRTHz; DYqj_: if ($this->config->item("\x75\x73\x65\162\x5f\145\170\160\151\x72\x65", "\151\157\156\x5f\141\165\164\150") === 0) { goto n0e2R; } goto UQsGg; Tbk3n: $this->trigger_events("\x73\x65\164\x5f\154\141\x6e\147"); goto DYqj_; TdE7Q: goto mjnyz; goto wO4Mz; tVkrE: mjnyz: goto KG6hv; UQsGg: $expire = $this->config->item("\x75\x73\145\x72\137\145\170\x70\x69\162\x65", "\151\x6f\156\137\x61\x75\x74\150"); goto TdE7Q; HTO5g: } public function set_session($user) { goto UEzji; j1qia: $this->trigger_events("\x70\x6f\x73\164\x5f\x73\x65\x74\137\x73\x65\x73\163\x69\x6f\x6e"); goto SXN5D; Q63O_: $session_data = ["\x69\144\x65\x6e\x74\x69\x74\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\151\x6c" => $user->email, "\x75\x73\145\x72\137\151\144" => $user->id, "\157\154\x64\137\154\x61\x73\164\137\x6c\157\x67\151\156" => $user->last_login, "\154\x61\163\x74\137\x63\150\145\143\x6b" => time()]; goto IpgtH; IpgtH: $this->session->set_userdata($session_data); goto j1qia; SXN5D: return TRUE; goto u2dHU; UEzji: $this->trigger_events("\x70\x72\x65\x5f\x73\x65\164\x5f\x73\145\x73\163\x69\x6f\x6e"); goto Q63O_; u2dHU: } public function remember_user($identity) { goto epEcC; Zk2ok: if (!($this->db->affected_rows() > -1)) { goto gXRig; } goto XldB1; LUU8v: $this->trigger_events(["\160\x6f\163\x74\137\x72\145\155\x65\155\142\145\162\x5f\165\163\x65\162", "\162\145\155\145\x6d\x62\145\x72\x5f\165\x73\145\162\137\x73\x75\143\x63\145\x73\163\x66\165\x6c"]); goto urkNi; DNBuB: if (!$token->validator_hashed) { goto zpALR; } goto MrrVa; JhlMV: gXRig: goto EuqbF; Ot2hk: wmdTP: goto OSbUd; On2bO: $expire = $this->config->item("\165\x73\x65\x72\x5f\145\170\160\x69\x72\x65", "\x69\157\x6e\137\x61\x75\164\150"); goto h1HZq; VAHrO: $token = $this->_generate_selector_validator_couple(); goto DNBuB; X9pIm: return FALSE; goto kN5wZ; GTdfl: return FALSE; goto Sfg8K; urkNi: return TRUE; goto JhlMV; e6lua: if ($identity) { goto QDi8N; } goto X9pIm; MrrVa: $this->db->update($this->tables["\165\x73\145\162\163"], ["\x72\145\155\145\155\142\145\162\137\x73\x65\154\x65\143\164\157\x72" => $token->selector, "\162\145\x6d\145\x6d\142\145\x72\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto Zk2ok; RacUU: $this->trigger_events(["\x70\157\x73\164\137\x72\x65\155\145\x6d\x62\x65\x72\137\x75\163\x65\162", "\162\x65\x6d\x65\155\142\145\162\x5f\165\163\145\162\137\165\156\x73\165\143\143\145\x73\163\146\x75\x6c"]); goto GTdfl; epEcC: $this->trigger_events("\x70\x72\145\x5f\162\145\155\145\155\142\x65\162\x5f\x75\163\x65\162"); goto e6lua; XldB1: if ($this->config->item("\165\163\145\x72\x5f\145\x78\x70\x69\x72\x65", "\151\x6f\156\137\x61\x75\x74\150") === 0) { goto wmdTP; } goto On2bO; h1HZq: goto R6Gr0; goto Ot2hk; kJ1ow: R6Gr0: goto Xzgaj; kN5wZ: QDi8N: goto VAHrO; Xzgaj: set_cookie(["\x6e\141\155\x65" => $this->config->item("\x72\x65\155\x65\155\142\145\162\137\x63\157\x6f\153\x69\x65\137\x6e\x61\x6d\x65", "\151\157\x6e\137\x61\165\164\x68"), "\x76\141\154\165\x65" => $token->user_code, "\145\170\160\151\162\x65" => $expire]); goto LUU8v; EuqbF: zpALR: goto RacUU; OSbUd: $expire = self::MAX_COOKIE_LIFETIME; goto kJ1ow; Sfg8K: } public function login_remembered_user() { goto Y2o4g; xdiTV: E21gu: goto Bwos2; ecOyA: if (!$this->config->item("\x75\x73\145\162\137\145\170\164\145\156\x64\x5f\157\156\137\x6c\x6f\x67\151\156", "\x69\157\x6e\137\x61\165\164\x68")) { goto KHED1; } goto UxDV7; r0C5u: return FALSE; goto u58x6; xpCEp: KHED1: goto m7gqh; Y2o4g: $this->trigger_events("\x70\x72\145\137\154\157\147\x69\156\x5f\x72\x65\x6d\145\x6d\x62\145\x72\x65\144\137\165\163\145\162"); goto lYDH6; GqiSG: if (!($query->num_rows() === 1)) { goto E21gu; } goto k1swi; ghUHg: $this->clear_forgotten_password_code($identity); goto ecOyA; u58x6: dyOZS: goto JTN73; tdSRY: return FALSE; goto n1Db4; sRFMo: return TRUE; goto s3hd0; EBGHV: $this->trigger_events(["\160\157\163\x74\x5f\154\x6f\147\151\x6e\x5f\x72\x65\155\x65\155\x62\x65\162\145\x64\137\x75\x73\x65\162", "\160\x6f\163\164\x5f\154\157\x67\x69\x6e\137\162\145\155\145\x6d\142\x65\162\145\144\x5f\x75\x73\145\x72\x5f\165\156\x73\x75\x63\143\x65\x73\163\146\x75\x6c"]); goto r0C5u; smGR2: $this->trigger_events(["\x70\x6f\163\x74\137\154\157\x67\151\156\137\162\x65\155\x65\x6d\x62\145\x72\x65\144\x5f\x75\x73\145\162", "\160\157\163\164\137\x6c\157\147\x69\x6e\x5f\x72\145\155\x65\155\x62\x65\162\x65\x64\137\x75\163\145\x72\x5f\x73\165\143\x63\x65\x73\163\x66\x75\154"]); goto sRFMo; Bwos2: delete_cookie($this->config->item("\162\145\155\x65\x6d\142\x65\x72\137\143\x6f\x6f\x6b\x69\x65\x5f\x6e\x61\x6d\145", "\151\157\x6e\x5f\141\165\x74\x68")); goto qcxBE; MlPee: if (!($token === FALSE)) { goto dyOZS; } goto EBGHV; lYDH6: $remember_cookie = get_cookie($this->config->item("\x72\x65\x6d\145\155\142\x65\162\137\143\157\157\x6b\x69\x65\x5f\156\x61\x6d\x65", "\x69\x6f\156\137\141\165\164\150")); goto Zr6S3; h6TUB: $query = $this->db->select($this->identity_column . "\54\x20\x69\144\54\x20\x65\155\x61\151\x6c\x2c\x20\x72\145\155\x65\155\142\x65\162\x5f\143\157\x64\x65\x2c\40\x6c\141\x73\164\137\x6c\157\x67\x69\156")->where("\x72\x65\155\x65\155\x62\x65\162\137\x73\x65\154\x65\143\x74\x6f\162", $token->selector)->where("\141\x63\164\x69\166\x65", 1)->limit(1)->get($this->tables["\165\x73\x65\162\163"]); goto GqiSG; qcxBE: $this->trigger_events(["\160\157\163\164\137\154\157\147\151\156\x5f\162\145\x6d\x65\155\x62\145\x72\145\x64\x5f\165\163\145\162", "\160\157\163\x74\137\x6c\157\147\151\156\x5f\x72\145\x6d\145\155\x62\145\162\145\x64\137\165\163\x65\162\137\165\x6e\x73\165\143\x63\x65\163\163\146\165\154"]); goto tdSRY; m7gqh: $this->session->sess_regenerate(FALSE); goto smGR2; v0Vfb: $this->update_last_login($user->id); goto o6_QU; VmFso: $identity = $user->{$this->identity_column}; goto gHf0H; UxDV7: $this->remember_user($identity); goto xpCEp; s3hd0: ls4tD: goto xdiTV; gHf0H: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto ls4tD; } goto v0Vfb; k1swi: $user = $query->row(); goto VmFso; Zr6S3: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto MlPee; o6_QU: $this->set_session($user); goto ghUHg; JTN73: $this->trigger_events("\x65\170\x74\162\141\x5f\167\150\x65\162\145"); goto h6TUB; n1Db4: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto PM9nq; HwbxQ: $this->set_message("\147\162\x6f\x75\x70\137\x63\162\145\x61\164\x69\157\156\x5f\x73\165\143\143\145\x73\x73\x66\165\x6c"); goto rNDNh; bCAg8: zK1KE: goto nuQh0; S7fMr: if (empty($additional_data)) { goto q2rBQ; } goto U2LVi; PHRKN: $existing_group = $this->db->get_where($this->tables["\147\162\157\165\x70\x73"], ["\x6e\x61\x6d\145" => $group_name])->num_rows(); goto UOYwx; HfRTi: return FALSE; goto bCAg8; MPssq: return FALSE; goto pC7sH; UOYwx: if (!($existing_group !== 0)) { goto zK1KE; } goto U_HIy; OthkH: $this->set_error("\x67\x72\157\x75\160\x5f\156\x61\x6d\x65\x5f\x72\145\x71\x75\x69\x72\x65\x64"); goto MPssq; qTurJ: $group_id = $this->db->insert_id($this->tables["\x67\x72\x6f\x75\x70\163"] . "\137\151\x64\x5f\x73\x65\161"); goto HwbxQ; xMSzl: $this->trigger_events("\x65\x78\x74\x72\141\137\147\162\x6f\165\160\x5f\163\x65\x74"); goto ykLVV; U2LVi: $data = array_merge($this->_filter_data($this->tables["\147\162\157\x75\160\x73"], $additional_data), $data); goto hU_CK; ykLVV: $this->db->insert($this->tables["\147\162\x6f\x75\160\x73"], $data); goto qTurJ; U_HIy: $this->set_error("\147\x72\157\165\x70\137\x61\x6c\x72\145\x61\x64\x79\137\x65\170\x69\x73\x74\x73"); goto HfRTi; nuQh0: $data = ["\156\x61\155\145" => $group_name, "\x64\145\163\x63\x72\x69\x70\x74\x69\157\x6e" => $group_description]; goto S7fMr; PM9nq: if ($group_name) { goto qeqdi; } goto OthkH; hU_CK: q2rBQ: goto xMSzl; rNDNh: return $group_id; goto VlulP; pC7sH: qeqdi: goto PHRKN; VlulP: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto L7b1Q; bRU7b: if (empty($group_name)) { goto dEcfo; } goto IbHQZ; WFK83: $this->set_message("\147\x72\x6f\x75\160\x5f\165\160\x64\141\164\145\137\163\165\143\143\145\163\x73\146\x75\x6c"); goto c8JIv; I3WJb: $data = []; goto bRU7b; RLIjt: $group = $this->db->get_where($this->tables["\147\x72\x6f\x75\160\163"], ["\x69\x64" => $group_id])->row(); goto cIP_Z; IbHQZ: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\165\x70\163"], ["\156\x61\155\145" => $group_name])->row(); goto OY0Yb; ZgMU2: $this->set_error("\x67\162\157\x75\x70\x5f\156\x61\x6d\x65\137\x61\144\x6d\151\x6e\137\156\x6f\164\137\x61\x6c\164\145\162"); goto k15HN; cO6H2: JPOu6: goto I3WJb; xPqQB: EntKR: goto W7OMQ; OY0Yb: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto vEJdb; } goto pOcW6; oXQjF: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\165\160\x73"], $additional_data), $data); goto G1dfM; rNaPW: return FALSE; goto OdGKQ; RTyM0: $data["\156\141\155\145"] = $group_name; goto pFHCW; k15HN: return FALSE; goto xPqQB; G1dfM: VFVhl: goto VMhqV; JkP5H: return FALSE; goto cO6H2; L7b1Q: if (!empty($group_id)) { goto JPOu6; } goto JkP5H; pFHCW: dEcfo: goto RLIjt; cIP_Z: if (!($this->config->item("\x61\144\155\151\x6e\137\x67\x72\x6f\165\160", "\151\157\156\137\x61\x75\x74\x68") === $group->name && $group_name !== $group->name)) { goto EntKR; } goto ZgMU2; W7OMQ: if (empty($additional_data)) { goto VFVhl; } goto oXQjF; VMhqV: $this->db->update($this->tables["\147\x72\x6f\165\x70\x73"], $data, ["\x69\144" => $group_id]); goto WFK83; OdGKQ: vEJdb: goto RTyM0; c8JIv: return TRUE; goto jUIfg; pOcW6: $this->set_error("\x67\x72\x6f\165\x70\x5f\141\x6c\162\x65\x61\144\171\x5f\145\x78\151\x73\164\163"); goto rNaPW; jUIfg: } public function delete_group($group_id = FALSE) { goto yS7zp; eXsjE: return TRUE; goto WScqa; yS7zp: if (!(!$group_id || empty($group_id))) { goto oeSuq; } goto mGRak; ppDjn: if (!($group->name == $this->config->item("\141\x64\155\x69\156\x5f\x67\x72\157\x75\x70", "\151\157\x6e\137\141\165\164\150"))) { goto V83E9; } goto pD0B0; bb9GC: $this->trigger_events("\160\162\x65\137\x64\x65\154\x65\164\x65\x5f\x67\162\x6f\x75\160"); goto P1Yvf; N0tpe: $this->set_message("\147\162\x6f\x75\160\137\x64\x65\x6c\145\164\x65\137\163\165\143\143\145\x73\x73\x66\165\154"); goto eXsjE; TL61e: if (!($this->db->trans_status() === FALSE)) { goto kYIJ7; } goto G0ORq; P1Yvf: $this->db->trans_begin(); goto SZ6NL; G0ORq: $this->db->trans_rollback(); goto s1x0V; KYoUN: $this->db->trans_commit(); goto mEgZ_; pD0B0: $this->trigger_events(["\160\157\163\164\137\144\145\154\x65\164\145\x5f\x67\162\157\x75\160", "\x70\157\163\x74\137\x64\145\x6c\x65\x74\145\137\x67\x72\157\x75\160\137\156\157\x74\141\x6c\154\157\167\x65\x64"]); goto NEYNr; NEYNr: $this->set_error("\147\162\157\165\160\x5f\144\145\154\x65\164\x65\137\156\157\164\x61\x6c\x6c\x6f\x77\145\x64"); goto nGR04; EU4Rl: kYIJ7: goto KYoUN; nGR04: return FALSE; goto AC_vp; Gyx3Z: $this->set_error("\x67\x72\157\x75\160\137\x64\x65\154\145\x74\145\x5f\x75\156\x73\x75\143\x63\145\163\x73\146\165\154"); goto JfCwY; JfCwY: return FALSE; goto EU4Rl; h0Gvj: $group = $this->group($group_id)->row(); goto ppDjn; AC_vp: V83E9: goto bb9GC; mGRak: return FALSE; goto JfRIU; jeRU2: $this->db->delete($this->tables["\147\162\157\x75\x70\x73"], ["\x69\x64" => $group_id]); goto TL61e; mEgZ_: $this->trigger_events(["\160\x6f\163\x74\x5f\144\x65\x6c\x65\164\x65\137\x67\162\157\165\160", "\160\x6f\163\x74\x5f\x64\145\x6c\145\x74\x65\x5f\147\162\x6f\165\x70\x5f\x73\165\x63\x63\x65\163\163\x66\165\154"]); goto N0tpe; s1x0V: $this->trigger_events(["\160\x6f\163\164\x5f\x64\145\x6c\x65\x74\x65\x5f\147\x72\157\165\160", "\x70\157\x73\x74\137\144\145\x6c\145\164\145\137\x67\162\157\x75\160\137\165\156\x73\x75\x63\x63\145\163\163\x66\165\154"]); goto Gyx3Z; SZ6NL: $this->db->delete($this->tables["\165\163\x65\162\x73\x5f\147\x72\157\165\x70\163"], [$this->join["\x67\162\157\165\x70\163"] => $group_id]); goto jeRU2; JfRIU: oeSuq: goto h0Gvj; WScqa: } public function set_hook($event, $name, $class, $method, $arguments) { goto Bj7at; Lg4RW: $this->_ion_hooks->{$event}[$name]->class = $class; goto bi17u; Y3Xrq: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto LYqbb; Bj7at: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto Lg4RW; bi17u: $this->_ion_hooks->{$event}[$name]->method = $method; goto Y3Xrq; LYqbb: } public function remove_hook($event, $name) { goto d3Mah; jTfIe: unset($this->_ion_hooks->{$event}[$name]); goto mFCJc; mFCJc: ZHrI8: goto SJpg2; d3Mah: if (!isset($this->_ion_hooks->{$event}[$name])) { goto ZHrI8; } goto jTfIe; SJpg2: } public function remove_hooks($event) { goto g0ma8; jpZSG: unset($this->_ion_hooks->{$event}); goto UnYYO; g0ma8: if (!isset($this->_ion_hooks->{$event})) { goto fyRpf; } goto jpZSG; UnYYO: fyRpf: goto RKOUR; RKOUR: } protected function _call_hook($event, $name) { goto mnDh8; JcbDm: return FALSE; goto TyKee; mnDh8: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto OYmYp; } goto uLgmC; uLgmC: $hook = $this->_ion_hooks->{$event}[$name]; goto KTTfM; KTTfM: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto z7UVE; z7UVE: OYmYp: goto JcbDm; TyKee: } public function trigger_events($events) { goto YLtbH; JUwkb: EuURW: goto ZlpFZ; ZcX1n: t1fC2: goto ks3U8; ks3U8: RKzx3: goto WCJRX; Iagj2: D2mlG: goto RuXjq; WCJRX: goto gjTWg; goto Iagj2; ZlpFZ: gjTWg: goto RTiNO; tZVRi: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); FkTS2: } goto ZcX1n; twXQV: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto RKzx3; } goto tZVRi; RuXjq: foreach ($events as $event) { $this->trigger_events($event); wROX5: } goto JUwkb; YLtbH: if (is_array($events) && !empty($events)) { goto D2mlG; } goto twXQV; RTiNO: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto oOu7Q; KHZGv: $this->message_end_delimiter = $end_delimiter; goto B_kzn; B_kzn: return TRUE; goto Ss3l2; oOu7Q: $this->message_start_delimiter = $start_delimiter; goto KHZGv; Ss3l2: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto Qsyo7; Qsyo7: $this->error_start_delimiter = $start_delimiter; goto dtHlM; wUO1T: return TRUE; goto kylcP; dtHlM: $this->error_end_delimiter = $end_delimiter; goto wUO1T; kylcP: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto v9BZp; AOlA2: return $_output; goto cz1Ip; fZI1a: foreach ($this->messages as $message) { goto lbDKu; amAnI: Sx1pN: goto RhTej; lbDKu: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto uYRnK; uYRnK: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto amAnI; RhTej: } goto OoanP; v9BZp: $_output = ''; goto fZI1a; OoanP: B9e4r: goto AOlA2; cz1Ip: } public function messages_array($langify = TRUE) { goto OmyMF; XGrIT: $_output = []; goto HmNHs; OmyMF: if ($langify) { goto fy0bm; } goto IgpeO; ReMbq: goto EnhOl; goto s2N6Q; IgpeO: return $this->messages; goto ReMbq; GPtdz: return $_output; goto vP9dy; HmNHs: foreach ($this->messages as $message) { goto XqEe1; XqEe1: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto BgI8c; BgI8c: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto e1H6c; e1H6c: J2vSh: goto yHpAf; yHpAf: } goto hINIP; hINIP: fN2hv: goto GPtdz; s2N6Q: fy0bm: goto XGrIT; vP9dy: EnhOl: goto cDVkg; cDVkg: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto va_8A; Nhy2u: return $_output; goto UHpex; va_8A: $_output = ''; goto BbqSz; BbqSz: foreach ($this->errors as $error) { goto e5DmQ; MPK91: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto KglvL; KglvL: H7FH7: goto rU5a3; e5DmQ: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\x23"; goto MPK91; rU5a3: } goto y70AD; y70AD: rP2WE: goto Nhy2u; UHpex: } public function errors_array($langify = TRUE) { goto NQ7jN; M8_dz: $_output = []; goto Xkekf; fiHUT: return $this->errors; goto UgFou; qEZ75: return $_output; goto rztoQ; NQ7jN: if ($langify) { goto x19Dh; } goto fiHUT; Xkekf: foreach ($this->errors as $error) { goto df_43; OupOw: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto SBoQI; df_43: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\x23"; goto OupOw; SBoQI: CKVZG: goto uqHDo; uqHDo: } goto Itbf9; JYmoH: x19Dh: goto M8_dz; rztoQ: FQsmu: goto oaley; UgFou: goto FQsmu; goto JYmoH; Itbf9: U0rAK: goto qEZ75; oaley: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto lwtvm; LR9zb: $data = ["\x70\141\x73\x73\x77\157\162\x64" => $hash, "\x72\x65\155\x65\x6d\142\145\x72\x5f\143\x6f\144\145" => NULL, "\x66\157\x72\147\157\x74\164\145\156\x5f\160\x61\x73\163\x77\157\x72\144\137\143\157\x64\x65" => NULL, "\146\157\162\x67\x6f\x74\164\145\156\x5f\160\x61\163\163\167\157\162\x64\137\x74\151\155\x65" => NULL]; goto WUmjC; lwtvm: $hash = $this->hash_password($password, $identity); goto eT1S9; IU4p3: TXVQs: goto LR9zb; rrRn8: return $this->db->affected_rows() == 1; goto UWleG; WUmjC: $this->trigger_events("\145\170\164\x72\141\137\x77\150\x65\x72\145"); goto oakFk; oakFk: $this->db->update($this->tables["\x75\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto rrRn8; uaRZM: return FALSE; goto IU4p3; eT1S9: if (!($hash === FALSE)) { goto TXVQs; } goto uaRZM; UWleG: } protected function _filter_data($table, $data) { goto D49QU; Sym_5: $columns = $this->db->list_fields($table); goto zNEkJ; nc1wz: return $filtered_data; goto Bleb8; zNEkJ: if (!is_array($data)) { goto wdCM4; } goto M11DW; D49QU: $filtered_data = []; goto Sym_5; ojdDD: M5f0g: goto Agpsg; Agpsg: wdCM4: goto nc1wz; M11DW: foreach ($columns as $column) { goto rSTz4; aOwk6: pB2Z6: goto nrMN9; rSTz4: if (!array_key_exists($column, $data)) { goto O9Q_Q; } goto DS91x; DS91x: $filtered_data[$column] = $data[$column]; goto uUt7L; uUt7L: O9Q_Q: goto aOwk6; nrMN9: } goto ojdDD; Bleb8: } protected function _random_token($result_length = 32) { goto uxMNf; uxMNf: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto EMcPG; } goto PsvHw; tGclh: if (!function_exists("\x72\x61\156\x64\157\x6d\137\142\171\x74\x65\x73")) { goto WGMdU; } goto RnPwD; RnPwD: return bin2hex(random_bytes($result_length / 2)); goto ZnxD0; h8xQl: if (!function_exists("\157\x70\145\x6e\163\x73\154\137\x72\x61\x6e\144\157\x6d\x5f\x70\x73\145\x75\144\x6f\137\x62\171\x74\x65\x73")) { goto Fnul4; } goto Quw0F; Oxroh: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto tapNw; ZnxD0: WGMdU: goto F0WH_; HXrFX: return FALSE; goto j5275; Quw0F: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto wIpen; wIpen: Fnul4: goto HXrFX; PsvHw: $result_length = 32; goto YZ6lb; YZ6lb: EMcPG: goto tGclh; tapNw: ZG5_y: goto h8xQl; F0WH_: if (!function_exists("\155\x63\x72\171\160\x74\137\143\x72\x65\141\164\x65\137\x69\x76")) { goto ZG5_y; } goto Oxroh; j5275: } protected function _get_hash_parameters($identity = NULL) { goto nk5K0; ObWuL: NnCmB: goto T2kv7; cI0q0: if (!($user_id && $this->in_group($this->config->item("\x61\x64\x6d\151\x6e\137\x67\x72\157\x75\160", "\x69\x6f\156\137\141\165\x74\x68"), $user_id))) { goto djOrq; } goto Yzff3; P3VJa: $user_id = $this->get_user_id_from_identity($identity); goto cI0q0; Yzff3: $is_admin = TRUE; goto kU58n; nk5K0: $is_admin = FALSE; goto UUDDM; mQ3Ob: eynQp: goto ObWuL; UUDDM: if (!$identity) { goto QGz1L; } goto P3VJa; tIUxY: $params = FALSE; goto IjQAw; xHQrW: QGz1L: goto tIUxY; kU58n: djOrq: goto xHQrW; T2kv7: return $params; goto zjoNZ; IjQAw: switch ($this->hash_method) { case "\x62\x63\x72\171\160\x74": $params = ["\143\157\x73\164" => $is_admin ? $this->config->item("\142\x63\162\x79\x70\164\137\141\x64\x6d\x69\156\137\143\x6f\x73\x74", "\x69\157\156\x5f\x61\165\x74\150") : $this->config->item("\x62\143\x72\171\160\x74\137\144\145\x66\x61\165\154\x74\x5f\x63\x6f\x73\x74", "\151\x6f\x6e\137\x61\x75\164\150")]; goto NnCmB; case "\x61\x72\x67\x6f\156\x32": $params = $is_admin ? $this->config->item("\141\x72\147\x6f\x6e\x32\x5f\141\144\x6d\151\156\137\160\141\x72\141\155\163", "\x69\157\156\137\141\x75\164\x68") : $this->config->item("\x61\162\x67\x6f\156\x32\137\x64\x65\x66\141\165\x6c\x74\x5f\160\141\162\x61\x6d\x73", "\x69\x6f\x6e\137\141\165\x74\150"); goto NnCmB; default: } goto mQ3Ob; zjoNZ: } protected function _get_hash_algo() { goto xJZAV; Rsf5S: return $algo; goto AvbbW; hY8HI: a3sc3: goto YkJCL; xJZAV: $algo = FALSE; goto ozRM2; ozRM2: switch ($this->hash_method) { case "\x62\x63\x72\x79\x70\x74": $algo = PASSWORD_BCRYPT; goto v7Jya; case "\x61\162\x67\x6f\156\x32": $algo = PASSWORD_ARGON2I; goto v7Jya; default: } goto hY8HI; YkJCL: v7Jya: goto Rsf5S; AvbbW: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto ZKVY6; ZKVY6: $selector = $this->_random_token($selector_size); goto c3h9v; i_KfR: return (object) ["\x73\x65\154\145\143\164\x6f\x72" => $selector, "\x76\x61\154\x69\144\x61\x74\157\x72\137\150\141\x73\x68\x65\x64" => $validator_hashed, "\x75\163\x65\162\x5f\143\x6f\144\145" => $user_code]; goto Bxvwj; wZopS: $user_code = "{$selector}\x2e{$validator}"; goto i_KfR; aSunq: $validator_hashed = $this->hash_password($validator); goto wZopS; c3h9v: $validator = $this->_random_token($validator_size); goto aSunq; Bxvwj: } protected function _retrieve_selector_validator_couple($user_code) { goto p26Rq; CZqyZ: Ucz_5: goto T7O10; of8qh: if (!(count($tokens) === 2)) { goto Ucz_5; } goto mv_zr; T7O10: c4jUc: goto dIaiC; mv_zr: return (object) ["\163\145\x6c\145\143\164\157\x72" => $tokens[0], "\166\x61\x6c\151\x64\141\x74\157\x72" => $tokens[1]]; goto CZqyZ; dIaiC: return FALSE; goto enjhB; mEosN: $tokens = explode("\56", $user_code); goto of8qh; p26Rq: if (!$user_code) { goto c4jUc; } goto mEosN; enjhB: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto vEbJR; MPGpM: $this->trigger_events(["\x70\x6f\163\x74\x5f\x73\x68\x61\61\137\160\x61\163\163\167\x6f\162\x64\x5f\x6d\x69\x67\x72\x61\x74\151\157\x6e", "\160\x6f\163\164\x5f\x73\x68\141\x31\x5f\160\x61\163\163\x77\157\x72\144\137\155\151\147\x72\x61\x74\151\x6f\x6e\137\165\156\163\x75\143\143\145\163\x73\146\165\154"]); goto Uy9lK; Zdyp9: $result = $this->_set_password_db($identity, $password); goto RicBi; nUuYf: return FALSE; goto LV9O2; JPpy2: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\150\141\x31\137\x70\x61\x73\x73\167\157\x72\144\137\x6d\151\147\162\x61\x74\x69\157\x6e", "\x70\x6f\x73\164\x5f\163\x68\141\61\137\160\x61\x73\x73\x77\x6f\x72\144\x5f\x6d\x69\147\162\141\x74\x69\157\x6e\137\165\x6e\x73\x75\x63\x63\145\163\x73\146\x75\x6c"]); goto nUuYf; kqwLA: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto cFbaX; bYO7K: return FALSE; goto InhDm; LV9O2: Y5Jjg: goto aKFMV; Ec0hd: $hashed_password = sha1($password . $salt_db->salt); goto eC3pa; InhDm: l2iCB: goto Ec0hd; RicBi: if ($result) { goto iGmxG; } goto MPGpM; sUDLu: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\x68\141\x31\137\160\x61\x73\x73\x77\x6f\x72\x64\137\155\x69\x67\x72\141\x74\x69\157\156", "\x70\157\x73\164\x5f\x73\150\141\61\137\x70\141\163\163\167\x6f\x72\144\x5f\x6d\x69\x67\162\141\164\x69\x6f\156\x5f\x73\165\x63\143\145\x73\163\x66\165\154"]); goto COXaN; ExAUQ: return $result; goto C525b; aKFMV: $salt = substr($hashed_password_db, 0, $salt_length); goto kqwLA; flH78: $this->trigger_events(["\x70\x6f\163\164\137\163\150\141\x31\137\160\141\x73\x73\167\x6f\x72\144\137\155\x69\x67\x72\x61\164\151\x6f\x6e", "\160\157\163\164\137\x73\150\x61\x31\137\x70\141\x73\x73\x77\157\162\144\x5f\x6d\x69\x67\162\141\x74\x69\x6f\x6e\137\165\156\163\x75\143\143\145\x73\x73\x66\x75\x6c"]); goto bYO7K; nAYgU: return FALSE; goto hd5UO; jwhqQ: dcNJ_: goto Zdyp9; BAqQf: $salt_length = $this->config->item("\163\141\x6c\164\x5f\x6c\x65\x6e\147\164\x68", "\151\x6f\x6e\x5f\141\x75\164\150"); goto kaubZ; C525b: OxQ0L: goto c50Db; COXaN: dxMtT: goto ExAUQ; cFbaX: goto VvHjw; goto sg8nc; dCmK9: if (!($query->num_rows() !== 1)) { goto l2iCB; } goto flH78; KERSE: $salt_db = $query->row(); goto dCmK9; YIdtp: $query = $this->db->select("\x73\x61\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\163"]); goto KERSE; hd5UO: goto OxQ0L; goto jwhqQ; opH2h: iGmxG: goto sUDLu; pfa08: if ($this->config->item("\x73\164\x6f\162\145\137\x73\x61\154\x74", "\x69\157\x6e\137\x61\x75\x74\150")) { goto gGgh4; } goto BAqQf; Uy9lK: goto dxMtT; goto opH2h; W2rXJ: $this->trigger_events(["\x70\x6f\x73\x74\137\x73\150\x61\x31\137\x70\x61\163\x73\x77\x6f\162\144\x5f\x6d\x69\147\162\x61\164\x69\x6f\156", "\x70\x6f\x73\164\x5f\x73\x68\x61\61\x5f\160\141\x73\x73\x77\x6f\x72\x64\137\155\151\147\162\x61\x74\x69\x6f\x6e\x5f\x75\x6e\163\165\x63\x63\x65\163\163\146\x75\154"]); goto nAYgU; sg8nc: gGgh4: goto YIdtp; kaubZ: if ($salt_length) { goto Y5Jjg; } goto JPpy2; eC3pa: VvHjw: goto vyaC6; vEbJR: $this->trigger_events("\160\162\x65\x5f\x73\x68\141\x31\x5f\x70\141\163\163\167\157\162\x64\x5f\155\x69\x67\162\x61\164\151\x6f\x6e"); goto pfa08; vyaC6: if ($hashed_password === $hashed_password_db) { goto dcNJ_; } goto W2rXJ; c50Db: } }
