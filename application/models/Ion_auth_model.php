<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\x53\105\x50\x41\124\x48") or exit("\x4e\157\40\x64\x69\162\x65\143\164\x20\163\x63\162\x69\160\x74\40\141\143\x63\145\163\x73\x20\x61\x6c\154\x6f\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto bUt2s; eWd9n: $this->error_start_delimiter = $this->config->item("\x65\x72\162\x6f\x72\137\x73\x74\141\162\x74\x5f\x64\x65\154\151\x6d\x69\x74\145\x72", "\x69\157\x6e\x5f\141\x75\164\150"); goto wSbGZ; uqM3h: if (empty($group_name)) { goto ZuwAE; } goto W250v; bUt2s: $this->config->load("\151\x6f\156\137\141\x75\164\150", TRUE); goto qaqZq; M3Rp2: $this->hash_method = $this->config->item("\x68\141\x73\x68\137\155\x65\164\150\157\x64", "\151\x6f\156\137\x61\165\164\x68"); goto eH313; Sf406: $this->join = $this->config->item("\x6a\157\x69\x6e", "\151\157\156\137\141\x75\164\x68"); goto M3Rp2; qIkpD: $this->lang->load("\x69\x6f\156\137\x61\165\164\150"); goto yoEMQ; AiBnm: $this->tables = $this->config->item("\164\141\142\x6c\145\163", "\x69\x6f\x6e\x5f\x61\165\x74\x68"); goto po9pL; WlYkw: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto YTe5I; eH313: $this->messages = []; goto Kr2PC; laKzw: $CI =& get_instance(); goto tHl6m; O9ItG: goto IWzUw; goto e5USb; T8Tqv: $this->message_start_delimiter = $this->config->item("\155\x65\163\x73\141\147\145\137\x73\164\141\162\164\137\x64\145\154\x69\x6d\151\164\x65\162", "\151\157\x6e\x5f\x61\165\x74\x68"); goto lnfqb; Kr2PC: $this->errors = []; goto sqJAr; xkGKZ: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto v1jEL; dG_wO: goto ee4JS; goto RWCha; nmuI5: $error_prefix = $form_validation_class->getProperty("\x5f\x65\x72\162\157\162\137\160\162\145\x66\x69\170"); goto d3D6S; VQlvs: IWzUw: goto NAeXA; PXmhV: $this->trigger_events("\x6d\157\144\145\x6c\x5f\x63\x6f\x6e\163\164\x72\x75\x63\164\x6f\162"); goto IwmtE; qaqZq: $this->load->helper("\x63\x6f\x6f\153\151\145"); goto pgZVA; e5USb: Zz413: goto vKRTG; YTe5I: $this->message_end_delimiter = $this->error_end_delimiter; goto VQlvs; NAeXA: $this->_ion_hooks = new stdClass(); goto PXmhV; pgZVA: $this->load->helper("\144\141\164\x65"); goto qIkpD; sqJAr: $delimiters_source = $this->config->item("\x64\145\x6c\x69\x6d\151\164\x65\x72\x73\x5f\x73\x6f\x75\162\x63\145", "\151\x6f\156\137\141\165\x74\x68"); goto OXBw_; ew9n1: $error_suffix->setAccessible(TRUE); goto WlYkw; usQvb: $error_suffix = $form_validation_class->getProperty("\137\x65\x72\x72\x6f\x72\x5f\163\x75\x66\146\x69\x78"); goto ew9n1; dCvbA: $form_validation_class = new ReflectionClass("\103\x49\137\106\157\x72\155\x5f\x76\141\154\x69\144\x61\x74\x69\157\156"); goto nmuI5; lnfqb: $this->message_end_delimiter = $this->config->item("\155\145\163\x73\141\147\145\x5f\x65\x6e\144\137\144\x65\154\x69\x6d\x69\x74\145\x72", "\151\x6f\156\x5f\x61\x75\x74\x68"); goto eWd9n; RWCha: ZuwAE: goto laKzw; OXBw_: if ($delimiters_source === "\x66\x6f\x72\x6d\137\166\x61\154\x69\144\141\164\x69\x6f\x6e") { goto Zz413; } goto T8Tqv; aodKP: ee4JS: goto AiBnm; wSbGZ: $this->error_end_delimiter = $this->config->item("\x65\162\x72\x6f\162\137\x65\156\x64\x5f\x64\x65\x6c\x69\x6d\151\164\145\162", "\x69\x6f\x6e\137\141\x75\x74\150"); goto O9ItG; W250v: $this->db = $this->load->database($group_name, TRUE, TRUE); goto dG_wO; vKRTG: $this->load->library("\x66\x6f\162\x6d\137\166\x61\x6c\151\x64\141\x74\x69\x6f\156"); goto dCvbA; v1jEL: $this->message_start_delimiter = $this->error_start_delimiter; goto usQvb; tHl6m: $this->db = $CI->db; goto aodKP; po9pL: $this->identity_column = $this->config->item("\x69\x64\x65\156\164\x69\164\171", "\x69\x6f\x6e\137\x61\165\164\150"); goto Sf406; d3D6S: $error_prefix->setAccessible(TRUE); goto xkGKZ; yoEMQ: $group_name = $this->config->item("\144\141\164\141\142\141\163\x65\x5f\x67\162\157\165\160\x5f\x6e\141\155\145", "\x69\x6f\156\137\x61\165\x74\150"); goto uqM3h; IwmtE: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto V02NZ; V02NZ: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto ZOpk0; } goto ZdH2m; VHLHK: $algo = $this->_get_hash_algo(); goto a0wbt; a0wbt: $params = $this->_get_hash_parameters($identity); goto BbqFv; k8tiL: return password_hash($password, $algo, $params); goto riq8g; fUBvH: ZOpk0: goto VHLHK; ZdH2m: return FALSE; goto fUBvH; BbqFv: if (!($algo !== FALSE && $params !== FALSE)) { goto fIlPg; } goto k8tiL; j_ZMR: return FALSE; goto uEJoK; riq8g: fIlPg: goto j_ZMR; uEJoK: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto K0dj4; Qk7gf: goto xFJpJ; goto qB2vg; qB2vg: fu2iz: goto f2G_i; MGrZ4: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto Qk7gf; NxvoU: return FALSE; goto Bu0rd; gFs47: xFJpJ: goto P5EK5; QUSGy: if (strpos($hash_password_db, "\44") === 0) { goto fu2iz; } goto MGrZ4; K0dj4: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto rVhSj; } goto NxvoU; Bu0rd: rVhSj: goto QUSGy; f2G_i: return password_verify($password, $hash_password_db); goto gFs47; P5EK5: } public function rehash_password_if_needed($hash, $identity, $password) { goto O76QF; B3RXa: $this->trigger_events(["\x72\145\x68\x61\x73\150\137\x70\x61\163\x73\x77\157\162\x64", "\162\x65\150\141\163\150\137\160\x61\x73\x73\167\157\162\x64\x5f\165\156\x73\x75\x63\x63\x65\163\163\x66\165\x6c"]); goto IYUN8; oWuSx: $this->trigger_events(["\x72\x65\150\x61\x73\x68\137\160\x61\163\163\x77\x6f\x72\x64", "\x72\145\150\141\x73\x68\137\160\141\x73\x73\167\x6f\x72\x64\137\163\165\x63\x63\x65\163\163\x66\x75\x6c"]); goto L6i_3; O76QF: $algo = $this->_get_hash_algo(); goto GO2NR; GO2NR: $params = $this->_get_hash_parameters($identity); goto NZpWr; BBx14: YatvE: goto zwQP4; Ye02D: IFejL: goto BBx14; MVBKs: if ($this->_set_password_db($identity, $password)) { goto kdVQY; } goto B3RXa; L6i_3: qm11A: goto Ye02D; qEsrD: if (!password_needs_rehash($hash, $algo, $params)) { goto IFejL; } goto MVBKs; Rh8ph: kdVQY: goto oWuSx; NZpWr: if (!($algo !== FALSE && $params !== FALSE)) { goto YatvE; } goto qEsrD; IYUN8: goto qm11A; goto Rh8ph; zwQP4: } public function get_user_by_activation_code($user_code) { goto c1fJQ; uN2jU: return FALSE; goto SSRtj; CeEnY: ac80z: goto Jqvx1; h0kkb: $user = $this->where("\141\x63\164\x69\x76\x61\x74\151\157\156\137\163\x65\x6c\x65\143\164\157\162", $token->selector)->users()->row(); goto OMThj; Jqvx1: ocgmQ: goto uN2jU; Jo2Pp: return $user; goto CeEnY; rHaQb: if (!$this->verify_password($token->validator, $user->activation_code)) { goto ac80z; } goto Jo2Pp; OMThj: if (!$user) { goto ocgmQ; } goto rHaQb; c1fJQ: $token = $this->_retrieve_selector_validator_couple($user_code); goto h0kkb; SSRtj: } public function activate($id, $code = FALSE) { goto p6Yd2; mlYkn: $this->set_message("\x61\x63\164\151\166\141\164\145\137\x73\165\x63\x63\x65\x73\163\146\x75\154"); goto j3PpC; w9m7U: $data = ["\x61\143\164\151\x76\141\164\151\157\x6e\137\163\145\154\x65\143\164\x6f\162" => NULL, "\x61\x63\164\x69\166\141\164\x69\157\156\x5f\x63\157\144\x65" => NULL, "\141\x63\x74\x69\x76\145" => 1]; goto Jw0xK; mWC30: $this->trigger_events(["\x70\x6f\x73\164\x5f\x61\x63\164\x69\x76\141\164\x65", "\x70\x6f\x73\164\137\x61\143\x74\x69\x76\141\x74\x65\x5f\165\156\163\165\x63\143\x65\x73\x73\146\165\x6c"]); goto LvObM; KeY43: if (!($code !== FALSE)) { goto jUJMR; } goto BbjO5; x3E2o: return FALSE; goto gYNla; NTzCI: $this->trigger_events(["\160\x6f\x73\x74\137\141\143\164\x69\x76\141\x74\x65", "\160\157\163\x74\x5f\x61\x63\164\x69\x76\x61\164\145\137\163\165\143\x63\145\x73\x73\x66\165\154"]); goto mlYkn; c7Z6T: SCWfm: goto mWC30; TKPs7: if (!($this->db->affected_rows() === 1)) { goto WSgeI; } goto NTzCI; RIqeY: $this->db->update($this->tables["\165\163\x65\162\163"], $data, ["\x69\x64" => $id]); goto TKPs7; Jw0xK: $this->trigger_events("\x65\x78\164\162\x61\x5f\167\x68\145\x72\145"); goto RIqeY; QcpiC: if (!($code === FALSE || $user && $user->id === $id)) { goto SCWfm; } goto w9m7U; LvObM: $this->set_error("\141\143\x74\x69\166\141\x74\145\137\165\156\163\x75\143\x63\145\163\x73\x66\x75\x6c"); goto x3E2o; PGWDL: jUJMR: goto QcpiC; j3PpC: return TRUE; goto oiAWK; oiAWK: WSgeI: goto c7Z6T; BbjO5: $user = $this->get_user_by_activation_code($code); goto PGWDL; p6Yd2: $this->trigger_events("\160\162\145\137\141\143\x74\x69\166\x61\164\145"); goto KeY43; gYNla: } public function deactivate($id = NULL) { goto n62Bb; Y3zGo: if (!isset($id)) { goto gH1Db; } goto r91_2; ucgav: $return = $this->db->affected_rows() == 1; goto EwMq9; x74FL: $this->set_message("\144\x65\141\143\164\x69\x76\141\x74\x65\x5f\x73\x75\x63\143\145\163\163\x66\x75\154"); goto qpOKP; k0A0Y: return FALSE; goto UBwBZ; s6eoS: goto E81Bo; goto KjuGs; h8mxj: $this->set_error("\144\145\141\143\x74\x69\x76\141\164\145\137\165\x6e\163\x75\143\143\x65\163\163\x66\x75\154"); goto k0A0Y; j2WV5: $this->trigger_events("\145\170\x74\162\141\137\167\x68\145\162\x65"); goto ZKQlU; EwMq9: if ($return) { goto PZzHn; } goto VDcUc; KjuGs: PZzHn: goto x74FL; ZKQlU: $this->db->update($this->tables["\x75\x73\x65\x72\163"], $data, ["\151\x64" => $id]); goto ucgav; P92jC: gH1Db: goto h8mxj; n62Bb: $this->trigger_events("\x64\x65\141\x63\164\x69\166\x61\x74\145"); goto Y3zGo; ElXc6: E021s: goto iCsSB; iCsSB: goto H53pJ; goto P92jC; ZLXxQ: return $return; goto qchMe; t5exW: $token = $this->_generate_selector_validator_couple(20, 40); goto C0tqN; C0tqN: $this->activation_code = $token->user_code; goto SngDo; UBwBZ: H53pJ: goto t5exW; VDcUc: $this->set_error("\x64\145\x61\x63\164\151\166\141\x74\145\x5f\x75\x6e\163\x75\143\143\145\163\163\146\165\154"); goto s6eoS; zMBjD: $this->set_error("\x64\x65\x61\x63\164\x69\166\141\164\x65\x5f\x63\x75\x72\162\145\156\164\137\x75\x73\x65\x72\137\x75\x6e\163\165\143\x63\x65\163\x73\146\165\x6c"); goto ojtTs; qpOKP: E81Bo: goto ZLXxQ; r91_2: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto E021s; } goto zMBjD; ojtTs: return FALSE; goto ElXc6; SngDo: $data = ["\x61\143\164\x69\166\141\164\151\157\156\x5f\163\145\154\145\x63\x74\x6f\x72" => $token->selector, "\141\143\164\151\166\141\164\x69\x6f\x6e\x5f\143\x6f\x64\145" => $token->validator_hashed, "\141\143\164\151\166\145" => 0]; goto j2WV5; qchMe: } public function clear_forgotten_password_code($identity) { goto GfoPI; vdx4X: return FALSE; goto IU3zd; IU3zd: ci4el: goto fz1iH; swRiY: return TRUE; goto T2iGU; fz1iH: $data = ["\146\157\162\147\157\164\x74\145\x6e\137\160\x61\x73\163\x77\157\x72\144\x5f\163\x65\x6c\x65\143\x74\157\x72" => NULL, "\146\x6f\x72\x67\x6f\x74\164\x65\x6e\137\x70\x61\163\163\167\x6f\x72\144\x5f\143\x6f\x64\x65" => NULL, "\x66\157\162\x67\x6f\x74\x74\145\156\137\160\141\x73\x73\x77\x6f\162\144\x5f\164\151\x6d\145" => NULL]; goto caS43; caS43: $this->db->update($this->tables["\x75\x73\145\162\x73"], $data, [$this->identity_column => $identity]); goto swRiY; GfoPI: if (!empty($identity)) { goto ci4el; } goto vdx4X; T2iGU: } public function clear_remember_code($identity) { goto oABOf; oABOf: if (!empty($identity)) { goto uSz24; } goto H8MIo; H8MIo: return FALSE; goto V4ZB_; srMRR: $data = ["\x72\145\x6d\145\x6d\x62\x65\162\137\x73\x65\154\145\x63\x74\x6f\x72" => NULL, "\162\145\x6d\145\x6d\142\x65\x72\137\x63\x6f\144\x65" => NULL]; goto oDQy1; V4ZB_: uSz24: goto srMRR; CYgTT: return TRUE; goto u_fKV; oDQy1: $this->db->update($this->tables["\x75\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto CYgTT; u_fKV: } public function reset_password($identity, $new) { goto DmG7N; QpRe3: D0GL_: goto LCH9z; LCH9z: $return = $this->_set_password_db($identity, $new); goto tKtn4; tKtn4: if ($return) { goto K4w7g; } goto GUyok; WyMbq: return FALSE; goto QpRe3; X9iLV: $this->trigger_events(["\x70\x6f\x73\164\x5f\x63\x68\x61\x6e\147\x65\137\x70\141\163\x73\167\x6f\162\x64", "\x70\x6f\x73\x74\137\x63\x68\x61\156\x67\x65\137\x70\141\x73\163\x77\157\162\x64\137\x75\156\x73\x75\143\143\x65\x73\x73\146\165\154"]); goto WyMbq; lJbwc: if ($this->identity_check($identity)) { goto D0GL_; } goto X9iLV; i7OVN: $this->trigger_events(["\160\x6f\x73\x74\137\x63\x68\141\x6e\x67\145\137\x70\141\163\x73\167\157\162\144", "\x70\x6f\163\x74\137\143\150\141\x6e\x67\x65\137\160\x61\x73\163\x77\157\162\144\137\x73\x75\143\143\x65\163\163\146\x75\154"]); goto mqVM1; mqVM1: $this->set_message("\160\141\x73\x73\x77\157\x72\144\x5f\143\150\x61\x6e\x67\x65\137\x73\165\x63\x63\145\163\x73\x66\x75\x6c"); goto nX8IC; DmG7N: $this->trigger_events("\160\x72\145\137\143\x68\141\156\147\x65\137\160\141\163\x73\x77\x6f\x72\144"); goto lJbwc; JJuPU: goto uWBbO; goto Ra2JQ; nX8IC: uWBbO: goto ZOEuH; dDRi9: $this->set_error("\x70\141\x73\163\x77\157\x72\x64\x5f\143\150\x61\x6e\x67\145\137\165\x6e\163\x75\x63\143\145\163\x73\146\165\154"); goto JJuPU; GUyok: $this->trigger_events(["\x70\157\x73\x74\137\143\x68\x61\156\x67\x65\137\x70\x61\163\163\x77\x6f\162\x64", "\x70\x6f\x73\164\x5f\143\x68\x61\156\147\x65\137\x70\x61\x73\x73\167\157\162\x64\x5f\165\156\163\x75\143\143\x65\163\163\146\x75\154"]); goto dDRi9; Ra2JQ: K4w7g: goto i7OVN; ZOEuH: return $return; goto vceY_; vceY_: } public function change_password($identity, $old, $new) { goto f9Fov; ay2Cx: if (!($query->num_rows() !== 1)) { goto ElAsP; } goto wq458; f9Fov: $this->trigger_events("\160\x72\x65\x5f\x63\150\141\x6e\147\x65\x5f\160\141\x73\x73\x77\x6f\162\144"); goto mJCi9; Wh7mG: $this->set_error("\x70\141\x73\x73\167\157\162\144\137\x63\150\x61\156\x67\x65\137\x75\156\x73\165\x63\143\145\163\163\x66\x75\154"); goto Nso6x; Mfp2L: return FALSE; goto hE6zG; JL7xe: $this->trigger_events(["\160\157\x73\x74\137\143\150\141\156\147\x65\x5f\x70\141\x73\x73\167\x6f\162\144", "\x70\x6f\x73\x74\x5f\x63\150\x61\156\147\145\137\x70\141\163\x73\167\x6f\x72\x64\x5f\165\x6e\x73\x75\143\143\145\163\x73\146\165\x6c"]); goto Wh7mG; fP5tY: if (!$this->verify_password($old, $user->password, $identity)) { goto jRMcC; } goto sgzgA; Pxuc0: $this->trigger_events(["\160\x6f\163\x74\x5f\x63\x68\141\x6e\147\145\x5f\x70\x61\x73\x73\x77\157\162\x64", "\x70\157\x73\x74\137\143\150\x61\156\147\x65\x5f\160\141\163\163\x77\157\x72\144\x5f\163\x75\x63\143\145\163\163\146\x75\x6c"]); goto WuSHr; brbrs: return $result; goto Vsb0A; dXMI2: return FALSE; goto CybGm; hE6zG: ElAsP: goto LaCS8; r3uQa: $query = $this->db->select("\x69\144\54\40\x70\x61\163\x73\167\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\145\x73\143")->get($this->tables["\x75\x73\x65\x72\x73"]); goto ay2Cx; QGEOU: UsLZW: goto Pxuc0; LaCS8: $user = $query->row(); goto fP5tY; sgzgA: $result = $this->_set_password_db($identity, $new); goto I9Bpq; WuSHr: $this->set_message("\160\x61\x73\163\x77\x6f\x72\x64\137\x63\x68\x61\156\147\x65\137\163\165\x63\x63\145\163\163\x66\165\154"); goto VqmMY; XUxtM: $this->set_error("\160\x61\x73\x73\167\x6f\x72\x64\137\x63\150\x61\x6e\147\145\137\165\156\163\x75\143\143\145\163\163\146\165\x6c"); goto Mfp2L; wq458: $this->trigger_events(["\160\x6f\163\164\x5f\143\x68\141\156\x67\x65\137\160\x61\163\163\x77\157\x72\x64", "\160\157\x73\164\x5f\x63\150\x61\156\x67\145\x5f\x70\x61\163\163\167\x6f\162\144\x5f\165\156\163\x75\143\143\x65\163\x73\x66\165\154"]); goto XUxtM; I9Bpq: if ($result) { goto UsLZW; } goto JL7xe; xlDua: $this->set_error("\160\x61\x73\163\x77\x6f\x72\x64\137\x63\150\141\x6e\x67\145\137\x75\x6e\x73\165\143\143\x65\x73\x73\146\165\154"); goto dXMI2; mJCi9: $this->trigger_events("\x65\x78\164\162\141\137\167\x68\x65\x72\x65"); goto r3uQa; VqmMY: IFv3d: goto brbrs; Vsb0A: jRMcC: goto xlDua; Nso6x: goto IFv3d; goto QGEOU; CybGm: } public function username_check($username = '') { goto mPeV2; mPeV2: $this->trigger_events("\x75\x73\x65\162\156\x61\155\x65\x5f\x63\x68\x65\143\x6b"); goto udNNw; udNNw: if (!empty($username)) { goto gGrqE; } goto F2aIr; hfwhc: $this->trigger_events("\x65\x78\164\x72\141\x5f\x77\150\x65\x72\x65"); goto Mo5tO; QsZWU: gGrqE: goto hfwhc; F2aIr: return FALSE; goto QsZWU; Mo5tO: return $this->db->where("\165\x73\x65\x72\x6e\141\155\x65", $username)->limit(1)->count_all_results($this->tables["\x75\163\x65\162\x73"]) > 0; goto nWYez; nWYez: } public function email_check($email = '') { goto J18Nm; J18Nm: $this->trigger_events("\x65\x6d\x61\151\154\x5f\x63\150\145\x63\x6b"); goto VNjvs; VNjvs: if (!empty($email)) { goto GIOIG; } goto twD5j; twD5j: return FALSE; goto mKAKY; Ij4RZ: return $this->db->where("\145\155\x61\151\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\145\x72\x73"]) > 0; goto Vu25B; xcZQD: $this->trigger_events("\145\x78\x74\x72\x61\x5f\167\x68\145\x72\x65"); goto Ij4RZ; mKAKY: GIOIG: goto xcZQD; Vu25B: } public function identity_check($identity = '') { goto XFVzg; mqUBT: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\x73"]) > 0; goto QeHW8; c7Y8w: kBHEp: goto mqUBT; XFVzg: $this->trigger_events("\x69\144\145\x6e\164\151\x74\171\137\x63\x68\145\x63\x6b"); goto DDcuR; ELqQc: return FALSE; goto c7Y8w; DDcuR: if (!empty($identity)) { goto kBHEp; } goto ELqQc; QeHW8: } public function get_user_id_from_identity($identity = '') { goto Dm8HU; L_tjl: return FALSE; goto W9r2C; HQkzJ: return $user->id; goto LVqGl; bu45z: TC9fg: goto iIi2X; Dm8HU: if (!empty($identity)) { goto U7_j7; } goto L_tjl; W9r2C: U7_j7: goto bL7GF; LxB0v: return FALSE; goto bu45z; iIi2X: $user = $query->row(); goto HQkzJ; eR_mR: if (!($query->num_rows() !== 1)) { goto TC9fg; } goto LxB0v; bL7GF: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\163"]); goto eR_mR; LVqGl: } public function forgotten_password($identity) { goto K3gXX; QBntB: return $token->user_code; goto qVza7; yDpRe: $this->trigger_events(["\x70\157\163\164\x5f\x66\x6f\x72\147\x6f\x74\164\x65\156\x5f\160\141\x73\163\167\x6f\x72\144", "\x70\157\163\x74\137\x66\x6f\x72\x67\x6f\164\164\x65\156\137\160\141\x73\x73\x77\157\x72\x64\137\165\x6e\x73\x75\x63\x63\145\163\163\x66\x75\154"]); goto xS8p1; qP1au: $token = $this->_generate_selector_validator_couple(20, 80); goto Fq32h; wmv5q: eBQ3O: goto qP1au; PUNeK: $this->trigger_events(["\160\x6f\163\164\x5f\x66\x6f\162\x67\x6f\164\164\x65\x6e\137\160\x61\163\x73\x77\157\x72\144", "\x70\157\x73\164\x5f\x66\x6f\x72\147\x6f\x74\164\145\x6e\137\160\x61\x73\x73\x77\157\162\144\x5f\163\165\x63\x63\145\163\x73\x66\165\x6c"]); goto QBntB; K3gXX: if (!empty($identity)) { goto eBQ3O; } goto Ctors; qVza7: PaHkq: goto svSMX; l_PDa: if ($this->db->affected_rows() === 1) { goto saXuy; } goto yDpRe; xS8p1: return FALSE; goto RP9PM; Ctors: $this->trigger_events(["\160\157\x73\164\x5f\146\157\x72\147\x6f\x74\164\145\156\x5f\x70\141\163\x73\167\157\162\144", "\x70\x6f\x73\164\137\146\x6f\x72\147\157\164\x74\x65\x6e\137\x70\x61\x73\163\x77\157\x72\x64\137\165\x6e\163\165\143\143\145\x73\x73\146\x75\x6c"]); goto XAmCV; RP9PM: goto PaHkq; goto Zg5t_; XAmCV: return FALSE; goto wmv5q; Zg5t_: saXuy: goto PUNeK; zAb1M: $this->trigger_events("\145\x78\x74\162\x61\137\167\x68\x65\x72\x65"); goto i_dyJ; Fq32h: $update = ["\146\157\162\147\x6f\164\x74\x65\156\137\160\141\x73\x73\167\x6f\x72\x64\137\x73\x65\x6c\145\x63\164\x6f\162" => $token->selector, "\146\x6f\162\x67\157\x74\x74\145\156\137\x70\x61\x73\x73\x77\157\x72\144\137\143\x6f\144\145" => $token->validator_hashed, "\x66\157\162\x67\157\x74\x74\145\156\x5f\x70\141\163\163\167\x6f\x72\144\x5f\x74\x69\155\145" => time()]; goto zAb1M; i_dyJ: $this->db->update($this->tables["\x75\x73\x65\162\163"], $update, [$this->identity_column => $identity]); goto l_PDa; svSMX: } public function get_user_by_forgotten_password_code($user_code) { goto z14Eu; z14Eu: $token = $this->_retrieve_selector_validator_couple($user_code); goto Ibs38; i1Ye9: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto P_rzS; } goto nGVNp; NMR2Z: return FALSE; goto XmAMu; HdGBN: P_rzS: goto ZwrjD; ZwrjD: vWbfm: goto NMR2Z; Sl3Fh: if (!$user) { goto vWbfm; } goto i1Ye9; Ibs38: $user = $this->where("\146\x6f\162\147\157\164\x74\x65\x6e\137\x70\141\163\163\167\157\162\x64\137\163\145\154\145\143\x74\x6f\x72", $token->selector)->users()->row(); goto Sl3Fh; nGVNp: return $user; goto HdGBN; XmAMu: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto QVidc; WL5IT: t40Ko: goto Sug21; oTgfF: return FALSE; goto WL5IT; iaJAd: return isset($id) ? $id : FALSE; goto ZqpPZ; m6b2F: if (empty($groups)) { goto lmAz6; } goto HnTpQ; EU__m: if ($this->identity_check($identity)) { goto DrHPp; } goto UGLwL; qwbUc: DrHPp: goto UNvfM; G2Rsx: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\x65\162\x73"], $additional_data), $data); goto cxmIq; UNvfM: $this->set_error("\x61\143\143\x6f\x75\x6e\x74\137\x63\162\x65\141\x74\x69\x6f\156\137\144\x75\160\154\x69\x63\x61\164\x65\x5f\151\x64\145\156\x74\151\x74\x79"); goto FycYP; lxSHq: $id = $this->db->insert_id($this->tables["\x75\x73\145\x72\163"] . "\x5f\x69\144\x5f\163\x65\x71"); goto Tpe7n; pjlOm: $default_group = $query; goto Jr87u; HnTpQ: foreach ($groups as $group) { $this->add_to_group($group, $id); XERWh: } goto e7_0M; e7_0M: r66Z5: goto Vc3wv; zeN71: $password = $this->hash_password($password); goto YMgNu; bQHKS: $this->trigger_events("\160\x6f\163\164\137\162\x65\147\x69\163\164\x65\162"); goto iaJAd; cxmIq: $this->trigger_events("\145\x78\164\x72\x61\x5f\163\145\x74"); goto BN52D; Tpe7n: if (!(isset($default_group->id) && empty($groups))) { goto WVwAz; } goto PWhCQ; kvXjv: V44W8: goto WiDN0; Vc3wv: lmAz6: goto bQHKS; PWhCQ: $groups[] = $default_group->id; goto gdkxL; B24Gu: $data = [$this->identity_column => $identity, "\165\163\145\162\156\x61\155\145" => $identity, "\160\141\163\163\167\x6f\x72\144" => $password, "\145\155\x61\151\154" => $email, "\x69\160\137\141\144\144\x72\x65\x73\x73" => $ip_address, "\143\x72\145\141\164\145\x64\137\157\156" => time(), "\x61\143\164\x69\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto G2Rsx; BN52D: $this->db->insert($this->tables["\x75\x73\145\x72\x73"], $user_data); goto lxSHq; xEJ6T: JFlj1: goto B24Gu; QVidc: $this->trigger_events("\x70\x72\145\137\x72\x65\x67\x69\163\x74\x65\x72"); goto h6doe; Sug21: goto V44W8; goto qwbUc; T4pWi: Ul4c1: goto pjlOm; FycYP: return FALSE; goto kvXjv; D6mrB: return FALSE; goto xEJ6T; Kh0WI: $this->set_error("\x61\143\x63\x6f\x75\156\164\137\143\x72\145\141\164\151\157\x6e\137\x6d\x69\163\163\151\156\x67\x5f\144\145\146\141\x75\x6c\164\x5f\x67\162\x6f\x75\160"); goto oTgfF; WiDN0: $query = $this->db->get_where($this->tables["\x67\162\x6f\x75\160\163"], ["\x6e\141\x6d\145" => $this->config->item("\144\x65\146\141\x75\x6c\164\x5f\x67\x72\x6f\x75\160", "\151\x6f\156\x5f\x61\x75\164\x68")], 1)->row(); goto hp5iy; YMgNu: if (!($password === FALSE)) { goto JFlj1; } goto jyjtF; gdkxL: WVwAz: goto m6b2F; jyjtF: $this->set_error("\x61\143\x63\157\165\x6e\x74\x5f\x63\162\145\x61\x74\151\x6f\156\137\165\x6e\x73\165\x63\x63\x65\163\163\x66\x75\154"); goto D6mrB; UGLwL: if (!(!$this->config->item("\x64\x65\146\141\165\x6c\164\x5f\147\x72\x6f\x75\160", "\x69\x6f\156\137\141\165\164\150") && empty($groups))) { goto t40Ko; } goto Kh0WI; hp5iy: if (!(!isset($query->id) && empty($groups))) { goto Ul4c1; } goto BLJYm; Jr87u: $ip_address = $this->input->ip_address(); goto zeN71; h6doe: $manual_activation = $this->config->item("\155\141\156\x75\141\154\137\x61\x63\x74\x69\166\x61\164\x69\x6f\156", "\151\x6f\156\137\141\165\x74\x68"); goto EU__m; BLJYm: $this->set_error("\x61\143\x63\157\x75\156\x74\137\x63\162\x65\141\164\151\157\x6e\x5f\151\156\x76\x61\154\x69\x64\x5f\x64\145\146\x61\165\154\x74\x5f\147\162\157\x75\160"); goto aF_wl; aF_wl: return FALSE; goto T4pWi; ZqpPZ: } public function login($identity, $password, $remember = FALSE) { goto D7Qq4; y4Y1O: Up8lX: goto dPs03; qHx0t: return FALSE; goto y4Y1O; HlfnO: $this->clear_forgotten_password_code($identity); goto HPUff; lZ86Z: $this->hash_password($password); goto TcnTh; HVxpt: $query = $this->db->select($this->identity_column . "\x2c\40\x65\x6d\141\x69\x6c\54\x20\x69\x64\x2c\x20\x70\141\x73\163\x77\157\x72\144\x2c\40\x61\143\164\151\x76\x65\x2c\x20\x6c\x61\x73\164\x5f\x6c\x6f\x67\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\163\x63")->get($this->tables["\x75\163\145\x72\x73"]); goto zzDh9; MI8fq: $this->clear_login_attempts($identity); goto HlfnO; p1CIm: $this->increase_login_attempts($identity); goto EtBQy; siHiN: $this->rehash_password_if_needed($user->password, $identity, $password); goto USSAF; DJycj: kUqxv: goto SF67c; KiIKq: KloDz: goto DJycj; B4B75: zpwph: goto XlQZT; zzDh9: if (!$this->is_max_login_attempts_exceeded($identity)) { goto Up8lX; } goto lZ86Z; dPs03: if (!($query->num_rows() === 1)) { goto kUqxv; } goto bs3zc; Tpdj9: if (!$this->verify_password($password, $user->password, $identity)) { goto KloDz; } goto EK_9R; zkOrV: return TRUE; goto KiIKq; OPwJm: $this->trigger_events("\x70\157\163\164\x5f\x6c\x6f\147\151\x6e\x5f\165\156\x73\165\x63\x63\x65\x73\x73\146\x75\x6c"); goto So1CI; z7Bo0: if (!(empty($identity) || empty($password))) { goto zpwph; } goto B8P09; So1CI: $this->set_error("\154\157\147\151\x6e\137\165\156\163\165\143\x63\145\x73\163\146\x75\x6c\x5f\156\x6f\164\x5f\141\x63\x74\151\166\x65"); goto gMXQM; jo4K6: goto hCC7H; goto Okei9; GbI3z: return FALSE; goto QM3RG; VucBU: $this->set_error("\x6c\x6f\147\151\x6e\x5f\165\x6e\x73\165\x63\143\145\163\x73\146\165\154"); goto GbI3z; p95xm: $this->set_message("\x6c\x6f\147\x69\156\x5f\x73\165\143\x63\145\163\x73\x66\x75\x6c"); goto zkOrV; sWJQU: THpDY: goto siHiN; QtrlN: hCC7H: goto sWJQU; Okei9: CvVWF: goto RX2Yw; gMXQM: return FALSE; goto Vs31t; RX2Yw: $this->remember_user($identity); goto QtrlN; HMLyy: $this->trigger_events(["\160\x6f\163\164\x5f\x6c\x6f\x67\x69\156", "\x70\x6f\163\164\x5f\154\157\147\151\156\137\x73\165\143\x63\x65\x73\x73\146\165\154"]); goto p95xm; D7Qq4: $this->trigger_events("\x70\162\145\137\154\157\147\151\x6e"); goto z7Bo0; TcnTh: $this->trigger_events("\x70\x6f\163\x74\137\154\157\x67\151\x6e\137\x75\x6e\163\165\x63\x63\145\163\163\x66\x75\x6c"); goto Nmo2q; EtBQy: $this->trigger_events("\x70\157\x73\164\137\x6c\157\147\x69\x6e\x5f\165\156\x73\x75\143\143\145\163\163\146\x75\154"); goto VucBU; Nmo2q: $this->set_error("\154\157\x67\151\x6e\x5f\164\x69\155\x65\157\165\164"); goto qHx0t; XlQZT: $this->trigger_events("\x65\x78\164\162\x61\137\x77\x68\x65\162\x65"); goto HVxpt; Vs31t: B3pPt: goto yByxS; bs3zc: $user = $query->row(); goto Tpdj9; C8w5B: return FALSE; goto B4B75; USSAF: $this->session->sess_regenerate(FALSE); goto HMLyy; KyO7q: if ($remember) { goto CvVWF; } goto qHq5f; r9vgH: $this->update_last_login($user->id); goto MI8fq; qHq5f: $this->clear_remember_code($identity); goto jo4K6; HPUff: if (!$this->config->item("\x72\145\x6d\x65\155\x62\x65\162\137\165\x73\145\x72\x73", "\151\x6f\156\x5f\x61\165\x74\x68")) { goto THpDY; } goto KyO7q; SF67c: $this->hash_password($password); goto p1CIm; EK_9R: if (!($user->active == 0)) { goto B3pPt; } goto OPwJm; yByxS: $this->set_session($user); goto r9vgH; B8P09: $this->set_error("\x6c\157\147\151\156\x5f\165\156\163\x75\143\143\x65\x73\163\x66\165\154"); goto C8w5B; QM3RG: } public function recheck_session() { goto jzcKV; bJYqU: $this->session->unset_userdata([$identity, "\x69\144", "\165\x73\145\x72\137\x69\144"]); goto EbCQ6; u2rfC: kkjNv: goto sGIoS; eGL1V: Qci7v: goto u2rfC; t01oq: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\x69\x64\145\x6e\x74\151\x74\x79"), "\x61\143\x74\151\x76\145" => "\61"])->limit(1)->order_by("\x69\144", "\144\x65\x73\143")->get($this->tables["\x75\163\x65\162\163"]); goto r5FW1; sGIoS: return (bool) $this->session->userdata("\151\x64\x65\x6e\164\x69\x74\x79"); goto yuS4C; MqMSU: $identity = $this->config->item("\151\144\145\x6e\x74\151\164\x79", "\151\157\x6e\137\141\x75\164\150"); goto bJYqU; Bk3e3: Lpydw: goto gba3Z; A441V: $last_login = $this->session->userdata("\154\141\163\x74\137\143\x68\x65\143\153"); goto GR2p3; r5FW1: if ($query->num_rows() === 1) { goto Lpydw; } goto Jrqwn; Jrqwn: $this->trigger_events("\154\157\x67\157\165\x74"); goto MqMSU; jzcKV: $recheck = NULL !== $this->config->item("\x72\x65\x63\150\x65\143\153\137\x74\151\155\145\x72", "\x69\157\156\137\141\x75\x74\150") ? $this->config->item("\162\x65\143\150\145\143\x6b\x5f\x74\x69\x6d\x65\162", "\x69\157\156\137\x61\x75\x74\x68") : 0; goto XABmb; rE8wO: UL4fX: goto eGL1V; EbCQ6: return FALSE; goto rL4Gf; gba3Z: $this->session->set_userdata("\x6c\141\x73\164\137\143\150\145\x63\153", time()); goto rE8wO; XABmb: if (!($recheck !== 0)) { goto kkjNv; } goto A441V; GR2p3: if (!($last_login + $recheck < time())) { goto Qci7v; } goto t01oq; rL4Gf: goto UL4fX; goto Bk3e3; yuS4C: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto WIj4n; FZ_e5: return $attempts >= $max_attempts; goto NhI2c; wo875: $attempts = $this->get_attempts_num($identity, $ip_address); goto FZ_e5; NhI2c: nJokW: goto yDidT; WIj4n: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\154\x6f\147\x69\x6e\137\141\x74\164\x65\155\160\x74\x73", "\x69\x6f\x6e\137\x61\165\x74\x68")) { goto u39KU; } goto m3PoS; j4Lny: return FALSE; goto dfvvt; m3PoS: $max_attempts = $this->config->item("\x6d\141\x78\x69\x6d\x75\155\x5f\154\x6f\x67\151\156\137\141\x74\x74\x65\155\160\x74\163", "\x69\x6f\156\x5f\141\x75\164\x68"); goto raD9U; raD9U: if (!($max_attempts > 0)) { goto nJokW; } goto wo875; yDidT: u39KU: goto j4Lny; dfvvt: } public function get_attempts_num($identity, $ip_address = NULL) { goto D_0Oe; zY4Dr: $this->db->where("\x74\x69\155\145\40\x3e", time() - $this->config->item("\154\157\x63\x6b\157\165\x74\x5f\x74\151\155\x65", "\151\157\156\137\141\x75\x74\x68"), FALSE); goto tFsrb; tFsrb: $qres = $this->db->get($this->tables["\x6c\x6f\x67\151\156\x5f\x61\x74\164\145\x6d\160\x74\163"]); goto P27w2; MNDR1: zsnaz: goto f6e_z; UKFdj: GW0pe: goto YHdJR; wi0Uv: $ip_address = $this->input->ip_address(); goto UKFdj; D_0Oe: if (!$this->config->item("\164\162\x61\x63\153\x5f\x6c\x6f\147\151\x6e\137\141\x74\x74\x65\x6d\160\x74\163", "\151\x6f\x6e\x5f\141\x75\x74\150")) { goto zsnaz; } goto gnom0; gnom0: $this->db->select("\61", FALSE); goto vLR1V; vLR1V: $this->db->where("\154\157\147\151\156", $identity); goto XZy6u; XZy6u: if (!$this->config->item("\164\162\x61\143\153\x5f\x6c\x6f\x67\151\x6e\x5f\151\x70\x5f\141\144\x64\162\145\x73\163", "\x69\x6f\156\137\x61\x75\x74\x68")) { goto oD2tZ; } goto GE28t; YHdJR: $this->db->where("\x69\x70\x5f\141\144\144\162\145\163\x73", $ip_address); goto ZiTku; P27w2: return $qres->num_rows(); goto MNDR1; f6e_z: return 0; goto lR_N5; ZiTku: oD2tZ: goto zY4Dr; GE28t: if (isset($ip_address)) { goto GW0pe; } goto wi0Uv; lR_N5: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto BT3oB; tAbWG: $this->db->select("\164\x69\155\x65"); goto eXCnZ; JI2Zh: $this->db->order_by("\x69\x64", "\x64\145\163\x63"); goto Gdwoj; TJJ5z: UEf3F: goto JI2Zh; oOOnG: $ip_address = $this->input->ip_address(); goto iOPuH; Gdwoj: $qres = $this->db->get($this->tables["\x6c\x6f\147\151\x6e\137\141\x74\x74\145\x6d\160\x74\x73"], 1); goto FBzXh; eXCnZ: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto x1XHD; N7oQs: if (isset($ip_address)) { goto Zww9I; } goto oOOnG; X18Uy: XcFdL: goto iBVRe; BT3oB: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\x6c\157\147\x69\x6e\x5f\141\x74\164\x65\x6d\160\x74\163", "\x69\x6f\156\x5f\x61\165\x74\x68")) { goto tdgqu; } goto tAbWG; iOPuH: Zww9I: goto PcXZ3; ubsb3: return 0; goto vnhHU; iBVRe: tdgqu: goto ubsb3; x1XHD: if (!$this->config->item("\x74\162\141\143\x6b\x5f\154\157\x67\x69\156\x5f\151\160\x5f\x61\x64\144\162\x65\163\163", "\151\x6f\x6e\137\x61\x75\x74\150")) { goto UEf3F; } goto N7oQs; FBzXh: if (!($qres->num_rows() > 0)) { goto XcFdL; } goto j8Pnu; j8Pnu: return $qres->row()->time; goto X18Uy; PcXZ3: $this->db->where("\151\x70\x5f\x61\x64\x64\x72\145\x73\x73", $ip_address); goto TJJ5z; vnhHU: } public function get_last_attempt_ip($identity) { goto oUBUE; oUBUE: if (!($this->config->item("\x74\x72\x61\x63\153\x5f\x6c\x6f\147\x69\156\137\x61\164\x74\x65\x6d\160\164\163", "\151\x6f\x6e\137\141\x75\164\150") && $this->config->item("\x74\x72\x61\143\153\x5f\x6c\157\147\x69\156\137\151\160\x5f\141\144\x64\x72\145\x73\x73", "\x69\157\156\137\141\x75\x74\150"))) { goto JyYNu; } goto U67_H; e87wr: return ''; goto ixJkh; a9CkH: JyYNu: goto e87wr; G91jl: if (!($qres->num_rows() > 0)) { goto UE0vC; } goto Xi1iz; p2AL5: $qres = $this->db->get($this->tables["\154\x6f\147\151\156\x5f\x61\164\164\x65\155\x70\x74\163"], 1); goto G91jl; pHxBo: UE0vC: goto a9CkH; S09L9: $this->db->order_by("\x69\x64", "\x64\145\x73\x63"); goto p2AL5; U67_H: $this->db->select("\151\160\137\141\x64\x64\162\x65\163\163"); goto d5PC8; d5PC8: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto S09L9; Xi1iz: return $qres->row()->ip_address; goto pHxBo; ixJkh: } public function increase_login_attempts($identity) { goto DFvVE; W2CX9: if (!$this->config->item("\164\162\141\x63\x6b\137\154\157\x67\x69\156\x5f\x69\x70\137\x61\144\x64\x72\x65\163\163", "\x69\157\156\137\x61\x75\164\x68")) { goto nBX3W; } goto Lxt4D; Lxt4D: $data["\x69\160\x5f\x61\x64\144\x72\x65\163\x73"] = $this->input->ip_address(); goto r4Kfj; hlyF9: $data = ["\x69\x70\137\x61\x64\144\162\x65\163\163" => '', "\154\157\x67\x69\x6e" => $identity, "\x74\151\x6d\x65" => time()]; goto W2CX9; tvmBN: Q8dno: goto Iz7lD; Iz7lD: return FALSE; goto vTW3H; DFvVE: if (!$this->config->item("\x74\162\141\143\x6b\x5f\154\x6f\x67\x69\156\x5f\141\164\x74\x65\155\160\164\163", "\151\x6f\156\x5f\x61\x75\164\x68")) { goto Q8dno; } goto hlyF9; xs0s_: return $this->db->insert($this->tables["\154\x6f\x67\x69\x6e\x5f\141\164\x74\145\x6d\x70\164\x73"], $data); goto tvmBN; r4Kfj: nBX3W: goto xs0s_; vTW3H: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto hke0M; bCycg: if (isset($ip_address)) { goto BDOOT; } goto dPNHZ; hke0M: if (!$this->config->item("\164\x72\x61\x63\153\137\x6c\x6f\x67\151\156\x5f\141\x74\164\x65\155\160\x74\x73", "\151\x6f\x6e\137\x61\x75\x74\x68")) { goto IFKRp; } goto ZcS1u; MrCbr: return FALSE; goto IDGE9; dPNHZ: $ip_address = $this->input->ip_address(); goto End8s; ZcS1u: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\x63\153\157\x75\164\137\164\x69\x6d\145", "\x69\x6f\x6e\x5f\141\x75\164\x68")); goto SEX4m; cUycN: IFKRp: goto MrCbr; IUcw8: VK5As: goto nyVcT; BiIbl: return $this->db->delete($this->tables["\154\x6f\x67\x69\156\137\x61\164\x74\145\x6d\160\164\x73"]); goto cUycN; aqc_E: $this->db->where("\151\160\137\x61\144\144\x72\x65\163\163", $ip_address); goto IUcw8; End8s: BDOOT: goto aqc_E; nyVcT: $this->db->or_where("\164\151\x6d\145\40\74", time() - $old_attempts_expire_period, FALSE); goto BiIbl; O_SC5: if (!$this->config->item("\164\162\x61\143\x6b\137\154\x6f\x67\x69\156\x5f\x69\x70\x5f\141\144\144\162\145\163\x73", "\151\157\156\137\x61\165\164\x68")) { goto VK5As; } goto bCycg; SEX4m: $this->db->where("\154\x6f\x67\151\x6e", $identity); goto O_SC5; IDGE9: } public function limit($limit) { goto DjBu0; n6b1y: return $this; goto b22eq; DjBu0: $this->trigger_events("\154\151\155\151\164"); goto eSqgt; eSqgt: $this->_ion_limit = $limit; goto n6b1y; b22eq: } public function offset($offset) { goto X5iKp; tW0eN: return $this; goto N8PFR; p3Ze7: $this->_ion_offset = $offset; goto tW0eN; X5iKp: $this->trigger_events("\x6f\146\x66\163\x65\164"); goto p3Ze7; N8PFR: } public function where($where, $value = NULL) { goto kSFfQ; uUr4o: $where = [$where => $value]; goto SHFnl; eEG8C: return $this; goto pcaxb; kSFfQ: $this->trigger_events("\x77\x68\x65\162\x65"); goto k9h3Y; k9h3Y: if (is_array($where)) { goto EMUKH; } goto uUr4o; SHFnl: EMUKH: goto CpMZ_; CpMZ_: array_push($this->_ion_where, $where); goto eEG8C; pcaxb: } public function like($like, $value = NULL, $position = "\142\x6f\164\x68") { goto Fq__O; KrM3B: return $this; goto qAExM; biHg7: array_push($this->_ion_like, ["\x6c\151\x6b\145" => $like, "\166\141\x6c\165\145" => $value, "\160\157\163\151\x74\151\x6f\x6e" => $position]); goto KrM3B; Fq__O: $this->trigger_events("\154\x69\x6b\x65"); goto biHg7; qAExM: } public function select($select) { goto ePUS2; o7D03: $this->_ion_select[] = $select; goto KFUwF; KFUwF: return $this; goto jE0nY; ePUS2: $this->trigger_events("\163\145\x6c\x65\x63\164"); goto o7D03; jE0nY: } public function order_by($by, $order = "\x64\x65\163\143") { goto hOSL2; hOSL2: $this->trigger_events("\x6f\x72\144\145\x72\x5f\142\x79"); goto MQG19; CYNj8: return $this; goto zT2G5; MQG19: $this->_ion_order_by = $by; goto nl1xi; nl1xi: $this->_ion_order = $order; goto CYNj8; zT2G5: } public function row() { goto J94NV; aVmWu: return $row; goto Xrljd; wGyvx: $row = $this->response->row(); goto aVmWu; J94NV: $this->trigger_events("\x72\157\167"); goto wGyvx; Xrljd: } public function row_array() { goto rfFSf; rfFSf: $this->trigger_events(["\162\x6f\x77", "\162\x6f\x77\x5f\x61\162\162\141\x79"]); goto Dt6Jc; kec_V: return $row; goto OKFb_; Dt6Jc: $row = $this->response->row_array(); goto kec_V; OKFb_: } public function result() { goto DQVUj; FEwgw: return $result; goto MeKa2; DQVUj: $this->trigger_events("\x72\145\163\x75\x6c\x74"); goto JYyJw; JYyJw: $result = $this->response->result(); goto FEwgw; MeKa2: } public function result_array() { goto UHLJZ; GHTKO: $result = $this->response->result_array(); goto nRUo7; UHLJZ: $this->trigger_events(["\162\145\163\165\x6c\x74", "\162\x65\163\x75\x6c\164\137\141\162\x72\141\171"]); goto GHTKO; nRUo7: return $result; goto bgcUf; bgcUf: } public function num_rows() { goto f0340; Ye0UU: $result = $this->response->num_rows(); goto ZYqHD; ZYqHD: return $result; goto ihte8; f0340: $this->trigger_events(["\x6e\165\155\x5f\x72\157\x77\163"]); goto Ye0UU; ihte8: } public function users($groups = NULL) { goto HHqHM; JS9g8: $group_names = []; goto QTUvs; q9k3Z: $this->_ion_limit = NULL; goto NftQx; WLbmf: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto KyY8d; } goto CXQkA; P2ZoD: $this->trigger_events("\x65\170\164\162\141\137\167\150\145\162\x65"); goto WYP5N; zLld3: foreach ($this->_ion_where as $where) { $this->db->where($where); I5lNj: } goto niuFT; JCWpN: ZS_g2: goto P2ZoD; Wh6Mo: if (!isset($this->_ion_limit)) { goto HXm0b; } goto A10qH; HmllJ: $this->_ion_order = NULL; goto PahZu; O7CAr: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto LPnNw; } goto eOtRK; JXKyO: $this->response = $this->db->get($this->tables["\x75\163\145\x72\163"]); goto RHwRU; AA0O7: $group_ids = []; goto JS9g8; GmK5k: OTVHS: goto yT0eR; S6p01: if (!isset($groups)) { goto ZS_g2; } goto YhVlT; eOtRK: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\x6b\x65"], $like["\166\x61\154\x75\145"], $like["\x70\157\163\x69\164\151\157\156"]); Pj1jC: } goto Zwkj3; xypVi: $this->db->where_in($this->tables["\147\162\157\x75\160\163"] . "\56\x6e\x61\x6d\x65", $group_names); goto VKN93; ilQts: $this->_ion_limit = NULL; goto V3JUO; NftQx: $this->_ion_offset = NULL; goto mlFm8; WYP5N: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto PhzFM; } goto zLld3; a9xRy: $groups = [$groups]; goto Usoav; EgXxH: LPnNw: goto ejV3r; V3JUO: HXm0b: goto Yqxcz; RHwRU: return $this; goto CVf1x; niuFT: U4Xns: goto l203Z; PahZu: $this->_ion_order_by = NULL; goto PUb2x; Yqxcz: goto Kj6tb; goto hoKpc; be_kB: goto Dyp0r; goto VqURm; icFEg: $this->_ion_like = []; goto EgXxH; Usoav: vaHop: goto bCXVg; PUb2x: ryTFR: goto JXKyO; gpyVr: Lh4yi: goto AA0O7; lOdlV: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto q9k3Z; hutRv: zbQ3h: goto dRQ13; VqURm: KyY8d: goto C_9Zm; hoKpc: guzXl: goto lOdlV; pprjJ: if (empty($group_names)) { goto C30YK; } goto hIh2f; mlFm8: Kj6tb: goto MT8qy; VKN93: C30YK: goto c8W3c; C_9Zm: foreach ($this->_ion_select as $select) { $this->db->select($select); EdTsc: } goto hutRv; A10qH: $this->db->limit($this->_ion_limit); goto ilQts; b3EDT: Dyp0r: goto S6p01; ejV3r: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto guzXl; } goto Wh6Mo; K6053: $this->db->distinct(); goto LOvir; zXZ6m: $this->db->{$or_where_in}($this->tables["\165\163\145\162\163\137\147\x72\157\165\160\x73"] . "\56" . $this->join["\147\x72\157\165\160\163"], $group_ids); goto S2Kdi; hIh2f: $this->db->join($this->tables["\147\x72\x6f\165\x70\x73"], $this->tables["\x75\x73\x65\x72\x73\137\x67\x72\157\165\160\x73"] . "\x2e" . $this->join["\147\x72\x6f\x75\x70\163"] . "\x20\75\x20" . $this->tables["\147\x72\x6f\x75\x70\163"] . "\x2e\151\144", "\151\x6e\156\145\x72"); goto xypVi; Zwkj3: eMWn6: goto icFEg; S2Kdi: lIjza: goto JCWpN; bCXVg: if (!(isset($groups) && !empty($groups))) { goto Lh4yi; } goto K6053; c8W3c: if (empty($group_ids)) { goto lIjza; } goto zXZ6m; dRQ13: $this->_ion_select = []; goto b3EDT; QTUvs: foreach ($groups as $group) { goto sgLsx; Bjei0: t18Cj: goto aaE7T; sgLsx: if (is_numeric($group)) { goto Bwd5O; } goto gA_Vj; z1qeZ: Bwd5O: goto IkzFN; gA_Vj: $group_names[] = $group; goto Gl0vB; qELdI: irVyA: goto Bjei0; Gl0vB: goto irVyA; goto z1qeZ; IkzFN: $group_ids[] = $group; goto qELdI; aaE7T: } goto GmK5k; LOvir: $this->db->join($this->tables["\x75\163\x65\162\163\137\147\x72\x6f\x75\x70\163"], $this->tables["\165\163\145\162\x73\x5f\x67\162\x6f\165\x70\x73"] . "\x2e" . $this->join["\x75\163\x65\x72\x73"] . "\75" . $this->tables["\x75\163\145\162\163"] . "\x2e\151\144", "\x69\x6e\x6e\145\162"); goto gpyVr; MT8qy: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto ryTFR; } goto kbdeQ; HHqHM: $this->trigger_events("\165\163\x65\x72\163"); goto WLbmf; CXQkA: $this->db->select([$this->tables["\165\163\145\x72\163"] . "\x2e\52", $this->tables["\x75\163\x65\162\x73"] . "\x2e\x69\144\x20\x61\x73\x20\151\x64", $this->tables["\x75\163\145\162\163"] . "\x2e\151\x64\40\141\x73\40\x75\x73\x65\162\137\151\144"]); goto be_kB; l203Z: $this->_ion_where = []; goto egZpo; YhVlT: if (is_array($groups)) { goto vaHop; } goto a9xRy; yT0eR: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\x77\x68\145\x72\145\137\151\156" : "\x77\150\145\162\145\x5f\151\x6e"; goto pprjJ; egZpo: PhzFM: goto O7CAr; kbdeQ: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto HmllJ; CVf1x: } public function user($id = NULL) { goto m42dd; HGRr3: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\145\x72\137\x69\x64"); goto BNxV7; jFd2V: $this->where($this->tables["\x75\163\145\x72\x73"] . "\56\151\x64", $id); goto PIZqj; m42dd: $this->trigger_events("\x75\163\145\x72"); goto HGRr3; s0SLB: $this->order_by($this->tables["\165\163\145\x72\x73"] . "\x2e\151\144", "\144\145\163\143"); goto jFd2V; BNxV7: $this->limit(1); goto s0SLB; PIZqj: $this->users(); goto Qx6P7; Qx6P7: return $this; goto f2Fse; f2Fse: } public function get_users_groups($id = FALSE) { goto eo4DR; a8sk2: $id || ($id = $this->session->userdata("\x75\x73\145\162\x5f\151\144")); goto hdiv5; eo4DR: $this->trigger_events("\x67\x65\x74\137\x75\x73\x65\162\163\137\147\162\x6f\x75\160"); goto a8sk2; hdiv5: return $this->db->select($this->tables["\x75\163\x65\x72\163\137\x67\162\x6f\x75\160\163"] . "\56" . $this->join["\147\x72\157\165\160\x73"] . "\40\141\163\x20\151\144\54\40" . $this->tables["\x67\162\x6f\x75\x70\x73"] . "\56\156\x61\155\145\x2c\x20" . $this->tables["\147\162\x6f\165\160\x73"] . "\x2e\x64\145\163\143\162\151\x70\x74\151\157\x6e")->where($this->tables["\165\163\x65\162\x73\x5f\147\162\157\x75\160\163"] . "\56" . $this->join["\x75\163\x65\162\163"], $id)->join($this->tables["\147\162\x6f\165\160\x73"], $this->tables["\x75\163\145\x72\x73\x5f\147\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\x6f\x75\x70\163"] . "\75" . $this->tables["\x67\x72\x6f\x75\x70\163"] . "\x2e\151\144")->get($this->tables["\165\x73\145\x72\x73\x5f\147\162\157\x75\x70\163"]); goto rAHc4; rAHc4: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto JfGzI; AXnT7: rsGj1: goto NW5bz; XZInR: $groups_array = $this->_cache_user_in_group[$id]; goto R_ve4; E5heI: b1F_P: goto XZInR; NW5bz: if (isset($this->_cache_user_in_group[$id])) { goto b1F_P; } goto vl9Yn; R_ve4: mmFwZ: goto X7Lc4; MuN11: if (is_array($check_group)) { goto rsGj1; } goto IjJHx; IjJHx: $check_group = [$check_group]; goto AXnT7; X7Lc4: foreach ($check_group as $key => $value) { goto stqci; cV6r8: if (!(in_array($value, $groups) xor $check_all)) { goto xYaEN; } goto HdiSc; stqci: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto cV6r8; XxXyB: xYaEN: goto M2FtO; HdiSc: return !$check_all; goto XxXyB; M2FtO: IVLyt: goto Lk_ge; Lk_ge: } goto Mogy1; e_3_Y: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; QspXw: } goto rvhli; RBYQj: $id || ($id = $this->session->userdata("\165\x73\145\x72\x5f\151\144")); goto MuN11; NNhHR: $groups_array = []; goto e_3_Y; Mogy1: OkoLd: goto XWMA1; XWMA1: return $check_all; goto cFl01; dyet2: $this->_cache_user_in_group[$id] = $groups_array; goto y5kBG; vl9Yn: $users_groups = $this->get_users_groups($id)->result(); goto NNhHR; rvhli: O_us6: goto dyet2; y5kBG: goto mmFwZ; goto E5heI; JfGzI: $this->trigger_events("\151\x6e\137\x67\x72\x6f\165\x70"); goto RBYQj; cFl01: } public function add_to_group($group_ids, $user_id = FALSE) { goto jB26u; qfd4s: $return = 0; goto dzfYE; RHaTQ: if (is_array($group_ids)) { goto wS9Mu; } goto a0eaM; a0eaM: $group_ids = [$group_ids]; goto WytJS; PzB4k: return $return; goto N6IW4; J2dVw: mBErn: goto PzB4k; WytJS: wS9Mu: goto qfd4s; UI1cK: $user_id || ($user_id = $this->session->userdata("\x75\163\145\x72\x5f\x69\x64")); goto RHaTQ; dzfYE: foreach ($group_ids as $group_id) { goto J0wYc; ej7ru: $this->_cache_groups[$group_id] = $group_name; goto gn8GL; gn8GL: goto SaYiC; goto Tm4vX; tvER9: $group_name = $this->_cache_groups[$group_id]; goto EuJQL; J0wYc: if (!$this->db->insert($this->tables["\165\x73\145\162\x73\x5f\x67\x72\x6f\165\160\163"], [$this->join["\x67\162\x6f\x75\x70\163"] => (float) $group_id, $this->join["\x75\163\145\162\163"] => (float) $user_id])) { goto Qzec6; } goto eZ4Lb; ij4Xz: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto pQLH2; EuJQL: SaYiC: goto ij4Xz; eZ4Lb: if (isset($this->_cache_groups[$group_id])) { goto NXUNb; } goto JL52u; JL52u: $group = $this->group($group_id)->result(); goto NSTJ5; NSTJ5: $group_name = $group[0]->name; goto ej7ru; idSGD: Kxlcl: goto Ses6a; Tm4vX: NXUNb: goto tvER9; ovDzN: Qzec6: goto idSGD; pQLH2: $return++; goto ovDzN; Ses6a: } goto J2dVw; jB26u: $this->trigger_events("\x61\x64\x64\x5f\164\157\137\x67\x72\157\x75\x70"); goto UI1cK; N6IW4: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto FXw5m; sNeMu: if (!empty($user_id)) { goto jE61r; } goto D3mip; Z9pKv: GsE3L: goto A2IVf; ffWgl: kWklE: goto OC1yL; FXw5m: $this->trigger_events("\x72\145\155\x6f\166\145\x5f\146\x72\157\x6d\137\x67\x72\157\x75\x70"); goto sNeMu; zOnpX: SBkXl: goto s8vyt; izcB8: if (!($return = $this->db->delete($this->tables["\x75\163\145\x72\163\137\x67\x72\157\x75\160\163"], [$this->join["\165\163\145\x72\x73"] => (float) $user_id]))) { goto GsE3L; } goto xwRBR; vixpg: $return = TRUE; goto uJRX_; pZwpn: if (!empty($group_ids)) { goto SBkXl; } goto izcB8; A2IVf: goto g6wlx; goto zOnpX; xwRBR: $this->_cache_user_in_group[$user_id] = []; goto Z9pKv; gNwi0: $group_ids = [$group_ids]; goto ffWgl; D3mip: return FALSE; goto mwTy9; s8vyt: if (is_array($group_ids)) { goto kWklE; } goto gNwi0; uJRX_: g6wlx: goto SJ2xD; mwTy9: jE61r: goto pZwpn; uIiQP: ZKFyy: goto vixpg; SJ2xD: return $return; goto nxEFd; OC1yL: foreach ($group_ids as $group_id) { goto Mgcbx; hEyoN: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto N2dxz; } goto EbadP; Fs9vJ: gAoNQ: goto P2COS; Mgcbx: $this->db->delete($this->tables["\165\163\145\162\x73\137\147\162\157\165\x70\x73"], [$this->join["\x67\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\x75\x73\x65\x72\163"] => (float) $user_id]); goto hEyoN; tYZkj: N2dxz: goto Fs9vJ; EbadP: unset($this->_cache_user_in_group[$user_id][$group_id]); goto tYZkj; P2COS: } goto uIiQP; nxEFd: } public function groups() { goto uYuJe; Fss5J: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto Dk7Jo; nRZvv: if (!isset($this->_ion_limit)) { goto O2nGn; } goto IKObF; nnTdF: $this->_ion_offset = NULL; goto lxuMG; RvPrk: O2nGn: goto GBVaU; nEpTg: rYDyE: goto CCT_V; CAWKt: yd_uQ: goto M32u0; yeNSr: $this->_ion_limit = NULL; goto RvPrk; fof0c: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto yd_uQ; } goto nRZvv; JvrS8: $this->_ion_limit = NULL; goto nnTdF; lxuMG: pLE1c: goto waXNQ; M32u0: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto JvrS8; Sk5XE: return $this; goto obJKj; GBVaU: goto pLE1c; goto CAWKt; IKObF: $this->db->limit($this->_ion_limit); goto yeNSr; Dk7Jo: DtOoU: goto WJi3J; waXNQ: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto DtOoU; } goto Fss5J; O6O3M: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto VV7jy; } goto iv2fU; CCT_V: $this->_ion_where = []; goto Ux70Z; WJi3J: $this->response = $this->db->get($this->tables["\147\x72\x6f\165\x70\x73"]); goto Sk5XE; iv2fU: foreach ($this->_ion_where as $where) { $this->db->where($where); XFPxI: } goto nEpTg; Ux70Z: VV7jy: goto fof0c; uYuJe: $this->trigger_events("\147\x72\157\165\x70\163"); goto O6O3M; obJKj: } public function group($id = NULL) { goto Q05OB; XeCJT: WpR7e: goto bv8iQ; OokVV: $this->order_by("\151\144", "\144\145\163\143"); goto bBpRG; bBpRG: return $this->groups(); goto ay9Do; bv8iQ: $this->limit(1); goto OokVV; Q05OB: $this->trigger_events("\x67\162\157\x75\x70"); goto OlSQv; OlSQv: if (!isset($id)) { goto WpR7e; } goto yUQy2; yUQy2: $this->where($this->tables["\x67\x72\157\x75\160\x73"] . "\56\x69\x64", $id); goto XeCJT; ay9Do: } public function update($id, array $data) { goto ewfji; LYTdM: hXRa5: goto U0DCB; kw3Ua: if (!($this->db->trans_status() === FALSE)) { goto LURMv; } goto Gv62X; sj5h4: $this->set_error("\141\x63\x63\157\x75\156\x74\x5f\x63\162\145\x61\x74\151\157\156\x5f\x64\165\x70\154\x69\143\x61\164\145\x5f\151\144\x65\156\164\x69\x74\x79"); goto pmsVU; SVqIu: AFlLJ: goto VE9wH; YCw9C: if (!empty($data["\x70\141\163\x73\x77\157\x72\x64"])) { goto hXRa5; } goto iNCys; iDFQp: if (!array_key_exists("\x70\x61\x73\x73\x77\157\162\144", $data)) { goto AFlLJ; } goto YCw9C; rXDEw: $this->set_error("\x75\160\x64\x61\164\145\x5f\165\156\x73\x75\143\143\145\163\x73\146\x75\x6c"); goto VZ5Mb; U0DCB: $data["\160\141\x73\x73\x77\x6f\162\x64"] = $this->hash_password($data["\160\141\x73\163\167\x6f\162\144"], $user->{$this->identity_column}); goto MHksJ; vH86A: aPjyR: goto jENf6; GsFRi: $this->set_error("\165\160\x64\x61\x74\145\137\x75\156\163\x75\143\143\145\163\x73\146\165\154"); goto rApr3; pmsVU: $this->trigger_events(["\x70\157\x73\164\x5f\165\x70\144\141\164\x65\x5f\x75\x73\x65\162", "\160\157\163\x74\137\x75\x70\x64\141\164\x65\x5f\165\163\145\162\x5f\x75\x6e\163\x75\x63\143\145\163\x73\146\x75\x6c"]); goto GsFRi; A1X7d: $this->db->trans_commit(); goto lIvVI; lIvVI: $this->trigger_events(["\160\157\163\164\x5f\x75\160\x64\141\x74\x65\137\x75\x73\x65\162", "\160\157\x73\164\x5f\165\x70\x64\x61\x74\145\137\165\x73\x65\162\x5f\x73\x75\x63\143\x65\163\x73\146\x75\154"]); goto WOrLK; KXfN_: return FALSE; goto QQcsu; oaAS1: return TRUE; goto cfxDD; ewfji: $this->trigger_events("\x70\162\145\x5f\165\160\144\x61\164\145\x5f\x75\x73\x65\162"); goto Wch07; rApr3: return FALSE; goto Nzk13; Hdzix: $data = $this->_filter_data($this->tables["\165\163\x65\162\163"], $data); goto rEGCR; jENf6: LoZqk: goto SVqIu; LxF4K: $this->trigger_events(["\x70\157\163\x74\x5f\165\x70\x64\141\x74\145\137\165\163\145\162", "\160\157\x73\x74\137\165\160\144\141\164\145\x5f\165\163\x65\162\x5f\x75\156\x73\165\x63\143\145\x73\x73\146\x75\154"]); goto ZzpGV; Wch07: $user = $this->user($id)->row(); goto eoqHh; Nzk13: Is_7B: goto Hdzix; eoqHh: $this->db->trans_begin(); goto XhDgp; QclR0: $this->db->trans_rollback(); goto S_K42; VE9wH: wBWir: goto t4UFV; t4UFV: $this->trigger_events("\x65\x78\164\162\x61\137\167\x68\x65\x72\145"); goto nKQv1; sab9e: $this->db->trans_rollback(); goto sj5h4; S_K42: $this->trigger_events(["\x70\157\x73\164\137\x75\x70\144\141\164\145\x5f\x75\x73\x65\162", "\x70\x6f\x73\164\x5f\165\x70\x64\141\x74\145\x5f\165\163\x65\x72\137\165\x6e\163\165\143\x63\145\163\163\x66\165\x6c"]); goto rXDEw; QQcsu: LURMv: goto A1X7d; Gv62X: $this->db->trans_rollback(); goto LxF4K; MHksJ: if (!($data["\x70\141\x73\163\x77\157\162\144"] === FALSE)) { goto aPjyR; } goto QclR0; VZ5Mb: return FALSE; goto vH86A; ZzpGV: $this->set_error("\x75\160\x64\x61\x74\x65\137\165\x6e\x73\165\143\x63\x65\163\x73\x66\165\x6c"); goto KXfN_; nKQv1: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $data, ["\151\x64" => $user->id]); goto kw3Ua; WOrLK: $this->set_message("\x75\x70\144\x61\164\x65\x5f\163\x75\143\x63\x65\x73\x73\x66\x75\154"); goto oaAS1; rEGCR: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\141\x73\x73\167\157\162\x64", $data) || array_key_exists("\145\155\x61\x69\154", $data))) { goto wBWir; } goto iDFQp; XhDgp: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto Is_7B; } goto sab9e; k2cF7: goto LoZqk; goto LYTdM; iNCys: unset($data["\160\x61\163\x73\x77\157\x72\144"]); goto k2cF7; cfxDD: } public function delete_user($id) { goto AtQba; oByYD: return FALSE; goto sUhKM; LmzB_: return TRUE; goto tH__4; wdCzj: $this->db->trans_begin(); goto n71d2; AtQba: $this->trigger_events("\160\x72\145\137\x64\x65\x6c\x65\x74\x65\137\165\163\145\x72"); goto wdCzj; trVch: $this->db->trans_rollback(); goto k8mrH; FIdcy: $this->db->trans_commit(); goto o4Olz; sUhKM: dUYeQ: goto FIdcy; BTfn0: $this->db->delete($this->tables["\x75\x73\145\162\163"], ["\151\144" => $id]); goto zEKay; SntKc: $this->set_message("\144\145\x6c\145\164\x65\x5f\x73\x75\143\143\x65\163\x73\146\165\x6c"); goto LmzB_; zEKay: if (!($this->db->trans_status() === FALSE)) { goto dUYeQ; } goto trVch; k8mrH: $this->trigger_events(["\160\157\163\x74\x5f\144\145\x6c\x65\164\145\x5f\165\x73\145\x72", "\x70\157\163\164\x5f\144\x65\154\145\x74\x65\x5f\x75\163\x65\162\137\165\x6e\x73\165\x63\x63\x65\x73\163\146\x75\154"]); goto jujop; jujop: $this->set_error("\144\x65\x6c\145\x74\x65\137\x75\x6e\163\165\x63\143\x65\163\163\146\165\x6c"); goto oByYD; n71d2: $this->remove_from_group(NULL, $id); goto BTfn0; o4Olz: $this->trigger_events(["\x70\x6f\x73\164\x5f\144\x65\154\145\x74\x65\x5f\x75\163\145\162", "\x70\x6f\x73\x74\137\144\145\x6c\x65\164\x65\x5f\x75\163\x65\162\137\163\x75\x63\143\145\x73\x73\x66\x75\154"]); goto SntKc; tH__4: } public function update_last_login($id) { goto YhpHk; YhpHk: $this->trigger_events("\165\160\x64\x61\x74\x65\137\154\141\163\164\137\x6c\157\147\x69\156"); goto YRGDG; YRGDG: $this->load->helper("\x64\141\164\x65"); goto Emxbo; moOiY: $this->db->update($this->tables["\x75\x73\x65\162\163"], ["\154\x61\x73\164\137\x6c\x6f\x67\x69\156" => time()], ["\x69\x64" => $id]); goto ykXHB; Emxbo: $this->trigger_events("\x65\170\164\x72\141\137\x77\x68\145\162\145"); goto moOiY; ykXHB: return $this->db->affected_rows() == 1; goto LPHoi; LPHoi: } public function set_lang($lang = "\145\x6e") { goto oaBIF; Hb7C0: if ($this->config->item("\x75\x73\x65\162\x5f\x65\x78\160\151\162\145", "\151\x6f\156\137\141\x75\164\x68") === 0) { goto GEr19; } goto ZoWep; ZoWep: $expire = $this->config->item("\x75\x73\145\162\x5f\x65\x78\160\151\162\x65", "\151\x6f\156\x5f\x61\x75\x74\x68"); goto Apj9f; QLTvI: set_cookie(["\156\x61\155\145" => "\154\141\156\x67\x5f\x63\157\144\145", "\x76\x61\154\x75\x65" => $lang, "\x65\x78\160\151\162\145" => $expire]); goto By563; Apj9f: goto mmV26; goto X2bji; By563: return TRUE; goto t8i3f; XXjIX: mmV26: goto QLTvI; oaBIF: $this->trigger_events("\x73\x65\x74\x5f\x6c\x61\x6e\147"); goto Hb7C0; nozXq: $expire = self::MAX_COOKIE_LIFETIME; goto XXjIX; X2bji: GEr19: goto nozXq; t8i3f: } public function set_session($user) { goto HsmqV; gvOE7: $this->trigger_events("\x70\x6f\163\164\x5f\163\x65\x74\x5f\x73\145\163\x73\x69\x6f\x6e"); goto gGMoM; HsmqV: $this->trigger_events("\160\x72\x65\x5f\163\145\x74\x5f\163\145\x73\163\x69\x6f\x6e"); goto hBoD1; gGMoM: return TRUE; goto QEzrm; EsBfn: $this->session->set_userdata($session_data); goto gvOE7; hBoD1: $session_data = ["\151\144\x65\156\x74\x69\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\x69\154" => $user->email, "\x75\x73\x65\x72\137\x69\144" => $user->id, "\x6f\154\x64\x5f\154\x61\x73\164\x5f\154\157\147\151\x6e" => $user->last_login, "\154\141\163\x74\137\143\150\145\x63\153" => time()]; goto EsBfn; QEzrm: } public function remember_user($identity) { goto v3AF8; wv0f2: $this->trigger_events(["\160\157\163\164\137\x72\145\x6d\145\x6d\x62\145\x72\x5f\165\163\x65\x72", "\x72\145\155\145\x6d\x62\x65\162\137\x75\x73\x65\x72\137\165\x6e\x73\165\143\143\x65\x73\163\x66\165\x6c"]); goto LRu19; dxLow: nnc5P: goto qqF1S; Ovupf: $expire = self::MAX_COOKIE_LIFETIME; goto MEdOk; i89ny: if (!$token->validator_hashed) { goto HBEqS; } goto w58WO; RFrFQ: $token = $this->_generate_selector_validator_couple(); goto i89ny; GslSn: $expire = $this->config->item("\x75\x73\145\x72\x5f\x65\170\x70\x69\162\x65", "\x69\157\x6e\x5f\x61\x75\164\150"); goto tiNGZ; P9kzb: return TRUE; goto dxLow; tiNGZ: goto mlhDg; goto x1eTo; w58WO: $this->db->update($this->tables["\x75\163\145\x72\x73"], ["\x72\x65\x6d\x65\155\x62\145\x72\x5f\x73\x65\x6c\x65\x63\164\157\162" => $token->selector, "\x72\145\x6d\x65\x6d\x62\x65\162\137\x63\157\144\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto Jx1lC; gn1dy: $this->trigger_events(["\x70\157\x73\x74\137\x72\145\155\x65\155\142\x65\x72\x5f\165\163\x65\x72", "\x72\145\x6d\x65\155\x62\x65\162\x5f\x75\163\x65\162\137\x73\x75\143\x63\145\163\163\146\x75\x6c"]); goto P9kzb; EyFGz: if ($this->config->item("\x75\x73\145\162\137\145\170\160\151\162\145", "\x69\x6f\156\137\x61\x75\164\150") === 0) { goto CtJkh; } goto GslSn; E_SQK: rGL_O: goto RFrFQ; MEdOk: mlhDg: goto DNFh8; DNFh8: set_cookie(["\156\x61\155\x65" => $this->config->item("\x72\x65\155\145\155\142\x65\x72\137\143\157\157\153\x69\145\x5f\x6e\x61\155\x65", "\151\157\x6e\x5f\x61\165\164\150"), "\x76\141\x6c\165\x65" => $token->user_code, "\145\170\160\151\162\145" => $expire]); goto gn1dy; LRu19: return FALSE; goto Nd50O; Jx1lC: if (!($this->db->affected_rows() > -1)) { goto nnc5P; } goto EyFGz; yLUb3: if ($identity) { goto rGL_O; } goto BIKoI; x1eTo: CtJkh: goto Ovupf; qqF1S: HBEqS: goto wv0f2; v3AF8: $this->trigger_events("\x70\162\145\137\x72\x65\x6d\x65\x6d\142\145\162\x5f\165\x73\145\162"); goto yLUb3; BIKoI: return FALSE; goto E_SQK; Nd50O: } public function login_remembered_user() { goto eZXNo; iG47c: $this->set_session($user); goto rbeT4; SlqL1: zpArv: goto Tiz3z; zaoik: $query = $this->db->select($this->identity_column . "\54\x20\151\144\x2c\x20\x65\x6d\141\151\x6c\x2c\x20\x72\x65\x6d\145\x6d\x62\145\162\137\x63\x6f\x64\x65\x2c\40\x6c\x61\x73\164\x5f\x6c\x6f\147\x69\x6e")->where("\x72\x65\x6d\145\155\x62\145\162\x5f\163\x65\x6c\x65\143\x74\x6f\162", $token->selector)->where("\141\143\x74\x69\166\x65", 1)->limit(1)->get($this->tables["\x75\163\145\162\163"]); goto mgB03; eZXNo: $this->trigger_events("\x70\x72\145\x5f\x6c\x6f\x67\151\x6e\x5f\162\145\x6d\145\155\142\x65\162\145\144\137\165\163\x65\162"); goto CMnfw; CMnfw: $remember_cookie = get_cookie($this->config->item("\162\x65\x6d\x65\155\x62\145\162\137\x63\x6f\x6f\x6b\x69\x65\137\x6e\x61\155\x65", "\x69\x6f\156\x5f\x61\x75\164\150")); goto SAugF; SAugF: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto q5KFC; gtMr1: $identity = $user->{$this->identity_column}; goto KZmC0; rbeT4: $this->clear_forgotten_password_code($identity); goto xin0Q; mgB03: if (!($query->num_rows() === 1)) { goto HToj1; } goto orFGw; toJ_v: mfVPP: goto PGSUw; Yr0Uo: $this->trigger_events(["\160\x6f\163\x74\137\154\157\x67\151\x6e\x5f\162\145\x6d\145\155\142\145\x72\x65\x64\137\165\x73\x65\162", "\x70\x6f\x73\x74\x5f\x6c\x6f\147\151\156\x5f\x72\145\155\145\x6d\x62\x65\x72\145\x64\137\x75\163\145\162\x5f\165\156\163\x75\143\143\x65\x73\163\x66\x75\x6c"]); goto EkxVp; FLVYf: $this->trigger_events(["\160\x6f\x73\x74\x5f\154\x6f\147\x69\156\137\x72\145\155\145\x6d\x62\x65\x72\145\144\137\x75\163\145\162", "\x70\157\x73\x74\137\x6c\157\x67\x69\156\137\x72\x65\x6d\x65\155\x62\x65\x72\x65\x64\137\165\163\x65\x72\137\163\165\143\x63\145\163\x73\146\165\x6c"]); goto aHm8k; Tiz3z: $this->session->sess_regenerate(FALSE); goto FLVYf; zBzHD: $this->update_last_login($user->id); goto iG47c; DtHEE: HToj1: goto DgR0B; DgR0B: delete_cookie($this->config->item("\162\145\x6d\145\155\x62\145\162\137\x63\157\x6f\153\151\x65\137\x6e\141\155\x65", "\x69\157\156\x5f\141\x75\164\x68")); goto Yr0Uo; xin0Q: if (!$this->config->item("\165\x73\x65\162\137\x65\x78\164\x65\x6e\x64\137\157\x6e\x5f\x6c\157\x67\151\156", "\151\157\156\137\141\x75\164\150")) { goto zpArv; } goto vxh3r; EkxVp: return FALSE; goto x1C9k; orFGw: $user = $query->row(); goto gtMr1; vxh3r: $this->remember_user($identity); goto SlqL1; q5KFC: if (!($token === FALSE)) { goto mfVPP; } goto Pj3kT; W7vMT: return FALSE; goto toJ_v; PGSUw: $this->trigger_events("\145\x78\164\x72\x61\137\x77\x68\145\x72\x65"); goto zaoik; YD2PX: T2eeU: goto DtHEE; aHm8k: return TRUE; goto YD2PX; KZmC0: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto T2eeU; } goto zBzHD; Pj3kT: $this->trigger_events(["\160\157\x73\x74\137\x6c\x6f\x67\x69\x6e\137\x72\145\x6d\145\155\142\x65\x72\x65\144\137\165\x73\x65\162", "\160\157\x73\x74\137\x6c\157\x67\151\156\137\162\x65\155\x65\155\x62\x65\x72\x65\x64\137\x75\x73\145\162\137\x75\x6e\163\165\143\x63\x65\163\x73\146\x75\x6c"]); goto W7vMT; x1C9k: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto Jd8KT; Jd8KT: if ($group_name) { goto WHcGA; } goto DgNzS; K1gRA: if (!($existing_group !== 0)) { goto C31Ku; } goto D_JTm; OCw2K: if (empty($additional_data)) { goto SCp2Y; } goto o64ZS; DgNzS: $this->set_error("\x67\162\157\165\160\x5f\x6e\x61\x6d\x65\137\x72\145\161\165\x69\x72\x65\x64"); goto A6F59; MXZp3: $data = ["\156\141\x6d\145" => $group_name, "\x64\145\x73\143\162\x69\160\x74\x69\157\156" => $group_description]; goto OCw2K; tITIo: $this->db->insert($this->tables["\x67\162\157\x75\160\163"], $data); goto lW4PQ; LzhSZ: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\x6e\x61\155\x65" => $group_name])->num_rows(); goto K1gRA; o64ZS: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\x75\160\x73"], $additional_data), $data); goto BuH5s; BuH5s: SCp2Y: goto bGC1B; BypCE: return FALSE; goto HwTYH; A6F59: return FALSE; goto PiU2c; PiU2c: WHcGA: goto LzhSZ; yqswI: return $group_id; goto V4M5P; D_JTm: $this->set_error("\x67\x72\157\x75\x70\137\x61\154\x72\x65\x61\144\171\x5f\x65\x78\151\x73\x74\x73"); goto BypCE; HwTYH: C31Ku: goto MXZp3; bGC1B: $this->trigger_events("\145\x78\164\162\x61\137\147\162\157\x75\x70\x5f\163\145\x74"); goto tITIo; lW4PQ: $group_id = $this->db->insert_id($this->tables["\147\x72\x6f\165\160\163"] . "\137\x69\144\x5f\x73\145\161"); goto SxtF4; SxtF4: $this->set_message("\147\x72\x6f\x75\160\137\143\x72\145\141\x74\x69\x6f\x6e\137\163\165\x63\x63\145\x73\163\146\x75\x6c"); goto yqswI; V4M5P: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto JQ4QO; Uu4fN: return FALSE; goto tVLdi; JQ4QO: if (!empty($group_id)) { goto tqeHr; } goto Uu4fN; bfkhk: $data = []; goto OXQT2; HU06k: CHcEl: goto zysen; L72F8: return TRUE; goto JmB7q; rtJqT: $this->set_error("\147\162\157\165\160\x5f\141\x6c\162\145\x61\x64\x79\x5f\x65\170\x69\163\x74\x73"); goto M27rU; M27rU: return FALSE; goto HU06k; DBBs3: xfpQI: goto ggWHR; NvXOv: YzUfo: goto Tm32q; Moq7r: return FALSE; goto NvXOv; mT9LP: $group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\x69\144" => $group_id])->row(); goto K2fix; K2fix: if (!($this->config->item("\141\144\x6d\151\x6e\x5f\147\162\157\165\160", "\151\x6f\x6e\x5f\x61\x75\x74\x68") === $group->name && $group_name !== $group->name)) { goto YzUfo; } goto V1AiC; OXQT2: if (empty($group_name)) { goto iESM3; } goto OLZkl; OLZkl: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\x75\x70\163"], ["\x6e\141\x6d\145" => $group_name])->row(); goto mHbI9; iXQv6: iESM3: goto mT9LP; Tm32q: if (empty($additional_data)) { goto xfpQI; } goto p54IX; mHbI9: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto CHcEl; } goto rtJqT; ggWHR: $this->db->update($this->tables["\147\x72\157\165\160\x73"], $data, ["\x69\144" => $group_id]); goto jErdb; p54IX: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\x75\160\163"], $additional_data), $data); goto DBBs3; zysen: $data["\156\x61\x6d\145"] = $group_name; goto iXQv6; jErdb: $this->set_message("\147\x72\x6f\x75\x70\x5f\x75\160\144\141\x74\x65\137\x73\165\x63\143\145\163\163\146\165\154"); goto L72F8; V1AiC: $this->set_error("\147\x72\x6f\165\160\137\156\141\155\145\x5f\x61\x64\x6d\x69\x6e\137\156\157\164\137\141\154\164\145\x72"); goto Moq7r; tVLdi: tqeHr: goto bfkhk; JmB7q: } public function delete_group($group_id = FALSE) { goto jNFMz; SFxi7: $this->set_error("\x67\162\x6f\165\x70\137\x64\x65\154\145\x74\145\x5f\156\157\x74\141\154\x6c\157\x77\x65\x64"); goto kBEk8; tjm8W: EV3y1: goto MPskg; wVL7H: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x64\145\154\x65\164\145\137\147\162\x6f\165\160", "\160\x6f\x73\164\137\x64\145\x6c\x65\x74\x65\137\147\x72\157\165\x70\x5f\156\157\x74\141\154\154\x6f\167\x65\x64"]); goto SFxi7; jNFMz: if (!(!$group_id || empty($group_id))) { goto qag6w; } goto QJQUB; nnzPj: $group = $this->group($group_id)->row(); goto dKcmY; UBwta: $this->db->trans_begin(); goto Xgsi0; kBEk8: return FALSE; goto s3QOq; Xgsi0: $this->db->delete($this->tables["\x75\x73\x65\162\x73\x5f\x67\162\x6f\165\x70\163"], [$this->join["\147\x72\157\x75\160\x73"] => $group_id]); goto gfFRh; QJQUB: return FALSE; goto ZCaZ1; a9TTm: if (!($this->db->trans_status() === FALSE)) { goto EV3y1; } goto RJMLe; MPskg: $this->db->trans_commit(); goto RqGWQ; Sg7gg: $this->trigger_events("\x70\162\145\137\144\145\x6c\145\164\145\137\x67\x72\x6f\165\160"); goto UBwta; ZCaZ1: qag6w: goto nnzPj; RqGWQ: $this->trigger_events(["\x70\x6f\163\x74\x5f\144\145\x6c\145\x74\x65\x5f\147\x72\x6f\165\x70", "\x70\x6f\x73\x74\137\144\145\154\x65\x74\x65\x5f\147\x72\157\165\160\x5f\x73\x75\x63\143\145\x73\163\x66\x75\154"]); goto X67e8; QoqWs: return TRUE; goto LBIei; s3QOq: B6yPX: goto Sg7gg; pZXFn: return FALSE; goto tjm8W; RJMLe: $this->db->trans_rollback(); goto l7Fs6; Ikf13: $this->set_error("\147\x72\157\x75\x70\137\144\145\154\145\x74\145\137\165\x6e\x73\165\x63\143\145\x73\163\x66\165\x6c"); goto pZXFn; dKcmY: if (!($group->name == $this->config->item("\x61\144\155\151\x6e\x5f\147\162\x6f\x75\x70", "\x69\x6f\x6e\x5f\141\x75\x74\150"))) { goto B6yPX; } goto wVL7H; gfFRh: $this->db->delete($this->tables["\x67\x72\x6f\x75\160\x73"], ["\151\144" => $group_id]); goto a9TTm; X67e8: $this->set_message("\147\162\x6f\165\x70\x5f\x64\145\x6c\x65\164\x65\137\x73\x75\x63\x63\145\163\163\146\165\x6c"); goto QoqWs; l7Fs6: $this->trigger_events(["\160\157\163\x74\x5f\144\145\x6c\145\164\x65\137\147\162\157\165\160", "\x70\x6f\163\164\137\144\x65\154\145\164\x65\137\x67\162\157\x75\x70\137\x75\x6e\x73\165\143\143\145\163\x73\146\x75\x6c"]); goto Ikf13; LBIei: } public function set_hook($event, $name, $class, $method, $arguments) { goto FaLYc; rZwVH: $this->_ion_hooks->{$event}[$name]->class = $class; goto UOs_X; UOs_X: $this->_ion_hooks->{$event}[$name]->method = $method; goto swECb; swECb: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto XCe4D; FaLYc: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto rZwVH; XCe4D: } public function remove_hook($event, $name) { goto ZamhM; zD3LQ: gKM0z: goto Abcxw; fcS5K: unset($this->_ion_hooks->{$event}[$name]); goto zD3LQ; ZamhM: if (!isset($this->_ion_hooks->{$event}[$name])) { goto gKM0z; } goto fcS5K; Abcxw: } public function remove_hooks($event) { goto LmX0P; jp2q9: unset($this->_ion_hooks->{$event}); goto m4TF7; LmX0P: if (!isset($this->_ion_hooks->{$event})) { goto jfoz2; } goto jp2q9; m4TF7: jfoz2: goto h5QrJ; h5QrJ: } protected function _call_hook($event, $name) { goto c51Wo; c51Wo: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto eszFq; } goto XgrWV; XgrWV: $hook = $this->_ion_hooks->{$event}[$name]; goto Xy6B3; zmq5E: return FALSE; goto nt1sg; P5KEr: eszFq: goto zmq5E; Xy6B3: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto P5KEr; nt1sg: } public function trigger_events($events) { goto k5EP8; J6H9X: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); tE7XM: } goto qEyRt; kupzW: btn_b: goto olVZu; yz1lb: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto btn_b; } goto J6H9X; Gi1XT: iTJ4C: goto bbcQd; bbcQd: foreach ($events as $event) { $this->trigger_events($event); B3y9c: } goto F_rUF; k5EP8: if (is_array($events) && !empty($events)) { goto iTJ4C; } goto yz1lb; olVZu: goto JQmV3; goto Gi1XT; F_rUF: C_3io: goto MjzFE; qEyRt: uYcVS: goto kupzW; MjzFE: JQmV3: goto OURnN; OURnN: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto UngqG; J3gBE: return TRUE; goto bcY2D; Js9c7: $this->message_end_delimiter = $end_delimiter; goto J3gBE; UngqG: $this->message_start_delimiter = $start_delimiter; goto Js9c7; bcY2D: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto He7Iv; quSyd: return TRUE; goto TFRHw; ZoNDU: $this->error_end_delimiter = $end_delimiter; goto quSyd; He7Iv: $this->error_start_delimiter = $start_delimiter; goto ZoNDU; TFRHw: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto nlJMq; Ragiv: foreach ($this->messages as $message) { goto wtQFW; wtQFW: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto NBRIM; NBRIM: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto kaul5; kaul5: GAGA9: goto wp5XV; wp5XV: } goto L0Jsy; k_ut5: return $_output; goto m_Z5S; L0Jsy: U3d6U: goto k_ut5; nlJMq: $_output = ''; goto Ragiv; m_Z5S: } public function messages_array($langify = TRUE) { goto bG_F3; gzAbq: $_output = []; goto imFxW; j5fcN: goto FmW11; goto eEeKC; eEeKC: itoeK: goto gzAbq; SUof1: return $this->messages; goto j5fcN; imFxW: foreach ($this->messages as $message) { goto KJGh9; KJGh9: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto ssXB4; xbdi0: E2zt9: goto G2ZzZ; ssXB4: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto xbdi0; G2ZzZ: } goto c3fdp; c3fdp: a5HK9: goto siR_E; siR_E: return $_output; goto FD461; FD461: FmW11: goto jUhaX; bG_F3: if ($langify) { goto itoeK; } goto SUof1; jUhaX: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto RXa4V; hunW6: dmsft: goto Sw9R8; Sw9R8: return $_output; goto EQ_E9; RXa4V: $_output = ''; goto Ic22T; Ic22T: foreach ($this->errors as $error) { goto lCveW; unNvv: wkl5V: goto CeqzQ; DEp02: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto unNvv; lCveW: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\x23\43"; goto DEp02; CeqzQ: } goto hunW6; EQ_E9: } public function errors_array($langify = TRUE) { goto ZcdnV; BLZFo: foreach ($this->errors as $error) { goto ytFAK; quzhG: x7HHv: goto R8dqO; g_8ZQ: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto quzhG; ytFAK: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\43"; goto g_8ZQ; R8dqO: } goto PSaY6; RXbuB: return $this->errors; goto rmzd0; Q2fOG: $_output = []; goto BLZFo; erq_F: return $_output; goto WgviX; iuA_5: SRMwd: goto Q2fOG; rmzd0: goto YFjBx; goto iuA_5; PSaY6: tsXKo: goto erq_F; ZcdnV: if ($langify) { goto SRMwd; } goto RXbuB; WgviX: YFjBx: goto LOUiC; LOUiC: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto A3Zpl; qAo2U: return FALSE; goto tiR2U; ygUkE: $this->trigger_events("\x65\x78\164\162\141\x5f\x77\150\145\162\x65"); goto hYDRe; a5GZE: return $this->db->affected_rows() == 1; goto C0it3; fuGpO: $data = ["\160\x61\x73\x73\167\157\x72\x64" => $hash, "\162\x65\x6d\145\x6d\142\x65\162\x5f\143\157\144\145" => NULL, "\x66\157\x72\x67\157\x74\x74\145\156\x5f\x70\141\163\x73\x77\x6f\x72\144\x5f\x63\157\144\x65" => NULL, "\146\x6f\162\147\x6f\164\x74\145\156\x5f\160\141\163\x73\167\x6f\x72\144\x5f\164\x69\x6d\x65" => NULL]; goto ygUkE; hYDRe: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto a5GZE; tiR2U: sYItl: goto fuGpO; A3Zpl: $hash = $this->hash_password($password, $identity); goto dz9O4; dz9O4: if (!($hash === FALSE)) { goto sYItl; } goto qAo2U; C0it3: } protected function _filter_data($table, $data) { goto VTnKD; SaviB: return $filtered_data; goto xxULx; w3pqo: if (!is_array($data)) { goto Pj7ps; } goto Rx2r1; VTnKD: $filtered_data = []; goto pJAK4; pJAK4: $columns = $this->db->list_fields($table); goto w3pqo; yVC6o: tUvZO: goto x0Ni7; Rx2r1: foreach ($columns as $column) { goto AIwPF; Q04T1: bdni7: goto G6NI0; BS2Mo: aF9CB: goto Q04T1; O4g3t: $filtered_data[$column] = $data[$column]; goto BS2Mo; AIwPF: if (!array_key_exists($column, $data)) { goto aF9CB; } goto O4g3t; G6NI0: } goto yVC6o; x0Ni7: Pj7ps: goto SaviB; xxULx: } protected function _random_token($result_length = 32) { goto CFhZN; CFhZN: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto P2Tw0; } goto dCqKY; wiCej: return bin2hex(random_bytes($result_length / 2)); goto tRidp; yKCu7: return FALSE; goto FXs9K; XHnSI: if (!function_exists("\157\160\145\x6e\163\x73\154\x5f\162\x61\156\x64\157\x6d\137\160\x73\x65\x75\x64\x6f\137\142\x79\x74\145\163")) { goto feCcF; } goto AE8we; p9oA3: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto eV8at; GXwg8: if (!function_exists("\155\x63\x72\171\x70\x74\137\x63\x72\145\x61\x74\145\x5f\151\x76")) { goto Gxi_f; } goto p9oA3; eV8at: Gxi_f: goto XHnSI; tRidp: PZIwc: goto GXwg8; opa7a: if (!function_exists("\x72\x61\x6e\144\157\155\x5f\142\171\x74\x65\x73")) { goto PZIwc; } goto wiCej; uyLI8: feCcF: goto yKCu7; dCqKY: $result_length = 32; goto qXFtk; AE8we: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto uyLI8; qXFtk: P2Tw0: goto opa7a; FXs9K: } protected function _get_hash_parameters($identity = NULL) { goto OGc0A; A29N6: $params = FALSE; goto Njznc; cUCN6: bGqAh: goto FKkdr; OGc0A: $is_admin = FALSE; goto etbwk; FKkdr: EW0XU: goto A29N6; hTv84: $is_admin = TRUE; goto cUCN6; RBOQw: if (!($user_id && $this->in_group($this->config->item("\x61\144\155\151\x6e\x5f\x67\x72\157\x75\160", "\151\x6f\x6e\x5f\x61\165\164\150"), $user_id))) { goto bGqAh; } goto hTv84; lnTJb: return $params; goto goDnt; etbwk: if (!$identity) { goto EW0XU; } goto EeqZe; Njznc: switch ($this->hash_method) { case "\x62\x63\162\x79\x70\164": $params = ["\x63\157\x73\x74" => $is_admin ? $this->config->item("\142\143\x72\171\160\x74\x5f\141\144\155\151\156\x5f\x63\x6f\163\x74", "\151\x6f\x6e\x5f\141\165\164\x68") : $this->config->item("\142\143\162\x79\160\164\x5f\x64\145\x66\141\x75\154\x74\x5f\143\x6f\x73\164", "\x69\157\x6e\x5f\x61\165\x74\150")]; goto h3THU; case "\141\x72\x67\157\x6e\x32": $params = $is_admin ? $this->config->item("\x61\x72\x67\x6f\156\x32\137\x61\x64\x6d\x69\156\x5f\160\x61\x72\x61\155\x73", "\x69\157\156\137\141\x75\x74\150") : $this->config->item("\x61\x72\x67\157\156\x32\137\x64\145\x66\141\x75\154\x74\x5f\160\x61\162\x61\155\163", "\151\x6f\156\x5f\141\x75\x74\x68"); goto h3THU; default: } goto raSf5; EeqZe: $user_id = $this->get_user_id_from_identity($identity); goto RBOQw; s2CZz: h3THU: goto lnTJb; raSf5: wDIE6: goto s2CZz; goDnt: } protected function _get_hash_algo() { goto nC2n4; vhB23: switch ($this->hash_method) { case "\142\143\162\171\160\164": $algo = PASSWORD_BCRYPT; goto vEBIQ; case "\x61\x72\x67\157\156\62": $algo = PASSWORD_ARGON2I; goto vEBIQ; default: } goto Ekmam; v9g6c: vEBIQ: goto jVho8; Ekmam: Vm_2I: goto v9g6c; jVho8: return $algo; goto W3H1S; nC2n4: $algo = FALSE; goto vhB23; W3H1S: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto ZfZom; ZfZom: $selector = $this->_random_token($selector_size); goto DKZRD; DKZRD: $validator = $this->_random_token($validator_size); goto RxmV1; LDqyl: $user_code = "{$selector}\56{$validator}"; goto IBAd9; IBAd9: return (object) ["\x73\x65\154\x65\143\x74\x6f\x72" => $selector, "\166\x61\154\151\x64\x61\164\157\162\137\x68\x61\x73\150\x65\144" => $validator_hashed, "\x75\x73\145\162\137\143\157\144\145" => $user_code]; goto gY7Zp; RxmV1: $validator_hashed = $this->hash_password($validator); goto LDqyl; gY7Zp: } protected function _retrieve_selector_validator_couple($user_code) { goto Yt1Ir; FHSe1: return FALSE; goto Phc81; hCcmB: return (object) ["\x73\145\x6c\145\143\164\157\162" => $tokens[0], "\166\x61\154\x69\x64\141\x74\x6f\162" => $tokens[1]]; goto QJkjt; Yt1Ir: if (!$user_code) { goto SNHdA; } goto wNzZ_; sGlrZ: SNHdA: goto FHSe1; QJkjt: OGyEv: goto sGlrZ; wNzZ_: $tokens = explode("\x2e", $user_code); goto ydp0X; ydp0X: if (!(count($tokens) === 2)) { goto OGyEv; } goto hCcmB; Phc81: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto wwNDZ; h1DRt: SmMUH: goto Byc6E; RbzwT: y842v: goto vIT4O; euOoL: goto SmMUH; goto RbzwT; vIT4O: $this->trigger_events(["\x70\157\x73\164\137\163\150\x61\x31\x5f\160\x61\x73\163\167\157\x72\x64\x5f\155\x69\x67\x72\141\x74\x69\157\x6e", "\160\157\x73\164\137\x73\x68\141\61\137\x70\141\x73\163\167\157\162\x64\137\155\x69\147\162\141\164\151\x6f\x6e\x5f\163\x75\143\x63\145\x73\x73\146\165\x6c"]); goto h1DRt; T_RgM: goto gazTT; goto jj5H3; ymI9z: $hashed_password = sha1($password . $salt_db->salt); goto R98Tu; VA4Ja: $this->trigger_events(["\x70\157\163\164\x5f\163\x68\141\x31\137\x70\x61\163\163\167\x6f\162\144\x5f\x6d\x69\x67\162\141\x74\x69\157\x6e", "\160\157\163\x74\x5f\x73\150\141\61\137\160\141\x73\x73\x77\x6f\x72\x64\137\x6d\151\x67\x72\141\x74\151\x6f\156\137\165\156\x73\165\143\x63\145\163\x73\x66\165\x6c"]); goto euOoL; eR46R: $result = $this->_set_password_db($identity, $password); goto rY_w2; p5Fk2: $this->trigger_events(["\x70\157\163\x74\x5f\163\150\x61\x31\137\x70\141\x73\x73\167\x6f\x72\144\137\x6d\x69\x67\x72\141\164\x69\157\156", "\x70\157\163\x74\x5f\x73\x68\141\x31\x5f\160\141\x73\x73\x77\157\162\144\137\x6d\151\x67\162\141\164\x69\157\x6e\x5f\x75\156\x73\x75\143\143\x65\x73\x73\x66\165\x6c"]); goto jnTZq; q02cT: $query = $this->db->select("\163\141\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\x65\162\163"]); goto Lqi2d; jnTZq: return FALSE; goto gzCSP; KEns5: $this->trigger_events(["\x70\157\163\x74\x5f\163\x68\x61\61\x5f\x70\x61\163\x73\167\x6f\162\144\x5f\155\x69\147\x72\141\164\151\157\x6e", "\x70\157\x73\164\137\x73\150\141\x31\137\160\141\x73\163\x77\157\x72\144\x5f\155\151\147\x72\141\164\151\157\x6e\x5f\x75\x6e\163\165\x63\x63\x65\163\163\146\x75\154"]); goto UA2if; R98Tu: gazTT: goto d2qtq; J_K31: if (!($query->num_rows() !== 1)) { goto mZllH; } goto p5Fk2; bRlfu: caMQ6: goto eR46R; VDMV_: $this->trigger_events(["\160\x6f\x73\164\x5f\163\150\141\61\137\160\x61\163\x73\167\157\x72\x64\x5f\x6d\151\x67\162\x61\164\151\157\156", "\x70\157\163\164\137\x73\x68\x61\61\x5f\x70\141\163\163\x77\157\x72\144\x5f\155\151\x67\x72\x61\x74\151\x6f\156\137\165\156\x73\x75\x63\143\x65\163\x73\x66\x75\x6c"]); goto UNGR_; VOFND: DBTJF: goto wyLMn; zRMoA: $salt_length = $this->config->item("\163\141\x6c\x74\137\154\145\x6e\147\x74\x68", "\x69\157\x6e\x5f\x61\x75\x74\x68"); goto sWGfD; sWGfD: if ($salt_length) { goto cktw9; } goto VDMV_; gzCSP: mZllH: goto ymI9z; jj5H3: sTQCa: goto q02cT; Lqi2d: $salt_db = $query->row(); goto J_K31; Io11f: if ($this->config->item("\x73\164\157\x72\x65\137\163\x61\154\x74", "\151\x6f\156\x5f\141\x75\164\x68")) { goto sTQCa; } goto zRMoA; InrtE: cktw9: goto zXML2; rY_w2: if ($result) { goto y842v; } goto VA4Ja; wwNDZ: $this->trigger_events("\160\162\145\137\163\x68\x61\x31\x5f\160\x61\x73\x73\x77\x6f\162\x64\x5f\x6d\x69\147\x72\141\164\x69\157\156"); goto Io11f; Byc6E: return $result; goto VOFND; zXML2: $salt = substr($hashed_password_db, 0, $salt_length); goto LRg5k; UA2if: return FALSE; goto YutK6; d2qtq: if ($hashed_password === $hashed_password_db) { goto caMQ6; } goto KEns5; UNGR_: return FALSE; goto InrtE; YutK6: goto DBTJF; goto bRlfu; LRg5k: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto T_RgM; wyLMn: } }
