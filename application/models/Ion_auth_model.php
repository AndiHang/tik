<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\120\x41\124\x48") or exit("\x4e\x6f\40\144\x69\x72\x65\x63\x74\40\163\143\x72\151\x70\164\40\141\143\x63\x65\x73\x73\40\141\154\x6c\157\x77\x65\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto TtTSS; YcKPk: $this->tables = $this->config->item("\164\141\x62\154\x65\163", "\151\x6f\x6e\x5f\141\165\164\150"); goto VnhEe; AlGYP: $this->errors = []; goto XYh8y; gC921: if ($delimiters_source === "\146\157\x72\x6d\x5f\x76\141\154\x69\x64\x61\x74\x69\x6f\x6e") { goto Olx9B; } goto qISBP; havND: $this->hash_method = $this->config->item("\x68\141\163\x68\x5f\155\145\x74\x68\x6f\144", "\x69\157\156\x5f\141\x75\x74\x68"); goto puhIp; SatnN: $this->load->library("\146\x6f\162\x6d\137\166\x61\154\151\x64\x61\x74\x69\x6f\x6e"); goto Xya1g; CSXIA: goto TfSOo; goto w3d1Q; VnhEe: $this->identity_column = $this->config->item("\x69\144\145\156\164\151\164\x79", "\151\x6f\156\x5f\x61\165\x74\150"); goto M7Aij; RwnOS: $this->message_end_delimiter = $this->error_end_delimiter; goto Kocz7; qISBP: $this->message_start_delimiter = $this->config->item("\x6d\145\163\x73\141\147\145\137\163\164\x61\162\164\137\144\x65\154\151\x6d\x69\x74\x65\x72", "\x69\157\x6e\137\x61\x75\164\150"); goto oOhjP; Hhbix: $this->_ion_hooks = new stdClass(); goto SFtzV; nv5Qw: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto edIsB; tSgjV: $this->db = $CI->db; goto LVajV; r88SZ: $this->db = $this->load->database($group_name, TRUE, TRUE); goto MOi_t; LtQmB: $error_prefix->setAccessible(TRUE); goto nv5Qw; VlFJd: $error_suffix->setAccessible(TRUE); goto CUmWu; TtTSS: $this->config->load("\x69\157\x6e\x5f\141\x75\x74\x68", TRUE); goto d3EHs; SFtzV: $this->trigger_events("\155\x6f\x64\x65\x6c\137\x63\157\x6e\x73\164\162\x75\x63\x74\157\x72"); goto cp7qX; XYh8y: $delimiters_source = $this->config->item("\144\x65\x6c\151\x6d\x69\164\145\162\x73\137\x73\157\x75\162\143\145", "\x69\157\x6e\x5f\x61\x75\x74\x68"); goto gC921; w3d1Q: Olx9B: goto SatnN; LVajV: k8sTo: goto YcKPk; gXGkD: VRJFD: goto kt8nh; CUmWu: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto RwnOS; d3EHs: $this->load->helper("\x63\x6f\157\x6b\151\x65"); goto i0BO6; Lp_4A: if (empty($group_name)) { goto VRJFD; } goto r88SZ; YVRwV: $error_suffix = $form_validation_class->getProperty("\137\145\162\162\157\x72\137\163\165\146\x66\x69\170"); goto VlFJd; NLV2F: $error_prefix = $form_validation_class->getProperty("\137\145\162\162\x6f\x72\x5f\x70\x72\145\146\x69\170"); goto LtQmB; i0BO6: $this->load->helper("\144\141\x74\145"); goto WIa4v; FxmT7: $this->error_start_delimiter = $this->config->item("\145\x72\x72\x6f\162\x5f\163\x74\141\162\164\x5f\x64\x65\x6c\x69\155\x69\164\145\162", "\151\157\x6e\137\141\165\164\150"); goto dZBFC; edIsB: $this->message_start_delimiter = $this->error_start_delimiter; goto YVRwV; kt8nh: $CI =& get_instance(); goto tSgjV; M7Aij: $this->join = $this->config->item("\x6a\x6f\x69\x6e", "\151\157\156\137\141\165\164\150"); goto havND; Kocz7: TfSOo: goto Hhbix; oOhjP: $this->message_end_delimiter = $this->config->item("\x6d\x65\x73\x73\141\147\145\137\x65\156\x64\x5f\144\145\154\x69\155\x69\x74\x65\162", "\151\157\156\x5f\x61\x75\164\150"); goto FxmT7; dZBFC: $this->error_end_delimiter = $this->config->item("\145\x72\162\x6f\x72\137\145\x6e\x64\x5f\x64\145\x6c\151\x6d\x69\164\145\162", "\x69\157\x6e\137\x61\165\164\150"); goto CSXIA; WIa4v: $this->lang->load("\x69\x6f\156\137\x61\x75\x74\x68"); goto WABOM; MOi_t: goto k8sTo; goto gXGkD; WABOM: $group_name = $this->config->item("\x64\141\x74\x61\x62\x61\x73\x65\x5f\147\x72\157\165\160\137\x6e\141\x6d\x65", "\x69\x6f\156\x5f\141\165\x74\150"); goto Lp_4A; puhIp: $this->messages = []; goto AlGYP; Xya1g: $form_validation_class = new ReflectionClass("\x43\x49\137\x46\x6f\162\155\x5f\166\x61\x6c\151\144\x61\164\151\157\156"); goto NLV2F; cp7qX: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto qvN3G; YlNyM: return password_hash($password, $algo, $params); goto OQ_uY; BB0g1: $params = $this->_get_hash_parameters($identity); goto i0SbO; OQ_uY: GssvG: goto zjV2M; JqItV: return FALSE; goto k0jk8; D3ppT: $algo = $this->_get_hash_algo(); goto BB0g1; i0SbO: if (!($algo !== FALSE && $params !== FALSE)) { goto GssvG; } goto YlNyM; qvN3G: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto J_K_x; } goto JqItV; zjV2M: return FALSE; goto XpC4m; k0jk8: J_K_x: goto D3ppT; XpC4m: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto TQMEk; Z9owu: if (strpos($hash_password_db, "\x24") === 0) { goto z3MGl; } goto lqskS; lqskS: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto NTDyL; hYH95: z3MGl: goto NUEtX; NUEtX: return password_verify($password, $hash_password_db); goto HaI5R; TQMEk: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto nWYSS; } goto zmvNx; NTDyL: goto iTa9s; goto hYH95; zrpNN: nWYSS: goto Z9owu; HaI5R: iTa9s: goto K4U3c; zmvNx: return FALSE; goto zrpNN; K4U3c: } public function rehash_password_if_needed($hash, $identity, $password) { goto RRtXY; UZOuI: if (!password_needs_rehash($hash, $algo, $params)) { goto r9KnS; } goto tT9z9; tjuuV: if (!($algo !== FALSE && $params !== FALSE)) { goto bztwU; } goto UZOuI; h6hFN: fhYTH: goto C3v78; HUlUe: bztwU: goto OwOfU; jlmCO: goto BT5VR; goto h6hFN; ukC2s: r9KnS: goto HUlUe; C3v78: $this->trigger_events(["\162\145\150\x61\x73\x68\137\x70\141\x73\x73\x77\157\162\144", "\x72\145\x68\141\x73\x68\137\160\x61\163\163\x77\x6f\162\144\137\x73\165\x63\x63\145\163\x73\146\x75\154"]); goto Tl5nP; ESnpi: $params = $this->_get_hash_parameters($identity); goto tjuuV; RRtXY: $algo = $this->_get_hash_algo(); goto ESnpi; Tl5nP: BT5VR: goto ukC2s; tT9z9: if ($this->_set_password_db($identity, $password)) { goto fhYTH; } goto R_HCZ; R_HCZ: $this->trigger_events(["\x72\x65\x68\x61\163\x68\x5f\x70\141\x73\163\x77\x6f\162\x64", "\162\x65\150\141\163\150\x5f\x70\x61\x73\163\x77\x6f\162\144\x5f\165\156\x73\165\143\x63\145\163\x73\x66\x75\154"]); goto jlmCO; OwOfU: } public function get_user_by_activation_code($user_code) { goto h5r4s; R2CsN: if (!$user) { goto Y0Rv4; } goto x82CM; h5r4s: $token = $this->_retrieve_selector_validator_couple($user_code); goto Bq5Xx; Hnhe6: I2dIN: goto MVgv5; MVgv5: Y0Rv4: goto Vv4Ic; g2oln: return $user; goto Hnhe6; x82CM: if (!$this->verify_password($token->validator, $user->activation_code)) { goto I2dIN; } goto g2oln; Vv4Ic: return FALSE; goto nZuuU; Bq5Xx: $user = $this->where("\141\143\x74\x69\x76\x61\x74\x69\157\x6e\x5f\163\145\x6c\145\143\164\157\x72", $token->selector)->users()->row(); goto R2CsN; nZuuU: } public function activate($id, $code = FALSE) { goto dRJdo; gJdOD: if (!($this->db->affected_rows() === 1)) { goto aH8M3; } goto iW_tR; c5bf7: $this->set_message("\x61\x63\x74\x69\166\141\x74\x65\x5f\163\x75\143\x63\x65\163\x73\146\165\154"); goto U0mAq; jUqzK: $this->set_error("\x61\x63\x74\x69\166\x61\164\x65\x5f\165\x6e\x73\x75\x63\143\145\163\163\x66\165\154"); goto sgQD3; VF9GX: $data = ["\141\x63\x74\x69\166\x61\164\151\157\x6e\137\163\145\x6c\x65\x63\164\x6f\x72" => NULL, "\x61\143\x74\x69\166\141\164\x69\x6f\156\x5f\x63\157\144\x65" => NULL, "\x61\143\x74\x69\x76\145" => 1]; goto VBrXQ; y52yS: $this->db->update($this->tables["\165\x73\x65\162\163"], $data, ["\151\x64" => $id]); goto gJdOD; EevwW: if (!($code === FALSE || $user && $user->id === $id)) { goto GyVqa; } goto VF9GX; Iiqn6: Dq8cJ: goto EevwW; VBrXQ: $this->trigger_events("\x65\170\x74\x72\141\137\167\150\x65\x72\145"); goto y52yS; iW_tR: $this->trigger_events(["\160\x6f\x73\x74\137\141\143\x74\x69\x76\x61\x74\x65", "\160\157\163\164\x5f\x61\143\x74\x69\166\x61\164\145\137\163\165\143\x63\145\163\163\146\x75\154"]); goto c5bf7; dRJdo: $this->trigger_events("\x70\162\145\137\141\x63\x74\151\x76\x61\x74\145"); goto I0svm; IJfV6: aH8M3: goto iuzOm; O6Pac: $user = $this->get_user_by_activation_code($code); goto Iiqn6; sgQD3: return FALSE; goto MNUlJ; I0svm: if (!($code !== FALSE)) { goto Dq8cJ; } goto O6Pac; xMv9Y: $this->trigger_events(["\160\157\163\x74\x5f\141\x63\164\151\x76\141\164\x65", "\x70\157\x73\x74\x5f\x61\143\164\x69\166\141\x74\145\137\165\x6e\x73\x75\143\143\x65\x73\x73\146\x75\x6c"]); goto jUqzK; U0mAq: return TRUE; goto IJfV6; iuzOm: GyVqa: goto xMv9Y; MNUlJ: } public function deactivate($id = NULL) { goto zbyr0; mEq2t: XgeVv: goto bBw3c; LZTMe: $this->set_error("\x64\145\x61\143\x74\x69\166\141\164\145\137\x75\x6e\163\x75\143\x63\145\163\163\x66\x75\154"); goto lzurf; rpOms: yi2XQ: goto uwE10; ihye8: $this->trigger_events("\145\x78\164\162\x61\x5f\x77\150\145\x72\145"); goto XG3hg; onarR: return $return; goto jE9zs; bBw3c: $token = $this->_generate_selector_validator_couple(20, 40); goto l2tiy; e8uRi: if ($return) { goto CDVJe; } goto LZTMe; uRBYR: goto XgeVv; goto rpOms; hHWgm: $return = $this->db->affected_rows() == 1; goto e8uRi; l2tiy: $this->activation_code = $token->user_code; goto WUizi; zbyr0: $this->trigger_events("\x64\145\x61\143\x74\x69\166\x61\164\x65"); goto mWlwb; uwE10: $this->set_error("\x64\145\141\x63\164\x69\166\x61\x74\145\x5f\x75\156\163\x75\143\143\145\x73\x73\146\165\154"); goto glhOa; NNW9D: c7_Z_: goto uRBYR; y8pD8: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto c7_Z_; } goto Zn34K; Zn34K: $this->set_error("\x64\x65\x61\x63\x74\x69\166\141\164\x65\137\143\165\162\162\145\156\164\137\165\163\x65\x72\x5f\165\156\163\x75\143\x63\145\x73\163\146\165\154"); goto G8Rwy; mWlwb: if (!isset($id)) { goto yi2XQ; } goto y8pD8; GkDCC: CDVJe: goto xLdz1; G8Rwy: return FALSE; goto NNW9D; lzurf: goto YbeD8; goto GkDCC; ehIwX: YbeD8: goto onarR; xLdz1: $this->set_message("\144\x65\x61\x63\164\151\166\141\164\x65\x5f\x73\x75\143\143\x65\x73\x73\146\165\154"); goto ehIwX; glhOa: return FALSE; goto mEq2t; WUizi: $data = ["\141\x63\164\x69\x76\x61\x74\151\157\x6e\x5f\x73\x65\154\x65\x63\x74\157\162" => $token->selector, "\141\143\164\151\166\141\164\x69\x6f\x6e\137\143\x6f\144\145" => $token->validator_hashed, "\x61\x63\x74\151\x76\x65" => 0]; goto ihye8; XG3hg: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, ["\151\x64" => $id]); goto hHWgm; jE9zs: } public function clear_forgotten_password_code($identity) { goto pgX53; xyntP: return TRUE; goto h7yEm; Eouyc: $this->db->update($this->tables["\x75\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto xyntP; FeXtH: return FALSE; goto TEteX; pgX53: if (!empty($identity)) { goto meMdS; } goto FeXtH; TEteX: meMdS: goto nm8C8; nm8C8: $data = ["\146\157\x72\147\157\164\164\x65\x6e\137\x70\x61\163\x73\x77\x6f\162\x64\137\163\145\154\145\143\x74\x6f\162" => NULL, "\x66\157\162\147\157\x74\x74\x65\156\137\160\141\163\x73\167\x6f\162\x64\x5f\143\157\144\x65" => NULL, "\x66\157\x72\x67\x6f\164\164\x65\x6e\x5f\x70\141\x73\x73\167\x6f\x72\144\x5f\164\x69\x6d\145" => NULL]; goto Eouyc; h7yEm: } public function clear_remember_code($identity) { goto i_2si; OYrGu: return TRUE; goto o4rhj; HP1Yj: return FALSE; goto iOqa_; hC_7G: $data = ["\x72\145\155\145\x6d\142\145\x72\137\x73\145\x6c\145\143\x74\157\162" => NULL, "\x72\145\155\x65\x6d\142\145\162\137\143\157\144\145" => NULL]; goto tJGhH; tJGhH: $this->db->update($this->tables["\x75\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto OYrGu; iOqa_: JCQsn: goto hC_7G; i_2si: if (!empty($identity)) { goto JCQsn; } goto HP1Yj; o4rhj: } public function reset_password($identity, $new) { goto QNRds; CRtEh: icAjb: goto nb4kq; fK7PD: pDFoJ: goto CKHzc; rbvxR: if ($return) { goto icAjb; } goto BTl7o; QNRds: $this->trigger_events("\160\162\145\137\143\150\141\x6e\147\x65\137\160\141\163\x73\x77\157\x72\144"); goto JPUyb; Rxa2p: $this->trigger_events(["\160\x6f\163\164\x5f\x63\150\x61\x6e\147\x65\137\x70\141\163\x73\x77\x6f\x72\144", "\x70\157\163\x74\x5f\x63\x68\x61\x6e\x67\145\137\x70\x61\x73\163\167\157\162\144\137\x75\x6e\x73\165\143\143\145\163\x73\146\165\154"]); goto eORdb; vEemh: $this->set_error("\x70\x61\163\x73\x77\x6f\162\144\x5f\143\150\x61\156\x67\x65\137\165\156\163\x75\x63\143\145\163\x73\146\165\x6c"); goto wYA4n; Bp2TY: $return = $this->_set_password_db($identity, $new); goto rbvxR; eORdb: return FALSE; goto lLH64; CKHzc: return $return; goto p9ONf; DMFFO: $this->set_message("\160\141\163\x73\x77\x6f\162\x64\x5f\x63\x68\141\156\147\x65\137\x73\x75\x63\x63\145\163\x73\x66\x75\x6c"); goto fK7PD; BTl7o: $this->trigger_events(["\160\157\163\164\x5f\143\150\141\156\x67\x65\x5f\x70\141\163\x73\167\x6f\162\x64", "\160\157\163\x74\x5f\143\x68\x61\x6e\x67\145\x5f\x70\x61\163\x73\167\x6f\162\x64\x5f\x75\156\x73\x75\143\143\145\x73\163\x66\165\154"]); goto vEemh; nb4kq: $this->trigger_events(["\x70\x6f\163\x74\137\143\150\141\x6e\x67\145\x5f\160\x61\x73\x73\x77\x6f\x72\144", "\x70\157\x73\164\137\x63\150\x61\156\x67\145\x5f\x70\x61\163\x73\167\x6f\162\144\137\163\x75\143\x63\x65\163\x73\146\165\154"]); goto DMFFO; wYA4n: goto pDFoJ; goto CRtEh; lLH64: dT9ue: goto Bp2TY; JPUyb: if ($this->identity_check($identity)) { goto dT9ue; } goto Rxa2p; p9ONf: } public function change_password($identity, $old, $new) { goto gyLIw; fC6Eo: $this->set_error("\160\141\x73\x73\167\157\x72\144\137\143\150\x61\x6e\147\145\137\165\156\163\165\143\x63\x65\163\x73\146\165\x6c"); goto w4GYd; k5AZA: if ($result) { goto dE56P; } goto BlFc1; kw744: goto JdaqF; goto UNQWP; BlFc1: $this->trigger_events(["\160\157\x73\164\137\143\150\141\156\147\145\x5f\x70\x61\163\163\x77\157\x72\144", "\160\157\x73\164\137\x63\150\x61\x6e\x67\145\x5f\x70\x61\163\x73\x77\x6f\x72\x64\x5f\x75\x6e\163\x75\x63\x63\x65\163\163\146\165\154"]); goto TUXV2; kcdgt: return FALSE; goto DWKOG; z2yH_: $this->trigger_events(["\160\157\163\164\137\x63\150\x61\156\147\145\137\x70\141\163\x73\167\x6f\162\144", "\x70\157\163\164\x5f\x63\x68\141\x6e\x67\x65\x5f\x70\x61\163\163\167\157\162\x64\137\x73\165\x63\x63\x65\163\163\x66\165\154"]); goto E8zHC; gyLIw: $this->trigger_events("\160\x72\145\137\143\x68\x61\x6e\x67\145\x5f\x70\x61\163\163\x77\157\162\144"); goto A5DIh; KUvgS: $this->trigger_events(["\160\157\x73\164\x5f\143\x68\141\156\x67\x65\x5f\160\141\163\163\x77\157\x72\x64", "\x70\x6f\x73\x74\137\143\x68\x61\x6e\147\145\137\x70\141\x73\163\x77\157\162\144\137\165\x6e\163\165\143\143\x65\163\163\146\165\x6c"]); goto fC6Eo; z6Bd4: if (!($query->num_rows() !== 1)) { goto NyO60; } goto KUvgS; LJi9H: NyO60: goto ZnBXL; edvRW: $query = $this->db->select("\151\x64\54\40\160\141\163\163\167\x6f\x72\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\x65\x73\x63")->get($this->tables["\165\163\145\x72\x73"]); goto z6Bd4; A5DIh: $this->trigger_events("\145\170\164\x72\141\x5f\167\x68\145\162\x65"); goto edvRW; pVaiS: jCl45: goto Yvv3I; TUXV2: $this->set_error("\x70\x61\163\x73\167\x6f\x72\144\137\143\150\x61\x6e\x67\145\x5f\165\156\163\x75\x63\x63\145\163\x73\x66\x75\154"); goto kw744; E8zHC: $this->set_message("\x70\x61\x73\163\167\x6f\162\x64\x5f\143\150\x61\156\x67\x65\x5f\163\165\143\x63\145\x73\x73\146\x75\154"); goto IXpIc; Yvv3I: $this->set_error("\x70\x61\163\163\x77\x6f\162\144\137\143\x68\x61\x6e\147\145\137\x75\x6e\x73\x75\x63\x63\x65\163\x73\146\x75\x6c"); goto kcdgt; KSX6I: return $result; goto pVaiS; jf_4r: if (!$this->verify_password($old, $user->password, $identity)) { goto jCl45; } goto Jp59j; ZnBXL: $user = $query->row(); goto jf_4r; w4GYd: return FALSE; goto LJi9H; UNQWP: dE56P: goto z2yH_; Jp59j: $result = $this->_set_password_db($identity, $new); goto k5AZA; IXpIc: JdaqF: goto KSX6I; DWKOG: } public function username_check($username = '') { goto scxcg; BBMwm: if (!empty($username)) { goto mc9mc; } goto gJEIg; gJEIg: return FALSE; goto VnJoa; Y9My_: return $this->db->where("\165\163\145\x72\x6e\x61\155\x65", $username)->limit(1)->count_all_results($this->tables["\x75\163\145\162\x73"]) > 0; goto kPgW0; COeKo: $this->trigger_events("\x65\x78\x74\162\141\x5f\167\x68\x65\x72\145"); goto Y9My_; VnJoa: mc9mc: goto COeKo; scxcg: $this->trigger_events("\x75\x73\145\x72\x6e\141\x6d\x65\137\x63\150\x65\x63\x6b"); goto BBMwm; kPgW0: } public function email_check($email = '') { goto q79b5; qEnMd: UkJsy: goto VNLGq; VNLGq: $this->trigger_events("\145\x78\x74\x72\x61\x5f\x77\x68\x65\x72\145"); goto IwRRG; q79b5: $this->trigger_events("\x65\x6d\141\x69\x6c\x5f\143\150\x65\143\x6b"); goto IIsa8; IwRRG: return $this->db->where("\145\x6d\141\151\154", $email)->limit(1)->count_all_results($this->tables["\165\163\145\x72\163"]) > 0; goto lxFmR; IIsa8: if (!empty($email)) { goto UkJsy; } goto Cf2C4; Cf2C4: return FALSE; goto qEnMd; lxFmR: } public function identity_check($identity = '') { goto jDwtY; Vd5dg: if (!empty($identity)) { goto fXqJY; } goto dc32I; UUZR2: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\x73"]) > 0; goto iyMqR; XlkYg: fXqJY: goto UUZR2; dc32I: return FALSE; goto XlkYg; jDwtY: $this->trigger_events("\151\144\145\x6e\x74\151\x74\171\137\143\x68\145\x63\153"); goto Vd5dg; iyMqR: } public function get_user_id_from_identity($identity = '') { goto pDYt7; PtCPL: if (!($query->num_rows() !== 1)) { goto SRPDL; } goto WTg_p; hKtO5: $user = $query->row(); goto wjqss; yOXzV: return FALSE; goto TcOfb; TcOfb: fAxOs: goto R1p96; HQVw7: SRPDL: goto hKtO5; pDYt7: if (!empty($identity)) { goto fAxOs; } goto yOXzV; wjqss: return $user->id; goto KFKMb; WTg_p: return FALSE; goto HQVw7; R1p96: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\x72\163"]); goto PtCPL; KFKMb: } public function forgotten_password($identity) { goto ZeAK6; ecu4h: $this->trigger_events(["\160\x6f\163\164\x5f\x66\157\162\x67\x6f\x74\x74\145\156\x5f\160\x61\163\163\x77\x6f\x72\x64", "\x70\x6f\163\164\137\x66\x6f\x72\147\157\x74\x74\145\x6e\137\160\141\163\x73\167\x6f\162\x64\x5f\x75\156\x73\165\x63\143\x65\163\163\x66\x75\x6c"]); goto G1T2g; uKNxy: $this->trigger_events(["\160\x6f\163\164\137\x66\157\x72\x67\157\x74\164\145\x6e\x5f\x70\x61\163\x73\167\x6f\162\x64", "\x70\157\163\164\137\x66\157\162\147\157\x74\164\x65\156\x5f\x70\141\163\163\x77\157\x72\144\x5f\x73\x75\143\143\x65\x73\163\146\165\x6c"]); goto jcekI; n936w: $this->trigger_events(["\160\x6f\x73\164\x5f\x66\x6f\x72\x67\157\x74\164\x65\156\137\160\141\163\163\x77\157\x72\x64", "\x70\x6f\x73\x74\x5f\x66\x6f\162\147\x6f\164\x74\145\x6e\x5f\x70\141\163\163\x77\157\x72\144\137\x75\x6e\x73\x75\x63\143\145\163\x73\x66\165\x6c"]); goto vscd3; jcekI: return $token->user_code; goto Iy8OB; ZeAK6: if (!empty($identity)) { goto yl07V; } goto n936w; W2Gdh: goto Ns2M6; goto NKeun; NKeun: WyCzt: goto uKNxy; PXrqu: if ($this->db->affected_rows() === 1) { goto WyCzt; } goto ecu4h; S7f6Z: yl07V: goto X6QMp; vscd3: return FALSE; goto S7f6Z; X6QMp: $token = $this->_generate_selector_validator_couple(20, 80); goto qDKRG; G1T2g: return FALSE; goto W2Gdh; vXMsY: $this->trigger_events("\145\170\x74\162\x61\137\x77\150\145\x72\145"); goto LQ89p; LQ89p: $this->db->update($this->tables["\165\163\145\162\163"], $update, [$this->identity_column => $identity]); goto PXrqu; qDKRG: $update = ["\x66\x6f\162\x67\157\x74\164\x65\x6e\x5f\x70\141\163\x73\167\157\x72\x64\137\x73\x65\154\x65\143\x74\x6f\x72" => $token->selector, "\x66\157\x72\147\x6f\164\x74\x65\x6e\137\160\141\x73\163\167\x6f\162\144\x5f\143\157\x64\145" => $token->validator_hashed, "\x66\157\x72\147\157\x74\164\145\156\x5f\160\141\163\163\167\x6f\162\144\x5f\164\151\x6d\x65" => time()]; goto vXMsY; Iy8OB: Ns2M6: goto un45q; un45q: } public function get_user_by_forgotten_password_code($user_code) { goto FueZM; FueZM: $token = $this->_retrieve_selector_validator_couple($user_code); goto GE9BN; DUObo: if (!$user) { goto a2oHc; } goto SG8Yi; OoWzs: a2oHc: goto Wv2Nh; GE9BN: $user = $this->where("\146\157\162\x67\157\x74\164\x65\x6e\137\160\x61\163\163\x77\157\x72\x64\x5f\163\x65\x6c\145\x63\x74\x6f\162", $token->selector)->users()->row(); goto DUObo; NTUf2: V7vRt: goto OoWzs; SG8Yi: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto V7vRt; } goto k0I0B; k0I0B: return $user; goto NTUf2; Wv2Nh: return FALSE; goto Bayyu; Bayyu: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto rjzrQ; v0PFO: goto bglmj; goto obwak; q75MM: $this->set_error("\141\x63\143\157\165\156\164\137\x63\162\145\141\164\151\157\156\x5f\155\151\x73\163\151\156\147\x5f\x64\x65\146\141\x75\x6c\164\x5f\x67\x72\x6f\x75\160"); goto J_v4Z; nQzPd: if (!($password === FALSE)) { goto ANstp; } goto RpGlW; A2ots: if (!(!$this->config->item("\x64\145\x66\141\x75\154\164\x5f\147\162\x6f\165\160", "\x69\x6f\156\x5f\141\165\x74\x68") && empty($groups))) { goto Rva9B; } goto q75MM; bltA1: return isset($id) ? $id : FALSE; goto jWM28; kB79l: $this->db->insert($this->tables["\x75\x73\x65\x72\x73"], $user_data); goto gjtpT; mv_PR: $default_group = $query; goto s0eCY; Pagd7: return FALSE; goto YrXlJ; uCRou: t2_lq: goto AuaIf; R7Ek2: $this->set_error("\141\x63\x63\157\x75\x6e\164\137\143\x72\x65\x61\x74\x69\x6f\156\137\x69\x6e\166\141\x6c\x69\x64\x5f\x64\145\x66\x61\165\154\x74\137\147\x72\157\165\160"); goto Pagd7; ZPNSd: if (!(isset($default_group->id) && empty($groups))) { goto uf1aw; } goto CoF1c; GHzEV: u34Yz: goto uCRou; rjzrQ: $this->trigger_events("\160\x72\x65\137\x72\x65\147\151\163\x74\145\162"); goto dGw5_; QsVVb: uf1aw: goto fgOd4; BZa02: return FALSE; goto vGigb; e2JF9: return FALSE; goto BNQn5; YrXlJ: zDMXV: goto mv_PR; CoF1c: $groups[] = $default_group->id; goto QsVVb; obwak: kWYme: goto W4Dvt; GJYZj: foreach ($groups as $group) { $this->add_to_group($group, $id); baAUE: } goto GHzEV; RpGlW: $this->set_error("\x61\x63\x63\157\x75\x6e\164\137\x63\x72\x65\141\x74\x69\x6f\156\x5f\165\x6e\x73\x75\143\143\145\x73\x73\146\165\154"); goto BZa02; HSxcG: if ($this->identity_check($identity)) { goto kWYme; } goto A2ots; gjtpT: $id = $this->db->insert_id($this->tables["\x75\x73\145\x72\163"] . "\x5f\151\x64\x5f\x73\145\161"); goto ZPNSd; W4Dvt: $this->set_error("\x61\x63\x63\x6f\165\x6e\x74\x5f\143\162\x65\x61\164\151\157\156\x5f\x64\x75\x70\x6c\x69\143\141\164\145\x5f\x69\144\145\x6e\164\151\x74\x79"); goto e2JF9; J_v4Z: return FALSE; goto qonXG; qonXG: Rva9B: goto v0PFO; grEuv: $password = $this->hash_password($password); goto nQzPd; vymiN: $query = $this->db->get_where($this->tables["\x67\x72\157\165\160\163"], ["\x6e\141\x6d\x65" => $this->config->item("\x64\145\146\x61\x75\x6c\x74\137\x67\162\157\165\x70", "\x69\157\x6e\x5f\x61\165\x74\x68")], 1)->row(); goto DxgOC; reqU6: $data = [$this->identity_column => $identity, "\x75\163\x65\162\156\x61\155\145" => $identity, "\x70\141\x73\163\x77\157\x72\144" => $password, "\145\155\x61\x69\154" => $email, "\151\160\x5f\x61\x64\x64\162\145\163\163" => $ip_address, "\x63\162\145\141\x74\145\144\137\x6f\x6e" => time(), "\141\x63\x74\x69\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto J8plt; BNQn5: bglmj: goto vymiN; fzgOT: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\163\x65\x74"); goto kB79l; s0eCY: $ip_address = $this->input->ip_address(); goto grEuv; dGw5_: $manual_activation = $this->config->item("\x6d\141\156\165\x61\x6c\x5f\x61\143\x74\151\x76\141\164\151\157\156", "\151\157\156\x5f\x61\x75\164\x68"); goto HSxcG; fgOd4: if (empty($groups)) { goto t2_lq; } goto GJYZj; J8plt: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\145\x72\x73"], $additional_data), $data); goto fzgOT; AuaIf: $this->trigger_events("\x70\157\163\x74\x5f\x72\145\x67\x69\x73\164\x65\162"); goto bltA1; vGigb: ANstp: goto reqU6; DxgOC: if (!(!isset($query->id) && empty($groups))) { goto zDMXV; } goto R7Ek2; jWM28: } public function login($identity, $password, $remember = FALSE) { goto O4rJ5; ocqRz: o6GM9: goto ecjTu; PE4Wg: $this->set_error("\154\x6f\x67\151\156\x5f\x75\x6e\163\165\143\x63\x65\163\x73\x66\x75\x6c"); goto fhaGY; wwUoM: $this->trigger_events("\x70\x6f\163\x74\x5f\154\157\147\x69\x6e\x5f\x75\x6e\163\x75\143\x63\145\x73\x73\x66\x75\154"); goto PE4Wg; Wwmc4: return TRUE; goto xWOmk; hgO08: $this->rehash_password_if_needed($user->password, $identity, $password); goto W70EH; MwZ8y: if ($remember) { goto o6GM9; } goto NtYBc; ecjTu: $this->remember_user($identity); goto dYXB_; bT6Kd: $user = $query->row(); goto nkYWT; OjTym: $this->hash_password($password); goto J0vEb; nkYWT: if (!$this->verify_password($password, $user->password, $identity)) { goto eBg9y; } goto zocGS; Xgkj3: $this->set_session($user); goto dW6K3; mbahn: if (!$this->is_max_login_attempts_exceeded($identity)) { goto UJlWE; } goto OjTym; dW6K3: $this->update_last_login($user->id); goto FUViM; O4rJ5: $this->trigger_events("\x70\x72\x65\x5f\154\x6f\147\151\x6e"); goto BCLlQ; BCLlQ: if (!(empty($identity) || empty($password))) { goto bNiL5; } goto V62lL; s9t5f: return FALSE; goto eg5gQ; D0L5C: vpksm: goto r9DSy; AFZ9J: $query = $this->db->select($this->identity_column . "\x2c\40\145\x6d\x61\x69\x6c\x2c\40\x69\x64\54\40\160\x61\163\163\167\x6f\x72\x64\x2c\x20\141\143\x74\151\166\x65\54\x20\x6c\x61\x73\164\x5f\x6c\157\x67\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\x65\x73\x63")->get($this->tables["\x75\163\145\x72\x73"]); goto mbahn; RcFgO: $this->set_message("\x6c\157\x67\x69\x6e\x5f\163\165\x63\x63\145\163\163\x66\x75\154"); goto Wwmc4; FUViM: $this->clear_login_attempts($identity); goto urPVc; NxSwg: return FALSE; goto A4hGh; urPVc: $this->clear_forgotten_password_code($identity); goto LHYeG; fXQBr: goto olqWa; goto ocqRz; nx7sm: $this->increase_login_attempts($identity); goto wwUoM; fhaGY: return FALSE; goto vOhaH; J0vEb: $this->trigger_events("\x70\x6f\163\x74\x5f\154\x6f\x67\151\156\137\x75\x6e\x73\x75\143\143\x65\163\x73\146\x75\x6c"); goto fDHOX; W70EH: $this->session->sess_regenerate(FALSE); goto Ul_19; MQv8d: if (!($query->num_rows() === 1)) { goto vpksm; } goto bT6Kd; AH6iN: return FALSE; goto Kzg2R; A4hGh: a67pH: goto Xgkj3; dYXB_: olqWa: goto iMFk7; FQQc_: $this->trigger_events("\x70\x6f\x73\x74\x5f\x6c\157\x67\x69\x6e\137\x75\x6e\163\165\x63\143\x65\x73\163\x66\x75\154"); goto IjpdD; NtYBc: $this->clear_remember_code($identity); goto fXQBr; V62lL: $this->set_error("\x6c\157\147\151\156\x5f\x75\x6e\x73\165\x63\143\145\163\163\x66\x75\x6c"); goto AH6iN; zocGS: if (!($user->active == 0)) { goto a67pH; } goto FQQc_; wRLTp: $this->trigger_events("\x65\x78\x74\162\141\x5f\167\x68\x65\162\145"); goto AFZ9J; eg5gQ: UJlWE: goto MQv8d; xWOmk: eBg9y: goto D0L5C; r9DSy: $this->hash_password($password); goto nx7sm; fDHOX: $this->set_error("\154\157\147\x69\156\x5f\164\x69\155\x65\157\165\164"); goto s9t5f; Ul_19: $this->trigger_events(["\x70\x6f\x73\164\x5f\x6c\x6f\147\151\156", "\x70\x6f\163\164\x5f\154\157\147\151\x6e\x5f\x73\x75\143\x63\145\x73\163\146\165\x6c"]); goto RcFgO; iMFk7: eQQqb: goto hgO08; IjpdD: $this->set_error("\154\x6f\x67\x69\x6e\x5f\x75\x6e\x73\x75\x63\143\145\x73\163\x66\165\154\x5f\156\157\164\137\141\x63\164\x69\166\145"); goto NxSwg; Kzg2R: bNiL5: goto wRLTp; LHYeG: if (!$this->config->item("\x72\x65\155\145\x6d\x62\x65\x72\x5f\165\x73\x65\x72\163", "\151\157\x6e\x5f\x61\165\x74\150")) { goto eQQqb; } goto MwZ8y; vOhaH: } public function recheck_session() { goto lUq1j; eCjC2: $last_login = $this->session->userdata("\154\x61\x73\x74\x5f\143\150\145\143\153"); goto OAVWa; WYKWa: if ($query->num_rows() === 1) { goto ioALf; } goto n0GkI; c2ykp: wgCBJ: goto Fdqsz; n9uFB: ioALf: goto Q5rir; y3rW2: goto taLLQ; goto n9uFB; Fdqsz: K7cfx: goto U2bjb; k10dq: if (!($recheck !== 0)) { goto K7cfx; } goto eCjC2; lUq1j: $recheck = NULL !== $this->config->item("\162\145\143\150\x65\143\153\x5f\164\151\x6d\145\162", "\x69\157\x6e\x5f\141\x75\x74\150") ? $this->config->item("\162\145\x63\x68\145\x63\x6b\137\164\151\155\145\162", "\151\x6f\156\137\x61\165\x74\150") : 0; goto k10dq; t7sNw: $this->session->unset_userdata([$identity, "\x69\144", "\x75\x73\145\x72\137\x69\x64"]); goto UVszs; Q5rir: $this->session->set_userdata("\154\x61\163\164\x5f\x63\x68\145\143\153", time()); goto yDLW0; INGAy: $query = $this->db->select("\151\x64")->where([$this->identity_column => $this->session->userdata("\x69\x64\x65\156\x74\x69\164\x79"), "\141\143\164\x69\x76\x65" => "\x31"])->limit(1)->order_by("\151\144", "\144\x65\163\x63")->get($this->tables["\165\x73\145\162\x73"]); goto WYKWa; yDLW0: taLLQ: goto c2ykp; n0GkI: $this->trigger_events("\x6c\157\x67\x6f\165\x74"); goto XyS6G; U2bjb: return (bool) $this->session->userdata("\151\x64\145\x6e\164\x69\x74\x79"); goto HtBWP; XyS6G: $identity = $this->config->item("\x69\x64\x65\x6e\164\x69\x74\x79", "\151\x6f\156\x5f\x61\165\164\150"); goto t7sNw; OAVWa: if (!($last_login + $recheck < time())) { goto wgCBJ; } goto INGAy; UVszs: return FALSE; goto y3rW2; HtBWP: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto jflOL; zUNd5: if (!($max_attempts > 0)) { goto rcLgB; } goto wKNY9; QmGza: return FALSE; goto bcrOA; zUPJ0: $max_attempts = $this->config->item("\x6d\141\170\x69\155\x75\x6d\x5f\x6c\x6f\x67\151\x6e\137\x61\x74\164\145\x6d\160\x74\x73", "\x69\x6f\156\137\141\165\164\150"); goto zUNd5; jflOL: if (!$this->config->item("\164\162\x61\x63\153\x5f\x6c\x6f\x67\151\156\x5f\x61\x74\164\145\155\x70\164\163", "\x69\x6f\x6e\137\x61\x75\164\x68")) { goto UWIeC; } goto zUPJ0; JNxTs: UWIeC: goto QmGza; jsWXt: rcLgB: goto JNxTs; wKNY9: $attempts = $this->get_attempts_num($identity, $ip_address); goto Hqci4; Hqci4: return $attempts >= $max_attempts; goto jsWXt; bcrOA: } public function get_attempts_num($identity, $ip_address = NULL) { goto fYUIM; T7xEA: if (isset($ip_address)) { goto UHnyt; } goto k3bte; eGhrH: $this->db->where("\151\160\137\141\x64\x64\162\145\163\x73", $ip_address); goto jXzAd; k3bte: $ip_address = $this->input->ip_address(); goto ZacFT; FNBUV: return 0; goto By79D; AAqEA: $qres = $this->db->get($this->tables["\154\x6f\x67\151\156\x5f\x61\x74\164\145\155\160\x74\163"]); goto AJpnX; fpEVC: $this->db->where("\164\151\x6d\x65\x20\76", time() - $this->config->item("\x6c\157\143\153\x6f\x75\164\137\164\x69\155\x65", "\151\157\x6e\137\141\165\x74\x68"), FALSE); goto AAqEA; AJpnX: return $qres->num_rows(); goto ZuNJY; ZacFT: UHnyt: goto eGhrH; UECzM: $this->db->select("\x31", FALSE); goto U3IFV; jXzAd: u2wY3: goto fpEVC; ZuNJY: BaeR7: goto FNBUV; fYUIM: if (!$this->config->item("\164\162\141\143\153\137\154\157\x67\x69\x6e\x5f\x61\x74\164\145\x6d\x70\x74\x73", "\x69\157\x6e\137\x61\x75\x74\150")) { goto BaeR7; } goto UECzM; TLxBP: if (!$this->config->item("\x74\162\x61\x63\153\137\x6c\x6f\147\x69\156\137\x69\x70\137\141\x64\144\162\145\x73\163", "\151\x6f\156\137\x61\x75\164\150")) { goto u2wY3; } goto T7xEA; U3IFV: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto TLxBP; By79D: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto JPHcr; kZ507: $this->db->where("\154\x6f\147\151\x6e", $identity); goto eCEfL; UhmUt: return $qres->row()->time; goto huVB_; a4h3A: $this->db->where("\151\160\137\x61\144\x64\x72\145\163\x73", $ip_address); goto Ll2L_; Sgdjs: uI8TF: goto jZTpe; BtPpN: $this->db->order_by("\x69\144", "\x64\145\163\143"); goto NRITj; TP0We: if (isset($ip_address)) { goto DfeO2; } goto v3JPS; NRITj: $qres = $this->db->get($this->tables["\154\x6f\x67\151\156\x5f\141\164\164\x65\155\x70\164\x73"], 1); goto E_bAa; mHSyN: $this->db->select("\x74\x69\x6d\145"); goto kZ507; bq5An: DfeO2: goto a4h3A; E_bAa: if (!($qres->num_rows() > 0)) { goto Onq2H; } goto UhmUt; Ll2L_: pJ5te: goto BtPpN; v3JPS: $ip_address = $this->input->ip_address(); goto bq5An; huVB_: Onq2H: goto Sgdjs; eCEfL: if (!$this->config->item("\x74\162\141\x63\x6b\x5f\154\157\x67\x69\x6e\x5f\x69\160\137\141\x64\x64\162\x65\163\163", "\151\157\156\x5f\141\165\164\150")) { goto pJ5te; } goto TP0We; jZTpe: return 0; goto GbhBv; JPHcr: if (!$this->config->item("\x74\162\x61\x63\153\137\154\x6f\x67\151\x6e\x5f\141\x74\164\145\155\x70\x74\163", "\x69\x6f\x6e\x5f\141\x75\x74\150")) { goto uI8TF; } goto mHSyN; GbhBv: } public function get_last_attempt_ip($identity) { goto wnESj; GUGwM: uCAjj: goto GMCG2; ZJdin: return ''; goto PM46y; cFCUY: if (!($qres->num_rows() > 0)) { goto uCAjj; } goto pUvOJ; VKlEv: $qres = $this->db->get($this->tables["\x6c\157\x67\151\x6e\x5f\141\164\x74\x65\155\160\164\163"], 1); goto cFCUY; GMCG2: tYeFX: goto ZJdin; X1jf3: $this->db->where("\x6c\157\147\x69\x6e", $identity); goto h2V7u; pUvOJ: return $qres->row()->ip_address; goto GUGwM; h2V7u: $this->db->order_by("\x69\144", "\x64\x65\x73\x63"); goto VKlEv; wnESj: if (!($this->config->item("\164\x72\x61\143\x6b\x5f\x6c\x6f\147\151\156\x5f\141\x74\x74\x65\155\160\164\163", "\151\x6f\x6e\137\x61\x75\164\x68") && $this->config->item("\x74\x72\x61\143\153\x5f\x6c\157\x67\151\x6e\x5f\x69\160\137\x61\x64\x64\x72\x65\163\x73", "\x69\157\156\137\x61\x75\164\x68"))) { goto tYeFX; } goto m1NWk; m1NWk: $this->db->select("\151\160\x5f\x61\144\x64\x72\x65\x73\x73"); goto X1jf3; PM46y: } public function increase_login_attempts($identity) { goto N0v2c; eeksZ: kExo0: goto kwlgG; kwlgG: return $this->db->insert($this->tables["\154\157\147\x69\156\137\x61\x74\x74\x65\155\160\164\x73"], $data); goto S2Q1J; N0v2c: if (!$this->config->item("\164\x72\141\x63\153\x5f\x6c\157\x67\151\156\137\141\x74\x74\145\155\x70\164\x73", "\151\157\156\x5f\x61\x75\x74\150")) { goto tkyik; } goto qocl_; S2Q1J: tkyik: goto mA4W7; BSIeQ: $data["\151\x70\137\141\x64\144\162\145\x73\163"] = $this->input->ip_address(); goto eeksZ; Zw8QY: if (!$this->config->item("\164\x72\x61\143\x6b\137\154\157\x67\x69\x6e\x5f\151\160\137\141\x64\144\x72\x65\x73\163", "\x69\157\156\137\x61\165\x74\x68")) { goto kExo0; } goto BSIeQ; mA4W7: return FALSE; goto oO8oq; qocl_: $data = ["\x69\160\x5f\x61\144\x64\162\145\x73\x73" => '', "\154\157\147\151\x6e" => $identity, "\164\151\155\145" => time()]; goto Zw8QY; oO8oq: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto xibu7; xX0aA: if (isset($ip_address)) { goto zf6GI; } goto lIR6t; ExZvO: $this->db->where("\x69\160\137\x61\x64\144\162\145\163\x73", $ip_address); goto tRA8i; iLGOe: return FALSE; goto olbw3; lIR6t: $ip_address = $this->input->ip_address(); goto DI5kL; BfSpa: pWyvg: goto iLGOe; j1YSO: $this->db->where("\154\x6f\x67\151\156", $identity); goto mpb4o; DI5kL: zf6GI: goto ExZvO; xibu7: if (!$this->config->item("\164\162\141\x63\153\137\154\x6f\x67\x69\x6e\x5f\x61\164\x74\145\155\160\x74\x73", "\151\x6f\156\x5f\x61\165\x74\150")) { goto pWyvg; } goto Bg4JX; dGBt_: return $this->db->delete($this->tables["\154\157\x67\151\156\137\x61\164\164\x65\155\x70\x74\x73"]); goto BfSpa; Bg4JX: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\x63\153\x6f\x75\164\x5f\164\151\x6d\x65", "\x69\x6f\156\x5f\141\x75\x74\150")); goto j1YSO; mpb4o: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\x6c\157\x67\151\156\137\151\160\x5f\x61\144\144\162\145\163\163", "\x69\x6f\x6e\137\x61\x75\x74\150")) { goto yAhe0; } goto xX0aA; tRA8i: yAhe0: goto MNNAl; MNNAl: $this->db->or_where("\164\x69\x6d\x65\40\74", time() - $old_attempts_expire_period, FALSE); goto dGBt_; olbw3: } public function limit($limit) { goto cCDLJ; FH9gr: $this->_ion_limit = $limit; goto OA1S8; cCDLJ: $this->trigger_events("\x6c\151\x6d\151\x74"); goto FH9gr; OA1S8: return $this; goto n79is; n79is: } public function offset($offset) { goto tQkAn; yD3KI: return $this; goto TCgh4; g30Qu: $this->_ion_offset = $offset; goto yD3KI; tQkAn: $this->trigger_events("\157\146\x66\163\x65\x74"); goto g30Qu; TCgh4: } public function where($where, $value = NULL) { goto OjMdV; OjMdV: $this->trigger_events("\x77\150\145\x72\145"); goto VNvtt; c5l1L: array_push($this->_ion_where, $where); goto gUFSv; VNvtt: if (is_array($where)) { goto cDYOE; } goto A86DP; gUFSv: return $this; goto EoR2M; I423h: cDYOE: goto c5l1L; A86DP: $where = [$where => $value]; goto I423h; EoR2M: } public function like($like, $value = NULL, $position = "\x62\157\164\x68") { goto Nkdbl; Q9upP: return $this; goto TBgzj; Nkdbl: $this->trigger_events("\154\151\153\x65"); goto t2fPv; t2fPv: array_push($this->_ion_like, ["\154\151\153\x65" => $like, "\x76\141\154\x75\145" => $value, "\x70\x6f\x73\x69\x74\151\157\156" => $position]); goto Q9upP; TBgzj: } public function select($select) { goto rLGgE; rLGgE: $this->trigger_events("\163\x65\154\145\143\164"); goto mL2_o; auS8R: return $this; goto AzKz0; mL2_o: $this->_ion_select[] = $select; goto auS8R; AzKz0: } public function order_by($by, $order = "\144\145\x73\143") { goto K8tBW; ZLweQ: $this->_ion_order = $order; goto jPYaJ; K8tBW: $this->trigger_events("\157\162\144\x65\162\x5f\x62\171"); goto Os2Nj; jPYaJ: return $this; goto KcaCy; Os2Nj: $this->_ion_order_by = $by; goto ZLweQ; KcaCy: } public function row() { goto QnHNv; qYfMk: return $row; goto Cgyc5; uH9XI: $row = $this->response->row(); goto qYfMk; QnHNv: $this->trigger_events("\162\157\x77"); goto uH9XI; Cgyc5: } public function row_array() { goto f1kzx; vx9FB: $row = $this->response->row_array(); goto HimwG; f1kzx: $this->trigger_events(["\162\157\x77", "\162\157\x77\x5f\x61\162\x72\x61\x79"]); goto vx9FB; HimwG: return $row; goto nT6xg; nT6xg: } public function result() { goto E41T9; fZg4G: return $result; goto LW8jj; ahTcs: $result = $this->response->result(); goto fZg4G; E41T9: $this->trigger_events("\x72\x65\163\x75\x6c\164"); goto ahTcs; LW8jj: } public function result_array() { goto Pr2M0; AoB7N: $result = $this->response->result_array(); goto ol9MK; Pr2M0: $this->trigger_events(["\x72\x65\163\x75\x6c\x74", "\x72\145\163\165\x6c\164\137\141\162\x72\x61\171"]); goto AoB7N; ol9MK: return $result; goto tsECs; tsECs: } public function num_rows() { goto oAGYH; rQw8W: return $result; goto bVv6K; Wda9H: $result = $this->response->num_rows(); goto rQw8W; oAGYH: $this->trigger_events(["\x6e\x75\x6d\x5f\162\x6f\x77\x73"]); goto Wda9H; bVv6K: } public function users($groups = NULL) { goto pzbn8; Mi48y: $this->db->join($this->tables["\165\163\145\x72\x73\137\147\x72\x6f\x75\160\163"], $this->tables["\165\163\145\162\163\x5f\x67\x72\157\x75\x70\163"] . "\x2e" . $this->join["\x75\x73\x65\162\163"] . "\x3d" . $this->tables["\165\163\145\162\163"] . "\x2e\x69\144", "\x69\x6e\156\145\162"); goto sqjDk; RESoW: if (empty($group_ids)) { goto ExxUW; } goto e0Yqz; Aip4x: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto Xzzxl; SCul4: O0RD6: goto yb2td; gN8xq: PcJkO: goto TClAm; xyJHv: keOWL: goto RESoW; jFNy4: foreach ($groups as $group) { goto HJtMy; uOMmN: $group_names[] = $group; goto kw7WN; qfgOE: wGQwI: goto gsVeW; kw7WN: goto oRpJT; goto qfgOE; gsVeW: $group_ids[] = $group; goto o9y6x; o9y6x: oRpJT: goto akcAZ; HJtMy: if (is_numeric($group)) { goto wGQwI; } goto uOMmN; akcAZ: TIcbN: goto U1wtM; U1wtM: } goto USCRc; H8qAl: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto pPWNv; } goto zEvzx; GxMEJ: $this->db->join($this->tables["\147\162\157\165\x70\x73"], $this->tables["\x75\163\x65\x72\x73\137\x67\x72\157\x75\x70\163"] . "\56" . $this->join["\x67\162\157\x75\160\163"] . "\x20\75\x20" . $this->tables["\x67\162\x6f\165\160\163"] . "\56\151\144", "\151\156\156\145\162"); goto m9zkq; pzbn8: $this->trigger_events("\x75\163\145\x72\163"); goto pLGHk; VikpI: $this->_ion_limit = NULL; goto gN8xq; VXMIL: pPWNv: goto xZt0J; uXpEy: cpltG: goto SP2a1; K0lmO: goto UAUaa; goto CmOeH; c9qgB: ExxUW: goto k40BM; zEvzx: if (!isset($this->_ion_limit)) { goto PcJkO; } goto FyQzo; JHHqx: UAUaa: goto Nv1cr; USCRc: TagN4: goto HObLP; nQPuw: GQb2Q: goto H8qAl; DHXdp: vCTo1: goto OxxJX; l3BCi: $group_names = []; goto jFNy4; DixG7: $this->_ion_order_by = NULL; goto uXpEy; e0Yqz: $this->db->{$or_where_in}($this->tables["\x75\x73\x65\162\163\x5f\x67\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\x67\162\157\x75\x70\x73"], $group_ids); goto c9qgB; N13yF: $this->db->distinct(); goto Mi48y; gvwgs: IscYQ: goto daXHq; SP2a1: $this->response = $this->db->get($this->tables["\x75\x73\x65\162\x73"]); goto IF6Kx; XnFlZ: foreach ($this->_ion_select as $select) { $this->db->select($select); eLnUd: } goto SCul4; Zv2Ow: $this->_ion_offset = NULL; goto MKhdc; xZt0J: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto AHrXR; ySg2C: if (is_array($groups)) { goto Ie7we; } goto f3MAY; daXHq: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto GQb2Q; } goto QPY5W; FyQzo: $this->db->limit($this->_ion_limit); goto VikpI; k40BM: KvNvb: goto bFhYv; pLGHk: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto kVL68; } goto lkwuu; T66fn: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto IscYQ; } goto soUTD; CmOeH: kVL68: goto XnFlZ; Nv1cr: if (!isset($groups)) { goto KvNvb; } goto ySg2C; fYwmQ: if (!(isset($groups) && !empty($groups))) { goto VA8VM; } goto N13yF; lkwuu: $this->db->select([$this->tables["\165\163\145\x72\x73"] . "\x2e\x2a", $this->tables["\x75\163\x65\x72\163"] . "\56\151\144\x20\141\163\40\x69\144", $this->tables["\165\x73\x65\162\163"] . "\x2e\151\144\x20\141\x73\x20\x75\163\145\x72\x5f\151\144"]); goto K0lmO; bFhYv: $this->trigger_events("\x65\170\164\x72\x61\137\x77\150\145\162\145"); goto T66fn; sWbqN: $group_ids = []; goto l3BCi; jE9i9: Ie7we: goto fYwmQ; rDVec: y_hPR: goto sZJsY; yb2td: $this->_ion_select = []; goto JHHqx; TClAm: goto GJWBg; goto VXMIL; AHrXR: $this->_ion_limit = NULL; goto Zv2Ow; sqjDk: VA8VM: goto sWbqN; QPY5W: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\x6b\145"], $like["\x76\x61\154\165\x65"], $like["\160\x6f\163\x69\164\x69\x6f\156"]); YlZx_: } goto DHXdp; Xzzxl: $this->_ion_order = NULL; goto DixG7; IF6Kx: return $this; goto i6Rgj; m9zkq: $this->db->where_in($this->tables["\147\x72\157\x75\160\x73"] . "\56\x6e\x61\155\145", $group_names); goto xyJHv; OxxJX: $this->_ion_like = []; goto nQPuw; MKhdc: GJWBg: goto SlE_s; gb2q3: if (empty($group_names)) { goto keOWL; } goto GxMEJ; SlE_s: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto cpltG; } goto Aip4x; sZJsY: $this->_ion_where = []; goto gvwgs; HObLP: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\x72\137\167\150\x65\162\145\x5f\151\x6e" : "\167\150\x65\162\x65\x5f\x69\156"; goto gb2q3; soUTD: foreach ($this->_ion_where as $where) { $this->db->where($where); KFN6B: } goto rDVec; f3MAY: $groups = [$groups]; goto jE9i9; i6Rgj: } public function user($id = NULL) { goto AbF52; U029K: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\x72\137\151\x64"); goto gtTSz; gtTSz: $this->limit(1); goto GGcN_; GGcN_: $this->order_by($this->tables["\165\163\145\x72\x73"] . "\x2e\x69\x64", "\144\145\x73\x63"); goto XUqzP; XUqzP: $this->where($this->tables["\x75\163\x65\x72\x73"] . "\56\151\144", $id); goto yw1xR; TKe2p: return $this; goto wsTd4; yw1xR: $this->users(); goto TKe2p; AbF52: $this->trigger_events("\165\163\x65\x72"); goto U029K; wsTd4: } public function get_users_groups($id = FALSE) { goto MReEB; ma9ec: $id || ($id = $this->session->userdata("\x75\163\145\x72\x5f\151\x64")); goto CXJdH; MReEB: $this->trigger_events("\147\145\x74\x5f\165\x73\145\162\163\x5f\x67\x72\157\165\x70"); goto ma9ec; CXJdH: return $this->db->select($this->tables["\x75\163\x65\x72\163\137\147\x72\157\165\x70\163"] . "\x2e" . $this->join["\147\x72\157\x75\160\x73"] . "\x20\x61\x73\40\151\144\54\x20" . $this->tables["\x67\x72\157\x75\160\x73"] . "\x2e\156\x61\155\x65\x2c\40" . $this->tables["\x67\x72\157\x75\160\163"] . "\56\x64\145\163\x63\x72\x69\160\x74\x69\157\x6e")->where($this->tables["\165\163\x65\x72\163\137\x67\162\157\165\x70\x73"] . "\x2e" . $this->join["\165\x73\x65\162\163"], $id)->join($this->tables["\147\162\x6f\165\160\x73"], $this->tables["\165\163\x65\x72\163\137\147\x72\157\165\160\x73"] . "\56" . $this->join["\x67\162\157\165\x70\163"] . "\75" . $this->tables["\147\x72\157\x75\160\163"] . "\x2e\x69\144")->get($this->tables["\165\x73\x65\x72\163\x5f\147\162\157\x75\x70\x73"]); goto Jx_lh; Jx_lh: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto ztaYL; eYKWA: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; ALCNN: } goto IqXom; xqE6J: HKi1u: goto Riqki; l4O_E: CA6hM: goto eCd0R; a7S7k: $this->_cache_user_in_group[$id] = $groups_array; goto LzWvI; Y8Wg5: if (isset($this->_cache_user_in_group[$id])) { goto y7Ua2; } goto v5iy1; LzWvI: goto HKi1u; goto i4IYb; D6oYZ: if (is_array($check_group)) { goto Cu4ab; } goto mI49B; Gw1nI: $groups_array = $this->_cache_user_in_group[$id]; goto xqE6J; mI49B: $check_group = [$check_group]; goto dZ2eV; v5iy1: $users_groups = $this->get_users_groups($id)->result(); goto CW2Q3; IqXom: SnXDX: goto a7S7k; eCd0R: return $check_all; goto rctp_; F2Gjt: $id || ($id = $this->session->userdata("\x75\163\x65\x72\137\151\x64")); goto D6oYZ; CW2Q3: $groups_array = []; goto eYKWA; Riqki: foreach ($check_group as $key => $value) { goto P6d19; jh2yR: return !$check_all; goto ivjXb; ivjXb: XcqKE: goto lKdO4; lKdO4: Rkag_: goto peSca; P6d19: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto VBxyO; VBxyO: if (!(in_array($value, $groups) xor $check_all)) { goto XcqKE; } goto jh2yR; peSca: } goto l4O_E; ztaYL: $this->trigger_events("\151\x6e\x5f\x67\x72\x6f\x75\x70"); goto F2Gjt; dZ2eV: Cu4ab: goto Y8Wg5; i4IYb: y7Ua2: goto Gw1nI; rctp_: } public function add_to_group($group_ids, $user_id = FALSE) { goto K5SYr; gklZo: foreach ($group_ids as $group_id) { goto Sg33V; xqJyr: $this->_cache_groups[$group_id] = $group_name; goto KflQk; jYaNe: $group_name = $this->_cache_groups[$group_id]; goto kA3v2; HpnYg: $group = $this->group($group_id)->result(); goto D3kTi; R1Ycp: xmSyb: goto e8qG8; D3kTi: $group_name = $group[0]->name; goto xqJyr; IbSjU: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto oF53u; wVP_t: ujUJL: goto R1Ycp; Sg33V: if (!$this->db->insert($this->tables["\165\163\x65\162\x73\x5f\147\x72\x6f\x75\160\163"], [$this->join["\x67\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\x75\x73\145\x72\163"] => (float) $user_id])) { goto ujUJL; } goto V8PD2; dQTNP: AY6AA: goto jYaNe; KflQk: goto mx3qG; goto dQTNP; oF53u: $return++; goto wVP_t; kA3v2: mx3qG: goto IbSjU; V8PD2: if (isset($this->_cache_groups[$group_id])) { goto AY6AA; } goto HpnYg; e8qG8: } goto Ek60S; N67lo: $user_id || ($user_id = $this->session->userdata("\x75\x73\x65\162\x5f\151\x64")); goto ZU8Af; WJIk3: $return = 0; goto gklZo; e3sta: $group_ids = [$group_ids]; goto UDxk1; Ek60S: f0mrz: goto F09Xu; K5SYr: $this->trigger_events("\141\x64\x64\x5f\x74\157\x5f\x67\x72\157\x75\160"); goto N67lo; ZU8Af: if (is_array($group_ids)) { goto it0Gj; } goto e3sta; F09Xu: return $return; goto sXeAo; UDxk1: it0Gj: goto WJIk3; sXeAo: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto AX_jZ; AX_jZ: $this->trigger_events("\162\x65\x6d\157\166\x65\x5f\146\x72\157\x6d\x5f\x67\162\x6f\x75\160"); goto Z1cZ4; Zddwz: Fgy8D: goto WMkXy; O_f2O: fAtZb: goto wU3rr; WMkXy: $return = TRUE; goto O_f2O; ndHDY: if (!empty($group_ids)) { goto kvpyr; } goto cgFyE; f47b6: $this->_cache_user_in_group[$user_id] = []; goto uwxJS; etCjb: return FALSE; goto eBMNn; eBMNn: mYhdF: goto ndHDY; uwxJS: zeQoq: goto QpS17; QpS17: goto fAtZb; goto tUA3n; Ogcqd: $group_ids = [$group_ids]; goto FRXCR; Ws45t: foreach ($group_ids as $group_id) { goto PII6X; iSCdP: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto HL3yc; } goto csVxI; TXYaF: HL3yc: goto CTjLc; CTjLc: mxREz: goto OwAoU; csVxI: unset($this->_cache_user_in_group[$user_id][$group_id]); goto TXYaF; PII6X: $this->db->delete($this->tables["\165\163\145\162\163\137\x67\162\x6f\165\160\x73"], [$this->join["\x67\162\x6f\165\160\163"] => (float) $group_id, $this->join["\x75\163\x65\162\163"] => (float) $user_id]); goto iSCdP; OwAoU: } goto Zddwz; wU3rr: return $return; goto NNQEx; cgFyE: if (!($return = $this->db->delete($this->tables["\165\x73\x65\162\163\137\x67\162\157\165\x70\163"], [$this->join["\x75\163\x65\x72\163"] => (float) $user_id]))) { goto zeQoq; } goto f47b6; tUA3n: kvpyr: goto ZIADi; ZIADi: if (is_array($group_ids)) { goto TVZJ6; } goto Ogcqd; FRXCR: TVZJ6: goto Ws45t; Z1cZ4: if (!empty($user_id)) { goto mYhdF; } goto etCjb; NNQEx: } public function groups() { goto fLWQI; BlqqH: $this->db->limit($this->_ion_limit); goto pZaP1; pZaP1: $this->_ion_limit = NULL; goto VeBHJ; t5UKU: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto cMxth; } goto S6gVx; GhzIt: Jox4K: goto A5QC3; zQdr8: C9D4k: goto eQleb; fLWQI: $this->trigger_events("\x67\162\157\x75\x70\x73"); goto MEtpj; S6gVx: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto BHi8T; VuwsP: return $this; goto Ox_K9; MEtpj: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto Jox4K; } goto U6gVC; va0po: $this->_ion_offset = NULL; goto Dt0li; lGC9e: hhsU3: goto rpBpK; VeBHJ: pBAPq: goto J1IAR; eQleb: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto tsoOZ; tsoOZ: $this->_ion_limit = NULL; goto va0po; rpBpK: $this->_ion_where = []; goto GhzIt; BHi8T: cMxth: goto AuWYy; AuWYy: $this->response = $this->db->get($this->tables["\147\162\x6f\165\x70\x73"]); goto VuwsP; U6gVC: foreach ($this->_ion_where as $where) { $this->db->where($where); y5sXx: } goto lGC9e; J1IAR: goto WqKLO; goto zQdr8; fnLyN: if (!isset($this->_ion_limit)) { goto pBAPq; } goto BlqqH; Dt0li: WqKLO: goto t5UKU; A5QC3: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto C9D4k; } goto fnLyN; Ox_K9: } public function group($id = NULL) { goto wrKpn; TElRN: $this->where($this->tables["\x67\162\157\165\x70\x73"] . "\x2e\151\144", $id); goto RYHC7; R1KJM: $this->limit(1); goto GL9cY; RYHC7: w7oox: goto R1KJM; wrKpn: $this->trigger_events("\147\x72\x6f\165\160"); goto okUo7; GL9cY: $this->order_by("\x69\144", "\144\x65\x73\x63"); goto XNyL6; XNyL6: return $this->groups(); goto f9Bq4; okUo7: if (!isset($id)) { goto w7oox; } goto TElRN; f9Bq4: } public function update($id, array $data) { goto nnSns; j0bCU: return FALSE; goto Q9GXL; PW7Am: return TRUE; goto t1c9V; jDxbf: $this->set_error("\x75\x70\x64\x61\x74\145\137\165\156\163\165\143\143\145\163\x73\x66\165\154"); goto CqsBf; iOH20: unset($data["\x70\x61\163\163\167\x6f\x72\144"]); goto UwftK; i2JqA: $data = $this->_filter_data($this->tables["\165\x73\145\162\163"], $data); goto ZO0nZ; ZiN7p: NQDQJ: goto Mxwm6; n20KR: if (!empty($data["\160\141\163\x73\x77\x6f\162\x64"])) { goto vgk1Z; } goto iOH20; ZO0nZ: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\x73\167\x6f\x72\144", $data) || array_key_exists("\x65\x6d\x61\x69\x6c", $data))) { goto DTqLp; } goto EafYY; q39mH: $this->db->trans_begin(); goto zJi1j; Rm23R: if (!($data["\160\141\x73\163\x77\x6f\x72\144"] === FALSE)) { goto YKq2I; } goto B1VLC; EafYY: if (!array_key_exists("\160\141\x73\x73\167\x6f\x72\x64", $data)) { goto Mz8Ge; } goto n20KR; jbzsk: PQYot: goto i2JqA; Q9GXL: YKq2I: goto b2HBv; A9PmA: $this->trigger_events(["\x70\x6f\x73\164\137\x75\x70\144\141\x74\x65\x5f\165\163\145\x72", "\160\157\163\164\x5f\x75\160\144\141\x74\145\137\165\x73\145\162\137\165\156\163\165\143\x63\145\163\163\x66\165\154"]); goto Qc0mk; x1jEW: if (!($this->db->trans_status() === FALSE)) { goto NQDQJ; } goto LPgVe; Q2FM5: Mz8Ge: goto YuHAf; Mxwm6: $this->db->trans_commit(); goto xUJan; SvBd9: $this->set_error("\x61\143\143\157\x75\156\x74\x5f\143\162\x65\141\x74\151\157\156\x5f\144\165\160\x6c\151\143\x61\164\145\x5f\x69\x64\145\156\164\151\164\x79"); goto TIwlm; GnfHv: $this->trigger_events(["\160\x6f\x73\164\137\x75\160\x64\x61\x74\x65\137\165\x73\x65\162", "\160\157\x73\x74\x5f\165\160\144\141\x74\x65\x5f\x75\x73\x65\162\x5f\165\156\x73\x75\x63\143\x65\163\x73\146\165\x6c"]); goto a_ZMf; b2HBv: uyv5k: goto Q2FM5; zJi1j: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto PQYot; } goto OOL0x; YAg2h: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, ["\x69\x64" => $user->id]); goto x1jEW; vnDuy: $user = $this->user($id)->row(); goto q39mH; OOL0x: $this->db->trans_rollback(); goto SvBd9; Qc0mk: $this->set_error("\165\160\144\141\x74\x65\x5f\x75\x6e\163\165\x63\x63\145\163\x73\146\x75\154"); goto j0bCU; YuHAf: DTqLp: goto jQ0zx; B1VLC: $this->db->trans_rollback(); goto A9PmA; a_ZMf: $this->set_error("\x75\160\144\141\164\x65\137\165\x6e\163\x75\x63\143\145\x73\x73\x66\165\x6c"); goto YvmNf; LPgVe: $this->db->trans_rollback(); goto GnfHv; YvmNf: return FALSE; goto ZiN7p; I_ufM: $data["\160\x61\163\163\167\157\162\x64"] = $this->hash_password($data["\160\x61\x73\x73\167\157\x72\144"], $user->{$this->identity_column}); goto Rm23R; TIwlm: $this->trigger_events(["\x70\157\x73\164\137\165\160\x64\141\x74\145\137\x75\163\145\162", "\x70\x6f\x73\x74\x5f\165\x70\x64\x61\164\145\x5f\165\163\145\162\137\x75\x6e\163\165\143\143\145\163\x73\146\x75\154"]); goto jDxbf; ANj2K: $this->set_message("\165\160\x64\141\164\145\x5f\x73\x75\x63\x63\145\163\x73\146\165\x6c"); goto PW7Am; UwftK: goto uyv5k; goto zrcgk; CqsBf: return FALSE; goto jbzsk; xUJan: $this->trigger_events(["\160\x6f\x73\x74\137\x75\x70\144\141\x74\145\x5f\x75\x73\x65\x72", "\x70\157\x73\x74\x5f\x75\160\144\x61\x74\145\x5f\165\x73\x65\x72\x5f\163\x75\x63\143\145\x73\163\146\x75\154"]); goto ANj2K; zrcgk: vgk1Z: goto I_ufM; nnSns: $this->trigger_events("\x70\162\145\137\165\160\x64\x61\x74\x65\137\x75\163\145\x72"); goto vnDuy; jQ0zx: $this->trigger_events("\x65\x78\x74\162\x61\137\x77\x68\x65\x72\145"); goto YAg2h; t1c9V: } public function delete_user($id) { goto vZCw7; Yl2Sg: return TRUE; goto eX3NN; UvM5a: $this->db->trans_commit(); goto ZzBTB; vZCw7: $this->trigger_events("\160\x72\x65\137\144\145\x6c\x65\x74\x65\137\x75\163\x65\x72"); goto NH5pO; bBWjq: return FALSE; goto tHjfs; tHjfs: Ue7K2: goto UvM5a; YxnrH: $this->set_message("\x64\x65\154\x65\164\145\137\x73\165\143\143\x65\163\x73\x66\x75\x6c"); goto Yl2Sg; ZzBTB: $this->trigger_events(["\x70\157\x73\x74\x5f\x64\x65\154\x65\164\145\x5f\x75\163\145\x72", "\160\157\163\x74\137\144\145\154\x65\x74\x65\137\165\x73\x65\162\x5f\163\165\x63\143\x65\163\x73\x66\x75\x6c"]); goto YxnrH; NH5pO: $this->db->trans_begin(); goto AjBTT; KSB0x: $this->set_error("\144\145\154\145\x74\145\x5f\165\x6e\163\165\143\143\145\163\163\x66\165\154"); goto bBWjq; AjBTT: $this->remove_from_group(NULL, $id); goto Dpckn; K1BaJ: $this->db->trans_rollback(); goto TDET4; jXWjr: if (!($this->db->trans_status() === FALSE)) { goto Ue7K2; } goto K1BaJ; TDET4: $this->trigger_events(["\160\157\x73\x74\137\144\x65\x6c\145\x74\x65\137\x75\163\145\x72", "\x70\x6f\x73\x74\x5f\144\x65\154\145\164\145\x5f\x75\x73\145\162\x5f\165\156\x73\165\x63\x63\x65\x73\x73\x66\165\x6c"]); goto KSB0x; Dpckn: $this->db->delete($this->tables["\x75\x73\x65\162\163"], ["\x69\144" => $id]); goto jXWjr; eX3NN: } public function update_last_login($id) { goto UNTkn; UNTkn: $this->trigger_events("\165\x70\144\x61\164\145\137\x6c\141\x73\x74\x5f\154\x6f\x67\x69\156"); goto pr7J5; KQQDZ: $this->db->update($this->tables["\x75\x73\145\162\163"], ["\154\x61\x73\164\137\154\x6f\147\x69\156" => time()], ["\151\x64" => $id]); goto vT65j; vT65j: return $this->db->affected_rows() == 1; goto MY7BE; F6AjR: $this->trigger_events("\145\x78\x74\x72\x61\x5f\167\x68\x65\162\x65"); goto KQQDZ; pr7J5: $this->load->helper("\144\141\x74\x65"); goto F6AjR; MY7BE: } public function set_lang($lang = "\145\156") { goto dGp4r; yS11v: set_cookie(["\156\x61\x6d\x65" => "\x6c\x61\156\147\x5f\143\157\x64\145", "\166\141\x6c\165\x65" => $lang, "\145\x78\x70\x69\x72\145" => $expire]); goto LEWh2; dGp4r: $this->trigger_events("\x73\145\164\x5f\154\x61\156\x67"); goto gPJRr; Dv1Vp: zLUpZ: goto lDQIC; ezxrH: TvA_k: goto yS11v; Qrp9j: goto TvA_k; goto Dv1Vp; LEWh2: return TRUE; goto YkIzY; lDQIC: $expire = self::MAX_COOKIE_LIFETIME; goto ezxrH; xoY0r: $expire = $this->config->item("\165\163\x65\x72\137\x65\170\160\x69\162\145", "\151\x6f\156\x5f\x61\x75\164\150"); goto Qrp9j; gPJRr: if ($this->config->item("\165\x73\145\162\x5f\145\170\x70\x69\x72\x65", "\151\157\x6e\137\x61\x75\164\x68") === 0) { goto zLUpZ; } goto xoY0r; YkIzY: } public function set_session($user) { goto z71Pf; z71Pf: $this->trigger_events("\160\162\x65\x5f\163\x65\164\x5f\x73\x65\163\163\x69\157\156"); goto hfmTl; hfmTl: $session_data = ["\x69\x64\x65\x6e\164\151\164\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\x69\x6c" => $user->email, "\165\163\x65\162\x5f\x69\x64" => $user->id, "\157\x6c\144\137\154\x61\163\164\137\x6c\157\x67\x69\x6e" => $user->last_login, "\x6c\141\163\x74\x5f\143\150\145\143\x6b" => time()]; goto F1XxJ; ITZq3: return TRUE; goto nX9nV; TTftZ: $this->trigger_events("\160\x6f\x73\x74\137\x73\145\164\137\163\145\x73\x73\x69\x6f\156"); goto ITZq3; F1XxJ: $this->session->set_userdata($session_data); goto TTftZ; nX9nV: } public function remember_user($identity) { goto Ectn6; oBNWs: $this->trigger_events(["\x70\x6f\x73\164\137\x72\x65\155\145\155\x62\x65\x72\x5f\165\163\x65\162", "\x72\145\155\145\x6d\x62\x65\162\x5f\165\163\145\162\137\163\165\143\x63\x65\x73\163\x66\165\154"]); goto DETld; wxkte: AoNmu: goto Mf99R; TuMXC: if (!$token->validator_hashed) { goto AoNmu; } goto KZfDV; U9lLP: $expire = $this->config->item("\x75\x73\145\x72\x5f\145\x78\160\151\x72\x65", "\x69\x6f\156\x5f\141\x75\x74\150"); goto nJ3v7; nJ3v7: goto ztA2H; goto aKE1E; aKE1E: hrYBL: goto R1A7N; l42qf: return FALSE; goto JDZ1P; R1A7N: $expire = self::MAX_COOKIE_LIFETIME; goto MfHs9; DETld: return TRUE; goto M4Zmc; Ectn6: $this->trigger_events("\x70\x72\x65\137\x72\x65\x6d\145\155\x62\145\162\137\165\x73\145\x72"); goto Nnx3b; Nnx3b: if ($identity) { goto Gq0cw; } goto l42qf; M4Zmc: ktMoC: goto wxkte; Mf99R: $this->trigger_events(["\x70\157\163\164\137\162\145\155\x65\x6d\x62\x65\162\x5f\165\x73\x65\162", "\x72\x65\155\x65\x6d\142\x65\x72\137\x75\x73\x65\162\137\x75\x6e\x73\x75\143\x63\x65\163\x73\x66\x75\x6c"]); goto IyIL_; KZfDV: $this->db->update($this->tables["\165\x73\145\x72\163"], ["\162\x65\155\145\155\x62\x65\x72\x5f\163\x65\x6c\x65\x63\x74\157\x72" => $token->selector, "\x72\145\x6d\x65\x6d\x62\145\x72\137\x63\157\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto l25lx; JDZ1P: Gq0cw: goto YsgQl; l25lx: if (!($this->db->affected_rows() > -1)) { goto ktMoC; } goto HWYDa; MfHs9: ztA2H: goto sU0wr; IyIL_: return FALSE; goto GHc_Z; sU0wr: set_cookie(["\156\141\x6d\145" => $this->config->item("\162\x65\x6d\145\155\x62\145\x72\x5f\x63\x6f\x6f\x6b\151\x65\137\x6e\141\x6d\145", "\x69\x6f\156\137\x61\x75\x74\x68"), "\166\x61\x6c\x75\145" => $token->user_code, "\x65\170\160\x69\162\145" => $expire]); goto oBNWs; HWYDa: if ($this->config->item("\165\163\x65\162\x5f\145\x78\160\151\x72\145", "\151\157\156\137\141\x75\x74\x68") === 0) { goto hrYBL; } goto U9lLP; YsgQl: $token = $this->_generate_selector_validator_couple(); goto TuMXC; GHc_Z: } public function login_remembered_user() { goto P9xBS; xGMfd: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto fB51Z; n03rF: $this->remember_user($identity); goto wP7Ye; szxHO: $this->trigger_events(["\x70\157\x73\164\137\154\x6f\x67\151\156\x5f\x72\145\155\x65\155\x62\x65\x72\x65\x64\x5f\x75\163\x65\162", "\160\x6f\x73\164\137\154\x6f\147\x69\156\137\162\145\x6d\x65\x6d\142\x65\162\145\x64\137\165\x73\x65\x72\137\x75\x6e\x73\165\x63\143\145\163\163\x66\x75\x6c"]); goto gEVMO; fB51Z: if (!($token === FALSE)) { goto itrJf; } goto szxHO; arTHW: cvC4r: goto TTMNa; aUT7s: delete_cookie($this->config->item("\162\145\x6d\145\155\142\x65\x72\x5f\x63\157\x6f\x6b\151\x65\137\x6e\141\155\x65", "\151\157\x6e\x5f\x61\x75\x74\x68")); goto L1cp9; gEVMO: return FALSE; goto WOjsI; xpL95: $this->set_session($user); goto FPJWA; WOjsI: itrJf: goto sy0th; R7ThN: $user = $query->row(); goto jdpEq; mWCtr: $query = $this->db->select($this->identity_column . "\54\40\x69\x64\x2c\x20\x65\155\x61\151\154\x2c\x20\162\x65\x6d\x65\155\142\145\162\137\x63\x6f\x64\145\x2c\40\x6c\x61\x73\164\137\x6c\x6f\147\x69\x6e")->where("\162\x65\155\145\x6d\x62\145\x72\x5f\x73\145\x6c\x65\x63\x74\x6f\162", $token->selector)->where("\x61\143\164\151\166\145", 1)->limit(1)->get($this->tables["\x75\x73\x65\x72\163"]); goto XerWm; XerWm: if (!($query->num_rows() === 1)) { goto xneA5; } goto R7ThN; jdpEq: $identity = $user->{$this->identity_column}; goto GcAvt; FPJWA: $this->clear_forgotten_password_code($identity); goto Lkdj_; Lkdj_: if (!$this->config->item("\165\163\145\x72\137\145\170\x74\x65\156\144\x5f\x6f\156\137\154\157\147\x69\156", "\x69\x6f\x6e\x5f\141\165\164\150")) { goto PZxGp; } goto n03rF; L1cp9: $this->trigger_events(["\x70\x6f\163\164\137\x6c\157\147\x69\156\137\x72\145\155\x65\x6d\x62\145\162\x65\144\x5f\x75\x73\145\162", "\x70\157\163\164\137\x6c\x6f\x67\151\156\x5f\162\145\x6d\145\155\142\145\x72\x65\144\x5f\x75\163\145\162\137\165\156\163\165\x63\143\145\163\163\x66\165\154"]); goto rXmNI; Aoe6f: return TRUE; goto arTHW; Dn_Nd: $remember_cookie = get_cookie($this->config->item("\162\x65\x6d\145\155\x62\145\162\137\x63\157\157\153\151\145\137\156\x61\x6d\145", "\x69\157\156\137\x61\165\164\x68")); goto xGMfd; rXmNI: return FALSE; goto iAgbl; sy0th: $this->trigger_events("\145\x78\164\x72\x61\x5f\x77\x68\x65\162\145"); goto mWCtr; OkU2J: $this->trigger_events(["\x70\157\163\164\137\154\157\147\x69\x6e\x5f\x72\x65\x6d\x65\x6d\142\145\162\x65\144\x5f\x75\163\145\162", "\x70\x6f\x73\x74\137\x6c\157\147\x69\156\137\x72\145\x6d\x65\x6d\142\145\162\145\x64\x5f\x75\x73\x65\162\x5f\x73\x75\143\x63\145\163\163\146\x75\154"]); goto Aoe6f; P9xBS: $this->trigger_events("\160\162\x65\x5f\x6c\157\x67\x69\x6e\137\x72\x65\x6d\145\x6d\142\x65\x72\x65\x64\137\165\x73\145\162"); goto Dn_Nd; AnYZ5: $this->session->sess_regenerate(FALSE); goto OkU2J; wP7Ye: PZxGp: goto AnYZ5; QF2fh: $this->update_last_login($user->id); goto xpL95; GcAvt: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto cvC4r; } goto QF2fh; TTMNa: xneA5: goto aUT7s; iAgbl: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto ETpOL; xN0VG: DwOhQ: goto OEHH1; mE2_p: return FALSE; goto A4F6P; QyOBA: return $group_id; goto hx705; C2WVh: $data = ["\x6e\141\155\145" => $group_name, "\144\x65\x73\143\162\151\160\x74\x69\157\156" => $group_description]; goto jpNT1; V7rl3: $this->db->insert($this->tables["\x67\x72\157\x75\160\163"], $data); goto S5ncw; dsF0H: $this->set_error("\x67\x72\157\165\x70\x5f\x6e\141\155\145\x5f\162\145\x71\x75\151\x72\145\x64"); goto mE2_p; ETpOL: if ($group_name) { goto RlnV6; } goto dsF0H; QxY25: return FALSE; goto m4Ssm; f_Z2C: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\165\160\x73"], ["\x6e\141\x6d\x65" => $group_name])->num_rows(); goto N8QW4; A4F6P: RlnV6: goto f_Z2C; S5ncw: $group_id = $this->db->insert_id($this->tables["\147\162\157\x75\x70\163"] . "\x5f\x69\x64\x5f\163\x65\x71"); goto sAVc9; ypSow: $data = array_merge($this->_filter_data($this->tables["\147\162\157\165\160\x73"], $additional_data), $data); goto xN0VG; jpNT1: if (empty($additional_data)) { goto DwOhQ; } goto ypSow; J5jaP: $this->set_error("\x67\162\157\x75\x70\x5f\x61\x6c\x72\145\141\x64\x79\137\x65\170\151\x73\164\x73"); goto QxY25; m4Ssm: psC6H: goto C2WVh; sAVc9: $this->set_message("\147\x72\157\x75\x70\x5f\143\x72\145\x61\x74\x69\157\156\137\163\x75\143\143\x65\x73\163\146\x75\154"); goto QyOBA; N8QW4: if (!($existing_group !== 0)) { goto psC6H; } goto J5jaP; OEHH1: $this->trigger_events("\x65\170\164\x72\x61\x5f\147\162\157\x75\160\x5f\163\x65\x74"); goto V7rl3; hx705: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto vxJrI; XneCN: OQTNB: goto wiYFO; LAMle: n2bVG: goto O50Cw; rNePZ: $existing_group = $this->db->get_where($this->tables["\x67\162\157\165\x70\163"], ["\156\141\x6d\x65" => $group_name])->row(); goto T5UZI; MIpSq: return FALSE; goto XneCN; FwLFA: if (empty($group_name)) { goto eUfeU; } goto rNePZ; RPwJH: $data = []; goto FwLFA; uO62z: $this->set_error("\x67\x72\x6f\x75\160\137\x61\x6c\162\x65\x61\144\x79\x5f\145\x78\x69\163\164\163"); goto yhGSQ; W_ic_: GiaUg: goto RPwJH; vxJrI: if (!empty($group_id)) { goto GiaUg; } goto A4OIs; wiYFO: if (empty($additional_data)) { goto n2bVG; } goto Iosnz; jRWiL: eUfeU: goto LuUlz; RV2y3: if (!($this->config->item("\x61\x64\x6d\x69\156\137\147\162\x6f\x75\160", "\x69\x6f\156\137\x61\x75\164\150") === $group->name && $group_name !== $group->name)) { goto OQTNB; } goto hfX0a; T5UZI: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto RTxBN; } goto uO62z; WO_4o: return TRUE; goto iw1Xl; O50Cw: $this->db->update($this->tables["\147\x72\x6f\165\160\x73"], $data, ["\x69\x64" => $group_id]); goto rKy1N; rKy1N: $this->set_message("\x67\162\x6f\165\160\137\165\x70\x64\141\x74\x65\x5f\x73\x75\x63\x63\x65\x73\163\x66\165\x6c"); goto WO_4o; LZtI3: $data["\156\x61\155\145"] = $group_name; goto jRWiL; waAAI: RTxBN: goto LZtI3; A4OIs: return FALSE; goto W_ic_; LuUlz: $group = $this->db->get_where($this->tables["\147\x72\x6f\165\160\163"], ["\x69\x64" => $group_id])->row(); goto RV2y3; yhGSQ: return FALSE; goto waAAI; hfX0a: $this->set_error("\x67\x72\x6f\x75\160\137\x6e\x61\155\145\x5f\141\144\155\x69\x6e\137\x6e\157\x74\x5f\141\154\164\x65\162"); goto MIpSq; Iosnz: $data = array_merge($this->_filter_data($this->tables["\x67\x72\157\x75\x70\163"], $additional_data), $data); goto LAMle; iw1Xl: } public function delete_group($group_id = FALSE) { goto y3aFA; Uu4pq: return FALSE; goto D7yIZ; d0yT0: $this->trigger_events(["\160\157\x73\164\137\x64\x65\154\145\x74\x65\x5f\x67\x72\x6f\165\160", "\x70\157\x73\164\137\144\145\x6c\x65\164\x65\x5f\147\162\x6f\x75\x70\137\165\156\163\165\143\143\145\163\163\x66\165\x6c"]); goto Db0MZ; C4mBz: $this->db->trans_begin(); goto IsOzU; FgYFW: $group = $this->group($group_id)->row(); goto FYLdF; rP9iE: $this->set_error("\147\162\x6f\165\x70\x5f\144\x65\x6c\x65\x74\145\x5f\x6e\x6f\164\141\154\x6c\x6f\167\x65\144"); goto Uu4pq; nOfm1: return FALSE; goto l0j4u; D7yIZ: RwltA: goto Hnv5r; Db0MZ: $this->set_error("\x67\162\x6f\x75\160\x5f\x64\x65\x6c\145\x74\145\x5f\165\156\163\165\143\x63\x65\x73\x73\x66\x75\x6c"); goto nOfm1; q2gru: return FALSE; goto gRhso; IsOzU: $this->db->delete($this->tables["\165\x73\x65\x72\163\x5f\147\x72\157\165\x70\x73"], [$this->join["\147\162\x6f\x75\160\x73"] => $group_id]); goto qzXzi; z2EPU: $this->trigger_events(["\x70\157\x73\164\x5f\x64\145\x6c\145\164\145\137\x67\162\x6f\165\x70", "\x70\157\x73\x74\x5f\144\x65\x6c\145\x74\x65\x5f\147\x72\157\165\160\x5f\x6e\157\x74\x61\154\x6c\x6f\167\x65\144"]); goto rP9iE; i5Fvi: $this->trigger_events(["\x70\x6f\163\x74\137\x64\145\x6c\x65\164\145\x5f\147\162\x6f\165\160", "\160\x6f\163\164\137\x64\x65\154\145\164\x65\x5f\x67\162\157\165\160\x5f\163\x75\143\143\x65\163\x73\x66\x75\154"]); goto JXsAd; ls1BL: if (!($this->db->trans_status() === FALSE)) { goto YyRWR; } goto enfjT; l0j4u: YyRWR: goto hYYdI; uPn6c: return TRUE; goto mX9cd; qzXzi: $this->db->delete($this->tables["\147\162\157\x75\x70\x73"], ["\151\144" => $group_id]); goto ls1BL; JXsAd: $this->set_message("\147\x72\x6f\x75\x70\x5f\x64\145\x6c\145\164\x65\137\x73\165\x63\143\x65\163\x73\146\x75\154"); goto uPn6c; enfjT: $this->db->trans_rollback(); goto d0yT0; Hnv5r: $this->trigger_events("\160\x72\x65\137\144\x65\154\145\x74\145\137\147\x72\157\x75\160"); goto C4mBz; y3aFA: if (!(!$group_id || empty($group_id))) { goto IBggT; } goto q2gru; FYLdF: if (!($group->name == $this->config->item("\x61\144\x6d\x69\156\x5f\147\x72\x6f\165\x70", "\x69\x6f\x6e\137\x61\x75\164\x68"))) { goto RwltA; } goto z2EPU; hYYdI: $this->db->trans_commit(); goto i5Fvi; gRhso: IBggT: goto FgYFW; mX9cd: } public function set_hook($event, $name, $class, $method, $arguments) { goto xhPkQ; xhPkQ: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto zperu; n3rjL: $this->_ion_hooks->{$event}[$name]->method = $method; goto EqQvF; EqQvF: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto ypex7; zperu: $this->_ion_hooks->{$event}[$name]->class = $class; goto n3rjL; ypex7: } public function remove_hook($event, $name) { goto mzwUC; mzwUC: if (!isset($this->_ion_hooks->{$event}[$name])) { goto pudpJ; } goto MBnMF; MEs7p: pudpJ: goto USR_q; MBnMF: unset($this->_ion_hooks->{$event}[$name]); goto MEs7p; USR_q: } public function remove_hooks($event) { goto a3ED_; WXV2_: rvI9l: goto K8BBT; mdDZA: unset($this->_ion_hooks->{$event}); goto WXV2_; a3ED_: if (!isset($this->_ion_hooks->{$event})) { goto rvI9l; } goto mdDZA; K8BBT: } protected function _call_hook($event, $name) { goto uMxXP; tYc3E: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto ZyIWH; uMxXP: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto PGyqc; } goto fS1Db; ZyIWH: PGyqc: goto KbaGw; fS1Db: $hook = $this->_ion_hooks->{$event}[$name]; goto tYc3E; KbaGw: return FALSE; goto djUs1; djUs1: } public function trigger_events($events) { goto dGXer; dGXer: if (is_array($events) && !empty($events)) { goto XlXPV; } goto myDdJ; myDdJ: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto Gvh0y; } goto mIy0o; WCN2O: XlXPV: goto jeiEu; kTM86: PTiWX: goto X06un; JGzqV: xpvRh: goto tGbhj; tGbhj: Gvh0y: goto eMnf1; jeiEu: foreach ($events as $event) { $this->trigger_events($event); nKHwG: } goto M49dS; eMnf1: goto PTiWX; goto WCN2O; M49dS: Av70p: goto kTM86; mIy0o: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); i8ohx: } goto JGzqV; X06un: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto uqog7; ri1dD: $this->message_end_delimiter = $end_delimiter; goto qN6Vh; qN6Vh: return TRUE; goto hksPe; uqog7: $this->message_start_delimiter = $start_delimiter; goto ri1dD; hksPe: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto PgWBI; VCRls: return TRUE; goto TWlHS; PgWBI: $this->error_start_delimiter = $start_delimiter; goto ffPNn; ffPNn: $this->error_end_delimiter = $end_delimiter; goto VCRls; TWlHS: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto J4qww; arE8a: foreach ($this->messages as $message) { goto g0XGK; Br3rG: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto HQ19J; HQ19J: V7vjW: goto hWzxn; g0XGK: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\43"; goto Br3rG; hWzxn: } goto ua3eu; ua3eu: AT3rH: goto H55AH; H55AH: return $_output; goto e0mDz; J4qww: $_output = ''; goto arE8a; e0mDz: } public function messages_array($langify = TRUE) { goto olpSq; xNeDw: $_output = []; goto YI7Lt; ZFupH: Z_3jy: goto FKD_z; Uj3Z2: goto Z_3jy; goto DAKIi; YI7Lt: foreach ($this->messages as $message) { goto cYFYo; eAerY: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto V7fer; V7fer: u63H8: goto s_aFY; cYFYo: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\43"; goto eAerY; s_aFY: } goto e_lLv; e_lLv: hKnaj: goto k11gr; k11gr: return $_output; goto ZFupH; RknVd: return $this->messages; goto Uj3Z2; DAKIi: sAkzP: goto xNeDw; olpSq: if ($langify) { goto sAkzP; } goto RknVd; FKD_z: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto y3NCf; SfPjx: foreach ($this->errors as $error) { goto kor7h; kor7h: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\x23"; goto ZuT3r; RfZh2: tD6cQ: goto m6Dr2; ZuT3r: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto RfZh2; m6Dr2: } goto Nnvvv; y3NCf: $_output = ''; goto SfPjx; Nnvvv: Rig9I: goto bUCC_; bUCC_: return $_output; goto zyiIg; zyiIg: } public function errors_array($langify = TRUE) { goto VDsF0; IU0kV: KGU3L: goto Blrno; f80c6: return $_output; goto Rus7Q; HPvTn: return $this->errors; goto BZF0P; NDrWX: mnicx: goto f80c6; QLHiR: foreach ($this->errors as $error) { goto DSBEY; DSBEY: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto aFSbZ; ujx8U: W2jiP: goto rl12D; aFSbZ: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto ujx8U; rl12D: } goto NDrWX; Rus7Q: XkJlW: goto PfhQ2; VDsF0: if ($langify) { goto KGU3L; } goto HPvTn; BZF0P: goto XkJlW; goto IU0kV; Blrno: $_output = []; goto QLHiR; PfhQ2: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto d1xm9; KCf5H: if (!($hash === FALSE)) { goto PqzWT; } goto od8JW; e3wCY: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto IGx4v; od8JW: return FALSE; goto UU9im; d1xm9: $hash = $this->hash_password($password, $identity); goto KCf5H; rm0BY: $data = ["\x70\141\x73\x73\167\x6f\162\x64" => $hash, "\x72\x65\x6d\x65\x6d\x62\x65\162\x5f\x63\157\x64\145" => NULL, "\x66\x6f\162\x67\x6f\164\x74\145\x6e\x5f\x70\x61\x73\163\167\x6f\162\x64\137\143\157\x64\x65" => NULL, "\x66\157\x72\147\x6f\164\x74\x65\x6e\x5f\x70\x61\x73\163\167\x6f\162\x64\137\164\x69\155\x65" => NULL]; goto Tkj5s; IGx4v: return $this->db->affected_rows() == 1; goto iKGEw; Tkj5s: $this->trigger_events("\145\x78\164\x72\x61\x5f\x77\150\x65\162\x65"); goto e3wCY; UU9im: PqzWT: goto rm0BY; iKGEw: } protected function _filter_data($table, $data) { goto hHStS; hHStS: $filtered_data = []; goto Waicr; tZiGB: if (!is_array($data)) { goto olsT3; } goto d69Eh; mdO2P: olsT3: goto whsiP; e8OKe: Y6CwF: goto mdO2P; whsiP: return $filtered_data; goto cXWUH; d69Eh: foreach ($columns as $column) { goto EdbZv; ATfTA: H_Qzh: goto Acd6U; Acd6U: RcXxJ: goto MuZB0; EdbZv: if (!array_key_exists($column, $data)) { goto H_Qzh; } goto Te1QT; Te1QT: $filtered_data[$column] = $data[$column]; goto ATfTA; MuZB0: } goto e8OKe; Waicr: $columns = $this->db->list_fields($table); goto tZiGB; cXWUH: } protected function _random_token($result_length = 32) { goto JQ8c4; TaolM: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto k9D0D; TEsnJ: HqHWm: goto HE9pn; dZk8T: vZQII: goto prX7F; prX7F: return FALSE; goto CmxG5; LxjZz: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto dZk8T; S29QG: return bin2hex(random_bytes($result_length / 2)); goto npvqI; k9D0D: XvD1R: goto lU64Z; DN6UM: if (!function_exists("\x6d\x63\162\x79\160\x74\137\x63\162\145\x61\164\145\x5f\x69\166")) { goto XvD1R; } goto TaolM; lU64Z: if (!function_exists("\157\x70\145\x6e\163\163\154\137\162\141\156\x64\157\155\x5f\160\x73\x65\165\144\x6f\x5f\x62\x79\164\145\x73")) { goto vZQII; } goto LxjZz; HE9pn: if (!function_exists("\162\x61\x6e\x64\x6f\155\x5f\142\171\164\145\163")) { goto qwKi4; } goto S29QG; npvqI: qwKi4: goto DN6UM; sjCUl: $result_length = 32; goto TEsnJ; JQ8c4: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto HqHWm; } goto sjCUl; CmxG5: } protected function _get_hash_parameters($identity = NULL) { goto lUoRI; AZY93: if (!($user_id && $this->in_group($this->config->item("\141\x64\155\151\156\137\147\x72\157\x75\160", "\x69\157\156\137\x61\x75\x74\x68"), $user_id))) { goto KSAnp; } goto s2rmB; VkpKa: zmPAl: goto TUkq4; i7Qn5: $params = FALSE; goto kNZ3u; R4_i8: KSAnp: goto owtyV; s4NLU: z7Zef: goto VkpKa; vaRsO: if (!$identity) { goto Gxv0M; } goto AHyPM; kNZ3u: switch ($this->hash_method) { case "\142\143\x72\x79\x70\164": $params = ["\x63\x6f\x73\x74" => $is_admin ? $this->config->item("\x62\143\x72\x79\160\x74\137\141\144\155\151\156\x5f\143\x6f\163\164", "\x69\x6f\156\x5f\x61\x75\164\150") : $this->config->item("\x62\x63\x72\x79\x70\x74\137\x64\x65\x66\x61\165\x6c\164\x5f\143\157\x73\x74", "\x69\x6f\156\x5f\x61\165\x74\150")]; goto zmPAl; case "\141\x72\147\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\162\x67\x6f\156\x32\x5f\141\144\155\151\156\x5f\x70\x61\162\141\155\x73", "\151\x6f\156\137\x61\165\164\x68") : $this->config->item("\141\162\x67\157\x6e\x32\137\144\145\x66\141\165\154\x74\137\x70\141\162\141\x6d\x73", "\x69\157\x6e\x5f\141\x75\x74\150"); goto zmPAl; default: } goto s4NLU; owtyV: Gxv0M: goto i7Qn5; TUkq4: return $params; goto MUVY5; AHyPM: $user_id = $this->get_user_id_from_identity($identity); goto AZY93; s2rmB: $is_admin = TRUE; goto R4_i8; lUoRI: $is_admin = FALSE; goto vaRsO; MUVY5: } protected function _get_hash_algo() { goto ptduN; ptduN: $algo = FALSE; goto nHU9j; nHU9j: switch ($this->hash_method) { case "\142\143\162\x79\x70\x74": $algo = PASSWORD_BCRYPT; goto goxJY; case "\141\x72\147\x6f\x6e\x32": $algo = PASSWORD_ARGON2I; goto goxJY; default: } goto vV0SK; gG_Kn: goxJY: goto To8xC; To8xC: return $algo; goto i6oC7; vV0SK: k7UEC: goto gG_Kn; i6oC7: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto qWP1z; oUjiX: $validator = $this->_random_token($validator_size); goto D3IR2; D3IR2: $validator_hashed = $this->hash_password($validator); goto MYjkS; qWP1z: $selector = $this->_random_token($selector_size); goto oUjiX; jGOsI: return (object) ["\x73\x65\154\145\x63\164\157\x72" => $selector, "\166\x61\x6c\151\144\141\164\x6f\x72\x5f\x68\x61\x73\150\145\x64" => $validator_hashed, "\165\163\x65\162\137\x63\x6f\x64\x65" => $user_code]; goto xIG3k; MYjkS: $user_code = "{$selector}\x2e{$validator}"; goto jGOsI; xIG3k: } protected function _retrieve_selector_validator_couple($user_code) { goto SqUFj; SqUFj: if (!$user_code) { goto DENXt; } goto Lu5nu; YUIjB: return FALSE; goto OwKxX; qs3ig: J9ljD: goto qGGa6; qGGa6: DENXt: goto YUIjB; Lu5nu: $tokens = explode("\56", $user_code); goto I7xU3; bGoFE: return (object) ["\163\145\x6c\x65\x63\164\x6f\x72" => $tokens[0], "\x76\141\x6c\151\x64\141\164\x6f\x72" => $tokens[1]]; goto qs3ig; I7xU3: if (!(count($tokens) === 2)) { goto J9ljD; } goto bGoFE; OwKxX: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto SguQl; L8p0Z: return FALSE; goto ra6em; G_UxV: $this->trigger_events(["\160\x6f\x73\164\x5f\x73\x68\141\61\x5f\x70\141\x73\x73\167\157\x72\x64\137\x6d\151\x67\162\141\x74\151\x6f\156", "\160\x6f\x73\x74\137\163\x68\141\61\x5f\x70\x61\x73\163\167\157\162\x64\x5f\x6d\151\147\x72\141\x74\x69\x6f\156\137\165\156\163\x75\143\x63\x65\163\163\x66\x75\x6c"]); goto L8p0Z; gp3wb: beyLm: goto xQ1jT; SguQl: $this->trigger_events("\160\x72\x65\137\163\x68\141\61\137\x70\x61\x73\163\167\157\x72\144\137\x6d\151\147\x72\x61\164\x69\x6f\156"); goto hENJ5; CAeYI: $this->trigger_events(["\160\x6f\x73\164\x5f\163\150\141\61\x5f\x70\141\x73\x73\167\157\162\x64\137\155\x69\x67\x72\141\x74\151\x6f\x6e", "\x70\x6f\x73\164\x5f\x73\150\x61\61\137\160\x61\163\163\x77\157\x72\144\137\x6d\151\x67\162\141\x74\x69\x6f\x6e\137\x73\x75\143\x63\x65\x73\x73\146\165\x6c"]); goto UiSuV; N1Yce: ntPQT: goto CAeYI; e53r_: vBbR7: goto VWkfA; oRRwC: return FALSE; goto Vp1U4; t0z_e: VoZuP: goto H2_GJ; weQAT: goto beyLm; goto t0z_e; wxB0Q: i3neL: goto qhNKJ; sS1y5: return $result; goto gp3wb; zqnBY: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto jbEIh; Icktd: return FALSE; goto weQAT; qhNKJ: if ($hashed_password === $hashed_password_db) { goto VoZuP; } goto jUtHi; jbEIh: goto i3neL; goto e53r_; vVD4Y: $this->trigger_events(["\160\x6f\163\164\x5f\163\150\x61\x31\137\160\141\163\x73\167\x6f\x72\144\137\155\151\x67\x72\x61\164\151\x6f\x6e", "\160\157\163\164\x5f\163\x68\x61\61\x5f\160\x61\x73\x73\167\157\x72\144\x5f\155\151\x67\162\x61\164\x69\x6f\156\x5f\x75\x6e\163\x75\143\143\x65\163\163\x66\x75\154"]); goto oRRwC; H2_GJ: $result = $this->_set_password_db($identity, $password); goto YzBZ_; YzBZ_: if ($result) { goto ntPQT; } goto JPO3w; ra6em: cfR6K: goto pLJzu; hENJ5: if ($this->config->item("\x73\x74\157\x72\145\x5f\x73\141\x6c\164", "\151\x6f\x6e\137\141\x75\164\x68")) { goto vBbR7; } goto wvJQf; ZEgSJ: if (!($query->num_rows() !== 1)) { goto PuAku; } goto vVD4Y; o4OHM: $hashed_password = sha1($password . $salt_db->salt); goto wxB0Q; jUtHi: $this->trigger_events(["\160\x6f\x73\x74\137\163\x68\x61\x31\x5f\x70\141\163\163\167\157\162\144\137\x6d\x69\x67\162\141\x74\151\157\156", "\160\157\163\x74\137\x73\x68\141\61\x5f\x70\x61\x73\x73\x77\x6f\x72\144\137\x6d\x69\x67\x72\141\x74\151\x6f\156\x5f\165\156\163\x75\143\x63\x65\x73\x73\146\165\x6c"]); goto Icktd; UiSuV: ub82N: goto sS1y5; JPO3w: $this->trigger_events(["\x70\157\x73\164\x5f\x73\150\x61\x31\x5f\160\x61\163\x73\167\157\x72\144\x5f\x6d\151\x67\x72\141\x74\151\x6f\156", "\x70\157\163\x74\x5f\x73\x68\x61\61\137\x70\141\x73\x73\x77\x6f\162\x64\x5f\x6d\151\147\162\141\x74\151\x6f\x6e\x5f\165\x6e\x73\165\x63\143\x65\163\163\146\x75\x6c"]); goto BK28r; wvJQf: $salt_length = $this->config->item("\163\141\154\164\137\x6c\145\156\x67\164\150", "\151\x6f\x6e\x5f\x61\x75\164\x68"); goto RoLhX; VWkfA: $query = $this->db->select("\163\141\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\162\x73"]); goto OjcR8; OjcR8: $salt_db = $query->row(); goto ZEgSJ; Vp1U4: PuAku: goto o4OHM; BK28r: goto ub82N; goto N1Yce; pLJzu: $salt = substr($hashed_password_db, 0, $salt_length); goto zqnBY; RoLhX: if ($salt_length) { goto cfR6K; } goto G_UxV; xQ1jT: } }
