<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\x45\x50\x41\124\x48") or exit("\x4e\x6f\40\x64\x69\162\145\x63\x74\40\163\x63\x72\151\x70\x74\40\141\x63\x63\145\163\x73\40\141\x6c\154\x6f\x77\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto KxZto; s0dEp: $group_name = $this->config->item("\x64\x61\164\141\x62\141\163\145\137\147\162\157\x75\160\137\x6e\141\x6d\145", "\151\157\156\x5f\x61\x75\164\150"); goto ma6It; UNDQQ: $this->message_start_delimiter = $this->config->item("\155\x65\163\163\x61\147\x65\x5f\x73\x74\141\x72\164\137\144\x65\x6c\x69\x6d\151\x74\x65\162", "\x69\157\156\x5f\141\x75\164\x68"); goto LI7Yp; SJtgP: $this->lang->load("\151\157\x6e\x5f\x61\x75\x74\x68"); goto s0dEp; PsXgQ: $error_suffix->setAccessible(TRUE); goto nQLt9; SLv1U: $this->load->helper("\144\x61\x74\145"); goto SJtgP; Lh3ZX: $CI =& get_instance(); goto pLitN; A0ENg: $this->hash_method = $this->config->item("\150\x61\x73\x68\x5f\x6d\145\164\150\x6f\144", "\151\x6f\x6e\x5f\141\165\x74\x68"); goto zJV4n; py50u: $this->tables = $this->config->item("\x74\141\x62\154\145\x73", "\x69\157\156\137\141\165\x74\x68"); goto Yk3K8; p0KJU: $this->errors = []; goto uHlwd; uHlwd: $delimiters_source = $this->config->item("\144\x65\154\151\155\151\164\x65\162\163\137\163\157\165\162\x63\x65", "\151\x6f\x6e\137\141\x75\x74\x68"); goto pvJYQ; ma6It: if (empty($group_name)) { goto lUp01; } goto ikuyw; t_1Ge: lUp01: goto Lh3ZX; AO4qQ: $error_prefix->setAccessible(TRUE); goto DcwOC; wkZ2J: $this->message_end_delimiter = $this->error_end_delimiter; goto jqOK9; hHJcv: XT3u4: goto py50u; ikuyw: $this->db = $this->load->database($group_name, TRUE, TRUE); goto CjUYW; CjUYW: goto XT3u4; goto t_1Ge; Y9UHu: $error_suffix = $form_validation_class->getProperty("\137\x65\x72\162\157\162\x5f\x73\165\146\146\151\170"); goto PsXgQ; LI7Yp: $this->message_end_delimiter = $this->config->item("\x6d\x65\163\163\x61\147\145\x5f\x65\156\144\137\x64\145\x6c\x69\155\x69\x74\145\162", "\x69\157\156\x5f\x61\165\x74\150"); goto xjpTO; x2363: $this->message_start_delimiter = $this->error_start_delimiter; goto Y9UHu; zJV4n: $this->messages = []; goto p0KJU; KxZto: $this->config->load("\x69\157\x6e\x5f\x61\165\x74\150", TRUE); goto bF1TZ; pvJYQ: if ($delimiters_source === "\146\157\162\x6d\x5f\166\x61\x6c\x69\x64\x61\x74\x69\157\x6e") { goto IuWoZ; } goto UNDQQ; nQLt9: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto wkZ2J; bF1TZ: $this->load->helper("\x63\157\157\153\x69\145"); goto SLv1U; BAXCe: $this->join = $this->config->item("\x6a\157\151\156", "\x69\x6f\x6e\x5f\141\165\164\150"); goto A0ENg; U5dMn: $this->trigger_events("\x6d\157\144\x65\154\137\143\x6f\x6e\x73\x74\162\165\x63\164\x6f\x72"); goto R3Hf2; NopOy: $this->load->library("\146\157\x72\155\x5f\x76\x61\x6c\x69\144\x61\x74\x69\157\156"); goto as3pc; DcwOC: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto x2363; am2qj: IuWoZ: goto NopOy; s2KAk: goto SrS2J; goto am2qj; gHoQW: $this->_ion_hooks = new stdClass(); goto U5dMn; Yk3K8: $this->identity_column = $this->config->item("\151\144\x65\x6e\x74\x69\x74\171", "\x69\x6f\156\x5f\x61\x75\164\150"); goto BAXCe; r4_gI: $this->error_end_delimiter = $this->config->item("\145\162\x72\157\x72\x5f\x65\156\x64\x5f\144\145\x6c\x69\x6d\x69\x74\x65\162", "\x69\157\156\x5f\141\x75\164\x68"); goto s2KAk; U_yYe: $error_prefix = $form_validation_class->getProperty("\137\x65\162\162\157\162\x5f\160\162\x65\146\151\x78"); goto AO4qQ; xjpTO: $this->error_start_delimiter = $this->config->item("\145\162\x72\x6f\162\137\x73\x74\x61\x72\164\137\144\145\x6c\151\155\151\164\145\162", "\151\157\x6e\x5f\x61\165\164\150"); goto r4_gI; jqOK9: SrS2J: goto gHoQW; as3pc: $form_validation_class = new ReflectionClass("\103\x49\x5f\x46\157\x72\155\x5f\x76\x61\154\151\x64\141\x74\x69\x6f\156"); goto U_yYe; pLitN: $this->db = $CI->db; goto hHJcv; R3Hf2: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto YSTKP; uB48M: return FALSE; goto uj8yu; kmVeS: $params = $this->_get_hash_parameters($identity); goto NbhlN; YSTKP: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto jjwCq; } goto sb0HF; KU011: TUCi3: goto uB48M; J3g6X: $algo = $this->_get_hash_algo(); goto kmVeS; U2L5Z: return password_hash($password, $algo, $params); goto KU011; NbhlN: if (!($algo !== FALSE && $params !== FALSE)) { goto TUCi3; } goto U2L5Z; sb0HF: return FALSE; goto lxtsJ; lxtsJ: jjwCq: goto J3g6X; uj8yu: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto egfZ6; oBOrA: MSIx1: goto Aib5_; O3lpb: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto DaoPQ; vASVo: return password_verify($password, $hash_password_db); goto oBOrA; baCtl: if (strpos($hash_password_db, "\x24") === 0) { goto IT_2L; } goto O3lpb; zQmAP: yx30V: goto baCtl; DaoPQ: goto MSIx1; goto eqWdy; yl2m7: return FALSE; goto zQmAP; eqWdy: IT_2L: goto vASVo; egfZ6: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto yx30V; } goto yl2m7; Aib5_: } public function rehash_password_if_needed($hash, $identity, $password) { goto THAgr; DFY1_: if (!password_needs_rehash($hash, $algo, $params)) { goto v2blQ; } goto KbD4o; Gg_Yb: $params = $this->_get_hash_parameters($identity); goto kYMH3; hORdu: $this->trigger_events(["\x72\x65\x68\x61\163\150\x5f\x70\x61\x73\163\167\157\x72\144", "\x72\145\150\x61\x73\x68\137\x70\141\163\163\167\157\162\x64\137\165\156\x73\x75\143\143\145\163\x73\146\x75\x6c"]); goto O90h2; Tg6D5: pk1Db: goto cltTq; FE1RQ: PqRIN: goto HO8RV; THAgr: $algo = $this->_get_hash_algo(); goto Gg_Yb; KbD4o: if ($this->_set_password_db($identity, $password)) { goto SSuV2; } goto hORdu; QcLym: SSuV2: goto KHais; KHais: $this->trigger_events(["\162\145\150\141\x73\x68\x5f\160\x61\x73\163\167\x6f\162\x64", "\162\145\150\141\x73\150\x5f\160\141\x73\x73\x77\157\x72\x64\x5f\x73\165\143\x63\x65\x73\163\x66\x75\154"]); goto FE1RQ; O90h2: goto PqRIN; goto QcLym; HO8RV: v2blQ: goto Tg6D5; kYMH3: if (!($algo !== FALSE && $params !== FALSE)) { goto pk1Db; } goto DFY1_; cltTq: } public function get_user_by_activation_code($user_code) { goto ZMwB3; RueKz: v6eod: goto JyoyZ; maxdI: return $user; goto osTqc; JyoyZ: return FALSE; goto MaygP; I4M8t: if (!$this->verify_password($token->validator, $user->activation_code)) { goto cNO9m; } goto maxdI; ZMwB3: $token = $this->_retrieve_selector_validator_couple($user_code); goto TDFSM; TDFSM: $user = $this->where("\141\x63\x74\151\x76\x61\164\x69\x6f\x6e\x5f\x73\145\x6c\145\143\x74\x6f\x72", $token->selector)->users()->row(); goto vnomV; vnomV: if (!$user) { goto v6eod; } goto I4M8t; osTqc: cNO9m: goto RueKz; MaygP: } public function activate($id, $code = FALSE) { goto vPC6Q; IYhMT: $user = $this->get_user_by_activation_code($code); goto VfxCu; YugIK: $data = ["\x61\x63\x74\151\166\141\x74\151\157\156\137\x73\145\x6c\145\x63\164\x6f\x72" => NULL, "\x61\143\x74\151\166\x61\164\151\157\156\x5f\143\157\x64\x65" => NULL, "\x61\x63\x74\151\166\x65" => 1]; goto CCcMl; CCcMl: $this->trigger_events("\x65\x78\164\162\141\x5f\x77\x68\x65\x72\145"); goto Z3MR4; fzwqv: hd6jY: goto sgLCD; OxY0V: $this->trigger_events(["\160\157\x73\164\137\141\143\164\151\x76\x61\x74\x65", "\160\x6f\x73\164\x5f\141\143\x74\x69\x76\x61\x74\145\137\163\x75\143\143\145\163\x73\146\165\x6c"]); goto KxAAZ; vPC6Q: $this->trigger_events("\x70\162\x65\137\x61\143\x74\x69\x76\141\x74\145"); goto YiD2e; E5kHA: $this->set_error("\141\143\164\x69\x76\x61\164\x65\137\x75\x6e\x73\x75\143\x63\145\x73\163\146\165\x6c"); goto i2ZQo; VfxCu: sCIg0: goto dygr_; z6WMp: if (!($this->db->affected_rows() === 1)) { goto hd6jY; } goto OxY0V; YiD2e: if (!($code !== FALSE)) { goto sCIg0; } goto IYhMT; sd90V: $this->trigger_events(["\x70\157\163\x74\x5f\141\x63\x74\x69\x76\141\x74\x65", "\x70\x6f\x73\164\x5f\x61\x63\164\151\x76\141\164\145\x5f\x75\156\163\165\143\143\x65\x73\163\146\165\x6c"]); goto E5kHA; Z3MR4: $this->db->update($this->tables["\x75\163\145\162\163"], $data, ["\151\x64" => $id]); goto z6WMp; KxAAZ: $this->set_message("\x61\143\x74\x69\166\x61\164\x65\x5f\163\165\x63\x63\145\163\163\146\165\154"); goto WqYyJ; WqYyJ: return TRUE; goto fzwqv; sgLCD: nAIRc: goto sd90V; i2ZQo: return FALSE; goto OwMFG; dygr_: if (!($code === FALSE || $user && $user->id === $id)) { goto nAIRc; } goto YugIK; OwMFG: } public function deactivate($id = NULL) { goto FGdSU; pK_H6: return $return; goto DnVel; ycREk: $data = ["\x61\143\x74\x69\166\x61\x74\x69\157\156\137\x73\145\154\145\143\x74\157\x72" => $token->selector, "\141\x63\164\x69\x76\141\x74\x69\157\156\x5f\143\x6f\144\x65" => $token->validator_hashed, "\141\x63\164\x69\x76\x65" => 0]; goto hHbsF; FGdSU: $this->trigger_events("\144\x65\x61\143\x74\x69\166\x61\164\145"); goto WLTJB; afmJc: $this->set_error("\144\145\141\143\164\x69\x76\141\164\145\137\x75\156\163\x75\x63\x63\145\x73\x73\x66\165\x6c"); goto e9rTg; naJq1: $this->set_error("\x64\145\x61\143\x74\x69\166\141\164\x65\x5f\165\156\x73\x75\143\x63\x65\163\163\146\x75\x6c"); goto kEM1K; Zp1oZ: $this->set_error("\144\145\x61\x63\164\x69\x76\x61\x74\145\x5f\143\x75\162\162\x65\x6e\164\x5f\165\163\x65\x72\x5f\x75\x6e\163\165\143\x63\145\163\x73\146\x75\154"); goto uOfCC; kEM1K: goto iruVz; goto EQ5Mk; WLTJB: if (!isset($id)) { goto dN_MG; } goto R9oWy; xcFsX: goto VaW6P; goto Zr5_H; R9oWy: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto DKj2D; } goto Zp1oZ; UcFny: DKj2D: goto xcFsX; OeME4: VaW6P: goto SZDN2; SZDN2: $token = $this->_generate_selector_validator_couple(20, 40); goto xP07h; GafSq: iruVz: goto pK_H6; hHbsF: $this->trigger_events("\145\x78\164\162\141\137\x77\150\x65\x72\145"); goto lGjye; nhEAU: if ($return) { goto JgzQn; } goto naJq1; xP07h: $this->activation_code = $token->user_code; goto ycREk; lGjye: $this->db->update($this->tables["\x75\163\145\x72\163"], $data, ["\151\x64" => $id]); goto EbHiR; x860k: $this->set_message("\144\145\141\x63\164\151\x76\141\x74\x65\137\x73\x75\143\143\x65\x73\163\146\x75\154"); goto GafSq; e9rTg: return FALSE; goto OeME4; EQ5Mk: JgzQn: goto x860k; Zr5_H: dN_MG: goto afmJc; EbHiR: $return = $this->db->affected_rows() == 1; goto nhEAU; uOfCC: return FALSE; goto UcFny; DnVel: } public function clear_forgotten_password_code($identity) { goto DQBPM; DQBPM: if (!empty($identity)) { goto V7HI6; } goto upK1B; bW57X: $data = ["\x66\157\x72\x67\x6f\164\x74\145\x6e\x5f\160\141\163\163\x77\x6f\x72\144\137\163\145\x6c\x65\143\x74\x6f\x72" => NULL, "\x66\157\x72\x67\x6f\164\x74\145\156\137\160\141\x73\x73\167\x6f\162\x64\x5f\x63\x6f\x64\x65" => NULL, "\x66\157\162\x67\x6f\164\x74\145\156\137\x70\141\x73\x73\x77\x6f\x72\x64\137\164\151\155\145" => NULL]; goto gp_tU; Ja9h4: return TRUE; goto nTOKZ; upK1B: return FALSE; goto Eg5p5; Eg5p5: V7HI6: goto bW57X; gp_tU: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto Ja9h4; nTOKZ: } public function clear_remember_code($identity) { goto q_tND; q_tND: if (!empty($identity)) { goto ZBtlW; } goto jBXFW; o_I9c: $data = ["\x72\145\x6d\145\155\142\x65\x72\x5f\x73\145\154\145\143\164\x6f\x72" => NULL, "\x72\145\x6d\x65\x6d\x62\x65\162\x5f\143\157\x64\x65" => NULL]; goto ty_Ch; c1nE1: ZBtlW: goto o_I9c; jBXFW: return FALSE; goto c1nE1; ty_Ch: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto lva9d; lva9d: return TRUE; goto hk2Af; hk2Af: } public function reset_password($identity, $new) { goto PdV3S; VhM71: WVjx4: goto lS3u3; oefar: $this->set_error("\x70\141\x73\163\x77\x6f\x72\x64\137\143\x68\141\x6e\147\145\137\165\x6e\x73\x75\x63\143\145\x73\163\146\165\154"); goto me7VW; lS3u3: return $return; goto nqtQD; Q1Yvp: $this->trigger_events(["\160\157\163\x74\137\143\150\141\156\147\x65\x5f\160\141\163\x73\x77\x6f\x72\144", "\160\157\x73\164\x5f\x63\x68\141\x6e\x67\x65\x5f\x70\x61\163\163\167\x6f\162\144\x5f\x75\x6e\163\165\x63\x63\x65\163\163\x66\165\154"]); goto fDw01; PdV3S: $this->trigger_events("\x70\162\x65\137\x63\150\141\x6e\147\x65\x5f\x70\141\163\x73\x77\157\162\x64"); goto CPd7g; CPd7g: if ($this->identity_check($identity)) { goto T8Jdo; } goto Q1Yvp; oGnps: $this->trigger_events(["\160\x6f\x73\164\137\x63\150\141\x6e\x67\145\137\160\141\163\x73\x77\157\162\x64", "\160\x6f\163\164\x5f\x63\150\141\156\147\x65\x5f\x70\x61\163\163\x77\157\162\144\137\163\165\x63\x63\x65\163\x73\x66\165\x6c"]); goto Grtjt; kw51P: T8Jdo: goto V5hFQ; bNprr: $this->trigger_events(["\160\x6f\163\x74\137\143\150\x61\x6e\147\x65\137\160\141\x73\x73\x77\157\162\144", "\160\157\163\164\x5f\x63\150\x61\x6e\x67\145\x5f\x70\141\x73\163\x77\157\x72\x64\137\x75\x6e\x73\x75\x63\143\145\163\163\146\x75\154"]); goto oefar; fDw01: return FALSE; goto kw51P; Grtjt: $this->set_message("\160\x61\x73\x73\x77\157\162\144\x5f\143\150\x61\156\147\145\x5f\163\165\x63\x63\x65\163\163\x66\165\x6c"); goto VhM71; r2BXO: hnHDG: goto oGnps; V5hFQ: $return = $this->_set_password_db($identity, $new); goto EfPx0; EfPx0: if ($return) { goto hnHDG; } goto bNprr; me7VW: goto WVjx4; goto r2BXO; nqtQD: } public function change_password($identity, $old, $new) { goto w0gNO; ZiCsn: $user = $query->row(); goto HCRE0; fP2Zt: if ($result) { goto PG8GO; } goto AbNR7; w0gNO: $this->trigger_events("\x70\x72\145\x5f\143\150\141\156\147\x65\x5f\160\141\x73\x73\167\157\x72\144"); goto SE18K; GH6Uw: goto Ux8OI; goto poGf6; QsMBp: return FALSE; goto UDcm_; UqQFv: $this->set_error("\x70\141\163\163\x77\x6f\x72\x64\137\143\x68\x61\x6e\147\145\137\x75\156\163\x75\x63\x63\x65\x73\163\146\x75\154"); goto GH6Uw; C20G5: jWz_O: goto faWN5; UTUwI: if (!($query->num_rows() !== 1)) { goto V2VbZ; } goto DLVma; UDcm_: V2VbZ: goto ZiCsn; K7snk: $this->set_message("\x70\141\x73\163\167\x6f\x72\144\x5f\x63\150\x61\156\147\145\137\x73\x75\x63\x63\x65\163\x73\146\165\x6c"); goto eSz14; B3pxp: $this->set_error("\x70\141\163\163\167\x6f\x72\144\137\x63\x68\141\x6e\x67\145\137\165\x6e\x73\x75\143\143\x65\163\x73\x66\x75\154"); goto QsMBp; pOnwP: $this->trigger_events(["\x70\157\163\x74\137\x63\x68\141\156\147\x65\x5f\x70\x61\163\x73\167\x6f\x72\144", "\160\x6f\163\x74\x5f\x63\150\141\x6e\147\145\137\160\141\163\163\167\157\162\144\137\163\x75\x63\143\x65\163\163\x66\165\x6c"]); goto K7snk; DLVma: $this->trigger_events(["\x70\157\x73\164\x5f\143\x68\141\x6e\x67\145\137\x70\x61\x73\x73\167\x6f\x72\x64", "\x70\x6f\x73\x74\x5f\x63\x68\141\x6e\147\x65\137\160\x61\x73\x73\167\x6f\162\144\x5f\x75\156\163\165\x63\143\x65\163\x73\x66\x75\154"]); goto B3pxp; AbNR7: $this->trigger_events(["\160\x6f\x73\164\x5f\x63\x68\141\x6e\147\145\137\160\141\163\x73\167\157\x72\x64", "\x70\x6f\163\x74\x5f\143\150\141\156\147\145\137\160\141\163\163\167\x6f\x72\144\137\x75\156\x73\x75\143\143\x65\x73\163\146\165\154"]); goto UqQFv; faWN5: $this->set_error("\160\x61\163\163\167\157\162\144\x5f\x63\150\141\156\x67\145\x5f\x75\x6e\163\165\143\x63\145\163\x73\146\165\154"); goto SNlcD; HCRE0: if (!$this->verify_password($old, $user->password, $identity)) { goto jWz_O; } goto UZaOp; SNlcD: return FALSE; goto iG5A8; UZaOp: $result = $this->_set_password_db($identity, $new); goto fP2Zt; SE18K: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\x68\x65\162\x65"); goto MvwJI; poGf6: PG8GO: goto pOnwP; ocS8Y: return $result; goto C20G5; eSz14: Ux8OI: goto ocS8Y; MvwJI: $query = $this->db->select("\x69\144\54\40\x70\x61\x73\163\x77\157\x72\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\x65\163\x63")->get($this->tables["\x75\x73\x65\x72\x73"]); goto UTUwI; iG5A8: } public function username_check($username = '') { goto eGnKD; d7nHd: if (!empty($username)) { goto QHqqW; } goto UR93Z; X8nds: QHqqW: goto D9rfc; eGnKD: $this->trigger_events("\x75\x73\145\x72\156\x61\155\145\x5f\x63\150\x65\x63\153"); goto d7nHd; UR93Z: return FALSE; goto X8nds; clDNm: return $this->db->where("\165\163\145\162\156\x61\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\163"]) > 0; goto CFVh5; D9rfc: $this->trigger_events("\x65\170\164\162\x61\137\167\150\x65\162\145"); goto clDNm; CFVh5: } public function email_check($email = '') { goto BzjYb; pWLqe: return $this->db->where("\145\155\141\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\163"]) > 0; goto XXvsm; BzjYb: $this->trigger_events("\x65\155\141\151\154\137\x63\150\x65\143\x6b"); goto Bgmqn; OHg2e: $this->trigger_events("\145\170\164\x72\x61\137\167\x68\145\x72\x65"); goto pWLqe; tgBc7: return FALSE; goto Jb1HI; Jb1HI: KEI_0: goto OHg2e; Bgmqn: if (!empty($email)) { goto KEI_0; } goto tgBc7; XXvsm: } public function identity_check($identity = '') { goto sQFqO; kws8e: if (!empty($identity)) { goto Jwoqu; } goto vMgJQ; vMgJQ: return FALSE; goto CC0J0; sQFqO: $this->trigger_events("\151\x64\x65\156\x74\x69\164\171\x5f\x63\x68\145\143\x6b"); goto kws8e; pehDI: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\145\162\163"]) > 0; goto Ig5Qg; CC0J0: Jwoqu: goto pehDI; Ig5Qg: } public function get_user_id_from_identity($identity = '') { goto Zqb29; Gbgus: if (!($query->num_rows() !== 1)) { goto xka0Y; } goto AkVF1; FNSr4: qMT1L: goto CMp7X; SbnwE: return FALSE; goto FNSr4; uLDxr: xka0Y: goto e2fzH; AkVF1: return FALSE; goto uLDxr; e2fzH: $user = $query->row(); goto wXgyJ; wXgyJ: return $user->id; goto T6ctv; CMp7X: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto Gbgus; Zqb29: if (!empty($identity)) { goto qMT1L; } goto SbnwE; T6ctv: } public function forgotten_password($identity) { goto juHv1; Rkkm_: goto cqjmQ; goto jYoY2; LiW0z: $this->trigger_events(["\160\x6f\x73\x74\137\146\x6f\x72\147\x6f\x74\164\145\x6e\137\160\141\163\163\167\157\x72\144", "\160\157\163\164\137\x66\x6f\162\147\x6f\x74\164\145\x6e\x5f\160\141\x73\163\x77\x6f\162\144\137\163\165\143\x63\145\163\x73\x66\165\154"]); goto uyBzh; juHv1: if (!empty($identity)) { goto wPNZe; } goto aD3IS; aD3IS: $this->trigger_events(["\x70\x6f\x73\164\137\x66\157\162\147\x6f\x74\x74\145\x6e\x5f\160\x61\x73\163\x77\x6f\x72\x64", "\160\x6f\163\164\137\x66\157\162\147\157\x74\164\145\156\137\x70\141\163\x73\x77\x6f\x72\144\137\165\156\163\x75\x63\143\x65\x73\x73\x66\x75\x6c"]); goto UV50Y; gNMGj: cqjmQ: goto xZQvR; xqtXH: $this->trigger_events("\x65\x78\x74\162\x61\137\167\x68\x65\x72\x65"); goto a52U2; uyBzh: return $token->user_code; goto gNMGj; a52U2: $this->db->update($this->tables["\165\163\145\x72\163"], $update, [$this->identity_column => $identity]); goto YPTMJ; UV50Y: return FALSE; goto aFnrW; aFnrW: wPNZe: goto y77jM; jYoY2: Us0Ka: goto LiW0z; tvm3c: return FALSE; goto Rkkm_; YPTMJ: if ($this->db->affected_rows() === 1) { goto Us0Ka; } goto nAv50; nAv50: $this->trigger_events(["\x70\x6f\163\164\x5f\x66\157\x72\x67\157\164\164\x65\156\137\x70\x61\163\x73\167\x6f\162\144", "\x70\157\163\x74\137\x66\157\x72\x67\157\164\x74\x65\156\137\160\x61\x73\x73\167\x6f\x72\x64\137\165\156\x73\x75\x63\143\x65\163\163\146\165\x6c"]); goto tvm3c; y77jM: $token = $this->_generate_selector_validator_couple(20, 80); goto I6mkA; I6mkA: $update = ["\146\157\x72\x67\x6f\x74\x74\x65\x6e\137\x70\141\163\x73\167\x6f\x72\144\137\x73\x65\x6c\145\143\x74\157\162" => $token->selector, "\x66\x6f\162\147\x6f\x74\164\145\156\x5f\x70\x61\163\163\167\157\162\x64\137\143\x6f\144\145" => $token->validator_hashed, "\146\x6f\162\147\x6f\164\164\145\156\x5f\160\x61\163\163\167\157\162\x64\137\164\151\x6d\x65" => time()]; goto xqtXH; xZQvR: } public function get_user_by_forgotten_password_code($user_code) { goto ZzlVl; VcG3V: if (!$user) { goto alloG; } goto KBZsg; pnDNY: alloG: goto reO2S; ZzlVl: $token = $this->_retrieve_selector_validator_couple($user_code); goto od3J_; izpOt: return $user; goto LphRB; od3J_: $user = $this->where("\x66\157\162\147\157\164\164\x65\x6e\137\x70\141\x73\163\167\x6f\162\144\x5f\x73\x65\154\x65\x63\164\x6f\x72", $token->selector)->users()->row(); goto VcG3V; LphRB: PdwPh: goto pnDNY; KBZsg: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto PdwPh; } goto izpOt; reO2S: return FALSE; goto sZUZK; sZUZK: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto yxj5C; svXUK: $ip_address = $this->input->ip_address(); goto Ke_et; YQZFn: return isset($id) ? $id : FALSE; goto woYBa; x5ILQ: $this->db->insert($this->tables["\165\x73\145\x72\163"], $user_data); goto CZdzL; HYh1z: $this->set_error("\141\143\x63\157\x75\x6e\x74\x5f\143\x72\x65\x61\164\x69\x6f\x6e\x5f\x69\x6e\x76\141\154\x69\x64\x5f\x64\145\146\x61\165\154\x74\137\147\x72\157\x75\x70"); goto YKerS; m60YJ: $data = [$this->identity_column => $identity, "\x75\x73\145\162\156\x61\x6d\145" => $identity, "\160\x61\x73\x73\167\x6f\x72\x64" => $password, "\145\155\141\x69\x6c" => $email, "\x69\160\137\141\x64\144\162\x65\163\163" => $ip_address, "\x63\x72\x65\x61\x74\145\144\137\157\x6e" => time(), "\141\143\164\x69\166\145" => $manual_activation === FALSE ? 1 : 0]; goto ABGRV; FoJoA: if (!(!$this->config->item("\144\145\x66\x61\165\154\x74\137\147\x72\x6f\165\160", "\151\157\x6e\x5f\141\165\x74\150") && empty($groups))) { goto a9umt; } goto Xh4HR; CZdzL: $id = $this->db->insert_id($this->tables["\x75\163\x65\162\163"] . "\137\x69\144\x5f\163\x65\161"); goto gCuTy; EAUst: if (!(!isset($query->id) && empty($groups))) { goto OocpJ; } goto HYh1z; lwyMB: lA0A7: goto zx5sZ; Ke_et: $password = $this->hash_password($password); goto siaKC; OH85_: $query = $this->db->get_where($this->tables["\147\x72\157\x75\x70\x73"], ["\x6e\x61\x6d\145" => $this->config->item("\x64\x65\x66\141\x75\x6c\164\137\147\162\x6f\x75\160", "\151\157\x6e\137\x61\165\x74\150")], 1)->row(); goto EAUst; RxukW: foreach ($groups as $group) { $this->add_to_group($group, $id); XB9o4: } goto PIpTw; ABGRV: $user_data = array_merge($this->_filter_data($this->tables["\165\163\x65\x72\x73"], $additional_data), $data); goto fvpaV; Rp81t: X6UcY: goto OH85_; cY8UH: $manual_activation = $this->config->item("\155\x61\x6e\165\141\154\x5f\141\143\164\151\x76\x61\x74\x69\157\x6e", "\x69\x6f\156\137\141\x75\x74\x68"); goto WmiTE; yxj5C: $this->trigger_events("\x70\162\x65\x5f\x72\x65\147\151\x73\164\145\162"); goto cY8UH; XK2cn: return FALSE; goto t685Q; kH8eV: lfu1_: goto ktEx6; zx5sZ: $this->trigger_events("\160\x6f\x73\x74\x5f\x72\x65\x67\151\x73\164\x65\162"); goto YQZFn; WmiTE: if ($this->identity_check($identity)) { goto ro_TY; } goto FoJoA; zQPy8: $default_group = $query; goto svXUK; GarGr: return FALSE; goto KJg0V; SX7Dg: goto X6UcY; goto BakmD; siaKC: if (!($password === FALSE)) { goto zEWJt; } goto K91E6; djPVQ: OocpJ: goto zQPy8; KJg0V: zEWJt: goto m60YJ; YKerS: return FALSE; goto djPVQ; f6UfD: $groups[] = $default_group->id; goto kH8eV; BakmD: ro_TY: goto t9vlP; PIpTw: v0RV_: goto lwyMB; fvpaV: $this->trigger_events("\x65\x78\164\x72\x61\x5f\163\145\164"); goto x5ILQ; K91E6: $this->set_error("\x61\143\x63\x6f\165\156\164\x5f\143\162\145\141\164\151\157\x6e\x5f\x75\x6e\163\165\x63\143\145\x73\163\146\x75\x6c"); goto GarGr; t9vlP: $this->set_error("\141\x63\143\x6f\165\156\x74\137\143\162\145\x61\164\151\157\x6e\137\x64\x75\x70\154\151\143\x61\164\145\x5f\151\144\x65\x6e\x74\x69\164\x79"); goto Sq2cA; Xh4HR: $this->set_error("\x61\x63\x63\x6f\x75\156\164\137\x63\162\145\141\x74\x69\x6f\x6e\137\x6d\x69\x73\163\x69\x6e\147\x5f\x64\145\146\x61\x75\x6c\x74\x5f\x67\162\157\x75\x70"); goto XK2cn; Sq2cA: return FALSE; goto Rp81t; gCuTy: if (!(isset($default_group->id) && empty($groups))) { goto lfu1_; } goto f6UfD; ktEx6: if (empty($groups)) { goto lA0A7; } goto RxukW; t685Q: a9umt: goto SX7Dg; woYBa: } public function login($identity, $password, $remember = FALSE) { goto O2yGQ; cYtDI: g2H0M: goto rOAOW; NI7tT: JqKkK: goto EevtR; C7jEH: $this->set_error("\x6c\157\x67\x69\156\x5f\x75\x6e\163\165\x63\x63\145\x73\163\146\x75\x6c\x5f\x6e\157\164\137\141\143\164\x69\166\x65"); goto SDJAh; TyA9L: O7_bN: goto tuw0q; QiVk4: $this->trigger_events("\x70\157\x73\164\x5f\154\x6f\x67\151\x6e\137\x75\156\163\x75\x63\x63\145\163\163\146\165\154"); goto vZVpF; g_hCS: $this->update_last_login($user->id); goto CKBGu; QhYYW: if (!($query->num_rows() === 1)) { goto g2H0M; } goto oZcMa; oZcMa: $user = $query->row(); goto TAvXa; GEUXc: $this->set_error("\154\x6f\x67\x69\x6e\137\x75\x6e\x73\165\143\x63\145\163\x73\x66\x75\154"); goto h5B5r; YdER7: e108h: goto KlHdA; EevtR: $this->rehash_password_if_needed($user->password, $identity, $password); goto ogj5w; Qqs1G: $this->hash_password($password); goto QiVk4; SDJAh: return FALSE; goto YdER7; h5B5r: return FALSE; goto f8YqW; GoPbS: fs1aJ: goto cYtDI; PGsbU: IX0hX: goto QhYYW; f8YqW: POfIw: goto HECyA; Vy1kZ: return TRUE; goto GoPbS; rOAOW: $this->hash_password($password); goto xt0WF; SEmZR: return FALSE; goto PGsbU; TAvXa: if (!$this->verify_password($password, $user->password, $identity)) { goto fs1aJ; } goto K1EKo; vZVpF: $this->set_error("\154\157\x67\151\156\x5f\x74\151\155\145\x6f\165\164"); goto SEmZR; betSZ: goto Ek9Ge; goto TyA9L; K1EKo: if (!($user->active == 0)) { goto e108h; } goto sqfZz; Owfnx: $this->trigger_events("\x70\157\163\164\137\x6c\157\147\151\156\x5f\x75\x6e\x73\x75\x63\143\145\163\x73\146\x75\x6c"); goto iOdJr; KPQCt: Ek9Ge: goto NI7tT; RcJBm: $this->clear_remember_code($identity); goto betSZ; Cza9t: $this->clear_forgotten_password_code($identity); goto KqC6_; tuw0q: $this->remember_user($identity); goto KPQCt; CKBGu: $this->clear_login_attempts($identity); goto Cza9t; bVr06: if (!$this->is_max_login_attempts_exceeded($identity)) { goto IX0hX; } goto Qqs1G; HECyA: $this->trigger_events("\x65\170\x74\162\141\x5f\x77\150\x65\x72\145"); goto Id1Vw; KqC6_: if (!$this->config->item("\162\x65\155\x65\155\x62\145\162\137\x75\x73\x65\162\x73", "\151\157\x6e\137\x61\x75\164\x68")) { goto JqKkK; } goto UJQ8C; epzCn: $this->set_message("\154\157\147\x69\156\x5f\163\x75\143\143\145\163\x73\146\x75\154"); goto Vy1kZ; Id1Vw: $query = $this->db->select($this->identity_column . "\54\40\145\155\141\x69\154\x2c\40\151\144\54\x20\160\141\163\x73\167\157\x72\144\54\40\141\143\164\151\x76\145\x2c\40\154\141\x73\164\137\154\157\147\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\x73\x63")->get($this->tables["\x75\x73\x65\162\163"]); goto bVr06; KlHdA: $this->set_session($user); goto g_hCS; sqfZz: $this->trigger_events("\160\157\163\x74\137\154\x6f\x67\151\156\x5f\x75\156\x73\x75\x63\143\145\x73\163\146\x75\x6c"); goto C7jEH; ogj5w: $this->session->sess_regenerate(FALSE); goto mj9zx; iOdJr: $this->set_error("\x6c\157\147\151\x6e\137\165\x6e\x73\165\x63\x63\x65\163\x73\146\165\154"); goto vzD9W; O2yGQ: $this->trigger_events("\x70\162\145\x5f\x6c\157\x67\x69\156"); goto mheKD; xt0WF: $this->increase_login_attempts($identity); goto Owfnx; mj9zx: $this->trigger_events(["\160\157\x73\x74\x5f\x6c\157\147\151\x6e", "\x70\x6f\x73\x74\137\x6c\157\147\x69\156\137\163\x75\143\x63\145\x73\x73\x66\x75\x6c"]); goto epzCn; vzD9W: return FALSE; goto HcWzg; UJQ8C: if ($remember) { goto O7_bN; } goto RcJBm; mheKD: if (!(empty($identity) || empty($password))) { goto POfIw; } goto GEUXc; HcWzg: } public function recheck_session() { goto d5AB0; V4Lml: b0qzN: goto pRwSG; CaJoH: if ($query->num_rows() === 1) { goto b0qzN; } goto qDhxz; sAbH7: return FALSE; goto ktrFY; ANwyP: o0Lpv: goto zGfb8; IXSVL: $last_login = $this->session->userdata("\x6c\141\163\x74\x5f\143\150\x65\143\x6b"); goto Rh_jH; ktrFY: goto N3zWM; goto V4Lml; fSrPv: $identity = $this->config->item("\151\144\x65\156\164\x69\164\x79", "\151\157\156\x5f\x61\x75\x74\150"); goto m2mCq; zGfb8: return (bool) $this->session->userdata("\x69\x64\x65\x6e\x74\x69\x74\171"); goto oWnW0; d5AB0: $recheck = NULL !== $this->config->item("\x72\145\x63\150\x65\x63\x6b\137\164\151\x6d\145\162", "\x69\157\156\137\141\x75\164\x68") ? $this->config->item("\x72\x65\143\150\x65\x63\153\x5f\x74\x69\x6d\145\162", "\151\x6f\x6e\137\x61\x75\x74\150") : 0; goto FinTC; qDhxz: $this->trigger_events("\x6c\x6f\x67\157\x75\164"); goto fSrPv; rjDsY: QNyUd: goto ANwyP; SZkXJ: N3zWM: goto rjDsY; pRwSG: $this->session->set_userdata("\154\141\x73\164\137\143\x68\x65\x63\x6b", time()); goto SZkXJ; FinTC: if (!($recheck !== 0)) { goto o0Lpv; } goto IXSVL; Rh_jH: if (!($last_login + $recheck < time())) { goto QNyUd; } goto h58d1; h58d1: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\151\x64\145\156\164\x69\x74\x79"), "\x61\x63\164\151\166\x65" => "\61"])->limit(1)->order_by("\x69\144", "\x64\145\163\143")->get($this->tables["\x75\163\x65\162\x73"]); goto CaJoH; m2mCq: $this->session->unset_userdata([$identity, "\x69\x64", "\x75\163\x65\162\137\x69\144"]); goto sAbH7; oWnW0: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto bM8b7; mfv_9: $max_attempts = $this->config->item("\x6d\x61\170\151\155\x75\155\137\x6c\157\x67\151\x6e\x5f\x61\164\x74\145\155\160\x74\x73", "\151\157\156\137\x61\x75\164\150"); goto ppMBv; ppMBv: if (!($max_attempts > 0)) { goto SkcpE; } goto C25CC; YoNYv: return FALSE; goto MlN3y; s8heG: return $attempts >= $max_attempts; goto gmjow; bM8b7: if (!$this->config->item("\164\162\141\143\153\x5f\x6c\157\x67\151\156\137\141\x74\164\145\155\x70\164\x73", "\x69\x6f\x6e\137\141\x75\x74\x68")) { goto HyGpa; } goto mfv_9; gmjow: SkcpE: goto KEn0P; KEn0P: HyGpa: goto YoNYv; C25CC: $attempts = $this->get_attempts_num($identity, $ip_address); goto s8heG; MlN3y: } public function get_attempts_num($identity, $ip_address = NULL) { goto v0gXy; fKmMx: if (isset($ip_address)) { goto xe_PA; } goto f2roN; uzAxQ: return 0; goto tA6BX; s1F_q: $qres = $this->db->get($this->tables["\154\157\147\x69\x6e\137\141\x74\x74\145\155\160\x74\163"]); goto nBwDj; IoKQn: $this->db->where("\x6c\x6f\147\x69\x6e", $identity); goto jS7ff; O3B4W: GBt3f: goto uzAxQ; jS7ff: if (!$this->config->item("\164\162\141\143\153\137\x6c\x6f\147\151\156\137\x69\160\137\141\144\144\x72\x65\163\163", "\151\x6f\156\x5f\141\165\164\150")) { goto RSLoN; } goto fKmMx; Cidwb: $this->db->where("\x74\151\x6d\145\x20\76", time() - $this->config->item("\x6c\157\x63\153\x6f\165\164\137\x74\151\x6d\x65", "\x69\x6f\x6e\x5f\x61\x75\x74\150"), FALSE); goto s1F_q; ikmQi: $this->db->where("\x69\160\x5f\x61\x64\144\x72\145\x73\163", $ip_address); goto PdfmB; Cq02H: $this->db->select("\61", FALSE); goto IoKQn; PdfmB: RSLoN: goto Cidwb; nBwDj: return $qres->num_rows(); goto O3B4W; v0gXy: if (!$this->config->item("\x74\x72\141\143\x6b\x5f\154\x6f\147\x69\x6e\137\141\164\164\145\x6d\x70\x74\163", "\151\x6f\156\x5f\x61\165\164\x68")) { goto GBt3f; } goto Cq02H; f2roN: $ip_address = $this->input->ip_address(); goto aUzQD; aUzQD: xe_PA: goto ikmQi; tA6BX: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto u_WF2; tTbnv: if (isset($ip_address)) { goto Yl6dv; } goto URsAK; Y59xt: D8lQb: goto CSpZc; jEX_5: vLH83: goto WPvlx; JbeuJ: return 0; goto giQIw; URsAK: $ip_address = $this->input->ip_address(); goto aJnfU; B6TwN: $this->db->where("\x69\x70\x5f\x61\x64\144\x72\145\x73\x73", $ip_address); goto jEX_5; aJnfU: Yl6dv: goto B6TwN; UsWLI: $qres = $this->db->get($this->tables["\154\x6f\147\x69\x6e\137\141\164\x74\145\x6d\160\164\163"], 1); goto LFu5f; y1d2O: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto miw8c; miw8c: if (!$this->config->item("\164\x72\x61\x63\153\x5f\154\x6f\x67\151\156\137\x69\160\x5f\141\144\x64\162\145\x73\x73", "\x69\x6f\156\x5f\x61\165\x74\x68")) { goto vLH83; } goto tTbnv; VcW9h: $this->db->select("\164\151\x6d\x65"); goto y1d2O; WPvlx: $this->db->order_by("\x69\144", "\144\145\163\x63"); goto UsWLI; u_WF2: if (!$this->config->item("\164\162\141\x63\x6b\x5f\154\x6f\147\x69\x6e\x5f\x61\164\x74\x65\x6d\160\164\163", "\x69\x6f\156\x5f\141\165\164\x68")) { goto OW_7a; } goto VcW9h; CSpZc: OW_7a: goto JbeuJ; LFu5f: if (!($qres->num_rows() > 0)) { goto D8lQb; } goto dxvxN; dxvxN: return $qres->row()->time; goto Y59xt; giQIw: } public function get_last_attempt_ip($identity) { goto avD2g; uzM8a: Yo8AX: goto BHX9L; uGT2P: $this->db->order_by("\151\x64", "\x64\145\163\x63"); goto q8P63; BHX9L: ne9Hi: goto v7bDA; avD2g: if (!($this->config->item("\164\x72\x61\143\153\137\x6c\x6f\x67\x69\156\x5f\141\164\164\145\155\x70\x74\163", "\151\x6f\156\137\141\x75\x74\x68") && $this->config->item("\x74\x72\141\x63\x6b\x5f\x6c\x6f\x67\x69\156\137\x69\160\137\x61\x64\x64\162\145\163\163", "\151\157\156\x5f\141\165\x74\x68"))) { goto ne9Hi; } goto V6vwZ; V6vwZ: $this->db->select("\x69\x70\137\141\x64\144\x72\x65\163\163"); goto lrXg6; q8P63: $qres = $this->db->get($this->tables["\x6c\x6f\147\151\156\137\141\164\x74\x65\155\160\x74\163"], 1); goto K1714; lrXg6: $this->db->where("\x6c\157\147\x69\156", $identity); goto uGT2P; K1714: if (!($qres->num_rows() > 0)) { goto Yo8AX; } goto Smybi; v7bDA: return ''; goto frqB6; Smybi: return $qres->row()->ip_address; goto uzM8a; frqB6: } public function increase_login_attempts($identity) { goto gTiAr; T0YIy: $data = ["\x69\x70\x5f\x61\x64\144\162\145\163\x73" => '', "\154\x6f\x67\x69\x6e" => $identity, "\164\x69\155\x65" => time()]; goto YmzuZ; QMXIW: sC5rX: goto ETj8m; ETj8m: return $this->db->insert($this->tables["\x6c\x6f\147\x69\x6e\137\x61\x74\x74\145\155\160\164\163"], $data); goto pGwZj; zSJGB: $data["\151\160\137\141\144\144\162\x65\x73\163"] = $this->input->ip_address(); goto QMXIW; BIAj6: return FALSE; goto C0i7W; gTiAr: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\157\147\x69\156\x5f\x61\164\x74\145\155\160\x74\x73", "\x69\157\x6e\137\x61\x75\x74\150")) { goto U2iqt; } goto T0YIy; pGwZj: U2iqt: goto BIAj6; YmzuZ: if (!$this->config->item("\x74\162\141\143\x6b\x5f\154\157\x67\x69\x6e\137\x69\x70\x5f\141\x64\x64\x72\145\x73\163", "\x69\x6f\x6e\137\x61\165\164\150")) { goto sC5rX; } goto zSJGB; C0i7W: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto Ix2ow; Sf8Lx: $this->db->where("\151\160\x5f\141\144\144\x72\x65\x73\x73", $ip_address); goto nlwmq; Spu48: $this->db->or_where("\x74\151\x6d\145\x20\x3c", time() - $old_attempts_expire_period, FALSE); goto DFPOQ; Ix2ow: if (!$this->config->item("\x74\x72\141\143\x6b\x5f\154\157\x67\x69\x6e\137\x61\x74\164\145\155\160\164\x73", "\151\x6f\x6e\x5f\141\165\164\x68")) { goto o8cxv; } goto oKhKD; oKhKD: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\143\x6b\157\165\164\x5f\164\151\155\x65", "\x69\x6f\156\137\141\165\x74\x68")); goto IOtWI; dOrMZ: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\154\x6f\147\x69\x6e\137\x69\x70\x5f\141\144\x64\x72\145\163\163", "\x69\x6f\x6e\x5f\x61\165\164\x68")) { goto qqI1Q; } goto f_lnS; f_lnS: if (isset($ip_address)) { goto ragIL; } goto Dbj8B; VeaH8: ragIL: goto Sf8Lx; Dbj8B: $ip_address = $this->input->ip_address(); goto VeaH8; DFPOQ: return $this->db->delete($this->tables["\x6c\157\x67\151\x6e\137\x61\164\164\x65\155\x70\164\163"]); goto slcvY; Oqwdb: return FALSE; goto B081O; nlwmq: qqI1Q: goto Spu48; IOtWI: $this->db->where("\154\x6f\x67\151\x6e", $identity); goto dOrMZ; slcvY: o8cxv: goto Oqwdb; B081O: } public function limit($limit) { goto N80lF; nQwRg: return $this; goto YyYKB; E3Wpn: $this->_ion_limit = $limit; goto nQwRg; N80lF: $this->trigger_events("\x6c\x69\155\151\164"); goto E3Wpn; YyYKB: } public function offset($offset) { goto Ql7kz; Ql7kz: $this->trigger_events("\157\146\x66\x73\x65\x74"); goto KSsf4; KSsf4: $this->_ion_offset = $offset; goto QU3UQ; QU3UQ: return $this; goto h824I; h824I: } public function where($where, $value = NULL) { goto S9TLa; ZluEL: $where = [$where => $value]; goto Ho064; XgGab: return $this; goto IdSvt; K0315: array_push($this->_ion_where, $where); goto XgGab; S9TLa: $this->trigger_events("\x77\x68\x65\x72\x65"); goto Qm0qf; Qm0qf: if (is_array($where)) { goto xFhNk; } goto ZluEL; Ho064: xFhNk: goto K0315; IdSvt: } public function like($like, $value = NULL, $position = "\142\157\164\x68") { goto e8pG3; amfq0: array_push($this->_ion_like, ["\154\x69\153\x65" => $like, "\166\x61\154\165\x65" => $value, "\160\x6f\163\151\x74\151\x6f\156" => $position]); goto nbbVQ; nbbVQ: return $this; goto fYwHy; e8pG3: $this->trigger_events("\x6c\x69\153\145"); goto amfq0; fYwHy: } public function select($select) { goto qDpKM; lsFEe: $this->_ion_select[] = $select; goto nlByh; qDpKM: $this->trigger_events("\163\145\154\x65\x63\x74"); goto lsFEe; nlByh: return $this; goto MwXJL; MwXJL: } public function order_by($by, $order = "\144\145\163\143") { goto wtGmQ; wtGmQ: $this->trigger_events("\157\x72\x64\x65\x72\137\x62\171"); goto lEHlK; tvta7: return $this; goto C0enS; dO22Z: $this->_ion_order = $order; goto tvta7; lEHlK: $this->_ion_order_by = $by; goto dO22Z; C0enS: } public function row() { goto lgMY6; I7b6U: return $row; goto Wo285; lgMY6: $this->trigger_events("\162\x6f\167"); goto NS9Wd; NS9Wd: $row = $this->response->row(); goto I7b6U; Wo285: } public function row_array() { goto CP8Uz; UdiX_: $row = $this->response->row_array(); goto VE0CW; VE0CW: return $row; goto bpPTb; CP8Uz: $this->trigger_events(["\x72\157\x77", "\x72\157\167\x5f\x61\162\x72\x61\171"]); goto UdiX_; bpPTb: } public function result() { goto NBQ2P; tpxM8: return $result; goto rxo4e; QETUp: $result = $this->response->result(); goto tpxM8; NBQ2P: $this->trigger_events("\162\x65\163\165\x6c\164"); goto QETUp; rxo4e: } public function result_array() { goto pfKHd; KDgYt: return $result; goto Wl7DW; pfKHd: $this->trigger_events(["\162\145\163\165\154\x74", "\162\145\163\165\154\164\x5f\x61\x72\x72\141\x79"]); goto GQUb2; GQUb2: $result = $this->response->result_array(); goto KDgYt; Wl7DW: } public function num_rows() { goto LKV6X; YoA9c: $result = $this->response->num_rows(); goto ODjdK; LKV6X: $this->trigger_events(["\x6e\x75\x6d\137\162\157\x77\163"]); goto YoA9c; ODjdK: return $result; goto oUuFJ; oUuFJ: } public function users($groups = NULL) { goto kLVx6; YjPDT: YCNKM: goto YEQb6; FGsnk: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\137\167\x68\x65\162\x65\137\x69\156" : "\167\150\145\162\x65\137\x69\156"; goto tfE4x; CjmZM: eeOh3: goto abtO2; hltJB: $this->_ion_limit = NULL; goto Gs2US; hax8Z: $this->_ion_select = []; goto F6QU8; cOAEc: eSFWA: goto s09Bl; OAKNe: AwQrs: goto BgDJv; lw_If: hDl8u: goto Kjym7; fG4mz: $groups = [$groups]; goto ERd6N; nV8CC: if (is_array($groups)) { goto a7J9K; } goto fG4mz; mBRq5: if (!isset($groups)) { goto AwQrs; } goto nV8CC; YiLgy: if (!isset($this->_ion_limit)) { goto eeOh3; } goto QdTCi; SvgpZ: foreach ($this->_ion_where as $where) { $this->db->where($where); sBcvz: } goto YjPDT; shKHK: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto KELdO; } goto SvgpZ; HvLDL: $this->_ion_order_by = NULL; goto TwrbM; AX031: foreach ($groups as $group) { goto BSdQV; WnEHA: omyLh: goto kiHjm; oSiN9: $group_names[] = $group; goto btU__; cYR4F: c1pFH: goto PTLDy; BSdQV: if (is_numeric($group)) { goto omyLh; } goto oSiN9; YWI9S: HS05g: goto cYR4F; kiHjm: $group_ids[] = $group; goto YWI9S; btU__: goto HS05g; goto WnEHA; PTLDy: } goto M2Kle; XWXAc: O6aB3: goto hax8Z; Yyu1h: X00SB: goto qydnY; F6QU8: JAQRE: goto mBRq5; wHu8j: $group_names = []; goto AX031; s09Bl: if (empty($group_ids)) { goto z3WEy; } goto rfR8_; co9vn: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto SxwB1; } goto ABCd0; YEQb6: $this->_ion_where = []; goto o4S3l; tfE4x: if (empty($group_names)) { goto eSFWA; } goto zkimz; CiSOa: $this->_ion_limit = NULL; goto CjmZM; iDCF2: xruEY: goto EPldP; abtO2: goto Jenng; goto lw_If; Ds1kZ: foreach ($this->_ion_select as $select) { $this->db->select($select); IjS_3: } goto XWXAc; R6Ke3: $this->db->where_in($this->tables["\x67\x72\157\165\160\x73"] . "\x2e\x6e\141\155\145", $group_names); goto cOAEc; o4S3l: KELdO: goto Jv3bM; BgDJv: $this->trigger_events("\145\x78\164\x72\141\x5f\167\150\x65\162\x65"); goto shKHK; Zaq2a: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto Y3dxa; } goto YxH5T; EPldP: $group_ids = []; goto wHu8j; XADji: $this->db->distinct(); goto a3Hxe; ABCd0: $this->db->select([$this->tables["\x75\x73\x65\162\163"] . "\56\x2a", $this->tables["\x75\163\x65\162\x73"] . "\56\x69\x64\40\141\163\40\151\x64", $this->tables["\x75\163\145\x72\163"] . "\56\151\x64\x20\x61\163\x20\x75\163\145\162\x5f\x69\x64"]); goto EjAPd; Kjym7: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto hltJB; zkimz: $this->db->join($this->tables["\x67\x72\x6f\x75\160\163"], $this->tables["\x75\x73\145\162\163\137\x67\162\x6f\165\160\x73"] . "\56" . $this->join["\147\162\x6f\x75\x70\x73"] . "\x20\x3d\x20" . $this->tables["\147\162\x6f\x75\160\x73"] . "\x2e\x69\x64", "\151\156\156\145\x72"); goto R6Ke3; kLVx6: $this->trigger_events("\165\x73\145\x72\163"); goto co9vn; Tflbx: $this->_ion_like = []; goto Yyu1h; pOlE7: $this->_ion_order = NULL; goto HvLDL; a3Hxe: $this->db->join($this->tables["\x75\163\145\162\163\137\x67\162\157\x75\160\x73"], $this->tables["\165\x73\x65\162\163\137\147\x72\x6f\x75\160\163"] . "\56" . $this->join["\x75\x73\x65\162\163"] . "\x3d" . $this->tables["\165\x73\x65\162\x73"] . "\x2e\x69\x64", "\151\156\156\x65\162"); goto iDCF2; M2Kle: EUfji: goto FGsnk; Jv3bM: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto X00SB; } goto Bm0cN; zNSyv: u3KGL: goto Tflbx; XN1e0: return $this; goto Bnmbh; PzV15: z3WEy: goto OAKNe; Gs2US: $this->_ion_offset = NULL; goto TSRrD; TSRrD: Jenng: goto Zaq2a; YxH5T: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto pOlE7; rfR8_: $this->db->{$or_where_in}($this->tables["\x75\x73\145\x72\163\x5f\147\162\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\157\x75\x70\x73"], $group_ids); goto PzV15; qydnY: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto hDl8u; } goto YiLgy; hgyOn: if (!(isset($groups) && !empty($groups))) { goto xruEY; } goto XADji; EjAPd: goto JAQRE; goto sPiJo; ERd6N: a7J9K: goto hgyOn; nLR6M: $this->response = $this->db->get($this->tables["\x75\163\x65\162\163"]); goto XN1e0; QdTCi: $this->db->limit($this->_ion_limit); goto CiSOa; sPiJo: SxwB1: goto Ds1kZ; Bm0cN: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\x6b\x65"], $like["\166\141\x6c\x75\x65"], $like["\x70\157\163\x69\x74\x69\x6f\156"]); DXulp: } goto zNSyv; TwrbM: Y3dxa: goto nLR6M; Bnmbh: } public function user($id = NULL) { goto Spv5i; qAe10: $this->order_by($this->tables["\x75\x73\145\x72\x73"] . "\56\x69\144", "\144\x65\x73\x63"); goto s0SXp; b6SFb: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\145\x72\137\x69\x64"); goto UboiX; UboiX: $this->limit(1); goto qAe10; d_ITZ: return $this; goto dwgTZ; RF1ez: $this->users(); goto d_ITZ; Spv5i: $this->trigger_events("\165\163\x65\162"); goto b6SFb; s0SXp: $this->where($this->tables["\165\x73\x65\162\x73"] . "\56\151\x64", $id); goto RF1ez; dwgTZ: } public function get_users_groups($id = FALSE) { goto nrBL4; BZ9xh: return $this->db->select($this->tables["\x75\163\x65\x72\x73\x5f\147\162\157\165\x70\x73"] . "\x2e" . $this->join["\147\162\x6f\165\160\x73"] . "\40\141\163\x20\151\x64\54\40" . $this->tables["\147\162\157\x75\x70\163"] . "\x2e\x6e\141\x6d\145\54\40" . $this->tables["\147\x72\x6f\165\x70\x73"] . "\x2e\144\145\x73\143\x72\151\160\x74\151\157\x6e")->where($this->tables["\165\x73\x65\162\163\137\x67\162\157\x75\160\x73"] . "\x2e" . $this->join["\x75\x73\145\162\163"], $id)->join($this->tables["\147\162\x6f\x75\x70\163"], $this->tables["\x75\x73\145\162\x73\x5f\147\x72\x6f\165\160\x73"] . "\56" . $this->join["\x67\162\157\x75\x70\163"] . "\x3d" . $this->tables["\x67\162\157\x75\160\x73"] . "\56\151\144")->get($this->tables["\165\163\x65\x72\163\137\x67\x72\x6f\x75\160\x73"]); goto CZhrY; m9bTZ: $id || ($id = $this->session->userdata("\165\x73\145\162\x5f\x69\x64")); goto BZ9xh; nrBL4: $this->trigger_events("\147\145\x74\x5f\x75\163\145\162\x73\x5f\x67\x72\157\165\160"); goto m9bTZ; CZhrY: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto QClKq; vMZAU: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; e5X7f: } goto eknSp; azQr4: $this->_cache_user_in_group[$id] = $groups_array; goto uFa8r; lIFh2: ItVEA: goto E8nlI; BeLnV: $groups_array = []; goto vMZAU; Ekivr: if (is_array($check_group)) { goto ItVEA; } goto pz3re; pz3re: $check_group = [$check_group]; goto lIFh2; cBNUL: $groups_array = $this->_cache_user_in_group[$id]; goto q0e0F; x6vwC: $id || ($id = $this->session->userdata("\x75\163\x65\x72\137\151\x64")); goto Ekivr; IgXjb: v0FDP: goto LPJae; QClKq: $this->trigger_events("\151\x6e\x5f\147\x72\157\165\x70"); goto x6vwC; E8nlI: if (isset($this->_cache_user_in_group[$id])) { goto O68mc; } goto DlccX; Xgslz: O68mc: goto cBNUL; uFa8r: goto HckDG; goto Xgslz; eknSp: HFCuk: goto azQr4; LPJae: return $check_all; goto eUkN5; DlccX: $users_groups = $this->get_users_groups($id)->result(); goto BeLnV; mYlAl: foreach ($check_group as $key => $value) { goto gcBU1; zUtTQ: if (!(in_array($value, $groups) xor $check_all)) { goto xudye; } goto KJjlo; X_aiH: xudye: goto tqiWp; tqiWp: YFHxg: goto pE4aW; KJjlo: return !$check_all; goto X_aiH; gcBU1: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto zUtTQ; pE4aW: } goto IgXjb; q0e0F: HckDG: goto mYlAl; eUkN5: } public function add_to_group($group_ids, $user_id = FALSE) { goto k1m_o; v24KG: return $return; goto ltsv7; uWLjC: $return = 0; goto nbdeu; k1m_o: $this->trigger_events("\x61\144\x64\137\x74\x6f\x5f\147\x72\x6f\165\160"); goto qK9aQ; qK9aQ: $user_id || ($user_id = $this->session->userdata("\165\x73\145\x72\137\151\x64")); goto YHdTg; zwZml: $group_ids = [$group_ids]; goto kSUeI; nbdeu: foreach ($group_ids as $group_id) { goto up1Qr; LAVYn: $group = $this->group($group_id)->result(); goto DTFeB; EDe4i: goto ZtFgh; goto B8vA8; oibH8: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto k7g2n; Y3u06: if (isset($this->_cache_groups[$group_id])) { goto YKP82; } goto LAVYn; y5x8X: $this->_cache_groups[$group_id] = $group_name; goto EDe4i; k7g2n: $return++; goto wksw5; LF5sd: xeVf9: goto jW4BT; B8vA8: YKP82: goto zIyOV; DTFeB: $group_name = $group[0]->name; goto y5x8X; up1Qr: if (!$this->db->insert($this->tables["\x75\x73\x65\x72\163\137\x67\162\157\165\160\x73"], [$this->join["\x67\162\x6f\x75\x70\x73"] => (float) $group_id, $this->join["\x75\163\x65\x72\163"] => (float) $user_id])) { goto PSk2N; } goto Y3u06; zIyOV: $group_name = $this->_cache_groups[$group_id]; goto Z6lxq; Z6lxq: ZtFgh: goto oibH8; wksw5: PSk2N: goto LF5sd; jW4BT: } goto bYiTF; kSUeI: qNPAB: goto uWLjC; bYiTF: Q4aCU: goto v24KG; YHdTg: if (is_array($group_ids)) { goto qNPAB; } goto zwZml; ltsv7: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto x5HVA; xL8j9: qHtIT: goto TNU3Y; yxExH: K06zH: goto uumt9; f7hBA: KNZ5l: goto u1xW1; sMsJM: if (!empty($user_id)) { goto KNZ5l; } goto AsD_X; u1xW1: if (!empty($group_ids)) { goto K06zH; } goto VTVr3; W0yKW: ddClU: goto HZcPl; WjIHI: goto qHtIT; goto yxExH; ZtSZv: joYmf: goto WjIHI; TNU3Y: return $return; goto aMhFA; uumt9: if (is_array($group_ids)) { goto ddClU; } goto rVcjz; fZNfg: $return = TRUE; goto xL8j9; HZcPl: foreach ($group_ids as $group_id) { goto pzxDM; pzxDM: $this->db->delete($this->tables["\x75\163\x65\162\163\x5f\x67\x72\157\x75\160\163"], [$this->join["\147\x72\157\165\160\163"] => (float) $group_id, $this->join["\x75\x73\x65\162\x73"] => (float) $user_id]); goto ZpOwE; L5ODD: wVcXo: goto rU50t; lMOOt: unset($this->_cache_user_in_group[$user_id][$group_id]); goto pzd8C; ZpOwE: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto B6uZ2; } goto lMOOt; pzd8C: B6uZ2: goto L5ODD; rU50t: } goto ZyvKE; x5HVA: $this->trigger_events("\162\x65\155\157\166\145\137\146\162\157\155\x5f\x67\162\x6f\165\x70"); goto sMsJM; AsD_X: return FALSE; goto f7hBA; n2SRE: $this->_cache_user_in_group[$user_id] = []; goto ZtSZv; VTVr3: if (!($return = $this->db->delete($this->tables["\165\x73\x65\x72\163\x5f\x67\162\157\x75\160\163"], [$this->join["\x75\x73\145\162\163"] => (float) $user_id]))) { goto joYmf; } goto n2SRE; ZyvKE: y422Z: goto fZNfg; rVcjz: $group_ids = [$group_ids]; goto W0yKW; aMhFA: } public function groups() { goto gmZhN; NISf2: $this->_ion_limit = NULL; goto iNtZO; oR60f: Pz5Nd: goto c9mpG; ig7SE: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto NISf2; K7SyC: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto EQuG3; } goto deCVU; Zdbbc: goto Lc3_E; goto i7RJ2; QbGSe: if (!isset($this->_ion_limit)) { goto lf_oo; } goto zzCcV; c9mpG: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto H_Q3A; } goto QbGSe; Dh00_: $this->_ion_limit = NULL; goto BdjuX; zzCcV: $this->db->limit($this->_ion_limit); goto Dh00_; iNtZO: $this->_ion_offset = NULL; goto evnMF; tDUII: foreach ($this->_ion_where as $where) { $this->db->where($where); N68I9: } goto FiauR; gmZhN: $this->trigger_events("\147\162\x6f\165\160\x73"); goto fW_Et; BdjuX: lf_oo: goto Zdbbc; i7RJ2: H_Q3A: goto ig7SE; fW_Et: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto Pz5Nd; } goto tDUII; FiauR: QYkQz: goto n2WHT; evnMF: Lc3_E: goto K7SyC; deCVU: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto fjAJF; gteAd: $this->response = $this->db->get($this->tables["\147\x72\157\165\x70\163"]); goto OHQ5J; fjAJF: EQuG3: goto gteAd; OHQ5J: return $this; goto TF7wv; n2WHT: $this->_ion_where = []; goto oR60f; TF7wv: } public function group($id = NULL) { goto Ayhh5; xLiR7: $this->where($this->tables["\x67\162\x6f\165\x70\163"] . "\x2e\151\144", $id); goto nbrab; VIKrE: $this->limit(1); goto zeZ72; nbrab: QgInV: goto VIKrE; Ayhh5: $this->trigger_events("\147\162\x6f\x75\160"); goto NZes0; qcjKs: return $this->groups(); goto tvJpG; zeZ72: $this->order_by("\x69\144", "\x64\145\163\x63"); goto qcjKs; NZes0: if (!isset($id)) { goto QgInV; } goto xLiR7; tvJpG: } public function update($id, array $data) { goto hGbuA; zeWMR: $this->db->update($this->tables["\x75\163\145\162\163"], $data, ["\x69\x64" => $user->id]); goto rnb5t; zGmiG: mV5Hf: goto coIhn; Xas3a: return FALSE; goto zGmiG; a02Q8: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\163\163\167\157\x72\144", $data) || array_key_exists("\x65\155\x61\x69\154", $data))) { goto MF8sJ; } goto vNT0y; A0PHa: return FALSE; goto dXCVI; swJ1C: if (!empty($data["\160\x61\163\163\167\157\x72\x64"])) { goto OBXEM; } goto kMiz2; hGbuA: $this->trigger_events("\x70\162\145\137\x75\160\144\x61\x74\x65\x5f\165\163\x65\x72"); goto sEZ36; nQ2Qo: return TRUE; goto A0FQt; dXCVI: ZIdGZ: goto eiyNz; xwi0k: $this->db->trans_begin(); goto BH44i; fSSCa: $this->db->trans_rollback(); goto OhQOn; jyjvT: $data["\160\x61\x73\x73\167\157\x72\x64"] = $this->hash_password($data["\x70\141\163\163\x77\x6f\162\x64"], $user->{$this->identity_column}); goto PlufO; OhQOn: $this->trigger_events(["\160\157\x73\x74\x5f\x75\x70\x64\141\x74\x65\x5f\165\x73\145\x72", "\x70\157\x73\x74\x5f\x75\x70\144\x61\x74\x65\137\165\163\145\162\137\x75\x6e\x73\x75\143\x63\x65\163\163\146\165\154"]); goto QSXxe; GD7jT: return FALSE; goto sguoH; vrSSY: $this->set_error("\x75\160\x64\141\x74\x65\137\165\x6e\163\x75\143\143\145\163\163\x66\165\x6c"); goto Xas3a; wvmJg: $this->set_error("\165\x70\x64\x61\164\x65\x5f\x75\156\163\x75\x63\x63\x65\163\163\146\x75\x6c"); goto GD7jT; BH44i: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto mV5Hf; } goto UItCb; O7btx: W8HGY: goto Axckz; vNT0y: if (!array_key_exists("\160\141\x73\x73\167\157\162\144", $data)) { goto W8HGY; } goto swJ1C; UItCb: $this->db->trans_rollback(); goto ZzwdV; XRCcS: OBXEM: goto jyjvT; PlufO: if (!($data["\160\141\163\x73\x77\157\162\x64"] === FALSE)) { goto ZIdGZ; } goto fSSCa; eiyNz: mr5mf: goto O7btx; yaMfE: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x75\x70\144\141\164\145\137\x75\163\x65\x72", "\x70\157\x73\164\x5f\165\x70\144\141\x74\x65\137\x75\x73\145\162\x5f\x75\156\163\165\143\x63\x65\163\163\x66\x75\x6c"]); goto vrSSY; QSXxe: $this->set_error("\x75\x70\144\x61\x74\145\137\x75\156\163\165\x63\x63\145\x73\x73\146\165\x6c"); goto A0PHa; sjsLF: $this->trigger_events(["\x70\x6f\163\164\x5f\165\160\144\x61\x74\145\x5f\165\x73\x65\x72", "\x70\x6f\163\x74\x5f\165\160\x64\x61\164\145\137\165\163\x65\162\x5f\x75\156\163\x75\x63\143\145\163\x73\146\x75\x6c"]); goto wvmJg; mx5og: $this->db->trans_commit(); goto mP0kg; sguoH: rfH6a: goto mx5og; coIhn: $data = $this->_filter_data($this->tables["\x75\163\x65\x72\163"], $data); goto a02Q8; Axckz: MF8sJ: goto ZcI6y; ZcI6y: $this->trigger_events("\145\170\164\x72\x61\137\167\x68\145\x72\x65"); goto zeWMR; kMiz2: unset($data["\x70\x61\x73\163\167\x6f\162\144"]); goto P4nss; sEZ36: $user = $this->user($id)->row(); goto xwi0k; Tkk9Q: $this->set_message("\x75\160\x64\x61\164\145\137\163\165\x63\x63\x65\163\x73\x66\165\x6c"); goto nQ2Qo; ZzwdV: $this->set_error("\141\x63\x63\157\165\x6e\164\137\x63\x72\145\x61\164\151\x6f\156\x5f\x64\x75\x70\154\x69\143\141\x74\x65\x5f\x69\144\x65\156\x74\x69\164\x79"); goto yaMfE; DoGf8: $this->db->trans_rollback(); goto sjsLF; P4nss: goto mr5mf; goto XRCcS; mP0kg: $this->trigger_events(["\160\157\163\164\x5f\x75\x70\144\141\x74\145\x5f\x75\x73\145\x72", "\160\x6f\163\164\137\x75\160\x64\x61\164\x65\x5f\x75\163\x65\x72\x5f\163\165\143\143\x65\163\x73\x66\x75\x6c"]); goto Tkk9Q; rnb5t: if (!($this->db->trans_status() === FALSE)) { goto rfH6a; } goto DoGf8; A0FQt: } public function delete_user($id) { goto AWV9e; KUc25: if (!($this->db->trans_status() === FALSE)) { goto YNJd5; } goto r1nQ8; nBqJn: $this->set_message("\x64\x65\154\145\x74\145\137\x73\165\143\x63\145\163\x73\146\165\x6c"); goto eB4Sk; AHglV: $this->remove_from_group(NULL, $id); goto GZsvm; G19te: $this->trigger_events(["\x70\157\163\x74\x5f\x64\145\154\145\164\x65\x5f\165\x73\x65\x72", "\160\x6f\163\x74\137\x64\145\x6c\145\x74\145\x5f\x75\163\145\162\x5f\165\x6e\163\165\x63\143\145\x73\163\x66\x75\154"]); goto b7n2I; r1nQ8: $this->db->trans_rollback(); goto G19te; eB4Sk: return TRUE; goto ApQHC; KbqFB: $this->trigger_events(["\x70\x6f\163\x74\x5f\144\145\154\145\x74\145\x5f\165\163\145\162", "\x70\x6f\163\164\137\x64\145\154\145\x74\x65\137\x75\163\x65\x72\137\163\x75\x63\143\x65\163\x73\146\165\154"]); goto nBqJn; Gsc7B: $this->db->trans_begin(); goto AHglV; F_dit: YNJd5: goto XdFas; b7n2I: $this->set_error("\x64\145\154\145\164\x65\137\165\x6e\163\x75\x63\x63\145\163\x73\146\x75\154"); goto FC9g5; XdFas: $this->db->trans_commit(); goto KbqFB; AWV9e: $this->trigger_events("\160\x72\x65\x5f\144\x65\154\x65\164\145\137\x75\163\x65\x72"); goto Gsc7B; FC9g5: return FALSE; goto F_dit; GZsvm: $this->db->delete($this->tables["\x75\163\x65\162\163"], ["\151\x64" => $id]); goto KUc25; ApQHC: } public function update_last_login($id) { goto nG6gM; Genvf: $this->load->helper("\x64\x61\x74\145"); goto jABSR; qIvYx: return $this->db->affected_rows() == 1; goto e5d72; nG6gM: $this->trigger_events("\165\160\x64\141\x74\x65\x5f\154\141\163\164\137\154\x6f\147\x69\x6e"); goto Genvf; HBMo0: $this->db->update($this->tables["\165\x73\145\x72\x73"], ["\x6c\141\163\164\x5f\154\x6f\x67\x69\156" => time()], ["\x69\x64" => $id]); goto qIvYx; jABSR: $this->trigger_events("\145\x78\164\x72\x61\x5f\167\150\145\162\x65"); goto HBMo0; e5d72: } public function set_lang($lang = "\x65\156") { goto YdUfw; XJ2dC: return TRUE; goto zwzv9; SHfzC: set_cookie(["\156\141\x6d\145" => "\154\x61\x6e\x67\137\x63\x6f\144\145", "\166\141\x6c\165\145" => $lang, "\x65\x78\160\151\162\x65" => $expire]); goto XJ2dC; dN3yy: goto jfOgX; goto DWxLj; DWxLj: hxVnR: goto X1Ct1; s5zU9: jfOgX: goto SHfzC; d_7VH: $expire = $this->config->item("\165\163\145\x72\x5f\x65\x78\x70\151\162\145", "\x69\157\x6e\x5f\x61\x75\x74\150"); goto dN3yy; n54X4: if ($this->config->item("\165\x73\145\x72\137\x65\x78\x70\x69\162\145", "\151\x6f\156\x5f\x61\x75\x74\150") === 0) { goto hxVnR; } goto d_7VH; X1Ct1: $expire = self::MAX_COOKIE_LIFETIME; goto s5zU9; YdUfw: $this->trigger_events("\163\x65\164\137\154\141\156\147"); goto n54X4; zwzv9: } public function set_session($user) { goto jIbnM; gxqBb: $session_data = ["\x69\144\145\156\x74\x69\164\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\x61\151\x6c" => $user->email, "\165\163\x65\162\x5f\x69\x64" => $user->id, "\157\154\x64\x5f\154\x61\163\164\137\x6c\157\x67\x69\156" => $user->last_login, "\154\x61\x73\164\137\x63\150\145\143\x6b" => time()]; goto fT6pu; fT6pu: $this->session->set_userdata($session_data); goto Oiyjp; fQ5M0: return TRUE; goto Gb4DK; Oiyjp: $this->trigger_events("\160\x6f\163\x74\x5f\163\145\164\137\x73\145\x73\163\151\157\156"); goto fQ5M0; jIbnM: $this->trigger_events("\x70\x72\145\137\163\145\164\x5f\x73\145\163\163\x69\x6f\x6e"); goto gxqBb; Gb4DK: } public function remember_user($identity) { goto IECax; i8yzE: if (!$token->validator_hashed) { goto l_e_3; } goto FR6a4; enM51: bph5m: goto yR4V2; WPlnX: $expire = $this->config->item("\165\x73\145\162\x5f\145\x78\x70\x69\162\145", "\151\157\156\x5f\141\165\164\x68"); goto sPrz9; CygFD: if (!($this->db->affected_rows() > -1)) { goto MYOnP; } goto NY7Sc; T0Hee: MYOnP: goto PkokO; sPrz9: goto bph5m; goto OYrLh; PkokO: l_e_3: goto P1rth; GA8Zz: return FALSE; goto pjOm7; KpAoO: $token = $this->_generate_selector_validator_couple(); goto i8yzE; FR6a4: $this->db->update($this->tables["\x75\x73\145\x72\x73"], ["\x72\145\155\x65\x6d\x62\x65\162\137\163\145\154\145\x63\x74\x6f\x72" => $token->selector, "\x72\145\x6d\x65\155\x62\x65\x72\137\x63\157\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto CygFD; NY7Sc: if ($this->config->item("\x75\163\x65\x72\137\145\x78\x70\151\x72\145", "\151\x6f\x6e\137\141\165\164\150") === 0) { goto fxVFS; } goto WPlnX; m2UBz: if ($identity) { goto K3njg; } goto ILJRY; gYNUA: $this->trigger_events(["\x70\x6f\x73\164\x5f\x72\145\x6d\145\x6d\142\145\162\137\165\163\145\162", "\162\145\155\145\x6d\142\145\x72\137\x75\163\145\x72\137\x73\x75\143\143\x65\x73\x73\146\165\x6c"]); goto y1DCT; IECax: $this->trigger_events("\x70\x72\145\x5f\162\145\155\x65\x6d\x62\x65\x72\137\165\163\x65\x72"); goto m2UBz; RpeaQ: K3njg: goto KpAoO; yR4V2: set_cookie(["\156\x61\x6d\145" => $this->config->item("\x72\145\x6d\x65\x6d\142\x65\x72\137\143\x6f\x6f\x6b\151\145\137\x6e\141\x6d\x65", "\151\157\156\x5f\141\x75\x74\150"), "\x76\x61\154\165\x65" => $token->user_code, "\145\x78\160\151\162\x65" => $expire]); goto gYNUA; P1rth: $this->trigger_events(["\x70\x6f\x73\164\137\x72\145\x6d\145\x6d\x62\145\x72\x5f\x75\x73\145\x72", "\x72\145\x6d\145\x6d\142\x65\x72\x5f\165\163\145\162\137\x75\x6e\163\165\143\143\x65\163\163\146\x75\154"]); goto GA8Zz; OYrLh: fxVFS: goto YQIpC; y1DCT: return TRUE; goto T0Hee; YQIpC: $expire = self::MAX_COOKIE_LIFETIME; goto enM51; ILJRY: return FALSE; goto RpeaQ; pjOm7: } public function login_remembered_user() { goto bm2a6; yq2bG: if (!($query->num_rows() === 1)) { goto ZQ3GE; } goto rJwNm; iIjjt: delete_cookie($this->config->item("\x72\145\155\145\x6d\142\145\x72\x5f\143\x6f\157\153\151\x65\x5f\x6e\x61\155\145", "\151\x6f\x6e\x5f\x61\x75\x74\x68")); goto qnCr1; yNI0N: ZQ3GE: goto iIjjt; Crc1U: return FALSE; goto WuMVh; WuMVh: lTjjJ: goto oYekU; oYekU: $this->trigger_events("\145\x78\x74\x72\141\137\167\150\x65\162\145"); goto V1XmH; BHAJo: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto SoziG; } goto va3Pm; rJwNm: $user = $query->row(); goto f_SAW; aVVKR: $this->session->sess_regenerate(FALSE); goto aAGif; qnCr1: $this->trigger_events(["\x70\157\x73\164\x5f\154\x6f\147\x69\156\x5f\x72\145\155\145\155\x62\x65\x72\145\144\137\165\163\145\162", "\x70\x6f\x73\164\137\154\157\x67\151\156\x5f\162\145\155\x65\x6d\x62\x65\162\145\x64\x5f\165\x73\145\162\x5f\165\156\x73\x75\x63\x63\x65\163\x73\146\165\154"]); goto JMufp; bb6RD: $remember_cookie = get_cookie($this->config->item("\162\145\155\145\x6d\x62\x65\x72\x5f\143\157\157\x6b\151\x65\x5f\x6e\x61\x6d\145", "\151\157\x6e\x5f\x61\165\164\150")); goto oHFRK; va3Pm: $this->update_last_login($user->id); goto ukudN; OS03W: SoziG: goto yNI0N; SyZ5E: $this->trigger_events(["\160\157\x73\164\137\154\x6f\x67\151\156\x5f\x72\145\155\x65\x6d\x62\x65\x72\x65\x64\x5f\x75\163\145\x72", "\160\157\163\164\137\x6c\x6f\147\151\156\137\162\145\x6d\x65\x6d\142\x65\x72\145\x64\137\165\x73\x65\162\x5f\165\156\163\165\143\x63\145\163\163\x66\x75\x6c"]); goto Crc1U; f_SAW: $identity = $user->{$this->identity_column}; goto BHAJo; DzSo5: if (!($token === FALSE)) { goto lTjjJ; } goto SyZ5E; oTyZR: hqFH7: goto aVVKR; uHj6X: return TRUE; goto OS03W; bm2a6: $this->trigger_events("\x70\x72\x65\x5f\x6c\x6f\x67\x69\x6e\x5f\x72\145\155\x65\155\142\145\162\145\x64\137\x75\163\x65\x72"); goto bb6RD; aAGif: $this->trigger_events(["\x70\157\163\164\x5f\154\x6f\147\151\x6e\137\x72\145\155\x65\x6d\142\145\x72\x65\x64\x5f\165\163\x65\x72", "\160\x6f\163\164\x5f\x6c\157\147\x69\x6e\x5f\162\x65\x6d\145\x6d\x62\x65\162\x65\x64\x5f\x75\x73\145\162\137\163\x75\x63\x63\145\x73\163\146\x75\x6c"]); goto uHj6X; V1XmH: $query = $this->db->select($this->identity_column . "\54\x20\151\144\54\40\x65\155\141\151\x6c\x2c\40\162\145\155\x65\x6d\x62\145\x72\x5f\143\x6f\144\x65\x2c\x20\x6c\141\x73\x74\137\x6c\157\147\151\156")->where("\x72\145\x6d\x65\155\x62\x65\x72\x5f\163\x65\154\x65\143\164\x6f\x72", $token->selector)->where("\141\143\164\151\x76\x65", 1)->limit(1)->get($this->tables["\x75\x73\145\162\x73"]); goto yq2bG; oerBZ: $this->clear_forgotten_password_code($identity); goto vuOBu; vuOBu: if (!$this->config->item("\x75\163\145\162\x5f\x65\170\x74\145\156\144\x5f\x6f\x6e\x5f\154\157\x67\x69\x6e", "\151\157\x6e\x5f\x61\x75\x74\150")) { goto hqFH7; } goto ADuzr; JMufp: return FALSE; goto kvsak; ukudN: $this->set_session($user); goto oerBZ; oHFRK: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto DzSo5; ADuzr: $this->remember_user($identity); goto oTyZR; kvsak: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto Aq4Jj; WQkmJ: KnHiZ: goto Nd1NB; Aq4Jj: if ($group_name) { goto ElGzy; } goto VUU3C; nPSp3: $this->trigger_events("\145\x78\x74\x72\x61\x5f\x67\x72\x6f\165\160\x5f\x73\x65\x74"); goto r6qRk; z9qgK: if (!($existing_group !== 0)) { goto KnHiZ; } goto Lso0F; Ol81N: $this->set_message("\147\162\x6f\x75\160\137\143\x72\145\141\x74\151\x6f\156\x5f\x73\165\x63\143\x65\x73\163\x66\x75\x6c"); goto czqZ0; pEbE3: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\160\163"], $additional_data), $data); goto Wkgr3; Nd1NB: $data = ["\156\141\155\x65" => $group_name, "\x64\145\x73\143\x72\151\160\x74\151\157\156" => $group_description]; goto TAY_0; r6qRk: $this->db->insert($this->tables["\x67\x72\157\165\160\163"], $data); goto c_oz1; TAY_0: if (empty($additional_data)) { goto P1kmH; } goto pEbE3; Wkgr3: P1kmH: goto nPSp3; ouFmb: ElGzy: goto skjJx; VUU3C: $this->set_error("\x67\162\x6f\165\160\137\156\x61\x6d\145\137\x72\x65\161\165\x69\x72\x65\x64"); goto gkcyK; czqZ0: return $group_id; goto w48hG; skjJx: $existing_group = $this->db->get_where($this->tables["\x67\162\157\x75\160\x73"], ["\x6e\141\155\145" => $group_name])->num_rows(); goto z9qgK; gkcyK: return FALSE; goto ouFmb; Lso0F: $this->set_error("\x67\162\157\165\160\x5f\x61\154\x72\145\141\x64\x79\137\x65\170\151\x73\x74\163"); goto ZhT_Z; ZhT_Z: return FALSE; goto WQkmJ; c_oz1: $group_id = $this->db->insert_id($this->tables["\x67\x72\157\x75\160\163"] . "\x5f\151\x64\x5f\x73\145\161"); goto Ol81N; w48hG: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto TLREy; gjCdC: return TRUE; goto yqEFH; wJB1C: $data = array_merge($this->_filter_data($this->tables["\147\x72\157\x75\160\163"], $additional_data), $data); goto czWBA; TLREy: if (!empty($group_id)) { goto kZfL6; } goto yeaxW; hF2rE: $group = $this->db->get_where($this->tables["\x67\162\157\165\160\x73"], ["\x69\x64" => $group_id])->row(); goto pzGzP; gL5wQ: $data["\x6e\141\x6d\145"] = $group_name; goto R1Ptn; vz2G6: $data = []; goto Q3Xno; kNdUl: if (empty($additional_data)) { goto XdCds; } goto wJB1C; E4b7t: kZfL6: goto vz2G6; Q3Xno: if (empty($group_name)) { goto v0Ar7; } goto Jotjs; WtZfM: return FALSE; goto pRKbM; elQ0i: return FALSE; goto dHp7V; pzGzP: if (!($this->config->item("\141\144\155\x69\156\x5f\x67\162\157\x75\x70", "\151\x6f\156\x5f\141\165\164\x68") === $group->name && $group_name !== $group->name)) { goto MVpOU; } goto hQv1t; czWBA: XdCds: goto eIx0w; pRKbM: ULz9P: goto gL5wQ; vbD38: $this->set_error("\147\162\157\165\160\137\x61\x6c\162\145\x61\x64\x79\137\x65\170\x69\163\x74\x73"); goto WtZfM; mXhFI: $this->set_message("\147\162\157\x75\160\137\165\160\x64\x61\164\145\x5f\163\165\143\143\145\163\163\146\x75\x6c"); goto gjCdC; hQv1t: $this->set_error("\147\x72\157\x75\160\137\156\x61\x6d\x65\137\x61\144\x6d\151\x6e\137\x6e\157\x74\137\x61\x6c\164\x65\x72"); goto elQ0i; yeaxW: return FALSE; goto E4b7t; Jotjs: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\165\x70\163"], ["\156\141\155\x65" => $group_name])->row(); goto ebcDr; eIx0w: $this->db->update($this->tables["\147\162\157\x75\x70\163"], $data, ["\x69\144" => $group_id]); goto mXhFI; R1Ptn: v0Ar7: goto hF2rE; dHp7V: MVpOU: goto kNdUl; ebcDr: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto ULz9P; } goto vbD38; yqEFH: } public function delete_group($group_id = FALSE) { goto N_mps; MJuT5: $this->set_error("\x67\x72\x6f\x75\160\x5f\144\x65\x6c\145\x74\x65\x5f\165\x6e\x73\x75\x63\143\145\163\x73\x66\165\154"); goto dF_IR; tHsAy: if (!($group->name == $this->config->item("\141\x64\155\151\x6e\x5f\x67\x72\x6f\x75\x70", "\x69\157\x6e\137\141\165\x74\150"))) { goto r9zEa; } goto Kw9PB; AbjTh: $this->db->trans_begin(); goto Mc72y; qS0UU: return FALSE; goto nGwpz; KjeLR: return FALSE; goto x4QOB; KBe7c: TcZj1: goto D5FXC; D5FXC: $this->db->trans_commit(); goto Bc0cy; NZZtR: $this->set_message("\147\x72\157\x75\x70\137\x64\145\x6c\145\164\145\x5f\x73\165\143\143\x65\x73\163\146\165\154"); goto GOuso; dF_IR: return FALSE; goto KBe7c; fzt8K: $this->trigger_events(["\x70\157\163\x74\x5f\144\x65\154\145\x74\145\x5f\x67\162\157\165\160", "\160\x6f\163\164\x5f\144\x65\x6c\145\164\145\x5f\x67\162\157\165\x70\x5f\165\x6e\x73\165\x63\x63\x65\163\163\x66\x75\x6c"]); goto MJuT5; GwTgm: $this->set_error("\x67\x72\x6f\165\160\x5f\x64\145\x6c\x65\164\145\137\156\x6f\164\141\x6c\154\157\167\x65\144"); goto qS0UU; Bc0cy: $this->trigger_events(["\x70\157\x73\x74\137\144\145\154\145\x74\x65\x5f\147\x72\157\x75\160", "\x70\157\x73\164\137\144\x65\x6c\x65\x74\145\x5f\x67\162\x6f\x75\x70\137\x73\165\x63\x63\x65\x73\163\x66\x75\x6c"]); goto NZZtR; N_mps: if (!(!$group_id || empty($group_id))) { goto Wi5vI; } goto KjeLR; iYwkD: $this->db->trans_rollback(); goto fzt8K; Mc72y: $this->db->delete($this->tables["\165\163\x65\162\x73\137\x67\x72\x6f\165\x70\x73"], [$this->join["\x67\162\x6f\165\x70\x73"] => $group_id]); goto vMsX3; nGwpz: r9zEa: goto kln_L; kln_L: $this->trigger_events("\x70\x72\x65\x5f\x64\x65\154\145\x74\x65\x5f\147\162\x6f\x75\x70"); goto AbjTh; x4QOB: Wi5vI: goto KNpvv; GOuso: return TRUE; goto ofufL; Ld3Gm: if (!($this->db->trans_status() === FALSE)) { goto TcZj1; } goto iYwkD; vMsX3: $this->db->delete($this->tables["\147\162\x6f\x75\x70\x73"], ["\x69\144" => $group_id]); goto Ld3Gm; KNpvv: $group = $this->group($group_id)->row(); goto tHsAy; Kw9PB: $this->trigger_events(["\x70\157\163\164\137\x64\x65\x6c\145\164\145\x5f\147\x72\157\x75\160", "\160\x6f\163\164\x5f\x64\145\154\145\164\x65\x5f\147\162\157\165\160\137\156\157\164\141\154\154\157\167\145\x64"]); goto GwTgm; ofufL: } public function set_hook($event, $name, $class, $method, $arguments) { goto CFBO0; l6L6P: $this->_ion_hooks->{$event}[$name]->method = $method; goto rXy2z; CFBO0: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto xqdmC; xqdmC: $this->_ion_hooks->{$event}[$name]->class = $class; goto l6L6P; rXy2z: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto VRPzt; VRPzt: } public function remove_hook($event, $name) { goto iggRs; iggRs: if (!isset($this->_ion_hooks->{$event}[$name])) { goto M30Sb; } goto I_5eK; ZwO82: M30Sb: goto T7dVl; I_5eK: unset($this->_ion_hooks->{$event}[$name]); goto ZwO82; T7dVl: } public function remove_hooks($event) { goto liFOE; TEyxx: ejKz_: goto rXbS4; t2cX3: unset($this->_ion_hooks->{$event}); goto TEyxx; liFOE: if (!isset($this->_ion_hooks->{$event})) { goto ejKz_; } goto t2cX3; rXbS4: } protected function _call_hook($event, $name) { goto GDFy3; tTx0W: RF5Fo: goto nTP0_; GDFy3: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto RF5Fo; } goto xI98a; nTP0_: return FALSE; goto gaZzT; xI98a: $hook = $this->_ion_hooks->{$event}[$name]; goto vw8vA; vw8vA: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto tTx0W; gaZzT: } public function trigger_events($events) { goto c0zpS; zSkvG: goto SD1nL; goto M8qxB; NU1c3: SD1nL: goto RvsY5; G6gDb: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto ooElV; } goto wTFB8; MZvNY: ZdI3O: goto NU1c3; wTFB8: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); gsUP5: } goto F9qRI; nD72W: foreach ($events as $event) { $this->trigger_events($event); dhvML: } goto MZvNY; F9qRI: fsFLN: goto Z_Uf2; M8qxB: CYDv6: goto nD72W; c0zpS: if (is_array($events) && !empty($events)) { goto CYDv6; } goto G6gDb; Z_Uf2: ooElV: goto zSkvG; RvsY5: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto Lvuj5; bDt18: $this->message_end_delimiter = $end_delimiter; goto FF3vq; FF3vq: return TRUE; goto kt73K; Lvuj5: $this->message_start_delimiter = $start_delimiter; goto bDt18; kt73K: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto l4Pmt; evbgG: $this->error_end_delimiter = $end_delimiter; goto zca2c; zca2c: return TRUE; goto Q5_Zj; l4Pmt: $this->error_start_delimiter = $start_delimiter; goto evbgG; Q5_Zj: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto z1JGJ; inqB2: foreach ($this->messages as $message) { goto PBd63; PBd63: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\43\x23"; goto Bs1C2; Bs1C2: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto nD1Pl; nD1Pl: ar6UY: goto Ogpop; Ogpop: } goto H3br7; z1JGJ: $_output = ''; goto inqB2; kknx4: return $_output; goto LMdEP; H3br7: cxkGB: goto kknx4; LMdEP: } public function messages_array($langify = TRUE) { goto fTWgi; QSikX: $_output = []; goto Vapmy; qsZPX: FyhUw: goto ZDtQY; RW9T9: return $this->messages; goto G1NvL; Vapmy: foreach ($this->messages as $message) { goto hJCfu; ehCqj: E_HTD: goto XuSsc; VO9I4: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto ehCqj; hJCfu: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\43"; goto VO9I4; XuSsc: } goto TP_A0; G1NvL: goto FyhUw; goto Hq36e; fTWgi: if ($langify) { goto IITVH; } goto RW9T9; TP_A0: Yj21B: goto AW8aO; Hq36e: IITVH: goto QSikX; AW8aO: return $_output; goto qsZPX; ZDtQY: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto yfT0u; a9ub1: foreach ($this->errors as $error) { goto lv71T; JIad9: gwzSb: goto SoUno; dxRDr: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto JIad9; lv71T: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\x23"; goto dxRDr; SoUno: } goto eJMbU; qiC_E: return $_output; goto QEY2w; eJMbU: InEQA: goto qiC_E; yfT0u: $_output = ''; goto a9ub1; QEY2w: } public function errors_array($langify = TRUE) { goto YsCCr; XViAe: QTZAp: goto zYEbJ; rJJRz: return $_output; goto P4TUg; YWubf: goto xfBln; goto XViAe; Ac9BR: foreach ($this->errors as $error) { goto XTv6v; X0wyH: gBh8R: goto IsBCW; XTv6v: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\43\43"; goto KJIBR; KJIBR: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto X0wyH; IsBCW: } goto ONx8d; lna3k: return $this->errors; goto YWubf; zYEbJ: $_output = []; goto Ac9BR; ONx8d: jxEKY: goto rJJRz; YsCCr: if ($langify) { goto QTZAp; } goto lna3k; P4TUg: xfBln: goto LECDU; LECDU: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto GsdSs; n5AJ6: Jc1ia: goto JT00B; qKm8Z: $this->trigger_events("\145\170\164\162\141\137\167\x68\145\x72\145"); goto djK8e; Hh0w5: if (!($hash === FALSE)) { goto Jc1ia; } goto lfv0N; GsdSs: $hash = $this->hash_password($password, $identity); goto Hh0w5; RmDKJ: return $this->db->affected_rows() == 1; goto SF5L5; JT00B: $data = ["\160\141\x73\163\x77\x6f\162\x64" => $hash, "\162\145\155\x65\x6d\x62\145\x72\x5f\x63\157\x64\x65" => NULL, "\x66\157\162\147\157\164\x74\145\x6e\137\160\x61\163\163\x77\x6f\162\x64\x5f\x63\x6f\x64\145" => NULL, "\x66\x6f\162\147\157\164\164\145\156\137\x70\x61\x73\x73\167\157\x72\144\x5f\x74\x69\155\145" => NULL]; goto qKm8Z; lfv0N: return FALSE; goto n5AJ6; djK8e: $this->db->update($this->tables["\165\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto RmDKJ; SF5L5: } protected function _filter_data($table, $data) { goto YlwaS; xsgKl: bkV5Q: goto MxLX4; GFqh2: foreach ($columns as $column) { goto kCI_4; kCI_4: if (!array_key_exists($column, $data)) { goto ptKrB; } goto Jzy5h; thDCo: ptKrB: goto cZJub; cZJub: PlHY7: goto g0SMx; Jzy5h: $filtered_data[$column] = $data[$column]; goto thDCo; g0SMx: } goto yRQIV; fgarc: if (!is_array($data)) { goto bkV5Q; } goto GFqh2; yRQIV: WCqp_: goto xsgKl; MxLX4: return $filtered_data; goto EY6SR; Jzyhj: $columns = $this->db->list_fields($table); goto fgarc; YlwaS: $filtered_data = []; goto Jzyhj; EY6SR: } protected function _random_token($result_length = 32) { goto ff53N; tsgUj: CGgSh: goto qK_Zf; qK_Zf: return FALSE; goto NZ7lz; YAnzT: J_WtO: goto U6HSn; GVpUp: ow86j: goto gPMoZ; NnONs: $result_length = 32; goto GVpUp; xmrHU: dlKQS: goto mx4m5; ff53N: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto ow86j; } goto NnONs; mx4m5: if (!function_exists("\157\160\145\156\163\163\x6c\137\162\141\x6e\x64\157\x6d\137\x70\163\145\x75\x64\157\x5f\142\171\x74\x65\163")) { goto CGgSh; } goto sg1Jm; U6HSn: if (!function_exists("\x6d\x63\x72\x79\160\x74\137\x63\162\145\141\x74\x65\137\151\166")) { goto dlKQS; } goto ghVJ0; GFFc0: return bin2hex(random_bytes($result_length / 2)); goto YAnzT; gPMoZ: if (!function_exists("\162\141\156\144\157\155\137\142\x79\x74\145\x73")) { goto J_WtO; } goto GFFc0; ghVJ0: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto xmrHU; sg1Jm: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto tsgUj; NZ7lz: } protected function _get_hash_parameters($identity = NULL) { goto wKoLe; dYnmI: r0g9K: goto qt7n3; IIJgX: $is_admin = TRUE; goto LF2pR; p0eaL: $user_id = $this->get_user_id_from_identity($identity); goto BS6WL; p88J3: $params = FALSE; goto vdovG; lDqyU: wc06g: goto dYnmI; LF2pR: tSAUS: goto M3yT9; BS6WL: if (!($user_id && $this->in_group($this->config->item("\141\x64\x6d\x69\x6e\x5f\x67\x72\157\165\x70", "\x69\157\x6e\x5f\x61\x75\164\150"), $user_id))) { goto tSAUS; } goto IIJgX; vdovG: switch ($this->hash_method) { case "\142\143\162\171\160\x74": $params = ["\143\157\163\x74" => $is_admin ? $this->config->item("\142\143\x72\171\x70\164\x5f\141\x64\x6d\x69\156\x5f\x63\x6f\163\x74", "\x69\157\x6e\137\x61\x75\x74\150") : $this->config->item("\142\143\x72\x79\160\164\x5f\144\x65\x66\141\x75\154\164\x5f\143\x6f\163\x74", "\x69\157\x6e\137\141\165\164\150")]; goto r0g9K; case "\141\162\x67\157\x6e\62": $params = $is_admin ? $this->config->item("\141\x72\x67\x6f\156\62\137\x61\144\x6d\x69\x6e\x5f\x70\141\x72\x61\x6d\x73", "\151\157\x6e\x5f\141\x75\x74\150") : $this->config->item("\x61\162\147\x6f\156\62\x5f\x64\x65\146\141\x75\154\x74\137\x70\141\x72\x61\155\x73", "\151\x6f\156\137\x61\x75\x74\x68"); goto r0g9K; default: } goto lDqyU; qt7n3: return $params; goto z3evw; M3yT9: PciQm: goto p88J3; kAy8_: if (!$identity) { goto PciQm; } goto p0eaL; wKoLe: $is_admin = FALSE; goto kAy8_; z3evw: } protected function _get_hash_algo() { goto kzUmK; kzUmK: $algo = FALSE; goto iWbUB; nuYpk: return $algo; goto kXUGB; AihVl: qPB2b: goto nuYpk; iWbUB: switch ($this->hash_method) { case "\142\143\162\171\160\x74": $algo = PASSWORD_BCRYPT; goto qPB2b; case "\x61\162\x67\157\156\x32": $algo = PASSWORD_ARGON2I; goto qPB2b; default: } goto qXVvh; qXVvh: qEyjO: goto AihVl; kXUGB: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto KrGSf; tcjbT: $validator = $this->_random_token($validator_size); goto NG224; OuILl: $user_code = "{$selector}\x2e{$validator}"; goto EM2G4; EM2G4: return (object) ["\x73\145\154\x65\143\164\x6f\162" => $selector, "\x76\x61\x6c\x69\x64\141\x74\157\162\137\150\x61\x73\150\145\144" => $validator_hashed, "\x75\163\145\162\x5f\x63\157\144\145" => $user_code]; goto kv3Gb; KrGSf: $selector = $this->_random_token($selector_size); goto tcjbT; NG224: $validator_hashed = $this->hash_password($validator); goto OuILl; kv3Gb: } protected function _retrieve_selector_validator_couple($user_code) { goto eu5Ol; AVLCI: $tokens = explode("\56", $user_code); goto X7GDO; Pkjt_: ljic3: goto mxgQn; dxRfB: EcZyD: goto Pkjt_; mxgQn: return FALSE; goto cIUJa; eu5Ol: if (!$user_code) { goto ljic3; } goto AVLCI; X7GDO: if (!(count($tokens) === 2)) { goto EcZyD; } goto d44_G; d44_G: return (object) ["\163\x65\x6c\x65\x63\164\x6f\x72" => $tokens[0], "\x76\141\154\151\144\141\x74\157\162" => $tokens[1]]; goto dxRfB; cIUJa: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto eHFkG; NNV5C: $salt = substr($hashed_password_db, 0, $salt_length); goto xDhJI; bHWiW: return FALSE; goto u0pYP; MGZxV: $this->trigger_events(["\x70\157\x73\164\x5f\163\x68\x61\x31\137\160\141\163\163\x77\x6f\x72\x64\137\155\151\147\x72\141\x74\151\157\x6e", "\x70\157\163\164\137\x73\150\x61\61\137\160\x61\x73\163\x77\x6f\x72\x64\x5f\x6d\x69\147\162\x61\164\x69\x6f\156\137\165\156\x73\x75\x63\143\145\163\x73\x66\165\x6c"]); goto bHWiW; h_f9h: FEmI4: goto mMRqb; o12ZL: if (!($query->num_rows() !== 1)) { goto AmqVr; } goto oIyPN; yxZWJ: $this->trigger_events(["\160\x6f\x73\164\x5f\x73\x68\x61\x31\137\160\141\x73\163\167\157\162\144\137\155\151\147\162\141\164\x69\157\x6e", "\x70\157\163\164\137\x73\150\x61\x31\137\160\141\163\x73\x77\x6f\162\x64\x5f\x6d\x69\x67\x72\141\x74\x69\x6f\x6e\x5f\x73\165\143\143\145\x73\163\146\x75\154"]); goto h_f9h; oIyPN: $this->trigger_events(["\160\x6f\163\164\137\x73\150\141\x31\x5f\160\x61\163\x73\167\x6f\162\x64\x5f\155\151\x67\162\x61\164\x69\157\156", "\160\x6f\163\164\137\x73\150\x61\x31\x5f\160\141\163\x73\x77\157\162\x64\x5f\x6d\151\147\x72\141\x74\x69\x6f\156\137\165\156\x73\165\143\x63\x65\x73\163\146\165\x6c"]); goto r6Yb0; r6Yb0: return FALSE; goto A7ySx; pfWuo: if ($result) { goto V6pPK; } goto N3juV; u0pYP: goto WeAk5; goto RDPQj; eTMjf: WeAk5: goto bqy77; dW667: $hashed_password = sha1($password . $salt_db->salt); goto E0f0a; afxdB: t5CZS: goto VVyz3; Th1mO: if ($this->config->item("\x73\164\157\x72\145\x5f\x73\x61\x6c\164", "\151\157\156\137\x61\x75\164\150")) { goto t5CZS; } goto qPyR_; E0f0a: NC2tT: goto qzhUv; VVyz3: $query = $this->db->select("\x73\x61\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\162\x73"]); goto EL2G2; qPyR_: $salt_length = $this->config->item("\x73\141\x6c\164\x5f\154\145\156\x67\164\x68", "\151\157\x6e\137\141\165\x74\x68"); goto tL7sG; N3juV: $this->trigger_events(["\x70\157\x73\164\x5f\x73\x68\141\61\137\160\141\163\x73\x77\157\162\144\137\x6d\x69\147\x72\141\x74\151\157\156", "\160\157\x73\x74\137\x73\150\x61\x31\137\x70\141\163\163\167\x6f\162\144\137\x6d\x69\x67\162\141\164\151\157\x6e\x5f\165\x6e\x73\x75\143\x63\145\x73\x73\146\165\x6c"]); goto GQFc6; OOqxk: return FALSE; goto IsVEo; i8NQF: $this->trigger_events(["\x70\x6f\x73\164\137\163\x68\x61\x31\137\160\x61\163\x73\167\x6f\x72\x64\x5f\155\151\x67\162\x61\x74\151\x6f\x6e", "\160\x6f\163\x74\137\x73\150\x61\x31\137\160\141\163\163\167\157\162\144\x5f\x6d\x69\147\x72\141\164\x69\157\x6e\137\x75\x6e\x73\x75\x63\x63\x65\163\x73\x66\x75\154"]); goto OOqxk; jA_vq: V6pPK: goto yxZWJ; tL7sG: if ($salt_length) { goto Mc282; } goto i8NQF; xDhJI: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto QeVv0; EL2G2: $salt_db = $query->row(); goto o12ZL; QeVv0: goto NC2tT; goto afxdB; RDPQj: mV7lq: goto zx86w; IsVEo: Mc282: goto NNV5C; qzhUv: if ($hashed_password === $hashed_password_db) { goto mV7lq; } goto MGZxV; eHFkG: $this->trigger_events("\160\x72\145\137\x73\x68\x61\61\137\160\x61\163\163\167\x6f\162\144\137\155\x69\147\162\x61\164\151\157\156"); goto Th1mO; mMRqb: return $result; goto eTMjf; GQFc6: goto FEmI4; goto jA_vq; zx86w: $result = $this->_set_password_db($identity, $password); goto pfWuo; A7ySx: AmqVr: goto dW667; bqy77: } }
