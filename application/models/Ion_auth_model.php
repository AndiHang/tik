<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\x45\x50\x41\x54\110") or exit("\x4e\x6f\40\144\x69\162\x65\x63\x74\40\163\143\x72\151\160\x74\40\x61\x63\x63\145\163\163\40\x61\x6c\154\x6f\x77\x65\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto AtAwK; UJh31: $this->message_start_delimiter = $this->error_start_delimiter; goto RgV6F; qIsyt: $this->error_start_delimiter = $this->config->item("\145\162\x72\x6f\x72\x5f\163\x74\141\162\x74\137\x64\x65\x6c\x69\155\151\x74\x65\162", "\151\157\x6e\137\x61\165\164\150"); goto rFplp; RgV6F: $error_suffix = $form_validation_class->getProperty("\x5f\145\x72\x72\157\x72\x5f\163\x75\146\146\151\170"); goto js89L; EuNBq: $this->load->helper("\x64\141\164\x65"); goto xQWYO; eAaOQ: $this->_ion_hooks = new stdClass(); goto X4SZN; QYxpm: ipo3_: goto yMAx1; PvgPi: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto diFm7; ni3VV: $this->errors = []; goto g0dmf; c2Vs0: $error_prefix = $form_validation_class->getProperty("\x5f\145\x72\162\x6f\x72\x5f\160\x72\x65\x66\151\170"); goto b30Aq; rFplp: $this->error_end_delimiter = $this->config->item("\145\x72\162\157\162\137\145\x6e\x64\x5f\x64\145\x6c\x69\155\x69\x74\x65\162", "\x69\157\156\x5f\x61\165\164\x68"); goto xMT_W; xQWYO: $this->lang->load("\x69\157\156\x5f\141\x75\x74\x68"); goto TnMOd; TnMOd: $group_name = $this->config->item("\x64\x61\x74\x61\142\141\163\x65\x5f\147\x72\x6f\165\x70\x5f\x6e\141\x6d\x65", "\151\157\x6e\x5f\141\165\164\150"); goto tT4RQ; AtAwK: $this->config->load("\x69\x6f\x6e\x5f\x61\x75\x74\x68", TRUE); goto HkyiQ; cnOFa: $this->db = $this->load->database($group_name, TRUE, TRUE); goto qRrkR; b30Aq: $error_prefix->setAccessible(TRUE); goto xKidG; FLo4o: Ec6df: goto eAaOQ; diFm7: $this->message_end_delimiter = $this->error_end_delimiter; goto FLo4o; fM8Rh: $this->hash_method = $this->config->item("\x68\x61\163\150\x5f\x6d\145\164\150\x6f\144", "\x69\157\156\x5f\x61\165\164\x68"); goto yPyRO; g0dmf: $delimiters_source = $this->config->item("\x64\x65\x6c\151\155\151\164\x65\x72\x73\x5f\163\157\x75\x72\143\x65", "\151\x6f\156\137\141\x75\x74\x68"); goto b0ZQA; qRrkR: goto E18yH; goto Tczar; yPyRO: $this->messages = []; goto ni3VV; TTD7U: $this->join = $this->config->item("\x6a\x6f\151\156", "\151\x6f\x6e\x5f\141\165\x74\x68"); goto fM8Rh; djZ6O: $this->tables = $this->config->item("\x74\141\142\154\x65\163", "\x69\157\156\x5f\141\x75\164\150"); goto OqfoM; uP4Mj: $this->message_end_delimiter = $this->config->item("\x6d\x65\x73\x73\141\x67\x65\x5f\145\156\144\137\144\x65\x6c\x69\x6d\151\164\145\x72", "\x69\157\156\137\141\x75\x74\x68"); goto qIsyt; HkyiQ: $this->load->helper("\x63\x6f\157\x6b\151\145"); goto EuNBq; b0ZQA: if ($delimiters_source === "\146\157\162\155\137\166\x61\x6c\x69\144\141\x74\x69\157\x6e") { goto ipo3_; } goto v_WBY; mQoTb: E18yH: goto djZ6O; X4SZN: $this->trigger_events("\155\x6f\144\145\154\137\143\157\156\163\x74\x72\x75\x63\164\x6f\x72"); goto ahRqR; yMAx1: $this->load->library("\146\x6f\162\x6d\x5f\x76\141\x6c\x69\144\141\x74\x69\x6f\x6e"); goto Ot2ES; v_WBY: $this->message_start_delimiter = $this->config->item("\155\145\163\163\141\147\x65\137\163\164\x61\x72\164\137\x64\x65\154\151\155\151\164\x65\x72", "\x69\x6f\x6e\137\x61\x75\164\x68"); goto uP4Mj; Ot2ES: $form_validation_class = new ReflectionClass("\x43\111\137\x46\x6f\x72\x6d\137\166\141\x6c\151\x64\141\x74\x69\157\x6e"); goto c2Vs0; js89L: $error_suffix->setAccessible(TRUE); goto PvgPi; tT4RQ: if (empty($group_name)) { goto IJGdV; } goto cnOFa; xKidG: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto UJh31; Tczar: IJGdV: goto N0WWY; OqfoM: $this->identity_column = $this->config->item("\x69\144\145\x6e\x74\151\x74\171", "\x69\x6f\156\x5f\x61\x75\164\x68"); goto TTD7U; N0WWY: $CI =& get_instance(); goto eKYHw; xMT_W: goto Ec6df; goto QYxpm; eKYHw: $this->db = $CI->db; goto mQoTb; ahRqR: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto OhLoo; rEUym: $algo = $this->_get_hash_algo(); goto vl1hc; Z3mty: return password_hash($password, $algo, $params); goto Jq6Iy; ZIRCB: return FALSE; goto z0c6g; VbGBh: return FALSE; goto cDGZe; OhLoo: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto uJj1n; } goto ZIRCB; vl1hc: $params = $this->_get_hash_parameters($identity); goto gaOyz; z0c6g: uJj1n: goto rEUym; gaOyz: if (!($algo !== FALSE && $params !== FALSE)) { goto E3eAz; } goto Z3mty; Jq6Iy: E3eAz: goto VbGBh; cDGZe: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto EJmTm; V9mqN: Jc2vr: goto ouYDL; ouYDL: if (strpos($hash_password_db, "\x24") === 0) { goto zWMaR; } goto n41pP; kIbCX: goto HS0pk; goto D3xjI; D3xjI: zWMaR: goto I2ale; I2ale: return password_verify($password, $hash_password_db); goto oCp8Q; oCp8Q: HS0pk: goto dyChi; gDESN: return FALSE; goto V9mqN; n41pP: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto kIbCX; EJmTm: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto Jc2vr; } goto gDESN; dyChi: } public function rehash_password_if_needed($hash, $identity, $password) { goto Tz2Ut; Dr44G: $this->trigger_events(["\162\145\x68\141\163\150\137\x70\x61\163\163\167\x6f\162\144", "\x72\145\150\x61\x73\150\x5f\x70\141\x73\163\x77\157\162\x64\x5f\x75\156\163\x75\143\143\145\163\163\146\165\154"]); goto qrs21; mR_O2: $this->trigger_events(["\162\x65\x68\x61\163\x68\137\x70\141\x73\163\x77\157\162\x64", "\162\145\150\x61\x73\x68\x5f\x70\141\163\x73\x77\157\162\144\x5f\x73\165\x63\x63\145\x73\x73\x66\x75\x6c"]); goto pPRjS; Eev7a: if ($this->_set_password_db($identity, $password)) { goto iuYic; } goto Dr44G; nTa5l: if (!password_needs_rehash($hash, $algo, $params)) { goto V3p_L; } goto Eev7a; qrs21: goto EQvBC; goto aY3UR; WyoJZ: SOOkY: goto NJzzi; sg3rd: $params = $this->_get_hash_parameters($identity); goto Ccwmj; Tz2Ut: $algo = $this->_get_hash_algo(); goto sg3rd; aY3UR: iuYic: goto mR_O2; aI8CQ: V3p_L: goto WyoJZ; pPRjS: EQvBC: goto aI8CQ; Ccwmj: if (!($algo !== FALSE && $params !== FALSE)) { goto SOOkY; } goto nTa5l; NJzzi: } public function get_user_by_activation_code($user_code) { goto w0fTp; TyvtS: $user = $this->where("\141\143\164\x69\166\x61\x74\151\x6f\156\x5f\x73\145\x6c\x65\x63\164\157\162", $token->selector)->users()->row(); goto YN6it; YN6it: if (!$user) { goto vSn1Y; } goto ixkF8; w0fTp: $token = $this->_retrieve_selector_validator_couple($user_code); goto TyvtS; N9rgo: return $user; goto tjraC; ixkF8: if (!$this->verify_password($token->validator, $user->activation_code)) { goto a_vKi; } goto N9rgo; qH9Kc: vSn1Y: goto PkRF6; PkRF6: return FALSE; goto zuD2t; tjraC: a_vKi: goto qH9Kc; zuD2t: } public function activate($id, $code = FALSE) { goto rp1hy; z9WFV: $this->trigger_events(["\160\x6f\163\164\137\x61\143\164\151\166\141\164\145", "\160\x6f\163\164\137\x61\x63\164\151\x76\x61\x74\145\x5f\x75\x6e\x73\165\x63\x63\x65\163\x73\x66\165\154"]); goto OeUup; ifGyv: pJ6OS: goto z9WFV; uhVKU: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $data, ["\x69\x64" => $id]); goto Qjdek; RWG04: $user = $this->get_user_by_activation_code($code); goto LaOAo; Qjdek: if (!($this->db->affected_rows() === 1)) { goto n9Y8T; } goto rOYZ2; eh8Cp: return FALSE; goto kz7k5; zmtoF: $data = ["\141\143\x74\x69\166\141\164\x69\157\156\x5f\x73\145\x6c\x65\143\x74\157\162" => NULL, "\x61\x63\164\151\x76\x61\x74\151\x6f\x6e\x5f\x63\x6f\x64\145" => NULL, "\x61\x63\x74\151\x76\x65" => 1]; goto RAB2L; Fjeio: if (!($code !== FALSE)) { goto ThfAK; } goto RWG04; LaOAo: ThfAK: goto j2L4E; UsZi3: n9Y8T: goto ifGyv; f7Odk: return TRUE; goto UsZi3; NCbQM: $this->set_message("\141\x63\164\x69\x76\141\x74\x65\137\163\165\x63\x63\x65\163\163\146\165\x6c"); goto f7Odk; j2L4E: if (!($code === FALSE || $user && $user->id === $id)) { goto pJ6OS; } goto zmtoF; RAB2L: $this->trigger_events("\x65\170\x74\162\x61\137\x77\x68\145\x72\x65"); goto uhVKU; OeUup: $this->set_error("\x61\x63\x74\151\x76\x61\x74\145\x5f\x75\156\163\165\x63\x63\145\163\163\146\165\154"); goto eh8Cp; rOYZ2: $this->trigger_events(["\160\x6f\x73\x74\137\141\143\164\151\166\141\x74\145", "\x70\157\163\164\137\x61\x63\164\151\166\x61\164\145\137\x73\x75\143\x63\x65\x73\x73\x66\165\154"]); goto NCbQM; rp1hy: $this->trigger_events("\160\x72\x65\137\141\143\x74\151\x76\141\x74\145"); goto Fjeio; kz7k5: } public function deactivate($id = NULL) { goto gQ4uY; zlF8k: goto T8cmQ; goto exRZV; c1_H8: return $return; goto N1hK0; So17H: $this->db->update($this->tables["\x75\163\145\162\163"], $data, ["\x69\144" => $id]); goto SZEk0; SZEk0: $return = $this->db->affected_rows() == 1; goto Vy1qx; REvvA: x5VRB: goto mVfHa; CRVJe: return FALSE; goto QwrlE; Vy1qx: if ($return) { goto AHEmx; } goto jaxpI; wH_bI: $this->set_error("\x64\x65\x61\143\x74\x69\166\141\164\145\x5f\x75\156\163\x75\143\143\x65\163\163\146\x75\x6c"); goto zprUS; zprUS: return FALSE; goto REvvA; gQ4uY: $this->trigger_events("\x64\145\141\x63\164\x69\x76\x61\164\145"); goto DDiSc; jaxpI: $this->set_error("\144\x65\x61\x63\x74\x69\166\x61\x74\x65\x5f\x75\x6e\x73\165\143\x63\145\x73\163\x66\x75\154"); goto zlF8k; X2gCM: auXNl: goto wH_bI; GtnmP: goto x5VRB; goto X2gCM; exRZV: AHEmx: goto uz90Q; mVfHa: $token = $this->_generate_selector_validator_couple(20, 40); goto Nd6ya; d1itd: $data = ["\141\143\x74\151\x76\x61\164\151\157\156\x5f\x73\x65\x6c\x65\143\164\x6f\162" => $token->selector, "\141\143\164\151\x76\x61\164\151\x6f\156\137\143\157\144\x65" => $token->validator_hashed, "\141\143\164\x69\x76\x65" => 0]; goto rXGPV; lskO1: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto E2FQg; } goto yWZK2; uz90Q: $this->set_message("\144\x65\x61\143\164\151\x76\141\164\x65\137\x73\165\143\x63\x65\x73\x73\x66\x75\154"); goto Bsh_E; Bsh_E: T8cmQ: goto c1_H8; DDiSc: if (!isset($id)) { goto auXNl; } goto lskO1; Nd6ya: $this->activation_code = $token->user_code; goto d1itd; QwrlE: E2FQg: goto GtnmP; rXGPV: $this->trigger_events("\145\170\164\x72\x61\137\167\150\145\x72\x65"); goto So17H; yWZK2: $this->set_error("\x64\x65\141\143\164\x69\x76\x61\x74\x65\x5f\x63\x75\x72\162\x65\x6e\164\x5f\165\163\x65\162\x5f\x75\156\x73\x75\143\143\145\163\x73\x66\x75\x6c"); goto CRVJe; N1hK0: } public function clear_forgotten_password_code($identity) { goto knWGv; Sg2Fw: FNIGu: goto vYI_W; qGnsI: $this->db->update($this->tables["\165\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto B2cqY; pgues: return FALSE; goto Sg2Fw; B2cqY: return TRUE; goto dW0Wc; knWGv: if (!empty($identity)) { goto FNIGu; } goto pgues; vYI_W: $data = ["\x66\157\162\x67\x6f\164\164\145\x6e\x5f\160\141\163\163\x77\157\x72\144\137\163\145\154\145\143\164\x6f\x72" => NULL, "\x66\157\162\147\157\x74\x74\x65\156\137\160\141\163\x73\167\x6f\x72\x64\x5f\x63\x6f\x64\x65" => NULL, "\x66\x6f\162\147\x6f\164\x74\x65\x6e\x5f\x70\141\163\x73\x77\x6f\x72\144\137\164\x69\x6d\x65" => NULL]; goto qGnsI; dW0Wc: } public function clear_remember_code($identity) { goto iutco; iutco: if (!empty($identity)) { goto Nt5EK; } goto WOJ3W; gn_F8: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto aEgNc; CpSAy: $data = ["\162\x65\x6d\x65\155\x62\145\162\137\x73\145\154\145\143\164\x6f\162" => NULL, "\x72\145\155\145\x6d\x62\145\162\x5f\x63\x6f\x64\145" => NULL]; goto gn_F8; aEgNc: return TRUE; goto DZ01r; gsb1o: Nt5EK: goto CpSAy; WOJ3W: return FALSE; goto gsb1o; DZ01r: } public function reset_password($identity, $new) { goto dAFE2; e5iTy: $return = $this->_set_password_db($identity, $new); goto OQLvN; LVffi: $this->set_error("\160\141\x73\163\x77\157\162\144\137\143\150\141\156\147\145\x5f\x75\x6e\163\165\x63\x63\x65\163\163\x66\165\x6c"); goto It7NW; e0_vH: if ($this->identity_check($identity)) { goto KzwcF; } goto qrv8D; dAFE2: $this->trigger_events("\x70\162\145\x5f\x63\150\141\x6e\147\145\x5f\x70\141\x73\x73\x77\157\162\x64"); goto e0_vH; Pc8zg: $this->trigger_events(["\160\157\x73\164\x5f\x63\150\141\x6e\147\x65\x5f\x70\141\163\163\167\x6f\x72\x64", "\160\157\x73\x74\137\143\x68\x61\x6e\x67\145\137\160\141\163\163\167\157\x72\x64\x5f\165\x6e\163\165\143\143\145\163\163\x66\165\x6c"]); goto LVffi; El_h0: return $return; goto yoUM2; uNRzm: xGMj3: goto El_h0; dfPaL: KzwcF: goto e5iTy; oDG6g: $this->set_message("\160\141\163\x73\167\157\162\144\x5f\x63\x68\141\x6e\x67\x65\137\x73\165\x63\x63\145\x73\163\x66\165\x6c"); goto uNRzm; qrv8D: $this->trigger_events(["\160\157\163\x74\137\x63\x68\141\156\147\145\137\160\141\x73\x73\x77\157\x72\144", "\160\157\163\x74\137\x63\x68\x61\x6e\x67\145\137\160\x61\163\x73\167\x6f\x72\x64\x5f\x75\156\x73\165\143\x63\x65\163\163\146\x75\154"]); goto SPUtT; OQLvN: if ($return) { goto QR23R; } goto Pc8zg; lNTEU: $this->trigger_events(["\160\157\163\x74\x5f\143\x68\141\156\147\x65\x5f\160\141\163\x73\x77\157\x72\x64", "\x70\157\163\164\137\x63\150\x61\x6e\x67\145\137\160\x61\163\163\167\x6f\162\144\137\x73\165\143\143\x65\163\x73\x66\x75\x6c"]); goto oDG6g; HyAJF: QR23R: goto lNTEU; It7NW: goto xGMj3; goto HyAJF; SPUtT: return FALSE; goto dfPaL; yoUM2: } public function change_password($identity, $old, $new) { goto dL9qq; E83ES: $this->trigger_events(["\x70\157\163\x74\137\x63\150\141\x6e\x67\x65\137\x70\x61\163\x73\167\157\x72\144", "\x70\157\163\164\137\x63\x68\141\156\147\x65\x5f\x70\141\x73\163\167\x6f\x72\144\x5f\163\x75\x63\143\x65\163\x73\146\165\154"]); goto nspKD; pIPuX: $query = $this->db->select("\x69\x64\x2c\40\x70\x61\x73\163\x77\x6f\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\x65\x73\143")->get($this->tables["\x75\x73\x65\x72\x73"]); goto zRZNR; kqSaj: $user = $query->row(); goto Bu216; Arv2q: $this->trigger_events(["\160\157\x73\164\x5f\143\x68\141\156\x67\145\137\x70\141\x73\x73\x77\157\162\144", "\x70\157\x73\164\x5f\143\150\x61\156\x67\145\x5f\160\x61\x73\x73\x77\x6f\162\144\137\165\x6e\163\165\x63\x63\145\163\x73\x66\x75\154"]); goto YZo3h; GHZhC: LMUv6: goto P05Vk; dL9qq: $this->trigger_events("\x70\x72\145\x5f\143\150\x61\x6e\x67\x65\x5f\160\x61\x73\163\x77\x6f\162\x64"); goto z5kLz; nspKD: $this->set_message("\160\x61\163\x73\x77\x6f\162\144\137\143\x68\x61\156\147\145\x5f\163\165\x63\143\x65\x73\x73\146\165\154"); goto s0kp2; tqnn_: AI192: goto E83ES; z5kLz: $this->trigger_events("\x65\170\164\x72\141\x5f\x77\x68\x65\x72\x65"); goto pIPuX; C8qlJ: $this->set_error("\x70\x61\x73\163\167\157\162\x64\137\x63\150\141\x6e\147\x65\137\165\x6e\163\x75\x63\x63\x65\163\163\x66\165\x6c"); goto Cvtu1; YZo3h: $this->set_error("\x70\x61\x73\x73\167\157\x72\144\x5f\143\150\141\x6e\x67\x65\x5f\165\x6e\x73\x75\143\x63\145\x73\163\x66\165\154"); goto N8IG0; dC6b9: return $result; goto GHZhC; R1FZ_: $this->trigger_events(["\160\x6f\163\164\137\x63\150\x61\x6e\147\x65\x5f\x70\141\163\x73\167\157\x72\x64", "\160\x6f\163\164\137\143\150\141\156\x67\145\x5f\160\x61\x73\163\x77\x6f\162\144\x5f\x75\x6e\163\165\143\x63\x65\163\163\x66\165\154"]); goto C8qlJ; gdmtn: $result = $this->_set_password_db($identity, $new); goto y5dGh; P05Vk: $this->set_error("\x70\x61\163\x73\x77\x6f\x72\144\x5f\143\x68\141\156\x67\145\x5f\165\156\x73\165\143\143\145\x73\163\x66\x75\154"); goto Je7HJ; Cvtu1: return FALSE; goto nqOB2; s0kp2: W3JHz: goto dC6b9; nqOB2: HyIhg: goto kqSaj; Je7HJ: return FALSE; goto zRWZM; N8IG0: goto W3JHz; goto tqnn_; Bu216: if (!$this->verify_password($old, $user->password, $identity)) { goto LMUv6; } goto gdmtn; zRZNR: if (!($query->num_rows() !== 1)) { goto HyIhg; } goto R1FZ_; y5dGh: if ($result) { goto AI192; } goto Arv2q; zRWZM: } public function username_check($username = '') { goto Goth_; Goth_: $this->trigger_events("\165\x73\x65\162\156\x61\155\145\x5f\x63\x68\x65\x63\153"); goto UnzOA; rI7xF: return $this->db->where("\x75\x73\x65\162\156\x61\x6d\145", $username)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\163"]) > 0; goto TsFp8; UnzOA: if (!empty($username)) { goto WVTXb; } goto qSsCc; qSsCc: return FALSE; goto xgywH; LSwVi: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\150\145\162\x65"); goto rI7xF; xgywH: WVTXb: goto LSwVi; TsFp8: } public function email_check($email = '') { goto ClFjP; ClFjP: $this->trigger_events("\145\x6d\141\151\154\x5f\143\150\x65\x63\x6b"); goto IFVOE; AyVMN: return $this->db->where("\145\x6d\x61\x69\x6c", $email)->limit(1)->count_all_results($this->tables["\x75\163\x65\162\x73"]) > 0; goto mB78i; x9OPY: return FALSE; goto Vy8dA; IFVOE: if (!empty($email)) { goto TqUTO; } goto x9OPY; Vy8dA: TqUTO: goto cL3QK; cL3QK: $this->trigger_events("\x65\x78\164\x72\x61\137\x77\x68\145\162\145"); goto AyVMN; mB78i: } public function identity_check($identity = '') { goto Wye9g; APyEM: if (!empty($identity)) { goto LiPlD; } goto s40u0; s40u0: return FALSE; goto uruiz; Wye9g: $this->trigger_events("\151\x64\145\156\164\x69\x74\x79\137\143\150\x65\143\153"); goto APyEM; uruiz: LiPlD: goto M8oto; M8oto: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\145\x72\163"]) > 0; goto vhPXb; vhPXb: } public function get_user_id_from_identity($identity = '') { goto i6kSY; Vn3gN: return FALSE; goto Vbju1; pwB7X: if (!($query->num_rows() !== 1)) { goto wT01O; } goto Vn3gN; AjZ3j: $query = $this->db->select("\151\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto pwB7X; Vbju1: wT01O: goto sYwzM; abd7i: return FALSE; goto RHttM; i6kSY: if (!empty($identity)) { goto nlnXy; } goto abd7i; b8mNr: return $user->id; goto rUlar; RHttM: nlnXy: goto AjZ3j; sYwzM: $user = $query->row(); goto b8mNr; rUlar: } public function forgotten_password($identity) { goto fDiaX; fDiaX: if (!empty($identity)) { goto rH05c; } goto VBy8N; GQ00t: goto VWzGB; goto pUCKK; zlFSW: $this->trigger_events(["\x70\157\163\164\x5f\146\x6f\x72\x67\157\164\164\x65\x6e\x5f\160\x61\x73\x73\167\x6f\x72\144", "\x70\157\163\164\x5f\146\x6f\162\147\x6f\x74\x74\145\156\x5f\160\141\x73\x73\x77\157\162\x64\x5f\165\156\163\x75\143\143\145\163\x73\x66\x75\x6c"]); goto Uh09m; BrJvX: rH05c: goto iVKS3; hpYzT: return FALSE; goto BrJvX; fNbNx: $update = ["\146\x6f\x72\147\157\x74\x74\x65\156\137\160\141\163\x73\167\x6f\x72\144\x5f\163\x65\x6c\145\x63\x74\x6f\162" => $token->selector, "\146\157\x72\x67\157\164\164\145\x6e\137\x70\141\x73\x73\x77\157\x72\144\137\x63\x6f\x64\x65" => $token->validator_hashed, "\x66\x6f\162\147\157\164\164\x65\x6e\137\160\x61\x73\x73\167\157\162\x64\137\164\x69\x6d\145" => time()]; goto e1QEn; Kt0dU: $this->trigger_events(["\x70\157\163\x74\137\146\157\162\147\157\x74\x74\145\156\x5f\160\141\x73\x73\167\x6f\x72\144", "\160\x6f\163\x74\x5f\x66\x6f\x72\147\x6f\x74\164\x65\x6e\x5f\160\x61\x73\x73\167\x6f\x72\x64\x5f\x73\165\x63\143\145\x73\x73\x66\x75\154"]); goto tUstQ; Xdg72: VWzGB: goto A_EGR; E46Mh: $this->db->update($this->tables["\165\163\x65\162\163"], $update, [$this->identity_column => $identity]); goto nNglC; pUCKK: adYOC: goto Kt0dU; nNglC: if ($this->db->affected_rows() === 1) { goto adYOC; } goto zlFSW; tUstQ: return $token->user_code; goto Xdg72; e1QEn: $this->trigger_events("\145\x78\164\162\141\137\167\150\145\162\145"); goto E46Mh; VBy8N: $this->trigger_events(["\160\157\163\x74\137\x66\157\x72\x67\x6f\x74\x74\145\156\x5f\160\x61\x73\x73\167\157\x72\144", "\160\157\163\x74\x5f\x66\157\162\x67\x6f\164\x74\145\156\x5f\x70\141\163\163\x77\x6f\162\x64\x5f\x75\156\163\165\143\143\145\163\163\146\165\x6c"]); goto hpYzT; iVKS3: $token = $this->_generate_selector_validator_couple(20, 80); goto fNbNx; Uh09m: return FALSE; goto GQ00t; A_EGR: } public function get_user_by_forgotten_password_code($user_code) { goto X3n91; rj1pb: WXoUx: goto kzPEe; CHmfr: return $user; goto rj1pb; kzPEe: AH9Eo: goto VQw4v; X3n91: $token = $this->_retrieve_selector_validator_couple($user_code); goto RL6Hh; VQw4v: return FALSE; goto qVsKK; xXozP: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto WXoUx; } goto CHmfr; RL6Hh: $user = $this->where("\x66\157\x72\x67\157\x74\164\x65\156\x5f\x70\141\x73\163\x77\x6f\162\144\x5f\x73\x65\x6c\x65\143\164\x6f\x72", $token->selector)->users()->row(); goto gpOxz; gpOxz: if (!$user) { goto AH9Eo; } goto xXozP; qVsKK: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto qB9wF; LPqbu: C0Dl2: goto ewNDx; dAcx0: if (!(isset($default_group->id) && empty($groups))) { goto nxIAr; } goto EyMsL; NXeiv: $id = $this->db->insert_id($this->tables["\165\163\145\x72\x73"] . "\137\151\x64\137\163\145\161"); goto dAcx0; aCppJ: if (!(!isset($query->id) && empty($groups))) { goto CYIaY; } goto fkrOX; alaCa: return isset($id) ? $id : FALSE; goto sC3Eu; MdTZ3: $ip_address = $this->input->ip_address(); goto WZ7cn; WZ7cn: $password = $this->hash_password($password); goto etZGG; kNWkC: if ($this->identity_check($identity)) { goto dK0H5; } goto ao1pg; pt2tk: $manual_activation = $this->config->item("\155\141\156\x75\141\x6c\137\141\x63\164\151\166\x61\x74\x69\x6f\x6e", "\x69\x6f\x6e\137\141\165\164\150"); goto kNWkC; BLyu7: if (empty($groups)) { goto hg5AD; } goto OsHvH; w01ew: return FALSE; goto x0hFW; EsELU: $this->db->insert($this->tables["\x75\x73\145\162\x73"], $user_data); goto NXeiv; DsrIT: Yclg8: goto Kuhmg; SggkG: CYIaY: goto mUmos; KK7i2: zt2mq: goto aLsk2; hm4Af: $this->set_error("\x61\x63\x63\x6f\x75\156\164\137\x63\162\145\x61\x74\151\157\x6e\137\x75\156\163\x75\x63\143\145\x73\163\x66\x75\154"); goto O88am; fkrOX: $this->set_error("\141\143\x63\x6f\x75\156\164\x5f\x63\162\145\x61\164\x69\x6f\x6e\137\x69\x6e\x76\x61\x6c\151\144\137\144\145\146\141\x75\x6c\x74\137\x67\x72\x6f\x75\160"); goto g1cRr; g1cRr: return FALSE; goto SggkG; ewNDx: hg5AD: goto U_Wwd; ao1pg: if (!(!$this->config->item("\144\x65\x66\141\165\x6c\x74\x5f\147\x72\157\165\160", "\151\x6f\156\x5f\141\165\164\150") && empty($groups))) { goto M8zOL; } goto KTZp1; symcv: dK0H5: goto Slxu4; qB9wF: $this->trigger_events("\x70\162\145\137\x72\145\x67\151\163\x74\145\162"); goto pt2tk; x0hFW: M8zOL: goto LjLQ1; KTZp1: $this->set_error("\141\x63\x63\157\165\156\x74\x5f\x63\x72\145\141\164\x69\157\156\137\x6d\x69\x73\x73\151\x6e\x67\137\x64\x65\146\141\x75\x6c\x74\137\147\162\x6f\x75\x70"); goto w01ew; OsHvH: foreach ($groups as $group) { $this->add_to_group($group, $id); Ibq6Z: } goto LPqbu; Slxu4: $this->set_error("\x61\143\x63\x6f\165\156\x74\137\x63\x72\x65\141\x74\x69\157\156\x5f\x64\x75\160\154\151\x63\x61\164\145\x5f\151\x64\x65\x6e\x74\151\x74\171"); goto y3B_U; U_Wwd: $this->trigger_events("\x70\x6f\163\x74\137\162\x65\147\x69\163\164\x65\x72"); goto alaCa; aLsk2: $data = [$this->identity_column => $identity, "\165\163\x65\x72\x6e\141\155\x65" => $identity, "\160\x61\163\163\167\157\x72\144" => $password, "\x65\155\141\151\154" => $email, "\x69\160\137\141\144\144\x72\x65\x73\163" => $ip_address, "\143\x72\x65\141\164\145\144\x5f\157\x6e" => time(), "\x61\x63\164\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto MmCNV; qjKyt: $this->trigger_events("\145\x78\x74\x72\x61\x5f\x73\145\x74"); goto EsELU; o4I6v: nxIAr: goto BLyu7; MmCNV: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\145\x72\163"], $additional_data), $data); goto qjKyt; EyMsL: $groups[] = $default_group->id; goto o4I6v; mUmos: $default_group = $query; goto MdTZ3; O88am: return FALSE; goto KK7i2; LjLQ1: goto Yclg8; goto symcv; Kuhmg: $query = $this->db->get_where($this->tables["\147\162\x6f\x75\160\x73"], ["\156\x61\155\145" => $this->config->item("\x64\x65\146\141\165\x6c\x74\x5f\147\x72\157\x75\160", "\151\x6f\x6e\137\141\165\164\x68")], 1)->row(); goto aCppJ; etZGG: if (!($password === FALSE)) { goto zt2mq; } goto hm4Af; y3B_U: return FALSE; goto DsrIT; sC3Eu: } public function login($identity, $password, $remember = FALSE) { goto k1jLv; k1jLv: $this->trigger_events("\160\162\145\x5f\154\157\x67\151\156"); goto LOowa; s8vEh: if (!($query->num_rows() === 1)) { goto wT6Sy; } goto G8Klh; jkI7B: $this->trigger_events("\x70\157\163\164\137\154\157\147\x69\156\137\165\156\163\165\x63\x63\x65\163\x73\x66\165\x6c"); goto gQOZz; zNVSA: return FALSE; goto y7tV6; qtMH6: return FALSE; goto f4Gtt; gQOZz: $this->set_error("\154\x6f\x67\151\156\137\x75\156\163\165\x63\x63\145\x73\x73\x66\165\154"); goto auqXY; VW0V1: $this->remember_user($identity); goto JIw8N; Fk3ME: $this->set_error("\154\157\147\151\156\x5f\x74\151\x6d\x65\x6f\x75\164"); goto qtMH6; Nllnd: lBRtd: goto a0OXz; QEFQw: goto NAyQ3; goto NAFG6; NAFG6: o4l6H: goto VW0V1; Xu978: $this->rehash_password_if_needed($user->password, $identity, $password); goto WelU6; OcViY: if (!$this->verify_password($password, $user->password, $identity)) { goto lBRtd; } goto XFFVO; UPaUj: $this->trigger_events("\145\x78\x74\162\141\137\167\150\x65\162\x65"); goto dAQ7S; knBTF: $this->trigger_events("\160\x6f\163\x74\137\154\157\x67\151\156\137\x75\156\x73\165\143\143\145\x73\x73\x66\x75\x6c"); goto iUXB1; G8Klh: $user = $query->row(); goto OcViY; Bma0v: $this->clear_remember_code($identity); goto QEFQw; BKlO_: $this->update_last_login($user->id); goto TnXQX; bNXT3: $this->set_error("\154\157\x67\x69\156\137\x75\x6e\163\x75\143\x63\145\163\163\x66\x75\154"); goto YF41S; CwGeW: if (!$this->config->item("\162\145\155\145\x6d\x62\x65\162\x5f\165\163\x65\x72\163", "\151\x6f\156\137\x61\x75\164\x68")) { goto UJ1Ms; } goto Ym5pN; ctmPU: $this->increase_login_attempts($identity); goto jkI7B; auqXY: return FALSE; goto Mfu7S; y7tV6: b_IcV: goto WJ2Ru; aezM_: QN3si: goto UPaUj; InjYm: $this->hash_password($password); goto ctmPU; MwSdg: $this->trigger_events("\x70\x6f\x73\x74\x5f\x6c\157\147\x69\156\137\x75\156\163\165\143\143\x65\163\x73\x66\165\x6c"); goto Fk3ME; YF41S: return FALSE; goto aezM_; f4Gtt: z6VJd: goto s8vEh; a0OXz: wT6Sy: goto InjYm; coeky: $this->clear_forgotten_password_code($identity); goto CwGeW; dAQ7S: $query = $this->db->select($this->identity_column . "\54\x20\145\x6d\x61\151\154\54\40\151\x64\54\40\x70\141\163\x73\x77\x6f\x72\144\x2c\x20\x61\143\x74\x69\166\145\x2c\x20\154\141\x73\x74\x5f\154\x6f\x67\x69\156")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\x65\x73\x63")->get($this->tables["\x75\163\x65\x72\x73"]); goto RncLZ; WJ2Ru: $this->set_session($user); goto BKlO_; Vf2tq: $this->set_message("\x6c\157\147\151\156\x5f\163\x75\143\143\145\163\163\x66\165\x6c"); goto Vps0y; tJMET: UJ1Ms: goto Xu978; Vps0y: return TRUE; goto Nllnd; WelU6: $this->session->sess_regenerate(FALSE); goto MtzRg; RncLZ: if (!$this->is_max_login_attempts_exceeded($identity)) { goto z6VJd; } goto dmxMq; TnXQX: $this->clear_login_attempts($identity); goto coeky; iUXB1: $this->set_error("\x6c\x6f\147\x69\x6e\137\x75\x6e\163\x75\143\143\145\163\x73\146\165\x6c\x5f\x6e\157\x74\x5f\141\x63\x74\x69\x76\x65"); goto zNVSA; XFFVO: if (!($user->active == 0)) { goto b_IcV; } goto knBTF; dmxMq: $this->hash_password($password); goto MwSdg; Ym5pN: if ($remember) { goto o4l6H; } goto Bma0v; MtzRg: $this->trigger_events(["\x70\157\163\164\137\x6c\x6f\147\151\156", "\160\x6f\163\x74\x5f\154\x6f\147\x69\156\x5f\x73\x75\143\143\x65\163\x73\146\165\x6c"]); goto Vf2tq; JIw8N: NAyQ3: goto tJMET; LOowa: if (!(empty($identity) || empty($password))) { goto QN3si; } goto bNXT3; Mfu7S: } public function recheck_session() { goto NIx36; B2j93: goto Ev7m1; goto W3hNt; sIxVB: Ev7m1: goto uVaWd; LJHKO: $last_login = $this->session->userdata("\x6c\141\163\x74\137\143\150\x65\x63\x6b"); goto Hi15j; uVaWd: GkJxy: goto KEhw3; lYoAO: $this->session->unset_userdata([$identity, "\x69\144", "\165\163\x65\x72\137\151\x64"]); goto H_S8L; Coyvm: if (!($recheck !== 0)) { goto mmMJT; } goto LJHKO; yf1GU: if ($query->num_rows() === 1) { goto y4ceF; } goto gMYkM; xQ9R6: return (bool) $this->session->userdata("\x69\144\145\x6e\x74\x69\x74\x79"); goto KXfse; Hi15j: if (!($last_login + $recheck < time())) { goto GkJxy; } goto NooSD; NIx36: $recheck = NULL !== $this->config->item("\x72\x65\x63\150\145\143\153\x5f\x74\151\x6d\x65\162", "\151\157\x6e\x5f\x61\x75\164\150") ? $this->config->item("\162\x65\x63\x68\145\x63\153\x5f\164\151\x6d\x65\162", "\151\157\156\x5f\x61\x75\164\x68") : 0; goto Coyvm; O9PB6: $identity = $this->config->item("\151\144\145\x6e\x74\151\164\x79", "\151\157\156\x5f\x61\x75\x74\x68"); goto lYoAO; W3hNt: y4ceF: goto u6VOn; NooSD: $query = $this->db->select("\151\144")->where([$this->identity_column => $this->session->userdata("\x69\144\x65\x6e\x74\x69\164\x79"), "\141\x63\x74\x69\x76\x65" => "\61"])->limit(1)->order_by("\x69\144", "\x64\145\163\143")->get($this->tables["\165\163\145\162\163"]); goto yf1GU; gMYkM: $this->trigger_events("\x6c\157\147\157\x75\164"); goto O9PB6; KEhw3: mmMJT: goto xQ9R6; H_S8L: return FALSE; goto B2j93; u6VOn: $this->session->set_userdata("\154\x61\163\164\x5f\143\x68\x65\x63\153", time()); goto sIxVB; KXfse: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto N3w03; N3w03: if (!$this->config->item("\164\162\x61\x63\x6b\137\x6c\157\x67\x69\x6e\137\x61\164\164\x65\x6d\x70\x74\163", "\x69\x6f\156\x5f\141\x75\164\150")) { goto MXtyK; } goto W9StO; b89pL: $attempts = $this->get_attempts_num($identity, $ip_address); goto rZgp8; W9StO: $max_attempts = $this->config->item("\155\141\x78\151\x6d\165\155\x5f\x6c\157\147\151\156\137\x61\x74\164\x65\x6d\160\x74\x73", "\151\157\x6e\x5f\x61\165\x74\150"); goto EeQwt; z6iPB: return FALSE; goto QNfB0; rZgp8: return $attempts >= $max_attempts; goto csdSe; csdSe: nTZKP: goto aOrk3; aOrk3: MXtyK: goto z6iPB; EeQwt: if (!($max_attempts > 0)) { goto nTZKP; } goto b89pL; QNfB0: } public function get_attempts_num($identity, $ip_address = NULL) { goto OPv8v; L6gLC: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto xfP0t; PCrdn: qWc30: goto yUeUO; xI8CN: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\156\x5f\x61\164\164\x65\155\x70\x74\x73"]); goto Wb3Mi; aTSam: hGYqV: goto AGcnQ; WSmRv: $this->db->select("\61", FALSE); goto L6gLC; Jxtnw: $ip_address = $this->input->ip_address(); goto aTSam; AGcnQ: $this->db->where("\x69\x70\x5f\x61\x64\144\x72\145\163\163", $ip_address); goto PCrdn; yUeUO: $this->db->where("\x74\x69\x6d\x65\40\x3e", time() - $this->config->item("\x6c\x6f\143\153\157\x75\164\137\164\151\155\145", "\151\157\x6e\137\141\165\x74\150"), FALSE); goto xI8CN; Wb3Mi: return $qres->num_rows(); goto nFPvr; OPv8v: if (!$this->config->item("\164\162\141\143\x6b\137\x6c\157\147\151\x6e\x5f\141\x74\x74\x65\155\160\164\x73", "\151\x6f\x6e\x5f\x61\165\x74\x68")) { goto ANT8_; } goto WSmRv; nFPvr: ANT8_: goto vDQT9; ybfsc: if (isset($ip_address)) { goto hGYqV; } goto Jxtnw; vDQT9: return 0; goto qfDUF; xfP0t: if (!$this->config->item("\164\162\141\x63\x6b\137\x6c\157\x67\151\x6e\137\151\160\137\x61\144\x64\162\x65\163\x73", "\151\x6f\x6e\x5f\x61\x75\x74\x68")) { goto qWc30; } goto ybfsc; qfDUF: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto fvky2; NQrds: if (isset($ip_address)) { goto aIWdZ; } goto ZwjOb; oAlbI: if (!($qres->num_rows() > 0)) { goto VmJMT; } goto RYeX2; ZwjOb: $ip_address = $this->input->ip_address(); goto paAIn; IdYzD: return 0; goto yI74m; FDnsX: $this->db->order_by("\151\144", "\144\x65\163\143"); goto nWyNi; PyjMj: if (!$this->config->item("\x74\162\141\143\x6b\137\154\x6f\x67\151\156\x5f\x69\160\x5f\141\x64\x64\162\145\x73\163", "\151\x6f\156\137\x61\x75\x74\x68")) { goto sFqs7; } goto NQrds; fvky2: if (!$this->config->item("\164\162\x61\x63\x6b\x5f\154\x6f\x67\151\x6e\x5f\141\164\x74\145\155\x70\x74\x73", "\x69\x6f\156\x5f\141\165\164\150")) { goto rpUx2; } goto gdIss; nWyNi: $qres = $this->db->get($this->tables["\154\x6f\147\x69\156\x5f\141\164\x74\145\155\x70\164\163"], 1); goto oAlbI; aTXvb: rpUx2: goto IdYzD; yTb0Y: $this->db->where("\151\160\137\141\x64\x64\162\x65\163\163", $ip_address); goto UKRRE; paAIn: aIWdZ: goto yTb0Y; p0rbf: $this->db->where("\154\157\147\151\x6e", $identity); goto PyjMj; UKRRE: sFqs7: goto FDnsX; gdIss: $this->db->select("\164\151\155\x65"); goto p0rbf; RYeX2: return $qres->row()->time; goto KhhRp; KhhRp: VmJMT: goto aTXvb; yI74m: } public function get_last_attempt_ip($identity) { goto e9Xd6; q2Onm: return ''; goto g2Ugf; L7KaN: return $qres->row()->ip_address; goto R4ZDS; jJ2d4: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto hv1tj; N4GCI: $this->db->select("\151\x70\137\141\x64\x64\162\145\163\x73"); goto jJ2d4; hv1tj: $this->db->order_by("\x69\x64", "\144\145\x73\x63"); goto iZhv9; P2sqS: if (!($qres->num_rows() > 0)) { goto akhgH; } goto L7KaN; iZhv9: $qres = $this->db->get($this->tables["\x6c\x6f\147\151\156\x5f\141\164\x74\x65\x6d\160\x74\163"], 1); goto P2sqS; WrbHx: ht67k: goto q2Onm; R4ZDS: akhgH: goto WrbHx; e9Xd6: if (!($this->config->item("\164\162\141\x63\x6b\x5f\154\x6f\147\151\156\137\141\164\x74\x65\155\160\x74\163", "\x69\x6f\156\x5f\141\x75\x74\150") && $this->config->item("\164\162\141\x63\153\137\154\157\x67\x69\156\x5f\151\x70\137\141\144\x64\x72\x65\x73\x73", "\151\x6f\x6e\x5f\x61\165\x74\150"))) { goto ht67k; } goto N4GCI; g2Ugf: } public function increase_login_attempts($identity) { goto nhaDZ; nhaDZ: if (!$this->config->item("\164\162\x61\x63\153\x5f\154\x6f\x67\x69\x6e\x5f\141\164\164\x65\x6d\160\x74\x73", "\151\157\x6e\137\x61\165\x74\x68")) { goto xO5BY; } goto NEX_L; fFTsf: return $this->db->insert($this->tables["\154\x6f\147\x69\x6e\137\x61\164\164\145\x6d\160\x74\163"], $data); goto Ez9ZU; NEX_L: $data = ["\151\160\137\x61\x64\x64\x72\x65\x73\163" => '', "\154\157\x67\151\x6e" => $identity, "\164\x69\155\x65" => time()]; goto omN7q; Ez9ZU: xO5BY: goto cF9pF; omN7q: if (!$this->config->item("\164\162\141\143\x6b\137\154\x6f\x67\151\156\137\151\160\137\x61\144\x64\x72\145\x73\x73", "\x69\x6f\x6e\137\141\x75\x74\150")) { goto TJQC5; } goto Jd6JQ; Jd6JQ: $data["\x69\160\x5f\141\x64\144\x72\145\163\x73"] = $this->input->ip_address(); goto bbx2M; bbx2M: TJQC5: goto fFTsf; cF9pF: return FALSE; goto vrYd0; vrYd0: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto e_1IO; e_1IO: if (!$this->config->item("\x74\162\x61\x63\153\137\x6c\157\x67\x69\x6e\x5f\x61\x74\x74\145\x6d\160\164\163", "\151\157\156\137\141\165\x74\x68")) { goto RW6dR; } goto zQReK; h12QX: $this->db->or_where("\x74\x69\x6d\145\x20\74", time() - $old_attempts_expire_period, FALSE); goto BrzNY; Vnjap: $this->db->where("\x69\x70\x5f\141\144\144\x72\x65\x73\163", $ip_address); goto MPf78; dTB2K: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto P6LBx; zQReK: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\x63\x6b\157\165\x74\137\164\x69\155\x65", "\x69\x6f\x6e\137\141\165\164\x68")); goto dTB2K; bmQZo: if (isset($ip_address)) { goto yeSuu; } goto dHkqw; BrzNY: return $this->db->delete($this->tables["\154\x6f\x67\151\x6e\x5f\141\164\164\x65\155\160\164\x73"]); goto MV96F; MPf78: GDkRm: goto h12QX; MV96F: RW6dR: goto vCIdP; dHkqw: $ip_address = $this->input->ip_address(); goto P1gzt; vCIdP: return FALSE; goto wOvqR; P1gzt: yeSuu: goto Vnjap; P6LBx: if (!$this->config->item("\x74\162\141\x63\x6b\x5f\154\157\x67\151\x6e\137\151\x70\137\141\144\x64\162\145\x73\x73", "\151\157\156\x5f\x61\165\164\150")) { goto GDkRm; } goto bmQZo; wOvqR: } public function limit($limit) { goto Tw5lI; Tw5lI: $this->trigger_events("\154\x69\x6d\151\x74"); goto FKhOe; FKhOe: $this->_ion_limit = $limit; goto JvOXu; JvOXu: return $this; goto kVbLc; kVbLc: } public function offset($offset) { goto Jkj_8; Jkj_8: $this->trigger_events("\157\x66\146\x73\x65\164"); goto zXVo4; zXVo4: $this->_ion_offset = $offset; goto Kkx75; Kkx75: return $this; goto cOD9L; cOD9L: } public function where($where, $value = NULL) { goto hWF9E; HPkYx: return $this; goto GBgq_; S6_hX: array_push($this->_ion_where, $where); goto HPkYx; uM1UH: $where = [$where => $value]; goto teYFW; teYFW: atPsO: goto S6_hX; hWF9E: $this->trigger_events("\167\150\x65\x72\145"); goto prDne; prDne: if (is_array($where)) { goto atPsO; } goto uM1UH; GBgq_: } public function like($like, $value = NULL, $position = "\142\157\164\x68") { goto kLqaV; rJWBZ: array_push($this->_ion_like, ["\x6c\x69\x6b\145" => $like, "\x76\x61\154\165\x65" => $value, "\160\157\x73\151\164\151\x6f\156" => $position]); goto zr5BB; kLqaV: $this->trigger_events("\154\x69\153\x65"); goto rJWBZ; zr5BB: return $this; goto XppG6; XppG6: } public function select($select) { goto wN1wj; ggQfv: $this->_ion_select[] = $select; goto rwPu5; wN1wj: $this->trigger_events("\x73\x65\154\145\143\164"); goto ggQfv; rwPu5: return $this; goto p8TXI; p8TXI: } public function order_by($by, $order = "\144\x65\163\143") { goto J4cbc; mh04g: $this->_ion_order = $order; goto IjiPL; IjiPL: return $this; goto lMwYZ; VOgI0: $this->_ion_order_by = $by; goto mh04g; J4cbc: $this->trigger_events("\157\x72\x64\x65\x72\x5f\x62\171"); goto VOgI0; lMwYZ: } public function row() { goto JD4ad; a_oVQ: $row = $this->response->row(); goto m1JAT; m1JAT: return $row; goto wQoEV; JD4ad: $this->trigger_events("\162\157\167"); goto a_oVQ; wQoEV: } public function row_array() { goto Fjt1T; PJmlN: $row = $this->response->row_array(); goto xaAI9; Fjt1T: $this->trigger_events(["\162\157\x77", "\x72\157\x77\x5f\141\162\162\141\171"]); goto PJmlN; xaAI9: return $row; goto mJ1O3; mJ1O3: } public function result() { goto lhJYD; UmgKN: return $result; goto mLKAc; lhJYD: $this->trigger_events("\162\x65\x73\165\x6c\164"); goto Pp_Qk; Pp_Qk: $result = $this->response->result(); goto UmgKN; mLKAc: } public function result_array() { goto jYm7F; FsXBb: $result = $this->response->result_array(); goto bZX1h; jYm7F: $this->trigger_events(["\162\145\x73\165\154\x74", "\x72\x65\x73\165\154\x74\x5f\141\x72\x72\141\x79"]); goto FsXBb; bZX1h: return $result; goto EK_XA; EK_XA: } public function num_rows() { goto YBowh; lmdsJ: return $result; goto rubfg; zAjip: $result = $this->response->num_rows(); goto lmdsJ; YBowh: $this->trigger_events(["\x6e\165\155\137\x72\x6f\167\163"]); goto zAjip; rubfg: } public function users($groups = NULL) { goto Xzh5v; WCApU: foreach ($this->_ion_where as $where) { $this->db->where($where); lAEed: } goto fKszU; mWOZg: if (!isset($groups)) { goto RFXU0; } goto KU1vv; j005m: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto UFdvG; } goto dTYS7; gvxud: $this->db->join($this->tables["\x67\x72\x6f\x75\x70\x73"], $this->tables["\x75\x73\145\x72\x73\137\147\162\157\165\160\163"] . "\56" . $this->join["\x67\x72\157\x75\x70\x73"] . "\x20\75\40" . $this->tables["\x67\162\x6f\x75\160\163"] . "\56\151\x64", "\151\x6e\x6e\x65\x72"); goto Mn7y1; sqbln: if (empty($group_names)) { goto goqLa; } goto gvxud; xon6m: $this->db->limit($this->_ion_limit); goto MxDhw; XSCDI: if (!(isset($groups) && !empty($groups))) { goto ATwnK; } goto pflDn; B4TsB: $this->db->join($this->tables["\x75\163\145\162\163\137\x67\x72\157\165\x70\x73"], $this->tables["\165\163\145\162\163\x5f\147\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\x75\163\x65\x72\x73"] . "\x3d" . $this->tables["\165\x73\x65\162\x73"] . "\x2e\151\144", "\151\x6e\x6e\x65\x72"); goto rANag; Sj8JO: $this->_ion_like = []; goto iQ7z8; qpgcB: L6m6A: goto j005m; Ocf2H: TIfmV: goto wyTKr; KU1vv: if (is_array($groups)) { goto I1fmS; } goto EBCxf; iXM5a: if (empty($group_ids)) { goto pUFZi; } goto YEPJ6; dx2g8: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto Jpcjv; iQ7z8: UFdvG: goto RgMNh; B_vhn: goto mBC1G; goto Ocf2H; fAOO7: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\x77\x68\x65\x72\x65\x5f\x69\156" : "\x77\150\x65\x72\145\x5f\x69\156"; goto sqbln; VISKc: goqLa: goto iXM5a; wbUcZ: $this->trigger_events("\145\x78\x74\x72\x61\x5f\x77\x68\x65\162\x65"); goto Bocn5; YJ2Wo: vYv50: goto Sj8JO; dkMlG: c00xl: goto fAOO7; GH6Te: KbRWt: goto cCFwF; fKszU: r_QwV: goto gcnaQ; afw8o: $group_ids = []; goto ij3xQ; Bocn5: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto L6m6A; } goto WCApU; ApE42: return $this; goto YntC1; MxDhw: $this->_ion_limit = NULL; goto zvQOv; aLCNA: I1fmS: goto XSCDI; dTYS7: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\x6b\145"], $like["\x76\141\154\165\x65"], $like["\160\157\x73\x69\x74\x69\157\156"]); rgrTH: } goto YJ2Wo; Mn7y1: $this->db->where_in($this->tables["\147\162\x6f\165\160\x73"] . "\56\156\141\155\x65", $group_names); goto VISKc; kILy2: RFXU0: goto wbUcZ; pflDn: $this->db->distinct(); goto B4TsB; BIG19: if (!isset($this->_ion_limit)) { goto sat5X; } goto xon6m; ij3xQ: $group_names = []; goto YnOpQ; cCFwF: $this->response = $this->db->get($this->tables["\165\x73\x65\x72\163"]); goto ApE42; EBCxf: $groups = [$groups]; goto aLCNA; n6ymd: goto d07Oo; goto Dy8H1; Dy8H1: L7yMC: goto dx2g8; XZAH0: jBpOE: goto LH_Lj; Jpcjv: $this->_ion_limit = NULL; goto wsXrh; qEoJA: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto KbRWt; } goto Mku8t; zvQOv: sat5X: goto n6ymd; RgMNh: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto L7yMC; } goto BIG19; GPOSX: $this->_ion_order_by = NULL; goto GH6Te; rANag: ATwnK: goto afw8o; Hun3Q: mBC1G: goto mWOZg; YnOpQ: foreach ($groups as $group) { goto aBq4F; Gh9tY: QpwTj: goto SqiSC; SqiSC: $group_ids[] = $group; goto kYZHN; NHBJA: Kn3uU: goto Ddx9l; vFQsi: goto vlgNm; goto Gh9tY; kYZHN: vlgNm: goto NHBJA; aBq4F: if (is_numeric($group)) { goto QpwTj; } goto WDRbj; WDRbj: $group_names[] = $group; goto vFQsi; Ddx9l: } goto dkMlG; mLyVH: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto TIfmV; } goto s_wyB; YEPJ6: $this->db->{$or_where_in}($this->tables["\165\x73\x65\162\163\x5f\147\162\157\165\160\x73"] . "\x2e" . $this->join["\x67\x72\157\165\x70\163"], $group_ids); goto JGCht; JGCht: pUFZi: goto kILy2; LH_Lj: $this->_ion_select = []; goto Hun3Q; wyTKr: foreach ($this->_ion_select as $select) { $this->db->select($select); EFUel: } goto XZAH0; s_wyB: $this->db->select([$this->tables["\165\x73\145\162\x73"] . "\x2e\x2a", $this->tables["\165\163\145\x72\163"] . "\x2e\151\144\x20\x61\163\x20\151\144", $this->tables["\x75\163\145\162\163"] . "\56\151\x64\x20\x61\x73\x20\x75\x73\x65\162\137\x69\x64"]); goto B_vhn; Mku8t: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto kj1MV; gcnaQ: $this->_ion_where = []; goto qpgcB; kj1MV: $this->_ion_order = NULL; goto GPOSX; O5Grk: d07Oo: goto qEoJA; Xzh5v: $this->trigger_events("\x75\x73\x65\x72\163"); goto mLyVH; wsXrh: $this->_ion_offset = NULL; goto O5Grk; YntC1: } public function user($id = NULL) { goto pNBX2; pNBX2: $this->trigger_events("\x75\163\x65\x72"); goto iMRWr; rHWAh: return $this; goto d6eiu; Xyr7j: $this->order_by($this->tables["\165\x73\x65\x72\x73"] . "\56\151\x64", "\x64\x65\x73\143"); goto E_mKl; iMRWr: $id = isset($id) ? $id : $this->session->userdata("\165\x73\x65\x72\x5f\151\x64"); goto KbW5b; E_mKl: $this->where($this->tables["\x75\x73\x65\162\163"] . "\x2e\x69\144", $id); goto Wf5ZY; Wf5ZY: $this->users(); goto rHWAh; KbW5b: $this->limit(1); goto Xyr7j; d6eiu: } public function get_users_groups($id = FALSE) { goto vzPFU; vzPFU: $this->trigger_events("\147\145\164\x5f\x75\x73\x65\x72\163\x5f\x67\x72\x6f\x75\160"); goto SIuRW; SIuRW: $id || ($id = $this->session->userdata("\165\163\x65\x72\x5f\151\x64")); goto fOkVC; fOkVC: return $this->db->select($this->tables["\x75\x73\x65\162\x73\x5f\x67\162\157\165\x70\163"] . "\56" . $this->join["\x67\x72\x6f\x75\x70\163"] . "\40\x61\163\40\151\144\54\40" . $this->tables["\147\162\157\x75\160\x73"] . "\56\156\x61\x6d\x65\x2c\x20" . $this->tables["\147\162\x6f\x75\x70\163"] . "\56\144\145\163\x63\162\151\160\x74\x69\x6f\x6e")->where($this->tables["\x75\x73\x65\162\x73\137\x67\x72\x6f\x75\160\163"] . "\x2e" . $this->join["\165\163\x65\x72\163"], $id)->join($this->tables["\x67\162\157\165\x70\163"], $this->tables["\165\163\145\162\163\x5f\x67\162\x6f\x75\160\163"] . "\x2e" . $this->join["\x67\x72\x6f\165\160\163"] . "\x3d" . $this->tables["\x67\162\157\x75\160\163"] . "\56\151\x64")->get($this->tables["\165\x73\x65\162\163\137\x67\162\x6f\165\160\x73"]); goto AOtSl; AOtSl: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto t6LyA; VSDBx: if (isset($this->_cache_user_in_group[$id])) { goto OyBoo; } goto LxK4h; cD06I: $groups_array = $this->_cache_user_in_group[$id]; goto ip6ne; fuawW: if (is_array($check_group)) { goto CaKTM; } goto y6Gku; TSYR8: $id || ($id = $this->session->userdata("\165\x73\x65\162\x5f\151\x64")); goto fuawW; MR0hc: h8x4K: goto uHeIL; ip6ne: jDyRj: goto GDNK3; t6LyA: $this->trigger_events("\x69\156\x5f\x67\162\157\165\x70"); goto TSYR8; y6Gku: $check_group = [$check_group]; goto IgA5b; IgA5b: CaKTM: goto VSDBx; GDNK3: foreach ($check_group as $key => $value) { goto wKMpV; z4gX9: s4Znx: goto ui0fb; HY1_N: return !$check_all; goto lx3tl; lx3tl: xOTIE: goto z4gX9; yukJV: if (!(in_array($value, $groups) xor $check_all)) { goto xOTIE; } goto HY1_N; wKMpV: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto yukJV; ui0fb: } goto OZZnM; uHeIL: $this->_cache_user_in_group[$id] = $groups_array; goto rmS3p; H30Bt: $groups_array = []; goto t2rzg; I_k6S: return $check_all; goto gmAvA; gQj_u: OyBoo: goto cD06I; rmS3p: goto jDyRj; goto gQj_u; OZZnM: LTvp9: goto I_k6S; t2rzg: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; VfYaU: } goto MR0hc; LxK4h: $users_groups = $this->get_users_groups($id)->result(); goto H30Bt; gmAvA: } public function add_to_group($group_ids, $user_id = FALSE) { goto F4dpi; XjD_2: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\162\x5f\x69\144")); goto rfQ6S; F4dpi: $this->trigger_events("\141\144\x64\x5f\164\x6f\x5f\x67\x72\x6f\x75\x70"); goto XjD_2; WMWox: $return = 0; goto zgJNw; edb8W: L1AKS: goto ecmXR; ecmXR: return $return; goto Ylg4h; RN1p_: $group_ids = [$group_ids]; goto vhZLA; vhZLA: TOXas: goto WMWox; rfQ6S: if (is_array($group_ids)) { goto TOXas; } goto RN1p_; zgJNw: foreach ($group_ids as $group_id) { goto sqo76; Itw_o: $group_name = $this->_cache_groups[$group_id]; goto qTY0l; N4HQg: goto cnzK1; goto rwO9Q; qTY0l: cnzK1: goto c72j2; EPj5i: if (isset($this->_cache_groups[$group_id])) { goto tPUZ5; } goto IhEs8; rwO9Q: tPUZ5: goto Itw_o; IhEs8: $group = $this->group($group_id)->result(); goto BFk4F; FJkcm: $this->_cache_groups[$group_id] = $group_name; goto N4HQg; BFk4F: $group_name = $group[0]->name; goto FJkcm; hWQPp: nR3wy: goto Fc0qK; c72j2: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto vKzLh; vKzLh: $return++; goto Co4et; sqo76: if (!$this->db->insert($this->tables["\165\x73\145\x72\163\137\147\162\x6f\165\x70\x73"], [$this->join["\147\162\x6f\165\x70\x73"] => (float) $group_id, $this->join["\165\163\145\x72\163"] => (float) $user_id])) { goto GrcFo; } goto EPj5i; Co4et: GrcFo: goto hWQPp; Fc0qK: } goto edb8W; Ylg4h: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto mhiHn; wJs7B: goto qecJX; goto AlwJr; Jf1kc: return FALSE; goto Gc_LT; E_hr3: e2QIC: goto wJs7B; nVU08: $this->_cache_user_in_group[$user_id] = []; goto E_hr3; mjerI: $group_ids = [$group_ids]; goto m8kWU; Libwb: if (!empty($group_ids)) { goto byGTJ; } goto ar5Sf; NnBls: d3_qC: goto YNz9r; m7igK: if (is_array($group_ids)) { goto FVyey; } goto mjerI; RwQ2y: qecJX: goto jhjFB; m8kWU: FVyey: goto hN9GL; Gc_LT: V0vhp: goto Libwb; ar5Sf: if (!($return = $this->db->delete($this->tables["\165\x73\x65\162\163\x5f\147\162\x6f\x75\160\x73"], [$this->join["\165\163\x65\x72\163"] => (float) $user_id]))) { goto e2QIC; } goto nVU08; hN9GL: foreach ($group_ids as $group_id) { goto mt0KY; Bdn8y: aqTwA: goto cRDKb; Pn0eA: FCHd4: goto Bdn8y; FcoYX: unset($this->_cache_user_in_group[$user_id][$group_id]); goto Pn0eA; QIBVY: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto FCHd4; } goto FcoYX; mt0KY: $this->db->delete($this->tables["\x75\x73\145\162\x73\137\147\162\x6f\x75\160\163"], [$this->join["\147\x72\157\x75\x70\x73"] => (float) $group_id, $this->join["\165\x73\145\162\163"] => (float) $user_id]); goto QIBVY; cRDKb: } goto NnBls; jhjFB: return $return; goto VNfzO; mhiHn: $this->trigger_events("\162\145\x6d\157\166\x65\x5f\146\x72\x6f\155\137\x67\162\x6f\x75\160"); goto g2ko5; YNz9r: $return = TRUE; goto RwQ2y; g2ko5: if (!empty($user_id)) { goto V0vhp; } goto Jf1kc; AlwJr: byGTJ: goto m7igK; VNfzO: } public function groups() { goto J3Jm1; FJiBL: nC1yA: goto V88tQ; GINUU: foreach ($this->_ion_where as $where) { $this->db->where($where); e0irc: } goto FJiBL; m5iCA: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto nLde7; } goto ygH20; PqWxs: nLde7: goto JN_Tq; qPfkT: Gy3HL: goto rSqB7; r8NiP: JEyy4: goto B0w3V; UCUVu: $this->_ion_limit = NULL; goto darYH; darYH: w0H3u: goto yeT8T; f668U: zzD6o: goto m5iCA; B0w3V: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto Gy3HL; } goto OeVby; J3Jm1: $this->trigger_events("\x67\x72\157\x75\160\163"); goto LCz5Q; V88tQ: $this->_ion_where = []; goto f668U; P4Iom: $this->_ion_offset = NULL; goto r8NiP; OeVby: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto qPfkT; tT7_g: return $this; goto YOT1z; JN_Tq: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto ntrjK; ntrjK: $this->_ion_limit = NULL; goto P4Iom; yeT8T: goto JEyy4; goto PqWxs; uiRZ0: $this->db->limit($this->_ion_limit); goto UCUVu; LCz5Q: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto zzD6o; } goto GINUU; ygH20: if (!isset($this->_ion_limit)) { goto w0H3u; } goto uiRZ0; rSqB7: $this->response = $this->db->get($this->tables["\147\x72\x6f\x75\x70\163"]); goto tT7_g; YOT1z: } public function group($id = NULL) { goto Q4o5f; o60SI: $this->where($this->tables["\x67\162\x6f\x75\x70\163"] . "\56\151\144", $id); goto C6crT; UnSjh: if (!isset($id)) { goto DR32G; } goto o60SI; C6crT: DR32G: goto XiegY; XiegY: $this->limit(1); goto zIZGC; Q4o5f: $this->trigger_events("\x67\162\x6f\165\x70"); goto UnSjh; zIZGC: $this->order_by("\151\x64", "\x64\145\x73\143"); goto WJCA7; WJCA7: return $this->groups(); goto cPsEz; cPsEz: } public function update($id, array $data) { goto lg_dY; PUQoE: $this->db->trans_rollback(); goto AGfQS; CnjyZ: $user = $this->user($id)->row(); goto MjGxa; HiGpq: goto ncbPB; goto VQNex; EvXmy: $this->db->update($this->tables["\165\x73\145\162\163"], $data, ["\x69\144" => $user->id]); goto V4Bc2; HybcD: if (!($data["\x70\141\163\163\167\157\162\x64"] === FALSE)) { goto x_O4U; } goto pi7Ww; E69xB: $this->set_error("\165\160\144\141\x74\145\x5f\x75\x6e\163\165\143\x63\145\163\x73\146\165\154"); goto WLFBn; MoAFE: return TRUE; goto m8hCC; YN2U8: ncbPB: goto Bi0A_; MjGxa: $this->db->trans_begin(); goto XTweE; pi7Ww: $this->db->trans_rollback(); goto ohvny; DALWM: $this->trigger_events(["\x70\157\163\164\137\x75\x70\144\141\164\145\137\165\x73\x65\x72", "\160\157\163\164\x5f\165\160\x64\141\164\145\x5f\165\x73\x65\x72\x5f\163\165\x63\143\145\x73\163\146\x75\154"]); goto bOavF; mLt76: if (!empty($data["\x70\x61\x73\163\167\x6f\162\144"])) { goto EvLDb; } goto omxLp; giC9y: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\141\163\x73\167\x6f\162\144", $data) || array_key_exists("\145\x6d\x61\x69\154", $data))) { goto xrXKl; } goto FOkTw; V4Bc2: if (!($this->db->trans_status() === FALSE)) { goto ZxHbF; } goto PUQoE; Ilw8e: $this->db->trans_rollback(); goto CW8ds; kyCbK: x_O4U: goto YN2U8; lcF3B: $this->trigger_events("\x65\170\x74\x72\x61\137\167\150\x65\x72\145"); goto EvXmy; CW8ds: $this->set_error("\141\143\143\x6f\165\156\x74\x5f\x63\x72\145\141\164\151\x6f\x6e\137\x64\165\160\154\151\x63\141\164\x65\x5f\x69\x64\x65\x6e\x74\x69\x74\x79"); goto GZ5DI; vqCHO: ZxHbF: goto LPTNN; bOavF: $this->set_message("\165\x70\x64\141\164\145\x5f\163\x75\143\x63\145\163\x73\146\x75\x6c"); goto MoAFE; AGfQS: $this->trigger_events(["\160\x6f\163\x74\137\x75\x70\144\x61\x74\145\x5f\x75\x73\145\x72", "\160\x6f\x73\164\137\x75\x70\144\x61\164\145\x5f\x75\163\145\162\x5f\x75\x6e\163\165\143\x63\145\163\163\x66\165\154"]); goto F3gZd; GZ5DI: $this->trigger_events(["\160\x6f\163\x74\x5f\165\x70\144\141\164\x65\137\165\163\145\x72", "\160\x6f\163\x74\x5f\x75\160\144\x61\x74\x65\137\165\163\x65\162\x5f\165\156\163\165\x63\x63\x65\x73\x73\x66\x75\x6c"]); goto QS4L2; FOkTw: if (!array_key_exists("\160\x61\163\x73\x77\157\x72\144", $data)) { goto tOWBf; } goto mLt76; ohvny: $this->trigger_events(["\x70\157\x73\164\x5f\165\x70\144\141\164\x65\x5f\x75\163\x65\162", "\x70\157\x73\164\137\x75\x70\144\141\x74\x65\137\165\163\x65\x72\x5f\x75\156\163\x75\x63\143\x65\x73\x73\x66\165\x6c"]); goto E69xB; Bi0A_: tOWBf: goto St_Td; VQNex: EvLDb: goto hsqQb; f02s3: return FALSE; goto vqCHO; lg_dY: $this->trigger_events("\160\x72\x65\137\x75\x70\x64\141\x74\145\137\165\163\145\162"); goto CnjyZ; KUVSS: return FALSE; goto bzk85; QS4L2: $this->set_error("\165\160\144\141\x74\145\x5f\x75\156\163\x75\143\143\145\x73\163\146\x75\154"); goto KUVSS; Wl6b9: $data = $this->_filter_data($this->tables["\165\x73\145\x72\163"], $data); goto giC9y; LPTNN: $this->db->trans_commit(); goto DALWM; WLFBn: return FALSE; goto kyCbK; XTweE: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto Ju8Gh; } goto Ilw8e; F3gZd: $this->set_error("\x75\160\x64\141\x74\x65\137\165\156\163\165\143\x63\x65\x73\163\146\x75\154"); goto f02s3; bzk85: Ju8Gh: goto Wl6b9; hsqQb: $data["\160\141\163\x73\x77\x6f\162\144"] = $this->hash_password($data["\160\141\x73\163\167\x6f\x72\x64"], $user->{$this->identity_column}); goto HybcD; St_Td: xrXKl: goto lcF3B; omxLp: unset($data["\x70\x61\x73\163\x77\x6f\x72\144"]); goto HiGpq; m8hCC: } public function delete_user($id) { goto HE4go; d1b3_: $this->remove_from_group(NULL, $id); goto A0WVC; qj1hA: $this->set_message("\144\x65\154\x65\164\145\x5f\x73\165\143\x63\x65\163\163\146\x75\154"); goto jqG6i; XIXq5: if (!($this->db->trans_status() === FALSE)) { goto UGRo3; } goto jqnp1; jqG6i: return TRUE; goto L5rea; OUOee: $this->trigger_events(["\x70\x6f\163\x74\137\x64\145\154\145\164\x65\137\x75\163\x65\x72", "\x70\x6f\x73\164\137\144\x65\154\x65\x74\145\137\165\163\x65\x72\137\163\165\x63\143\x65\x73\x73\146\x75\x6c"]); goto qj1hA; A0WVC: $this->db->delete($this->tables["\165\163\x65\x72\x73"], ["\x69\144" => $id]); goto XIXq5; e6ti3: UGRo3: goto pplJi; uwvU7: $this->trigger_events(["\x70\x6f\163\164\137\x64\145\154\x65\x74\145\137\x75\x73\x65\x72", "\160\x6f\163\x74\137\x64\145\154\x65\x74\x65\x5f\165\x73\x65\x72\x5f\x75\156\163\165\143\143\145\163\163\x66\x75\x6c"]); goto PUAxa; HE4go: $this->trigger_events("\160\162\x65\x5f\x64\145\x6c\145\164\145\137\165\x73\145\162"); goto ODrAi; pplJi: $this->db->trans_commit(); goto OUOee; BOeru: return FALSE; goto e6ti3; jqnp1: $this->db->trans_rollback(); goto uwvU7; ODrAi: $this->db->trans_begin(); goto d1b3_; PUAxa: $this->set_error("\x64\145\154\x65\164\x65\137\165\156\x73\x75\143\x63\x65\163\163\146\165\x6c"); goto BOeru; L5rea: } public function update_last_login($id) { goto GrMCL; lYWCe: $this->load->helper("\x64\141\x74\x65"); goto T45jp; wiyqL: $this->db->update($this->tables["\x75\x73\145\x72\x73"], ["\154\141\x73\164\x5f\154\157\147\x69\x6e" => time()], ["\x69\x64" => $id]); goto c74fY; T45jp: $this->trigger_events("\x65\x78\164\162\x61\x5f\167\x68\x65\x72\x65"); goto wiyqL; c74fY: return $this->db->affected_rows() == 1; goto vC18o; GrMCL: $this->trigger_events("\165\x70\144\141\x74\145\x5f\x6c\x61\163\164\137\x6c\x6f\x67\151\156"); goto lYWCe; vC18o: } public function set_lang($lang = "\x65\156") { goto ljb5E; ljb5E: $this->trigger_events("\163\x65\x74\137\154\x61\156\x67"); goto ZaMhh; zSUTO: return TRUE; goto sOGcD; rA8TU: goto LFFCO; goto FO0gx; k97df: LFFCO: goto n5Lsb; ZaMhh: if ($this->config->item("\x75\x73\x65\162\x5f\x65\x78\160\x69\x72\145", "\151\x6f\156\x5f\x61\165\164\150") === 0) { goto rDOel; } goto TNcjQ; LFSLE: $expire = self::MAX_COOKIE_LIFETIME; goto k97df; FO0gx: rDOel: goto LFSLE; n5Lsb: set_cookie(["\x6e\x61\155\x65" => "\x6c\141\x6e\x67\x5f\x63\x6f\144\x65", "\x76\x61\154\165\x65" => $lang, "\x65\x78\x70\151\x72\x65" => $expire]); goto zSUTO; TNcjQ: $expire = $this->config->item("\x75\x73\145\x72\x5f\145\x78\x70\x69\x72\145", "\x69\157\x6e\137\x61\165\x74\150"); goto rA8TU; sOGcD: } public function set_session($user) { goto E1esn; t015V: $this->session->set_userdata($session_data); goto Ienwm; xm92C: return TRUE; goto ZR2qM; pB6TN: $session_data = ["\151\144\x65\156\164\x69\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\x69\154" => $user->email, "\x75\163\145\162\137\x69\144" => $user->id, "\x6f\154\x64\x5f\154\141\163\x74\x5f\x6c\x6f\x67\x69\156" => $user->last_login, "\154\x61\163\164\x5f\x63\150\x65\x63\x6b" => time()]; goto t015V; E1esn: $this->trigger_events("\160\162\x65\x5f\x73\x65\164\137\x73\x65\x73\163\151\157\x6e"); goto pB6TN; Ienwm: $this->trigger_events("\160\157\x73\x74\137\163\145\164\x5f\x73\x65\x73\163\151\157\x6e"); goto xm92C; ZR2qM: } public function remember_user($identity) { goto z4EMm; i_159: $expire = $this->config->item("\x75\163\x65\x72\137\145\170\160\x69\162\145", "\x69\x6f\x6e\x5f\x61\x75\164\150"); goto EQqqi; MtcSd: return TRUE; goto vyYdr; lg8m5: diZd1: goto otJq0; NZDtn: kwhx8: goto G4GaP; auE7D: $this->db->update($this->tables["\x75\x73\145\x72\x73"], ["\x72\x65\155\x65\x6d\142\145\x72\137\163\x65\x6c\145\x63\x74\157\x72" => $token->selector, "\162\x65\155\145\x6d\x62\145\x72\x5f\143\x6f\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto Al3L5; wsB0T: if (!$token->validator_hashed) { goto d3l8K; } goto auE7D; tp96o: DdQvT: goto WVha6; ltpRc: return FALSE; goto KYzHu; ZM5bR: if ($identity) { goto diZd1; } goto Q1rxX; Q1rxX: return FALSE; goto lg8m5; G4GaP: $expire = self::MAX_COOKIE_LIFETIME; goto tp96o; mUouT: $this->trigger_events(["\160\157\163\164\137\x72\x65\x6d\x65\x6d\142\145\162\137\165\163\145\162", "\162\x65\155\145\155\142\x65\162\137\x75\x73\x65\x72\137\165\156\163\165\x63\x63\145\x73\x73\x66\165\x6c"]); goto ltpRc; EQqqi: goto DdQvT; goto NZDtn; Al3L5: if (!($this->db->affected_rows() > -1)) { goto rSZvY; } goto inbvF; otJq0: $token = $this->_generate_selector_validator_couple(); goto wsB0T; vyYdr: rSZvY: goto j0C05; li13I: $this->trigger_events(["\160\x6f\x73\164\x5f\x72\x65\155\145\155\142\x65\162\137\x75\x73\145\162", "\162\x65\155\x65\x6d\142\x65\x72\x5f\165\163\x65\162\x5f\163\x75\143\x63\x65\x73\163\x66\x75\x6c"]); goto MtcSd; inbvF: if ($this->config->item("\165\163\145\x72\x5f\x65\x78\x70\151\x72\145", "\151\x6f\156\137\141\x75\164\x68") === 0) { goto kwhx8; } goto i_159; WVha6: set_cookie(["\156\141\x6d\145" => $this->config->item("\x72\x65\x6d\145\x6d\x62\145\x72\137\143\x6f\157\153\151\x65\x5f\156\x61\x6d\145", "\x69\x6f\x6e\x5f\141\165\164\x68"), "\x76\x61\154\x75\x65" => $token->user_code, "\145\x78\x70\151\162\x65" => $expire]); goto li13I; j0C05: d3l8K: goto mUouT; z4EMm: $this->trigger_events("\160\162\x65\x5f\162\x65\x6d\145\x6d\x62\145\x72\137\x75\163\x65\162"); goto ZM5bR; KYzHu: } public function login_remembered_user() { goto Jr5N0; nEY7L: $this->update_last_login($user->id); goto f4HJ4; PGo15: OTORL: goto KHZmx; UedC9: ZK3y3: goto Ozcrp; Ozcrp: $this->trigger_events("\145\x78\164\x72\141\137\167\x68\x65\162\145"); goto cu6wP; R0BbS: if (!($query->num_rows() === 1)) { goto qpk3y; } goto BdM3i; Y6pSp: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto qnpg3; } goto nEY7L; WbmIb: $this->trigger_events(["\160\x6f\163\164\137\154\157\x67\151\x6e\x5f\162\x65\x6d\145\x6d\x62\x65\162\x65\144\137\x75\163\x65\162", "\160\157\x73\x74\137\154\x6f\x67\x69\156\137\x72\145\x6d\x65\155\142\x65\x72\x65\144\x5f\165\163\x65\162\137\x73\165\143\x63\x65\163\163\x66\x75\154"]); goto iOkKN; Jr5N0: $this->trigger_events("\x70\x72\x65\x5f\154\x6f\x67\x69\156\x5f\162\145\x6d\145\x6d\142\x65\x72\x65\144\137\165\163\145\x72"); goto QvudQ; BdM3i: $user = $query->row(); goto qY1mW; BupCY: $this->trigger_events(["\x70\157\163\x74\137\154\157\147\x69\x6e\x5f\x72\145\155\x65\155\x62\x65\162\x65\x64\137\165\x73\145\162", "\x70\157\163\x74\x5f\x6c\x6f\147\x69\x6e\137\x72\145\155\x65\x6d\x62\145\162\x65\144\x5f\x75\x73\x65\x72\x5f\x75\x6e\163\165\143\x63\145\163\x73\146\165\154"]); goto jFtez; s0zUG: qpk3y: goto USMIw; iOkKN: return TRUE; goto u5NxM; jFtez: return FALSE; goto UedC9; KHZmx: $this->session->sess_regenerate(FALSE); goto WbmIb; MkDm6: if (!($token === FALSE)) { goto ZK3y3; } goto BupCY; cu6wP: $query = $this->db->select($this->identity_column . "\54\x20\x69\144\x2c\x20\x65\155\x61\x69\154\54\40\162\145\x6d\145\155\x62\x65\162\137\x63\x6f\x64\x65\x2c\x20\154\x61\163\164\x5f\154\x6f\147\x69\x6e")->where("\162\x65\x6d\x65\x6d\142\x65\162\x5f\163\x65\154\x65\143\x74\157\x72", $token->selector)->where("\141\143\164\151\166\145", 1)->limit(1)->get($this->tables["\x75\x73\145\x72\163"]); goto R0BbS; OGzwg: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto MkDm6; USMIw: delete_cookie($this->config->item("\162\145\155\x65\x6d\142\x65\x72\x5f\x63\157\157\153\151\145\137\156\141\155\145", "\151\157\156\137\141\165\164\150")); goto rZc6Y; qY1mW: $identity = $user->{$this->identity_column}; goto Y6pSp; QvudQ: $remember_cookie = get_cookie($this->config->item("\x72\x65\155\x65\x6d\142\145\162\x5f\143\x6f\x6f\x6b\151\x65\x5f\x6e\x61\155\145", "\151\157\156\137\x61\x75\x74\x68")); goto OGzwg; YjM7j: if (!$this->config->item("\165\x73\x65\162\137\x65\170\164\x65\156\x64\x5f\157\156\x5f\154\x6f\x67\x69\156", "\x69\x6f\x6e\137\x61\165\x74\x68")) { goto OTORL; } goto H3foa; H3foa: $this->remember_user($identity); goto PGo15; f4HJ4: $this->set_session($user); goto KtHWL; u5NxM: qnpg3: goto s0zUG; Q8Ysb: return FALSE; goto ncWKK; rZc6Y: $this->trigger_events(["\x70\x6f\x73\164\137\x6c\157\147\x69\x6e\x5f\162\145\155\145\155\142\x65\162\145\x64\x5f\x75\x73\145\x72", "\x70\157\x73\x74\x5f\x6c\x6f\147\151\156\x5f\x72\x65\155\x65\155\x62\145\x72\x65\x64\137\165\163\x65\x72\137\x75\156\163\165\143\x63\x65\163\163\x66\165\154"]); goto Q8Ysb; KtHWL: $this->clear_forgotten_password_code($identity); goto YjM7j; ncWKK: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto pDVdn; c9Bum: return $group_id; goto LMPe0; aHQp1: if (empty($additional_data)) { goto PyCd7; } goto P3ocr; zC_Lc: $this->trigger_events("\x65\170\164\162\x61\x5f\x67\x72\x6f\x75\x70\x5f\163\145\x74"); goto AslYV; FJuUF: return FALSE; goto rp9Sa; o8WlD: $group_id = $this->db->insert_id($this->tables["\x67\x72\x6f\x75\x70\163"] . "\137\151\144\x5f\163\145\161"); goto b4H5G; KEx7X: Zb_kM: goto iq18b; rp9Sa: ZJ17k: goto DZmN1; tN6NV: $this->set_error("\147\162\157\x75\160\137\156\141\x6d\145\x5f\x72\x65\161\x75\151\x72\145\144"); goto fog8u; iq18b: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\165\x70\x73"], ["\156\x61\x6d\145" => $group_name])->num_rows(); goto q_d2_; b4H5G: $this->set_message("\147\162\x6f\x75\160\x5f\x63\x72\145\x61\x74\x69\157\156\x5f\163\x75\x63\x63\145\x73\x73\146\165\x6c"); goto c9Bum; Zy9TY: $this->set_error("\x67\x72\157\x75\x70\x5f\141\x6c\162\x65\141\144\x79\137\145\x78\151\163\164\163"); goto FJuUF; q_d2_: if (!($existing_group !== 0)) { goto ZJ17k; } goto Zy9TY; MuTNy: PyCd7: goto zC_Lc; P3ocr: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\x75\160\163"], $additional_data), $data); goto MuTNy; DZmN1: $data = ["\x6e\141\x6d\x65" => $group_name, "\x64\145\163\143\162\151\x70\164\151\x6f\x6e" => $group_description]; goto aHQp1; pDVdn: if ($group_name) { goto Zb_kM; } goto tN6NV; fog8u: return FALSE; goto KEx7X; AslYV: $this->db->insert($this->tables["\147\162\x6f\165\160\x73"], $data); goto o8WlD; LMPe0: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto uHBAv; Jc5if: K77p6: goto JJsA3; mrr_E: $this->set_error("\x67\x72\x6f\165\160\x5f\156\x61\x6d\x65\x5f\141\144\155\151\x6e\x5f\156\x6f\164\x5f\141\154\x74\145\x72"); goto LYegJ; uHBAv: if (!empty($group_id)) { goto cJVYw; } goto vaDMy; C6CsJ: return FALSE; goto vhvAY; PRGxU: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto wWzDr; } goto MKJTy; ES8JW: $this->set_message("\x67\x72\x6f\165\x70\x5f\165\x70\x64\141\164\145\x5f\x73\165\143\143\x65\x73\x73\x66\165\154"); goto pWFoE; JJsA3: if (empty($additional_data)) { goto k9643; } goto bqBAM; f4xSW: $this->db->update($this->tables["\x67\x72\x6f\x75\160\163"], $data, ["\x69\144" => $group_id]); goto ES8JW; jh9LA: $group = $this->db->get_where($this->tables["\147\162\x6f\x75\160\163"], ["\151\144" => $group_id])->row(); goto sMLXM; CVhkc: $existing_group = $this->db->get_where($this->tables["\147\162\157\x75\160\163"], ["\156\141\x6d\145" => $group_name])->row(); goto PRGxU; LYegJ: return FALSE; goto Jc5if; tdBmK: if (empty($group_name)) { goto qukOz; } goto CVhkc; PQkdN: cJVYw: goto zrDTY; UYVzw: qukOz: goto jh9LA; sMLXM: if (!($this->config->item("\141\144\x6d\151\156\137\147\x72\x6f\165\x70", "\x69\x6f\156\x5f\x61\x75\164\x68") === $group->name && $group_name !== $group->name)) { goto K77p6; } goto mrr_E; vaDMy: return FALSE; goto PQkdN; bqBAM: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\x75\x70\163"], $additional_data), $data); goto e0s7_; pWFoE: return TRUE; goto NsAqn; MKJTy: $this->set_error("\x67\x72\157\x75\x70\137\x61\x6c\162\x65\141\144\171\x5f\145\170\x69\163\164\x73"); goto C6CsJ; zrDTY: $data = []; goto tdBmK; OOZ5P: $data["\156\141\x6d\x65"] = $group_name; goto UYVzw; vhvAY: wWzDr: goto OOZ5P; e0s7_: k9643: goto f4xSW; NsAqn: } public function delete_group($group_id = FALSE) { goto Qqx6g; fDsWQ: $this->trigger_events(["\x70\x6f\163\164\x5f\x64\x65\154\145\164\145\x5f\x67\162\x6f\165\160", "\x70\157\163\x74\x5f\144\145\154\x65\x74\x65\x5f\147\x72\157\165\x70\137\163\x75\143\x63\x65\163\x73\x66\165\154"]); goto AJpBe; AJpBe: $this->set_message("\147\x72\157\165\x70\137\x64\145\154\145\x74\145\137\x73\165\143\143\x65\163\x73\146\165\x6c"); goto OifoI; M91_O: if (!($this->db->trans_status() === FALSE)) { goto G6APo; } goto KjNC1; XOmcu: if (!($group->name == $this->config->item("\x61\144\155\x69\156\137\x67\x72\x6f\x75\160", "\151\x6f\156\137\141\x75\x74\150"))) { goto aMfrl; } goto VsEAh; IjaEZ: return FALSE; goto LhlNA; IeXqP: $this->db->delete($this->tables["\x67\162\x6f\165\160\163"], ["\x69\144" => $group_id]); goto M91_O; j_dn7: $this->set_error("\147\x72\x6f\165\x70\137\x64\x65\x6c\x65\x74\x65\137\x75\x6e\163\165\x63\143\x65\x73\x73\x66\x75\154"); goto IjaEZ; KjNC1: $this->db->trans_rollback(); goto GQQMI; ixBPO: OcMYW: goto aLIt7; FRVKv: return FALSE; goto ixBPO; aLIt7: $group = $this->group($group_id)->row(); goto XOmcu; OifoI: return TRUE; goto ytA5z; oZJW7: $this->trigger_events("\160\162\x65\137\x64\145\154\x65\164\x65\x5f\147\x72\157\x75\160"); goto bhzZK; P3M4y: $this->set_error("\x67\162\x6f\x75\x70\x5f\144\145\x6c\x65\164\145\x5f\156\x6f\164\141\x6c\x6c\x6f\167\145\144"); goto SBdVI; GQQMI: $this->trigger_events(["\160\157\163\164\137\x64\145\x6c\x65\164\x65\137\147\x72\x6f\x75\x70", "\160\x6f\x73\164\137\144\x65\154\x65\164\x65\x5f\147\x72\157\x75\x70\x5f\165\x6e\163\165\x63\143\145\x73\x73\146\165\154"]); goto j_dn7; bhzZK: $this->db->trans_begin(); goto La5Jc; VsEAh: $this->trigger_events(["\160\x6f\x73\x74\137\144\x65\x6c\x65\x74\145\137\147\162\x6f\x75\160", "\160\x6f\x73\x74\x5f\x64\x65\154\x65\164\x65\x5f\147\162\157\165\x70\x5f\156\x6f\x74\x61\154\154\x6f\x77\x65\144"]); goto P3M4y; Qqx6g: if (!(!$group_id || empty($group_id))) { goto OcMYW; } goto FRVKv; SBdVI: return FALSE; goto NbTe0; AWzQ3: $this->db->trans_commit(); goto fDsWQ; NbTe0: aMfrl: goto oZJW7; LhlNA: G6APo: goto AWzQ3; La5Jc: $this->db->delete($this->tables["\165\x73\145\x72\x73\x5f\147\162\x6f\x75\x70\163"], [$this->join["\x67\x72\157\165\x70\163"] => $group_id]); goto IeXqP; ytA5z: } public function set_hook($event, $name, $class, $method, $arguments) { goto mvNFM; gMq2d: $this->_ion_hooks->{$event}[$name]->class = $class; goto hXels; hXels: $this->_ion_hooks->{$event}[$name]->method = $method; goto oqSVm; oqSVm: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto Dhwjx; mvNFM: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto gMq2d; Dhwjx: } public function remove_hook($event, $name) { goto nJiUD; IHBD7: unset($this->_ion_hooks->{$event}[$name]); goto mImth; nJiUD: if (!isset($this->_ion_hooks->{$event}[$name])) { goto u_bDu; } goto IHBD7; mImth: u_bDu: goto g2NhO; g2NhO: } public function remove_hooks($event) { goto rKBLB; OwMx7: unset($this->_ion_hooks->{$event}); goto IRidd; IRidd: FQhIQ: goto sIy0g; rKBLB: if (!isset($this->_ion_hooks->{$event})) { goto FQhIQ; } goto OwMx7; sIy0g: } protected function _call_hook($event, $name) { goto hlmyq; yJXxX: qbHX0: goto pBiTO; qFYH2: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto yJXxX; pBiTO: return FALSE; goto ifB9T; dM95Y: $hook = $this->_ion_hooks->{$event}[$name]; goto qFYH2; hlmyq: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto qbHX0; } goto dM95Y; ifB9T: } public function trigger_events($events) { goto ahbWh; CW5MW: goto NVpRJ; goto WQ8_4; QdFJI: eBTOn: goto F2cbW; daL5A: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); gDMfY: } goto HaauR; OP2no: foreach ($events as $event) { $this->trigger_events($event); zDUNQ: } goto QdFJI; Pg3Mf: web09: goto CW5MW; HaauR: JLnrq: goto Pg3Mf; ahbWh: if (is_array($events) && !empty($events)) { goto IN82W; } goto MZh5r; WQ8_4: IN82W: goto OP2no; MZh5r: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto web09; } goto daL5A; F2cbW: NVpRJ: goto mRQh_; mRQh_: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto wwKvB; NmGJv: return TRUE; goto AoCXj; wwKvB: $this->message_start_delimiter = $start_delimiter; goto J5NPS; J5NPS: $this->message_end_delimiter = $end_delimiter; goto NmGJv; AoCXj: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto GQO1G; GQO1G: $this->error_start_delimiter = $start_delimiter; goto AZiZu; h3tab: return TRUE; goto zHWwA; AZiZu: $this->error_end_delimiter = $end_delimiter; goto h3tab; zHWwA: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto FA6iP; FA6iP: $_output = ''; goto YlLhw; YlLhw: foreach ($this->messages as $message) { goto ZZPBI; kmWGb: MmEKR: goto FD10p; fWyr8: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto kmWGb; ZZPBI: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto fWyr8; FD10p: } goto CnxyQ; mGVvp: return $_output; goto lVsf7; CnxyQ: oaWmb: goto mGVvp; lVsf7: } public function messages_array($langify = TRUE) { goto TQNFd; gd03M: $_output = []; goto Zm2Pz; Zm2Pz: foreach ($this->messages as $message) { goto EB4ts; tfFMJ: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto ydlKP; ydlKP: H6igx: goto hi330; EB4ts: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\43"; goto tfFMJ; hi330: } goto TG8FI; TG8FI: VzNs8: goto N5Uxn; N5Uxn: return $_output; goto PANBX; TQNFd: if ($langify) { goto UiMaS; } goto p46iV; p46iV: return $this->messages; goto izqNH; izqNH: goto G0ziU; goto AX_zG; AX_zG: UiMaS: goto gd03M; PANBX: G0ziU: goto JzT0X; JzT0X: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto MiLPS; wvgHo: aCVH_: goto Wqmu5; jc_Ig: foreach ($this->errors as $error) { goto kgO1i; Lvqqr: P4X1K: goto tvLPl; kk3rM: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto Lvqqr; kgO1i: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\43"; goto kk3rM; tvLPl: } goto wvgHo; Wqmu5: return $_output; goto IXfVL; MiLPS: $_output = ''; goto jc_Ig; IXfVL: } public function errors_array($langify = TRUE) { goto uZ_DW; bst97: $_output = []; goto S4XEZ; TW5MV: return $_output; goto SgKzI; KBFpz: csavb: goto TW5MV; g8sRM: goto SwVwf; goto goovM; goovM: MG46h: goto bst97; S4XEZ: foreach ($this->errors as $error) { goto VKg7w; VKg7w: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\43"; goto I8L7t; R0vcL: gj_HI: goto cGwYR; I8L7t: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto R0vcL; cGwYR: } goto KBFpz; E5IvE: return $this->errors; goto g8sRM; SgKzI: SwVwf: goto gt2Nf; uZ_DW: if ($langify) { goto MG46h; } goto E5IvE; gt2Nf: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto qRQaF; lOza9: if (!($hash === FALSE)) { goto WFFny; } goto LoXfs; snAMJ: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto xlhrm; xlhrm: return $this->db->affected_rows() == 1; goto M2k5n; qRQaF: $hash = $this->hash_password($password, $identity); goto lOza9; d15fu: WFFny: goto Q2yGQ; LoXfs: return FALSE; goto d15fu; r_rs2: $this->trigger_events("\145\170\164\x72\141\137\167\150\x65\x72\145"); goto snAMJ; Q2yGQ: $data = ["\160\141\163\x73\x77\x6f\x72\x64" => $hash, "\x72\145\x6d\x65\155\x62\x65\x72\137\x63\157\x64\x65" => NULL, "\x66\157\x72\147\157\164\x74\145\156\137\x70\141\x73\163\167\157\x72\x64\x5f\143\157\144\x65" => NULL, "\146\x6f\162\x67\157\x74\x74\145\156\x5f\160\x61\x73\x73\167\x6f\x72\x64\137\x74\151\155\145" => NULL]; goto r_rs2; M2k5n: } protected function _filter_data($table, $data) { goto V2CiX; DGC76: foreach ($columns as $column) { goto jxdsR; mu6pg: uOIr2: goto b9QqJ; b9QqJ: ItWuF: goto az21A; jxdsR: if (!array_key_exists($column, $data)) { goto uOIr2; } goto XAPYq; XAPYq: $filtered_data[$column] = $data[$column]; goto mu6pg; az21A: } goto IZR81; B2ezE: $columns = $this->db->list_fields($table); goto PhxRb; DdsY8: FyK50: goto BxRB_; V2CiX: $filtered_data = []; goto B2ezE; PhxRb: if (!is_array($data)) { goto FyK50; } goto DGC76; IZR81: qKwAm: goto DdsY8; BxRB_: return $filtered_data; goto RDFZ2; RDFZ2: } protected function _random_token($result_length = 32) { goto RpnLo; cPLRN: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto xhzmx; hneN_: return FALSE; goto CrAo7; P_D0R: wkbU5: goto x0VcX; Myukv: CDAnz: goto FwcVZ; wByY1: return bin2hex(random_bytes($result_length / 2)); goto P_D0R; c9AJ_: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto ZO2ge; x0VcX: if (!function_exists("\155\143\x72\171\x70\164\x5f\x63\162\145\x61\x74\x65\x5f\151\166")) { goto awK1y; } goto cPLRN; RpnLo: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto CDAnz; } goto DgmNU; k0fYO: if (!function_exists("\157\x70\x65\156\163\163\x6c\x5f\x72\141\156\x64\157\x6d\137\160\163\145\x75\144\157\137\x62\x79\x74\x65\x73")) { goto nQQXn; } goto c9AJ_; FwcVZ: if (!function_exists("\x72\x61\156\x64\157\x6d\x5f\x62\171\x74\x65\x73")) { goto wkbU5; } goto wByY1; DgmNU: $result_length = 32; goto Myukv; xhzmx: awK1y: goto k0fYO; ZO2ge: nQQXn: goto hneN_; CrAo7: } protected function _get_hash_parameters($identity = NULL) { goto d7k3D; mhQbq: RuNI3: goto BDNJN; E0Cen: $is_admin = TRUE; goto Wn7LT; BDNJN: HAB0x: goto aJcD2; Wn7LT: Cc6xf: goto w5NZP; nx4Di: switch ($this->hash_method) { case "\x62\143\x72\x79\x70\x74": $params = ["\x63\x6f\163\x74" => $is_admin ? $this->config->item("\142\x63\x72\x79\160\164\x5f\x61\x64\155\x69\x6e\x5f\x63\x6f\x73\164", "\x69\157\x6e\137\141\165\x74\x68") : $this->config->item("\142\x63\162\171\160\x74\137\x64\x65\146\141\x75\x6c\164\x5f\143\157\x73\x74", "\151\x6f\156\137\141\165\164\150")]; goto HAB0x; case "\x61\162\147\157\x6e\62": $params = $is_admin ? $this->config->item("\x61\162\x67\157\x6e\62\137\x61\x64\x6d\x69\x6e\137\160\x61\x72\x61\x6d\x73", "\151\157\156\x5f\141\x75\164\x68") : $this->config->item("\141\x72\147\157\156\x32\137\x64\x65\x66\x61\165\154\164\x5f\160\x61\162\141\155\x73", "\151\157\156\x5f\141\165\x74\150"); goto HAB0x; default: } goto mhQbq; OkXZe: if (!$identity) { goto iQyuN; } goto OgVsv; aJcD2: return $params; goto P1R6U; d7k3D: $is_admin = FALSE; goto OkXZe; JWp0f: if (!($user_id && $this->in_group($this->config->item("\141\144\155\151\x6e\137\147\162\x6f\x75\x70", "\x69\x6f\156\x5f\x61\165\x74\x68"), $user_id))) { goto Cc6xf; } goto E0Cen; w5NZP: iQyuN: goto kqgrA; kqgrA: $params = FALSE; goto nx4Di; OgVsv: $user_id = $this->get_user_id_from_identity($identity); goto JWp0f; P1R6U: } protected function _get_hash_algo() { goto gp_yk; o89p1: gHeIS: goto XibaV; NBGAo: gxYax: goto o89p1; XibaV: return $algo; goto gMxCa; wmB2q: switch ($this->hash_method) { case "\142\143\162\x79\160\x74": $algo = PASSWORD_BCRYPT; goto gHeIS; case "\141\x72\x67\157\x6e\62": $algo = PASSWORD_ARGON2I; goto gHeIS; default: } goto NBGAo; gp_yk: $algo = FALSE; goto wmB2q; gMxCa: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto gjBok; Aoq_M: $validator = $this->_random_token($validator_size); goto CKlFq; gjBok: $selector = $this->_random_token($selector_size); goto Aoq_M; O3Xb0: $user_code = "{$selector}\x2e{$validator}"; goto frEdx; frEdx: return (object) ["\x73\x65\154\x65\x63\164\x6f\162" => $selector, "\166\x61\x6c\x69\x64\x61\x74\157\162\x5f\150\x61\x73\150\145\x64" => $validator_hashed, "\165\x73\x65\162\x5f\x63\157\144\145" => $user_code]; goto K24ew; CKlFq: $validator_hashed = $this->hash_password($validator); goto O3Xb0; K24ew: } protected function _retrieve_selector_validator_couple($user_code) { goto XzWgt; oplwr: jeZSa: goto bxTOG; s7QrJ: if (!(count($tokens) === 2)) { goto Cxqkr; } goto JtJVk; JtJVk: return (object) ["\x73\x65\154\x65\x63\164\x6f\162" => $tokens[0], "\166\141\x6c\x69\x64\x61\x74\157\162" => $tokens[1]]; goto oZN0q; XzWgt: if (!$user_code) { goto jeZSa; } goto fkz2U; fkz2U: $tokens = explode("\x2e", $user_code); goto s7QrJ; oZN0q: Cxqkr: goto oplwr; bxTOG: return FALSE; goto Lncd2; Lncd2: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto NDTyO; GZy4E: e5hU6: goto vxvEF; D_rl6: $this->trigger_events(["\x70\x6f\163\x74\137\x73\x68\x61\61\x5f\x70\141\x73\x73\x77\x6f\x72\144\x5f\x6d\151\x67\162\141\x74\151\x6f\156", "\160\157\163\164\137\163\150\141\61\137\x70\x61\x73\163\167\x6f\162\144\137\x6d\x69\x67\x72\141\x74\151\x6f\x6e\137\x75\156\x73\165\x63\x63\145\163\x73\146\165\x6c"]); goto x3PvV; piJyZ: goto PuIj1; goto EFfgn; pHO6L: vp5gF: goto xAvRJ; xAvRJ: $hashed_password = sha1($password . $salt_db->salt); goto qTOaq; kMXS9: $query = $this->db->select("\x73\141\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto RtQ1f; qkLpu: goto gub6P; goto dIGoK; dJQr1: if ($hashed_password === $hashed_password_db) { goto Y6IFD; } goto yca1l; W1Fss: if ($salt_length) { goto vpsY1; } goto P6K40; NDTyO: $this->trigger_events("\160\162\145\137\163\150\x61\x31\x5f\160\141\163\x73\x77\x6f\162\x64\x5f\x6d\x69\147\162\141\x74\151\157\156"); goto ak9QT; qTOaq: gub6P: goto dJQr1; kDD4r: h8bpk: goto ZROHI; dIGoK: gtWIP: goto kMXS9; zuQ8G: $result = $this->_set_password_db($identity, $password); goto UlxXp; Rte6u: vpsY1: goto c2OsD; Pvm0z: if (!($query->num_rows() !== 1)) { goto vp5gF; } goto D_rl6; x3PvV: return FALSE; goto pHO6L; gSpJQ: goto h8bpk; goto GZy4E; P6K40: $this->trigger_events(["\160\x6f\163\x74\x5f\x73\x68\141\x31\x5f\x70\141\x73\x73\x77\157\162\144\x5f\155\x69\147\162\141\x74\x69\x6f\x6e", "\160\157\163\164\137\x73\x68\141\x31\137\160\x61\163\x73\x77\x6f\x72\144\x5f\x6d\x69\x67\x72\141\164\x69\x6f\156\x5f\x75\156\163\x75\x63\143\x65\x73\x73\146\165\154"]); goto kxvqE; ak9QT: if ($this->config->item("\163\164\157\x72\145\x5f\163\x61\x6c\x74", "\x69\157\156\137\141\x75\x74\x68")) { goto gtWIP; } goto lhFFd; Zk53b: return FALSE; goto piJyZ; lhFFd: $salt_length = $this->config->item("\163\141\x6c\164\x5f\154\x65\156\x67\x74\x68", "\151\x6f\x6e\137\141\x75\164\150"); goto W1Fss; sbnCI: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto qkLpu; ec31D: PuIj1: goto YL0o2; yFXAt: $this->trigger_events(["\160\157\163\x74\x5f\163\150\x61\61\x5f\x70\x61\x73\x73\x77\157\x72\x64\137\155\151\147\x72\x61\x74\151\157\x6e", "\160\x6f\163\x74\x5f\x73\x68\x61\61\x5f\x70\x61\x73\x73\x77\157\x72\x64\x5f\155\x69\x67\x72\141\164\151\157\x6e\137\165\x6e\163\165\143\143\x65\x73\x73\146\x75\154"]); goto gSpJQ; yca1l: $this->trigger_events(["\160\157\x73\164\x5f\x73\x68\141\61\137\x70\141\x73\163\x77\157\x72\x64\137\155\x69\147\x72\x61\164\x69\157\156", "\x70\x6f\163\x74\137\163\x68\141\x31\137\160\141\163\163\x77\x6f\x72\144\137\x6d\151\147\162\x61\x74\151\x6f\x6e\x5f\165\156\x73\165\x63\143\x65\x73\x73\x66\165\154"]); goto Zk53b; RtQ1f: $salt_db = $query->row(); goto Pvm0z; EFfgn: Y6IFD: goto zuQ8G; vxvEF: $this->trigger_events(["\160\x6f\x73\x74\x5f\x73\150\x61\61\x5f\x70\141\x73\x73\x77\157\162\x64\x5f\x6d\x69\x67\162\141\164\151\157\x6e", "\x70\157\163\x74\137\163\150\141\x31\137\x70\141\x73\163\x77\157\162\x64\137\x6d\151\x67\162\x61\164\151\x6f\x6e\x5f\163\165\x63\143\x65\163\163\x66\165\x6c"]); goto kDD4r; kxvqE: return FALSE; goto Rte6u; ZROHI: return $result; goto ec31D; c2OsD: $salt = substr($hashed_password_db, 0, $salt_length); goto sbnCI; UlxXp: if ($result) { goto e5hU6; } goto yFXAt; YL0o2: } }
