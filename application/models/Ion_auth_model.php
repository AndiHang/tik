<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\123\x45\x50\x41\124\110") or exit("\116\x6f\x20\144\x69\x72\x65\143\164\x20\163\143\x72\151\x70\x74\x20\x61\x63\x63\145\x73\x73\40\141\x6c\x6c\x6f\x77\145\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto O7aBs; XEWev: $this->_ion_hooks = new stdClass(); goto d9oBn; kVLDO: $this->lang->load("\x69\157\156\x5f\141\x75\164\150"); goto OxtAr; tPdxd: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\x72\157\162\x5f\x73\x75\x66\x66\151\170"); goto ujOjb; qRPsu: IUpm3: goto EPPp_; Pd9fU: $this->messages = []; goto qsaVu; tqvdE: $form_validation_class = new ReflectionClass("\103\x49\x5f\106\x6f\162\x6d\x5f\x76\141\x6c\151\x64\141\x74\x69\x6f\156"); goto DkWhz; KXP11: $this->load->helper("\x63\x6f\x6f\x6b\x69\145"); goto QfmVh; RGJnh: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto cDeOc; PhtJd: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto Ntx1T; DkWhz: $error_prefix = $form_validation_class->getProperty("\137\145\162\x72\x6f\162\x5f\x70\x72\x65\146\151\170"); goto lwi6z; Ntx1T: $this->message_end_delimiter = $this->error_end_delimiter; goto OOIc6; IzZYw: $delimiters_source = $this->config->item("\144\x65\x6c\x69\155\151\x74\x65\x72\163\x5f\x73\157\x75\x72\143\x65", "\x69\x6f\156\x5f\141\x75\164\x68"); goto d9w4x; QfmVh: $this->load->helper("\x64\141\164\145"); goto kVLDO; d9w4x: if ($delimiters_source === "\x66\x6f\x72\x6d\x5f\x76\x61\154\151\x64\x61\164\151\157\156") { goto sgHKO; } goto PEaRZ; OgSOg: $this->message_end_delimiter = $this->config->item("\x6d\x65\x73\x73\x61\147\145\x5f\x65\x6e\x64\137\x64\145\x6c\151\155\x69\164\145\x72", "\x69\157\x6e\137\141\165\164\x68"); goto RiQTh; cDeOc: $this->message_start_delimiter = $this->error_start_delimiter; goto tPdxd; TY0If: sgHKO: goto F6CTg; YVqv2: if (empty($group_name)) { goto pBmMz; } goto c8QIO; Kzh8E: goto EGaR7; goto TY0If; U1rEj: goto IUpm3; goto i_EdB; PEaRZ: $this->message_start_delimiter = $this->config->item("\155\x65\163\x73\x61\147\x65\137\163\164\141\x72\x74\137\144\x65\x6c\x69\x6d\151\x74\x65\162", "\151\x6f\x6e\x5f\141\x75\164\150"); goto OgSOg; ujOjb: $error_suffix->setAccessible(TRUE); goto PhtJd; i_EdB: pBmMz: goto wrlJW; RiQTh: $this->error_start_delimiter = $this->config->item("\145\162\162\x6f\162\x5f\x73\164\x61\162\164\137\144\x65\154\151\155\151\164\x65\x72", "\151\x6f\156\x5f\x61\165\x74\x68"); goto wTXlF; wrlJW: $CI =& get_instance(); goto w009g; qsaVu: $this->errors = []; goto IzZYw; F6CTg: $this->load->library("\146\x6f\162\x6d\x5f\x76\141\154\151\144\x61\x74\151\x6f\156"); goto tqvdE; EPPp_: $this->tables = $this->config->item("\x74\141\x62\154\x65\163", "\151\157\x6e\x5f\x61\165\x74\x68"); goto iFGLz; fVhwr: $this->hash_method = $this->config->item("\x68\141\163\150\x5f\155\145\x74\x68\157\144", "\151\157\x6e\x5f\141\165\x74\x68"); goto Pd9fU; w009g: $this->db = $CI->db; goto qRPsu; O7aBs: $this->config->load("\151\157\156\x5f\x61\x75\x74\150", TRUE); goto KXP11; OxtAr: $group_name = $this->config->item("\x64\x61\x74\141\142\141\163\145\137\x67\162\157\x75\160\137\156\x61\155\x65", "\x69\157\x6e\x5f\141\165\x74\x68"); goto YVqv2; lwi6z: $error_prefix->setAccessible(TRUE); goto RGJnh; iFGLz: $this->identity_column = $this->config->item("\x69\x64\145\156\x74\151\164\x79", "\x69\157\156\137\x61\x75\164\x68"); goto fbsxO; fbsxO: $this->join = $this->config->item("\x6a\157\x69\156", "\x69\x6f\x6e\x5f\x61\165\164\150"); goto fVhwr; wTXlF: $this->error_end_delimiter = $this->config->item("\145\162\x72\157\162\x5f\x65\156\144\x5f\144\x65\x6c\x69\x6d\x69\x74\x65\x72", "\151\x6f\156\x5f\141\x75\x74\x68"); goto Kzh8E; d9oBn: $this->trigger_events("\155\157\144\145\154\137\x63\157\156\163\164\x72\165\x63\x74\x6f\x72"); goto yz6RS; OOIc6: EGaR7: goto XEWev; c8QIO: $this->db = $this->load->database($group_name, TRUE, TRUE); goto U1rEj; yz6RS: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto BKFMI; htM15: return FALSE; goto quHTZ; JUp9Q: $algo = $this->_get_hash_algo(); goto j37mI; BKFMI: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto YxnP0; } goto htM15; quHTZ: YxnP0: goto JUp9Q; soGAP: return password_hash($password, $algo, $params); goto or14J; j37mI: $params = $this->_get_hash_parameters($identity); goto i7XhL; wFl0n: return FALSE; goto hXM2u; i7XhL: if (!($algo !== FALSE && $params !== FALSE)) { goto S2ziO; } goto soGAP; or14J: S2ziO: goto wFl0n; hXM2u: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto Gmk9w; uhi8J: return password_verify($password, $hash_password_db); goto Pi9UQ; psG95: QD8eG: goto abR2t; m3BPz: goto ALeab; goto va1EG; va1EG: WFJS7: goto uhi8J; rJvEi: return FALSE; goto psG95; Pi9UQ: ALeab: goto yM7yF; abR2t: if (strpos($hash_password_db, "\44") === 0) { goto WFJS7; } goto MuLru; Gmk9w: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto QD8eG; } goto rJvEi; MuLru: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto m3BPz; yM7yF: } public function rehash_password_if_needed($hash, $identity, $password) { goto Eoxkm; b9yaR: goto kCZBe; goto Ekywg; ukuL3: HeKJ0: goto ZLirH; TQbS2: if ($this->_set_password_db($identity, $password)) { goto ABbo_; } goto mRil8; xfCQ4: mhZg_: goto ukuL3; ifCmQ: kCZBe: goto xfCQ4; N0fK6: if (!($algo !== FALSE && $params !== FALSE)) { goto HeKJ0; } goto iKy3b; Eoxkm: $algo = $this->_get_hash_algo(); goto SqGgV; tkHWm: $this->trigger_events(["\x72\x65\150\x61\x73\x68\137\x70\141\x73\163\167\x6f\162\x64", "\x72\145\x68\141\163\150\x5f\160\141\163\x73\x77\x6f\162\x64\x5f\x73\165\x63\x63\x65\x73\x73\146\165\154"]); goto ifCmQ; mRil8: $this->trigger_events(["\x72\x65\x68\141\x73\x68\137\x70\x61\163\x73\x77\x6f\x72\144", "\x72\145\x68\x61\163\150\x5f\160\x61\x73\x73\x77\157\162\144\137\x75\x6e\163\x75\x63\x63\145\x73\x73\x66\x75\154"]); goto b9yaR; Ekywg: ABbo_: goto tkHWm; SqGgV: $params = $this->_get_hash_parameters($identity); goto N0fK6; iKy3b: if (!password_needs_rehash($hash, $algo, $params)) { goto mhZg_; } goto TQbS2; ZLirH: } public function get_user_by_activation_code($user_code) { goto REp8F; REp8F: $token = $this->_retrieve_selector_validator_couple($user_code); goto V2kvO; IXusT: eHH57: goto yN2GN; yN2GN: oscua: goto e3z05; nI09G: if (!$user) { goto oscua; } goto Bu9g9; Bu9g9: if (!$this->verify_password($token->validator, $user->activation_code)) { goto eHH57; } goto gHYTm; gHYTm: return $user; goto IXusT; V2kvO: $user = $this->where("\x61\143\x74\151\166\x61\x74\x69\157\156\x5f\163\x65\154\x65\143\164\157\162", $token->selector)->users()->row(); goto nI09G; e3z05: return FALSE; goto W_Vxz; W_Vxz: } public function activate($id, $code = FALSE) { goto v6JaR; Cv0q2: P6HJ5: goto wdt1k; wLOqK: return TRUE; goto sdUY0; Y8hRz: $data = ["\x61\x63\x74\x69\166\141\164\151\157\x6e\137\163\x65\154\x65\143\164\x6f\162" => NULL, "\x61\x63\x74\151\166\x61\x74\151\157\156\137\143\157\144\x65" => NULL, "\141\x63\164\151\166\x65" => 1]; goto kyq1E; kyq1E: $this->trigger_events("\x65\170\x74\162\141\137\167\150\145\162\x65"); goto u0I6Z; D5AQQ: if (!($code !== FALSE)) { goto P6HJ5; } goto P9FL8; CfFle: YoE5j: goto WHBQV; UAfky: $this->trigger_events(["\x70\x6f\x73\x74\x5f\141\x63\x74\x69\x76\141\x74\145", "\x70\x6f\163\164\x5f\141\x63\x74\x69\x76\x61\x74\145\x5f\163\165\143\x63\x65\x73\163\146\165\x6c"]); goto zTYKc; WHBQV: $this->trigger_events(["\160\x6f\x73\164\137\141\143\164\151\x76\x61\164\145", "\160\x6f\163\x74\137\141\x63\164\x69\x76\141\164\145\x5f\x75\x6e\163\165\x63\x63\145\x73\163\146\x75\x6c"]); goto a4H7P; v6JaR: $this->trigger_events("\x70\162\x65\x5f\x61\143\x74\x69\166\141\164\x65"); goto D5AQQ; u0I6Z: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, ["\151\144" => $id]); goto EGN4K; a4H7P: $this->set_error("\141\x63\164\151\x76\141\x74\x65\137\x75\156\163\x75\143\143\x65\163\x73\146\165\154"); goto MJlom; wdt1k: if (!($code === FALSE || $user && $user->id === $id)) { goto YoE5j; } goto Y8hRz; P9FL8: $user = $this->get_user_by_activation_code($code); goto Cv0q2; MJlom: return FALSE; goto DBUxE; EGN4K: if (!($this->db->affected_rows() === 1)) { goto Dt9xw; } goto UAfky; sdUY0: Dt9xw: goto CfFle; zTYKc: $this->set_message("\x61\143\x74\151\x76\x61\x74\145\x5f\163\165\143\143\x65\163\163\x66\x75\154"); goto wLOqK; DBUxE: } public function deactivate($id = NULL) { goto qGhCo; J2fn6: $data = ["\x61\143\x74\x69\166\x61\x74\x69\157\156\137\163\x65\x6c\x65\143\x74\x6f\x72" => $token->selector, "\141\x63\x74\151\166\141\164\x69\x6f\156\x5f\143\157\x64\145" => $token->validator_hashed, "\x61\x63\164\151\166\145" => 0]; goto l3drl; UMA8n: if (!isset($id)) { goto GRIQv; } goto R6iDB; A2426: return FALSE; goto yMRXh; MSO0j: $this->set_error("\x64\145\x61\143\164\x69\166\141\164\x65\137\143\165\x72\162\x65\x6e\x74\137\x75\163\145\x72\x5f\x75\156\163\x75\143\143\x65\163\163\x66\165\x6c"); goto A2426; qGhCo: $this->trigger_events("\144\145\x61\x63\x74\151\x76\141\x74\145"); goto UMA8n; Qw_i7: if ($return) { goto zPIea; } goto KFQbi; mDTT0: goto ClDXQ; goto ypbI5; wRqnc: $this->set_message("\144\x65\x61\143\x74\x69\x76\141\164\145\x5f\163\165\x63\143\145\163\163\x66\165\x6c"); goto HiJsY; zvssa: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, ["\x69\144" => $id]); goto Y_V54; BntWC: return $return; goto CrcxU; Y4nwY: $this->set_error("\144\x65\x61\143\164\151\166\141\164\x65\137\x75\x6e\x73\x75\x63\143\145\163\x73\x66\165\154"); goto Mhwvo; Mhwvo: return FALSE; goto HE1Ob; KFQbi: $this->set_error("\x64\x65\x61\x63\164\151\x76\x61\x74\x65\x5f\x75\x6e\x73\165\143\143\145\163\x73\146\165\154"); goto mDTT0; jitor: $token = $this->_generate_selector_validator_couple(20, 40); goto RL4Rp; HiJsY: ClDXQ: goto BntWC; ypbI5: zPIea: goto wRqnc; Y_V54: $return = $this->db->affected_rows() == 1; goto Qw_i7; yMRXh: epYgC: goto rTFPK; RL4Rp: $this->activation_code = $token->user_code; goto J2fn6; HE1Ob: o4Pzu: goto jitor; czBkn: GRIQv: goto Y4nwY; R6iDB: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto epYgC; } goto MSO0j; l3drl: $this->trigger_events("\145\170\164\162\141\137\167\x68\145\162\145"); goto zvssa; rTFPK: goto o4Pzu; goto czBkn; CrcxU: } public function clear_forgotten_password_code($identity) { goto WxHmY; IX1Ws: return FALSE; goto u4mAS; u4mAS: WwdVO: goto fTFYf; WxHmY: if (!empty($identity)) { goto WwdVO; } goto IX1Ws; y_OBt: $this->db->update($this->tables["\165\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto h2mlz; h2mlz: return TRUE; goto v3IrF; fTFYf: $data = ["\x66\157\x72\x67\x6f\164\x74\145\156\137\160\x61\163\163\167\157\x72\x64\137\x73\x65\x6c\x65\x63\x74\157\x72" => NULL, "\146\157\x72\x67\157\x74\164\145\156\x5f\x70\x61\x73\163\x77\157\162\144\137\143\157\x64\145" => NULL, "\146\x6f\x72\x67\x6f\x74\164\x65\156\137\160\141\x73\163\x77\157\162\x64\137\x74\151\x6d\x65" => NULL]; goto y_OBt; v3IrF: } public function clear_remember_code($identity) { goto p0_Q1; cdW5O: RtluA: goto cMKT8; MDDBg: return FALSE; goto cdW5O; p0_Q1: if (!empty($identity)) { goto RtluA; } goto MDDBg; kPwMr: return TRUE; goto jOjHj; cMKT8: $data = ["\162\145\155\x65\155\142\145\162\137\x73\145\x6c\145\x63\164\x6f\x72" => NULL, "\162\145\x6d\145\x6d\142\145\x72\137\x63\x6f\x64\145" => NULL]; goto Txbt3; Txbt3: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto kPwMr; jOjHj: } public function reset_password($identity, $new) { goto HypNf; wtahP: return FALSE; goto jE5YZ; xsHIY: $return = $this->_set_password_db($identity, $new); goto P5L0X; SBMqD: mxN1z: goto TrVFp; NlKRT: goto mxN1z; goto ABxp9; uIDYP: $this->trigger_events(["\x70\x6f\x73\x74\137\x63\150\x61\156\147\x65\137\x70\141\x73\163\x77\x6f\x72\x64", "\x70\157\163\164\x5f\143\150\x61\156\x67\x65\x5f\160\x61\163\x73\167\157\162\144\x5f\x75\156\x73\165\x63\143\x65\163\x73\x66\x75\x6c"]); goto wtahP; ABxp9: hRf8K: goto SnvaI; XP3dn: $this->trigger_events(["\160\157\x73\x74\137\143\x68\141\x6e\x67\145\x5f\160\141\x73\x73\x77\157\162\x64", "\x70\x6f\163\x74\137\x63\x68\141\156\x67\145\x5f\x70\141\x73\x73\x77\x6f\x72\x64\137\x75\156\163\165\x63\143\x65\x73\163\146\x75\x6c"]); goto Hop3P; Hop3P: $this->set_error("\x70\141\x73\163\167\157\162\x64\x5f\143\150\141\156\147\x65\137\165\x6e\x73\x75\x63\143\145\x73\163\146\165\x6c"); goto NlKRT; Zg6q1: if ($this->identity_check($identity)) { goto I2ceS; } goto uIDYP; jE5YZ: I2ceS: goto xsHIY; P5L0X: if ($return) { goto hRf8K; } goto XP3dn; HypNf: $this->trigger_events("\x70\162\x65\x5f\x63\150\x61\x6e\x67\145\137\x70\x61\x73\x73\x77\x6f\x72\144"); goto Zg6q1; SnvaI: $this->trigger_events(["\x70\x6f\163\164\x5f\x63\150\x61\156\147\x65\x5f\160\141\x73\x73\x77\157\x72\144", "\x70\157\x73\x74\137\x63\150\141\156\147\145\x5f\160\x61\163\163\x77\157\162\144\137\163\165\143\143\x65\x73\163\146\165\x6c"]); goto nCRk6; TrVFp: return $return; goto IGDXr; nCRk6: $this->set_message("\x70\141\163\163\x77\x6f\x72\x64\x5f\x63\x68\x61\156\x67\x65\137\163\165\x63\143\145\x73\163\146\165\x6c"); goto SBMqD; IGDXr: } public function change_password($identity, $old, $new) { goto rWSmB; Gkeyn: $this->set_error("\160\x61\163\x73\x77\x6f\162\144\137\x63\x68\141\156\x67\145\137\x75\x6e\x73\165\x63\x63\x65\163\x73\146\x75\154"); goto bEiWa; icBf4: if (!$this->verify_password($old, $user->password, $identity)) { goto Nfnmf; } goto sEoWE; whcQq: $this->set_error("\160\x61\x73\163\167\157\x72\144\x5f\x63\x68\141\156\147\x65\x5f\165\x6e\163\165\x63\143\x65\x73\163\146\x75\x6c"); goto yvtTL; Qi1O6: if (!($query->num_rows() !== 1)) { goto uKJiN; } goto OgdJH; MFfu2: $this->trigger_events("\x65\170\164\162\141\137\x77\x68\x65\x72\145"); goto O3ZOR; s5F8S: $this->trigger_events(["\x70\x6f\163\x74\x5f\x63\150\x61\x6e\x67\x65\x5f\x70\141\x73\163\x77\x6f\x72\x64", "\160\x6f\163\164\x5f\x63\150\x61\x6e\147\145\137\x70\141\163\163\167\157\162\x64\137\163\x75\x63\143\145\163\x73\146\165\x6c"]); goto f18QK; yvtTL: return FALSE; goto zYwQC; TWBV8: cgkA1: goto TSfSs; WGHGb: $this->trigger_events(["\x70\157\163\x74\x5f\143\150\x61\156\x67\x65\137\160\141\163\163\x77\x6f\x72\144", "\160\157\163\x74\x5f\x63\x68\141\156\147\145\x5f\160\141\x73\x73\167\x6f\x72\144\x5f\x75\x6e\x73\165\x63\143\145\163\163\x66\165\x6c"]); goto Gkeyn; rWSmB: $this->trigger_events("\160\162\x65\x5f\143\150\x61\x6e\x67\145\137\160\x61\x73\x73\x77\157\x72\144"); goto MFfu2; oqmNZ: Nfnmf: goto BmCdY; TSfSs: return $result; goto oqmNZ; qGL_E: return FALSE; goto ymxSg; OgdJH: $this->trigger_events(["\x70\x6f\163\x74\137\143\x68\141\156\x67\145\137\x70\141\163\163\167\x6f\162\144", "\x70\x6f\163\x74\x5f\143\150\141\156\x67\x65\137\x70\x61\x73\x73\x77\157\162\144\x5f\x75\156\163\165\x63\143\145\163\163\146\165\154"]); goto whcQq; O3ZOR: $query = $this->db->select("\151\x64\x2c\x20\x70\x61\x73\163\x77\x6f\x72\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\x65\x73\x63")->get($this->tables["\x75\163\145\162\x73"]); goto Qi1O6; f18QK: $this->set_message("\x70\x61\x73\x73\x77\x6f\x72\x64\x5f\x63\x68\141\156\x67\145\137\x73\x75\x63\143\145\163\163\146\165\154"); goto TWBV8; zYwQC: uKJiN: goto tTtsN; sEoWE: $result = $this->_set_password_db($identity, $new); goto wV0_V; wV0_V: if ($result) { goto HQ4s1; } goto WGHGb; tTtsN: $user = $query->row(); goto icBf4; BmCdY: $this->set_error("\160\x61\163\x73\x77\x6f\162\144\137\x63\150\141\x6e\147\145\x5f\x75\x6e\163\x75\143\143\145\x73\x73\146\x75\x6c"); goto qGL_E; bEiWa: goto cgkA1; goto R2mKd; R2mKd: HQ4s1: goto s5F8S; ymxSg: } public function username_check($username = '') { goto IY6Jt; IY6Jt: $this->trigger_events("\165\x73\145\162\x6e\x61\155\145\x5f\143\x68\145\143\x6b"); goto x8mF1; S2x6G: return FALSE; goto qSNtl; x8mF1: if (!empty($username)) { goto FOBYc; } goto S2x6G; qSNtl: FOBYc: goto mEVQ2; j02Dt: return $this->db->where("\165\163\x65\162\x6e\141\x6d\145", $username)->limit(1)->count_all_results($this->tables["\x75\x73\x65\x72\x73"]) > 0; goto ipgKE; mEVQ2: $this->trigger_events("\x65\170\164\x72\141\137\x77\150\x65\x72\x65"); goto j02Dt; ipgKE: } public function email_check($email = '') { goto V8Ikk; rKMLT: if (!empty($email)) { goto KeHUo; } goto u4nbk; V8Ikk: $this->trigger_events("\x65\155\141\x69\x6c\137\x63\150\x65\x63\x6b"); goto rKMLT; s7wxa: $this->trigger_events("\x65\170\x74\162\141\137\167\150\x65\162\x65"); goto bpNmQ; oekVI: KeHUo: goto s7wxa; bpNmQ: return $this->db->where("\x65\x6d\141\x69\154", $email)->limit(1)->count_all_results($this->tables["\x75\163\x65\x72\x73"]) > 0; goto zASZw; u4nbk: return FALSE; goto oekVI; zASZw: } public function identity_check($identity = '') { goto eDeDe; S3XhG: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\145\162\163"]) > 0; goto Ad0oo; iVN3p: if (!empty($identity)) { goto t5oEW; } goto GZ9Hi; HAMJ0: t5oEW: goto S3XhG; GZ9Hi: return FALSE; goto HAMJ0; eDeDe: $this->trigger_events("\151\x64\145\156\164\x69\164\171\137\x63\x68\x65\143\x6b"); goto iVN3p; Ad0oo: } public function get_user_id_from_identity($identity = '') { goto AcFMJ; fvfZP: sBi_V: goto iwk1r; iwk1r: $user = $query->row(); goto CEpjN; ANHv1: bgrN5: goto qzAIn; AcFMJ: if (!empty($identity)) { goto bgrN5; } goto Dldfs; qzAIn: $query = $this->db->select("\x69\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\163"]); goto CBFQ4; rNWnR: return FALSE; goto fvfZP; CBFQ4: if (!($query->num_rows() !== 1)) { goto sBi_V; } goto rNWnR; CEpjN: return $user->id; goto T0uME; Dldfs: return FALSE; goto ANHv1; T0uME: } public function forgotten_password($identity) { goto FfokL; vFTbA: $update = ["\x66\x6f\162\x67\157\x74\x74\x65\x6e\x5f\160\141\163\x73\167\x6f\x72\x64\x5f\163\145\154\145\x63\x74\157\162" => $token->selector, "\146\x6f\162\x67\157\164\x74\x65\x6e\137\160\141\163\x73\x77\157\162\144\137\143\x6f\144\x65" => $token->validator_hashed, "\146\157\162\x67\157\164\164\x65\x6e\137\x70\x61\163\163\x77\157\x72\x64\137\164\x69\x6d\145" => time()]; goto eHQMg; XyQkC: $token = $this->_generate_selector_validator_couple(20, 80); goto vFTbA; eXk1l: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], $update, [$this->identity_column => $identity]); goto hF7WV; jw8L8: $this->trigger_events(["\x70\157\x73\x74\x5f\146\157\162\147\x6f\164\x74\145\x6e\137\x70\x61\163\x73\167\157\x72\144", "\160\157\x73\x74\137\x66\157\x72\x67\x6f\x74\164\x65\156\137\x70\x61\163\x73\167\157\162\x64\x5f\165\x6e\163\x75\143\x63\145\163\163\x66\165\x6c"]); goto AOzoH; hF7WV: if ($this->db->affected_rows() === 1) { goto GAKFP; } goto jw8L8; aq5gm: GAKFP: goto pGIoh; Uncu2: return FALSE; goto JwrNy; Em8rK: $this->trigger_events(["\160\x6f\163\164\x5f\x66\x6f\x72\147\x6f\x74\164\x65\x6e\x5f\x70\141\x73\163\x77\157\162\144", "\160\x6f\163\164\137\146\157\x72\x67\x6f\x74\164\x65\x6e\x5f\x70\x61\163\x73\167\x6f\x72\x64\137\x75\156\163\x75\x63\x63\x65\x73\163\146\165\154"]); goto Uncu2; hhaSP: goto eik6C; goto aq5gm; IsHdL: return $token->user_code; goto W4srW; AOzoH: return FALSE; goto hhaSP; JwrNy: ydUeg: goto XyQkC; FfokL: if (!empty($identity)) { goto ydUeg; } goto Em8rK; W4srW: eik6C: goto aV7Ws; eHQMg: $this->trigger_events("\x65\170\164\x72\141\x5f\167\x68\x65\162\x65"); goto eXk1l; pGIoh: $this->trigger_events(["\x70\x6f\x73\164\x5f\146\x6f\162\x67\157\164\164\145\x6e\137\x70\x61\x73\163\x77\x6f\162\x64", "\160\157\x73\x74\x5f\146\x6f\x72\147\157\164\x74\x65\156\137\x70\141\x73\163\167\157\162\144\x5f\163\x75\x63\x63\x65\163\163\146\165\154"]); goto IsHdL; aV7Ws: } public function get_user_by_forgotten_password_code($user_code) { goto nxC8y; ri4T9: $user = $this->where("\146\x6f\162\x67\x6f\x74\164\x65\156\137\160\141\163\163\x77\157\x72\144\137\163\145\154\x65\x63\164\157\x72", $token->selector)->users()->row(); goto hBT3l; tdNnx: return FALSE; goto zyu3B; aO0CW: return $user; goto fM0AC; nxC8y: $token = $this->_retrieve_selector_validator_couple($user_code); goto ri4T9; xHyw3: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto KRnxe; } goto aO0CW; fM0AC: KRnxe: goto Xp19T; hBT3l: if (!$user) { goto vG6nY; } goto xHyw3; Xp19T: vG6nY: goto tdNnx; zyu3B: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto fCeNk; i3qkc: $default_group = $query; goto AwlPd; wag1h: $this->set_error("\141\143\143\x6f\165\156\164\x5f\x63\x72\x65\x61\164\x69\157\156\x5f\x69\156\166\x61\154\x69\x64\x5f\x64\145\x66\141\165\x6c\x74\x5f\x67\162\157\165\160"); goto sFIjO; G9Zne: DKwZQ: goto vnKeL; xzomP: $this->trigger_events("\x65\170\164\x72\141\137\x73\x65\x74"); goto Upi4I; r6OAK: $password = $this->hash_password($password); goto U7NV8; vnKeL: if (empty($groups)) { goto bzFjg; } goto DVPm7; P_pYA: $this->set_error("\141\x63\x63\157\165\156\x74\137\x63\162\x65\141\x74\151\157\x6e\x5f\165\x6e\163\165\143\143\145\163\x73\146\x75\154"); goto aS85Y; wd3jS: $this->set_error("\141\x63\143\157\165\x6e\x74\137\x63\162\145\141\164\x69\x6f\156\137\x6d\151\x73\163\151\156\x67\x5f\x64\x65\x66\x61\165\x6c\x74\137\x67\162\x6f\x75\160"); goto ELeiv; U7NV8: if (!($password === FALSE)) { goto n24Nh; } goto P_pYA; GJVYu: return isset($id) ? $id : FALSE; goto EqagI; cKNaG: if (!(!isset($query->id) && empty($groups))) { goto aIXtg; } goto wag1h; uBxjr: goto skgJI; goto mHB_A; gNtII: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\145\x72\163"], $additional_data), $data); goto xzomP; jAKTQ: nkW7r: goto uBxjr; LayoZ: n24Nh: goto ELZ9L; Ghp_7: return FALSE; goto m1IhW; U_T_1: if (!(!$this->config->item("\x64\145\x66\141\x75\x6c\164\137\x67\162\157\x75\160", "\151\157\x6e\137\141\x75\x74\x68") && empty($groups))) { goto nkW7r; } goto wd3jS; ELeiv: return FALSE; goto jAKTQ; JCG2Q: $id = $this->db->insert_id($this->tables["\x75\x73\x65\162\163"] . "\x5f\x69\144\x5f\x73\x65\x71"); goto nLSDI; WMmlC: $manual_activation = $this->config->item("\155\141\x6e\165\141\x6c\x5f\x61\143\x74\x69\166\141\x74\151\x6f\x6e", "\151\157\156\137\x61\x75\164\150"); goto BSg_x; prPd3: $query = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\x73"], ["\156\141\x6d\145" => $this->config->item("\x64\145\x66\x61\165\154\x74\137\147\x72\x6f\165\160", "\x69\157\x6e\x5f\x61\165\x74\150")], 1)->row(); goto cKNaG; BSg_x: if ($this->identity_check($identity)) { goto fXBO9; } goto U_T_1; JJ66f: bzFjg: goto YLYG4; sFIjO: return FALSE; goto WALH6; nLSDI: if (!(isset($default_group->id) && empty($groups))) { goto DKwZQ; } goto t2uuR; AwlPd: $ip_address = $this->input->ip_address(); goto r6OAK; aS85Y: return FALSE; goto LayoZ; t2uuR: $groups[] = $default_group->id; goto G9Zne; Upi4I: $this->db->insert($this->tables["\x75\163\x65\x72\163"], $user_data); goto JCG2Q; ELZ9L: $data = [$this->identity_column => $identity, "\x75\x73\145\x72\156\141\155\x65" => $identity, "\x70\141\163\x73\x77\x6f\162\x64" => $password, "\145\155\141\151\x6c" => $email, "\x69\x70\137\x61\144\x64\x72\145\x73\163" => $ip_address, "\x63\x72\x65\141\164\x65\144\x5f\x6f\156" => time(), "\141\x63\x74\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto gNtII; m1IhW: skgJI: goto prPd3; mHB_A: fXBO9: goto JIF96; JIF96: $this->set_error("\141\x63\143\x6f\x75\x6e\x74\x5f\143\x72\145\141\164\151\157\x6e\x5f\144\165\x70\154\x69\x63\x61\164\145\137\x69\144\145\x6e\164\x69\x74\171"); goto Ghp_7; WALH6: aIXtg: goto i3qkc; YLYG4: $this->trigger_events("\160\x6f\x73\x74\x5f\162\145\x67\151\163\x74\145\162"); goto GJVYu; fCeNk: $this->trigger_events("\160\x72\x65\137\162\145\147\151\x73\x74\x65\x72"); goto WMmlC; DVPm7: foreach ($groups as $group) { $this->add_to_group($group, $id); ltSm3: } goto DTRi9; DTRi9: bHYTR: goto JJ66f; EqagI: } public function login($identity, $password, $remember = FALSE) { goto yVs1F; lnrkt: vyigv: goto aoBWL; hRxNW: $this->set_error("\x6c\157\147\151\156\137\165\156\x73\165\143\x63\x65\x73\x73\x66\x75\154\x5f\x6e\157\164\137\x61\x63\164\151\x76\x65"); goto QX4f2; y3yyq: $this->set_error("\154\157\x67\x69\156\137\164\x69\x6d\x65\157\x75\x74"); goto IhxEy; iOlZ7: $this->update_last_login($user->id); goto PzhWN; CND_Z: $this->session->sess_regenerate(FALSE); goto ZMh_u; PzhWN: $this->clear_login_attempts($identity); goto UhmgE; FsY9S: if (!$this->is_max_login_attempts_exceeded($identity)) { goto vyigv; } goto FDxvl; PfFwA: if (!(empty($identity) || empty($password))) { goto gPSny; } goto Itmh1; VdUYw: $this->set_session($user); goto iOlZ7; cwMwV: rluJj: goto gHs0a; xVqIX: return TRUE; goto cwMwV; yVs1F: $this->trigger_events("\x70\x72\x65\x5f\154\x6f\147\151\x6e"); goto PfFwA; TVbyZ: Kpc7D: goto VdUYw; QX4f2: return FALSE; goto TVbyZ; GLFDB: $this->trigger_events("\160\157\x73\x74\x5f\154\157\x67\x69\x6e\137\165\x6e\163\x75\x63\x63\145\x73\163\146\165\154"); goto hRxNW; yiC0H: $this->trigger_events("\145\x78\164\x72\x61\x5f\x77\150\145\162\145"); goto rSuIT; MDuL7: $this->clear_remember_code($identity); goto gAW4X; QQHia: $this->increase_login_attempts($identity); goto OY4hl; rmAEf: $this->set_error("\x6c\x6f\x67\151\156\137\x75\x6e\x73\x75\x63\143\145\163\163\146\165\154"); goto hXuhP; gAW4X: goto rWCJk; goto xzcJe; FDxvl: $this->hash_password($password); goto WE5Gm; aAxZ6: return FALSE; goto Mv_0m; IhxEy: return FALSE; goto lnrkt; hXuhP: return FALSE; goto UVL1K; DYXfh: if ($remember) { goto NYUF3; } goto MDuL7; xzcJe: NYUF3: goto aAyLv; U2Vln: if (!$this->config->item("\x72\145\155\145\x6d\x62\145\162\137\165\163\145\x72\x73", "\x69\157\156\137\141\x75\x74\150")) { goto TdSY5; } goto DYXfh; n2UiG: TdSY5: goto HCKpQ; Itmh1: $this->set_error("\154\x6f\x67\151\156\x5f\x75\x6e\x73\x75\x63\143\x65\163\163\146\x75\x6c"); goto aAxZ6; V7hgu: if (!($user->active == 0)) { goto Kpc7D; } goto GLFDB; j79T4: $user = $query->row(); goto vf8OB; ZMh_u: $this->trigger_events(["\160\x6f\163\164\137\x6c\x6f\x67\151\156", "\x70\x6f\163\x74\137\154\x6f\x67\151\156\x5f\163\165\143\143\145\163\x73\146\x75\x6c"]); goto Wz9Id; WE5Gm: $this->trigger_events("\160\157\163\164\137\154\x6f\147\x69\x6e\x5f\x75\156\163\x75\x63\x63\x65\163\163\146\165\x6c"); goto y3yyq; lm0tR: rWCJk: goto n2UiG; Wz9Id: $this->set_message("\x6c\157\147\151\156\x5f\163\165\x63\143\x65\x73\x73\146\165\x6c"); goto xVqIX; UhmgE: $this->clear_forgotten_password_code($identity); goto U2Vln; Mv_0m: gPSny: goto yiC0H; gHs0a: OJC8m: goto PiBSn; PiBSn: $this->hash_password($password); goto QQHia; vf8OB: if (!$this->verify_password($password, $user->password, $identity)) { goto rluJj; } goto V7hgu; HCKpQ: $this->rehash_password_if_needed($user->password, $identity, $password); goto CND_Z; rSuIT: $query = $this->db->select($this->identity_column . "\x2c\40\x65\155\141\151\x6c\54\x20\x69\x64\x2c\40\x70\x61\163\x73\x77\x6f\162\x64\x2c\40\141\143\x74\x69\166\145\54\x20\x6c\141\163\164\137\x6c\157\147\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\144\x65\x73\x63")->get($this->tables["\165\x73\145\x72\x73"]); goto FsY9S; aoBWL: if (!($query->num_rows() === 1)) { goto OJC8m; } goto j79T4; OY4hl: $this->trigger_events("\160\x6f\163\x74\137\154\157\147\x69\156\137\165\x6e\x73\165\x63\143\x65\163\x73\x66\165\154"); goto rmAEf; aAyLv: $this->remember_user($identity); goto lm0tR; UVL1K: } public function recheck_session() { goto cmVp0; GS58J: oSdUz: goto mP77d; xCGIT: return FALSE; goto Gxq1z; G3RXh: $identity = $this->config->item("\x69\144\x65\156\164\x69\164\x79", "\151\x6f\156\137\141\165\x74\x68"); goto d7ibV; wEMUX: EPjmK: goto Wo2eB; V1KRQ: return (bool) $this->session->userdata("\151\x64\145\x6e\164\x69\x74\x79"); goto dvqs3; Wo2eB: $this->session->set_userdata("\154\141\x73\x74\x5f\143\150\145\143\153", time()); goto YDncX; G51BE: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\x69\144\145\x6e\164\x69\x74\171"), "\141\x63\164\x69\166\x65" => "\x31"])->limit(1)->order_by("\151\144", "\144\x65\163\x63")->get($this->tables["\165\163\145\162\x73"]); goto SffEP; mP77d: QFtZx: goto V1KRQ; XFtAA: if (!($last_login + $recheck < time())) { goto oSdUz; } goto G51BE; Gxq1z: goto JU5Eq; goto wEMUX; d7ibV: $this->session->unset_userdata([$identity, "\151\x64", "\x75\x73\145\162\137\151\144"]); goto xCGIT; YDncX: JU5Eq: goto GS58J; wERFx: $last_login = $this->session->userdata("\x6c\x61\163\164\x5f\143\x68\145\x63\153"); goto XFtAA; cmVp0: $recheck = NULL !== $this->config->item("\162\x65\143\x68\145\x63\x6b\137\164\x69\x6d\145\162", "\151\x6f\156\137\x61\165\164\x68") ? $this->config->item("\162\145\143\x68\x65\x63\153\x5f\x74\151\x6d\145\x72", "\x69\x6f\156\137\141\165\x74\150") : 0; goto m6fSn; SffEP: if ($query->num_rows() === 1) { goto EPjmK; } goto H0RDw; H0RDw: $this->trigger_events("\x6c\157\x67\157\x75\164"); goto G3RXh; m6fSn: if (!($recheck !== 0)) { goto QFtZx; } goto wERFx; dvqs3: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto MQeoy; tzCH8: $max_attempts = $this->config->item("\x6d\141\170\x69\155\x75\x6d\x5f\154\157\x67\x69\156\137\x61\164\164\145\155\160\x74\x73", "\151\x6f\156\137\141\x75\164\x68"); goto ZyHmQ; yrL8a: return $attempts >= $max_attempts; goto Zdc4f; MQeoy: if (!$this->config->item("\164\x72\x61\x63\x6b\137\x6c\x6f\147\x69\x6e\x5f\x61\x74\164\145\x6d\160\164\163", "\151\x6f\x6e\x5f\141\x75\x74\150")) { goto XA3b0; } goto tzCH8; Zdc4f: UXywC: goto YRHFG; QcbC0: return FALSE; goto otXKk; YRHFG: XA3b0: goto QcbC0; rQta_: $attempts = $this->get_attempts_num($identity, $ip_address); goto yrL8a; ZyHmQ: if (!($max_attempts > 0)) { goto UXywC; } goto rQta_; otXKk: } public function get_attempts_num($identity, $ip_address = NULL) { goto GgETD; c3AUI: $ip_address = $this->input->ip_address(); goto XvsMI; GgETD: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\x6c\x6f\147\x69\x6e\137\x61\164\x74\x65\155\x70\x74\x73", "\x69\157\156\137\x61\x75\164\x68")) { goto XPVny; } goto cbIYD; cbIYD: $this->db->select("\x31", FALSE); goto Jo8sp; VyzhB: return 0; goto fRK4G; y12a_: $this->db->where("\x74\x69\x6d\x65\40\76", time() - $this->config->item("\154\x6f\x63\x6b\157\x75\x74\x5f\x74\151\155\145", "\x69\157\156\x5f\x61\165\164\x68"), FALSE); goto ghWDa; Jo8sp: $this->db->where("\x6c\x6f\x67\x69\x6e", $identity); goto lVTlk; iUIbB: return $qres->num_rows(); goto Pz7y2; XvsMI: IfwXW: goto HAvC7; Pz7y2: XPVny: goto VyzhB; ghWDa: $qres = $this->db->get($this->tables["\x6c\157\147\151\x6e\137\141\x74\x74\x65\155\160\164\x73"]); goto iUIbB; lVTlk: if (!$this->config->item("\164\162\141\x63\x6b\137\x6c\157\147\x69\x6e\137\151\160\137\x61\144\x64\162\x65\163\x73", "\151\157\x6e\x5f\x61\x75\164\150")) { goto NbU6i; } goto grM3N; XZHka: NbU6i: goto y12a_; HAvC7: $this->db->where("\x69\x70\137\141\144\x64\162\x65\163\x73", $ip_address); goto XZHka; grM3N: if (isset($ip_address)) { goto IfwXW; } goto c3AUI; fRK4G: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto HkBSB; C03e9: nQrdo: goto Sp0ia; YXHWR: $qres = $this->db->get($this->tables["\154\x6f\x67\x69\156\x5f\141\x74\x74\145\155\160\164\163"], 1); goto KyMSI; Sp0ia: return 0; goto l0fy7; HkBSB: if (!$this->config->item("\x74\162\x61\143\153\137\154\157\147\x69\156\137\141\x74\x74\x65\x6d\160\x74\x73", "\x69\x6f\156\137\x61\165\x74\150")) { goto nQrdo; } goto sa7Pw; YZXLC: if (isset($ip_address)) { goto Hmyzf; } goto w0p5i; GE71j: if (!$this->config->item("\x74\162\x61\x63\x6b\137\154\157\x67\151\x6e\137\x69\160\137\x61\144\x64\x72\x65\163\x73", "\x69\157\156\137\x61\165\164\150")) { goto s3GGF; } goto YZXLC; KyMSI: if (!($qres->num_rows() > 0)) { goto xsCzv; } goto xwB_k; R_bWh: $this->db->where("\151\x70\137\141\x64\144\162\x65\x73\163", $ip_address); goto c0z5r; w0p5i: $ip_address = $this->input->ip_address(); goto RmHW3; c0z5r: s3GGF: goto nUyBv; nUyBv: $this->db->order_by("\x69\144", "\144\145\x73\x63"); goto YXHWR; EfYAQ: $this->db->where("\154\x6f\147\151\156", $identity); goto GE71j; RmHW3: Hmyzf: goto R_bWh; sa7Pw: $this->db->select("\164\151\x6d\145"); goto EfYAQ; xwB_k: return $qres->row()->time; goto HciaP; HciaP: xsCzv: goto C03e9; l0fy7: } public function get_last_attempt_ip($identity) { goto Omc2N; BrWr1: $this->db->select("\x69\x70\x5f\x61\x64\144\x72\x65\163\163"); goto Ox4y5; CMR1l: return $qres->row()->ip_address; goto RiNMO; Ox4y5: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto E8Xke; I_5h0: nTgIB: goto y3w6g; Omc2N: if (!($this->config->item("\164\x72\x61\143\153\x5f\154\157\147\151\x6e\x5f\141\x74\164\x65\x6d\x70\x74\x73", "\x69\x6f\156\x5f\141\165\x74\150") && $this->config->item("\x74\162\141\x63\153\137\x6c\157\x67\x69\x6e\x5f\151\160\137\x61\144\144\x72\x65\x73\163", "\151\157\156\x5f\x61\x75\164\x68"))) { goto nTgIB; } goto BrWr1; E8Xke: $this->db->order_by("\x69\x64", "\144\145\x73\143"); goto N7LQn; Zv0Ms: if (!($qres->num_rows() > 0)) { goto enoT8; } goto CMR1l; y3w6g: return ''; goto d9IHj; N7LQn: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\137\141\164\x74\145\155\160\164\x73"], 1); goto Zv0Ms; RiNMO: enoT8: goto I_5h0; d9IHj: } public function increase_login_attempts($identity) { goto L_JLK; VPkYD: ACEI8: goto YQzdz; hNaf1: $data["\151\160\137\x61\x64\x64\x72\145\x73\x73"] = $this->input->ip_address(); goto VPkYD; L_JLK: if (!$this->config->item("\164\162\x61\x63\153\x5f\x6c\157\x67\x69\x6e\x5f\x61\x74\x74\x65\x6d\160\164\x73", "\151\x6f\156\x5f\x61\165\164\x68")) { goto m6PZu; } goto zEuN0; cqr7X: if (!$this->config->item("\164\x72\x61\x63\x6b\137\154\x6f\147\151\156\x5f\151\x70\137\141\x64\144\162\x65\x73\x73", "\151\157\156\137\x61\x75\164\150")) { goto ACEI8; } goto hNaf1; SAFJc: m6PZu: goto tix4E; tix4E: return FALSE; goto bHicb; zEuN0: $data = ["\x69\x70\137\x61\144\144\x72\x65\x73\163" => '', "\x6c\x6f\147\x69\156" => $identity, "\164\151\x6d\145" => time()]; goto cqr7X; YQzdz: return $this->db->insert($this->tables["\x6c\157\147\151\156\x5f\141\164\x74\x65\155\160\164\x73"], $data); goto SAFJc; bHicb: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto vOTx6; v7H74: $this->db->where("\x69\160\137\141\144\x64\162\145\163\163", $ip_address); goto dp37O; ZLyqS: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto yf2Kk; dp37O: p3VmO: goto Am2wY; CjXfZ: $ip_address = $this->input->ip_address(); goto gZQQT; AZR90: return FALSE; goto XidfP; zP1Fj: GZOqB: goto AZR90; N9Y4g: if (isset($ip_address)) { goto wyE9z; } goto CjXfZ; vOTx6: if (!$this->config->item("\164\x72\x61\x63\153\137\154\157\147\151\156\137\x61\164\x74\x65\x6d\x70\164\163", "\x69\157\x6e\x5f\141\x75\x74\x68")) { goto GZOqB; } goto Z8sra; Z8sra: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\143\153\x6f\165\164\x5f\x74\151\x6d\145", "\151\157\156\x5f\x61\165\x74\150")); goto ZLyqS; Am2wY: $this->db->or_where("\x74\151\155\145\x20\74", time() - $old_attempts_expire_period, FALSE); goto LMLnQ; gZQQT: wyE9z: goto v7H74; yf2Kk: if (!$this->config->item("\164\162\x61\143\x6b\x5f\154\x6f\x67\151\x6e\x5f\151\x70\x5f\x61\144\x64\x72\x65\163\x73", "\151\157\156\137\x61\165\x74\150")) { goto p3VmO; } goto N9Y4g; LMLnQ: return $this->db->delete($this->tables["\x6c\x6f\x67\x69\156\137\141\x74\164\x65\x6d\x70\164\163"]); goto zP1Fj; XidfP: } public function limit($limit) { goto zol_0; O9ele: $this->_ion_limit = $limit; goto jJE6e; zol_0: $this->trigger_events("\154\x69\155\x69\x74"); goto O9ele; jJE6e: return $this; goto NtfMP; NtfMP: } public function offset($offset) { goto XzEj3; XzEj3: $this->trigger_events("\x6f\x66\x66\x73\x65\x74"); goto voWm1; voWm1: $this->_ion_offset = $offset; goto jMMGR; jMMGR: return $this; goto SnsP9; SnsP9: } public function where($where, $value = NULL) { goto Mb3tF; k8UPm: return $this; goto saxJz; LRlC6: gvtvY: goto RgMQr; RgMQr: array_push($this->_ion_where, $where); goto k8UPm; JSCd6: $where = [$where => $value]; goto LRlC6; ftq3u: if (is_array($where)) { goto gvtvY; } goto JSCd6; Mb3tF: $this->trigger_events("\167\150\145\162\x65"); goto ftq3u; saxJz: } public function like($like, $value = NULL, $position = "\x62\x6f\164\x68") { goto zB4jU; aZRuG: return $this; goto thZsJ; nIcMz: array_push($this->_ion_like, ["\x6c\151\153\145" => $like, "\166\x61\154\x75\x65" => $value, "\x70\157\x73\151\x74\x69\157\156" => $position]); goto aZRuG; zB4jU: $this->trigger_events("\x6c\x69\x6b\x65"); goto nIcMz; thZsJ: } public function select($select) { goto wgMTC; IknnG: return $this; goto w9Mbj; JiRpf: $this->_ion_select[] = $select; goto IknnG; wgMTC: $this->trigger_events("\x73\x65\x6c\x65\143\x74"); goto JiRpf; w9Mbj: } public function order_by($by, $order = "\144\145\x73\x63") { goto XMzMO; XMzMO: $this->trigger_events("\157\162\x64\x65\162\137\142\x79"); goto xC5Fp; V8M6E: $this->_ion_order = $order; goto KYQht; KYQht: return $this; goto rALQn; xC5Fp: $this->_ion_order_by = $by; goto V8M6E; rALQn: } public function row() { goto GFzwi; Jtvj6: $row = $this->response->row(); goto IIXc0; GFzwi: $this->trigger_events("\x72\x6f\x77"); goto Jtvj6; IIXc0: return $row; goto DEDRB; DEDRB: } public function row_array() { goto j0Uv5; j0Uv5: $this->trigger_events(["\x72\x6f\x77", "\x72\x6f\167\x5f\x61\x72\x72\x61\x79"]); goto My63n; we6nR: return $row; goto q7DAn; My63n: $row = $this->response->row_array(); goto we6nR; q7DAn: } public function result() { goto cndEl; cndEl: $this->trigger_events("\x72\145\x73\165\154\164"); goto D_x0h; h5LOb: return $result; goto B6TxF; D_x0h: $result = $this->response->result(); goto h5LOb; B6TxF: } public function result_array() { goto MM3VT; MM3VT: $this->trigger_events(["\162\145\x73\x75\154\x74", "\x72\145\x73\165\154\164\137\x61\162\162\141\x79"]); goto wtZc0; wtZc0: $result = $this->response->result_array(); goto XJC_h; XJC_h: return $result; goto IGXCj; IGXCj: } public function num_rows() { goto hmOXt; ZsUYk: return $result; goto mKCOv; hmOXt: $this->trigger_events(["\x6e\x75\x6d\x5f\162\157\x77\163"]); goto KhCzV; KhCzV: $result = $this->response->num_rows(); goto ZsUYk; mKCOv: } public function users($groups = NULL) { goto GRM2z; ic_z5: $groups = [$groups]; goto IUo3M; OzdO5: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto NpiS2; } goto kMwft; H3WNz: NpiS2: goto Ub96q; i_EVB: $this->_ion_select = []; goto aSO04; APCks: UsIM7: goto KREL_; SLgeX: foreach ($this->_ion_select as $select) { $this->db->select($select); UiC6R: } goto ZHwED; x0qdG: n5wf5: goto vpw4v; ktK8M: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto baddp; } goto JoV4G; hHx6T: $this->response = $this->db->get($this->tables["\x75\x73\x65\x72\163"]); goto p1AjW; EvnF0: IVSAl: goto XMGFI; vpw4v: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto I9tCG; GGVsk: $this->_ion_limit = NULL; goto FfTro; aSO04: ZNGOF: goto KMZev; rZriS: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto uiAE2; } goto g8iwN; yR0MW: $this->db->limit($this->_ion_limit); goto GGVsk; KMZev: if (!isset($groups)) { goto IVSAl; } goto RzF7L; KY_kA: $this->db->where_in($this->tables["\147\x72\157\x75\160\163"] . "\56\156\141\x6d\x65", $group_names); goto I6XLb; GRM2z: $this->trigger_events("\x75\163\x65\162\x73"); goto ktK8M; u0jyW: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\137\x77\x68\x65\x72\x65\x5f\151\x6e" : "\x77\150\x65\x72\x65\137\151\x6e"; goto a3b5S; Z8CaK: $group_ids = []; goto WwQ7X; FfTro: bF2PB: goto uKe2U; QviFL: $this->_ion_like = []; goto H3WNz; S3avV: VPmnm: goto wN1mS; NzuZA: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto CapxY; XMGFI: $this->trigger_events("\145\x78\164\x72\x61\137\x77\150\x65\162\145"); goto rZriS; nyQsF: if (!isset($this->_ion_limit)) { goto bF2PB; } goto yR0MW; WwQ7X: $group_names = []; goto Wq53z; uKe2U: goto UsIM7; goto x0qdG; ArqXT: qx8OE: goto hHx6T; nRCVL: $this->db->join($this->tables["\165\x73\x65\x72\x73\137\x67\x72\x6f\165\x70\163"], $this->tables["\165\163\145\x72\163\x5f\147\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\x75\163\x65\x72\x73"] . "\x3d" . $this->tables["\165\x73\x65\162\x73"] . "\x2e\x69\x64", "\x69\x6e\156\145\x72"); goto HLaL7; I9tCG: $this->_ion_limit = NULL; goto V_Hc5; j9Ro2: goto ZNGOF; goto yYP7i; I6XLb: HS05i: goto t6pqa; CapxY: $this->_ion_order = NULL; goto zAyIA; Wq53z: foreach ($groups as $group) { goto pUrIE; pUrIE: if (is_numeric($group)) { goto rwhu0; } goto KM3ph; qm30H: $group_ids[] = $group; goto aUkRl; pAd3s: goto Hg90j; goto rpNTh; g1QJ2: LWWHa: goto z0etn; rpNTh: rwhu0: goto qm30H; aUkRl: Hg90j: goto g1QJ2; KM3ph: $group_names[] = $group; goto pAd3s; z0etn: } goto cqfzl; cqfzl: NsB0r: goto u0jyW; kMwft: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\153\145"], $like["\166\x61\154\x75\x65"], $like["\160\x6f\163\151\164\151\x6f\156"]); JhsGz: } goto YI8xl; JoV4G: $this->db->select([$this->tables["\165\163\145\x72\163"] . "\x2e\x2a", $this->tables["\165\x73\145\162\x73"] . "\x2e\x69\x64\40\x61\x73\x20\151\144", $this->tables["\165\163\x65\x72\163"] . "\56\x69\x64\x20\x61\x73\x20\x75\x73\145\x72\x5f\151\144"]); goto j9Ro2; ZHwED: xUhJy: goto i_EVB; yYP7i: baddp: goto SLgeX; HLaL7: hvxqg: goto Z8CaK; a3b5S: if (empty($group_names)) { goto HS05i; } goto gwLTj; zAyIA: $this->_ion_order_by = NULL; goto ArqXT; e9tqi: if (!(isset($groups) && !empty($groups))) { goto hvxqg; } goto DH66i; IUo3M: FRUrh: goto e9tqi; DH66i: $this->db->distinct(); goto nRCVL; wN1mS: $this->_ion_where = []; goto Yc3Mv; KREL_: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto qx8OE; } goto NzuZA; Ub96q: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto n5wf5; } goto nyQsF; RzF7L: if (is_array($groups)) { goto FRUrh; } goto ic_z5; t6pqa: if (empty($group_ids)) { goto gwWVR; } goto RYc8g; gwLTj: $this->db->join($this->tables["\147\162\157\165\x70\x73"], $this->tables["\165\x73\x65\x72\x73\x5f\147\162\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\x72\x6f\165\160\163"] . "\x20\75\x20" . $this->tables["\147\x72\x6f\165\x70\163"] . "\x2e\151\x64", "\151\156\x6e\x65\x72"); goto KY_kA; Yc3Mv: uiAE2: goto OzdO5; V_Hc5: $this->_ion_offset = NULL; goto APCks; p1AjW: return $this; goto GHloe; YI8xl: wpCz3: goto QviFL; fKzP9: gwWVR: goto EvnF0; RYc8g: $this->db->{$or_where_in}($this->tables["\165\x73\x65\x72\163\x5f\x67\162\157\165\x70\163"] . "\x2e" . $this->join["\147\x72\x6f\x75\160\163"], $group_ids); goto fKzP9; g8iwN: foreach ($this->_ion_where as $where) { $this->db->where($where); QhHr2: } goto S3avV; GHloe: } public function user($id = NULL) { goto rIoAc; L9e9F: $id = isset($id) ? $id : $this->session->userdata("\165\x73\145\162\x5f\151\x64"); goto yTpqt; yTpqt: $this->limit(1); goto cSADl; dWYZG: return $this; goto aVXJX; nX_WB: $this->users(); goto dWYZG; LJGWY: $this->where($this->tables["\x75\x73\x65\162\x73"] . "\x2e\x69\x64", $id); goto nX_WB; rIoAc: $this->trigger_events("\165\163\145\x72"); goto L9e9F; cSADl: $this->order_by($this->tables["\165\163\x65\162\x73"] . "\x2e\x69\x64", "\x64\x65\x73\143"); goto LJGWY; aVXJX: } public function get_users_groups($id = FALSE) { goto X4ubj; luH6Y: return $this->db->select($this->tables["\x75\x73\x65\162\x73\137\147\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\157\165\x70\163"] . "\40\x61\x73\x20\151\144\x2c\x20" . $this->tables["\147\162\x6f\165\x70\163"] . "\x2e\156\x61\155\145\x2c\40" . $this->tables["\147\x72\157\165\x70\x73"] . "\56\x64\145\163\x63\x72\151\x70\164\x69\157\x6e")->where($this->tables["\165\x73\x65\x72\x73\x5f\x67\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\165\x73\x65\x72\163"], $id)->join($this->tables["\x67\x72\x6f\165\x70\163"], $this->tables["\165\x73\145\x72\x73\137\x67\x72\157\x75\x70\163"] . "\56" . $this->join["\147\x72\x6f\165\x70\x73"] . "\x3d" . $this->tables["\x67\162\x6f\165\160\x73"] . "\x2e\151\x64")->get($this->tables["\165\163\x65\162\163\x5f\147\x72\157\x75\160\x73"]); goto mF3Yj; X4ubj: $this->trigger_events("\147\145\164\x5f\x75\x73\x65\x72\x73\137\x67\162\x6f\165\160"); goto N1Bcw; N1Bcw: $id || ($id = $this->session->userdata("\x75\x73\145\162\137\x69\144")); goto luH6Y; mF3Yj: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto rcggu; lsnsL: Af6RQ: goto mIM1d; Z1UfC: goto DizR6; goto lsnsL; xJWtg: uVnY5: goto Ym2aP; rcggu: $this->trigger_events("\151\x6e\137\147\162\157\x75\160"); goto NXvIV; NXvIV: $id || ($id = $this->session->userdata("\165\x73\x65\162\137\151\144")); goto wcx_b; bgWIx: $users_groups = $this->get_users_groups($id)->result(); goto B2sqn; bnui0: if (isset($this->_cache_user_in_group[$id])) { goto Af6RQ; } goto bgWIx; sU2W4: rQCtF: goto QLBEj; Ym2aP: return $check_all; goto jREB1; wcx_b: if (is_array($check_group)) { goto M2jfh; } goto M6S5U; B2sqn: $groups_array = []; goto M4Qiz; M6S5U: $check_group = [$check_group]; goto DzNne; s_nrK: DizR6: goto wrz86; mIM1d: $groups_array = $this->_cache_user_in_group[$id]; goto s_nrK; wrz86: foreach ($check_group as $key => $value) { goto t7Unr; t7Unr: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto EHmks; QaJSh: lmsWO: goto N_I4V; HKtft: return !$check_all; goto QaJSh; N_I4V: heJFh: goto tFVZq; EHmks: if (!(in_array($value, $groups) xor $check_all)) { goto lmsWO; } goto HKtft; tFVZq: } goto xJWtg; DzNne: M2jfh: goto bnui0; QLBEj: $this->_cache_user_in_group[$id] = $groups_array; goto Z1UfC; M4Qiz: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; ARm7i: } goto sU2W4; jREB1: } public function add_to_group($group_ids, $user_id = FALSE) { goto ejJKH; aEPsw: LZCpv: goto DBp3c; XURit: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\162\x5f\151\x64")); goto tK0rW; tK0rW: if (is_array($group_ids)) { goto eGt90; } goto q0BRq; ejJKH: $this->trigger_events("\141\144\144\x5f\x74\157\137\147\162\157\165\x70"); goto XURit; dTLdP: eGt90: goto B5cYR; B5cYR: $return = 0; goto GaNvQ; q0BRq: $group_ids = [$group_ids]; goto dTLdP; DBp3c: return $return; goto SeR2s; GaNvQ: foreach ($group_ids as $group_id) { goto vMsdF; Sbm5n: $this->_cache_groups[$group_id] = $group_name; goto hylD5; bF0Fe: g8rqb: goto BPI9L; gO4X5: vac2i: goto tUVSN; Xv04b: $group_name = $group[0]->name; goto Sbm5n; zfqHg: if (isset($this->_cache_groups[$group_id])) { goto ah6wb; } goto Lr9Fj; zjbhQ: $group_name = $this->_cache_groups[$group_id]; goto gO4X5; IJE2I: $return++; goto UfBMH; tUVSN: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto IJE2I; hylD5: goto vac2i; goto JXcjk; UfBMH: ad5cj: goto bF0Fe; Lr9Fj: $group = $this->group($group_id)->result(); goto Xv04b; JXcjk: ah6wb: goto zjbhQ; vMsdF: if (!$this->db->insert($this->tables["\x75\x73\145\162\x73\137\x67\x72\157\x75\160\163"], [$this->join["\147\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\x75\x73\145\x72\163"] => (float) $user_id])) { goto ad5cj; } goto zfqHg; BPI9L: } goto aEPsw; SeR2s: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto ug6Pz; KwS6w: return $return; goto TDf1A; gY6yA: et4Qq: goto KwS6w; ePQ6M: goto et4Qq; goto cPats; V0ow0: foreach ($group_ids as $group_id) { goto XnCxu; XnCxu: $this->db->delete($this->tables["\165\163\145\162\x73\x5f\x67\x72\x6f\x75\160\x73"], [$this->join["\147\x72\157\x75\160\163"] => (float) $group_id, $this->join["\165\163\x65\162\163"] => (float) $user_id]); goto IgAYM; IgAYM: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto qL8vm; } goto HopLn; HopLn: unset($this->_cache_user_in_group[$user_id][$group_id]); goto Hc4_P; e1I3C: LOpP5: goto ZADyF; Hc4_P: qL8vm: goto e1I3C; ZADyF: } goto xH89b; mHOnv: ShRNB: goto V0ow0; mIiVg: return FALSE; goto DoqbZ; DoqbZ: NyT1A: goto ExffE; cPats: cRIU9: goto UymaI; IBwOh: if (!($return = $this->db->delete($this->tables["\165\x73\x65\162\163\x5f\147\x72\x6f\x75\x70\x73"], [$this->join["\165\163\x65\162\x73"] => (float) $user_id]))) { goto iP086; } goto R228c; jGG20: iP086: goto ePQ6M; ExffE: if (!empty($group_ids)) { goto cRIU9; } goto IBwOh; iiUUz: if (!empty($user_id)) { goto NyT1A; } goto mIiVg; ug6Pz: $this->trigger_events("\x72\x65\x6d\157\x76\x65\x5f\x66\x72\x6f\155\137\x67\x72\x6f\165\160"); goto iiUUz; MHSm9: $return = TRUE; goto gY6yA; DOmPa: $group_ids = [$group_ids]; goto mHOnv; R228c: $this->_cache_user_in_group[$user_id] = []; goto jGG20; UymaI: if (is_array($group_ids)) { goto ShRNB; } goto DOmPa; xH89b: JZUGe: goto MHSm9; TDf1A: } public function groups() { goto g60W0; gMvOz: goto eaSg6; goto MgKjP; mTTxB: mLJFm: goto VKPod; tiHiy: foreach ($this->_ion_where as $where) { $this->db->where($where); zWn4W: } goto mTTxB; eKjlG: $this->db->limit($this->_ion_limit); goto JFkWk; mEt3W: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto mMzrj; PFJtV: $this->response = $this->db->get($this->tables["\147\x72\x6f\165\160\x73"]); goto d4T9Y; FUp5m: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto LVWqj; d4T9Y: return $this; goto Zgawz; YAfcA: tuyId: goto gMvOz; VKPod: $this->_ion_where = []; goto kfbi4; G9xwq: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto e7TNS; } goto FUp5m; wtF7l: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto dEA_V; } goto tiHiy; g60W0: $this->trigger_events("\x67\162\157\x75\x70\163"); goto wtF7l; MgKjP: Ipo5x: goto mEt3W; HsvlB: if (!isset($this->_ion_limit)) { goto tuyId; } goto eKjlG; JFkWk: $this->_ion_limit = NULL; goto YAfcA; DmoOh: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto Ipo5x; } goto HsvlB; CPxgp: eaSg6: goto G9xwq; kfbi4: dEA_V: goto DmoOh; RLrAS: $this->_ion_offset = NULL; goto CPxgp; mMzrj: $this->_ion_limit = NULL; goto RLrAS; LVWqj: e7TNS: goto PFJtV; Zgawz: } public function group($id = NULL) { goto qxlh3; dAEZV: $this->where($this->tables["\147\162\157\x75\x70\x73"] . "\x2e\x69\144", $id); goto oXQcb; NS8X7: if (!isset($id)) { goto pAEs9; } goto dAEZV; aGrgC: $this->limit(1); goto Q9bOV; oXQcb: pAEs9: goto aGrgC; DbmYl: return $this->groups(); goto hHmEp; qxlh3: $this->trigger_events("\147\162\x6f\165\x70"); goto NS8X7; Q9bOV: $this->order_by("\x69\144", "\x64\145\163\143"); goto DbmYl; hHmEp: } public function update($id, array $data) { goto mSTtu; vp4_W: if (!array_key_exists("\160\141\x73\x73\167\x6f\x72\144", $data)) { goto G0__z; } goto cbega; Ms2BC: $data = $this->_filter_data($this->tables["\165\163\x65\x72\163"], $data); goto RSZ35; cbega: if (!empty($data["\x70\141\x73\163\x77\x6f\162\144"])) { goto tr2Uf; } goto J40Ej; PthNP: return FALSE; goto xTEZS; U_d_k: KSy9r: goto zKujA; j62XC: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto hUh38; } goto Fn2vA; MWqco: return FALSE; goto ZpV7N; peV22: return FALSE; goto HeGkQ; w0Jk5: if (!($data["\x70\x61\x73\x73\167\x6f\x72\x64"] === FALSE)) { goto uXiOx; } goto fssrF; ZpV7N: uXiOx: goto GP5jW; J40Ej: unset($data["\x70\x61\163\163\167\157\162\144"]); goto nGgSG; En0Bk: $user = $this->user($id)->row(); goto LT8IF; nGgSG: goto OKIjI; goto FgdRy; K2Otj: G0__z: goto U_d_k; mSTtu: $this->trigger_events("\160\162\x65\x5f\x75\x70\x64\141\164\145\x5f\x75\163\145\x72"); goto En0Bk; c3yuF: $this->trigger_events(["\160\x6f\x73\x74\137\x75\160\x64\141\x74\x65\137\165\x73\x65\x72", "\x70\x6f\x73\164\137\165\160\x64\x61\x74\145\137\165\163\x65\x72\137\x75\x6e\163\x75\143\x63\145\x73\163\146\165\154"]); goto N3mml; LFzjz: $this->set_error("\x75\x70\144\x61\164\145\137\165\156\x73\165\143\143\x65\163\x73\146\165\154"); goto PthNP; rIcci: return TRUE; goto PD5Fq; RSZ35: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\141\x73\x73\x77\157\x72\x64", $data) || array_key_exists("\x65\x6d\141\x69\x6c", $data))) { goto KSy9r; } goto vp4_W; zKujA: $this->trigger_events("\x65\x78\x74\162\141\137\x77\x68\145\x72\145"); goto qH6Qz; Fn2vA: $this->db->trans_rollback(); goto Pm8js; LT8IF: $this->db->trans_begin(); goto j62XC; HeGkQ: zwNXx: goto jMjUI; QetpL: $this->trigger_events(["\x70\157\163\164\x5f\165\x70\x64\x61\x74\145\x5f\x75\163\x65\x72", "\x70\x6f\x73\164\x5f\165\160\x64\x61\x74\x65\137\x75\x73\145\x72\137\x75\x6e\x73\165\x63\143\145\163\163\146\165\x6c"]); goto oWSQJ; vAyBb: $this->trigger_events(["\160\157\x73\x74\x5f\x75\160\144\141\164\x65\137\165\x73\145\x72", "\160\x6f\x73\x74\x5f\x75\160\144\x61\164\x65\x5f\165\x73\145\162\137\x73\x75\x63\x63\x65\163\163\146\x75\154"]); goto UK9Z3; FgdRy: tr2Uf: goto Y86WE; N3mml: $this->set_error("\165\x70\144\141\x74\x65\137\x75\x6e\163\165\143\x63\x65\x73\163\x66\165\x6c"); goto MWqco; FPGQ2: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\160\144\x61\x74\145\x5f\x75\163\145\162", "\x70\157\x73\164\x5f\165\x70\144\141\164\x65\137\x75\163\x65\x72\137\x75\x6e\x73\x75\143\143\145\163\x73\x66\x75\x6c"]); goto LFzjz; Y86WE: $data["\160\141\x73\x73\167\157\162\x64"] = $this->hash_password($data["\x70\x61\x73\163\x77\157\162\144"], $user->{$this->identity_column}); goto w0Jk5; VI7Ls: $this->db->trans_rollback(); goto QetpL; jMjUI: $this->db->trans_commit(); goto vAyBb; fssrF: $this->db->trans_rollback(); goto c3yuF; Pm8js: $this->set_error("\x61\x63\143\x6f\x75\x6e\164\137\143\x72\x65\x61\164\x69\157\156\x5f\144\165\x70\x6c\x69\143\141\164\x65\x5f\x69\144\x65\156\x74\151\164\x79"); goto FPGQ2; UK9Z3: $this->set_message("\165\x70\x64\x61\x74\145\x5f\x73\x75\x63\143\145\163\163\146\x75\x6c"); goto rIcci; qH6Qz: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, ["\151\144" => $user->id]); goto aNeWT; xTEZS: hUh38: goto Ms2BC; GP5jW: OKIjI: goto K2Otj; aNeWT: if (!($this->db->trans_status() === FALSE)) { goto zwNXx; } goto VI7Ls; oWSQJ: $this->set_error("\165\160\144\141\x74\145\x5f\165\156\163\x75\x63\143\x65\163\163\x66\x75\154"); goto peV22; PD5Fq: } public function delete_user($id) { goto LWsot; PdvHM: $this->db->delete($this->tables["\165\163\x65\162\163"], ["\151\144" => $id]); goto w_Uuq; y5XSz: return TRUE; goto l41PH; z6TKM: $this->db->trans_commit(); goto eNZTb; BYtb2: $this->set_error("\144\145\154\x65\164\x65\x5f\x75\x6e\x73\165\143\143\145\163\163\x66\165\154"); goto U6feE; LWsot: $this->trigger_events("\160\162\x65\x5f\144\x65\154\x65\164\x65\x5f\165\163\145\x72"); goto tAmA8; tAmA8: $this->db->trans_begin(); goto cAyB2; cAyB2: $this->remove_from_group(NULL, $id); goto PdvHM; GAzf7: $this->trigger_events(["\x70\x6f\x73\164\x5f\x64\x65\154\145\x74\145\x5f\165\x73\x65\162", "\x70\x6f\x73\164\x5f\x64\145\x6c\145\x74\145\137\165\x73\x65\162\137\x75\x6e\163\165\x63\x63\x65\163\163\x66\165\154"]); goto BYtb2; gBJLi: yfahP: goto z6TKM; CTIk3: $this->set_message("\x64\x65\154\x65\x74\145\x5f\163\165\143\x63\x65\163\163\146\x75\x6c"); goto y5XSz; eNZTb: $this->trigger_events(["\160\157\163\164\137\x64\x65\154\x65\164\x65\x5f\165\163\145\162", "\160\x6f\163\x74\x5f\x64\x65\x6c\145\164\x65\137\x75\x73\145\162\x5f\x73\165\143\x63\145\x73\x73\146\x75\154"]); goto CTIk3; SKN3b: $this->db->trans_rollback(); goto GAzf7; U6feE: return FALSE; goto gBJLi; w_Uuq: if (!($this->db->trans_status() === FALSE)) { goto yfahP; } goto SKN3b; l41PH: } public function update_last_login($id) { goto Z1pHu; W0ZlD: $this->db->update($this->tables["\x75\163\x65\162\x73"], ["\x6c\141\163\164\137\154\x6f\147\x69\x6e" => time()], ["\151\x64" => $id]); goto BCWZa; gV2dp: $this->load->helper("\144\141\x74\145"); goto l1uno; l1uno: $this->trigger_events("\x65\170\x74\x72\141\137\167\150\x65\162\145"); goto W0ZlD; BCWZa: return $this->db->affected_rows() == 1; goto NqbS7; Z1pHu: $this->trigger_events("\165\x70\144\x61\164\145\137\x6c\x61\163\x74\x5f\154\157\147\x69\156"); goto gV2dp; NqbS7: } public function set_lang($lang = "\x65\156") { goto ciX1a; tzE_i: $expire = self::MAX_COOKIE_LIFETIME; goto SvGa6; Xu8LT: LsdDK: goto tzE_i; kU0r7: goto DsJu7; goto Xu8LT; t27dX: set_cookie(["\156\x61\x6d\145" => "\154\x61\x6e\x67\x5f\x63\157\144\x65", "\166\141\x6c\165\x65" => $lang, "\145\170\160\x69\162\145" => $expire]); goto jtQ4v; EZvw4: $expire = $this->config->item("\165\163\145\x72\x5f\x65\170\160\151\x72\145", "\151\157\156\137\141\165\164\150"); goto kU0r7; ciX1a: $this->trigger_events("\163\145\x74\137\x6c\141\156\147"); goto UOeHh; jtQ4v: return TRUE; goto Rdwvm; SvGa6: DsJu7: goto t27dX; UOeHh: if ($this->config->item("\x75\163\x65\162\x5f\145\x78\160\151\x72\x65", "\x69\157\156\137\x61\x75\x74\150") === 0) { goto LsdDK; } goto EZvw4; Rdwvm: } public function set_session($user) { goto aAVcn; rv0jR: $this->trigger_events("\x70\157\163\x74\137\163\x65\x74\137\x73\145\x73\163\x69\157\x6e"); goto cQZcb; ztDZO: $session_data = ["\151\144\145\156\164\151\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\141\151\x6c" => $user->email, "\165\163\145\x72\137\151\144" => $user->id, "\157\154\x64\137\154\x61\163\164\137\154\x6f\x67\x69\x6e" => $user->last_login, "\x6c\141\x73\x74\x5f\x63\150\x65\143\x6b" => time()]; goto WWrV3; cQZcb: return TRUE; goto YG8Fi; WWrV3: $this->session->set_userdata($session_data); goto rv0jR; aAVcn: $this->trigger_events("\160\x72\x65\x5f\163\145\164\137\x73\x65\163\x73\151\157\156"); goto ztDZO; YG8Fi: } public function remember_user($identity) { goto dDS05; ZInOw: $expire = self::MAX_COOKIE_LIFETIME; goto yZBGP; t_Hsr: if ($identity) { goto F1xjg; } goto Q1Mik; b_oNN: $this->db->update($this->tables["\x75\163\145\162\163"], ["\162\x65\x6d\145\x6d\x62\x65\x72\x5f\x73\x65\154\145\143\x74\157\162" => $token->selector, "\162\x65\155\x65\155\142\145\162\137\x63\157\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto tFLGD; MErrQ: $this->trigger_events(["\x70\x6f\x73\164\137\x72\x65\155\x65\x6d\x62\x65\x72\137\x75\x73\x65\x72", "\x72\x65\x6d\x65\155\142\x65\162\x5f\x75\x73\x65\162\x5f\x73\x75\143\x63\145\163\163\x66\x75\x6c"]); goto Ns3Ed; hFaz6: $this->trigger_events(["\x70\x6f\163\x74\137\x72\145\x6d\x65\x6d\142\x65\162\x5f\165\163\145\162", "\x72\145\x6d\145\155\x62\x65\x72\137\x75\163\145\162\x5f\x75\156\163\x75\x63\143\145\x73\x73\x66\165\154"]); goto e65l1; aCY6s: $token = $this->_generate_selector_validator_couple(); goto onT0U; Haa3x: if ($this->config->item("\x75\163\x65\162\x5f\145\170\160\151\x72\145", "\x69\157\156\x5f\141\x75\164\150") === 0) { goto JHcgQ; } goto XMoT3; yZBGP: DZN1l: goto SXn0b; dhk2I: JHcgQ: goto ZInOw; tFLGD: if (!($this->db->affected_rows() > -1)) { goto REIg3; } goto Haa3x; dsCvB: REIg3: goto HeowB; e65l1: return FALSE; goto h5zjY; Ns3Ed: return TRUE; goto dsCvB; g2BeW: F1xjg: goto aCY6s; XMoT3: $expire = $this->config->item("\x75\x73\145\162\137\x65\x78\x70\151\162\145", "\151\157\156\x5f\x61\165\x74\150"); goto TUklD; TUklD: goto DZN1l; goto dhk2I; onT0U: if (!$token->validator_hashed) { goto euR45; } goto b_oNN; Q1Mik: return FALSE; goto g2BeW; HeowB: euR45: goto hFaz6; SXn0b: set_cookie(["\156\x61\155\x65" => $this->config->item("\162\x65\155\145\x6d\142\x65\x72\137\x63\x6f\x6f\x6b\x69\x65\137\x6e\141\155\145", "\x69\x6f\156\137\141\x75\164\x68"), "\166\x61\x6c\x75\145" => $token->user_code, "\145\x78\160\x69\x72\145" => $expire]); goto MErrQ; dDS05: $this->trigger_events("\x70\x72\x65\x5f\162\145\x6d\x65\155\x62\x65\x72\x5f\165\163\x65\162"); goto t_Hsr; h5zjY: } public function login_remembered_user() { goto PLfcW; FVqNM: $query = $this->db->select($this->identity_column . "\54\40\x69\x64\54\40\x65\155\141\151\154\x2c\x20\162\145\155\145\155\142\x65\162\137\x63\157\144\145\54\40\x6c\141\x73\164\137\x6c\157\147\x69\156")->where("\x72\145\155\145\x6d\142\x65\x72\137\163\145\154\x65\x63\x74\x6f\162", $token->selector)->where("\x61\143\x74\151\x76\x65", 1)->limit(1)->get($this->tables["\x75\163\145\x72\163"]); goto uj4Of; pCC8j: DNFaM: goto unUd1; rGJM2: $this->clear_forgotten_password_code($identity); goto bkx3z; FcG4M: $this->set_session($user); goto rGJM2; MX4I3: $user = $query->row(); goto Up0RS; xOR9u: if (!($token === FALSE)) { goto DNFaM; } goto QCcHi; arTXG: OLL1D: goto Yqtbu; PLfcW: $this->trigger_events("\160\162\145\x5f\154\x6f\x67\151\x6e\x5f\x72\145\155\x65\155\142\x65\x72\145\x64\x5f\165\163\x65\162"); goto EIYrs; uj4Of: if (!($query->num_rows() === 1)) { goto Kgo_y; } goto MX4I3; EIYrs: $remember_cookie = get_cookie($this->config->item("\x72\145\x6d\145\155\x62\145\162\137\143\157\x6f\153\151\145\x5f\156\141\155\x65", "\151\x6f\156\137\141\x75\x74\x68")); goto KiTYU; s3IeJ: return FALSE; goto pCC8j; UeZ1p: $this->update_last_login($user->id); goto FcG4M; QCcHi: $this->trigger_events(["\x70\157\163\x74\137\154\157\147\151\156\137\x72\145\x6d\x65\x6d\x62\x65\x72\145\144\x5f\x75\x73\145\x72", "\x70\157\x73\164\137\154\x6f\x67\x69\156\137\x72\145\x6d\x65\x6d\x62\145\x72\145\144\137\x75\163\x65\x72\x5f\x75\156\163\165\x63\143\145\x73\163\146\x75\x6c"]); goto s3IeJ; Up0RS: $identity = $user->{$this->identity_column}; goto EjXjK; Yqtbu: Kgo_y: goto R3v30; DAuKW: return TRUE; goto arTXG; ec2ut: $this->session->sess_regenerate(FALSE); goto NjsG_; bkx3z: if (!$this->config->item("\165\x73\x65\162\x5f\x65\170\164\145\156\x64\137\157\x6e\x5f\154\x6f\147\151\x6e", "\x69\x6f\156\x5f\x61\x75\x74\x68")) { goto WMiV6; } goto Mvs3M; EjXjK: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto OLL1D; } goto UeZ1p; ztFbT: return FALSE; goto RQz9N; KiTYU: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto xOR9u; xWPrq: WMiV6: goto ec2ut; Mvs3M: $this->remember_user($identity); goto xWPrq; unUd1: $this->trigger_events("\x65\x78\164\162\141\137\167\150\x65\x72\x65"); goto FVqNM; R3v30: delete_cookie($this->config->item("\x72\145\155\145\155\x62\145\162\x5f\143\157\x6f\x6b\151\145\137\x6e\x61\155\x65", "\151\x6f\156\x5f\x61\165\x74\150")); goto vRS0l; NjsG_: $this->trigger_events(["\160\157\163\x74\x5f\154\157\x67\151\x6e\x5f\162\x65\x6d\145\x6d\142\x65\162\145\144\137\165\x73\145\162", "\x70\157\x73\x74\137\x6c\x6f\147\x69\156\137\x72\145\155\x65\x6d\x62\145\162\x65\x64\x5f\165\x73\x65\162\137\x73\165\143\143\x65\x73\x73\146\165\x6c"]); goto DAuKW; vRS0l: $this->trigger_events(["\160\x6f\163\x74\137\154\x6f\x67\x69\156\137\162\145\x6d\145\155\x62\x65\x72\145\144\137\x75\163\145\x72", "\x70\x6f\163\x74\137\x6c\x6f\x67\151\x6e\137\162\x65\155\x65\155\142\x65\162\145\x64\x5f\165\163\145\162\x5f\165\156\x73\165\x63\x63\x65\x73\x73\x66\165\x6c"]); goto ztFbT; RQz9N: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto vdmlE; Z6yD8: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\x73"], ["\x6e\x61\x6d\x65" => $group_name])->num_rows(); goto TA6q7; Vjawb: if (empty($additional_data)) { goto c4ST8; } goto OmI0z; LSq3t: return FALSE; goto J1seP; y2_Ss: $this->db->insert($this->tables["\147\162\x6f\x75\x70\163"], $data); goto ooKuE; Yd9yD: $this->trigger_events("\x65\x78\164\162\141\137\147\x72\x6f\165\160\x5f\163\145\164"); goto y2_Ss; tW0GF: J2Ef1: goto Z6yD8; OmI0z: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\160\x73"], $additional_data), $data); goto tsTvM; Quo4C: $this->set_error("\147\x72\x6f\165\160\137\156\141\155\145\137\x72\145\x71\165\x69\162\145\144"); goto dYV2b; TA6q7: if (!($existing_group !== 0)) { goto GBswS; } goto l0laA; dYV2b: return FALSE; goto tW0GF; ooKuE: $group_id = $this->db->insert_id($this->tables["\147\x72\157\x75\x70\163"] . "\x5f\x69\x64\x5f\163\x65\x71"); goto MSEHH; J1seP: GBswS: goto RbyMq; tsTvM: c4ST8: goto Yd9yD; l0laA: $this->set_error("\x67\162\x6f\165\x70\x5f\x61\154\x72\x65\x61\x64\171\137\x65\170\x69\163\x74\x73"); goto LSq3t; RbyMq: $data = ["\156\141\155\145" => $group_name, "\144\x65\163\143\162\x69\x70\x74\151\x6f\x6e" => $group_description]; goto Vjawb; FcMM2: return $group_id; goto HPOgb; MSEHH: $this->set_message("\147\162\157\165\x70\x5f\x63\162\145\x61\x74\151\157\x6e\x5f\x73\165\x63\143\x65\x73\163\146\165\154"); goto FcMM2; vdmlE: if ($group_name) { goto J2Ef1; } goto Quo4C; HPOgb: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto A8TT_; r1pOf: $this->set_message("\x67\x72\157\165\x70\x5f\165\x70\x64\x61\164\x65\137\163\x75\x63\x63\145\163\163\146\x75\154"); goto d0JGP; U9Fq6: gJCiE: goto Z29GK; KVK97: if (!($this->config->item("\141\144\x6d\x69\156\x5f\x67\162\x6f\x75\160", "\x69\157\x6e\x5f\x61\x75\x74\x68") === $group->name && $group_name !== $group->name)) { goto aPdFM; } goto P7xNj; e2OAw: if (empty($additional_data)) { goto MeQf8; } goto ksxGv; Qt0qq: aPdFM: goto e2OAw; Bh2cK: if (empty($group_name)) { goto bcdzL; } goto wAP0X; GdsBb: MeQf8: goto rda33; P7xNj: $this->set_error("\147\x72\157\x75\x70\137\156\141\x6d\145\x5f\x61\x64\155\151\x6e\137\156\x6f\164\x5f\x61\x6c\x74\145\x72"); goto tBe8W; WIUY9: bcdzL: goto mONsJ; ksxGv: $data = array_merge($this->_filter_data($this->tables["\147\162\157\165\x70\163"], $additional_data), $data); goto GdsBb; A8TT_: if (!empty($group_id)) { goto gJCiE; } goto gR80A; mONsJ: $group = $this->db->get_where($this->tables["\x67\x72\157\165\160\163"], ["\151\x64" => $group_id])->row(); goto KVK97; e4Y9b: w85Dx: goto vNJL4; Z29GK: $data = []; goto Bh2cK; gR80A: return FALSE; goto U9Fq6; o0DQ6: return FALSE; goto e4Y9b; wAP0X: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\x75\x70\163"], ["\156\141\x6d\145" => $group_name])->row(); goto iQHGP; vNJL4: $data["\156\x61\155\x65"] = $group_name; goto WIUY9; d0JGP: return TRUE; goto p9xus; V1TUw: $this->set_error("\x67\x72\157\x75\x70\137\141\x6c\162\145\x61\x64\171\x5f\145\170\151\x73\164\x73"); goto o0DQ6; rda33: $this->db->update($this->tables["\147\162\157\x75\x70\x73"], $data, ["\151\x64" => $group_id]); goto r1pOf; tBe8W: return FALSE; goto Qt0qq; iQHGP: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto w85Dx; } goto V1TUw; p9xus: } public function delete_group($group_id = FALSE) { goto bd3ps; PLpH5: $this->db->delete($this->tables["\x75\163\x65\x72\163\137\147\x72\157\165\160\163"], [$this->join["\147\162\157\x75\x70\x73"] => $group_id]); goto LwwPg; AhN_Z: return FALSE; goto kXUt8; GKf4m: $this->set_message("\147\162\157\x75\x70\137\144\x65\x6c\x65\164\x65\x5f\163\x75\143\143\x65\x73\x73\x66\x75\x6c"); goto mziCj; vl_7o: $this->trigger_events(["\x70\x6f\163\x74\137\x64\x65\x6c\145\x74\145\x5f\147\x72\157\x75\x70", "\x70\x6f\163\x74\x5f\x64\145\154\145\x74\x65\137\x67\162\x6f\165\160\x5f\165\156\163\165\143\143\145\x73\163\146\x75\154"]); goto tOWvX; uZiTz: $group = $this->group($group_id)->row(); goto ofMoo; mnHkj: $this->trigger_events(["\160\x6f\163\x74\137\144\x65\154\145\164\x65\137\x67\162\x6f\x75\160", "\x70\157\163\x74\x5f\144\x65\154\145\164\x65\137\x67\x72\157\x75\160\x5f\x6e\157\x74\141\x6c\x6c\157\x77\145\x64"]); goto fZD36; mziCj: return TRUE; goto q5MAv; GZmqO: H1Vj0: goto aUHWW; bd3ps: if (!(!$group_id || empty($group_id))) { goto Teh_1; } goto QFM4i; ZV1It: Teh_1: goto uZiTz; tOWvX: $this->set_error("\147\162\x6f\x75\160\137\x64\145\154\x65\164\145\x5f\165\x6e\163\x75\143\143\145\163\x73\x66\165\154"); goto hWap3; fZD36: $this->set_error("\x67\162\157\x75\160\137\x64\145\x6c\x65\164\x65\137\156\157\164\x61\x6c\x6c\x6f\x77\x65\x64"); goto AhN_Z; kXUt8: ZIXy6: goto v9Pzo; v9Pzo: $this->trigger_events("\160\x72\145\137\x64\145\x6c\x65\x74\x65\x5f\147\x72\x6f\165\x70"); goto QVTLe; QVTLe: $this->db->trans_begin(); goto PLpH5; ofMoo: if (!($group->name == $this->config->item("\141\144\x6d\x69\x6e\137\147\162\157\165\160", "\x69\x6f\x6e\x5f\141\x75\164\150"))) { goto ZIXy6; } goto mnHkj; vGhLj: $this->trigger_events(["\160\157\163\164\x5f\x64\145\154\x65\164\x65\x5f\x67\x72\x6f\165\x70", "\160\x6f\163\164\x5f\144\x65\154\x65\164\145\x5f\x67\x72\x6f\165\160\137\163\165\x63\143\145\x73\163\x66\x75\154"]); goto GKf4m; QFM4i: return FALSE; goto ZV1It; DIXyW: if (!($this->db->trans_status() === FALSE)) { goto H1Vj0; } goto OKivY; aUHWW: $this->db->trans_commit(); goto vGhLj; hWap3: return FALSE; goto GZmqO; LwwPg: $this->db->delete($this->tables["\147\x72\x6f\x75\x70\x73"], ["\x69\144" => $group_id]); goto DIXyW; OKivY: $this->db->trans_rollback(); goto vl_7o; q5MAv: } public function set_hook($event, $name, $class, $method, $arguments) { goto PNREi; axbZa: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto wHxP4; yq2N6: $this->_ion_hooks->{$event}[$name]->method = $method; goto axbZa; PNREi: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto LGQHA; LGQHA: $this->_ion_hooks->{$event}[$name]->class = $class; goto yq2N6; wHxP4: } public function remove_hook($event, $name) { goto dluYi; dluYi: if (!isset($this->_ion_hooks->{$event}[$name])) { goto He25p; } goto m1Pdj; tpZUU: He25p: goto IwpeV; m1Pdj: unset($this->_ion_hooks->{$event}[$name]); goto tpZUU; IwpeV: } public function remove_hooks($event) { goto ktXdG; Sn98Z: BEKL2: goto DspCV; ilAsb: unset($this->_ion_hooks->{$event}); goto Sn98Z; ktXdG: if (!isset($this->_ion_hooks->{$event})) { goto BEKL2; } goto ilAsb; DspCV: } protected function _call_hook($event, $name) { goto a7mNm; bT5UU: YWzh5: goto e6EtA; ZjFKJ: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto bT5UU; a7mNm: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto YWzh5; } goto DpOmg; e6EtA: return FALSE; goto kDx1T; DpOmg: $hook = $this->_ion_hooks->{$event}[$name]; goto ZjFKJ; kDx1T: } public function trigger_events($events) { goto tQmd7; OfCdU: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto Rgi9l; } goto KgXXA; u_9Ej: te2sQ: goto XrXBY; jBwpV: KrqPv: goto i25u3; xTC1u: YP2a5: goto l1MeI; l1MeI: z0YEw: goto oYs55; XrXBY: foreach ($events as $event) { $this->trigger_events($event); Lrv4o: } goto xTC1u; KgXXA: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); dcrzy: } goto jBwpV; tQmd7: if (is_array($events) && !empty($events)) { goto te2sQ; } goto OfCdU; Q8opB: goto z0YEw; goto u_9Ej; i25u3: Rgi9l: goto Q8opB; oYs55: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto g8AOo; JWYlV: return TRUE; goto gEfpf; MAcxU: $this->message_end_delimiter = $end_delimiter; goto JWYlV; g8AOo: $this->message_start_delimiter = $start_delimiter; goto MAcxU; gEfpf: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto LhQb7; LhQb7: $this->error_start_delimiter = $start_delimiter; goto dl730; dl730: $this->error_end_delimiter = $end_delimiter; goto fL3FS; fL3FS: return TRUE; goto dpjLL; dpjLL: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto Zkr6B; qag2t: foreach ($this->messages as $message) { goto uYWWz; uYWWz: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\43\43"; goto Y3kIO; Y3kIO: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto DfyaF; DfyaF: eobWR: goto K90Ll; K90Ll: } goto c1uzZ; UID6p: return $_output; goto zQaAu; Zkr6B: $_output = ''; goto qag2t; c1uzZ: J_z7u: goto UID6p; zQaAu: } public function messages_array($langify = TRUE) { goto Uw91o; cGC1j: return $this->messages; goto VU5PE; TY1w7: R5fvI: goto h0_ia; ShZcT: ILT5B: goto Ob4h1; VU5PE: goto ILT5B; goto p7U4_; rtiIu: $_output = []; goto Y2atu; h0_ia: return $_output; goto ShZcT; p7U4_: OuOFr: goto rtiIu; Y2atu: foreach ($this->messages as $message) { goto IFC7U; e52mD: xtoSu: goto uMrEx; IFC7U: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\x23\x23"; goto AJRZq; AJRZq: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto e52mD; uMrEx: } goto TY1w7; Uw91o: if ($langify) { goto OuOFr; } goto cGC1j; Ob4h1: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto xofz1; OcCoK: return $_output; goto fuwED; AaJ57: eP3rt: goto OcCoK; xofz1: $_output = ''; goto zkXTj; zkXTj: foreach ($this->errors as $error) { goto Or4u8; Or4u8: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\43"; goto nMGrn; q852X: muX7l: goto OItms; nMGrn: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto q852X; OItms: } goto AaJ57; fuwED: } public function errors_array($langify = TRUE) { goto xDpOR; IpiuS: jDbzh: goto hhEcj; AIBUN: return $_output; goto IpiuS; F1dOy: NPben: goto dmjtb; vGm9S: goto jDbzh; goto F1dOy; dmjtb: $_output = []; goto PSRyW; x2Es2: return $this->errors; goto vGm9S; RZfM_: JQB3I: goto AIBUN; PSRyW: foreach ($this->errors as $error) { goto Q5Yoi; Q5Yoi: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto d2Tqw; efiZb: gHoII: goto YhXph; d2Tqw: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto efiZb; YhXph: } goto RZfM_; xDpOR: if ($langify) { goto NPben; } goto x2Es2; hhEcj: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto IGWER; fmfIS: if (!($hash === FALSE)) { goto GwQJB; } goto FGCKw; IGWER: $hash = $this->hash_password($password, $identity); goto fmfIS; qQOf3: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto qlFSK; BWdrw: $data = ["\x70\x61\x73\x73\167\157\x72\144" => $hash, "\162\145\155\x65\155\x62\145\162\137\x63\157\x64\x65" => NULL, "\146\157\x72\x67\x6f\164\164\145\x6e\137\160\x61\163\x73\167\x6f\162\x64\137\x63\x6f\144\x65" => NULL, "\146\x6f\x72\147\x6f\x74\164\x65\x6e\137\x70\141\163\x73\x77\x6f\162\x64\x5f\x74\151\x6d\145" => NULL]; goto NCoNw; chw82: GwQJB: goto BWdrw; qlFSK: return $this->db->affected_rows() == 1; goto jYyVn; FGCKw: return FALSE; goto chw82; NCoNw: $this->trigger_events("\x65\170\x74\162\141\137\167\150\145\x72\x65"); goto qQOf3; jYyVn: } protected function _filter_data($table, $data) { goto qQUcX; PW_id: ti6tH: goto hLErI; qQUcX: $filtered_data = []; goto bK8Aq; FPdwm: return $filtered_data; goto CYn70; bK8Aq: $columns = $this->db->list_fields($table); goto qZdEI; qZdEI: if (!is_array($data)) { goto imrT4; } goto y1Kev; y1Kev: foreach ($columns as $column) { goto EyxYh; JxRI6: $filtered_data[$column] = $data[$column]; goto Evz7X; K6vfk: wmXhW: goto Y5721; EyxYh: if (!array_key_exists($column, $data)) { goto jKPX0; } goto JxRI6; Evz7X: jKPX0: goto K6vfk; Y5721: } goto PW_id; hLErI: imrT4: goto FPdwm; CYn70: } protected function _random_token($result_length = 32) { goto X9yjH; dCwcs: if (!function_exists("\x6f\160\145\156\x73\163\154\137\162\141\x6e\144\157\x6d\137\x70\x73\145\165\x64\157\137\142\171\164\x65\x73")) { goto WopIL; } goto E9KPo; XyHK1: WopIL: goto bpJOg; fyg61: $result_length = 32; goto xD3x1; E9KPo: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto XyHK1; duFGM: if (!function_exists("\x6d\143\162\x79\x70\164\137\x63\162\x65\x61\164\x65\137\x69\x76")) { goto dbodV; } goto g1jXQ; xD3x1: TbQfl: goto D1oW0; D1oW0: if (!function_exists("\x72\141\x6e\144\x6f\x6d\x5f\x62\x79\x74\x65\163")) { goto MTYQ_; } goto eO6t3; eO6t3: return bin2hex(random_bytes($result_length / 2)); goto CwttY; CwttY: MTYQ_: goto duFGM; X9yjH: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto TbQfl; } goto fyg61; bpJOg: return FALSE; goto qWBPJ; g1jXQ: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto dfm64; dfm64: dbodV: goto dCwcs; qWBPJ: } protected function _get_hash_parameters($identity = NULL) { goto n9yqs; Ha7xb: $is_admin = TRUE; goto SXQXL; xwXo0: fq063: goto zvQHW; R9kdA: if (!$identity) { goto fq063; } goto qfaVY; qxM6A: ioUrF: goto vTW3m; VWmEZ: trzpk: goto qxM6A; vTW3m: return $params; goto vi_dq; zvQHW: $params = FALSE; goto Eb_3G; SXQXL: AGM51: goto xwXo0; H6PC0: if (!($user_id && $this->in_group($this->config->item("\141\x64\x6d\x69\156\x5f\x67\162\x6f\165\160", "\x69\x6f\x6e\137\x61\165\164\x68"), $user_id))) { goto AGM51; } goto Ha7xb; n9yqs: $is_admin = FALSE; goto R9kdA; qfaVY: $user_id = $this->get_user_id_from_identity($identity); goto H6PC0; Eb_3G: switch ($this->hash_method) { case "\x62\x63\x72\x79\160\x74": $params = ["\x63\157\x73\x74" => $is_admin ? $this->config->item("\x62\143\162\x79\160\164\x5f\x61\144\x6d\x69\x6e\137\x63\157\163\164", "\151\x6f\156\x5f\x61\165\164\x68") : $this->config->item("\142\x63\x72\x79\x70\x74\137\x64\145\146\x61\165\154\x74\x5f\143\x6f\163\x74", "\x69\157\x6e\137\x61\x75\x74\x68")]; goto ioUrF; case "\141\162\147\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\x72\147\x6f\156\x32\137\x61\x64\155\151\x6e\137\160\141\162\141\155\x73", "\151\157\x6e\137\141\165\x74\150") : $this->config->item("\141\x72\x67\x6f\156\62\x5f\x64\x65\146\x61\165\154\164\137\x70\141\162\x61\x6d\x73", "\x69\157\x6e\137\x61\165\164\150"); goto ioUrF; default: } goto VWmEZ; vi_dq: } protected function _get_hash_algo() { goto eSQrG; eSQrG: $algo = FALSE; goto RugXF; yt3Yl: X7EK8: goto nqsAG; lwaog: return $algo; goto O3rHS; RugXF: switch ($this->hash_method) { case "\x62\143\x72\x79\160\x74": $algo = PASSWORD_BCRYPT; goto Aeddr; case "\141\x72\x67\157\x6e\x32": $algo = PASSWORD_ARGON2I; goto Aeddr; default: } goto yt3Yl; nqsAG: Aeddr: goto lwaog; O3rHS: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto M3ZEM; m1RJ2: $validator_hashed = $this->hash_password($validator); goto f4vrm; sFcmP: $validator = $this->_random_token($validator_size); goto m1RJ2; M3ZEM: $selector = $this->_random_token($selector_size); goto sFcmP; f4vrm: $user_code = "{$selector}\56{$validator}"; goto JjvLa; JjvLa: return (object) ["\x73\145\x6c\x65\143\x74\x6f\162" => $selector, "\166\x61\x6c\151\144\x61\164\157\162\x5f\150\x61\x73\x68\145\144" => $validator_hashed, "\165\163\145\162\137\143\157\x64\145" => $user_code]; goto PFADk; PFADk: } protected function _retrieve_selector_validator_couple($user_code) { goto b0BE_; b0BE_: if (!$user_code) { goto xU3sW; } goto SQc29; r2uhk: return FALSE; goto qPI6p; N_fwu: if (!(count($tokens) === 2)) { goto y7syQ; } goto x5es7; Thua7: xU3sW: goto r2uhk; Qs6Xm: y7syQ: goto Thua7; x5es7: return (object) ["\x73\145\154\x65\x63\x74\x6f\162" => $tokens[0], "\x76\141\x6c\x69\x64\141\164\157\x72" => $tokens[1]]; goto Qs6Xm; SQc29: $tokens = explode("\x2e", $user_code); goto N_fwu; qPI6p: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto aSHuj; SnaUV: $this->trigger_events(["\x70\x6f\x73\164\137\163\x68\x61\61\x5f\160\x61\x73\163\x77\157\162\144\137\x6d\151\x67\x72\141\x74\x69\x6f\156", "\x70\x6f\x73\164\x5f\163\x68\141\x31\137\160\x61\163\x73\167\157\162\x64\137\x6d\x69\x67\162\x61\164\151\x6f\156\x5f\x75\x6e\x73\165\x63\x63\145\163\163\x66\x75\154"]); goto Hhy83; mEani: dYtb4: goto zPicU; PL_bp: $this->trigger_events(["\160\x6f\163\164\137\x73\x68\141\61\137\160\x61\163\163\167\157\x72\x64\x5f\x6d\151\147\162\141\164\x69\x6f\x6e", "\x70\157\163\164\x5f\x73\x68\141\61\137\x70\x61\x73\163\x77\157\162\144\137\155\x69\147\x72\141\x74\x69\x6f\156\137\163\x75\x63\x63\145\x73\163\x66\165\x6c"]); goto mEani; PaUls: goto vJr6z; goto pDlp1; SUeqO: return FALSE; goto hi7tZ; amiby: $this->trigger_events(["\x70\x6f\x73\164\137\x73\150\x61\61\x5f\x70\141\163\x73\167\x6f\x72\x64\137\x6d\x69\x67\x72\x61\164\x69\157\x6e", "\x70\x6f\163\164\137\163\150\x61\x31\137\x70\x61\x73\163\167\157\x72\x64\x5f\x6d\x69\147\162\x61\164\151\x6f\156\x5f\165\x6e\163\x75\143\x63\145\x73\163\x66\x75\x6c"]); goto SUeqO; s7RZb: if ($salt_length) { goto gJsrl; } goto amiby; Yf78l: $salt_length = $this->config->item("\x73\141\154\x74\137\154\x65\x6e\x67\x74\150", "\151\157\x6e\x5f\x61\x75\x74\x68"); goto s7RZb; HtIVH: $salt_db = $query->row(); goto Uw8NH; nrVo8: if ($this->config->item("\x73\x74\x6f\x72\145\x5f\x73\x61\x6c\164", "\x69\157\156\137\x61\165\164\x68")) { goto lveFQ; } goto Yf78l; Uyz_V: return FALSE; goto PaUls; zLe6E: if ($hashed_password === $hashed_password_db) { goto sjF5l; } goto GDTg0; DTBsS: fX6tW: goto zLe6E; GDTg0: $this->trigger_events(["\160\157\163\x74\137\x73\150\x61\61\137\160\141\163\x73\167\157\162\144\x5f\155\x69\x67\162\141\164\151\x6f\x6e", "\x70\x6f\x73\164\137\x73\150\141\61\137\160\141\x73\163\x77\x6f\162\144\x5f\155\x69\x67\x72\141\x74\151\x6f\156\x5f\165\156\x73\x75\143\x63\x65\x73\x73\x66\x75\154"]); goto Uyz_V; Hhy83: goto dYtb4; goto s3bME; LbnqP: $this->trigger_events(["\x70\157\x73\164\137\163\x68\141\x31\x5f\x70\x61\x73\x73\x77\x6f\162\x64\x5f\155\x69\147\x72\141\164\151\x6f\156", "\x70\x6f\x73\x74\137\x73\150\x61\61\x5f\160\x61\163\x73\167\x6f\x72\x64\137\155\x69\x67\162\x61\x74\151\157\156\137\165\156\x73\x75\143\x63\x65\x73\x73\146\165\154"]); goto MZ7fV; MZ7fV: return FALSE; goto aH6yR; aH6yR: M9YZT: goto o_Mh3; pLFGy: if ($result) { goto QSu8g; } goto SnaUV; o_Mh3: $hashed_password = sha1($password . $salt_db->salt); goto DTBsS; N90W7: $query = $this->db->select("\163\141\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\145\x72\x73"]); goto HtIVH; S3uYU: goto fX6tW; goto z8zBV; l35dU: vJr6z: goto Ej7Ba; SHs58: $result = $this->_set_password_db($identity, $password); goto pLFGy; yI_ur: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto S3uYU; pDlp1: sjF5l: goto SHs58; aSHuj: $this->trigger_events("\x70\x72\x65\137\163\x68\x61\61\137\160\x61\163\x73\x77\x6f\x72\144\x5f\155\x69\147\162\x61\164\151\157\156"); goto nrVo8; hlAAg: $salt = substr($hashed_password_db, 0, $salt_length); goto yI_ur; hi7tZ: gJsrl: goto hlAAg; zPicU: return $result; goto l35dU; s3bME: QSu8g: goto PL_bp; z8zBV: lveFQ: goto N90W7; Uw8NH: if (!($query->num_rows() !== 1)) { goto M9YZT; } goto LbnqP; Ej7Ba: } }
