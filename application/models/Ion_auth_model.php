<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\105\120\x41\x54\x48") or exit("\x4e\x6f\x20\144\x69\x72\x65\x63\164\x20\163\x63\x72\x69\160\164\x20\141\x63\x63\x65\x73\163\x20\141\x6c\154\157\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; private $identity_column; private $join; private $hash_method; private $message_start_delimiter; private $message_end_delimiter; public function __construct() { goto oUYDL; lGFDT: $this->message_end_delimiter = $this->error_end_delimiter; goto ubCJM; hXOJ0: goto mo3Pr; goto KNOKb; dxEtI: $this->tables = $this->config->item("\x74\x61\142\x6c\x65\x73", "\x69\x6f\x6e\x5f\x61\x75\164\150"); goto Qu0wg; PptKV: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto lGFDT; R05zO: $error_prefix = $form_validation_class->getProperty("\x5f\145\x72\162\157\x72\137\160\162\x65\x66\151\x78"); goto gWr0X; Xab7Y: $error_suffix->setAccessible(TRUE); goto PptKV; BgtXa: $this->db = $CI->db; goto cpaWl; oUYDL: $this->config->load("\151\157\156\137\x61\165\x74\x68", TRUE); goto LJ6PJ; xLJhB: $CI =& get_instance(); goto BgtXa; mxGx2: $this->message_end_delimiter = $this->config->item("\x6d\x65\163\x73\141\147\145\x5f\x65\x6e\144\x5f\144\145\154\151\x6d\x69\164\145\x72", "\x69\x6f\x6e\x5f\141\165\164\x68"); goto Zt1h_; aJBV9: $this->error_end_delimiter = $this->config->item("\x65\162\162\157\x72\137\145\156\144\137\144\145\154\x69\155\151\164\145\x72", "\x69\157\156\137\x61\x75\164\x68"); goto t4q8p; FFMw6: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto I5c1v; WnKcT: $this->errors = []; goto AjVUY; t4q8p: goto OgadH; goto RZVQG; t1LYo: if ($delimiters_source === "\146\x6f\x72\x6d\137\166\x61\154\151\x64\141\164\x69\x6f\156") { goto G2Eks; } goto OUVP2; I5c1v: $this->message_start_delimiter = $this->error_start_delimiter; goto Wsp4u; adfyo: $this->messages = []; goto WnKcT; FfQow: $this->lang->load("\151\157\x6e\137\141\x75\x74\x68"); goto az2MF; lH0sz: $this->trigger_events("\x6d\157\x64\145\x6c\x5f\x63\x6f\x6e\x73\x74\x72\165\143\164\x6f\162"); goto J452V; dYolD: $this->join = $this->config->item("\152\x6f\x69\156", "\x69\x6f\x6e\x5f\x61\x75\164\x68"); goto uWC0k; qOa1A: $this->load->library("\x66\x6f\x72\155\137\166\141\154\x69\144\x61\x74\151\157\x6e"); goto YOxUH; WnG2w: $this->load->helper("\144\141\x74\x65"); goto FfQow; LJ6PJ: $this->load->helper("\x63\157\157\153\x69\x65"); goto WnG2w; ubCJM: OgadH: goto rZRdQ; YOxUH: $form_validation_class = new ReflectionClass("\x43\x49\137\x46\x6f\x72\x6d\x5f\166\141\x6c\x69\x64\x61\x74\151\157\x6e"); goto R05zO; Qu0wg: $this->identity_column = $this->config->item("\151\144\145\x6e\x74\x69\164\171", "\x69\x6f\156\x5f\x61\165\164\x68"); goto dYolD; rZRdQ: $this->_ion_hooks = new stdClass(); goto lH0sz; Wsp4u: $error_suffix = $form_validation_class->getProperty("\x5f\x65\x72\162\157\162\x5f\163\165\146\146\x69\x78"); goto Xab7Y; OUVP2: $this->message_start_delimiter = $this->config->item("\155\x65\163\163\x61\x67\x65\x5f\x73\164\141\162\164\x5f\144\145\154\x69\x6d\151\164\x65\x72", "\151\157\156\x5f\x61\165\164\x68"); goto mxGx2; Cay7F: $this->db = $this->load->database($group_name, TRUE, TRUE); goto hXOJ0; az2MF: $group_name = $this->config->item("\x64\x61\164\x61\x62\141\x73\145\x5f\147\162\x6f\165\x70\x5f\156\141\155\x65", "\x69\x6f\156\137\x61\165\x74\150"); goto l1ai0; RZVQG: G2Eks: goto qOa1A; Zt1h_: $this->error_start_delimiter = $this->config->item("\145\162\x72\x6f\x72\137\x73\x74\141\x72\x74\137\144\145\154\151\x6d\151\x74\145\x72", "\151\x6f\156\137\141\165\x74\150"); goto aJBV9; uWC0k: $this->hash_method = $this->config->item("\150\141\163\150\x5f\x6d\145\x74\x68\x6f\144", "\x69\x6f\x6e\137\x61\165\164\x68"); goto adfyo; gWr0X: $error_prefix->setAccessible(TRUE); goto FFMw6; l1ai0: if (empty($group_name)) { goto zpZB1; } goto Cay7F; cpaWl: mo3Pr: goto dxEtI; AjVUY: $delimiters_source = $this->config->item("\144\x65\154\x69\155\151\x74\145\x72\163\x5f\163\157\x75\x72\x63\145", "\151\157\x6e\x5f\x61\165\164\150"); goto t1LYo; KNOKb: zpZB1: goto xLJhB; J452V: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto yyI4e; Gncin: G3cVR: goto qajCy; yyI4e: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto G3cVR; } goto n1N4e; cxBMd: $params = $this->_get_hash_parameters($identity); goto ULQEQ; qajCy: $algo = $this->_get_hash_algo(); goto cxBMd; n1N4e: return FALSE; goto Gncin; ULQEQ: if (!($algo !== FALSE && $params !== FALSE)) { goto tvZyj; } goto pjkQh; pjkQh: return password_hash($password, $algo, $params); goto uUHEK; uFs0M: return FALSE; goto mIbzY; uUHEK: tvZyj: goto uFs0M; mIbzY: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto XKJfQ; T_g_f: C0t32: goto p9fv1; hqyqB: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto AN9Ql; HLmDv: XwTZk: goto sgmXm; p9fv1: return password_verify($password, $hash_password_db); goto KpaHa; KpaHa: sH93W: goto TiQ46; AN9Ql: goto sH93W; goto T_g_f; sgmXm: if (strpos($hash_password_db, "\x24") === 0) { goto C0t32; } goto hqyqB; dkvHS: return FALSE; goto HLmDv; XKJfQ: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto XwTZk; } goto dkvHS; TiQ46: } public function rehash_password_if_needed($hash, $identity, $password) { goto LaUVq; IDHEI: if (!($algo !== FALSE && $params !== FALSE)) { goto pECiO; } goto sTKIL; bTihG: $params = $this->_get_hash_parameters($identity); goto IDHEI; iNFpm: $this->trigger_events(["\x72\x65\150\141\x73\x68\137\x70\x61\x73\x73\x77\x6f\162\144", "\162\x65\150\x61\163\150\x5f\x70\141\163\x73\167\x6f\162\144\x5f\x73\165\143\143\145\163\x73\146\x75\x6c"]); goto kBcpU; yJwx2: lzu_s: goto iNFpm; LaUVq: $algo = $this->_get_hash_algo(); goto bTihG; kBcpU: h1D_w: goto AkoEb; obzZo: goto h1D_w; goto yJwx2; DiVKA: pECiO: goto EflUC; sTKIL: if (!password_needs_rehash($hash, $algo, $params)) { goto txgdk; } goto Klklp; Klklp: if ($this->_set_password_db($identity, $password)) { goto lzu_s; } goto pE0Px; pE0Px: $this->trigger_events(["\x72\x65\x68\x61\x73\x68\137\160\x61\163\163\x77\x6f\162\144", "\x72\145\150\x61\163\150\x5f\160\x61\x73\x73\x77\x6f\x72\144\137\x75\156\163\165\143\143\x65\x73\x73\146\x75\x6c"]); goto obzZo; AkoEb: txgdk: goto DiVKA; EflUC: } public function get_user_by_activation_code($user_code) { goto YAMLK; n7rEz: return FALSE; goto hC3rk; r1RpK: HCKxb: goto n7rEz; sEPai: return $user; goto q7Eua; jLmwZ: if (!$this->verify_password($token->validator, $user->activation_code)) { goto HCppF; } goto sEPai; q7Eua: HCppF: goto r1RpK; YAMLK: $token = $this->_retrieve_selector_validator_couple($user_code); goto T1zXP; T1zXP: $user = $this->where("\141\x63\164\x69\166\x61\x74\x69\x6f\x6e\x5f\x73\145\x6c\145\143\x74\157\x72", $token->selector)->users()->row(); goto M7hUc; M7hUc: if (!$user) { goto HCKxb; } goto jLmwZ; hC3rk: } public function activate($id, $code = FALSE) { goto fCcfb; F95PL: return TRUE; goto xmfP7; NqwBU: h52pv: goto ulTUW; FpgJS: $this->trigger_events(["\160\157\163\x74\x5f\141\x63\x74\x69\x76\141\x74\x65", "\x70\157\163\x74\137\x61\143\164\151\166\x61\x74\x65\x5f\x75\x6e\163\165\x63\143\x65\x73\x73\146\x75\154"]); goto Cp0qf; ulTUW: if (!($code === FALSE || $user && $user->id === $id)) { goto Bcwz6; } goto uwzr5; ITGS3: $this->set_message("\x61\143\x74\151\166\141\164\145\137\163\x75\143\x63\145\163\163\x66\165\x6c"); goto F95PL; a9w4H: $this->trigger_events(["\x70\157\x73\164\x5f\x61\x63\164\x69\x76\141\164\145", "\160\157\x73\x74\x5f\x61\x63\x74\151\x76\x61\164\x65\137\x73\165\143\143\145\x73\x73\146\x75\154"]); goto ITGS3; L__eu: Bcwz6: goto FpgJS; Cp0qf: $this->set_error("\x61\x63\x74\x69\166\x61\164\x65\x5f\165\x6e\x73\165\x63\143\x65\163\x73\146\165\154"); goto V06cr; xmfP7: oj_Hd: goto L__eu; V06cr: return FALSE; goto Eh3et; R0Wmx: if (!($code !== FALSE)) { goto h52pv; } goto FdwkP; uwzr5: $data = ["\141\x63\164\x69\x76\x61\x74\151\157\x6e\137\163\145\154\145\x63\x74\157\x72" => NULL, "\141\143\x74\151\166\x61\x74\151\157\156\137\143\157\144\x65" => NULL, "\141\x63\x74\151\x76\145" => 1]; goto cvwwh; fCcfb: $this->trigger_events("\160\x72\x65\x5f\x61\x63\164\151\166\141\x74\145"); goto R0Wmx; aExlW: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, ["\x69\144" => $id]); goto qCzur; FdwkP: $user = $this->get_user_by_activation_code($code); goto NqwBU; qCzur: if (!($this->db->affected_rows() === 1)) { goto oj_Hd; } goto a9w4H; cvwwh: $this->trigger_events("\145\170\x74\x72\x61\137\x77\x68\145\162\x65"); goto aExlW; Eh3et: } public function deactivate($id = NULL) { goto nfJsQ; dU0py: $this->set_message("\144\x65\141\143\x74\x69\x76\141\164\x65\x5f\x73\165\143\143\145\163\163\146\165\x6c"); goto CNj3g; F5aIO: goto FdhlZ; goto ClgOI; twFvQ: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, ["\x69\144" => $id]); goto cxAzD; eJ2pd: return FALSE; goto pXzuP; cxAzD: $return = $this->db->affected_rows() == 1; goto HVl1E; nskZs: $token = $this->_generate_selector_validator_couple(20, 40); goto lxfPC; hngOI: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto WsGNF; } goto al7qx; IjIjX: if (!isset($id)) { goto U0whl; } goto hngOI; ClgOI: p7n2s: goto dU0py; VQrnv: return FALSE; goto R2tbo; nfJsQ: $this->trigger_events("\x64\x65\x61\x63\164\x69\x76\x61\164\145"); goto IjIjX; hJDZ4: U0whl: goto Vr1i6; pXzuP: WsGNF: goto G1CMk; HVl1E: if ($return) { goto p7n2s; } goto ORxm2; jaXfg: $data = ["\141\143\164\151\x76\x61\x74\x69\157\156\x5f\x73\x65\x6c\145\143\x74\x6f\162" => $token->selector, "\x61\x63\x74\x69\166\141\x74\x69\x6f\156\137\x63\x6f\x64\145" => $token->validator_hashed, "\x61\x63\x74\x69\166\145" => 0]; goto H8gW9; Vr1i6: $this->set_error("\x64\145\141\143\164\x69\x76\x61\164\x65\137\165\x6e\x73\165\x63\143\145\x73\163\146\165\154"); goto VQrnv; lxfPC: $this->activation_code = $token->user_code; goto jaXfg; R2tbo: bEVwd: goto nskZs; ORxm2: $this->set_error("\x64\145\141\143\x74\151\x76\141\164\145\137\165\156\163\x75\143\143\x65\163\163\146\165\154"); goto F5aIO; KDeQR: return $return; goto Cgf1v; H8gW9: $this->trigger_events("\145\x78\x74\162\x61\x5f\x77\x68\145\x72\x65"); goto twFvQ; al7qx: $this->set_error("\144\x65\x61\143\164\x69\166\141\x74\145\x5f\143\x75\x72\x72\x65\x6e\x74\x5f\x75\x73\145\x72\137\x75\156\x73\x75\143\x63\145\163\163\146\165\154"); goto eJ2pd; CNj3g: FdhlZ: goto KDeQR; G1CMk: goto bEVwd; goto hJDZ4; Cgf1v: } public function clear_forgotten_password_code($identity) { goto fhjoN; nqS6K: return TRUE; goto RTECY; bNInu: QVNBz: goto sPu5M; FbUQU: return FALSE; goto bNInu; QUZjV: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, [$this->identity_column => $identity]); goto nqS6K; fhjoN: if (!empty($identity)) { goto QVNBz; } goto FbUQU; sPu5M: $data = ["\x66\x6f\162\x67\157\164\164\145\156\137\x70\x61\x73\163\167\157\x72\144\137\x73\145\154\145\143\164\x6f\x72" => NULL, "\x66\x6f\x72\147\x6f\x74\x74\145\156\137\x70\141\163\163\x77\x6f\162\x64\x5f\143\x6f\x64\x65" => NULL, "\146\157\x72\x67\x6f\x74\164\x65\156\x5f\x70\141\163\x73\x77\157\162\144\x5f\164\x69\155\x65" => NULL]; goto QUZjV; RTECY: } public function clear_remember_code($identity) { goto q_KJy; q_KJy: if (!empty($identity)) { goto A1gjB; } goto IuPDx; IuPDx: return FALSE; goto s_PLI; hjy33: $data = ["\x72\x65\155\145\x6d\x62\x65\162\137\x73\x65\154\145\143\x74\x6f\x72" => NULL, "\x72\145\155\145\155\x62\x65\162\x5f\143\x6f\x64\145" => NULL]; goto C30w8; s_PLI: A1gjB: goto hjy33; Jg_fQ: return TRUE; goto m61AT; C30w8: $this->db->update($this->tables["\x75\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto Jg_fQ; m61AT: } public function reset_password($identity, $new) { goto NFL7D; UKl8B: CkfhS: goto RgGg9; WVkjr: goto Dg0gD; goto UKl8B; nMYJL: if ($this->identity_check($identity)) { goto lQo77; } goto qBbh7; FiQ7M: return $return; goto NtXB6; LXpxB: lQo77: goto KBDwC; RgGg9: $this->trigger_events(["\x70\x6f\163\x74\137\143\x68\141\156\x67\145\x5f\x70\x61\x73\163\167\157\x72\x64", "\160\x6f\163\164\137\143\x68\141\156\147\145\x5f\x70\141\x73\x73\x77\x6f\162\144\x5f\x73\165\x63\x63\x65\163\163\146\x75\154"]); goto WPZIK; NFL7D: $this->trigger_events("\160\x72\x65\x5f\x63\150\x61\x6e\x67\145\137\160\x61\163\163\x77\157\162\144"); goto nMYJL; Uvwil: $this->set_error("\x70\141\163\163\x77\x6f\162\x64\x5f\143\150\141\x6e\x67\145\x5f\x75\x6e\163\x75\x63\x63\145\163\x73\146\x75\x6c"); goto WVkjr; RRxYy: return FALSE; goto LXpxB; tvg7g: Dg0gD: goto FiQ7M; KBDwC: $return = $this->_set_password_db($identity, $new); goto D3pxC; WPZIK: $this->set_message("\x70\141\x73\163\167\x6f\162\144\x5f\x63\150\x61\156\147\145\x5f\163\x75\x63\x63\x65\163\x73\146\165\154"); goto tvg7g; qBbh7: $this->trigger_events(["\x70\x6f\x73\164\137\143\x68\141\156\x67\x65\x5f\x70\141\163\x73\x77\x6f\x72\x64", "\160\157\x73\x74\x5f\x63\150\141\x6e\x67\145\137\x70\x61\x73\x73\x77\157\162\144\x5f\165\156\x73\x75\143\143\x65\163\163\146\x75\154"]); goto RRxYy; D3pxC: if ($return) { goto CkfhS; } goto PIl_T; PIl_T: $this->trigger_events(["\x70\x6f\163\164\137\x63\x68\141\x6e\147\145\137\160\141\x73\x73\x77\157\162\144", "\160\157\163\164\x5f\x63\x68\141\156\147\x65\137\160\x61\163\x73\167\x6f\x72\144\x5f\x75\156\x73\x75\143\143\145\x73\163\146\x75\154"]); goto Uvwil; NtXB6: } public function change_password($identity, $old, $new) { goto tSmvS; vJMU0: return FALSE; goto XXGP9; CqOTw: $this->trigger_events(["\x70\157\163\164\x5f\143\150\x61\156\147\x65\x5f\x70\x61\x73\163\167\157\x72\144", "\x70\x6f\163\x74\x5f\143\150\141\x6e\x67\x65\137\160\141\163\163\x77\157\162\x64\137\x75\x6e\x73\x75\x63\x63\x65\163\x73\x66\x75\154"]); goto bAu82; tSmvS: $this->trigger_events("\160\162\x65\137\x63\150\x61\156\147\x65\x5f\x70\x61\163\x73\167\157\162\x64"); goto ktLWO; r6E03: $result = $this->_set_password_db($identity, $new); goto gGPmO; bAu82: $this->set_error("\x70\141\x73\x73\x77\157\x72\x64\137\143\x68\141\156\x67\x65\x5f\165\x6e\x73\x75\x63\143\145\x73\x73\x66\165\x6c"); goto y7Z58; v7sa3: if (!$this->verify_password($old, $user->password, $identity)) { goto f6b4Z; } goto r6E03; CaYpq: $this->set_message("\x70\x61\x73\x73\x77\x6f\162\144\x5f\143\x68\141\156\147\145\137\x73\x75\143\143\x65\163\x73\x66\x75\154"); goto FjTkl; GrG3Y: return $result; goto VI0z9; FjTkl: pAla9: goto GrG3Y; ZONed: $this->trigger_events(["\x70\x6f\163\x74\x5f\x63\x68\x61\156\x67\145\x5f\160\141\163\x73\167\x6f\x72\144", "\x70\157\163\x74\x5f\x63\150\x61\156\147\x65\x5f\x70\x61\163\x73\x77\x6f\162\x64\137\165\x6e\163\165\x63\x63\145\163\163\146\x75\154"]); goto xYvOv; ioXa6: $user = $query->row(); goto v7sa3; NXE5b: $query = $this->db->select("\151\x64\54\40\160\x61\163\163\167\x6f\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\x73\143")->get($this->tables["\165\163\x65\162\163"]); goto miKSo; gGPmO: if ($result) { goto u3GGy; } goto CqOTw; ktLWO: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\167\150\x65\x72\x65"); goto NXE5b; azD1z: u3GGy: goto iyKXp; xYvOv: $this->set_error("\160\141\x73\163\167\x6f\x72\x64\137\x63\150\x61\156\147\145\137\165\156\163\165\x63\x63\145\163\x73\x66\165\154"); goto vJMU0; y7Z58: goto pAla9; goto azD1z; xfbcM: $this->set_error("\160\141\x73\x73\167\157\x72\x64\x5f\143\150\x61\x6e\147\145\137\x75\156\x73\165\x63\x63\x65\x73\x73\146\165\x6c"); goto AjyPF; AjyPF: return FALSE; goto UP6vv; VI0z9: f6b4Z: goto xfbcM; XXGP9: bbOa9: goto ioXa6; iyKXp: $this->trigger_events(["\x70\157\163\164\x5f\x63\150\x61\x6e\147\x65\x5f\160\141\163\x73\167\x6f\162\144", "\160\157\163\x74\x5f\143\x68\x61\x6e\147\x65\x5f\160\141\x73\x73\167\157\x72\144\x5f\x73\x75\x63\143\x65\163\163\146\165\154"]); goto CaYpq; miKSo: if (!($query->num_rows() !== 1)) { goto bbOa9; } goto ZONed; UP6vv: } public function username_check($username = '') { goto TgU4m; Et1fn: if (!empty($username)) { goto Uz2Z5; } goto ocuwU; wDBrA: Uz2Z5: goto tlJJF; ocuwU: return FALSE; goto wDBrA; tlJJF: $this->trigger_events("\x65\x78\x74\162\141\137\167\150\145\x72\x65"); goto iAM7R; TgU4m: $this->trigger_events("\x75\163\x65\x72\156\x61\155\145\x5f\143\x68\145\143\153"); goto Et1fn; iAM7R: return $this->db->where("\x75\x73\x65\x72\156\x61\155\x65", $username)->limit(1)->count_all_results($this->tables["\165\x73\145\162\x73"]) > 0; goto kma1X; kma1X: } public function email_check($email = '') { goto hDJlJ; hDJlJ: $this->trigger_events("\x65\x6d\141\151\154\x5f\143\150\145\x63\x6b"); goto H19d8; Qsk2a: $this->trigger_events("\145\170\x74\162\x61\x5f\167\x68\x65\x72\x65"); goto CfR6r; GilSu: return FALSE; goto Dem55; Dem55: Zokha: goto Qsk2a; CfR6r: return $this->db->where("\x65\x6d\141\x69\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\145\162\163"]) > 0; goto d12NS; H19d8: if (!empty($email)) { goto Zokha; } goto GilSu; d12NS: } public function identity_check($identity = '') { goto xouPx; N9J4D: return FALSE; goto RPx_E; oiISi: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\x73\145\162\x73"]) > 0; goto OGdeY; jEMB9: if (!empty($identity)) { goto ZmjKZ; } goto N9J4D; xouPx: $this->trigger_events("\151\144\x65\156\164\x69\x74\171\x5f\x63\150\x65\143\x6b"); goto jEMB9; RPx_E: ZmjKZ: goto oiISi; OGdeY: } public function get_user_id_from_identity($identity = '') { goto EF2kQ; efWBd: LDIWJ: goto U6bPz; FzUF7: return FALSE; goto H2xuW; f5cPT: if (!($query->num_rows() !== 1)) { goto GONXv; } goto FzUF7; k51LY: return FALSE; goto efWBd; EF2kQ: if (!empty($identity)) { goto LDIWJ; } goto k51LY; HPolV: $user = $query->row(); goto yi6uH; yi6uH: return $user->id; goto rK5xV; H2xuW: GONXv: goto HPolV; U6bPz: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\x65\162\163"]); goto f5cPT; rK5xV: } public function forgotten_password($identity) { goto bs7Fi; zX5es: $this->trigger_events(["\160\157\163\164\x5f\x66\157\x72\147\x6f\164\x74\x65\x6e\137\160\x61\x73\163\167\157\162\144", "\x70\157\163\164\x5f\146\x6f\162\147\x6f\164\164\145\x6e\137\160\141\x73\163\167\x6f\162\x64\137\165\x6e\x73\x75\x63\143\x65\x73\163\x66\x75\154"]); goto pFgwy; lgOuh: goto kLlHQ; goto dBEGf; hm49B: $this->trigger_events("\x65\170\164\162\x61\137\167\x68\x65\162\145"); goto J0gnn; XGJ77: $this->trigger_events(["\x70\157\163\164\x5f\x66\157\x72\x67\157\x74\164\x65\156\137\160\x61\x73\x73\167\157\162\x64", "\x70\157\163\x74\x5f\146\x6f\x72\147\157\x74\x74\x65\156\137\x70\x61\x73\163\167\157\x72\144\x5f\163\x75\x63\x63\145\163\x73\146\x75\x6c"]); goto RO8cy; G3Djn: $update = ["\x66\157\162\147\x6f\164\x74\x65\x6e\137\160\141\163\x73\x77\157\x72\x64\137\x73\145\x6c\145\143\164\157\x72" => $token->selector, "\x66\157\162\147\157\164\164\x65\156\137\x70\141\163\163\167\x6f\162\144\x5f\143\157\144\145" => $token->validator_hashed, "\146\x6f\162\x67\x6f\x74\164\x65\156\137\160\x61\x73\x73\167\x6f\x72\x64\137\x74\151\x6d\145" => time()]; goto hm49B; J0gnn: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], $update, [$this->identity_column => $identity]); goto xWNum; Jmbs1: return FALSE; goto lgOuh; DvRK1: kLlHQ: goto hO88I; EVl8q: $this->trigger_events(["\160\x6f\163\164\x5f\146\157\x72\147\157\164\x74\x65\156\x5f\160\x61\x73\163\167\x6f\162\144", "\x70\x6f\163\x74\137\x66\157\x72\x67\157\164\x74\145\x6e\137\160\x61\x73\163\x77\x6f\x72\144\x5f\x75\x6e\x73\165\x63\x63\145\163\163\x66\165\x6c"]); goto Jmbs1; E30yT: pTgWv: goto Q9mEK; xWNum: if ($this->db->affected_rows() === 1) { goto Q_z1l; } goto EVl8q; Q9mEK: $token = $this->_generate_selector_validator_couple(20, 80); goto G3Djn; pFgwy: return FALSE; goto E30yT; RO8cy: return $token->user_code; goto DvRK1; bs7Fi: if (!empty($identity)) { goto pTgWv; } goto zX5es; dBEGf: Q_z1l: goto XGJ77; hO88I: } public function get_user_by_forgotten_password_code($user_code) { goto BcS32; S42Hr: JrPO5: goto btpHn; ejhUv: return $user; goto S42Hr; btpHn: CprTL: goto qrHA6; Xv4CM: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto JrPO5; } goto ejhUv; qrHA6: return FALSE; goto hM5RQ; BcS32: $token = $this->_retrieve_selector_validator_couple($user_code); goto lrO6G; lrO6G: $user = $this->where("\146\x6f\162\147\x6f\164\164\145\x6e\x5f\160\141\163\x73\167\157\162\144\137\163\145\154\x65\143\x74\x6f\162", $token->selector)->users()->row(); goto DZy0C; DZy0C: if (!$user) { goto CprTL; } goto Xv4CM; hM5RQ: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto ComAj; yLYBQ: A51bN: goto GwAch; Ol_RV: $query = $this->db->get_where($this->tables["\147\162\x6f\165\160\x73"], ["\156\141\155\145" => $this->config->item("\x64\x65\x66\x61\165\x6c\164\x5f\147\x72\x6f\x75\x70", "\x69\157\156\137\x61\165\164\x68")], 1)->row(); goto p8Efa; m6mt1: return isset($id) ? $id : FALSE; goto Zl2V8; csipS: wEz66: goto Ol_RV; N1fGY: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\x65\162\163"], $additional_data), $data); goto B5rJb; MKv2t: if (!(isset($default_group->id) && empty($groups))) { goto sR8M5; } goto dfoUs; Sdfj8: return FALSE; goto yLYBQ; RY0Li: if (empty($groups)) { goto wZJM1; } goto z8BL5; ComAj: $this->trigger_events("\160\x72\145\137\162\145\147\151\163\164\145\x72"); goto gPr1R; WOZWq: wZJM1: goto rJTHq; Tsot_: return FALSE; goto V7oxm; f_meZ: $id = $this->db->insert_id($this->tables["\x75\163\145\x72\x73"] . "\x5f\x69\x64\x5f\163\x65\161"); goto MKv2t; Zc3Ls: return FALSE; goto csipS; kKd11: if (!(!$this->config->item("\144\145\146\141\165\154\x74\x5f\147\162\x6f\x75\160", "\x69\x6f\x6e\137\141\x75\164\150") && empty($groups))) { goto A51bN; } goto zt0S9; njQPd: $this->set_error("\x61\x63\x63\x6f\x75\x6e\164\x5f\143\162\145\x61\164\151\157\156\x5f\165\x6e\163\165\x63\x63\145\x73\x73\146\x75\x6c"); goto Tsot_; tXks4: $data = [$this->identity_column => $identity, "\x75\x73\145\162\156\141\155\x65" => $identity, "\160\x61\x73\163\167\157\162\144" => $password, "\145\x6d\141\x69\x6c" => $email, "\x69\160\x5f\141\144\144\162\145\163\x73" => $ip_address, "\x63\162\x65\141\x74\x65\144\137\x6f\x6e" => time(), "\141\143\x74\x69\166\145" => $manual_activation === FALSE ? 1 : 0]; goto N1fGY; eJ0tz: $ip_address = $this->input->ip_address(); goto umBrQ; B5rJb: $this->trigger_events("\x65\x78\164\162\141\137\x73\x65\164"); goto TVFBH; p8Efa: if (!(!isset($query->id) && empty($groups))) { goto VuBOq; } goto F9EFa; snxy0: return FALSE; goto v5ZHM; AD3Uo: if ($this->identity_check($identity)) { goto SDejy; } goto kKd11; vke6I: MZGZG: goto WOZWq; IN2Aj: SDejy: goto CRrB9; gPr1R: $manual_activation = $this->config->item("\155\x61\156\x75\x61\x6c\x5f\141\143\x74\x69\x76\141\x74\x69\x6f\x6e", "\x69\x6f\156\x5f\x61\165\164\x68"); goto AD3Uo; fWWS4: $default_group = $query; goto eJ0tz; dfoUs: $groups[] = $default_group->id; goto D17W4; zt0S9: $this->set_error("\x61\143\143\157\165\156\164\137\x63\162\145\141\x74\x69\x6f\156\x5f\155\151\x73\163\x69\156\x67\137\x64\145\146\141\165\154\x74\137\x67\162\x6f\165\160"); goto Sdfj8; rJTHq: $this->trigger_events("\160\x6f\x73\164\137\x72\145\x67\151\x73\x74\145\162"); goto m6mt1; D17W4: sR8M5: goto RY0Li; CRrB9: $this->set_error("\x61\143\143\x6f\165\x6e\164\137\143\x72\x65\141\164\x69\157\x6e\x5f\x64\165\160\x6c\x69\143\141\x74\x65\137\x69\144\x65\156\x74\x69\164\171"); goto Zc3Ls; V7oxm: hom5z: goto tXks4; F9EFa: $this->set_error("\x61\143\143\157\x75\x6e\x74\x5f\143\x72\145\x61\164\151\x6f\156\137\x69\156\x76\141\154\151\x64\137\144\x65\x66\x61\x75\154\164\137\x67\162\157\x75\x70"); goto snxy0; rxu2Z: if (!($password === FALSE)) { goto hom5z; } goto njQPd; z8BL5: foreach ($groups as $group) { $this->add_to_group($group, $id); c8Pt3: } goto vke6I; umBrQ: $password = $this->hash_password($password); goto rxu2Z; v5ZHM: VuBOq: goto fWWS4; GwAch: goto wEz66; goto IN2Aj; TVFBH: $this->db->insert($this->tables["\x75\163\x65\x72\163"], $user_data); goto f_meZ; Zl2V8: } public function login($identity, $password, $remember = FALSE) { goto TP3J_; TNAQ3: $this->rehash_password_if_needed($user->password, $identity, $password); goto VDo_a; sLAGP: $this->set_error("\x6c\157\x67\151\x6e\137\x75\x6e\x73\165\143\143\x65\163\x73\x66\x75\154\137\156\157\164\137\141\x63\164\x69\166\145"); goto Vqcxl; m7JFU: $this->set_session($user); goto X3YhN; CL5uo: sv9hp: goto XAz5T; cLUvU: $this->set_error("\154\157\x67\x69\x6e\x5f\165\x6e\163\x75\x63\x63\145\x73\x73\146\165\x6c"); goto MupUg; Xrr4Z: goto IPdyh; goto CL5uo; RjghP: $this->hash_password($password); goto VBItS; JfxkZ: $this->trigger_events("\145\170\x74\162\141\137\167\150\x65\162\145"); goto CaMh3; vmr0k: V4rE0: goto OVU7Q; LsL3k: if (!$this->config->item("\x72\145\x6d\x65\x6d\x62\x65\162\x5f\165\x73\145\162\163", "\151\x6f\x6e\137\x61\x75\164\x68")) { goto rbxWQ; } goto sX4Sy; CG5v3: rbxWQ: goto TNAQ3; fQDz3: return FALSE; goto uSiaJ; Vo6rh: if (!$this->verify_password($password, $user->password, $identity)) { goto KLeo7; } goto HVCCM; AWTPa: $this->clear_forgotten_password_code($identity); goto LsL3k; S6wA4: KLeo7: goto vmr0k; cfdBt: $user = $query->row(); goto Vo6rh; XAz5T: $this->remember_user($identity); goto GpnIm; TP7BP: $this->clear_login_attempts($identity); goto AWTPa; BJcaT: $this->set_error("\x6c\x6f\x67\x69\156\x5f\164\x69\x6d\145\157\165\x74"); goto fQDz3; KVjWK: return TRUE; goto S6wA4; sX4Sy: if ($remember) { goto sv9hp; } goto VcPpt; Bz1t3: return FALSE; goto eBI_c; rVtv8: if (!(empty($identity) || empty($password))) { goto qbAzx; } goto cLUvU; uSiaJ: QOzvm: goto ydk96; CaMh3: $query = $this->db->select($this->identity_column . "\x2c\40\145\155\x61\x69\x6c\54\40\151\x64\x2c\x20\160\141\x73\163\x77\157\x72\x64\54\x20\141\x63\164\x69\166\145\x2c\x20\x6c\141\163\x74\x5f\x6c\x6f\x67\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\145\x73\143")->get($this->tables["\165\163\145\162\x73"]); goto ASAGe; ydk96: if (!($query->num_rows() === 1)) { goto V4rE0; } goto cfdBt; wIewh: $this->trigger_events("\x70\157\x73\164\137\154\x6f\x67\151\x6e\x5f\165\x6e\x73\x75\143\143\x65\163\x73\146\x75\x6c"); goto sLAGP; HVCCM: if (!($user->active == 0)) { goto B2lDT; } goto wIewh; TP3J_: $this->trigger_events("\x70\x72\x65\x5f\x6c\157\147\x69\x6e"); goto rVtv8; MupUg: return FALSE; goto YYb49; j_HPF: $this->set_error("\154\x6f\x67\151\x6e\x5f\x75\x6e\163\x75\143\143\x65\x73\x73\x66\x75\x6c"); goto Bz1t3; YYb49: qbAzx: goto JfxkZ; sAhw2: $this->increase_login_attempts($identity); goto U4Wax; VBItS: $this->trigger_events("\160\x6f\163\x74\x5f\154\x6f\147\x69\156\137\165\x6e\163\x75\x63\x63\145\163\163\146\x75\154"); goto BJcaT; U4Wax: $this->trigger_events("\x70\x6f\163\x74\x5f\x6c\x6f\147\x69\156\x5f\165\x6e\163\x75\143\143\x65\x73\x73\x66\165\154"); goto j_HPF; VDo_a: $this->session->sess_regenerate(FALSE); goto neiQ1; Oxnva: B2lDT: goto m7JFU; OVU7Q: $this->hash_password($password); goto sAhw2; ASAGe: if (!$this->is_max_login_attempts_exceeded($identity)) { goto QOzvm; } goto RjghP; VcPpt: $this->clear_remember_code($identity); goto Xrr4Z; X3YhN: $this->update_last_login($user->id); goto TP7BP; OtbyU: $this->set_message("\154\x6f\147\151\x6e\137\x73\165\x63\x63\145\163\x73\x66\165\154"); goto KVjWK; neiQ1: $this->trigger_events(["\x70\x6f\x73\164\137\154\157\147\151\x6e", "\x70\x6f\163\x74\137\x6c\157\147\x69\x6e\137\x73\x75\x63\x63\x65\163\163\x66\x75\x6c"]); goto OtbyU; GpnIm: IPdyh: goto CG5v3; Vqcxl: return FALSE; goto Oxnva; eBI_c: } public function recheck_session() { goto OoMty; cBKzz: $this->trigger_events("\x6c\x6f\147\157\x75\x74"); goto jKdrA; YMfl0: imwq6: goto e8WBl; q55yC: $this->session->unset_userdata([$identity, "\x69\144", "\x75\163\145\x72\x5f\x69\x64"]); goto HcIZy; lINi1: if (!($recheck !== 0)) { goto uYsqf; } goto kwKMj; HcIZy: return FALSE; goto McstN; e8WBl: orCIw: goto EmY3z; xLhYu: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\x69\x64\x65\156\164\x69\x74\171"), "\141\x63\164\x69\166\145" => "\61"])->limit(1)->order_by("\x69\144", "\x64\x65\163\143")->get($this->tables["\165\163\x65\x72\x73"]); goto LwbEe; xG24m: VjDxS: goto qiN5_; EmY3z: uYsqf: goto cQs4b; kwKMj: $last_login = $this->session->userdata("\x6c\x61\x73\164\137\x63\x68\145\x63\153"); goto WLFrn; jKdrA: $identity = $this->config->item("\x69\x64\145\156\x74\151\x74\171", "\151\157\156\x5f\x61\165\x74\150"); goto q55yC; OoMty: $recheck = NULL !== $this->config->item("\162\145\143\150\x65\x63\153\x5f\164\x69\x6d\x65\x72", "\x69\x6f\156\x5f\x61\x75\x74\x68") ? $this->config->item("\162\x65\x63\x68\x65\143\153\x5f\x74\x69\x6d\x65\162", "\x69\157\x6e\x5f\141\165\164\x68") : 0; goto lINi1; qiN5_: $this->session->set_userdata("\x6c\x61\x73\164\x5f\x63\150\x65\x63\x6b", time()); goto YMfl0; McstN: goto imwq6; goto xG24m; cQs4b: return (bool) $this->session->userdata("\151\144\145\156\x74\151\164\171"); goto jaqr6; WLFrn: if (!($last_login + $recheck < time())) { goto orCIw; } goto xLhYu; LwbEe: if ($query->num_rows() === 1) { goto VjDxS; } goto cBKzz; jaqr6: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto X3kXc; Mf22p: return FALSE; goto i7A1S; DS3a2: return $attempts >= $max_attempts; goto GDPMr; hR02j: $attempts = $this->get_attempts_num($identity, $ip_address); goto DS3a2; X3kXc: if (!$this->config->item("\164\162\141\143\153\137\154\x6f\x67\x69\x6e\x5f\141\164\164\x65\155\160\x74\x73", "\151\157\156\x5f\141\x75\x74\150")) { goto WgaOx; } goto W0O2W; GDPMr: SEeVV: goto wWzxc; wWzxc: WgaOx: goto Mf22p; giZSm: if (!($max_attempts > 0)) { goto SEeVV; } goto hR02j; W0O2W: $max_attempts = $this->config->item("\x6d\141\x78\151\x6d\165\155\x5f\154\x6f\147\151\x6e\x5f\x61\x74\x74\x65\x6d\160\x74\x73", "\151\x6f\x6e\x5f\x61\165\164\x68"); goto giZSm; i7A1S: } public function get_attempts_num($identity, $ip_address = NULL) { goto H0tfE; ykefo: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto CRuGj; CRuGj: if (!$this->config->item("\x74\162\x61\143\x6b\137\154\x6f\147\151\x6e\x5f\151\x70\137\x61\144\x64\162\x65\x73\x73", "\151\157\156\x5f\x61\165\164\x68")) { goto wyTE5; } goto VXLr4; G_hSf: return $qres->num_rows(); goto BllQo; yC_eP: $this->db->where("\164\151\155\145\x20\x3e", time() - $this->config->item("\154\x6f\x63\153\x6f\165\164\137\x74\x69\155\x65", "\x69\157\x6e\x5f\x61\165\x74\x68"), FALSE); goto a3j0k; SYaOF: $ip_address = $this->input->ip_address(); goto JQly8; tjSZ3: wyTE5: goto yC_eP; VXLr4: if (isset($ip_address)) { goto E9pjT; } goto SYaOF; Kgkfp: return 0; goto S92DZ; BllQo: Op8zn: goto Kgkfp; JQly8: E9pjT: goto L2MbG; L2MbG: $this->db->where("\x69\160\x5f\141\144\x64\162\x65\x73\163", $ip_address); goto tjSZ3; H0tfE: if (!$this->config->item("\x74\162\x61\143\153\137\154\x6f\x67\151\156\137\141\164\x74\x65\155\160\x74\x73", "\x69\157\x6e\137\x61\x75\x74\150")) { goto Op8zn; } goto GsMoC; GsMoC: $this->db->select("\61", FALSE); goto ykefo; a3j0k: $qres = $this->db->get($this->tables["\154\157\147\x69\156\x5f\x61\x74\164\145\x6d\x70\x74\163"]); goto G_hSf; S92DZ: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto sJcyQ; h5Bw3: $this->db->order_by("\x69\144", "\144\x65\x73\x63"); goto t9WhN; LUgQ9: YKgvJ: goto h5Bw3; uMz32: if (!($qres->num_rows() > 0)) { goto BOXWD; } goto EEvbZ; sRWxY: $this->db->select("\x74\x69\x6d\145"); goto lHpJS; aPn_5: $ip_address = $this->input->ip_address(); goto E7mdu; lHpJS: $this->db->where("\154\x6f\x67\x69\156", $identity); goto sazyJ; sazyJ: if (!$this->config->item("\x74\162\x61\143\x6b\x5f\154\x6f\147\151\x6e\x5f\x69\160\x5f\141\144\144\162\x65\163\x73", "\151\157\156\x5f\x61\x75\164\x68")) { goto YKgvJ; } goto ln_UV; sJcyQ: if (!$this->config->item("\164\x72\x61\143\153\x5f\x6c\157\147\151\156\x5f\141\164\164\145\x6d\x70\164\163", "\x69\157\156\137\141\165\164\150")) { goto kFAmH; } goto sRWxY; ln_UV: if (isset($ip_address)) { goto WgU7j; } goto aPn_5; TnNvw: $this->db->where("\151\160\x5f\141\144\144\x72\x65\x73\x73", $ip_address); goto LUgQ9; gp1uR: return 0; goto aS2U2; EEvbZ: return $qres->row()->time; goto h_lK8; h_lK8: BOXWD: goto zTvVi; zTvVi: kFAmH: goto gp1uR; E7mdu: WgU7j: goto TnNvw; t9WhN: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\156\x5f\141\164\x74\x65\x6d\160\164\163"], 1); goto uMz32; aS2U2: } public function get_last_attempt_ip($identity) { goto ErELg; UyC85: $this->db->select("\x69\x70\x5f\x61\x64\144\162\x65\163\x73"); goto wjDSV; zRwUT: $qres = $this->db->get($this->tables["\154\157\x67\151\156\x5f\x61\164\164\145\155\160\164\163"], 1); goto D2_ag; wjDSV: $this->db->where("\154\157\x67\151\x6e", $identity); goto abEPN; IyymH: Y5g1b: goto Tuwuk; ErELg: if (!($this->config->item("\x74\162\141\x63\153\x5f\x6c\x6f\x67\151\x6e\x5f\x61\164\164\145\155\x70\164\163", "\151\157\156\137\141\x75\164\x68") && $this->config->item("\164\162\141\143\153\137\154\x6f\x67\x69\x6e\137\151\160\137\141\x64\x64\x72\x65\163\x73", "\x69\157\x6e\x5f\141\x75\164\x68"))) { goto ptrw5; } goto UyC85; N105t: return $qres->row()->ip_address; goto IyymH; D2_ag: if (!($qres->num_rows() > 0)) { goto Y5g1b; } goto N105t; Tuwuk: ptrw5: goto AHhYo; abEPN: $this->db->order_by("\151\x64", "\x64\x65\x73\x63"); goto zRwUT; AHhYo: return ''; goto PPl4o; PPl4o: } public function increase_login_attempts($identity) { goto gJvFN; Uhqol: $data["\x69\x70\137\141\144\144\x72\x65\163\163"] = $this->input->ip_address(); goto C_bo1; gJvFN: if (!$this->config->item("\164\162\141\143\153\137\x6c\157\147\x69\156\x5f\141\x74\164\x65\155\160\164\x73", "\x69\157\x6e\x5f\141\x75\164\150")) { goto i49Db; } goto AFDNv; C_bo1: I87zv: goto JSaUe; K7zb9: if (!$this->config->item("\x74\x72\141\143\x6b\x5f\154\157\x67\151\x6e\137\x69\x70\x5f\141\144\144\162\x65\163\163", "\151\x6f\x6e\x5f\x61\165\164\x68")) { goto I87zv; } goto Uhqol; rUdTT: return FALSE; goto yCsZj; GVMVN: i49Db: goto rUdTT; JSaUe: return $this->db->insert($this->tables["\x6c\157\x67\x69\156\137\x61\164\164\x65\155\x70\164\163"], $data); goto GVMVN; AFDNv: $data = ["\x69\x70\137\141\x64\x64\162\x65\x73\163" => '', "\154\157\147\151\x6e" => $identity, "\x74\151\x6d\145" => time()]; goto K7zb9; yCsZj: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto Wz0CP; c7T8E: $this->db->where("\x69\160\x5f\141\144\x64\x72\x65\x73\x73", $ip_address); goto uOtLO; tqQoI: return FALSE; goto IKZDF; skMvH: return $this->db->delete($this->tables["\154\x6f\147\x69\156\x5f\141\x74\164\145\x6d\x70\164\163"]); goto LPKsd; K20Qa: if (isset($ip_address)) { goto Yhzk5; } goto P9KSi; HmkaU: Yhzk5: goto c7T8E; Wz0CP: if (!$this->config->item("\x74\162\141\x63\153\x5f\x6c\x6f\x67\x69\156\x5f\x61\x74\x74\x65\x6d\160\164\163", "\151\157\156\x5f\141\165\x74\x68")) { goto AgHOu; } goto prD9p; prD9p: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\x63\x6b\x6f\x75\x74\137\164\x69\155\x65", "\151\x6f\x6e\137\141\165\164\150")); goto urzK1; f60X1: if (!$this->config->item("\x74\x72\x61\143\153\x5f\x6c\x6f\x67\x69\156\137\x69\160\137\141\144\144\x72\145\163\163", "\x69\x6f\x6e\137\x61\x75\164\x68")) { goto JF4cf; } goto K20Qa; uOtLO: JF4cf: goto iYacd; urzK1: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto f60X1; LPKsd: AgHOu: goto tqQoI; iYacd: $this->db->or_where("\x74\151\x6d\x65\40\74", time() - $old_attempts_expire_period, FALSE); goto skMvH; P9KSi: $ip_address = $this->input->ip_address(); goto HmkaU; IKZDF: } public function limit($limit) { goto NrfJb; a6aCu: return $this; goto FESua; NrfJb: $this->trigger_events("\x6c\151\155\x69\x74"); goto Snqcg; Snqcg: $this->_ion_limit = $limit; goto a6aCu; FESua: } public function offset($offset) { goto ikRzg; ikRzg: $this->trigger_events("\x6f\146\146\163\x65\x74"); goto Wyj0W; Wyj0W: $this->_ion_offset = $offset; goto XuEAv; XuEAv: return $this; goto fks0S; fks0S: } public function where($where, $value = NULL) { goto oN2dz; qlH_t: array_push($this->_ion_where, $where); goto vuV9b; oN2dz: $this->trigger_events("\167\x68\145\162\145"); goto KW_qv; vuV9b: return $this; goto CXi9i; wKhq7: $where = [$where => $value]; goto jJk2F; jJk2F: qhELG: goto qlH_t; KW_qv: if (is_array($where)) { goto qhELG; } goto wKhq7; CXi9i: } public function like($like, $value = NULL, $position = "\142\x6f\x74\150") { goto eblRj; ursw0: return $this; goto PtCDT; eEaCa: array_push($this->_ion_like, ["\x6c\x69\153\145" => $like, "\166\141\154\x75\x65" => $value, "\160\x6f\x73\x69\164\x69\157\156" => $position]); goto ursw0; eblRj: $this->trigger_events("\154\x69\x6b\145"); goto eEaCa; PtCDT: } public function select($select) { goto iBioO; ogWQu: return $this; goto aUj40; pk0sP: $this->_ion_select[] = $select; goto ogWQu; iBioO: $this->trigger_events("\x73\145\x6c\145\143\164"); goto pk0sP; aUj40: } public function order_by($by, $order = "\x64\x65\163\x63") { goto Re5c8; Heql1: return $this; goto wVQk0; Re5c8: $this->trigger_events("\157\162\144\145\x72\x5f\142\171"); goto Spn0M; taTgL: $this->_ion_order = $order; goto Heql1; Spn0M: $this->_ion_order_by = $by; goto taTgL; wVQk0: } public function row() { goto IDjLU; nQ1fy: $row = $this->response->row(); goto vEkBk; IDjLU: $this->trigger_events("\162\157\167"); goto nQ1fy; vEkBk: return $row; goto eEBbD; eEBbD: } public function row_array() { goto mZRtN; mZRtN: $this->trigger_events(["\x72\x6f\167", "\x72\x6f\167\137\141\162\162\141\x79"]); goto iv_u4; g_ZGW: return $row; goto Y3y42; iv_u4: $row = $this->response->row_array(); goto g_ZGW; Y3y42: } public function result() { goto JW48K; JW48K: $this->trigger_events("\162\x65\x73\165\154\x74"); goto PkDN3; PkDN3: $result = $this->response->result(); goto nJfE5; nJfE5: return $result; goto SfaSq; SfaSq: } public function result_array() { goto F3pXr; RH1Ga: $result = $this->response->result_array(); goto Sa4gJ; F3pXr: $this->trigger_events(["\x72\x65\163\165\154\x74", "\162\145\163\165\x6c\164\x5f\141\162\x72\x61\x79"]); goto RH1Ga; Sa4gJ: return $result; goto zeY9G; zeY9G: } public function num_rows() { goto nBke6; Vdb2F: return $result; goto T0xSt; nBke6: $this->trigger_events(["\x6e\x75\155\137\162\x6f\x77\x73"]); goto mEeXG; mEeXG: $result = $this->response->num_rows(); goto Vdb2F; T0xSt: } public function users($groups = NULL) { goto EkBpo; g2f19: $this->db->select([$this->tables["\x75\163\x65\162\x73"] . "\x2e\52", $this->tables["\x75\163\x65\x72\163"] . "\x2e\x69\x64\40\141\x73\x20\x69\x64", $this->tables["\165\x73\145\162\x73"] . "\56\151\144\x20\x61\163\40\165\x73\x65\x72\x5f\151\x64"]); goto boaI4; ZnYPd: $this->db->limit($this->_ion_limit); goto AsyXf; aXkXK: foreach ($groups as $group) { goto IZGPN; mkoQu: rIwce: goto Nmozo; M7f8o: Gn8CG: goto mkoQu; IZGPN: if (is_numeric($group)) { goto JbdH8; } goto s0Q96; Ekvpn: goto Gn8CG; goto k4rW0; k4rW0: JbdH8: goto b7EBg; b7EBg: $group_ids[] = $group; goto M7f8o; s0Q96: $group_names[] = $group; goto Ekvpn; Nmozo: } goto XdeTx; L0zBH: BVKjG: goto Prj7t; ZfkB9: $this->db->distinct(); goto VDDUT; zaExk: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto rCNyP; psaJ3: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\153\145"], $like["\x76\141\154\165\145"], $like["\x70\x6f\x73\x69\164\x69\157\156"]); E1aMQ: } goto GRzi2; BvdmB: foreach ($this->_ion_where as $where) { $this->db->where($where); iDJUG: } goto XcfTO; Prj7t: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto kHeC4; } goto x0iFf; u93FU: hoz9o: goto tfFCx; k_r18: J_Zyz: goto FyqmF; zj7DN: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\137\167\x68\145\162\145\137\x69\x6e" : "\x77\150\145\162\145\137\151\x6e"; goto sQL6S; NoZlx: Le3R8: goto bxuxd; NFLjI: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto LYNuU; sQL6S: if (empty($group_names)) { goto hoz9o; } goto cAJrQ; Jj2nS: $group_ids = []; goto bTseE; fKKHi: $this->trigger_events("\145\170\x74\162\141\137\x77\150\x65\x72\x65"); goto Hgh9V; paqbe: $this->db->{$or_where_in}($this->tables["\x75\163\x65\x72\x73\x5f\147\162\157\x75\160\163"] . "\x2e" . $this->join["\147\x72\x6f\165\160\x73"], $group_ids); goto ZqQ6L; ySQEy: X29W6: goto Jj2nS; rzD5U: $this->_ion_where = []; goto jYHTv; boaI4: goto OdKl9; goto k_r18; x0iFf: if (!isset($this->_ion_limit)) { goto hvIpn; } goto ZnYPd; XdeTx: fefwC: goto zj7DN; Sfqby: fecqO: goto hYaek; RYOob: $this->_ion_like = []; goto L0zBH; hNH1L: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto J_Zyz; } goto g2f19; cAJrQ: $this->db->join($this->tables["\147\x72\x6f\165\x70\x73"], $this->tables["\x75\163\x65\x72\163\x5f\x67\162\x6f\x75\x70\163"] . "\56" . $this->join["\x67\162\x6f\165\160\x73"] . "\x20\75\x20" . $this->tables["\147\x72\157\x75\x70\x73"] . "\x2e\x69\144", "\x69\156\x6e\x65\162"); goto CREI_; Hgh9V: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto c4dBZ; } goto BvdmB; YYt1j: OdKl9: goto KteNs; iK76c: $this->_ion_order_by = NULL; goto YCIKN; EkBpo: $this->trigger_events("\165\x73\145\x72\163"); goto hNH1L; jtFiw: kHeC4: goto NFLjI; ckE91: hvIpn: goto tG2H3; QUgNt: $this->response = $this->db->get($this->tables["\x75\163\x65\x72\x73"]); goto VcPAw; AsyXf: $this->_ion_limit = NULL; goto ckE91; ogPxy: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto BVKjG; } goto psaJ3; jYHTv: c4dBZ: goto ogPxy; s0etS: $this->_ion_offset = NULL; goto NoZlx; CREI_: $this->db->where_in($this->tables["\147\x72\x6f\x75\160\x73"] . "\x2e\156\x61\x6d\x65", $group_names); goto u93FU; ZqQ6L: Xg50Q: goto NefRp; rCNyP: $this->_ion_order = NULL; goto iK76c; VcPAw: return $this; goto KW58g; rq4Wc: if (is_array($groups)) { goto fecqO; } goto lLFGL; bxuxd: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto VEGQv; } goto zaExk; tfFCx: if (empty($group_ids)) { goto Xg50Q; } goto paqbe; GRzi2: qc5zD: goto RYOob; NefRp: wEliY: goto fKKHi; ygYrl: $this->_ion_select = []; goto YYt1j; hYaek: if (!(isset($groups) && !empty($groups))) { goto X29W6; } goto ZfkB9; VDDUT: $this->db->join($this->tables["\x75\163\x65\x72\163\x5f\147\162\157\165\x70\x73"], $this->tables["\x75\163\145\162\x73\x5f\x67\162\157\165\160\x73"] . "\x2e" . $this->join["\x75\x73\x65\162\x73"] . "\75" . $this->tables["\x75\x73\145\162\x73"] . "\56\151\144", "\x69\156\x6e\x65\x72"); goto ySQEy; F8SbO: kyPKq: goto ygYrl; YCIKN: VEGQv: goto QUgNt; bTseE: $group_names = []; goto aXkXK; LYNuU: $this->_ion_limit = NULL; goto s0etS; XcfTO: cfpUA: goto rzD5U; tG2H3: goto Le3R8; goto jtFiw; KteNs: if (!isset($groups)) { goto wEliY; } goto rq4Wc; FyqmF: foreach ($this->_ion_select as $select) { $this->db->select($select); tICXN: } goto F8SbO; lLFGL: $groups = [$groups]; goto Sfqby; KW58g: } public function user($id = NULL) { goto OSTUK; u0ua1: $this->users(); goto phFws; OSTUK: $this->trigger_events("\165\x73\145\162"); goto ioQXD; n4v0u: $this->limit(1); goto s19dS; knijm: $this->where($this->tables["\x75\163\x65\162\163"] . "\56\x69\x64", $id); goto u0ua1; ioQXD: $id = isset($id) ? $id : $this->session->userdata("\165\163\x65\162\x5f\151\144"); goto n4v0u; phFws: return $this; goto PY0SF; s19dS: $this->order_by($this->tables["\165\163\145\162\x73"] . "\x2e\x69\x64", "\x64\145\x73\x63"); goto knijm; PY0SF: } public function get_users_groups($id = FALSE) { goto tCayG; SErcP: $id || ($id = $this->session->userdata("\x75\x73\145\x72\137\151\x64")); goto rkqNm; rkqNm: return $this->db->select($this->tables["\165\x73\145\162\163\x5f\147\x72\x6f\165\x70\x73"] . "\56" . $this->join["\147\162\157\x75\160\163"] . "\x20\x61\163\40\151\144\54\x20" . $this->tables["\x67\162\x6f\x75\160\163"] . "\56\x6e\x61\x6d\x65\54\40" . $this->tables["\x67\162\157\165\x70\x73"] . "\x2e\144\x65\x73\x63\x72\151\x70\164\x69\x6f\x6e")->where($this->tables["\165\x73\x65\x72\163\137\x67\162\x6f\165\x70\163"] . "\56" . $this->join["\x75\x73\x65\x72\x73"], $id)->join($this->tables["\147\162\157\x75\x70\x73"], $this->tables["\x75\x73\x65\162\163\x5f\147\x72\x6f\165\160\163"] . "\x2e" . $this->join["\147\162\x6f\165\x70\163"] . "\x3d" . $this->tables["\147\x72\x6f\x75\160\x73"] . "\x2e\151\x64")->get($this->tables["\165\163\x65\x72\163\x5f\147\162\157\165\x70\x73"]); goto KuVYO; tCayG: $this->trigger_events("\x67\145\x74\x5f\x75\x73\x65\162\x73\x5f\147\x72\x6f\165\160"); goto SErcP; KuVYO: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto cJ5k4; SjJaz: goto Wi3Dj; goto gYmP3; BzMIY: n9N8f: goto HTLgD; gYmP3: Pj_Hm: goto DbrjR; qxtvM: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; u7y9H: } goto rCUv1; tMcst: $groups_array = []; goto qxtvM; fxQ_R: $this->_cache_user_in_group[$id] = $groups_array; goto SjJaz; HTLgD: return $check_all; goto DozCr; sxbc2: if (isset($this->_cache_user_in_group[$id])) { goto Pj_Hm; } goto iVj8H; iVj8H: $users_groups = $this->get_users_groups($id)->result(); goto tMcst; RE4S9: foreach ($check_group as $key => $value) { goto h6fjm; zeTk9: fPlyU: goto Agg1F; ARf5v: if (!(in_array($value, $groups) xor $check_all)) { goto Q9tNT; } goto j9Ml3; j9Ml3: return !$check_all; goto cB05l; cB05l: Q9tNT: goto zeTk9; h6fjm: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto ARf5v; Agg1F: } goto BzMIY; rCUv1: xkpgu: goto fxQ_R; gK8vp: Wi3Dj: goto RE4S9; DbrjR: $groups_array = $this->_cache_user_in_group[$id]; goto gK8vp; V3XXj: $check_group = [$check_group]; goto PwrQP; cJ5k4: $this->trigger_events("\151\156\x5f\x67\x72\x6f\x75\x70"); goto BCmzt; PwrQP: Onz_a: goto sxbc2; RDPEc: if (is_array($check_group)) { goto Onz_a; } goto V3XXj; BCmzt: $id || ($id = $this->session->userdata("\x75\163\x65\162\137\151\x64")); goto RDPEc; DozCr: } public function add_to_group($group_ids, $user_id = FALSE) { goto mFSKW; fk4wd: foreach ($group_ids as $group_id) { goto ItMP1; Pl7aC: $group_name = $group[0]->name; goto ZpqBk; ItMP1: if (!$this->db->insert($this->tables["\165\x73\x65\162\x73\x5f\x67\x72\157\x75\160\163"], [$this->join["\x67\162\157\165\x70\x73"] => (float) $group_id, $this->join["\165\163\x65\162\x73"] => (float) $user_id])) { goto RLx3w; } goto aFvCb; Art4G: Husuo: goto LEqO8; iDWvN: $return++; goto UBii0; LEqO8: $group_name = $this->_cache_groups[$group_id]; goto YfJeI; GzDIN: ZCWHR: goto aRR98; aFvCb: if (isset($this->_cache_groups[$group_id])) { goto Husuo; } goto MLiCp; UBii0: RLx3w: goto GzDIN; MLiCp: $group = $this->group($group_id)->result(); goto Pl7aC; ZpqBk: $this->_cache_groups[$group_id] = $group_name; goto zGRLO; zGRLO: goto ccKPn; goto Art4G; YfJeI: ccKPn: goto ZBhrZ; ZBhrZ: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto iDWvN; aRR98: } goto jZET3; lrURb: O5zda: goto Ihw1j; x3PNM: $group_ids = [$group_ids]; goto lrURb; Ihw1j: $return = 0; goto fk4wd; mFSKW: $this->trigger_events("\141\144\144\x5f\x74\x6f\137\x67\x72\157\x75\x70"); goto ZOJs8; jZET3: vIzaf: goto uBFTj; uBFTj: return $return; goto Yi9Gv; ZOJs8: $user_id || ($user_id = $this->session->userdata("\165\x73\145\162\x5f\x69\x64")); goto UE7My; UE7My: if (is_array($group_ids)) { goto O5zda; } goto x3PNM; Yi9Gv: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto t0fmd; Nklax: return $return; goto OwvXP; CIi3F: $return = TRUE; goto FgBdB; fsMbT: i3egl: goto zHqU2; FgBdB: n6flS: goto Nklax; IfvgN: return FALSE; goto f22yP; t0fmd: $this->trigger_events("\x72\x65\155\x6f\x76\x65\137\146\162\157\x6d\x5f\x67\162\x6f\x75\x70"); goto XyRyW; CMaCG: PXgg9: goto CIi3F; wwnjO: QRv5L: goto SU17d; OP82N: fZjpe: goto MwFGl; LP0u1: $this->_cache_user_in_group[$user_id] = []; goto fsMbT; MwFGl: if (is_array($group_ids)) { goto QRv5L; } goto wOtyz; XyRyW: if (!empty($user_id)) { goto ZGI8D; } goto IfvgN; SU17d: foreach ($group_ids as $group_id) { goto tBhfd; tBhfd: $this->db->delete($this->tables["\x75\x73\145\x72\x73\137\x67\162\157\x75\160\163"], [$this->join["\x67\x72\x6f\165\x70\163"] => (float) $group_id, $this->join["\x75\163\x65\x72\x73"] => (float) $user_id]); goto wBBTs; ZJQkI: YFz5d: goto hTCsY; wBBTs: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto YFz5d; } goto KSV0o; KSV0o: unset($this->_cache_user_in_group[$user_id][$group_id]); goto ZJQkI; hTCsY: xNeJi: goto dlS67; dlS67: } goto CMaCG; wOtyz: $group_ids = [$group_ids]; goto wwnjO; cxN2K: if (!($return = $this->db->delete($this->tables["\165\x73\145\162\x73\x5f\147\x72\x6f\x75\x70\x73"], [$this->join["\165\x73\145\x72\x73"] => (float) $user_id]))) { goto i3egl; } goto LP0u1; QpwMc: if (!empty($group_ids)) { goto fZjpe; } goto cxN2K; f22yP: ZGI8D: goto QpwMc; zHqU2: goto n6flS; goto OP82N; OwvXP: } public function groups() { goto O5NyR; xxyy3: iQ94b: goto lOCKM; lsbT2: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto JtvMG; aVgHe: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto J22Et; } goto lsbT2; lOCKM: $this->_ion_where = []; goto MaOJH; aupny: $this->response = $this->db->get($this->tables["\147\162\x6f\x75\x70\163"]); goto ovAqz; O5NyR: $this->trigger_events("\x67\162\x6f\165\x70\x73"); goto I9AUZ; OZy8i: if (!isset($this->_ion_limit)) { goto JRm2_; } goto SsIdD; ovAqz: return $this; goto AYubk; ZRvfs: foreach ($this->_ion_where as $where) { $this->db->where($where); pjxVM: } goto xxyy3; MaOJH: nl1rj: goto kdZbL; F9sFp: $this->_ion_limit = NULL; goto a1v9J; a1v9J: $this->_ion_offset = NULL; goto fYzl3; I9AUZ: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto nl1rj; } goto ZRvfs; kdZbL: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto lpCP2; } goto OZy8i; qlLxY: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto F9sFp; SsIdD: $this->db->limit($this->_ion_limit); goto pXcPh; vUTU3: lpCP2: goto qlLxY; fYzl3: Pw_Ks: goto aVgHe; JtvMG: J22Et: goto aupny; We0mg: JRm2_: goto bs5Em; pXcPh: $this->_ion_limit = NULL; goto We0mg; bs5Em: goto Pw_Ks; goto vUTU3; AYubk: } public function group($id = NULL) { goto ISsx9; ISsx9: $this->trigger_events("\147\162\157\x75\x70"); goto A0QMh; Wcywj: return $this->groups(); goto s09SP; kQNXe: $this->order_by("\151\x64", "\144\145\x73\x63"); goto Wcywj; A0QMh: if (!isset($id)) { goto kAnt6; } goto lcuRS; ZiEXj: $this->limit(1); goto kQNXe; lcuRS: $this->where($this->tables["\x67\x72\157\x75\x70\163"] . "\56\x69\x64", $id); goto ARKWs; ARKWs: kAnt6: goto ZiEXj; s09SP: } public function update($id, array $data) { goto NMBXf; Z33KZ: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\163\163\x77\x6f\x72\144", $data) || array_key_exists("\x65\x6d\141\x69\154", $data))) { goto euM3K; } goto NEl6t; X6h5W: $this->db->trans_rollback(); goto aVQic; LhanS: if (!($this->db->trans_status() === FALSE)) { goto FYhUA; } goto yb9rb; bWFnF: $this->trigger_events("\145\170\x74\x72\141\x5f\167\x68\x65\162\x65"); goto QQFRX; i11EB: FYhUA: goto QyVOk; V97XG: HFeLM: goto UBNea; WijK9: $this->set_error("\165\x70\x64\x61\x74\145\137\165\x6e\163\x75\143\143\145\x73\163\x66\x75\x6c"); goto bAxi9; uMlNy: return TRUE; goto TCMSA; NEl6t: if (!array_key_exists("\x70\141\x73\163\167\x6f\162\144", $data)) { goto iOkUz; } goto Tga60; xQwH0: nt9pC: goto iwq_i; npU24: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\160\144\141\x74\x65\x5f\165\x73\x65\x72", "\x70\x6f\163\164\137\x75\160\x64\141\164\x65\x5f\165\x73\x65\x72\x5f\163\x75\143\143\x65\x73\x73\x66\165\x6c"]); goto Wrmjc; aVQic: $this->set_error("\x61\x63\x63\x6f\x75\x6e\x74\x5f\143\x72\x65\141\x74\x69\157\x6e\137\x64\165\x70\x6c\151\143\141\164\145\137\151\x64\145\x6e\x74\x69\164\171"); goto AEZA4; GxHkQ: $this->set_error("\x75\160\144\141\164\x65\x5f\x75\156\163\165\x63\x63\145\163\x73\146\165\x6c"); goto PCDWZ; NMBXf: $this->trigger_events("\160\162\145\137\x75\160\144\x61\x74\x65\x5f\x75\x73\145\x72"); goto jez3O; L3hs9: $this->db->trans_begin(); goto GXNqG; Tga60: if (!empty($data["\x70\x61\163\x73\167\157\162\x64"])) { goto nt9pC; } goto g98EG; g98EG: unset($data["\x70\x61\x73\x73\x77\157\x72\x64"]); goto STSMU; jmqiq: DaL9l: goto hA3YK; yb9rb: $this->db->trans_rollback(); goto KfoWz; Ux7CW: $this->db->trans_rollback(); goto i01v3; KfoWz: $this->trigger_events(["\160\157\x73\x74\137\165\160\x64\x61\164\x65\137\165\x73\x65\x72", "\x70\x6f\x73\x74\x5f\165\x70\144\x61\x74\145\137\165\x73\x65\x72\x5f\165\x6e\x73\165\143\143\x65\163\x73\146\165\154"]); goto jP92I; Wrmjc: $this->set_message("\165\160\x64\x61\164\145\137\x73\x75\x63\x63\x65\x73\163\x66\165\x6c"); goto uMlNy; PCDWZ: return FALSE; goto V97XG; beRYe: if (!($data["\x70\141\163\163\167\x6f\x72\144"] === FALSE)) { goto MDnSK; } goto Ux7CW; AEZA4: $this->trigger_events(["\x70\x6f\x73\164\137\x75\160\x64\x61\x74\145\x5f\165\163\145\162", "\160\157\x73\164\x5f\165\160\x64\x61\164\145\x5f\x75\x73\x65\x72\x5f\x75\x6e\163\165\143\x63\x65\163\x73\146\165\154"]); goto GxHkQ; lJL9i: euM3K: goto bWFnF; GXNqG: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto HFeLM; } goto X6h5W; QyVOk: $this->db->trans_commit(); goto npU24; jez3O: $user = $this->user($id)->row(); goto L3hs9; i01v3: $this->trigger_events(["\x70\157\163\164\137\x75\160\144\x61\x74\x65\137\x75\x73\x65\162", "\160\x6f\x73\x74\137\x75\x70\x64\141\164\x65\x5f\165\163\x65\x72\x5f\165\156\163\165\x63\x63\x65\x73\163\146\165\x6c"]); goto WijK9; jP92I: $this->set_error("\x75\160\144\141\x74\x65\137\x75\x6e\x73\x75\143\143\x65\163\x73\146\165\154"); goto OKzmy; OKzmy: return FALSE; goto i11EB; hA3YK: iOkUz: goto lJL9i; STSMU: goto DaL9l; goto xQwH0; DnwT8: MDnSK: goto jmqiq; UBNea: $data = $this->_filter_data($this->tables["\165\x73\x65\x72\x73"], $data); goto Z33KZ; iwq_i: $data["\x70\x61\x73\163\x77\157\x72\x64"] = $this->hash_password($data["\160\x61\x73\163\167\x6f\x72\x64"], $user->{$this->identity_column}); goto beRYe; QQFRX: $this->db->update($this->tables["\165\163\145\162\x73"], $data, ["\x69\144" => $user->id]); goto LhanS; bAxi9: return FALSE; goto DnwT8; TCMSA: } public function delete_user($id) { goto Y4nuT; S0s1s: $this->db->delete($this->tables["\165\x73\145\x72\163"], ["\151\144" => $id]); goto Gf16t; Vgr6N: vZpB0: goto vSuVr; qtSzH: $this->remove_from_group(NULL, $id); goto S0s1s; Iyv58: $this->set_error("\x64\x65\154\x65\164\145\137\165\x6e\x73\165\x63\x63\x65\163\163\x66\165\154"); goto e9gWB; vpR93: $this->set_message("\144\x65\154\x65\x74\145\x5f\x73\x75\143\143\145\163\163\x66\x75\154"); goto ZKaD1; ijySI: $this->trigger_events(["\x70\x6f\163\164\137\144\145\x6c\x65\x74\145\137\165\x73\145\162", "\160\x6f\x73\164\x5f\144\145\x6c\145\164\x65\137\165\x73\x65\x72\x5f\x75\156\x73\165\143\143\145\163\163\146\165\154"]); goto Iyv58; ZKaD1: return TRUE; goto cXNFG; e9gWB: return FALSE; goto Vgr6N; vSuVr: $this->db->trans_commit(); goto F17eF; YAXlb: $this->db->trans_begin(); goto qtSzH; TVmQx: $this->db->trans_rollback(); goto ijySI; Y4nuT: $this->trigger_events("\x70\162\x65\137\144\145\x6c\x65\x74\x65\137\x75\163\145\162"); goto YAXlb; Gf16t: if (!($this->db->trans_status() === FALSE)) { goto vZpB0; } goto TVmQx; F17eF: $this->trigger_events(["\x70\157\163\164\x5f\x64\145\x6c\145\x74\145\x5f\165\163\x65\162", "\x70\157\x73\x74\x5f\x64\x65\x6c\x65\x74\145\137\x75\163\x65\x72\x5f\x73\x75\x63\143\x65\163\x73\146\165\154"]); goto vpR93; cXNFG: } public function update_last_login($id) { goto vsWEP; Io9lR: $this->load->helper("\144\141\x74\145"); goto N3AOa; ByMR2: return $this->db->affected_rows() == 1; goto K1x4N; N3AOa: $this->trigger_events("\145\x78\x74\162\x61\137\x77\150\x65\x72\145"); goto IPRCr; IPRCr: $this->db->update($this->tables["\165\x73\145\162\x73"], ["\x6c\141\163\x74\x5f\x6c\157\x67\151\156" => time()], ["\151\144" => $id]); goto ByMR2; vsWEP: $this->trigger_events("\x75\160\144\x61\x74\145\x5f\x6c\x61\163\164\137\154\x6f\x67\151\x6e"); goto Io9lR; K1x4N: } public function set_lang($lang = "\x65\156") { goto vTJpf; T2GSS: goto mI_20; goto GPtms; jP2hC: if ($this->config->item("\x75\163\x65\x72\137\145\x78\160\151\162\x65", "\x69\x6f\x6e\137\x61\x75\164\x68") === 0) { goto WxsRB; } goto ikRkZ; bVGaZ: set_cookie(["\x6e\141\x6d\145" => "\x6c\x61\156\147\137\143\157\144\145", "\166\x61\x6c\165\145" => $lang, "\145\170\160\151\162\x65" => $expire]); goto nTf0f; GPtms: WxsRB: goto gQtnh; Ao0Ib: mI_20: goto bVGaZ; ikRkZ: $expire = $this->config->item("\165\x73\145\x72\137\x65\170\x70\x69\x72\x65", "\x69\x6f\x6e\137\x61\165\x74\x68"); goto T2GSS; nTf0f: return TRUE; goto WES8_; vTJpf: $this->trigger_events("\163\145\x74\x5f\x6c\141\x6e\147"); goto jP2hC; gQtnh: $expire = self::MAX_COOKIE_LIFETIME; goto Ao0Ib; WES8_: } public function set_session($user) { goto UimFt; k8qcb: $session_data = ["\151\144\145\156\164\151\x74\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\141\151\154" => $user->email, "\165\x73\x65\x72\137\151\144" => $user->id, "\157\x6c\144\x5f\154\141\x73\x74\137\154\x6f\147\x69\x6e" => $user->last_login, "\154\x61\163\x74\x5f\x63\x68\145\x63\153" => time()]; goto E1om3; UimFt: $this->trigger_events("\160\x72\x65\x5f\x73\145\x74\137\163\x65\x73\163\x69\x6f\156"); goto k8qcb; E1om3: $this->session->set_userdata($session_data); goto Rh08x; Es0F6: return TRUE; goto YDihJ; Rh08x: $this->trigger_events("\x70\x6f\x73\164\137\163\x65\164\x5f\x73\145\x73\163\151\x6f\x6e"); goto Es0F6; YDihJ: } public function remember_user($identity) { goto MU4O7; ik8sb: $this->trigger_events(["\x70\157\163\164\x5f\162\x65\155\x65\155\x62\x65\162\137\165\163\145\x72", "\162\145\x6d\145\x6d\142\145\162\137\x75\x73\145\162\x5f\165\x6e\x73\x75\x63\x63\x65\x73\163\x66\165\154"]); goto BFHSH; Rxdwj: if ($identity) { goto Y0xso; } goto hfGlI; hfGlI: return FALSE; goto OCBBs; hpPIM: $expire = $this->config->item("\x75\x73\145\x72\x5f\145\170\160\x69\x72\x65", "\151\157\156\137\141\165\164\150"); goto gXU7X; mlkDe: $expire = self::MAX_COOKIE_LIFETIME; goto kJVMi; G28VL: $this->db->update($this->tables["\165\x73\145\162\x73"], ["\162\x65\x6d\145\x6d\x62\145\162\x5f\x73\x65\x6c\x65\x63\x74\157\162" => $token->selector, "\162\x65\x6d\x65\155\x62\x65\162\x5f\x63\x6f\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto F1MGQ; kJVMi: ErXIH: goto hhMX_; BFHSH: return FALSE; goto FGx33; InOoK: $token = $this->_generate_selector_validator_couple(); goto agv8b; gXU7X: goto ErXIH; goto vffw2; Yv78r: KsjBt: goto ik8sb; adCVv: $this->trigger_events(["\x70\157\x73\x74\x5f\162\x65\x6d\x65\x6d\x62\145\x72\x5f\x75\x73\145\x72", "\x72\x65\x6d\145\x6d\142\x65\162\137\x75\x73\x65\x72\137\x73\165\143\x63\145\x73\x73\146\x75\154"]); goto u10CV; MU4O7: $this->trigger_events("\x70\x72\145\x5f\x72\x65\155\145\x6d\x62\x65\x72\x5f\165\x73\145\162"); goto Rxdwj; vffw2: VhYTw: goto mlkDe; agv8b: if (!$token->validator_hashed) { goto KsjBt; } goto G28VL; Qgq8i: c0bsX: goto Yv78r; OCBBs: Y0xso: goto InOoK; hhMX_: set_cookie(["\x6e\141\x6d\145" => $this->config->item("\x72\x65\155\x65\155\142\145\162\x5f\143\157\x6f\153\x69\x65\137\x6e\x61\x6d\145", "\x69\157\156\x5f\141\x75\164\x68"), "\166\x61\154\x75\145" => $token->user_code, "\145\x78\x70\151\x72\x65" => $expire]); goto adCVv; u10CV: return TRUE; goto Qgq8i; cHQHR: if ($this->config->item("\165\163\x65\x72\137\145\170\160\x69\162\145", "\x69\157\156\x5f\141\x75\x74\x68") === 0) { goto VhYTw; } goto hpPIM; F1MGQ: if (!($this->db->affected_rows() > -1)) { goto c0bsX; } goto cHQHR; FGx33: } public function login_remembered_user() { goto TbpUC; D22JE: $this->set_session($user); goto PCv91; sUOE5: if (!$this->config->item("\x75\163\145\162\137\145\170\x74\145\x6e\144\x5f\x6f\x6e\x5f\154\x6f\147\x69\x6e", "\x69\157\156\137\141\x75\x74\150")) { goto cqM_x; } goto fUniy; kHLcs: return FALSE; goto A6krp; S4y2M: I3ZUG: goto VD16s; VD16s: sMei0: goto lPbYl; fwkNo: return FALSE; goto jhASd; P0z0c: $this->trigger_events(["\160\157\x73\164\x5f\x6c\157\x67\151\x6e\137\x72\x65\155\145\x6d\142\x65\x72\145\x64\x5f\x75\163\145\162", "\x70\157\x73\x74\137\x6c\x6f\147\151\156\x5f\x72\145\x6d\145\155\x62\145\162\145\144\137\x75\x73\x65\x72\x5f\165\156\163\165\x63\x63\145\163\x73\x66\165\x6c"]); goto fwkNo; LaZDA: cqM_x: goto U27Gr; waBwZ: return TRUE; goto S4y2M; WA2Gx: $this->update_last_login($user->id); goto D22JE; PorVE: $identity = $user->{$this->identity_column}; goto KqdR5; cWIfN: $this->trigger_events(["\x70\x6f\x73\x74\x5f\154\157\x67\151\156\x5f\x72\x65\x6d\145\155\142\145\x72\145\x64\137\x75\163\x65\x72", "\x70\x6f\163\164\137\x6c\157\x67\x69\156\x5f\x72\x65\x6d\145\155\142\145\x72\x65\144\137\x75\x73\145\162\x5f\165\156\163\165\x63\x63\x65\163\x73\x66\165\154"]); goto kHLcs; FL78n: $user = $query->row(); goto PorVE; PCv91: $this->clear_forgotten_password_code($identity); goto sUOE5; fUniy: $this->remember_user($identity); goto LaZDA; TbpUC: $this->trigger_events("\x70\162\145\x5f\154\157\147\x69\156\137\x72\x65\155\145\x6d\142\x65\x72\x65\144\x5f\165\x73\145\x72"); goto nNEV9; Lt6uk: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto vzh_b; vzh_b: if (!($token === FALSE)) { goto I04dM; } goto cWIfN; Mkkmn: $this->trigger_events(["\160\157\163\164\x5f\x6c\157\x67\151\x6e\x5f\x72\145\x6d\145\x6d\142\x65\162\x65\144\x5f\165\163\145\x72", "\x70\x6f\163\x74\137\154\157\147\151\x6e\x5f\162\x65\x6d\x65\155\142\145\x72\x65\x64\137\165\x73\145\x72\137\x73\165\143\143\x65\x73\163\146\165\x6c"]); goto waBwZ; zoK2i: if (!($query->num_rows() === 1)) { goto sMei0; } goto FL78n; A6krp: I04dM: goto sBpAq; lPbYl: delete_cookie($this->config->item("\x72\145\155\x65\155\142\x65\x72\137\x63\x6f\x6f\153\x69\145\x5f\156\141\x6d\145", "\151\x6f\156\137\141\x75\164\x68")); goto P0z0c; sBpAq: $this->trigger_events("\145\170\x74\162\141\x5f\x77\x68\145\162\x65"); goto ndNIr; U27Gr: $this->session->sess_regenerate(FALSE); goto Mkkmn; ndNIr: $query = $this->db->select($this->identity_column . "\x2c\x20\151\144\54\x20\x65\155\x61\151\x6c\x2c\40\162\x65\155\x65\x6d\142\x65\162\x5f\143\157\x64\145\54\x20\x6c\x61\x73\164\137\x6c\x6f\147\151\x6e")->where("\162\x65\x6d\x65\155\x62\x65\162\x5f\x73\x65\x6c\145\143\164\x6f\x72", $token->selector)->where("\x61\143\164\x69\166\x65", 1)->limit(1)->get($this->tables["\x75\x73\x65\x72\163"]); goto zoK2i; nNEV9: $remember_cookie = get_cookie($this->config->item("\162\x65\155\145\155\x62\145\162\137\x63\x6f\157\x6b\x69\145\137\156\141\x6d\145", "\x69\157\x6e\x5f\141\x75\164\x68")); goto Lt6uk; KqdR5: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto I3ZUG; } goto WA2Gx; jhASd: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto FrXak; zvyWt: $this->trigger_events("\145\x78\x74\x72\x61\137\x67\x72\x6f\x75\160\137\163\x65\x74"); goto jlIIg; BLWA6: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\160\163"], $additional_data), $data); goto LJ5T7; qWxaZ: return $group_id; goto th7N7; f3k7_: Km1Mj: goto SlFRK; r8wDP: MVanX: goto LME91; cTPjF: return FALSE; goto f3k7_; AThAn: $this->set_message("\x67\x72\157\165\160\x5f\143\162\x65\141\164\x69\x6f\156\137\x73\165\x63\143\145\x73\163\146\165\154"); goto qWxaZ; LJ5T7: HrVNN: goto zvyWt; MvH7o: if (!($existing_group !== 0)) { goto MVanX; } goto If8Vd; jlIIg: $this->db->insert($this->tables["\147\162\157\x75\160\163"], $data); goto TUGqK; G2M6A: $this->set_error("\147\x72\157\x75\160\137\x6e\x61\155\x65\137\162\145\x71\165\151\162\x65\x64"); goto cTPjF; LME91: $data = ["\x6e\141\x6d\x65" => $group_name, "\144\145\x73\143\162\x69\x70\164\151\157\156" => $group_description]; goto eowza; If8Vd: $this->set_error("\147\162\x6f\165\160\137\x61\x6c\x72\x65\141\x64\x79\x5f\x65\x78\151\x73\164\163"); goto Sa34o; eowza: if (empty($additional_data)) { goto HrVNN; } goto BLWA6; FrXak: if ($group_name) { goto Km1Mj; } goto G2M6A; TUGqK: $group_id = $this->db->insert_id($this->tables["\x67\162\x6f\x75\160\x73"] . "\x5f\151\x64\137\x73\x65\x71"); goto AThAn; SlFRK: $existing_group = $this->db->get_where($this->tables["\147\162\x6f\165\x70\163"], ["\x6e\141\x6d\x65" => $group_name])->num_rows(); goto MvH7o; Sa34o: return FALSE; goto r8wDP; th7N7: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto Ny9Op; qmos6: dQKzL: goto Cl3zR; DK1AC: $data["\156\x61\155\145"] = $group_name; goto qmos6; HSxbG: return TRUE; goto NCL9a; Cl3zR: $group = $this->db->get_where($this->tables["\x67\162\x6f\x75\x70\x73"], ["\x69\144" => $group_id])->row(); goto d9Sco; XQFoE: $data = array_merge($this->_filter_data($this->tables["\147\x72\157\165\160\163"], $additional_data), $data); goto gJZos; ZxpvY: $this->set_message("\147\162\157\165\x70\137\165\160\x64\141\x74\x65\137\163\165\x63\143\145\x73\x73\x66\x75\154"); goto HSxbG; dzwfU: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto Vvu74; } goto TTvVr; vrKSr: $data = []; goto QR54H; WsyOZ: if (empty($additional_data)) { goto MWQvr; } goto XQFoE; Ny9Op: if (!empty($group_id)) { goto muYPQ; } goto YNzTo; VOwoa: $this->set_error("\147\162\x6f\x75\160\137\156\141\x6d\145\x5f\141\x64\x6d\x69\x6e\137\156\157\x74\137\x61\x6c\x74\x65\162"); goto gVlUQ; QR54H: if (empty($group_name)) { goto dQKzL; } goto hk3w6; gVlUQ: return FALSE; goto X9saK; X9saK: Lygnl: goto WsyOZ; gJZos: MWQvr: goto wAnpQ; hk3w6: $existing_group = $this->db->get_where($this->tables["\147\162\x6f\165\160\x73"], ["\x6e\141\155\x65" => $group_name])->row(); goto dzwfU; YiUGS: muYPQ: goto vrKSr; wAnpQ: $this->db->update($this->tables["\147\162\x6f\x75\x70\163"], $data, ["\151\144" => $group_id]); goto ZxpvY; YNzTo: return FALSE; goto YiUGS; TTvVr: $this->set_error("\147\x72\157\x75\160\137\141\154\x72\x65\x61\x64\171\137\x65\x78\x69\163\164\x73"); goto tGRZh; oG9rs: Vvu74: goto DK1AC; d9Sco: if (!($this->config->item("\x61\x64\155\x69\156\x5f\147\162\157\x75\x70", "\x69\157\x6e\x5f\x61\x75\x74\150") === $group->name && $group_name !== $group->name)) { goto Lygnl; } goto VOwoa; tGRZh: return FALSE; goto oG9rs; NCL9a: } public function delete_group($group_id = FALSE) { goto m3Twj; TIopG: $this->trigger_events(["\x70\157\163\x74\137\144\x65\x6c\145\164\x65\137\x67\x72\x6f\x75\x70", "\160\157\163\164\137\144\145\x6c\145\164\145\x5f\x67\162\157\165\160\137\x73\165\x63\143\x65\x73\x73\x66\x75\154"]); goto ffrZq; UKJFX: return FALSE; goto SlYrT; eGkD0: $this->db->trans_rollback(); goto Z84aN; JSweQ: return TRUE; goto Lwk1G; xCheg: $this->trigger_events(["\x70\157\163\164\x5f\x64\x65\x6c\145\164\x65\x5f\x67\x72\x6f\x75\x70", "\x70\157\163\x74\x5f\144\145\x6c\x65\164\145\x5f\x67\162\x6f\x75\160\x5f\156\x6f\x74\x61\154\x6c\157\x77\145\144"]); goto yurt1; nrlQz: j4x85: goto HMLel; Ub3BB: $this->db->delete($this->tables["\147\x72\x6f\x75\160\x73"], ["\x69\x64" => $group_id]); goto nKrP4; yurt1: $this->set_error("\147\x72\x6f\165\x70\137\144\145\154\145\164\x65\137\156\x6f\164\x61\x6c\154\x6f\167\145\x64"); goto UKJFX; Z84aN: $this->trigger_events(["\160\x6f\x73\164\x5f\x64\145\x6c\145\x74\145\137\x67\162\157\165\160", "\x70\157\163\164\137\144\145\154\x65\164\145\137\147\162\x6f\x75\160\x5f\165\156\x73\165\143\143\x65\163\x73\x66\x75\154"]); goto oovyp; L3wxO: $this->db->trans_begin(); goto WlxAF; KAF4h: $this->trigger_events("\160\x72\x65\x5f\144\145\154\x65\164\145\137\147\162\x6f\165\160"); goto L3wxO; yqH20: FYLyA: goto Nu83W; m3Twj: if (!(!$group_id || empty($group_id))) { goto j4x85; } goto K9g7x; ffrZq: $this->set_message("\x67\162\157\x75\x70\137\x64\145\154\145\164\x65\137\x73\165\143\x63\x65\163\163\x66\x75\154"); goto JSweQ; WlxAF: $this->db->delete($this->tables["\x75\163\x65\162\163\x5f\x67\x72\x6f\165\160\163"], [$this->join["\x67\x72\x6f\x75\x70\163"] => $group_id]); goto Ub3BB; rura7: if (!($group->name == $this->config->item("\141\x64\x6d\151\156\x5f\x67\x72\157\165\160", "\x69\157\x6e\137\141\x75\x74\150"))) { goto m_62n; } goto xCheg; nKrP4: if (!($this->db->trans_status() === FALSE)) { goto FYLyA; } goto eGkD0; SlYrT: m_62n: goto KAF4h; HMLel: $group = $this->group($group_id)->row(); goto rura7; Nu83W: $this->db->trans_commit(); goto TIopG; K9g7x: return FALSE; goto nrlQz; Z8bMf: return FALSE; goto yqH20; oovyp: $this->set_error("\x67\162\157\x75\160\137\x64\145\x6c\145\x74\145\137\x75\x6e\x73\165\x63\x63\x65\163\163\x66\x75\154"); goto Z8bMf; Lwk1G: } public function set_hook($event, $name, $class, $method, $arguments) { goto ay3wy; UMRXG: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto hYTF9; p6K3L: $this->_ion_hooks->{$event}[$name]->method = $method; goto UMRXG; ay3wy: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto bcPHP; bcPHP: $this->_ion_hooks->{$event}[$name]->class = $class; goto p6K3L; hYTF9: } public function remove_hook($event, $name) { goto utODu; yPLj6: dw0kW: goto IRz2u; JMALs: unset($this->_ion_hooks->{$event}[$name]); goto yPLj6; utODu: if (!isset($this->_ion_hooks->{$event}[$name])) { goto dw0kW; } goto JMALs; IRz2u: } public function remove_hooks($event) { goto yT8ri; wM6EE: unset($this->_ion_hooks->{$event}); goto TZMDM; yT8ri: if (!isset($this->_ion_hooks->{$event})) { goto Zq5R7; } goto wM6EE; TZMDM: Zq5R7: goto EmnaA; EmnaA: } protected function _call_hook($event, $name) { goto lhOGr; Z3oXN: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto ysoxQ; asgOQ: return FALSE; goto Guvu8; ysoxQ: o8JD9: goto asgOQ; lhOGr: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto o8JD9; } goto nOzN7; nOzN7: $hook = $this->_ion_hooks->{$event}[$name]; goto Z3oXN; Guvu8: } public function trigger_events($events) { goto qVd5u; cDcWa: Xaw4h: goto b3C0J; QsyhJ: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto wjqrV; } goto KBIM9; KBIM9: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); TdPHT: } goto oO2cX; b3C0J: foreach ($events as $event) { $this->trigger_events($event); wqu4R: } goto YovV_; qVd5u: if (is_array($events) && !empty($events)) { goto Xaw4h; } goto QsyhJ; YovV_: Wgzcz: goto CaglZ; yNmzk: wjqrV: goto VvifZ; CaglZ: f7DwG: goto rkKtd; oO2cX: z7Osf: goto yNmzk; VvifZ: goto f7DwG; goto cDcWa; rkKtd: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto JmKIq; mXE1V: return TRUE; goto DCbe0; JmKIq: $this->message_start_delimiter = $start_delimiter; goto ve5zK; ve5zK: $this->message_end_delimiter = $end_delimiter; goto mXE1V; DCbe0: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto ZmowE; S_G49: $this->error_end_delimiter = $end_delimiter; goto n720T; ZmowE: $this->error_start_delimiter = $start_delimiter; goto S_G49; n720T: return TRUE; goto XdQoy; XdQoy: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto J0qCC; GAJyW: foreach ($this->messages as $message) { goto EopRB; yLyjv: L21Ju: goto tmkie; PwcW8: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto yLyjv; EopRB: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto PwcW8; tmkie: } goto wus6M; wus6M: X2fCB: goto FUYGQ; J0qCC: $_output = ''; goto GAJyW; FUYGQ: return $_output; goto ypzcJ; ypzcJ: } public function messages_array($langify = TRUE) { goto bVH11; ONOOm: return $_output; goto lHL6d; ucuQO: be_L9: goto FdDb5; XHvKv: foreach ($this->messages as $message) { goto GwRWB; VTyCM: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto KIKnw; KIKnw: kWq8y: goto gflXx; GwRWB: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto VTyCM; gflXx: } goto YCi0C; lKqZu: goto Q85DO; goto ucuQO; bVH11: if ($langify) { goto be_L9; } goto duUAR; FdDb5: $_output = []; goto XHvKv; YCi0C: eFZgb: goto ONOOm; lHL6d: Q85DO: goto AG9Rn; duUAR: return $this->messages; goto lKqZu; AG9Rn: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto Rn2D3; yMyuN: foreach ($this->errors as $error) { goto NwmMN; HUyrM: JmJFv: goto uGm48; NwmMN: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto J_vaa; J_vaa: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto HUyrM; uGm48: } goto yozfq; iBMk7: return $_output; goto GReFP; yozfq: Bq7Ws: goto iBMk7; Rn2D3: $_output = ''; goto yMyuN; GReFP: } public function errors_array($langify = TRUE) { goto REPw9; XpfUA: LD0vH: goto FvXWX; DgBMk: fbIdl: goto PvzYK; C9xtt: ZYd10: goto mIi9q; uSwFG: return $this->errors; goto XdlKi; PvzYK: return $_output; goto C9xtt; REPw9: if ($langify) { goto LD0vH; } goto uSwFG; FvXWX: $_output = []; goto g4sWG; g4sWG: foreach ($this->errors as $error) { goto HhOUb; WPc9A: qG8MV: goto C3TTt; HhOUb: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto fwAiT; fwAiT: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto WPc9A; C3TTt: } goto DgBMk; XdlKi: goto ZYd10; goto XpfUA; mIi9q: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto GFkyI; f08fY: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto GXIA0; GFkyI: $hash = $this->hash_password($password, $identity); goto say0n; TVPHN: $this->trigger_events("\145\170\x74\162\x61\x5f\167\150\x65\162\145"); goto f08fY; GXIA0: return $this->db->affected_rows() == 1; goto a5qup; LcOhD: eMtFq: goto uQuuu; CaK_p: return FALSE; goto LcOhD; say0n: if (!($hash === FALSE)) { goto eMtFq; } goto CaK_p; uQuuu: $data = ["\x70\x61\x73\163\167\157\x72\144" => $hash, "\x72\x65\x6d\x65\x6d\x62\145\x72\x5f\x63\x6f\144\145" => NULL, "\x66\157\162\147\157\x74\x74\145\x6e\137\x70\141\x73\x73\x77\x6f\x72\x64\137\143\x6f\144\x65" => NULL, "\x66\x6f\x72\x67\157\x74\x74\145\156\137\160\141\163\x73\x77\157\x72\144\137\x74\151\155\145" => NULL]; goto TVPHN; a5qup: } protected function _filter_data($table, $data) { goto OkinY; HNfCE: $columns = $this->db->list_fields($table); goto lv0J0; pwk2B: foreach ($columns as $column) { goto dlIK7; dlIK7: if (!array_key_exists($column, $data)) { goto nXWrl; } goto SAfPZ; SAfPZ: $filtered_data[$column] = $data[$column]; goto q2EEf; v3Ecm: sVRRv: goto uagZt; q2EEf: nXWrl: goto v3Ecm; uagZt: } goto g4fjv; g4fjv: gulJA: goto qhCkt; qhCkt: hNkQY: goto GRXOY; OkinY: $filtered_data = []; goto HNfCE; GRXOY: return $filtered_data; goto VDKT7; lv0J0: if (!is_array($data)) { goto hNkQY; } goto pwk2B; VDKT7: } protected function _random_token($result_length = 32) { goto P9pJF; KYROl: Vfjgn: goto SWKvo; nS4Ph: jwi3N: goto Vo3vR; wfI75: return bin2hex(random_bytes($result_length / 2)); goto KYROl; fNj6H: $result_length = 32; goto jJU9Q; WEfdz: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto nS4Ph; SWKvo: if (!function_exists("\x6d\x63\x72\171\x70\x74\137\x63\x72\145\141\164\145\137\x69\166")) { goto jwi3N; } goto WEfdz; DtYnF: if (!function_exists("\162\141\x6e\144\x6f\155\x5f\142\171\x74\x65\163")) { goto Vfjgn; } goto wfI75; j3M3A: EheTd: goto eH9ge; jJU9Q: NhfwN: goto DtYnF; P9pJF: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto NhfwN; } goto fNj6H; qQ2aO: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto j3M3A; Vo3vR: if (!function_exists("\x6f\160\x65\x6e\163\163\x6c\x5f\162\141\156\144\x6f\x6d\x5f\x70\x73\x65\x75\144\x6f\137\x62\171\164\145\163")) { goto EheTd; } goto qQ2aO; eH9ge: return FALSE; goto tUanP; tUanP: } protected function _get_hash_parameters($identity = NULL) { goto wCfWV; hE94W: KBI1K: goto WJ6Jh; hfXOI: if (!($user_id && $this->in_group($this->config->item("\x61\x64\155\x69\x6e\x5f\x67\162\x6f\165\x70", "\x69\x6f\156\137\x61\165\x74\150"), $user_id))) { goto TQDD9; } goto g1lov; rvH9X: $params = FALSE; goto feH7j; DfBMP: $user_id = $this->get_user_id_from_identity($identity); goto hfXOI; feH7j: switch ($this->hash_method) { case "\142\x63\x72\171\x70\164": $params = ["\143\x6f\x73\x74" => $is_admin ? $this->config->item("\x62\143\162\171\160\164\x5f\141\144\155\151\156\x5f\x63\157\x73\x74", "\151\x6f\156\x5f\x61\165\164\x68") : $this->config->item("\x62\x63\162\171\x70\164\x5f\144\145\x66\141\x75\154\x74\x5f\143\157\163\164", "\x69\x6f\156\x5f\x61\x75\x74\x68")]; goto yR3Db; case "\x61\162\147\157\x6e\62": $params = $is_admin ? $this->config->item("\x61\x72\147\157\156\62\137\x61\x64\x6d\x69\156\x5f\x70\141\x72\141\x6d\163", "\x69\157\156\x5f\x61\x75\164\x68") : $this->config->item("\141\x72\x67\x6f\156\62\x5f\x64\x65\146\141\x75\x6c\x74\x5f\x70\x61\x72\x61\x6d\x73", "\151\x6f\156\x5f\x61\165\164\150"); goto yR3Db; default: } goto hE94W; PeYdW: return $params; goto BNvZP; g1lov: $is_admin = TRUE; goto QuuRm; nGZgC: LMUYZ: goto rvH9X; WJ6Jh: yR3Db: goto PeYdW; wCfWV: $is_admin = FALSE; goto rykf3; rykf3: if (!$identity) { goto LMUYZ; } goto DfBMP; QuuRm: TQDD9: goto nGZgC; BNvZP: } protected function _get_hash_algo() { goto tHA5n; Huvkw: return $algo; goto dM9Nl; wddVB: cBH3z: goto QYz7S; uexKU: switch ($this->hash_method) { case "\x62\x63\162\171\x70\x74": $algo = PASSWORD_BCRYPT; goto lBUs3; case "\x61\x72\147\157\156\x32": $algo = PASSWORD_ARGON2I; goto lBUs3; default: } goto wddVB; tHA5n: $algo = FALSE; goto uexKU; QYz7S: lBUs3: goto Huvkw; dM9Nl: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto uKjJC; nVKLj: $validator = $this->_random_token($validator_size); goto vvzJC; Vj6yj: return (object) ["\163\145\154\145\143\x74\157\162" => $selector, "\x76\x61\154\x69\144\141\164\x6f\162\137\x68\x61\163\150\x65\x64" => $validator_hashed, "\165\x73\x65\x72\x5f\143\x6f\144\x65" => $user_code]; goto WglBF; uKjJC: $selector = $this->_random_token($selector_size); goto nVKLj; vvzJC: $validator_hashed = $this->hash_password($validator); goto fIYqH; fIYqH: $user_code = "{$selector}\56{$validator}"; goto Vj6yj; WglBF: } protected function _retrieve_selector_validator_couple($user_code) { goto jaoi1; NGhxm: VGdvW: goto FY153; wa_93: return FALSE; goto Sf2zi; VN7Uk: if (!(count($tokens) === 2)) { goto VGdvW; } goto zXnOW; FY153: B4pby: goto wa_93; dPNgL: $tokens = explode("\x2e", $user_code); goto VN7Uk; jaoi1: if (!$user_code) { goto B4pby; } goto dPNgL; zXnOW: return (object) ["\163\145\x6c\x65\143\x74\157\x72" => $tokens[0], "\x76\x61\x6c\x69\x64\141\x74\x6f\x72" => $tokens[1]]; goto NGhxm; Sf2zi: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto sv33L; wPCsT: if ($hashed_password === $hashed_password_db) { goto n1Z46; } goto x0iwJ; L5pqc: goto ZdunV; goto ZOtCW; fCuca: enlrh: goto zrFYh; OksLI: RBClp: goto AxtA6; x0iwJ: $this->trigger_events(["\160\x6f\x73\164\x5f\163\150\141\x31\137\160\141\x73\x73\167\157\x72\144\137\x6d\151\147\x72\x61\x74\x69\157\x6e", "\x70\x6f\163\164\x5f\x73\150\x61\61\137\x70\x61\163\x73\x77\x6f\162\144\137\x6d\151\x67\x72\141\x74\x69\x6f\x6e\137\x75\x6e\x73\x75\x63\x63\145\x73\163\x66\165\x6c"]); goto K4U7Y; uQZM1: if ($this->config->item("\163\x74\157\x72\145\137\x73\x61\x6c\x74", "\151\157\156\x5f\141\x75\164\x68")) { goto mgH92; } goto fkyIR; zXCry: n1Z46: goto bDtev; Rak0o: return FALSE; goto x35M4; dMFum: if ($salt_length) { goto TMcw4; } goto TZPMt; bDtev: $result = $this->_set_password_db($identity, $password); goto y8YRS; ZOtCW: mgH92: goto gTjYh; djwrp: TMcw4: goto pQXkD; AxtA6: return $result; goto fCuca; x35M4: PkHVu: goto QZbR3; sIKCx: if (!($query->num_rows() !== 1)) { goto PkHVu; } goto kYMit; SesDH: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto L5pqc; fkyIR: $salt_length = $this->config->item("\163\141\154\x74\x5f\x6c\145\156\147\x74\x68", "\x69\x6f\x6e\137\141\x75\x74\150"); goto dMFum; nVM3L: $salt_db = $query->row(); goto sIKCx; TZPMt: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x73\150\141\61\x5f\x70\141\x73\163\167\x6f\x72\144\x5f\x6d\x69\147\x72\141\x74\x69\157\x6e", "\160\x6f\x73\x74\x5f\x73\x68\x61\x31\x5f\160\141\x73\x73\x77\157\162\x64\x5f\x6d\151\x67\x72\141\x74\151\x6f\156\x5f\165\156\x73\165\143\143\x65\x73\163\146\165\154"]); goto KPpuJ; adw3O: goto RBClp; goto Dyw2p; QWVnO: goto enlrh; goto zXCry; Dyw2p: rxUqz: goto V4KBS; QZbR3: $hashed_password = sha1($password . $salt_db->salt); goto GoYcC; K4U7Y: return FALSE; goto QWVnO; gTjYh: $query = $this->db->select("\x73\x61\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\145\162\163"]); goto nVM3L; y8YRS: if ($result) { goto rxUqz; } goto prgg9; KPpuJ: return FALSE; goto djwrp; prgg9: $this->trigger_events(["\x70\x6f\163\x74\137\x73\x68\x61\x31\x5f\160\141\x73\x73\x77\157\162\144\137\155\151\x67\x72\x61\x74\151\157\x6e", "\x70\157\163\164\137\163\x68\141\x31\x5f\x70\x61\163\163\x77\157\162\x64\137\155\151\147\162\x61\164\x69\157\x6e\x5f\x75\x6e\163\x75\x63\x63\x65\x73\163\x66\165\154"]); goto adw3O; pQXkD: $salt = substr($hashed_password_db, 0, $salt_length); goto SesDH; kYMit: $this->trigger_events(["\x70\x6f\163\164\x5f\x73\150\x61\61\137\160\x61\x73\x73\x77\x6f\x72\144\137\x6d\151\147\162\x61\x74\x69\x6f\156", "\160\x6f\163\x74\137\x73\x68\141\61\137\x70\141\163\x73\167\x6f\162\144\137\155\151\x67\162\x61\x74\x69\x6f\156\x5f\165\156\x73\165\x63\x63\x65\x73\163\146\x75\x6c"]); goto Rak0o; V4KBS: $this->trigger_events(["\160\x6f\x73\x74\137\163\150\141\61\x5f\x70\x61\x73\x73\167\157\x72\144\137\155\x69\147\x72\141\164\x69\157\156", "\160\x6f\x73\164\x5f\x73\150\x61\x31\137\x70\141\163\x73\167\157\x72\144\x5f\x6d\151\147\x72\141\164\151\157\156\137\163\165\143\x63\145\163\163\x66\165\154"]); goto OksLI; GoYcC: ZdunV: goto wPCsT; sv33L: $this->trigger_events("\160\162\145\137\x73\150\141\61\137\x70\x61\x73\x73\167\157\x72\144\137\155\x69\147\x72\141\164\151\x6f\156"); goto uQZM1; zrFYh: } }
