<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\x45\x50\x41\x54\110") or exit("\116\157\x20\x64\x69\162\x65\143\x74\40\x73\143\x72\x69\160\164\40\141\x63\x63\145\x73\x73\40\x61\x6c\154\157\x77\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto rTLSX; nQ_z5: $this->error_end_delimiter = $this->config->item("\145\162\x72\x6f\162\x5f\145\x6e\144\137\x64\x65\x6c\x69\x6d\151\164\145\162", "\x69\x6f\x6e\137\141\x75\x74\150"); goto cmRZa; M1RCv: $CI =& get_instance(); goto UDpol; rTLSX: $this->config->load("\151\x6f\156\x5f\141\x75\x74\150", TRUE); goto MFMAP; fqof2: mJ835: goto UuTXb; COssV: $this->messages = []; goto SWv96; Y6cQT: $form_validation_class = new ReflectionClass("\x43\x49\137\106\x6f\162\x6d\137\166\x61\x6c\151\x64\141\x74\151\x6f\x6e"); goto Dye2t; LjTfv: if ($delimiters_source === "\x66\x6f\x72\x6d\x5f\x76\141\154\151\x64\141\164\151\157\156") { goto mJ835; } goto qjXPe; fzKuu: $this->db = $this->load->database($group_name, TRUE, TRUE); goto c3j6I; yPQAL: $error_suffix->setAccessible(TRUE); goto rS07L; OXAL5: $error_suffix = $form_validation_class->getProperty("\137\145\162\162\x6f\x72\x5f\x73\x75\146\146\x69\x78"); goto yPQAL; jbezN: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto WhE2E; N3SJY: bOJy0: goto M1RCv; c3j6I: goto sfv7U; goto N3SJY; UDpol: $this->db = $CI->db; goto Li85v; rS07L: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto aJQl9; Q0c8P: $this->tables = $this->config->item("\x74\x61\x62\x6c\145\x73", "\x69\157\x6e\137\x61\x75\x74\150"); goto QbGgd; XS263: $this->join = $this->config->item("\152\x6f\151\156", "\151\x6f\156\137\141\x75\x74\150"); goto C3dmS; Qsk9P: $this->message_end_delimiter = $this->config->item("\155\x65\163\163\141\147\x65\137\145\156\x64\x5f\x64\x65\154\151\x6d\x69\164\x65\162", "\151\157\x6e\137\141\x75\164\x68"); goto t2MBh; qjXPe: $this->message_start_delimiter = $this->config->item("\155\145\x73\x73\x61\x67\x65\x5f\163\164\x61\x72\164\x5f\x64\x65\x6c\x69\155\x69\x74\145\x72", "\151\x6f\x6e\137\x61\x75\x74\150"); goto Qsk9P; cmRZa: goto A_cl6; goto fqof2; oMudH: $this->trigger_events("\x6d\157\x64\x65\154\x5f\143\x6f\156\163\x74\162\x75\143\164\157\162"); goto L4tTp; Bb9Y3: $error_prefix->setAccessible(TRUE); goto jbezN; VZiMy: $this->load->helper("\x64\141\x74\145"); goto DGpGt; C3dmS: $this->hash_method = $this->config->item("\x68\x61\x73\x68\x5f\155\x65\164\150\x6f\x64", "\x69\157\x6e\x5f\141\x75\164\150"); goto COssV; WhE2E: $this->message_start_delimiter = $this->error_start_delimiter; goto OXAL5; MFMAP: $this->load->helper("\x63\x6f\157\x6b\151\x65"); goto VZiMy; SWv96: $this->errors = []; goto NCmwy; Dye2t: $error_prefix = $form_validation_class->getProperty("\x5f\145\162\x72\x6f\162\137\x70\x72\x65\x66\151\170"); goto Bb9Y3; QbGgd: $this->identity_column = $this->config->item("\151\144\x65\x6e\x74\151\164\171", "\151\x6f\156\x5f\141\x75\164\x68"); goto XS263; C3gio: $group_name = $this->config->item("\144\x61\164\x61\142\141\163\145\137\147\x72\x6f\165\x70\x5f\156\x61\x6d\145", "\x69\157\x6e\x5f\141\x75\x74\150"); goto msuMP; DGpGt: $this->lang->load("\x69\157\x6e\137\141\165\x74\150"); goto C3gio; sq213: A_cl6: goto Q55Hl; Q55Hl: $this->_ion_hooks = new stdClass(); goto oMudH; UuTXb: $this->load->library("\x66\157\x72\x6d\x5f\x76\141\x6c\151\144\x61\x74\x69\157\x6e"); goto Y6cQT; Li85v: sfv7U: goto Q0c8P; t2MBh: $this->error_start_delimiter = $this->config->item("\145\x72\162\x6f\x72\x5f\x73\164\x61\162\x74\x5f\x64\145\x6c\x69\x6d\151\x74\145\162", "\x69\x6f\156\x5f\141\165\164\150"); goto nQ_z5; NCmwy: $delimiters_source = $this->config->item("\x64\145\x6c\151\155\x69\164\x65\162\163\137\x73\157\165\162\x63\145", "\151\157\156\x5f\141\165\x74\x68"); goto LjTfv; aJQl9: $this->message_end_delimiter = $this->error_end_delimiter; goto sq213; msuMP: if (empty($group_name)) { goto bOJy0; } goto fzKuu; L4tTp: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto D2nSG; beOhK: $algo = $this->_get_hash_algo(); goto acvnX; zKP7P: hoYbi: goto beOhK; BzCZg: return password_hash($password, $algo, $params); goto iFSyM; D2nSG: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto hoYbi; } goto Wbvrt; KXVKd: if (!($algo !== FALSE && $params !== FALSE)) { goto L8e7p; } goto BzCZg; acvnX: $params = $this->_get_hash_parameters($identity); goto KXVKd; Wbvrt: return FALSE; goto zKP7P; iFSyM: L8e7p: goto qotZn; qotZn: return FALSE; goto chtRP; chtRP: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto SKQef; HtZIl: RRCB_: goto ENhzd; kwRr_: NwmP0: goto hoMU2; hoMU2: return password_verify($password, $hash_password_db); goto HtZIl; SKQef: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto pfz9X; } goto uyZVs; aYY5E: goto RRCB_; goto kwRr_; L43Mp: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto aYY5E; uyZVs: return FALSE; goto FxQYO; GZDgZ: if (strpos($hash_password_db, "\44") === 0) { goto NwmP0; } goto L43Mp; FxQYO: pfz9X: goto GZDgZ; ENhzd: } public function rehash_password_if_needed($hash, $identity, $password) { goto rPdQP; ctnZH: fI8qr: goto SAzaM; a1AOv: goto fI8qr; goto HaLOO; HaLOO: Pelmo: goto JW_62; JUQVd: if (!password_needs_rehash($hash, $algo, $params)) { goto O14k1; } goto AzMeI; rPdQP: $algo = $this->_get_hash_algo(); goto DsrHF; JW_62: $this->trigger_events(["\x72\145\x68\141\163\x68\x5f\x70\141\x73\163\x77\157\162\x64", "\162\145\150\141\x73\x68\137\160\x61\163\x73\x77\x6f\162\144\x5f\163\x75\x63\143\x65\x73\x73\x66\165\154"]); goto ctnZH; ITDr1: $this->trigger_events(["\x72\x65\x68\141\163\150\137\x70\141\x73\x73\167\x6f\162\144", "\x72\145\150\141\x73\150\137\x70\141\163\x73\167\157\x72\144\x5f\x75\x6e\163\165\x63\143\145\163\163\x66\x75\x6c"]); goto a1AOv; AzMeI: if ($this->_set_password_db($identity, $password)) { goto Pelmo; } goto ITDr1; DsrHF: $params = $this->_get_hash_parameters($identity); goto o1ruB; SAzaM: O14k1: goto fgyLK; o1ruB: if (!($algo !== FALSE && $params !== FALSE)) { goto OoD0M; } goto JUQVd; fgyLK: OoD0M: goto fBeTy; fBeTy: } public function get_user_by_activation_code($user_code) { goto G1IWZ; XqMrY: return FALSE; goto uohot; fUXKV: if (!$user) { goto K37tr; } goto jh2iJ; ok2gi: $user = $this->where("\141\x63\164\x69\166\x61\x74\151\x6f\156\x5f\163\x65\x6c\145\x63\x74\x6f\x72", $token->selector)->users()->row(); goto fUXKV; QuIXF: return $user; goto Kktf4; jh2iJ: if (!$this->verify_password($token->validator, $user->activation_code)) { goto I3DLB; } goto QuIXF; Kktf4: I3DLB: goto cgkZd; cgkZd: K37tr: goto XqMrY; G1IWZ: $token = $this->_retrieve_selector_validator_couple($user_code); goto ok2gi; uohot: } public function activate($id, $code = FALSE) { goto aDzMX; WlEoL: $this->set_error("\141\143\164\151\166\141\164\x65\137\x75\156\163\165\143\143\x65\x73\x73\x66\165\x6c"); goto Pvdlp; Pvdlp: return FALSE; goto IlZ3i; Ix2sq: $this->trigger_events(["\160\157\163\x74\x5f\141\x63\x74\x69\166\141\164\x65", "\160\x6f\x73\x74\137\x61\143\x74\x69\166\x61\164\145\x5f\x75\x6e\x73\x75\x63\143\145\x73\x73\x66\165\x6c"]); goto WlEoL; ltNw1: dwgA5: goto v5esR; PYAoP: $user = $this->get_user_by_activation_code($code); goto YjJlo; v5esR: mnJez: goto Ix2sq; iiKRm: $this->db->update($this->tables["\x75\163\145\x72\163"], $data, ["\x69\x64" => $id]); goto daQuC; aDzMX: $this->trigger_events("\x70\162\x65\137\x61\143\x74\x69\166\x61\x74\145"); goto cjaSP; uTPZG: $this->trigger_events("\x65\170\164\162\x61\x5f\x77\x68\x65\162\145"); goto iiKRm; YjJlo: XoKN9: goto rgZwP; cjaSP: if (!($code !== FALSE)) { goto XoKN9; } goto PYAoP; rgZwP: if (!($code === FALSE || $user && $user->id === $id)) { goto mnJez; } goto Wo0eF; KihU2: $this->set_message("\x61\143\x74\x69\166\141\164\x65\137\163\165\x63\143\145\163\163\x66\165\154"); goto DZGbv; Wo0eF: $data = ["\x61\143\164\x69\x76\141\164\151\157\156\137\x73\145\154\x65\143\x74\x6f\x72" => NULL, "\x61\143\x74\151\166\x61\164\151\x6f\x6e\x5f\x63\157\144\145" => NULL, "\141\x63\x74\x69\x76\145" => 1]; goto uTPZG; daQuC: if (!($this->db->affected_rows() === 1)) { goto dwgA5; } goto a1jjg; DZGbv: return TRUE; goto ltNw1; a1jjg: $this->trigger_events(["\x70\157\163\x74\137\141\x63\164\151\x76\x61\x74\x65", "\x70\x6f\163\x74\x5f\x61\143\x74\151\166\141\x74\x65\x5f\x73\165\x63\x63\x65\x73\163\146\x75\154"]); goto KihU2; IlZ3i: } public function deactivate($id = NULL) { goto Kqv3A; BHAXR: CBnux: goto rpubj; oQ9FV: $this->db->update($this->tables["\165\163\145\162\x73"], $data, ["\x69\x64" => $id]); goto kn4ko; DZg40: $token = $this->_generate_selector_validator_couple(20, 40); goto WFQ2H; kn4ko: $return = $this->db->affected_rows() == 1; goto dNgCS; sc4lV: QkfeH: goto TQ1M6; WFQ2H: $this->activation_code = $token->user_code; goto O9nbN; TQ1M6: $this->set_error("\x64\145\141\x63\x74\x69\x76\x61\164\145\137\165\x6e\x73\x75\143\143\145\163\x73\x66\x75\x6c"); goto lVpea; axK3G: uGgfA: goto sU1qZ; tbnhy: $this->trigger_events("\x65\170\x74\162\141\137\167\150\x65\x72\x65"); goto oQ9FV; dNgCS: if ($return) { goto CBnux; } goto NI6KW; Lx7rB: goto uGgfA; goto BHAXR; DSePc: return FALSE; goto aZAQd; lVpea: return FALSE; goto USEz_; tJ7e5: goto o2SI7; goto sc4lV; O9nbN: $data = ["\x61\143\164\151\166\x61\x74\151\x6f\156\137\x73\x65\x6c\x65\143\164\x6f\x72" => $token->selector, "\141\x63\x74\151\x76\x61\x74\x69\157\156\x5f\x63\x6f\x64\x65" => $token->validator_hashed, "\141\143\x74\x69\166\145" => 0]; goto tbnhy; rpubj: $this->set_message("\144\145\x61\143\x74\151\x76\141\164\x65\x5f\163\x75\143\x63\145\x73\163\x66\165\154"); goto axK3G; Kqv3A: $this->trigger_events("\144\145\141\x63\x74\151\x76\141\x74\x65"); goto RBsag; vehC_: $this->set_error("\144\x65\x61\x63\164\151\166\x61\x74\x65\x5f\143\x75\162\x72\145\156\164\137\165\163\145\x72\x5f\165\x6e\x73\165\x63\143\x65\x73\163\146\165\154"); goto DSePc; RBsag: if (!isset($id)) { goto QkfeH; } goto i2RC1; aZAQd: JQJop: goto tJ7e5; i2RC1: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto JQJop; } goto vehC_; sU1qZ: return $return; goto LnDK5; NI6KW: $this->set_error("\x64\x65\141\x63\164\151\166\141\x74\145\x5f\165\x6e\x73\x75\143\143\145\163\x73\x66\165\154"); goto Lx7rB; USEz_: o2SI7: goto DZg40; LnDK5: } public function clear_forgotten_password_code($identity) { goto V21Ra; V21Ra: if (!empty($identity)) { goto J2Enu; } goto DclqW; pumZH: $data = ["\x66\157\x72\147\x6f\x74\164\x65\156\x5f\x70\x61\x73\163\x77\157\x72\144\137\163\x65\x6c\145\x63\164\157\x72" => NULL, "\146\157\x72\147\157\x74\164\x65\x6e\x5f\x70\141\x73\163\x77\x6f\162\x64\137\143\x6f\x64\145" => NULL, "\146\157\x72\147\157\x74\x74\x65\x6e\137\x70\141\163\163\167\x6f\162\144\x5f\x74\x69\155\145" => NULL]; goto bZvkr; cbyau: return TRUE; goto dV3uC; DclqW: return FALSE; goto NFTuP; bZvkr: $this->db->update($this->tables["\x75\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto cbyau; NFTuP: J2Enu: goto pumZH; dV3uC: } public function clear_remember_code($identity) { goto oAK0x; oAK0x: if (!empty($identity)) { goto Yj7gY; } goto nNJtT; ol3dF: $data = ["\x72\x65\155\x65\155\142\145\x72\137\163\x65\x6c\145\x63\164\157\x72" => NULL, "\x72\x65\155\x65\155\142\x65\162\x5f\x63\157\144\x65" => NULL]; goto RcvDs; RcvDs: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto FLmwd; nNJtT: return FALSE; goto PimNF; FLmwd: return TRUE; goto MU6p6; PimNF: Yj7gY: goto ol3dF; MU6p6: } public function reset_password($identity, $new) { goto kt72a; bqlPW: if ($this->identity_check($identity)) { goto zFe4l; } goto RQJIP; DjRKD: if ($return) { goto ut27K; } goto np0zS; ZfUDB: goto yB2tq; goto WPRYw; kt72a: $this->trigger_events("\160\x72\145\x5f\143\150\141\x6e\x67\145\137\x70\x61\163\163\167\x6f\162\x64"); goto bqlPW; F41FW: return $return; goto GhmNj; dAWZv: yB2tq: goto F41FW; mHFiJ: $this->set_error("\160\141\163\x73\167\157\x72\144\x5f\143\150\x61\156\x67\x65\137\x75\x6e\163\165\x63\x63\x65\163\x73\x66\165\154"); goto ZfUDB; cxzmm: return FALSE; goto dzNTO; S3lBx: $return = $this->_set_password_db($identity, $new); goto DjRKD; RQJIP: $this->trigger_events(["\160\157\163\164\137\x63\x68\141\x6e\147\145\137\x70\x61\163\x73\x77\x6f\x72\x64", "\160\157\x73\164\x5f\x63\x68\141\x6e\147\x65\x5f\160\x61\x73\x73\167\x6f\162\144\x5f\x75\156\163\x75\143\x63\x65\x73\163\146\165\154"]); goto cxzmm; dzNTO: zFe4l: goto S3lBx; pj2qJ: $this->trigger_events(["\160\157\x73\x74\x5f\x63\150\141\x6e\x67\145\137\160\x61\x73\x73\x77\x6f\162\144", "\160\157\163\164\137\143\150\x61\x6e\147\x65\x5f\x70\x61\x73\163\167\157\162\144\x5f\x73\x75\x63\x63\x65\163\163\146\165\154"]); goto EQTsa; EQTsa: $this->set_message("\160\141\x73\163\x77\157\x72\x64\137\x63\x68\141\156\x67\x65\137\x73\x75\x63\x63\145\163\163\x66\x75\154"); goto dAWZv; WPRYw: ut27K: goto pj2qJ; np0zS: $this->trigger_events(["\x70\157\x73\164\x5f\x63\x68\x61\x6e\147\x65\137\160\x61\x73\163\167\157\162\x64", "\x70\157\163\x74\137\x63\150\x61\x6e\x67\x65\137\x70\141\163\163\167\157\x72\144\x5f\165\x6e\x73\x75\143\143\145\x73\163\x66\165\x6c"]); goto mHFiJ; GhmNj: } public function change_password($identity, $old, $new) { goto kuUjm; fvxCy: $this->trigger_events("\x65\x78\164\162\141\x5f\167\x68\x65\162\145"); goto Jz2pK; tS3kp: $this->trigger_events(["\x70\157\x73\x74\x5f\x63\x68\x61\x6e\x67\x65\137\160\x61\163\x73\x77\157\x72\144", "\160\x6f\x73\x74\137\143\x68\141\x6e\147\x65\137\160\141\x73\163\x77\157\x72\x64\x5f\163\165\x63\x63\145\x73\x73\146\x75\154"]); goto StP6G; AhvCV: return $result; goto KO2wC; KO2wC: aIjVE: goto mr4Au; ASXJF: QgHcL: goto tS3kp; zQfWT: return FALSE; goto UVQpE; u_gIv: $this->set_error("\x70\141\163\163\x77\x6f\x72\x64\x5f\x63\x68\141\156\147\145\x5f\165\x6e\163\165\143\143\x65\x73\163\146\x75\x6c"); goto YQnCQ; s56RR: $this->trigger_events(["\x70\157\163\x74\x5f\x63\150\141\156\147\145\x5f\160\141\x73\x73\x77\157\x72\x64", "\x70\x6f\x73\164\137\x63\x68\x61\156\147\x65\x5f\160\141\x73\163\x77\x6f\x72\144\x5f\x75\156\163\x75\143\x63\x65\163\163\146\165\154"]); goto aLBAL; SaKXP: if ($result) { goto QgHcL; } goto s56RR; f7I4P: if (!$this->verify_password($old, $user->password, $identity)) { goto aIjVE; } goto qa3nd; qa3nd: $result = $this->_set_password_db($identity, $new); goto SaKXP; B4AK3: $this->trigger_events(["\160\157\x73\x74\137\x63\x68\x61\x6e\x67\x65\x5f\160\141\x73\x73\x77\x6f\162\144", "\x70\x6f\x73\x74\137\143\x68\x61\x6e\x67\145\137\x70\x61\163\163\167\157\162\144\x5f\x75\x6e\163\x75\143\143\145\163\x73\x66\165\154"]); goto u_gIv; uBrUk: $user = $query->row(); goto f7I4P; ndnRR: vx19U: goto uBrUk; v0bHP: EDNJt: goto AhvCV; Jz2pK: $query = $this->db->select("\151\x64\x2c\x20\x70\x61\163\x73\x77\157\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\x65\163\x63")->get($this->tables["\165\x73\145\x72\163"]); goto yVA0W; StP6G: $this->set_message("\160\x61\x73\163\x77\x6f\162\144\x5f\143\x68\x61\156\147\x65\x5f\x73\x75\143\143\x65\x73\163\146\165\x6c"); goto v0bHP; kuUjm: $this->trigger_events("\x70\162\x65\137\143\150\x61\156\x67\145\x5f\160\x61\163\163\167\x6f\162\x64"); goto fvxCy; mr4Au: $this->set_error("\x70\141\163\x73\x77\157\x72\144\137\x63\x68\141\156\x67\145\x5f\165\156\163\165\x63\143\145\x73\163\x66\165\x6c"); goto zQfWT; AuadK: goto EDNJt; goto ASXJF; yVA0W: if (!($query->num_rows() !== 1)) { goto vx19U; } goto B4AK3; YQnCQ: return FALSE; goto ndnRR; aLBAL: $this->set_error("\160\141\163\163\167\x6f\x72\144\137\x63\150\x61\x6e\x67\145\x5f\165\156\x73\165\x63\143\145\163\x73\x66\x75\x6c"); goto AuadK; UVQpE: } public function username_check($username = '') { goto r3fVl; r3fVl: $this->trigger_events("\x75\163\145\x72\156\141\x6d\x65\137\x63\x68\145\143\x6b"); goto AYI29; K6PTC: return FALSE; goto i_Mbm; i_Mbm: CSX9q: goto K4ITH; afed4: return $this->db->where("\165\163\x65\x72\x6e\x61\155\145", $username)->limit(1)->count_all_results($this->tables["\165\163\x65\162\x73"]) > 0; goto CxXjj; AYI29: if (!empty($username)) { goto CSX9q; } goto K6PTC; K4ITH: $this->trigger_events("\145\170\164\x72\x61\x5f\167\x68\145\162\x65"); goto afed4; CxXjj: } public function email_check($email = '') { goto otnzW; V6DMx: return FALSE; goto lG2tn; Q_s1g: return $this->db->where("\x65\x6d\x61\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\x73"]) > 0; goto UdzC4; bWPtk: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\150\145\x72\145"); goto Q_s1g; otnzW: $this->trigger_events("\145\155\141\x69\x6c\137\143\150\x65\143\x6b"); goto fXnMT; fXnMT: if (!empty($email)) { goto yZsSC; } goto V6DMx; lG2tn: yZsSC: goto bWPtk; UdzC4: } public function identity_check($identity = '') { goto XSGjX; C1R1y: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\x73"]) > 0; goto MFfB4; XrAng: return FALSE; goto PBrhz; PBrhz: seyce: goto C1R1y; XSGjX: $this->trigger_events("\151\144\x65\x6e\164\x69\x74\x79\x5f\x63\x68\x65\143\153"); goto yHAmA; yHAmA: if (!empty($identity)) { goto seyce; } goto XrAng; MFfB4: } public function get_user_id_from_identity($identity = '') { goto Ol8XP; YFNgS: return FALSE; goto mvZUb; MnB_t: $user = $query->row(); goto a8mzy; Ol8XP: if (!empty($identity)) { goto YTAbe; } goto X112G; a8mzy: return $user->id; goto WYXd2; bZgiv: YTAbe: goto rDUtZ; mvZUb: MbCqJ: goto MnB_t; X112G: return FALSE; goto bZgiv; s_OC9: if (!($query->num_rows() !== 1)) { goto MbCqJ; } goto YFNgS; rDUtZ: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\145\162\x73"]); goto s_OC9; WYXd2: } public function forgotten_password($identity) { goto X2Kov; JAmw7: $this->trigger_events(["\160\157\x73\164\x5f\x66\x6f\x72\147\157\164\x74\145\156\x5f\160\141\x73\163\x77\157\162\144", "\x70\x6f\x73\x74\137\146\x6f\x72\x67\x6f\164\164\x65\156\x5f\x70\x61\x73\163\167\x6f\x72\144\x5f\x75\156\163\165\143\x63\x65\x73\163\146\165\x6c"]); goto Ivoup; GDf8j: C28r6: goto iQzZc; ZFOeu: $this->db->update($this->tables["\165\163\145\x72\163"], $update, [$this->identity_column => $identity]); goto c4vX7; cegbu: DnpTV: goto s3ucD; q6Nhj: $update = ["\x66\157\162\147\x6f\164\164\x65\x6e\x5f\x70\x61\163\163\x77\157\x72\x64\137\163\145\154\145\x63\164\x6f\x72" => $token->selector, "\x66\157\x72\x67\x6f\164\164\145\156\137\x70\x61\163\x73\x77\157\x72\x64\x5f\x63\157\144\145" => $token->validator_hashed, "\x66\x6f\162\147\157\164\164\x65\156\137\x70\141\x73\x73\167\157\162\x64\x5f\164\151\x6d\x65" => time()]; goto jB03d; c4vX7: if ($this->db->affected_rows() === 1) { goto C28r6; } goto JAmw7; F9DdQ: goto IX1Kf; goto GDf8j; OReqY: IX1Kf: goto Zl8l5; iQzZc: $this->trigger_events(["\x70\157\163\164\x5f\146\157\162\x67\x6f\164\164\x65\x6e\x5f\160\141\163\163\x77\157\x72\x64", "\x70\x6f\x73\x74\137\x66\157\162\x67\x6f\x74\x74\145\x6e\x5f\x70\x61\x73\163\x77\157\162\x64\137\163\165\143\x63\145\163\163\x66\x75\154"]); goto fbUfF; fbUfF: return $token->user_code; goto OReqY; MCwvj: return FALSE; goto cegbu; X2Kov: if (!empty($identity)) { goto DnpTV; } goto MoKnW; MoKnW: $this->trigger_events(["\x70\x6f\163\164\x5f\x66\157\162\x67\x6f\164\x74\x65\x6e\x5f\160\x61\163\x73\x77\x6f\162\144", "\x70\157\x73\164\137\146\157\162\x67\x6f\164\x74\x65\156\137\x70\x61\x73\163\167\x6f\162\144\x5f\x75\156\x73\165\143\143\x65\163\163\x66\x75\x6c"]); goto MCwvj; jB03d: $this->trigger_events("\145\170\x74\x72\x61\137\x77\x68\x65\x72\145"); goto ZFOeu; s3ucD: $token = $this->_generate_selector_validator_couple(20, 80); goto q6Nhj; Ivoup: return FALSE; goto F9DdQ; Zl8l5: } public function get_user_by_forgotten_password_code($user_code) { goto bTvM8; abqff: if (!$user) { goto KPwld; } goto YeBBU; YeBBU: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto qPIKi; } goto K7tsc; fijz7: KPwld: goto jCrQc; bTvM8: $token = $this->_retrieve_selector_validator_couple($user_code); goto az51I; wAHvo: qPIKi: goto fijz7; az51I: $user = $this->where("\x66\x6f\162\147\x6f\164\x74\145\x6e\x5f\160\141\163\x73\x77\157\x72\x64\x5f\163\145\154\x65\x63\x74\x6f\x72", $token->selector)->users()->row(); goto abqff; jCrQc: return FALSE; goto B1hQ_; K7tsc: return $user; goto wAHvo; B1hQ_: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto Bh31P; Mz6dU: euhzZ: goto XLckC; Vedg0: if (!(!isset($query->id) && empty($groups))) { goto OLD0B; } goto z4dAp; Wk71m: $default_group = $query; goto ZzfVi; Bzng_: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\x65\x72\163"], $additional_data), $data); goto VDNqt; mh1x1: vrdy1: goto GFGJz; XLckC: $this->set_error("\x61\x63\x63\157\165\x6e\164\x5f\143\x72\x65\141\x74\151\x6f\156\137\x64\x75\160\x6c\151\143\x61\x74\145\137\x69\x64\x65\x6e\x74\x69\164\x79"); goto JHnhI; LIBUP: return FALSE; goto yqtK2; YJotl: goto kCvnn; goto Mz6dU; Bh31P: $this->trigger_events("\160\x72\145\x5f\162\145\x67\x69\x73\164\145\x72"); goto d9mVv; Am_Kb: fGgEJ: goto ejdQf; nfgJ0: foreach ($groups as $group) { $this->add_to_group($group, $id); ziyxw: } goto UeE_Q; dBNOj: if ($this->identity_check($identity)) { goto euhzZ; } goto sVREA; U7L6p: kCvnn: goto uP1ym; d9mVv: $manual_activation = $this->config->item("\x6d\141\156\x75\x61\154\x5f\x61\143\x74\151\166\x61\164\x69\157\x6e", "\151\157\x6e\x5f\141\x75\x74\x68"); goto dBNOj; sVREA: if (!(!$this->config->item("\144\x65\x66\x61\165\154\x74\x5f\x67\x72\x6f\x75\160", "\x69\x6f\x6e\x5f\141\x75\x74\150") && empty($groups))) { goto P4aS7; } goto IAmSE; sdCwN: $groups[] = $default_group->id; goto PrVKv; GFGJz: $data = [$this->identity_column => $identity, "\x75\163\145\x72\156\141\x6d\145" => $identity, "\x70\141\163\163\167\x6f\162\144" => $password, "\145\155\141\x69\154" => $email, "\151\160\x5f\x61\x64\144\x72\145\x73\163" => $ip_address, "\143\x72\145\x61\164\x65\x64\137\157\156" => time(), "\x61\143\164\x69\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto Bzng_; IAmSE: $this->set_error("\141\x63\143\x6f\165\x6e\164\x5f\143\162\x65\141\x74\151\157\156\x5f\x6d\x69\x73\x73\x69\x6e\x67\137\x64\145\x66\x61\x75\x6c\x74\x5f\147\x72\157\165\160"); goto VoCx0; VDNqt: $this->trigger_events("\145\x78\164\x72\x61\137\x73\x65\x74"); goto NQz67; A6l79: return isset($id) ? $id : FALSE; goto GsHxS; VoCx0: return FALSE; goto cIJDI; z4dAp: $this->set_error("\x61\x63\x63\157\165\156\x74\x5f\143\162\145\x61\164\151\x6f\x6e\x5f\151\156\x76\x61\x6c\151\x64\x5f\x64\x65\x66\x61\165\154\x74\x5f\147\162\x6f\165\x70"); goto LIBUP; NQz67: $this->db->insert($this->tables["\165\163\145\x72\x73"], $user_data); goto DjVQy; RYQb8: if (!($password === FALSE)) { goto vrdy1; } goto l9RBv; PrVKv: g3R1B: goto s5AgX; YIEdL: $password = $this->hash_password($password); goto RYQb8; l9RBv: $this->set_error("\141\143\143\157\x75\156\x74\137\143\x72\145\141\164\151\157\156\x5f\x75\156\163\x75\x63\x63\x65\x73\x73\146\165\154"); goto ik_1w; s5AgX: if (empty($groups)) { goto fGgEJ; } goto nfgJ0; UeE_Q: V6NhO: goto Am_Kb; cIJDI: P4aS7: goto YJotl; ik_1w: return FALSE; goto mh1x1; DjVQy: $id = $this->db->insert_id($this->tables["\165\163\x65\162\x73"] . "\137\151\x64\137\163\145\161"); goto cYc5u; ejdQf: $this->trigger_events("\160\157\x73\x74\137\x72\x65\x67\x69\163\x74\145\162"); goto A6l79; uP1ym: $query = $this->db->get_where($this->tables["\x67\162\157\165\160\163"], ["\156\141\x6d\x65" => $this->config->item("\144\x65\146\141\165\x6c\x74\x5f\x67\162\x6f\x75\160", "\151\157\x6e\137\141\165\164\150")], 1)->row(); goto Vedg0; yqtK2: OLD0B: goto Wk71m; cYc5u: if (!(isset($default_group->id) && empty($groups))) { goto g3R1B; } goto sdCwN; JHnhI: return FALSE; goto U7L6p; ZzfVi: $ip_address = $this->input->ip_address(); goto YIEdL; GsHxS: } public function login($identity, $password, $remember = FALSE) { goto KWfLg; gRDng: return TRUE; goto ny9K1; yyfGl: $this->hash_password($password); goto FMKaj; rhxaM: d71_O: goto OR1r9; AI6Ny: if (!($query->num_rows() === 1)) { goto V2XzO; } goto W88_D; rfGgp: V2XzO: goto yyfGl; Eu9D8: $this->trigger_events("\160\x6f\163\x74\x5f\x6c\157\147\x69\156\x5f\x75\x6e\163\165\x63\143\x65\163\163\146\x75\x6c"); goto F4Xmj; qxIjp: $this->clear_remember_code($identity); goto yrpaQ; KWfLg: $this->trigger_events("\160\x72\145\x5f\154\157\x67\151\156"); goto yMp9x; hT4nE: $this->set_session($user); goto KnUP9; ny9K1: CRrh0: goto rfGgp; q6eXN: $this->clear_login_attempts($identity); goto wzkQx; KnUP9: $this->update_last_login($user->id); goto q6eXN; MdCZy: $this->set_error("\154\x6f\147\151\x6e\137\x75\156\x73\x75\x63\x63\145\x73\163\146\165\154"); goto UAhNb; yMp9x: if (!(empty($identity) || empty($password))) { goto TzMrn; } goto MdCZy; F4Xmj: $this->set_error("\154\x6f\147\151\x6e\x5f\165\x6e\163\x75\143\143\145\163\163\146\x75\154"); goto m4kPe; yrpaQ: goto c5AXg; goto rhxaM; tz8VI: return FALSE; goto uIcu0; m4kPe: return FALSE; goto G2qq8; gkcIt: $this->rehash_password_if_needed($user->password, $identity, $password); goto jascM; cCxb5: $this->trigger_events("\x65\170\x74\162\141\137\x77\150\x65\162\x65"); goto Qv_oO; CUv45: $this->set_message("\154\157\x67\x69\156\137\163\165\143\143\145\x73\163\x66\165\x6c"); goto gRDng; Cqzjm: if (!$this->is_max_login_attempts_exceeded($identity)) { goto nIHb7; } goto csAZr; Qv_oO: $query = $this->db->select($this->identity_column . "\54\x20\145\155\x61\x69\154\x2c\x20\151\144\54\x20\160\141\x73\x73\167\157\x72\x64\x2c\x20\141\143\x74\x69\x76\145\x2c\x20\154\x61\x73\x74\x5f\154\x6f\x67\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\144\x65\163\143")->get($this->tables["\165\x73\145\x72\163"]); goto Cqzjm; yWvj3: $this->trigger_events("\x70\x6f\163\x74\x5f\x6c\157\147\x69\156\137\x75\x6e\163\x75\143\x63\x65\163\163\146\x75\x6c"); goto NzNlN; csAZr: $this->hash_password($password); goto xeUjq; FMKaj: $this->increase_login_attempts($identity); goto Eu9D8; JJvu4: if (!$this->config->item("\162\x65\155\145\x6d\142\145\162\x5f\165\163\145\162\163", "\151\x6f\x6e\x5f\141\165\x74\x68")) { goto jGmwn; } goto FavxW; GM64i: if (!$this->verify_password($password, $user->password, $identity)) { goto CRrh0; } goto xa5A4; UAhNb: return FALSE; goto kC4JJ; jascM: $this->session->sess_regenerate(FALSE); goto y5N6k; NzNlN: $this->set_error("\x6c\x6f\147\151\x6e\137\x75\x6e\x73\165\143\x63\x65\x73\x73\146\x75\154\137\x6e\157\164\x5f\x61\x63\x74\151\x76\x65"); goto JlkPP; wzkQx: $this->clear_forgotten_password_code($identity); goto JJvu4; OR1r9: $this->remember_user($identity); goto aGYQA; JlkPP: return FALSE; goto l2LiB; xa5A4: if (!($user->active == 0)) { goto EmTUk; } goto yWvj3; Ewia3: $this->set_error("\154\157\147\x69\156\137\x74\151\155\145\x6f\165\164"); goto tz8VI; xeUjq: $this->trigger_events("\x70\x6f\x73\x74\x5f\154\x6f\147\151\x6e\x5f\165\156\163\165\143\x63\x65\163\163\x66\x75\x6c"); goto Ewia3; W88_D: $user = $query->row(); goto GM64i; y5N6k: $this->trigger_events(["\x70\x6f\163\164\137\154\157\x67\151\x6e", "\x70\x6f\163\x74\x5f\154\157\x67\x69\156\137\x73\x75\143\143\x65\x73\163\x66\165\x6c"]); goto CUv45; kC4JJ: TzMrn: goto cCxb5; uIcu0: nIHb7: goto AI6Ny; DpeOK: jGmwn: goto gkcIt; l2LiB: EmTUk: goto hT4nE; FavxW: if ($remember) { goto d71_O; } goto qxIjp; aGYQA: c5AXg: goto DpeOK; G2qq8: } public function recheck_session() { goto cBjIf; cBjIf: $recheck = NULL !== $this->config->item("\x72\x65\143\x68\145\x63\x6b\x5f\164\x69\155\145\162", "\x69\x6f\x6e\x5f\x61\165\x74\150") ? $this->config->item("\x72\145\x63\150\x65\x63\x6b\137\x74\151\x6d\x65\162", "\151\157\156\x5f\x61\x75\x74\150") : 0; goto Axkql; Axkql: if (!($recheck !== 0)) { goto k927S; } goto urtpw; mTtRc: if (!($last_login + $recheck < time())) { goto HguCD; } goto JBYOz; qq7Oz: $identity = $this->config->item("\x69\144\145\x6e\x74\x69\164\171", "\x69\x6f\156\137\141\165\x74\150"); goto W0ieb; W0ieb: $this->session->unset_userdata([$identity, "\151\x64", "\x75\163\145\x72\x5f\151\x64"]); goto K5mJx; ficOy: FSNKv: goto osMOO; irxyX: goto FSNKv; goto eiEla; eiEla: vckdr: goto u4P1P; urtpw: $last_login = $this->session->userdata("\154\x61\163\164\x5f\x63\150\145\143\153"); goto mTtRc; osMOO: HguCD: goto AeIVZ; K5mJx: return FALSE; goto irxyX; u4P1P: $this->session->set_userdata("\154\x61\x73\164\137\x63\x68\145\143\153", time()); goto ficOy; bfqlP: $this->trigger_events("\x6c\157\x67\x6f\165\x74"); goto qq7Oz; ErT7T: return (bool) $this->session->userdata("\151\x64\x65\x6e\164\x69\164\171"); goto lCnCm; JBYOz: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\144\x65\156\164\x69\164\x79"), "\x61\143\164\x69\x76\145" => "\x31"])->limit(1)->order_by("\x69\144", "\144\x65\163\143")->get($this->tables["\x75\163\145\162\x73"]); goto dEgai; AeIVZ: k927S: goto ErT7T; dEgai: if ($query->num_rows() === 1) { goto vckdr; } goto bfqlP; lCnCm: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto MUwEJ; MUwEJ: if (!$this->config->item("\164\x72\141\143\153\x5f\154\157\x67\x69\156\x5f\x61\164\164\x65\x6d\x70\x74\x73", "\x69\x6f\156\x5f\x61\x75\164\150")) { goto cWuDn; } goto NTCoH; NTCoH: $max_attempts = $this->config->item("\155\141\170\151\x6d\x75\x6d\x5f\154\x6f\x67\x69\x6e\137\x61\x74\164\x65\155\160\x74\163", "\x69\157\156\x5f\141\x75\x74\150"); goto IEH31; eNJri: $attempts = $this->get_attempts_num($identity, $ip_address); goto jrVfy; jrVfy: return $attempts >= $max_attempts; goto XJu_b; XJu_b: P40Xx: goto zZk1e; zZk1e: cWuDn: goto Avbh4; IEH31: if (!($max_attempts > 0)) { goto P40Xx; } goto eNJri; Avbh4: return FALSE; goto Q4QU9; Q4QU9: } public function get_attempts_num($identity, $ip_address = NULL) { goto oXPjT; GwvFt: return $qres->num_rows(); goto sHk9m; sYofx: $qres = $this->db->get($this->tables["\154\157\x67\x69\156\137\x61\x74\x74\145\155\x70\x74\163"]); goto GwvFt; yBDVG: if (!$this->config->item("\164\x72\x61\x63\x6b\x5f\154\x6f\x67\x69\x6e\x5f\151\x70\137\141\144\144\x72\x65\163\x73", "\x69\x6f\156\x5f\x61\165\164\x68")) { goto Bq99Q; } goto nVxzN; m6vnJ: $ip_address = $this->input->ip_address(); goto seeIh; oXPjT: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\x6f\147\151\x6e\137\141\164\x74\x65\x6d\x70\x74\x73", "\x69\157\x6e\x5f\x61\x75\x74\x68")) { goto g3RFA; } goto BwU5i; BwU5i: $this->db->select("\61", FALSE); goto SRpKr; seeIh: t0la3: goto GgFZA; nir6l: return 0; goto G9Fe7; SRpKr: $this->db->where("\154\157\x67\151\156", $identity); goto yBDVG; nVxzN: if (isset($ip_address)) { goto t0la3; } goto m6vnJ; LuNPA: Bq99Q: goto xZq6Y; GgFZA: $this->db->where("\151\160\137\x61\x64\144\162\x65\x73\163", $ip_address); goto LuNPA; sHk9m: g3RFA: goto nir6l; xZq6Y: $this->db->where("\164\151\155\x65\x20\x3e", time() - $this->config->item("\154\157\143\x6b\x6f\165\x74\x5f\164\151\x6d\x65", "\151\x6f\x6e\137\141\x75\x74\x68"), FALSE); goto sYofx; G9Fe7: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto urLxg; ERKLq: $this->db->where("\154\x6f\147\x69\x6e", $identity); goto vyHBZ; X8Qbu: $ip_address = $this->input->ip_address(); goto PBtJ0; ThxIu: Fl2wg: goto Gw2pc; FLJGW: $this->db->order_by("\151\x64", "\x64\145\x73\143"); goto ELm3S; vO2D8: $this->db->where("\151\160\x5f\141\x64\144\162\x65\x73\x73", $ip_address); goto wAvTn; Bv04K: $this->db->select("\x74\x69\155\x65"); goto ERKLq; urLxg: if (!$this->config->item("\164\162\141\x63\x6b\x5f\x6c\x6f\147\x69\x6e\137\141\164\164\x65\x6d\x70\164\163", "\151\157\156\137\141\165\x74\150")) { goto bLuRW; } goto Bv04K; vyHBZ: if (!$this->config->item("\x74\162\141\x63\x6b\x5f\x6c\157\x67\x69\x6e\x5f\x69\160\137\x61\x64\144\162\145\x73\x73", "\x69\x6f\156\137\x61\165\164\150")) { goto wXC6d; } goto avcbe; GXjoy: return 0; goto IBSUs; PBtJ0: RLJcq: goto vO2D8; Gw2pc: bLuRW: goto GXjoy; qNefK: return $qres->row()->time; goto ThxIu; TC82U: if (!($qres->num_rows() > 0)) { goto Fl2wg; } goto qNefK; wAvTn: wXC6d: goto FLJGW; avcbe: if (isset($ip_address)) { goto RLJcq; } goto X8Qbu; ELm3S: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\156\x5f\x61\x74\164\145\x6d\160\164\163"], 1); goto TC82U; IBSUs: } public function get_last_attempt_ip($identity) { goto nPT8d; P1c6e: if (!($qres->num_rows() > 0)) { goto i0hoI; } goto KkEoR; PKelE: $this->db->select("\x69\x70\137\141\144\x64\x72\x65\163\163"); goto QYAfh; QEycV: i0hoI: goto iW_aZ; KkEoR: return $qres->row()->ip_address; goto QEycV; QYAfh: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto lftmx; Qj8xQ: $qres = $this->db->get($this->tables["\154\x6f\x67\x69\156\137\x61\164\x74\x65\155\x70\164\163"], 1); goto P1c6e; GRkOw: return ''; goto WAMIc; nPT8d: if (!($this->config->item("\164\162\x61\143\x6b\137\x6c\157\x67\x69\x6e\137\x61\x74\x74\145\x6d\160\164\x73", "\151\157\x6e\x5f\x61\165\164\150") && $this->config->item("\164\x72\141\x63\x6b\137\154\157\147\151\156\x5f\x69\160\137\x61\144\x64\162\x65\163\163", "\x69\x6f\156\x5f\141\165\x74\150"))) { goto yQ7gx; } goto PKelE; iW_aZ: yQ7gx: goto GRkOw; lftmx: $this->db->order_by("\151\144", "\x64\x65\163\143"); goto Qj8xQ; WAMIc: } public function increase_login_attempts($identity) { goto bYqa4; id2IC: if (!$this->config->item("\164\162\x61\143\153\x5f\x6c\157\147\x69\156\137\x69\160\x5f\141\144\x64\162\145\163\163", "\x69\157\156\137\x61\x75\x74\x68")) { goto wsRLo; } goto GYTEj; Ifn1h: return FALSE; goto tMpiJ; TmPmD: wsRLo: goto jTCGF; JzrYh: $data = ["\151\160\137\x61\x64\144\162\145\x73\x73" => '', "\x6c\x6f\x67\151\156" => $identity, "\x74\x69\x6d\145" => time()]; goto id2IC; jTCGF: return $this->db->insert($this->tables["\x6c\157\147\151\x6e\x5f\141\x74\164\145\x6d\160\x74\x73"], $data); goto wiCUc; bYqa4: if (!$this->config->item("\x74\x72\141\x63\x6b\137\154\x6f\x67\x69\x6e\x5f\x61\164\164\x65\x6d\x70\164\x73", "\151\157\156\x5f\x61\x75\x74\x68")) { goto GfrLv; } goto JzrYh; wiCUc: GfrLv: goto Ifn1h; GYTEj: $data["\151\160\x5f\x61\x64\144\162\145\163\x73"] = $this->input->ip_address(); goto TmPmD; tMpiJ: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto OLxLE; OLxLE: if (!$this->config->item("\164\x72\141\143\x6b\x5f\x6c\157\x67\151\x6e\137\141\164\164\x65\155\x70\x74\163", "\151\x6f\x6e\x5f\x61\x75\x74\x68")) { goto lpnLS; } goto Os2fB; Os2fB: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\143\153\157\x75\x74\137\164\151\155\145", "\x69\157\156\137\x61\x75\164\150")); goto t_DTa; bHMNs: return $this->db->delete($this->tables["\x6c\157\x67\151\x6e\137\141\164\164\x65\155\x70\164\163"]); goto gDc_0; LtjmN: $ip_address = $this->input->ip_address(); goto iz3zr; SXoGb: if (!$this->config->item("\x74\162\141\x63\x6b\x5f\154\x6f\x67\151\156\x5f\151\x70\137\141\144\x64\162\x65\163\x73", "\x69\157\156\137\x61\165\164\150")) { goto vjtL8; } goto ym5ek; NWiVn: return FALSE; goto szqhu; AnXug: $this->db->where("\151\160\x5f\x61\x64\x64\162\x65\163\163", $ip_address); goto Y5P6g; iz3zr: aICsj: goto AnXug; t_DTa: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto SXoGb; ym5ek: if (isset($ip_address)) { goto aICsj; } goto LtjmN; gDc_0: lpnLS: goto NWiVn; W8z5x: $this->db->or_where("\x74\151\155\x65\40\x3c", time() - $old_attempts_expire_period, FALSE); goto bHMNs; Y5P6g: vjtL8: goto W8z5x; szqhu: } public function limit($limit) { goto Yxz3l; b5TJp: return $this; goto qZ9ao; Yxz3l: $this->trigger_events("\154\x69\x6d\151\164"); goto ZXqW4; ZXqW4: $this->_ion_limit = $limit; goto b5TJp; qZ9ao: } public function offset($offset) { goto YCCxN; HvoGd: $this->_ion_offset = $offset; goto m7aHs; YCCxN: $this->trigger_events("\x6f\146\146\x73\145\164"); goto HvoGd; m7aHs: return $this; goto XDcl7; XDcl7: } public function where($where, $value = NULL) { goto QJLjr; oIDxl: $where = [$where => $value]; goto kXBfx; UG3y6: if (is_array($where)) { goto MhD2y; } goto oIDxl; kXBfx: MhD2y: goto NqtFN; QJLjr: $this->trigger_events("\x77\x68\x65\162\x65"); goto UG3y6; OZ7rA: return $this; goto W1DVr; NqtFN: array_push($this->_ion_where, $where); goto OZ7rA; W1DVr: } public function like($like, $value = NULL, $position = "\142\x6f\164\x68") { goto fW6NE; a8nMQ: array_push($this->_ion_like, ["\154\x69\153\x65" => $like, "\x76\141\154\x75\x65" => $value, "\160\x6f\x73\151\164\x69\157\x6e" => $position]); goto o9EKR; fW6NE: $this->trigger_events("\x6c\x69\x6b\x65"); goto a8nMQ; o9EKR: return $this; goto aYAIJ; aYAIJ: } public function select($select) { goto gaPEi; SW36e: return $this; goto i0UDE; gaPEi: $this->trigger_events("\x73\x65\x6c\145\x63\x74"); goto qwuFT; qwuFT: $this->_ion_select[] = $select; goto SW36e; i0UDE: } public function order_by($by, $order = "\144\145\x73\143") { goto jasqK; mJci2: $this->_ion_order = $order; goto J5uNX; YQRNe: $this->_ion_order_by = $by; goto mJci2; J5uNX: return $this; goto sE_81; jasqK: $this->trigger_events("\x6f\162\144\x65\x72\x5f\142\x79"); goto YQRNe; sE_81: } public function row() { goto rbeSa; i45Xb: $row = $this->response->row(); goto gBIXE; rbeSa: $this->trigger_events("\x72\157\167"); goto i45Xb; gBIXE: return $row; goto FNn23; FNn23: } public function row_array() { goto OWiJL; WEABL: $row = $this->response->row_array(); goto hHTnd; OWiJL: $this->trigger_events(["\162\157\167", "\162\157\x77\x5f\141\x72\162\x61\x79"]); goto WEABL; hHTnd: return $row; goto g9aNR; g9aNR: } public function result() { goto HOK3X; HOK3X: $this->trigger_events("\x72\145\163\x75\x6c\164"); goto lZIik; kx5JO: return $result; goto b5ERa; lZIik: $result = $this->response->result(); goto kx5JO; b5ERa: } public function result_array() { goto rGRi9; rGRi9: $this->trigger_events(["\162\x65\163\x75\154\x74", "\162\145\163\165\154\164\137\141\x72\162\x61\x79"]); goto N7Blq; b0gkm: return $result; goto uyA0p; N7Blq: $result = $this->response->result_array(); goto b0gkm; uyA0p: } public function num_rows() { goto izh_z; izh_z: $this->trigger_events(["\156\x75\x6d\x5f\162\x6f\x77\x73"]); goto MEC_s; Zn2nR: return $result; goto eM6NN; MEC_s: $result = $this->response->num_rows(); goto Zn2nR; eM6NN: } public function users($groups = NULL) { goto yVugY; yVugY: $this->trigger_events("\x75\x73\145\162\163"); goto nWN3t; kiEfc: return $this; goto JmGi2; H6Vu8: if (is_array($groups)) { goto pcpm4; } goto TMXsc; n5SF2: $this->db->join($this->tables["\x75\163\145\162\163\137\147\x72\x6f\x75\x70\163"], $this->tables["\165\x73\x65\162\163\x5f\x67\x72\157\x75\160\x73"] . "\56" . $this->join["\x75\x73\145\x72\163"] . "\x3d" . $this->tables["\165\163\145\x72\x73"] . "\56\151\x64", "\x69\156\x6e\x65\x72"); goto DKYlH; TTvha: m9L8q: goto cEyGs; viab3: guoLO: goto qVSsx; jUi92: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto aM3s7; TMXsc: $groups = [$groups]; goto I00ac; nWN3t: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto K9G2q; } goto pBg3I; YXtMU: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto n_1vy; lfdrL: $this->_ion_offset = NULL; goto an8Je; hzX2W: XKL8g: goto OfMzn; Up8en: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto zWvhN; } goto Xb3Hx; S9LRa: zWvhN: goto YXtMU; Frmaq: dBZms: goto aSkRL; cl2Xs: $this->db->distinct(); goto n5SF2; T59k9: cMdJw: goto j96K2; dClIy: foreach ($this->_ion_select as $select) { $this->db->select($select); vIrcH: } goto m4Cef; YClXT: jtG7I: goto xleC2; DKYlH: IDdkR: goto MtYbD; n_1vy: $this->_ion_limit = NULL; goto lfdrL; pBg3I: $this->db->select([$this->tables["\x75\x73\145\162\x73"] . "\56\52", $this->tables["\165\163\x65\x72\163"] . "\56\x69\x64\40\x61\163\x20\x69\144", $this->tables["\165\x73\x65\162\x73"] . "\56\x69\144\40\141\x73\x20\x75\x73\x65\162\137\151\144"]); goto NpX5H; f9beU: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto jtG7I; } goto wlEw1; OfMzn: $this->_ion_where = []; goto YClXT; wlEw1: foreach ($this->_ion_where as $where) { $this->db->where($where); ixsOW: } goto hzX2W; Obb63: qWtns: goto BDwGV; LniHE: $this->db->join($this->tables["\x67\162\157\x75\160\163"], $this->tables["\165\163\145\162\x73\137\x67\x72\x6f\x75\x70\163"] . "\56" . $this->join["\147\x72\x6f\165\x70\163"] . "\x20\75\40" . $this->tables["\147\x72\157\x75\160\x73"] . "\x2e\151\x64", "\x69\x6e\156\x65\162"); goto EzAxd; NpX5H: goto dBZms; goto vkDVk; yb8l0: foreach ($groups as $group) { goto wZTbr; H9Jpz: $group_names[] = $group; goto Vn9rt; uNptD: $group_ids[] = $group; goto GqFmb; QbfhN: NtZ1O: goto gQL6u; wZTbr: if (is_numeric($group)) { goto Gp2Mr; } goto H9Jpz; GqFmb: CcmEa: goto QbfhN; Vn9rt: goto CcmEa; goto dYu34; dYu34: Gp2Mr: goto uNptD; gQL6u: } goto Obb63; iQs2y: $this->_ion_limit = NULL; goto TTvha; k28av: $this->_ion_order_by = NULL; goto viab3; ib188: $this->_ion_select = []; goto Frmaq; I00ac: pcpm4: goto MBzaw; VG48q: qLTmV: goto SvEnP; nBFoS: $group_names = []; goto yb8l0; MtYbD: $group_ids = []; goto nBFoS; m4Cef: DIv6B: goto ib188; vYvST: $this->db->{$or_where_in}($this->tables["\x75\x73\145\162\x73\x5f\x67\x72\x6f\x75\160\x73"] . "\56" . $this->join["\x67\x72\157\165\x70\163"], $group_ids); goto KEZ6Y; vEPI1: waccf: goto ZV7gX; F5LJK: if (empty($group_names)) { goto cMdJw; } goto LniHE; Xb3Hx: if (!isset($this->_ion_limit)) { goto m9L8q; } goto pG8gK; j96K2: if (empty($group_ids)) { goto p7Qw9; } goto vYvST; an8Je: tqIlp: goto nq4W9; EzAxd: $this->db->where_in($this->tables["\x67\x72\x6f\165\x70\163"] . "\56\x6e\x61\155\145", $group_names); goto T59k9; SvEnP: $this->_ion_like = []; goto gbc5L; gbc5L: Oha4h: goto Up8en; vkDVk: K9G2q: goto dClIy; nq4W9: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto guoLO; } goto jUi92; qNb0O: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\153\x65"], $like["\x76\141\154\x75\145"], $like["\160\157\163\x69\164\151\x6f\156"]); nca_P: } goto VG48q; aSkRL: if (!isset($groups)) { goto waccf; } goto H6Vu8; BDwGV: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\137\167\x68\x65\162\145\137\x69\156" : "\167\x68\x65\x72\145\137\151\x6e"; goto F5LJK; pG8gK: $this->db->limit($this->_ion_limit); goto iQs2y; qVSsx: $this->response = $this->db->get($this->tables["\x75\x73\x65\x72\x73"]); goto kiEfc; MBzaw: if (!(isset($groups) && !empty($groups))) { goto IDdkR; } goto cl2Xs; ZV7gX: $this->trigger_events("\145\x78\x74\x72\141\x5f\x77\x68\145\162\145"); goto f9beU; xleC2: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto Oha4h; } goto qNb0O; cEyGs: goto tqIlp; goto S9LRa; aM3s7: $this->_ion_order = NULL; goto k28av; KEZ6Y: p7Qw9: goto vEPI1; JmGi2: } public function user($id = NULL) { goto uV5vi; c6Aq1: $this->limit(1); goto baOZ7; baOZ7: $this->order_by($this->tables["\x75\x73\145\162\163"] . "\x2e\151\144", "\x64\145\163\x63"); goto idzIe; Qai5O: $id = isset($id) ? $id : $this->session->userdata("\x75\163\145\x72\137\x69\x64"); goto c6Aq1; idzIe: $this->where($this->tables["\x75\x73\x65\x72\163"] . "\56\x69\x64", $id); goto xBKjN; uV5vi: $this->trigger_events("\x75\163\x65\x72"); goto Qai5O; xBKjN: $this->users(); goto KV0UJ; KV0UJ: return $this; goto KW71X; KW71X: } public function get_users_groups($id = FALSE) { goto kRdfA; kRdfA: $this->trigger_events("\147\145\164\x5f\x75\163\x65\x72\163\x5f\147\x72\x6f\x75\x70"); goto QjOoN; MnXhM: return $this->db->select($this->tables["\x75\163\145\x72\x73\x5f\147\x72\157\165\x70\x73"] . "\56" . $this->join["\x67\x72\x6f\x75\x70\163"] . "\40\x61\x73\x20\x69\x64\x2c\x20" . $this->tables["\147\162\157\x75\x70\x73"] . "\56\156\141\x6d\x65\x2c\40" . $this->tables["\147\x72\157\x75\x70\163"] . "\x2e\144\x65\x73\143\162\151\160\164\151\x6f\x6e")->where($this->tables["\x75\163\145\x72\x73\x5f\x67\162\x6f\x75\x70\163"] . "\56" . $this->join["\165\163\x65\x72\x73"], $id)->join($this->tables["\147\x72\157\x75\160\163"], $this->tables["\165\x73\x65\162\163\x5f\x67\162\157\x75\x70\163"] . "\x2e" . $this->join["\x67\x72\157\165\x70\163"] . "\75" . $this->tables["\147\x72\157\x75\160\163"] . "\x2e\151\144")->get($this->tables["\165\163\x65\x72\163\137\147\x72\x6f\165\x70\x73"]); goto L4e1w; QjOoN: $id || ($id = $this->session->userdata("\165\163\145\x72\x5f\x69\144")); goto MnXhM; L4e1w: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto Ps6LG; gRDN2: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; jTscU: } goto xLpTb; elBi6: foreach ($check_group as $key => $value) { goto XoA61; zcxEN: HGDgV: goto lE50R; lE50R: uCTtG: goto TacwF; XoA61: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto CriWX; CriWX: if (!(in_array($value, $groups) xor $check_all)) { goto HGDgV; } goto QSr9t; QSr9t: return !$check_all; goto zcxEN; TacwF: } goto vrX4b; xLpTb: xMMPL: goto muAAr; mAl2t: qB_QB: goto elBi6; YJrX0: Tdrmt: goto FoL9B; ysIYg: $users_groups = $this->get_users_groups($id)->result(); goto pjGTm; FoL9B: $groups_array = $this->_cache_user_in_group[$id]; goto mAl2t; TOGaF: rst1h: goto H9svg; oym0e: $check_group = [$check_group]; goto TOGaF; vrX4b: D2ZTo: goto tEJT7; muAAr: $this->_cache_user_in_group[$id] = $groups_array; goto MLKrI; MLKrI: goto qB_QB; goto YJrX0; H9svg: if (isset($this->_cache_user_in_group[$id])) { goto Tdrmt; } goto ysIYg; pjGTm: $groups_array = []; goto gRDN2; tEJT7: return $check_all; goto eErcm; x8nYM: if (is_array($check_group)) { goto rst1h; } goto oym0e; Ps6LG: $this->trigger_events("\x69\156\137\147\162\x6f\165\x70"); goto i9qs_; i9qs_: $id || ($id = $this->session->userdata("\x75\163\x65\162\137\151\144")); goto x8nYM; eErcm: } public function add_to_group($group_ids, $user_id = FALSE) { goto NiUXi; bl9HZ: suBHn: goto jppKx; NiUXi: $this->trigger_events("\x61\x64\x64\137\164\x6f\x5f\147\162\x6f\x75\160"); goto dWUXb; rjZDk: $return = 0; goto Bf3E_; dWUXb: $user_id || ($user_id = $this->session->userdata("\x75\x73\x65\162\137\x69\144")); goto cFIyW; Bf3E_: foreach ($group_ids as $group_id) { goto v4b0b; pZeab: jM0FB: goto ntTwr; v4b0b: if (!$this->db->insert($this->tables["\165\163\x65\162\x73\137\147\x72\x6f\165\x70\163"], [$this->join["\x67\x72\157\x75\x70\163"] => (float) $group_id, $this->join["\165\x73\x65\162\x73"] => (float) $user_id])) { goto sSPfJ; } goto QAVIf; l8LQG: goto jM0FB; goto aQx_t; ntTwr: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto hBWna; oeVyk: sSPfJ: goto vaMZV; vMIqp: $group_name = $group[0]->name; goto xHRJO; MUS3X: $group_name = $this->_cache_groups[$group_id]; goto pZeab; Zj7_g: $group = $this->group($group_id)->result(); goto vMIqp; vaMZV: vYW6T: goto dBbZL; hBWna: $return++; goto oeVyk; aQx_t: Xszfj: goto MUS3X; QAVIf: if (isset($this->_cache_groups[$group_id])) { goto Xszfj; } goto Zj7_g; xHRJO: $this->_cache_groups[$group_id] = $group_name; goto l8LQG; dBbZL: } goto bl9HZ; cFIyW: if (is_array($group_ids)) { goto rGCit; } goto ZxvO3; Ah8_2: rGCit: goto rjZDk; ZxvO3: $group_ids = [$group_ids]; goto Ah8_2; jppKx: return $return; goto yRqst; yRqst: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto ftK4F; IPS6y: $this->_cache_user_in_group[$user_id] = []; goto Pxw0G; w1pq8: foreach ($group_ids as $group_id) { goto emEzI; emEzI: $this->db->delete($this->tables["\165\x73\145\162\163\137\x67\162\157\x75\x70\x73"], [$this->join["\147\162\x6f\165\160\163"] => (float) $group_id, $this->join["\x75\163\145\x72\x73"] => (float) $user_id]); goto kzxUK; kzxUK: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto dS1Mb; } goto S1q7j; MeDGR: Ez2Ts: goto pi3v8; S1q7j: unset($this->_cache_user_in_group[$user_id][$group_id]); goto Is0_u; Is0_u: dS1Mb: goto MeDGR; pi3v8: } goto qyp6K; FBceW: goto d3HY6; goto w0thg; Pxw0G: El08Z: goto FBceW; uscQX: if (!empty($group_ids)) { goto z8tDw; } goto uTY0Y; Cwxvt: return $return; goto cdlnh; uTY0Y: if (!($return = $this->db->delete($this->tables["\x75\x73\145\x72\x73\x5f\147\162\157\x75\160\x73"], [$this->join["\165\163\145\162\x73"] => (float) $user_id]))) { goto El08Z; } goto IPS6y; qyp6K: dj5Cx: goto Odk3Z; sZkfB: uMgsN: goto uscQX; zrqQL: d3HY6: goto Cwxvt; w0thg: z8tDw: goto ztkhj; HCIeP: $group_ids = [$group_ids]; goto GCAC3; ftK4F: $this->trigger_events("\162\x65\155\157\166\x65\x5f\x66\x72\157\155\x5f\147\162\x6f\165\x70"); goto iYl3n; ztkhj: if (is_array($group_ids)) { goto Ozv5D; } goto HCIeP; GCAC3: Ozv5D: goto w1pq8; RsrE5: return FALSE; goto sZkfB; iYl3n: if (!empty($user_id)) { goto uMgsN; } goto RsrE5; Odk3Z: $return = TRUE; goto zrqQL; cdlnh: } public function groups() { goto Ev0m5; s1luk: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto ZtiX6; } goto wCfBm; g458L: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto DFyfD; } goto QJRpK; NJ0Et: el9UQ: goto s1luk; MKgxN: tIvWg: goto VaCTq; QPPM9: $this->_ion_offset = NULL; goto JybWN; AR1dm: $this->db->limit($this->_ion_limit); goto UiMv3; zaINK: goto n8rac; goto ESCmA; nAfZP: $this->_ion_limit = NULL; goto QPPM9; pe2vJ: DFyfD: goto ehTua; ehTua: $this->response = $this->db->get($this->tables["\147\x72\157\165\x70\x73"]); goto p3Etv; VaCTq: $this->_ion_where = []; goto NJ0Et; JybWN: n8rac: goto g458L; QJRpK: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto pe2vJ; p3Etv: return $this; goto J0EUU; UiMv3: $this->_ion_limit = NULL; goto Z7hRd; wCfBm: if (!isset($this->_ion_limit)) { goto Olpx3; } goto AR1dm; Ev0m5: $this->trigger_events("\x67\x72\x6f\165\x70\163"); goto a1lls; EaGdz: foreach ($this->_ion_where as $where) { $this->db->where($where); HPobv: } goto MKgxN; qLHVJ: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto nAfZP; Z7hRd: Olpx3: goto zaINK; a1lls: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto el9UQ; } goto EaGdz; ESCmA: ZtiX6: goto qLHVJ; J0EUU: } public function group($id = NULL) { goto hHkss; Aqolv: return $this->groups(); goto lXVyi; ZlCJ9: $this->limit(1); goto xjJCr; c1DdK: NmnwC: goto ZlCJ9; xjJCr: $this->order_by("\151\144", "\x64\x65\x73\143"); goto Aqolv; ySRPy: $this->where($this->tables["\x67\162\157\165\x70\163"] . "\x2e\151\144", $id); goto c1DdK; jP1sN: if (!isset($id)) { goto NmnwC; } goto ySRPy; hHkss: $this->trigger_events("\x67\162\x6f\165\x70"); goto jP1sN; lXVyi: } public function update($id, array $data) { goto SOY1b; txLo2: Q6muw: goto OLfnC; BQ3EW: return FALSE; goto Uccpq; MTm8K: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\163\163\x77\x6f\x72\144", $data) || array_key_exists("\145\x6d\x61\x69\x6c", $data))) { goto PJSUd; } goto DblLo; DcASs: return FALSE; goto txLo2; oCIQZ: $this->trigger_events(["\x70\x6f\x73\164\137\x75\x70\x64\x61\x74\145\137\165\163\145\162", "\160\157\163\164\137\x75\160\x64\x61\x74\145\137\x75\163\x65\x72\x5f\165\156\163\x75\x63\143\x65\163\x73\x66\165\154"]); goto tKdV5; Vh_re: Vd0kP: goto JICKV; RGAUI: if (!($data["\160\x61\163\163\x77\x6f\162\x64"] === FALSE)) { goto Q6muw; } goto xsMIj; eci_z: xmQih: goto F4ZWe; FLtsP: $this->trigger_events(["\160\x6f\x73\164\x5f\x75\160\x64\x61\164\x65\137\165\x73\145\x72", "\160\x6f\163\x74\137\x75\160\x64\141\164\x65\x5f\x75\163\x65\x72\137\x75\156\x73\165\x63\x63\145\163\x73\146\165\154"]); goto u9KU_; L_u2c: $user = $this->user($id)->row(); goto ABfgf; pr24z: $this->trigger_events(["\160\157\x73\x74\x5f\x75\160\144\x61\164\x65\137\165\163\x65\162", "\160\157\x73\164\x5f\165\160\144\141\164\145\x5f\x75\x73\x65\162\137\x75\156\163\165\143\143\145\x73\x73\146\165\x6c"]); goto cvGzG; MUIJH: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, ["\151\144" => $user->id]); goto h7pkG; ABfgf: $this->db->trans_begin(); goto p33so; BnBmF: $this->set_message("\x75\x70\144\141\x74\x65\x5f\x73\x75\143\143\145\x73\163\x66\165\x6c"); goto d2n2y; reoTd: $this->trigger_events(["\x70\157\x73\x74\x5f\165\x70\144\x61\x74\x65\137\x75\163\145\162", "\160\157\x73\x74\137\x75\x70\x64\x61\x74\x65\x5f\165\163\145\162\137\x73\x75\143\143\x65\163\x73\146\165\154"]); goto BnBmF; JICKV: $this->db->trans_commit(); goto reoTd; d2n2y: return TRUE; goto bTwLA; v0nWu: $this->db->trans_rollback(); goto S2nsI; DblLo: if (!array_key_exists("\x70\x61\x73\163\167\157\162\144", $data)) { goto xmQih; } goto R_S21; GeKHg: unset($data["\160\141\x73\x73\167\157\x72\144"]); goto xFqiO; p33so: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto TWKZn; } goto v0nWu; h7pkG: if (!($this->db->trans_status() === FALSE)) { goto Vd0kP; } goto jjcSh; jjcSh: $this->db->trans_rollback(); goto oCIQZ; xFqiO: goto JdrTq; goto xYEyu; R_S21: if (!empty($data["\x70\x61\163\x73\167\157\x72\144"])) { goto hXzEX; } goto GeKHg; GkNSI: $this->trigger_events("\145\x78\164\x72\141\x5f\167\x68\145\162\x65"); goto MUIJH; S2nsI: $this->set_error("\x61\x63\x63\157\165\156\164\x5f\143\162\145\141\164\x69\x6f\x6e\137\x64\165\x70\154\x69\x63\141\x74\x65\x5f\x69\144\x65\x6e\164\x69\164\171"); goto pr24z; Wy6pI: $data["\160\141\163\x73\x77\157\x72\x64"] = $this->hash_password($data["\160\141\163\163\x77\x6f\x72\x64"], $user->{$this->identity_column}); goto RGAUI; xsMIj: $this->db->trans_rollback(); goto FLtsP; F4ZWe: PJSUd: goto GkNSI; u9KU_: $this->set_error("\165\160\144\x61\164\145\137\x75\156\x73\165\143\x63\x65\x73\163\146\165\x6c"); goto DcASs; OLfnC: JdrTq: goto eci_z; dbAAL: return FALSE; goto Vh_re; SOY1b: $this->trigger_events("\160\162\145\x5f\x75\x70\x64\141\x74\x65\x5f\x75\163\145\x72"); goto L_u2c; FKUhE: $data = $this->_filter_data($this->tables["\x75\x73\145\162\x73"], $data); goto MTm8K; xYEyu: hXzEX: goto Wy6pI; tKdV5: $this->set_error("\x75\160\x64\x61\164\145\x5f\x75\x6e\163\x75\143\x63\145\163\x73\146\165\x6c"); goto dbAAL; cvGzG: $this->set_error("\x75\x70\x64\x61\x74\x65\137\165\156\x73\x75\143\143\x65\x73\163\146\x75\154"); goto BQ3EW; Uccpq: TWKZn: goto FKUhE; bTwLA: } public function delete_user($id) { goto Wel__; pqzrV: $this->remove_from_group(NULL, $id); goto Znhm0; Z84vN: return TRUE; goto DmGoY; sjsAk: if (!($this->db->trans_status() === FALSE)) { goto RaXge; } goto VyAfH; gyDeJ: $this->trigger_events(["\160\x6f\x73\164\137\x64\x65\154\x65\164\x65\137\165\163\x65\x72", "\160\157\163\164\137\x64\145\154\x65\x74\145\x5f\165\x73\145\x72\137\163\165\x63\143\x65\x73\x73\x66\x75\x6c"]); goto IuoRI; Znhm0: $this->db->delete($this->tables["\165\163\145\162\163"], ["\x69\144" => $id]); goto sjsAk; BcMWj: RaXge: goto bf8Ez; Wel__: $this->trigger_events("\160\x72\145\x5f\144\x65\154\145\x74\x65\x5f\165\x73\145\x72"); goto PRTU5; VyAfH: $this->db->trans_rollback(); goto vDLyi; PRTU5: $this->db->trans_begin(); goto pqzrV; bf8Ez: $this->db->trans_commit(); goto gyDeJ; Jyf3E: $this->set_error("\x64\x65\x6c\x65\x74\145\x5f\x75\x6e\x73\x75\x63\x63\x65\163\x73\146\165\154"); goto b7jNo; IuoRI: $this->set_message("\x64\x65\154\145\x74\x65\137\163\165\143\x63\x65\163\x73\146\165\154"); goto Z84vN; b7jNo: return FALSE; goto BcMWj; vDLyi: $this->trigger_events(["\160\157\163\x74\x5f\144\x65\x6c\145\x74\145\x5f\x75\163\145\x72", "\160\x6f\163\164\x5f\144\x65\x6c\145\x74\x65\x5f\x75\163\x65\x72\137\165\x6e\x73\x75\143\x63\x65\163\x73\146\x75\x6c"]); goto Jyf3E; DmGoY: } public function update_last_login($id) { goto dK0qI; dK0qI: $this->trigger_events("\x75\x70\x64\x61\x74\145\x5f\x6c\141\x73\x74\x5f\154\157\147\151\x6e"); goto WLmUf; WLmUf: $this->load->helper("\x64\141\x74\145"); goto cZ0jf; cZ0jf: $this->trigger_events("\145\x78\164\162\x61\x5f\167\x68\145\x72\145"); goto Z97hc; Z97hc: $this->db->update($this->tables["\165\163\x65\x72\x73"], ["\154\x61\163\164\137\154\157\x67\x69\156" => time()], ["\x69\x64" => $id]); goto Cqv2J; Cqv2J: return $this->db->affected_rows() == 1; goto iF5Ew; iF5Ew: } public function set_lang($lang = "\x65\156") { goto O99kK; F1eSj: if ($this->config->item("\x75\163\x65\x72\x5f\145\x78\x70\151\x72\x65", "\x69\x6f\156\x5f\141\165\164\x68") === 0) { goto CDK4a; } goto Y6ABK; O99kK: $this->trigger_events("\163\145\x74\137\154\x61\156\x67"); goto F1eSj; MMdrZ: $expire = self::MAX_COOKIE_LIFETIME; goto A0ZAP; kXxHR: return TRUE; goto xLm2O; ulKzl: goto u9LRD; goto tCX0b; X2xv0: set_cookie(["\156\141\x6d\145" => "\154\x61\x6e\147\x5f\143\157\144\145", "\x76\x61\x6c\x75\145" => $lang, "\145\170\160\151\x72\x65" => $expire]); goto kXxHR; Y6ABK: $expire = $this->config->item("\x75\x73\145\x72\x5f\x65\170\160\151\x72\145", "\x69\157\156\137\x61\x75\x74\150"); goto ulKzl; tCX0b: CDK4a: goto MMdrZ; A0ZAP: u9LRD: goto X2xv0; xLm2O: } public function set_session($user) { goto u8h0U; bGD1v: $session_data = ["\151\x64\x65\156\x74\151\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\141\x69\x6c" => $user->email, "\165\x73\145\162\137\x69\x64" => $user->id, "\x6f\154\x64\137\154\x61\x73\x74\x5f\154\x6f\x67\151\156" => $user->last_login, "\x6c\x61\163\x74\x5f\143\150\145\143\153" => time()]; goto TW4kV; TW4kV: $this->session->set_userdata($session_data); goto iSJRb; u8h0U: $this->trigger_events("\160\162\x65\137\x73\x65\x74\x5f\x73\145\x73\x73\151\x6f\x6e"); goto bGD1v; ds6Nj: return TRUE; goto MDGRb; iSJRb: $this->trigger_events("\160\x6f\163\x74\x5f\x73\x65\164\137\163\x65\163\x73\x69\x6f\156"); goto ds6Nj; MDGRb: } public function remember_user($identity) { goto bcJDh; AH0qg: return TRUE; goto XgpZE; T4cgi: if ($this->config->item("\x75\x73\145\x72\137\x65\x78\x70\151\x72\x65", "\x69\x6f\156\x5f\x61\165\x74\150") === 0) { goto qCWH8; } goto CrwB0; DQZF0: return FALSE; goto lLbZI; txO9X: $this->trigger_events(["\160\x6f\163\x74\137\162\x65\x6d\x65\x6d\x62\x65\x72\x5f\165\163\145\162", "\162\145\155\145\x6d\142\x65\162\x5f\x75\163\x65\162\137\163\x75\143\x63\145\163\163\x66\165\154"]); goto AH0qg; bcJDh: $this->trigger_events("\160\162\x65\137\x72\145\155\145\155\x62\145\x72\137\165\163\x65\162"); goto U0TD4; LYQk3: $this->db->update($this->tables["\x75\x73\145\x72\x73"], ["\x72\x65\155\145\155\x62\x65\x72\137\163\x65\154\145\x63\164\157\x72" => $token->selector, "\162\x65\155\145\x6d\x62\145\162\x5f\143\157\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto hkJVs; LA8w3: $this->trigger_events(["\x70\157\163\164\137\x72\x65\155\x65\155\x62\x65\x72\x5f\165\x73\x65\x72", "\162\145\x6d\145\155\x62\145\162\x5f\165\x73\x65\162\137\165\156\x73\x75\x63\x63\x65\163\x73\x66\x75\154"]); goto DQZF0; cJXgh: set_cookie(["\156\x61\155\145" => $this->config->item("\162\x65\155\x65\x6d\142\x65\162\x5f\x63\x6f\x6f\153\151\145\x5f\x6e\141\155\x65", "\151\157\156\x5f\x61\x75\x74\x68"), "\166\x61\154\165\x65" => $token->user_code, "\x65\170\x70\x69\162\x65" => $expire]); goto txO9X; fcXjz: return FALSE; goto yCABP; XgpZE: Ji08C: goto aJX_5; bBfAH: $token = $this->_generate_selector_validator_couple(); goto mgZp4; mgZp4: if (!$token->validator_hashed) { goto PULti; } goto LYQk3; U0TD4: if ($identity) { goto I98CS; } goto fcXjz; Atqez: goto k1SPC; goto QOjI7; QOjI7: qCWH8: goto JRLyk; CrwB0: $expire = $this->config->item("\x75\x73\145\x72\x5f\145\170\160\151\x72\x65", "\x69\157\x6e\x5f\x61\165\164\x68"); goto Atqez; aJX_5: PULti: goto LA8w3; hkJVs: if (!($this->db->affected_rows() > -1)) { goto Ji08C; } goto T4cgi; JRLyk: $expire = self::MAX_COOKIE_LIFETIME; goto QFKhR; QFKhR: k1SPC: goto cJXgh; yCABP: I98CS: goto bBfAH; lLbZI: } public function login_remembered_user() { goto BuzqT; m94Ar: return TRUE; goto A8qxY; uC9mj: if (!$this->config->item("\x75\163\x65\x72\x5f\x65\170\x74\x65\156\x64\x5f\157\x6e\137\154\x6f\x67\x69\x6e", "\151\x6f\x6e\x5f\141\165\164\x68")) { goto Q0hmU; } goto wEXXM; EL_tG: delete_cookie($this->config->item("\162\x65\155\x65\155\x62\x65\x72\x5f\x63\x6f\x6f\153\151\145\x5f\x6e\141\155\145", "\151\157\156\137\x61\165\164\x68")); goto bMpan; wEXXM: $this->remember_user($identity); goto iYF__; O7e_5: $remember_cookie = get_cookie($this->config->item("\x72\x65\x6d\x65\155\142\145\x72\x5f\143\157\x6f\x6b\151\x65\x5f\156\141\x6d\x65", "\x69\157\x6e\x5f\141\x75\x74\150")); goto oN3wF; jQWPR: $this->session->sess_regenerate(FALSE); goto geVox; geVox: $this->trigger_events(["\160\157\163\x74\x5f\154\157\x67\x69\156\x5f\162\x65\x6d\145\x6d\x62\x65\162\x65\x64\x5f\165\163\x65\162", "\160\x6f\x73\x74\137\x6c\x6f\x67\x69\x6e\137\162\x65\x6d\145\155\x62\x65\162\x65\x64\x5f\165\x73\145\162\137\163\x75\143\143\x65\x73\163\146\x75\154"]); goto m94Ar; svj9E: $this->trigger_events("\145\x78\164\162\141\x5f\167\150\x65\162\x65"); goto hE5nh; aSp5Q: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto ZPNHi; } goto i3TQA; BuzqT: $this->trigger_events("\x70\x72\145\x5f\154\157\147\x69\x6e\137\162\145\x6d\145\155\142\145\162\145\x64\137\x75\163\x65\x72"); goto O7e_5; A8qxY: ZPNHi: goto lNb1Z; afDHG: $this->clear_forgotten_password_code($identity); goto uC9mj; Rh817: $this->trigger_events(["\160\x6f\163\164\x5f\x6c\x6f\147\x69\156\x5f\162\145\x6d\145\155\x62\x65\162\x65\144\x5f\165\163\145\162", "\x70\x6f\x73\x74\137\x6c\x6f\147\151\156\x5f\162\x65\x6d\145\x6d\x62\145\x72\145\144\137\x75\163\x65\162\x5f\x75\156\163\165\143\143\145\x73\163\x66\165\154"]); goto nzZC8; MHQxG: if (!($token === FALSE)) { goto p_Rql; } goto Rh817; lNb1Z: reuT6: goto EL_tG; LY4Zn: if (!($query->num_rows() === 1)) { goto reuT6; } goto xVKd0; SzZgm: $identity = $user->{$this->identity_column}; goto aSp5Q; iYF__: Q0hmU: goto jQWPR; xVKd0: $user = $query->row(); goto SzZgm; RwDsC: p_Rql: goto svj9E; i3TQA: $this->update_last_login($user->id); goto YslTf; YslTf: $this->set_session($user); goto afDHG; nzZC8: return FALSE; goto RwDsC; oN3wF: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto MHQxG; hE5nh: $query = $this->db->select($this->identity_column . "\x2c\x20\151\x64\x2c\x20\145\x6d\x61\x69\154\54\x20\162\145\x6d\145\155\x62\x65\x72\137\x63\157\144\145\54\40\x6c\x61\163\x74\x5f\x6c\157\x67\x69\x6e")->where("\x72\x65\x6d\x65\x6d\x62\x65\162\137\163\x65\154\145\x63\x74\157\162", $token->selector)->where("\x61\143\164\151\x76\145", 1)->limit(1)->get($this->tables["\165\163\145\162\163"]); goto LY4Zn; U4_ch: return FALSE; goto uz39P; bMpan: $this->trigger_events(["\x70\x6f\163\x74\x5f\x6c\x6f\147\151\x6e\x5f\x72\x65\x6d\x65\155\142\145\x72\x65\144\x5f\x75\163\145\162", "\x70\157\x73\x74\137\154\x6f\147\151\x6e\137\x72\x65\x6d\x65\155\142\145\162\145\x64\x5f\x75\163\x65\x72\137\165\x6e\x73\x75\x63\143\x65\x73\163\x66\x75\x6c"]); goto U4_ch; uz39P: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto gpUnx; uJiFj: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\x75\160\163"], ["\x6e\x61\x6d\x65" => $group_name])->num_rows(); goto kVxOL; zVEGw: mwXfa: goto OT34I; mfgz9: $group_id = $this->db->insert_id($this->tables["\x67\162\157\x75\x70\x73"] . "\x5f\x69\144\137\x73\145\161"); goto xRAj6; uSWrv: X0pm0: goto GUvm2; kVxOL: if (!($existing_group !== 0)) { goto X0pm0; } goto U7ePU; Svzvq: g8QOh: goto uJiFj; fO6tz: return FALSE; goto Svzvq; VUfN7: $data = array_merge($this->_filter_data($this->tables["\x67\x72\157\x75\160\x73"], $additional_data), $data); goto zVEGw; Wfdqp: $this->db->insert($this->tables["\147\x72\x6f\x75\x70\163"], $data); goto mfgz9; xRAj6: $this->set_message("\x67\162\157\x75\x70\x5f\143\162\x65\x61\x74\x69\157\156\137\x73\165\x63\x63\145\x73\x73\x66\x75\154"); goto qTBPh; VLVvY: return FALSE; goto uSWrv; gpUnx: if ($group_name) { goto g8QOh; } goto jku1m; AKwI2: if (empty($additional_data)) { goto mwXfa; } goto VUfN7; OT34I: $this->trigger_events("\x65\x78\164\162\x61\137\x67\162\157\165\160\x5f\x73\x65\x74"); goto Wfdqp; jku1m: $this->set_error("\147\162\x6f\x75\160\x5f\x6e\141\155\x65\137\x72\145\161\165\151\x72\145\x64"); goto fO6tz; qTBPh: return $group_id; goto NoDe1; GUvm2: $data = ["\156\x61\x6d\x65" => $group_name, "\x64\145\163\143\x72\151\160\x74\x69\x6f\156" => $group_description]; goto AKwI2; U7ePU: $this->set_error("\x67\162\157\165\x70\137\x61\x6c\162\145\x61\144\171\137\x65\170\x69\163\164\163"); goto VLVvY; NoDe1: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto Mxjvu; NVIq_: $data["\156\x61\155\145"] = $group_name; goto pWWLf; PXO1z: $this->set_error("\147\162\x6f\165\160\137\x61\154\x72\145\x61\144\171\x5f\145\x78\x69\163\x74\163"); goto tQm9p; UUwEO: h4hGR: goto bMgy6; TUCOO: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto lRm79; } goto PXO1z; U6Og0: $this->set_message("\x67\x72\x6f\165\x70\x5f\165\x70\144\x61\x74\x65\137\x73\165\143\x63\x65\x73\x73\x66\165\x6c"); goto f5aNI; tQm9p: return FALSE; goto JGooQ; dxnq7: xU_xY: goto MHt7O; bKfY6: return FALSE; goto dxnq7; JGooQ: lRm79: goto NVIq_; f5aNI: return TRUE; goto TvZbM; tah1Q: $this->set_error("\x67\x72\157\x75\160\x5f\x6e\x61\155\145\x5f\x61\x64\155\151\x6e\137\156\x6f\x74\x5f\x61\154\x74\145\162"); goto bKfY6; vtLOr: if (!($this->config->item("\141\144\155\x69\x6e\137\147\x72\157\165\160", "\151\x6f\156\x5f\x61\165\x74\x68") === $group->name && $group_name !== $group->name)) { goto xU_xY; } goto tah1Q; CL530: $data = array_merge($this->_filter_data($this->tables["\x67\162\157\x75\160\163"], $additional_data), $data); goto RerWF; pWWLf: dtFqg: goto rzZnw; MHt7O: if (empty($additional_data)) { goto DBEwY; } goto CL530; rzZnw: $group = $this->db->get_where($this->tables["\x67\162\x6f\x75\160\x73"], ["\151\144" => $group_id])->row(); goto vtLOr; mWn2L: $this->db->update($this->tables["\147\162\157\x75\160\163"], $data, ["\x69\144" => $group_id]); goto U6Og0; RerWF: DBEwY: goto mWn2L; Mxjvu: if (!empty($group_id)) { goto h4hGR; } goto j211C; GqFn8: if (empty($group_name)) { goto dtFqg; } goto yb1v1; j211C: return FALSE; goto UUwEO; yb1v1: $existing_group = $this->db->get_where($this->tables["\147\162\157\165\x70\163"], ["\x6e\x61\x6d\145" => $group_name])->row(); goto TUCOO; bMgy6: $data = []; goto GqFn8; TvZbM: } public function delete_group($group_id = FALSE) { goto NpLVr; Wpr3P: $this->set_error("\x67\x72\157\x75\160\x5f\144\145\154\145\x74\x65\x5f\x75\156\163\x75\x63\143\x65\163\x73\x66\165\x6c"); goto uM0uc; uM0uc: return FALSE; goto IHUZJ; ZLWGk: $this->set_error("\x67\x72\x6f\x75\160\x5f\x64\145\x6c\x65\x74\x65\137\x6e\x6f\164\141\x6c\154\x6f\167\145\x64"); goto LIBEw; oe9QE: $group = $this->group($group_id)->row(); goto BxuwE; dGMne: $this->trigger_events(["\160\x6f\x73\x74\137\x64\x65\154\145\164\145\137\147\162\157\x75\160", "\x70\157\163\164\137\x64\x65\154\x65\164\145\x5f\x67\x72\x6f\165\160\137\x73\165\143\143\145\x73\x73\x66\x75\154"]); goto ynhHA; FVq3U: DQ4Di: goto MvODJ; UL292: $this->db->delete($this->tables["\x67\162\x6f\x75\160\163"], ["\x69\x64" => $group_id]); goto Mkcl3; Mkcl3: if (!($this->db->trans_status() === FALSE)) { goto JVox8; } goto F1MNg; LIBEw: return FALSE; goto FVq3U; nqu0q: return FALSE; goto N_4_z; IHUZJ: JVox8: goto wIcHC; BxuwE: if (!($group->name == $this->config->item("\141\x64\x6d\151\x6e\x5f\x67\162\x6f\x75\160", "\151\x6f\156\137\141\165\x74\150"))) { goto DQ4Di; } goto FHUln; ynhHA: $this->set_message("\x67\x72\x6f\x75\160\x5f\x64\145\154\145\164\x65\137\163\x75\x63\143\x65\163\x73\x66\x75\x6c"); goto TTiIE; FHUln: $this->trigger_events(["\x70\x6f\163\164\x5f\144\x65\x6c\x65\x74\145\x5f\147\162\x6f\165\x70", "\x70\157\163\164\137\144\145\154\145\x74\x65\137\x67\x72\157\165\x70\137\156\x6f\164\141\x6c\154\157\x77\145\x64"]); goto ZLWGk; MKw5T: $this->trigger_events(["\160\157\163\x74\x5f\144\x65\154\x65\x74\145\137\x67\162\157\x75\160", "\160\157\x73\164\137\144\x65\154\145\164\145\x5f\147\x72\157\165\160\x5f\x75\x6e\163\x75\143\x63\x65\163\163\146\x75\154"]); goto Wpr3P; F1MNg: $this->db->trans_rollback(); goto MKw5T; TTiIE: return TRUE; goto bx2IF; N_4_z: r7KnI: goto oe9QE; D8JCr: $this->db->trans_begin(); goto nlkZQ; MvODJ: $this->trigger_events("\160\x72\145\137\144\145\154\145\164\x65\x5f\x67\x72\157\x75\160"); goto D8JCr; NpLVr: if (!(!$group_id || empty($group_id))) { goto r7KnI; } goto nqu0q; wIcHC: $this->db->trans_commit(); goto dGMne; nlkZQ: $this->db->delete($this->tables["\165\x73\x65\x72\x73\137\x67\162\x6f\x75\x70\x73"], [$this->join["\147\x72\x6f\x75\x70\x73"] => $group_id]); goto UL292; bx2IF: } public function set_hook($event, $name, $class, $method, $arguments) { goto ADS1l; E8V0C: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto UF5Ye; CWowZ: $this->_ion_hooks->{$event}[$name]->method = $method; goto E8V0C; ADS1l: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto QBiXO; QBiXO: $this->_ion_hooks->{$event}[$name]->class = $class; goto CWowZ; UF5Ye: } public function remove_hook($event, $name) { goto P3V4t; P3V4t: if (!isset($this->_ion_hooks->{$event}[$name])) { goto Cpa7q; } goto vu9ig; vu9ig: unset($this->_ion_hooks->{$event}[$name]); goto nNyFm; nNyFm: Cpa7q: goto ZOtGI; ZOtGI: } public function remove_hooks($event) { goto Bi_yp; Bi_yp: if (!isset($this->_ion_hooks->{$event})) { goto s0YpO; } goto Dquo1; Dquo1: unset($this->_ion_hooks->{$event}); goto upDb3; upDb3: s0YpO: goto hbThv; hbThv: } protected function _call_hook($event, $name) { goto AJRKs; LZQ4g: $hook = $this->_ion_hooks->{$event}[$name]; goto KxtD1; KxtD1: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto MWl2c; KN_cu: return FALSE; goto n0XY0; MWl2c: LqgVS: goto KN_cu; AJRKs: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto LqgVS; } goto LZQ4g; n0XY0: } public function trigger_events($events) { goto XrR21; qgKh6: p4SwH: goto NX1rQ; AJTZH: TcRkR: goto l8MHz; XrR21: if (is_array($events) && !empty($events)) { goto H1Cn7; } goto q1FkA; NX1rQ: goto H2g2n; goto F_z_m; l8MHz: H2g2n: goto YFuO0; R6m1L: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); vRlBs: } goto JsIZb; F_z_m: H1Cn7: goto qDqRS; qDqRS: foreach ($events as $event) { $this->trigger_events($event); aLqMa: } goto AJTZH; JsIZb: Y33_x: goto qgKh6; q1FkA: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto p4SwH; } goto R6m1L; YFuO0: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto tyXeG; IJyAr: $this->message_end_delimiter = $end_delimiter; goto TViQg; TViQg: return TRUE; goto sgbE_; tyXeG: $this->message_start_delimiter = $start_delimiter; goto IJyAr; sgbE_: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto hfcDy; LcWDx: return TRUE; goto bDy0z; iSF_1: $this->error_end_delimiter = $end_delimiter; goto LcWDx; hfcDy: $this->error_start_delimiter = $start_delimiter; goto iSF_1; bDy0z: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto ZHYZ2; ZHYZ2: $_output = ''; goto oeF3f; VxJIp: lH014: goto jwjGJ; jwjGJ: return $_output; goto RJtAg; oeF3f: foreach ($this->messages as $message) { goto mOpnE; vIloY: T10Ai: goto PEDPn; mOpnE: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\43"; goto D2aI7; D2aI7: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto vIloY; PEDPn: } goto VxJIp; RJtAg: } public function messages_array($langify = TRUE) { goto DIhrB; M72JG: DcZOO: goto rHUbN; rHUbN: return $_output; goto uAsb_; FvFEt: tJ5rl: goto mzXU8; bWyDn: goto p79vJ; goto FvFEt; uAsb_: p79vJ: goto Xax2V; mzXU8: $_output = []; goto O3HA0; O3HA0: foreach ($this->messages as $message) { goto EIv_C; x8aCV: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto evn5z; EIv_C: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto x8aCV; evn5z: sm6Hb: goto HvBwF; HvBwF: } goto M72JG; DIhrB: if ($langify) { goto tJ5rl; } goto RgrAW; RgrAW: return $this->messages; goto bWyDn; Xax2V: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto RqnT_; OJ3Xt: return $_output; goto TTJyK; RqnT_: $_output = ''; goto VtVNh; M2Uh2: lZzvD: goto OJ3Xt; VtVNh: foreach ($this->errors as $error) { goto mi5oa; dkHVZ: rxe4r: goto kzlGP; mi5oa: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\43"; goto OoPH6; OoPH6: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto dkHVZ; kzlGP: } goto M2Uh2; TTJyK: } public function errors_array($langify = TRUE) { goto wP1WS; RpmmL: ira8V: goto i5pk0; wP1WS: if ($langify) { goto ira8V; } goto z0Opv; zk4N1: CDNNX: goto QvgXx; t1zp0: goto kkjTT; goto RpmmL; Rjuk_: kkjTT: goto C15jX; z0Opv: return $this->errors; goto t1zp0; kd905: foreach ($this->errors as $error) { goto Qoo4S; Qoo4S: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\43"; goto BK5Oq; BK5Oq: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto P2QQe; P2QQe: a9ant: goto mDZI_; mDZI_: } goto zk4N1; i5pk0: $_output = []; goto kd905; QvgXx: return $_output; goto Rjuk_; C15jX: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto rzsmz; rEq5Q: return FALSE; goto AeWGH; WnlEP: $this->db->update($this->tables["\165\163\145\162\163"], $data, [$this->identity_column => $identity]); goto o16UC; AivYx: $data = ["\x70\x61\x73\x73\x77\x6f\162\144" => $hash, "\162\145\155\x65\x6d\x62\x65\x72\137\143\157\144\x65" => NULL, "\x66\157\x72\147\157\x74\x74\145\x6e\x5f\160\x61\163\163\x77\157\x72\144\x5f\x63\x6f\x64\145" => NULL, "\146\x6f\162\147\x6f\x74\x74\x65\x6e\137\160\141\163\x73\167\157\162\144\x5f\x74\151\x6d\x65" => NULL]; goto hw3tK; IiZux: if (!($hash === FALSE)) { goto E32r4; } goto rEq5Q; hw3tK: $this->trigger_events("\x65\x78\x74\x72\x61\137\167\x68\145\162\x65"); goto WnlEP; o16UC: return $this->db->affected_rows() == 1; goto DMBvZ; rzsmz: $hash = $this->hash_password($password, $identity); goto IiZux; AeWGH: E32r4: goto AivYx; DMBvZ: } protected function _filter_data($table, $data) { goto Ua962; eyR2N: return $filtered_data; goto xiy0U; KJ2tZ: wb9OO: goto n5X8t; Ua962: $filtered_data = []; goto rUR9q; Z2b36: foreach ($columns as $column) { goto Bu4Xn; odJJ0: IsENO: goto tga0e; dngUL: $filtered_data[$column] = $data[$column]; goto odJJ0; Bu4Xn: if (!array_key_exists($column, $data)) { goto IsENO; } goto dngUL; tga0e: JlA2N: goto Rnr0H; Rnr0H: } goto KJ2tZ; CsNGW: if (!is_array($data)) { goto aI3Cm; } goto Z2b36; n5X8t: aI3Cm: goto eyR2N; rUR9q: $columns = $this->db->list_fields($table); goto CsNGW; xiy0U: } protected function _random_token($result_length = 32) { goto m8GB0; B25gA: if (!function_exists("\x6f\x70\x65\156\163\163\x6c\137\162\141\x6e\x64\157\x6d\137\160\163\x65\165\144\x6f\137\x62\x79\x74\145\163")) { goto jiZ5R; } goto jf6oU; iWSWE: return bin2hex(random_bytes($result_length / 2)); goto nCBte; BcGa4: return FALSE; goto OUSpE; ed0Dj: KAvt1: goto B25gA; kjoio: if (!function_exists("\x6d\143\162\171\x70\164\x5f\143\162\x65\x61\164\x65\137\151\166")) { goto KAvt1; } goto RznWA; jf6oU: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto i1t4t; HFfpg: if (!function_exists("\162\x61\x6e\144\x6f\x6d\137\x62\171\x74\145\x73")) { goto IPH_5; } goto iWSWE; i1t4t: jiZ5R: goto BcGa4; nCBte: IPH_5: goto kjoio; RznWA: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto ed0Dj; SvzJH: $result_length = 32; goto jpySe; jpySe: OV4i8: goto HFfpg; m8GB0: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto OV4i8; } goto SvzJH; OUSpE: } protected function _get_hash_parameters($identity = NULL) { goto GKAyN; DGxm5: $params = FALSE; goto Qil57; gJrjb: RPRh7: goto FvN7z; dUkrq: fH54k: goto DGxm5; Qil57: switch ($this->hash_method) { case "\x62\143\x72\x79\x70\164": $params = ["\143\x6f\x73\x74" => $is_admin ? $this->config->item("\x62\x63\162\x79\x70\x74\137\x61\144\155\x69\x6e\137\x63\157\163\x74", "\151\x6f\x6e\x5f\x61\165\x74\150") : $this->config->item("\142\143\x72\x79\x70\164\137\x64\x65\x66\141\165\154\x74\137\143\x6f\163\x74", "\x69\157\x6e\x5f\141\x75\164\150")]; goto HaehY; case "\141\162\x67\157\156\62": $params = $is_admin ? $this->config->item("\141\162\147\x6f\x6e\x32\137\141\144\155\151\156\x5f\160\x61\x72\141\155\163", "\151\x6f\x6e\x5f\x61\x75\x74\x68") : $this->config->item("\141\x72\147\157\156\62\137\x64\x65\146\141\165\x6c\x74\x5f\x70\x61\x72\x61\x6d\x73", "\x69\x6f\x6e\137\141\x75\164\x68"); goto HaehY; default: } goto gJrjb; hns6t: if (!($user_id && $this->in_group($this->config->item("\141\144\155\x69\x6e\137\147\162\x6f\x75\x70", "\x69\x6f\x6e\x5f\141\165\x74\150"), $user_id))) { goto ziFIM; } goto qGYTI; mP6VZ: $user_id = $this->get_user_id_from_identity($identity); goto hns6t; GxLK1: return $params; goto yo_uJ; FvN7z: HaehY: goto GxLK1; qGYTI: $is_admin = TRUE; goto MnGzb; MnGzb: ziFIM: goto dUkrq; GKAyN: $is_admin = FALSE; goto ucJDd; ucJDd: if (!$identity) { goto fH54k; } goto mP6VZ; yo_uJ: } protected function _get_hash_algo() { goto EBk0Q; b_XCp: return $algo; goto PMxNZ; EBk0Q: $algo = FALSE; goto ww1UJ; ww1UJ: switch ($this->hash_method) { case "\x62\x63\162\171\160\164": $algo = PASSWORD_BCRYPT; goto mjy4e; case "\x61\162\x67\157\156\x32": $algo = PASSWORD_ARGON2I; goto mjy4e; default: } goto CfAIA; CfAIA: jwhMx: goto sj986; sj986: mjy4e: goto b_XCp; PMxNZ: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto Ah1WD; lKB5_: return (object) ["\163\x65\x6c\x65\143\x74\157\x72" => $selector, "\x76\x61\x6c\x69\x64\141\164\157\x72\137\150\x61\x73\x68\x65\x64" => $validator_hashed, "\165\163\x65\x72\x5f\x63\x6f\x64\145" => $user_code]; goto n11C9; rqMok: $validator = $this->_random_token($validator_size); goto cBS_L; cBS_L: $validator_hashed = $this->hash_password($validator); goto fmKg0; fmKg0: $user_code = "{$selector}\56{$validator}"; goto lKB5_; Ah1WD: $selector = $this->_random_token($selector_size); goto rqMok; n11C9: } protected function _retrieve_selector_validator_couple($user_code) { goto diUgR; YqI_0: $tokens = explode("\56", $user_code); goto gDSIJ; Xlpw9: Zwcih: goto mD4uH; bvFx5: OOBfs: goto Xlpw9; Pki4K: return (object) ["\x73\145\154\145\143\164\x6f\162" => $tokens[0], "\166\x61\x6c\x69\144\141\x74\x6f\x72" => $tokens[1]]; goto bvFx5; mD4uH: return FALSE; goto QyLGj; diUgR: if (!$user_code) { goto Zwcih; } goto YqI_0; gDSIJ: if (!(count($tokens) === 2)) { goto OOBfs; } goto Pki4K; QyLGj: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto QYrDQ; YNE5x: $hashed_password = sha1($password . $salt_db->salt); goto G43F9; BRNOn: return FALSE; goto bMUK6; KP39w: return FALSE; goto pkieT; UJMUB: goto ufIMD; goto bSS7h; pkieT: ETosp: goto YNE5x; EVv_z: $this->trigger_events(["\160\x6f\163\x74\137\x73\x68\x61\61\137\x70\141\x73\x73\167\157\162\144\137\155\151\x67\162\x61\164\x69\157\x6e", "\x70\157\x73\x74\x5f\163\150\141\x31\137\160\x61\163\163\x77\x6f\162\144\137\155\x69\147\162\141\164\151\x6f\156\x5f\165\x6e\x73\x75\x63\143\145\163\x73\x66\x75\154"]); goto BRNOn; kSc0N: ufIMD: goto kwfO5; DuX_o: goto FVaax; goto j35NK; Qps5h: teidO: goto AzW_z; QYrDQ: $this->trigger_events("\160\x72\x65\x5f\x73\150\x61\x31\137\160\141\163\x73\x77\157\x72\144\x5f\155\151\147\x72\141\164\151\157\x6e"); goto aX5IS; aX5IS: if ($this->config->item("\163\164\x6f\162\145\x5f\x73\x61\154\x74", "\x69\157\x6e\137\x61\165\x74\150")) { goto M1vgY; } goto O90in; G43F9: FVaax: goto FSny8; AN71R: dbO1J: goto Vknpw; sw9Qb: if ($salt_length) { goto qKcXc; } goto bXB3L; Y9mNR: $this->trigger_events(["\x70\x6f\163\164\137\x73\150\141\x31\137\x70\141\163\x73\167\x6f\162\x64\137\155\151\x67\162\141\x74\151\x6f\x6e", "\x70\157\x73\x74\137\163\150\141\61\x5f\x70\141\x73\x73\167\x6f\162\144\x5f\x6d\151\147\162\x61\164\x69\157\x6e\137\x73\x75\143\143\145\163\163\x66\165\154"]); goto kSc0N; bMUK6: goto teidO; goto AN71R; Vknpw: $result = $this->_set_password_db($identity, $password); goto WcPHi; j35NK: M1vgY: goto TzB6a; O90in: $salt_length = $this->config->item("\x73\x61\154\x74\137\x6c\145\156\147\164\150", "\x69\x6f\156\137\x61\x75\164\150"); goto sw9Qb; fU0W3: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto DuX_o; N271_: $salt_db = $query->row(); goto nIe0Z; Gh3i1: return FALSE; goto UsbH0; nIe0Z: if (!($query->num_rows() !== 1)) { goto ETosp; } goto Uqrfu; bSS7h: z87I8: goto Y9mNR; FSny8: if ($hashed_password === $hashed_password_db) { goto dbO1J; } goto EVv_z; WcPHi: if ($result) { goto z87I8; } goto sF1Cn; TzB6a: $query = $this->db->select("\x73\x61\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto N271_; bXB3L: $this->trigger_events(["\x70\x6f\163\164\137\x73\150\x61\x31\x5f\x70\141\163\163\167\157\162\x64\x5f\x6d\151\147\162\x61\x74\x69\157\156", "\x70\x6f\x73\x74\137\x73\150\141\x31\x5f\160\x61\163\x73\x77\157\x72\x64\137\155\x69\147\162\141\x74\151\157\x6e\137\165\156\x73\165\143\x63\x65\163\x73\x66\165\x6c"]); goto Gh3i1; UsbH0: qKcXc: goto qz_lY; kwfO5: return $result; goto Qps5h; sF1Cn: $this->trigger_events(["\x70\x6f\x73\164\137\x73\150\141\61\x5f\160\141\163\163\167\x6f\x72\x64\x5f\155\x69\147\162\141\164\x69\x6f\156", "\x70\157\x73\164\137\x73\x68\141\x31\x5f\160\x61\x73\163\x77\157\x72\x64\137\155\151\147\x72\x61\164\151\157\156\x5f\x75\156\163\x75\143\x63\145\163\x73\146\165\x6c"]); goto UJMUB; qz_lY: $salt = substr($hashed_password_db, 0, $salt_length); goto fU0W3; Uqrfu: $this->trigger_events(["\x70\x6f\163\164\x5f\x73\150\x61\61\x5f\x70\141\x73\x73\167\157\x72\144\137\x6d\151\x67\162\x61\x74\x69\157\156", "\x70\x6f\163\164\x5f\x73\x68\x61\61\x5f\160\x61\163\163\x77\157\162\x64\137\155\151\x67\x72\x61\x74\151\x6f\156\137\165\156\x73\165\143\143\x65\163\163\x66\165\154"]); goto KP39w; AzW_z: } }
