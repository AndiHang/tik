<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\x50\101\x54\x48") or exit("\116\x6f\x20\x64\x69\162\x65\143\x74\40\x73\143\x72\x69\x70\x74\40\141\x63\x63\145\163\x73\40\x61\154\x6c\157\167\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto KkPwM; b2jZV: IrnW2: goto N0e4x; KkPwM: $this->config->load("\x69\157\x6e\137\x61\165\x74\x68", TRUE); goto I902f; ieANb: $this->message_start_delimiter = $this->config->item("\155\x65\x73\163\x61\147\x65\137\x73\164\x61\x72\x74\x5f\144\145\154\x69\155\151\164\x65\x72", "\151\157\x6e\x5f\x61\165\164\x68"); goto GqAF5; EGip4: $group_name = $this->config->item("\144\x61\x74\x61\x62\x61\163\145\x5f\x67\162\x6f\165\x70\137\156\x61\155\145", "\151\x6f\156\137\141\165\x74\x68"); goto NNGnt; NNGnt: if (empty($group_name)) { goto zeRGG; } goto k16Wo; QB0j2: $this->hash_method = $this->config->item("\150\x61\163\150\x5f\x6d\145\164\150\x6f\144", "\151\157\x6e\x5f\x61\x75\x74\150"); goto PCaI1; l1EpB: goto v_Yy7; goto pWUgw; I902f: $this->load->helper("\x63\x6f\x6f\153\151\x65"); goto E2EqN; qM_R3: $this->_ion_hooks = new stdClass(); goto HLeFe; N0e4x: $this->load->library("\146\157\162\x6d\137\x76\141\x6c\x69\144\141\164\151\x6f\x6e"); goto Qbf5x; YalQa: $error_prefix = $form_validation_class->getProperty("\137\145\x72\162\157\162\137\x70\162\145\146\x69\x78"); goto p3QXm; aUiX9: $this->db = $CI->db; goto Pqy4s; HLeFe: $this->trigger_events("\155\x6f\x64\x65\154\137\x63\x6f\x6e\163\164\x72\x75\143\164\x6f\x72"); goto RXzcd; lGdni: $this->join = $this->config->item("\152\157\151\156", "\151\157\x6e\x5f\141\x75\x74\150"); goto QB0j2; jJ1TN: $error_suffix = $form_validation_class->getProperty("\137\x65\x72\162\157\x72\x5f\x73\165\146\146\151\x78"); goto XB1sU; m0VXQ: if ($delimiters_source === "\146\x6f\162\x6d\x5f\x76\141\x6c\x69\x64\141\164\151\157\x6e") { goto IrnW2; } goto ieANb; iwrgQ: A5zFU: goto qM_R3; XB1sU: $error_suffix->setAccessible(TRUE); goto Fpr4G; z9ffr: $CI =& get_instance(); goto aUiX9; Pqy4s: v_Yy7: goto cWP1V; GqAF5: $this->message_end_delimiter = $this->config->item("\x6d\145\163\x73\x61\x67\145\137\x65\156\x64\x5f\144\x65\154\151\155\x69\x74\145\162", "\x69\157\156\137\141\165\x74\x68"); goto dc8qA; p3QXm: $error_prefix->setAccessible(TRUE); goto qaYC2; dc8qA: $this->error_start_delimiter = $this->config->item("\145\162\162\157\x72\137\163\164\x61\162\164\x5f\x64\145\x6c\x69\155\x69\x74\x65\162", "\x69\x6f\x6e\137\x61\x75\164\150"); goto g0Pd1; Qbf5x: $form_validation_class = new ReflectionClass("\x43\x49\x5f\x46\x6f\x72\155\137\x76\141\154\x69\144\x61\x74\x69\157\x6e"); goto YalQa; pWUgw: zeRGG: goto z9ffr; cWP1V: $this->tables = $this->config->item("\x74\x61\x62\154\x65\x73", "\151\x6f\156\x5f\141\165\x74\150"); goto wBfPi; k16Wo: $this->db = $this->load->database($group_name, TRUE, TRUE); goto l1EpB; E2EqN: $this->load->helper("\x64\x61\164\145"); goto kNS9D; g0Pd1: $this->error_end_delimiter = $this->config->item("\x65\162\x72\x6f\x72\x5f\x65\156\144\x5f\x64\145\154\x69\x6d\x69\x74\x65\x72", "\x69\x6f\x6e\x5f\141\165\x74\x68"); goto Dast9; qaYC2: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto Bdc_d; Fpr4G: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto dqr64; yPZsb: $this->errors = []; goto ZIUtZ; Dast9: goto A5zFU; goto b2jZV; dqr64: $this->message_end_delimiter = $this->error_end_delimiter; goto iwrgQ; PCaI1: $this->messages = []; goto yPZsb; wBfPi: $this->identity_column = $this->config->item("\151\x64\x65\156\164\151\x74\171", "\151\157\x6e\x5f\x61\165\164\x68"); goto lGdni; ZIUtZ: $delimiters_source = $this->config->item("\x64\x65\154\151\x6d\151\164\145\162\x73\x5f\x73\x6f\x75\x72\143\x65", "\151\157\156\137\141\x75\x74\x68"); goto m0VXQ; Bdc_d: $this->message_start_delimiter = $this->error_start_delimiter; goto jJ1TN; kNS9D: $this->lang->load("\151\x6f\156\x5f\x61\165\164\x68"); goto EGip4; RXzcd: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto x1m4g; U63bS: D5ybX: goto SlzSl; j0rZO: return FALSE; goto U63bS; NWoha: $params = $this->_get_hash_parameters($identity); goto xhiPv; x1m4g: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto D5ybX; } goto j0rZO; SlzSl: $algo = $this->_get_hash_algo(); goto NWoha; xhiPv: if (!($algo !== FALSE && $params !== FALSE)) { goto rcR66; } goto Br2qq; CT7bP: rcR66: goto coLbO; coLbO: return FALSE; goto Cqn7Z; Br2qq: return password_hash($password, $algo, $params); goto CT7bP; Cqn7Z: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto BTseX; TEtPS: po8I0: goto gxbsR; gxbsR: if (strpos($hash_password_db, "\x24") === 0) { goto B7gbo; } goto FcO9O; BTseX: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto po8I0; } goto uUNEq; fG3su: EyLy3: goto w5PV4; FcO9O: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto UIgTB; UIgTB: goto EyLy3; goto u1DnP; u1DnP: B7gbo: goto UwkQF; UwkQF: return password_verify($password, $hash_password_db); goto fG3su; uUNEq: return FALSE; goto TEtPS; w5PV4: } public function rehash_password_if_needed($hash, $identity, $password) { goto vJrfA; YI4jB: NyBYD: goto ifjXc; KUBA6: goto GAfWl; goto YI4jB; HzCMq: I9IE2: goto r8Qse; r8Qse: qFFCV: goto WGtjb; Vc7HW: if ($this->_set_password_db($identity, $password)) { goto NyBYD; } goto HFOBS; ggOil: if (!($algo !== FALSE && $params !== FALSE)) { goto qFFCV; } goto g2NAh; HFOBS: $this->trigger_events(["\162\x65\x68\x61\x73\150\137\160\141\163\x73\167\x6f\x72\x64", "\x72\145\x68\141\x73\x68\137\160\141\163\163\167\157\162\144\137\165\156\163\165\x63\143\145\163\163\146\165\x6c"]); goto KUBA6; g2NAh: if (!password_needs_rehash($hash, $algo, $params)) { goto I9IE2; } goto Vc7HW; jGTkx: $params = $this->_get_hash_parameters($identity); goto ggOil; vJrfA: $algo = $this->_get_hash_algo(); goto jGTkx; TY6D5: GAfWl: goto HzCMq; ifjXc: $this->trigger_events(["\162\x65\150\x61\x73\x68\137\x70\141\x73\x73\167\157\x72\144", "\x72\x65\x68\141\163\x68\x5f\x70\x61\163\x73\167\x6f\x72\144\x5f\x73\x75\x63\143\145\163\x73\146\x75\x6c"]); goto TY6D5; WGtjb: } public function get_user_by_activation_code($user_code) { goto nMDUh; nMDUh: $token = $this->_retrieve_selector_validator_couple($user_code); goto VooTk; DcUgS: hubLg: goto ANHfx; ETdRd: yhM5h: goto DcUgS; VooTk: $user = $this->where("\141\143\x74\x69\166\141\x74\151\x6f\156\x5f\163\145\154\x65\143\x74\x6f\x72", $token->selector)->users()->row(); goto N57Ak; N57Ak: if (!$user) { goto hubLg; } goto RZYxi; hQuen: return $user; goto ETdRd; ANHfx: return FALSE; goto l4jEE; RZYxi: if (!$this->verify_password($token->validator, $user->activation_code)) { goto yhM5h; } goto hQuen; l4jEE: } public function activate($id, $code = FALSE) { goto XJSgd; Xs3_d: $this->set_message("\141\x63\x74\151\166\141\164\x65\x5f\163\x75\143\143\x65\163\x73\146\x75\154"); goto EaVRj; DeNM8: if (!($code === FALSE || $user && $user->id === $id)) { goto sOepH; } goto bbbOo; EaVRj: return TRUE; goto WQBYP; DDz0E: sOepH: goto BQrn0; bbbOo: $data = ["\141\143\x74\x69\x76\x61\164\x69\x6f\156\137\163\x65\154\x65\143\x74\157\162" => NULL, "\141\x63\x74\151\x76\x61\x74\x69\x6f\156\137\x63\x6f\144\145" => NULL, "\141\143\164\151\x76\x65" => 1]; goto POmU8; BQrn0: $this->trigger_events(["\160\x6f\163\164\x5f\141\143\x74\x69\166\141\164\x65", "\160\157\163\164\x5f\x61\143\x74\x69\166\141\x74\x65\x5f\165\156\x73\x75\143\x63\145\163\163\146\x75\154"]); goto FKqvC; Tg33H: return FALSE; goto z9SfE; POmU8: $this->trigger_events("\x65\x78\x74\162\141\x5f\167\150\x65\x72\x65"); goto LNmYK; t29gm: $user = $this->get_user_by_activation_code($code); goto WDMsT; oUrjm: $this->trigger_events(["\160\157\x73\164\x5f\141\143\x74\151\x76\x61\x74\145", "\x70\157\x73\x74\x5f\141\x63\164\x69\166\141\x74\x65\x5f\163\x75\143\143\145\x73\x73\x66\165\154"]); goto Xs3_d; WQBYP: Ao_WZ: goto DDz0E; XJSgd: $this->trigger_events("\160\x72\x65\x5f\x61\143\x74\151\x76\x61\x74\145"); goto xAf_z; xAf_z: if (!($code !== FALSE)) { goto Y1zIi; } goto t29gm; FKqvC: $this->set_error("\141\143\164\151\x76\141\x74\145\x5f\x75\156\x73\165\143\x63\x65\x73\x73\146\x75\154"); goto Tg33H; gn3Pf: if (!($this->db->affected_rows() === 1)) { goto Ao_WZ; } goto oUrjm; LNmYK: $this->db->update($this->tables["\165\163\x65\162\163"], $data, ["\x69\x64" => $id]); goto gn3Pf; WDMsT: Y1zIi: goto DeNM8; z9SfE: } public function deactivate($id = NULL) { goto r21hD; weXxE: j0j5L: goto OiSTv; NAafg: fCAxT: goto ICDkh; UFyKv: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto t_2IG; } goto A1S3n; r21hD: $this->trigger_events("\144\x65\x61\143\x74\151\x76\141\164\145"); goto FhBHW; OiSTv: $this->set_message("\x64\145\141\x63\x74\151\166\x61\x74\x65\x5f\x73\165\x63\x63\x65\x73\x73\146\165\154"); goto sCrvE; zbB_y: return $return; goto QntUR; dvhF1: return FALSE; goto LZiQr; xfQdJ: $this->set_error("\144\x65\141\x63\164\151\166\141\164\145\137\x75\x6e\x73\165\143\x63\145\x73\163\146\x75\154"); goto oyiPX; hporp: goto iL6lT; goto NAafg; oyiPX: goto bsW5X; goto weXxE; E86Bx: $data = ["\141\143\x74\151\166\x61\x74\x69\157\156\x5f\x73\145\154\x65\143\x74\x6f\162" => $token->selector, "\x61\143\x74\x69\x76\x61\x74\x69\x6f\156\x5f\143\157\x64\145" => $token->validator_hashed, "\x61\x63\x74\x69\166\145" => 0]; goto bkZvY; sCrvE: bsW5X: goto zbB_y; CzfGV: $this->activation_code = $token->user_code; goto E86Bx; CdPSp: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $data, ["\x69\x64" => $id]); goto yvox3; k3UiB: t_2IG: goto hporp; AC2Nl: if ($return) { goto j0j5L; } goto xfQdJ; Y3bWB: return FALSE; goto k3UiB; bkZvY: $this->trigger_events("\x65\x78\164\x72\x61\137\x77\x68\145\x72\145"); goto CdPSp; FhBHW: if (!isset($id)) { goto fCAxT; } goto UFyKv; ImN3f: $token = $this->_generate_selector_validator_couple(20, 40); goto CzfGV; ICDkh: $this->set_error("\x64\145\141\143\164\151\166\141\164\x65\x5f\165\156\x73\x75\143\143\x65\x73\x73\146\165\x6c"); goto dvhF1; yvox3: $return = $this->db->affected_rows() == 1; goto AC2Nl; A1S3n: $this->set_error("\144\x65\x61\x63\164\151\x76\141\x74\x65\x5f\143\165\x72\x72\x65\x6e\x74\137\165\163\x65\x72\x5f\x75\x6e\x73\165\143\143\145\163\x73\146\165\x6c"); goto Y3bWB; LZiQr: iL6lT: goto ImN3f; QntUR: } public function clear_forgotten_password_code($identity) { goto PRGha; Ll_Vq: return FALSE; goto sefSX; HbaOL: $this->db->update($this->tables["\165\163\x65\x72\163"], $data, [$this->identity_column => $identity]); goto oGGI6; sefSX: IxKfn: goto Xur9W; Xur9W: $data = ["\146\x6f\162\147\157\x74\x74\x65\156\x5f\160\141\x73\x73\x77\157\x72\x64\137\163\145\154\145\x63\x74\x6f\x72" => NULL, "\x66\157\162\147\157\x74\164\145\156\137\160\x61\163\163\167\x6f\x72\x64\137\143\x6f\144\145" => NULL, "\146\x6f\162\x67\157\x74\164\x65\156\x5f\x70\x61\x73\163\x77\157\x72\144\137\x74\151\155\x65" => NULL]; goto HbaOL; oGGI6: return TRUE; goto mi5pQ; PRGha: if (!empty($identity)) { goto IxKfn; } goto Ll_Vq; mi5pQ: } public function clear_remember_code($identity) { goto OBevu; vfjMO: $this->db->update($this->tables["\x75\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto oDOHn; xXC1f: return FALSE; goto CHHTr; CHHTr: xb6Zb: goto IkkBW; oDOHn: return TRUE; goto LVgkI; OBevu: if (!empty($identity)) { goto xb6Zb; } goto xXC1f; IkkBW: $data = ["\162\145\155\145\155\x62\145\x72\x5f\163\145\x6c\145\x63\x74\x6f\162" => NULL, "\x72\x65\x6d\145\x6d\x62\145\x72\x5f\x63\157\x64\145" => NULL]; goto vfjMO; LVgkI: } public function reset_password($identity, $new) { goto PmLnk; dryU2: $this->trigger_events(["\x70\157\x73\164\x5f\x63\150\141\156\x67\145\x5f\x70\x61\163\163\x77\x6f\x72\144", "\160\157\x73\x74\137\143\150\141\x6e\147\145\x5f\x70\141\x73\163\x77\157\x72\144\137\163\x75\x63\x63\145\163\163\146\x75\154"]); goto T7Coj; LSSln: wLnlv: goto kjcF1; OYQrj: goto wLnlv; goto PPFXi; CaDvX: $this->set_error("\x70\141\x73\x73\167\157\162\x64\137\143\150\x61\156\147\x65\137\165\156\x73\x75\143\143\x65\163\163\146\x75\x6c"); goto OYQrj; Nt_rE: $this->trigger_events(["\x70\157\163\164\x5f\143\x68\x61\x6e\x67\145\137\x70\x61\x73\163\167\x6f\x72\144", "\160\157\163\164\137\143\150\141\156\x67\x65\x5f\x70\141\x73\163\x77\x6f\162\144\x5f\165\x6e\x73\x75\143\143\145\163\163\x66\165\154"]); goto oGbRI; PmLnk: $this->trigger_events("\160\x72\x65\x5f\x63\x68\x61\x6e\x67\145\137\x70\x61\163\x73\167\157\x72\x64"); goto MmNVC; T7Coj: $this->set_message("\160\x61\163\163\x77\x6f\162\x64\137\x63\x68\x61\x6e\x67\x65\x5f\163\165\143\x63\145\x73\x73\x66\165\x6c"); goto LSSln; HNXpF: if ($return) { goto gH1fg; } goto NIj2I; JYJSr: $return = $this->_set_password_db($identity, $new); goto HNXpF; oGbRI: return FALSE; goto b1GoD; PPFXi: gH1fg: goto dryU2; MmNVC: if ($this->identity_check($identity)) { goto zAHU2; } goto Nt_rE; b1GoD: zAHU2: goto JYJSr; NIj2I: $this->trigger_events(["\160\x6f\x73\x74\x5f\x63\150\141\156\x67\145\x5f\160\x61\x73\163\167\157\162\x64", "\x70\x6f\163\x74\x5f\143\150\x61\x6e\x67\145\x5f\160\x61\x73\163\167\157\x72\144\137\165\156\x73\165\x63\143\x65\x73\x73\x66\x75\154"]); goto CaDvX; kjcF1: return $return; goto z3HSQ; z3HSQ: } public function change_password($identity, $old, $new) { goto JITW0; vrLb5: if (!$this->verify_password($old, $user->password, $identity)) { goto dU3w5; } goto xfepc; OSMf_: ukQk4: goto l7sWe; o_gFJ: $this->set_error("\160\141\163\x73\167\157\x72\x64\137\x63\x68\141\156\147\x65\x5f\x75\x6e\163\x75\143\x63\145\163\163\146\165\154"); goto APDLR; AB0yC: if (!($query->num_rows() !== 1)) { goto Zt_P0; } goto VLAcQ; PRgBR: dU3w5: goto RKGKt; UFDWV: $this->set_error("\x70\141\163\x73\167\x6f\162\144\137\x63\x68\141\156\147\x65\x5f\165\x6e\163\165\x63\143\145\x73\x73\x66\x75\154"); goto n1QJ6; ZkB2s: Zt_P0: goto FB5sk; PB05b: if ($result) { goto ukQk4; } goto FbDAW; APDLR: return FALSE; goto ZkB2s; VLAcQ: $this->trigger_events(["\x70\157\163\x74\137\x63\x68\141\156\147\145\x5f\x70\141\163\x73\167\157\162\x64", "\160\x6f\x73\164\x5f\143\150\141\156\x67\x65\x5f\x70\x61\163\x73\x77\x6f\x72\x64\137\165\156\163\x75\x63\143\x65\x73\x73\x66\x75\x6c"]); goto o_gFJ; gLQg8: nEhkL: goto U3_z8; U3_z8: return $result; goto PRgBR; g5GZ3: $this->set_message("\x70\x61\x73\x73\167\x6f\162\144\137\143\150\141\156\147\145\137\x73\165\143\143\x65\163\163\146\x75\154"); goto gLQg8; l7sWe: $this->trigger_events(["\160\x6f\x73\x74\137\x63\150\141\156\x67\x65\137\x70\x61\163\163\167\x6f\x72\144", "\x70\157\163\x74\137\143\150\141\x6e\147\x65\137\x70\x61\163\163\x77\157\x72\x64\x5f\x73\x75\x63\143\x65\163\163\146\x75\154"]); goto g5GZ3; FbDAW: $this->trigger_events(["\160\x6f\x73\164\x5f\143\x68\141\156\147\145\137\160\x61\163\163\x77\x6f\x72\x64", "\160\157\163\x74\137\143\x68\x61\x6e\x67\145\x5f\x70\141\163\163\167\157\162\x64\137\x75\156\163\x75\143\x63\x65\163\x73\x66\x75\x6c"]); goto UFDWV; Y5wBd: $this->trigger_events("\x65\x78\164\x72\141\x5f\167\x68\145\x72\x65"); goto FGtMA; xfepc: $result = $this->_set_password_db($identity, $new); goto PB05b; RKGKt: $this->set_error("\160\x61\x73\163\167\x6f\162\144\x5f\x63\x68\x61\x6e\147\x65\137\x75\x6e\x73\165\x63\143\145\163\163\146\165\154"); goto GADTF; GADTF: return FALSE; goto Co0zo; FGtMA: $query = $this->db->select("\151\144\54\x20\160\141\x73\163\x77\x6f\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\x73\143")->get($this->tables["\165\163\145\x72\x73"]); goto AB0yC; FB5sk: $user = $query->row(); goto vrLb5; n1QJ6: goto nEhkL; goto OSMf_; JITW0: $this->trigger_events("\x70\162\145\137\x63\150\141\156\x67\145\x5f\160\x61\163\163\167\x6f\x72\x64"); goto Y5wBd; Co0zo: } public function username_check($username = '') { goto JUwR6; DcYQL: return $this->db->where("\165\163\x65\162\156\x61\x6d\145", $username)->limit(1)->count_all_results($this->tables["\x75\163\145\162\163"]) > 0; goto KeIKx; HJ5gy: aqIeI: goto K5JZL; A7Wb4: if (!empty($username)) { goto aqIeI; } goto vdaeh; vdaeh: return FALSE; goto HJ5gy; JUwR6: $this->trigger_events("\165\163\x65\162\156\x61\x6d\145\x5f\x63\x68\145\x63\x6b"); goto A7Wb4; K5JZL: $this->trigger_events("\145\170\x74\162\x61\x5f\x77\x68\145\x72\145"); goto DcYQL; KeIKx: } public function email_check($email = '') { goto dKzxR; dKzxR: $this->trigger_events("\x65\155\141\x69\154\x5f\x63\x68\145\143\153"); goto dB9DQ; tIQ6w: return FALSE; goto E50Dv; IsH4Y: return $this->db->where("\145\x6d\141\151\154", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\x73"]) > 0; goto boMXL; aY_MY: $this->trigger_events("\145\170\164\162\x61\137\167\x68\145\162\x65"); goto IsH4Y; dB9DQ: if (!empty($email)) { goto OvXfJ; } goto tIQ6w; E50Dv: OvXfJ: goto aY_MY; boMXL: } public function identity_check($identity = '') { goto ckyvF; HOzQ3: if (!empty($identity)) { goto I4RSR; } goto lSG94; ckyvF: $this->trigger_events("\151\x64\145\156\x74\x69\164\171\x5f\143\150\x65\x63\153"); goto HOzQ3; SaSUH: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\x73"]) > 0; goto k6D3n; lSG94: return FALSE; goto dibGq; dibGq: I4RSR: goto SaSUH; k6D3n: } public function get_user_id_from_identity($identity = '') { goto QSZhL; jCGtz: return FALSE; goto YRdnV; Z322g: $user = $query->row(); goto p5Jlf; EW0sw: if (!($query->num_rows() !== 1)) { goto SbcxZ; } goto jCGtz; ICoVF: return FALSE; goto H6ENd; QSZhL: if (!empty($identity)) { goto n45eT; } goto ICoVF; H6ENd: n45eT: goto IlHwF; YRdnV: SbcxZ: goto Z322g; p5Jlf: return $user->id; goto pO7h5; IlHwF: $query = $this->db->select("\x69\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto EW0sw; pO7h5: } public function forgotten_password($identity) { goto p7wYH; zbvsB: $this->db->update($this->tables["\x75\163\145\x72\x73"], $update, [$this->identity_column => $identity]); goto op8W1; PiNfU: return FALSE; goto AefTF; Jjugd: return FALSE; goto z03sn; SkY4C: FATsd: goto an6B0; pgBtA: return $token->user_code; goto SkY4C; L4Z0V: $update = ["\x66\157\x72\x67\157\164\x74\x65\156\x5f\x70\141\163\x73\x77\157\162\x64\137\163\145\154\145\143\x74\x6f\162" => $token->selector, "\146\x6f\162\x67\x6f\164\164\145\x6e\x5f\160\141\x73\163\167\x6f\x72\x64\x5f\143\x6f\x64\145" => $token->validator_hashed, "\x66\x6f\x72\x67\x6f\x74\x74\145\156\x5f\x70\141\x73\163\167\157\162\x64\x5f\x74\x69\x6d\145" => time()]; goto KSyPx; z03sn: ZCucb: goto wSokh; op8W1: if ($this->db->affected_rows() === 1) { goto W3bdh; } goto GJTow; sDDaC: $this->trigger_events(["\x70\157\x73\x74\137\x66\x6f\162\x67\x6f\x74\x74\145\x6e\x5f\160\x61\163\163\167\157\x72\144", "\160\157\163\x74\137\146\157\162\x67\157\164\x74\x65\x6e\137\160\141\x73\x73\x77\x6f\x72\144\x5f\x73\165\x63\x63\145\x73\x73\146\165\x6c"]); goto pgBtA; p7wYH: if (!empty($identity)) { goto ZCucb; } goto qxZI0; wSokh: $token = $this->_generate_selector_validator_couple(20, 80); goto L4Z0V; Qotoz: W3bdh: goto sDDaC; AefTF: goto FATsd; goto Qotoz; KSyPx: $this->trigger_events("\x65\x78\164\162\141\x5f\x77\x68\145\x72\145"); goto zbvsB; qxZI0: $this->trigger_events(["\x70\157\163\164\x5f\146\157\x72\x67\x6f\164\x74\x65\156\137\160\141\x73\163\167\157\x72\144", "\x70\x6f\x73\x74\137\146\x6f\x72\x67\157\x74\164\145\156\137\160\x61\163\163\167\x6f\162\144\137\x75\x6e\x73\165\x63\x63\145\163\x73\146\165\x6c"]); goto Jjugd; GJTow: $this->trigger_events(["\x70\157\163\x74\137\146\x6f\x72\147\x6f\164\x74\145\x6e\x5f\160\x61\163\x73\167\157\162\x64", "\x70\157\x73\164\137\146\157\x72\x67\x6f\x74\x74\x65\x6e\x5f\160\141\163\x73\x77\x6f\x72\x64\137\x75\x6e\x73\x75\143\143\x65\163\x73\x66\165\154"]); goto PiNfU; an6B0: } public function get_user_by_forgotten_password_code($user_code) { goto tBHvJ; p2ywp: cSPbR: goto aO6nN; ZD3ug: return FALSE; goto SEyUR; aO6nN: G_sJ0: goto ZD3ug; U8zmM: $user = $this->where("\146\157\x72\x67\157\x74\164\145\x6e\x5f\160\x61\x73\163\x77\x6f\162\x64\x5f\163\145\x6c\145\143\x74\x6f\x72", $token->selector)->users()->row(); goto bs0At; bBS2y: return $user; goto p2ywp; tzmjs: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto cSPbR; } goto bBS2y; bs0At: if (!$user) { goto G_sJ0; } goto tzmjs; tBHvJ: $token = $this->_retrieve_selector_validator_couple($user_code); goto U8zmM; SEyUR: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto jdwnp; ovU5L: $this->db->insert($this->tables["\165\163\145\x72\x73"], $user_data); goto c86D3; jdwnp: $this->trigger_events("\160\x72\145\x5f\x72\x65\x67\151\163\x74\145\x72"); goto kixtX; kixtX: $manual_activation = $this->config->item("\155\141\x6e\x75\141\154\x5f\141\x63\x74\151\x76\x61\x74\x69\157\x6e", "\151\157\x6e\137\x61\165\x74\150"); goto S2jwo; SvFkb: HW17O: goto KlmgG; ZdiJ9: if (!($password === FALSE)) { goto pULcy; } goto AtgPF; N3pTr: xmxvH: goto WvfZb; WvfZb: goto HW17O; goto eOUrb; AtgPF: $this->set_error("\x61\143\x63\x6f\x75\x6e\164\x5f\x63\162\x65\x61\164\151\157\x6e\137\x75\x6e\x73\165\143\x63\145\x73\163\146\165\154"); goto ACm21; DPK64: $this->trigger_events("\160\x6f\x73\164\x5f\162\x65\147\151\x73\164\x65\x72"); goto cnGu5; c86D3: $id = $this->db->insert_id($this->tables["\165\163\x65\x72\163"] . "\137\x69\144\x5f\163\x65\x71"); goto ecjns; DzPkA: $default_group = $query; goto GLVZk; eOUrb: qFO3z: goto Uknx_; p3AX7: return FALSE; goto Y_Mmo; jzXz2: $password = $this->hash_password($password); goto ZdiJ9; S2jwo: if ($this->identity_check($identity)) { goto qFO3z; } goto GqVpL; xBE_a: jWKoK: goto DPK64; Y_Mmo: E6A9x: goto DzPkA; WHv6w: pULcy: goto n3yP0; uFYgE: $this->set_error("\x61\x63\143\x6f\165\156\x74\137\143\x72\145\141\x74\151\157\156\137\x69\156\166\x61\154\x69\x64\137\144\x65\x66\141\x75\154\164\137\x67\162\x6f\x75\160"); goto p3AX7; ACm21: return FALSE; goto WHv6w; GHMgc: $groups[] = $default_group->id; goto x1THu; KlmgG: $query = $this->db->get_where($this->tables["\147\162\x6f\x75\160\x73"], ["\x6e\x61\x6d\x65" => $this->config->item("\x64\145\x66\x61\x75\x6c\164\137\147\x72\x6f\165\x70", "\151\157\156\x5f\x61\165\x74\x68")], 1)->row(); goto Aik47; Odcrk: foreach ($groups as $group) { $this->add_to_group($group, $id); y_qoL: } goto mrAcE; GqVpL: if (!(!$this->config->item("\x64\x65\146\x61\x75\x6c\x74\x5f\x67\x72\x6f\165\160", "\x69\157\x6e\137\141\165\164\x68") && empty($groups))) { goto xmxvH; } goto eq_Q8; n3yP0: $data = [$this->identity_column => $identity, "\165\163\x65\162\x6e\x61\155\x65" => $identity, "\x70\141\x73\x73\167\157\162\x64" => $password, "\145\x6d\141\151\x6c" => $email, "\x69\160\x5f\141\144\x64\x72\x65\163\x73" => $ip_address, "\x63\x72\x65\141\x74\145\x64\137\x6f\156" => time(), "\141\143\x74\x69\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto J_9P6; ecjns: if (!(isset($default_group->id) && empty($groups))) { goto vMgCR; } goto GHMgc; mrAcE: kJloK: goto xBE_a; J_9P6: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\x65\x72\x73"], $additional_data), $data); goto RXAJQ; HXnB2: if (empty($groups)) { goto jWKoK; } goto Odcrk; x1THu: vMgCR: goto HXnB2; Uknx_: $this->set_error("\x61\143\143\x6f\x75\156\x74\x5f\143\162\145\x61\x74\x69\x6f\x6e\137\x64\165\160\x6c\x69\x63\x61\x74\x65\x5f\x69\144\145\156\164\x69\164\x79"); goto TYxhm; RXAJQ: $this->trigger_events("\x65\170\164\162\141\x5f\x73\145\x74"); goto ovU5L; GLVZk: $ip_address = $this->input->ip_address(); goto jzXz2; eq_Q8: $this->set_error("\141\x63\143\x6f\165\156\164\137\143\x72\x65\x61\x74\151\x6f\156\x5f\x6d\151\x73\x73\151\156\147\x5f\144\145\x66\x61\165\154\164\137\x67\x72\157\x75\x70"); goto iB7pP; Aik47: if (!(!isset($query->id) && empty($groups))) { goto E6A9x; } goto uFYgE; cnGu5: return isset($id) ? $id : FALSE; goto NemnP; iB7pP: return FALSE; goto N3pTr; TYxhm: return FALSE; goto SvFkb; NemnP: } public function login($identity, $password, $remember = FALSE) { goto lEBVg; UhhX0: $this->increase_login_attempts($identity); goto Thy4m; J2box: $query = $this->db->select($this->identity_column . "\x2c\40\x65\155\141\x69\154\x2c\x20\151\x64\54\40\x70\141\163\x73\x77\x6f\x72\144\54\40\141\x63\x74\151\x76\x65\54\40\154\141\163\x74\x5f\x6c\x6f\x67\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\163\x63")->get($this->tables["\x75\x73\x65\162\163"]); goto pqRrG; IrcGh: $this->trigger_events("\145\170\x74\162\141\x5f\167\150\x65\162\145"); goto J2box; fLTcR: return FALSE; goto VXKKJ; t_y_x: $this->remember_user($identity); goto EA_uU; ghI4F: if ($remember) { goto mb_3i; } goto uHbVD; QFiT3: $this->set_error("\x6c\x6f\x67\151\x6e\137\165\156\163\165\143\143\145\x73\163\x66\165\154\137\x6e\x6f\x74\x5f\141\x63\164\151\x76\145"); goto XMsYI; c7dYA: $this->trigger_events(["\160\x6f\x73\x74\137\x6c\x6f\147\151\156", "\x70\x6f\163\x74\x5f\x6c\157\x67\151\156\x5f\x73\x75\x63\x63\145\163\163\146\x75\154"]); goto nIWmv; LTtnN: if (!($user->active == 0)) { goto uhdeF; } goto S_M9a; nIWmv: $this->set_message("\154\x6f\147\151\x6e\137\163\165\x63\x63\145\163\x73\146\165\x6c"); goto TNvVl; maDNA: if (!$this->config->item("\162\145\155\145\155\x62\x65\x72\x5f\165\x73\x65\162\163", "\151\157\x6e\x5f\141\x75\164\x68")) { goto nAwWr; } goto ghI4F; dt63V: $this->set_error("\x6c\157\147\151\156\x5f\164\x69\x6d\x65\157\165\164"); goto OWoNn; M_p7m: $this->session->sess_regenerate(FALSE); goto c7dYA; j4AA0: goto j2D6d; goto g5OcZ; wMtsI: $this->update_last_login($user->id); goto ag1kV; EA_uU: j2D6d: goto bln0X; g5OcZ: mb_3i: goto t_y_x; ag1kV: $this->clear_login_attempts($identity); goto YCFnq; ue1aH: $this->set_error("\x6c\157\x67\151\156\x5f\165\156\163\x75\x63\x63\x65\163\163\146\x75\x6c"); goto YjAK7; TNvVl: return TRUE; goto zTZZl; bln0X: nAwWr: goto w7U2Q; DB23Y: $this->hash_password($password); goto UhhX0; XMsYI: return FALSE; goto jW18G; lEBVg: $this->trigger_events("\x70\162\145\x5f\x6c\x6f\x67\151\156"); goto DQNEJ; vNxtl: HquE6: goto Ul61D; YCFnq: $this->clear_forgotten_password_code($identity); goto maDNA; beO0H: $this->trigger_events("\160\x6f\x73\164\x5f\154\x6f\147\x69\x6e\137\x75\x6e\x73\165\143\x63\x65\x73\x73\x66\165\154"); goto dt63V; NCgA0: $this->hash_password($password); goto beO0H; YZ8bE: $this->set_error("\154\x6f\147\151\156\x5f\x75\156\163\x75\x63\x63\145\163\163\x66\165\x6c"); goto fLTcR; OWoNn: return FALSE; goto vNxtl; KJUy1: RimBE: goto IrcGh; XWQX3: $this->set_session($user); goto wMtsI; DQNEJ: if (!(empty($identity) || empty($password))) { goto RimBE; } goto ue1aH; FOX83: E5Ar4: goto DB23Y; qzngJ: if (!$this->verify_password($password, $user->password, $identity)) { goto z78NL; } goto LTtnN; uHbVD: $this->clear_remember_code($identity); goto j4AA0; Thy4m: $this->trigger_events("\x70\157\163\x74\137\x6c\157\147\151\x6e\x5f\165\x6e\163\x75\x63\x63\x65\163\163\x66\x75\x6c"); goto YZ8bE; jW18G: uhdeF: goto XWQX3; w7U2Q: $this->rehash_password_if_needed($user->password, $identity, $password); goto M_p7m; Ul61D: if (!($query->num_rows() === 1)) { goto E5Ar4; } goto ny7_x; S_M9a: $this->trigger_events("\160\157\x73\164\137\x6c\x6f\x67\x69\x6e\137\165\156\163\x75\143\x63\x65\x73\163\x66\x75\x6c"); goto QFiT3; YjAK7: return FALSE; goto KJUy1; pqRrG: if (!$this->is_max_login_attempts_exceeded($identity)) { goto HquE6; } goto NCgA0; ny7_x: $user = $query->row(); goto qzngJ; zTZZl: z78NL: goto FOX83; VXKKJ: } public function recheck_session() { goto QCi33; wq2lr: goto OYHag; goto KGSwT; OrVI2: OYHag: goto u6USp; SlqQq: $last_login = $this->session->userdata("\x6c\x61\163\x74\x5f\143\150\145\x63\x6b"); goto gfSqc; zwBwm: $this->session->set_userdata("\x6c\141\x73\x74\x5f\x63\x68\145\143\153", time()); goto OrVI2; gfSqc: if (!($last_login + $recheck < time())) { goto OeYiU; } goto UhhiS; rhU6b: $identity = $this->config->item("\151\x64\x65\156\x74\x69\x74\171", "\x69\x6f\x6e\137\141\165\164\x68"); goto BneJw; BneJw: $this->session->unset_userdata([$identity, "\151\144", "\x75\163\145\162\137\151\x64"]); goto xUrHe; pxSE5: return (bool) $this->session->userdata("\x69\144\x65\156\x74\x69\x74\171"); goto kqCvR; KGSwT: fb1EK: goto zwBwm; u6USp: OeYiU: goto Dhun3; aKEM6: $this->trigger_events("\154\157\147\x6f\x75\x74"); goto rhU6b; JedMH: if ($query->num_rows() === 1) { goto fb1EK; } goto aKEM6; UhhiS: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\151\144\145\x6e\x74\x69\164\x79"), "\141\x63\x74\x69\166\x65" => "\61"])->limit(1)->order_by("\x69\x64", "\x64\x65\163\x63")->get($this->tables["\165\x73\145\x72\x73"]); goto JedMH; xUrHe: return FALSE; goto wq2lr; Dhun3: jMoz2: goto pxSE5; QCi33: $recheck = NULL !== $this->config->item("\x72\x65\143\x68\145\143\153\x5f\x74\151\x6d\x65\x72", "\x69\157\x6e\x5f\141\165\164\x68") ? $this->config->item("\x72\x65\143\150\x65\x63\x6b\x5f\164\x69\x6d\x65\162", "\x69\x6f\x6e\x5f\141\165\164\150") : 0; goto Ov68t; Ov68t: if (!($recheck !== 0)) { goto jMoz2; } goto SlqQq; kqCvR: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto Ix32z; CvYh4: $max_attempts = $this->config->item("\x6d\141\x78\151\155\165\x6d\x5f\154\157\x67\151\x6e\137\141\x74\164\x65\x6d\160\164\x73", "\x69\157\x6e\137\141\x75\164\150"); goto TOcRY; UNWGn: return FALSE; goto V4NhZ; Ix32z: if (!$this->config->item("\x74\162\141\x63\153\x5f\154\157\x67\x69\x6e\137\141\x74\x74\145\155\160\164\163", "\x69\x6f\156\137\x61\165\164\x68")) { goto cYpun; } goto CvYh4; lJXOD: XoLdm: goto CNm8Q; kJkCY: return $attempts >= $max_attempts; goto lJXOD; TOcRY: if (!($max_attempts > 0)) { goto XoLdm; } goto HSHr0; CNm8Q: cYpun: goto UNWGn; HSHr0: $attempts = $this->get_attempts_num($identity, $ip_address); goto kJkCY; V4NhZ: } public function get_attempts_num($identity, $ip_address = NULL) { goto XcFCZ; LEfKY: $qres = $this->db->get($this->tables["\154\157\147\151\156\x5f\x61\164\164\145\x6d\x70\164\x73"]); goto BMBLm; XcFCZ: if (!$this->config->item("\164\162\141\143\x6b\x5f\x6c\x6f\147\151\x6e\x5f\141\x74\164\x65\155\x70\x74\x73", "\151\x6f\156\x5f\x61\165\164\x68")) { goto tYuGC; } goto Pkqxx; w5hbB: $this->db->where("\x74\151\155\x65\40\x3e", time() - $this->config->item("\x6c\x6f\x63\x6b\x6f\x75\164\137\x74\x69\x6d\x65", "\x69\157\x6e\x5f\x61\165\164\x68"), FALSE); goto LEfKY; Pkqxx: $this->db->select("\x31", FALSE); goto kO4Lk; reJmX: tYuGC: goto QMiGW; J2qox: tkgJW: goto w5hbB; BMBLm: return $qres->num_rows(); goto reJmX; deUVq: $this->db->where("\x69\160\x5f\x61\x64\144\x72\145\x73\x73", $ip_address); goto J2qox; pdtud: if (!$this->config->item("\164\x72\x61\x63\153\137\154\x6f\147\x69\x6e\x5f\x69\x70\x5f\141\144\x64\162\145\x73\x73", "\x69\x6f\156\137\141\x75\164\150")) { goto tkgJW; } goto oxbEc; QMiGW: return 0; goto j0VPQ; kO4Lk: $this->db->where("\x6c\157\147\151\156", $identity); goto pdtud; oxbEc: if (isset($ip_address)) { goto XDNH_; } goto QnI3e; Bbv2a: XDNH_: goto deUVq; QnI3e: $ip_address = $this->input->ip_address(); goto Bbv2a; j0VPQ: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto M1pdD; PB8Ri: hPMKV: goto RLtid; RLtid: $this->db->order_by("\151\x64", "\x64\145\163\143"); goto OmSOr; XIPcW: Q6MkW: goto jssqf; gmHxX: if (isset($ip_address)) { goto dMnBC; } goto Vvw_A; wjLF4: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto eaHoi; l2txr: return 0; goto oWCoM; W5Pgj: $this->db->select("\x74\x69\x6d\145"); goto wjLF4; eaHoi: if (!$this->config->item("\164\162\x61\x63\x6b\x5f\154\x6f\147\151\x6e\137\151\160\137\141\144\x64\162\x65\x73\163", "\x69\157\156\x5f\x61\x75\x74\150")) { goto hPMKV; } goto gmHxX; jzkKq: $this->db->where("\x69\160\x5f\x61\x64\x64\162\145\163\163", $ip_address); goto PB8Ri; sMPsk: dMnBC: goto jzkKq; fO0Mf: if (!($qres->num_rows() > 0)) { goto Q6MkW; } goto sDaJS; jssqf: JpDh_: goto l2txr; OmSOr: $qres = $this->db->get($this->tables["\154\157\147\151\156\x5f\141\164\x74\145\155\160\x74\163"], 1); goto fO0Mf; Vvw_A: $ip_address = $this->input->ip_address(); goto sMPsk; sDaJS: return $qres->row()->time; goto XIPcW; M1pdD: if (!$this->config->item("\164\x72\141\143\153\x5f\x6c\x6f\x67\151\156\137\141\164\164\x65\x6d\x70\164\163", "\x69\x6f\x6e\x5f\x61\x75\164\x68")) { goto JpDh_; } goto W5Pgj; oWCoM: } public function get_last_attempt_ip($identity) { goto zVJ0Q; SZCGP: $this->db->order_by("\x69\x64", "\144\x65\x73\143"); goto M1cRs; l1A_r: SaG1h: goto CPMb_; i2cJc: $this->db->where("\x6c\x6f\x67\x69\156", $identity); goto SZCGP; M1cRs: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\x6e\x5f\x61\x74\164\145\x6d\160\164\x73"], 1); goto NoOl6; z_aNV: return $qres->row()->ip_address; goto sMhqd; CPMb_: return ''; goto Ury_g; sMhqd: slUAj: goto l1A_r; NoOl6: if (!($qres->num_rows() > 0)) { goto slUAj; } goto z_aNV; ExRW8: $this->db->select("\x69\160\x5f\141\x64\x64\x72\x65\x73\x73"); goto i2cJc; zVJ0Q: if (!($this->config->item("\164\x72\x61\x63\x6b\x5f\154\x6f\x67\151\x6e\x5f\x61\x74\164\x65\x6d\x70\164\x73", "\x69\157\x6e\x5f\141\x75\x74\x68") && $this->config->item("\164\162\x61\143\153\x5f\154\157\147\151\x6e\137\x69\160\x5f\141\x64\x64\x72\x65\x73\163", "\151\157\156\x5f\x61\165\164\x68"))) { goto SaG1h; } goto ExRW8; Ury_g: } public function increase_login_attempts($identity) { goto GyYxO; EWcMJ: $data["\151\x70\x5f\x61\144\144\x72\145\x73\163"] = $this->input->ip_address(); goto J2EQd; mjQKm: if (!$this->config->item("\164\x72\141\x63\x6b\x5f\x6c\x6f\x67\151\156\x5f\x69\160\137\x61\x64\x64\x72\145\163\x73", "\x69\157\156\x5f\x61\x75\164\x68")) { goto wyVJd; } goto EWcMJ; rmMXj: return FALSE; goto VeP_g; YYkpr: NxdVq: goto rmMXj; GyYxO: if (!$this->config->item("\164\162\141\x63\153\x5f\x6c\x6f\x67\151\x6e\137\x61\164\x74\145\x6d\x70\164\163", "\151\157\156\x5f\141\x75\164\x68")) { goto NxdVq; } goto dY_e3; hJhoX: return $this->db->insert($this->tables["\154\157\x67\151\x6e\x5f\141\164\x74\x65\x6d\160\164\x73"], $data); goto YYkpr; dY_e3: $data = ["\151\160\137\141\144\x64\162\x65\163\163" => '', "\x6c\157\x67\x69\x6e" => $identity, "\x74\x69\155\x65" => time()]; goto mjQKm; J2EQd: wyVJd: goto hJhoX; VeP_g: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto jwx8T; l2xY8: nD_Kq: goto W9cwq; bnc2R: vYqKX: goto wS5qD; kFPSm: $ip_address = $this->input->ip_address(); goto Fw9YL; PMEnf: $this->db->where("\151\x70\137\x61\144\x64\x72\x65\x73\x73", $ip_address); goto bnc2R; vxIii: return $this->db->delete($this->tables["\154\157\147\151\x6e\x5f\141\x74\x74\145\155\160\x74\x73"]); goto l2xY8; W9cwq: return FALSE; goto Sf3jQ; sAnvB: if (!$this->config->item("\x74\162\141\143\x6b\x5f\x6c\x6f\x67\x69\x6e\x5f\x69\160\137\x61\x64\x64\x72\145\x73\x73", "\151\x6f\156\x5f\141\165\x74\x68")) { goto vYqKX; } goto Ec3vU; Fw9YL: Oprp8: goto PMEnf; phh4d: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\143\153\x6f\165\164\x5f\164\x69\155\x65", "\x69\157\x6e\137\141\165\x74\150")); goto TUNwl; TUNwl: $this->db->where("\154\x6f\147\151\156", $identity); goto sAnvB; Ec3vU: if (isset($ip_address)) { goto Oprp8; } goto kFPSm; jwx8T: if (!$this->config->item("\164\162\x61\143\x6b\x5f\154\x6f\x67\151\x6e\x5f\x61\164\x74\x65\x6d\160\x74\x73", "\151\x6f\156\137\141\x75\x74\150")) { goto nD_Kq; } goto phh4d; wS5qD: $this->db->or_where("\x74\151\x6d\145\x20\74", time() - $old_attempts_expire_period, FALSE); goto vxIii; Sf3jQ: } public function limit($limit) { goto aiMAH; hJpD3: $this->_ion_limit = $limit; goto A1BVB; aiMAH: $this->trigger_events("\154\151\x6d\x69\164"); goto hJpD3; A1BVB: return $this; goto v8qNA; v8qNA: } public function offset($offset) { goto Vy_Wv; qO6Lk: return $this; goto Bu9XT; c69Y6: $this->_ion_offset = $offset; goto qO6Lk; Vy_Wv: $this->trigger_events("\x6f\146\x66\x73\x65\164"); goto c69Y6; Bu9XT: } public function where($where, $value = NULL) { goto QBJzU; QBJzU: $this->trigger_events("\x77\x68\145\x72\145"); goto n6hRC; n6hRC: if (is_array($where)) { goto fQnat; } goto SzOqU; WIEXl: return $this; goto PK3Gz; jYSA5: fQnat: goto T4mXC; SzOqU: $where = [$where => $value]; goto jYSA5; T4mXC: array_push($this->_ion_where, $where); goto WIEXl; PK3Gz: } public function like($like, $value = NULL, $position = "\x62\157\x74\x68") { goto mb_x9; NA24M: array_push($this->_ion_like, ["\154\151\153\x65" => $like, "\166\141\x6c\x75\145" => $value, "\x70\157\x73\151\164\x69\x6f\x6e" => $position]); goto UmWjc; UmWjc: return $this; goto vp2IZ; mb_x9: $this->trigger_events("\154\151\x6b\145"); goto NA24M; vp2IZ: } public function select($select) { goto Yi35u; Sm0ka: return $this; goto SwIjC; Yi35u: $this->trigger_events("\163\x65\x6c\145\143\164"); goto q2KXS; q2KXS: $this->_ion_select[] = $select; goto Sm0ka; SwIjC: } public function order_by($by, $order = "\144\x65\x73\143") { goto BxVr3; BxVr3: $this->trigger_events("\157\x72\x64\x65\162\x5f\x62\x79"); goto JF32F; xP2bQ: return $this; goto TBdKk; akuPg: $this->_ion_order = $order; goto xP2bQ; JF32F: $this->_ion_order_by = $by; goto akuPg; TBdKk: } public function row() { goto LLvwH; RvKSO: $row = $this->response->row(); goto IN5xI; LLvwH: $this->trigger_events("\162\157\x77"); goto RvKSO; IN5xI: return $row; goto cRw4T; cRw4T: } public function row_array() { goto tx4bG; zC2Gi: return $row; goto DNq1R; p2Rdd: $row = $this->response->row_array(); goto zC2Gi; tx4bG: $this->trigger_events(["\x72\157\x77", "\x72\x6f\167\137\141\x72\162\x61\x79"]); goto p2Rdd; DNq1R: } public function result() { goto L3MzP; L3MzP: $this->trigger_events("\x72\x65\163\165\x6c\x74"); goto PkY7w; PkY7w: $result = $this->response->result(); goto yy2Ia; yy2Ia: return $result; goto tfkfH; tfkfH: } public function result_array() { goto k_ekA; k_ekA: $this->trigger_events(["\x72\x65\163\x75\x6c\x74", "\162\x65\x73\x75\x6c\x74\137\141\x72\162\141\171"]); goto sLyl0; qT28m: return $result; goto dPBm4; sLyl0: $result = $this->response->result_array(); goto qT28m; dPBm4: } public function num_rows() { goto lW8pm; qcPr4: return $result; goto EsQ6v; IBxaw: $result = $this->response->num_rows(); goto qcPr4; lW8pm: $this->trigger_events(["\156\165\x6d\x5f\162\x6f\x77\x73"]); goto IBxaw; EsQ6v: } public function users($groups = NULL) { goto uIJDA; tkwZy: CCcdH: goto UmCdE; GSYht: if (!isset($this->_ion_limit)) { goto CCcdH; } goto sYNEp; yZonD: QNhhk: goto wf1DR; wWjaX: $group_names = []; goto Ky1NU; uIJDA: $this->trigger_events("\165\163\145\x72\x73"); goto kLfki; RJPlQ: BUzU8: goto r_lfp; IljYk: $this->_ion_order_by = NULL; goto yZonD; DV5JH: Lvl_m: goto u3Gn4; thOQi: $this->_ion_like = []; goto L4gmm; H4OGk: if (empty($group_names)) { goto TQ3WS; } goto KWITN; bdtwH: foreach ($this->_ion_where as $where) { $this->db->where($where); e7caQ: } goto qaTu4; KWITN: $this->db->join($this->tables["\x67\162\x6f\165\160\163"], $this->tables["\165\163\145\162\163\x5f\x67\162\x6f\165\160\x73"] . "\56" . $this->join["\x67\162\157\x75\x70\x73"] . "\x20\x3d\x20" . $this->tables["\147\162\x6f\x75\x70\163"] . "\x2e\151\144", "\x69\x6e\x6e\145\162"); goto Wg6RK; Pap1x: DmEXu: goto EnGM7; Nsk1P: $this->db->select([$this->tables["\x75\x73\145\162\163"] . "\56\x2a", $this->tables["\165\163\x65\162\x73"] . "\x2e\151\144\40\x61\163\x20\151\144", $this->tables["\165\163\x65\x72\x73"] . "\x2e\151\x64\40\141\163\x20\x75\163\x65\162\137\151\144"]); goto OwpEq; elAz6: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto QNhhk; } goto cYvBT; Ky1NU: foreach ($groups as $group) { goto ie5H8; t0FUu: XIrNu: goto Yy81N; X9Z47: $group_names[] = $group; goto HqPLG; ie5H8: if (is_numeric($group)) { goto XIrNu; } goto X9Z47; Yy81N: $group_ids[] = $group; goto IlAKV; ONvt5: zQYZF: goto KtvpY; HqPLG: goto L8ALi; goto t0FUu; IlAKV: L8ALi: goto ONvt5; KtvpY: } goto T30Q4; OwpEq: goto Lvl_m; goto Pap1x; PZj3Z: return $this; goto o23GE; VGvsu: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto aeOSg; } goto bdtwH; MLcdw: $this->_ion_offset = NULL; goto ueE1X; u3Gn4: if (!isset($groups)) { goto ryXWl; } goto Y_616; EimOm: e447m: goto rMNai; T30Q4: LnpT6: goto BAsY3; m9DF7: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto cC4_D; } goto bnULO; w9uaB: $this->db->join($this->tables["\165\163\145\x72\163\137\x67\x72\x6f\x75\160\x73"], $this->tables["\x75\x73\x65\x72\x73\137\147\162\157\165\x70\x73"] . "\x2e" . $this->join["\x75\x73\x65\x72\163"] . "\75" . $this->tables["\x75\163\x65\x72\x73"] . "\56\x69\x64", "\151\156\x6e\x65\162"); goto wROZI; wf1DR: $this->response = $this->db->get($this->tables["\x75\x73\x65\x72\163"]); goto PZj3Z; JYqB4: if (empty($group_ids)) { goto tyiGy; } goto DfHh9; dmBWv: KE1IU: goto RKy93; r_lfp: if (!(isset($groups) && !empty($groups))) { goto eIub7; } goto Hn2ig; cBaTJ: ryXWl: goto i39ek; RKy93: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto iRhfK; bnULO: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\x6b\145"], $like["\166\x61\154\x75\145"], $like["\x70\157\x73\151\x74\151\157\x6e"]); Sop3r: } goto bPgVH; BAsY3: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\167\150\x65\x72\x65\137\x69\156" : "\x77\x68\145\x72\145\x5f\151\x6e"; goto H4OGk; cYvBT: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto uc2Xh; bPgVH: EprfE: goto thOQi; nL5mP: $groups = [$groups]; goto RJPlQ; wROZI: eIub7: goto M9su1; rMNai: $this->_ion_select = []; goto DV5JH; NUXNj: $this->_ion_where = []; goto vis4g; UmCdE: goto d4IPM; goto dmBWv; vis4g: aeOSg: goto m9DF7; qaTu4: TwczT: goto NUXNj; i39ek: $this->trigger_events("\x65\170\164\162\x61\x5f\x77\x68\x65\162\x65"); goto VGvsu; uc2Xh: $this->_ion_order = NULL; goto IljYk; XqyQQ: $this->_ion_limit = NULL; goto tkwZy; DfHh9: $this->db->{$or_where_in}($this->tables["\165\x73\145\x72\x73\x5f\x67\x72\x6f\165\x70\x73"] . "\56" . $this->join["\147\162\157\x75\x70\163"], $group_ids); goto PPRtq; PPRtq: tyiGy: goto cBaTJ; L4gmm: cC4_D: goto Ygeqw; iRhfK: $this->_ion_limit = NULL; goto MLcdw; M9su1: $group_ids = []; goto wWjaX; EnGM7: foreach ($this->_ion_select as $select) { $this->db->select($select); COc_d: } goto EimOm; sYNEp: $this->db->limit($this->_ion_limit); goto XqyQQ; P1rmO: TQ3WS: goto JYqB4; Hn2ig: $this->db->distinct(); goto w9uaB; ueE1X: d4IPM: goto elAz6; Wg6RK: $this->db->where_in($this->tables["\x67\162\x6f\165\x70\163"] . "\x2e\x6e\141\x6d\x65", $group_names); goto P1rmO; kLfki: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto DmEXu; } goto Nsk1P; Ygeqw: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto KE1IU; } goto GSYht; Y_616: if (is_array($groups)) { goto BUzU8; } goto nL5mP; o23GE: } public function user($id = NULL) { goto tZI2v; WSE1A: $this->limit(1); goto N9EE1; N9EE1: $this->order_by($this->tables["\165\163\x65\162\163"] . "\x2e\151\144", "\144\x65\163\x63"); goto EADsO; LznzC: return $this; goto wyvic; EADsO: $this->where($this->tables["\165\163\145\x72\163"] . "\56\151\144", $id); goto DEHrw; DEHrw: $this->users(); goto LznzC; tZI2v: $this->trigger_events("\x75\163\x65\162"); goto JvQnU; JvQnU: $id = isset($id) ? $id : $this->session->userdata("\165\x73\145\x72\137\151\x64"); goto WSE1A; wyvic: } public function get_users_groups($id = FALSE) { goto AZErr; I38SR: $id || ($id = $this->session->userdata("\x75\163\145\x72\137\x69\144")); goto RUAFf; AZErr: $this->trigger_events("\147\145\164\137\x75\x73\x65\x72\163\x5f\147\162\157\x75\160"); goto I38SR; RUAFf: return $this->db->select($this->tables["\165\163\x65\162\163\x5f\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x67\162\x6f\x75\160\x73"] . "\x20\x61\163\40\x69\144\54\x20" . $this->tables["\147\162\157\x75\160\163"] . "\x2e\156\x61\155\x65\54\40" . $this->tables["\147\x72\157\165\160\163"] . "\56\144\145\163\x63\x72\151\160\164\x69\157\156")->where($this->tables["\x75\x73\x65\162\x73\x5f\147\162\157\165\160\163"] . "\x2e" . $this->join["\x75\x73\145\162\x73"], $id)->join($this->tables["\147\162\x6f\x75\160\x73"], $this->tables["\165\163\145\x72\x73\137\x67\162\157\165\160\163"] . "\x2e" . $this->join["\x67\162\157\165\160\163"] . "\75" . $this->tables["\x67\162\x6f\165\160\163"] . "\x2e\x69\144")->get($this->tables["\x75\163\145\x72\163\137\x67\x72\x6f\x75\x70\x73"]); goto AhliI; AhliI: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto RDQLS; wdwg_: AFd_a: goto uU4bU; z0y29: $id || ($id = $this->session->userdata("\x75\x73\x65\x72\x5f\x69\144")); goto q84VE; Had5x: $groups_array = []; goto gw2pl; Pi4X2: goto BKx9W; goto IpjP9; IpjP9: ar2jV: goto Ms4Yz; c1Jbv: BKx9W: goto D8pCs; u9jZE: $this->_cache_user_in_group[$id] = $groups_array; goto Pi4X2; q84VE: if (is_array($check_group)) { goto AFd_a; } goto WAeFK; RDQLS: $this->trigger_events("\151\x6e\x5f\147\162\x6f\165\160"); goto z0y29; WAeFK: $check_group = [$check_group]; goto wdwg_; nR_x5: XDSG_: goto zKwhp; uU4bU: if (isset($this->_cache_user_in_group[$id])) { goto ar2jV; } goto FEhDx; D8pCs: foreach ($check_group as $key => $value) { goto W0gba; W0gba: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto nQ0wZ; OY5qk: XDNdR: goto T10nA; UqE2v: PxEvV: goto OY5qk; nQ0wZ: if (!(in_array($value, $groups) xor $check_all)) { goto PxEvV; } goto xFVik; xFVik: return !$check_all; goto UqE2v; T10nA: } goto nR_x5; FPOLK: FIXMW: goto u9jZE; zKwhp: return $check_all; goto sVFue; gw2pl: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; ho6Wq: } goto FPOLK; Ms4Yz: $groups_array = $this->_cache_user_in_group[$id]; goto c1Jbv; FEhDx: $users_groups = $this->get_users_groups($id)->result(); goto Had5x; sVFue: } public function add_to_group($group_ids, $user_id = FALSE) { goto NJB7U; n4MLA: vkelA: goto qrZfu; qrZfu: return $return; goto s8j6p; bgL8f: $group_ids = [$group_ids]; goto ZPWMd; ZPWMd: Gg8Fy: goto gicY8; NJB7U: $this->trigger_events("\x61\x64\x64\x5f\x74\157\x5f\147\162\x6f\x75\x70"); goto nJus8; c7USW: if (is_array($group_ids)) { goto Gg8Fy; } goto bgL8f; nJus8: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\162\137\x69\144")); goto c7USW; gicY8: $return = 0; goto bMxi_; bMxi_: foreach ($group_ids as $group_id) { goto zVawS; xXIQn: zQEKh: goto gllFz; v09mw: $group = $this->group($group_id)->result(); goto hLpk0; KI7DQ: $this->_cache_groups[$group_id] = $group_name; goto TcakC; yaswL: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto i49lT; hLpk0: $group_name = $group[0]->name; goto KI7DQ; i49lT: $return++; goto ZnKUA; F5pUZ: $group_name = $this->_cache_groups[$group_id]; goto YjCTr; zVawS: if (!$this->db->insert($this->tables["\165\x73\x65\162\x73\137\x67\162\x6f\165\160\163"], [$this->join["\x67\162\157\x75\160\163"] => (float) $group_id, $this->join["\x75\163\145\x72\163"] => (float) $user_id])) { goto VBHXw; } goto CjRGJ; ZnKUA: VBHXw: goto xXIQn; TcakC: goto BCzWT; goto Bw6fQ; YjCTr: BCzWT: goto yaswL; CjRGJ: if (isset($this->_cache_groups[$group_id])) { goto hfWGj; } goto v09mw; Bw6fQ: hfWGj: goto F5pUZ; gllFz: } goto n4MLA; s8j6p: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto ITaGl; VGHm2: yO3_d: goto vEIH3; ITaGl: $this->trigger_events("\x72\x65\155\157\x76\x65\x5f\x66\x72\157\x6d\x5f\147\x72\157\165\x70"); goto kf1nq; WKpU9: EwjZz: goto RdlHp; XUmAh: $group_ids = [$group_ids]; goto WKpU9; sOX8r: LGO7w: goto o7rKf; kf1nq: if (!empty($user_id)) { goto yO3_d; } goto fs5v6; RdlHp: foreach ($group_ids as $group_id) { goto VE19a; d55qv: unset($this->_cache_user_in_group[$user_id][$group_id]); goto Ks5OT; Ks5OT: LPIeu: goto PLB9u; VE19a: $this->db->delete($this->tables["\x75\x73\x65\162\163\137\147\x72\x6f\x75\x70\163"], [$this->join["\x67\162\x6f\x75\x70\163"] => (float) $group_id, $this->join["\x75\x73\x65\162\x73"] => (float) $user_id]); goto y0k1h; PLB9u: zD_3L: goto IxJSM; y0k1h: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto LPIeu; } goto d55qv; IxJSM: } goto vUTLF; vEIH3: if (!empty($group_ids)) { goto LGO7w; } goto PCQ5c; Lbi_X: goto ltZws; goto sOX8r; Pqy_S: $return = TRUE; goto cs15t; o7rKf: if (is_array($group_ids)) { goto EwjZz; } goto XUmAh; tb4a9: $this->_cache_user_in_group[$user_id] = []; goto k4ZEW; H4YfA: return $return; goto y5Pey; fs5v6: return FALSE; goto VGHm2; k4ZEW: j9c_s: goto Lbi_X; PCQ5c: if (!($return = $this->db->delete($this->tables["\x75\163\145\162\x73\137\x67\162\x6f\x75\160\163"], [$this->join["\x75\x73\x65\x72\x73"] => (float) $user_id]))) { goto j9c_s; } goto tb4a9; vUTLF: qrGPH: goto Pqy_S; cs15t: ltZws: goto H4YfA; y5Pey: } public function groups() { goto y_B82; cB0en: $this->_ion_limit = NULL; goto wZVGl; DBjaL: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto SMGQy; SzAo5: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto w7Apc; } goto DBjaL; YMlEo: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto tQZmS; } goto yxBRJ; wZVGl: TKpVl: goto GMpV8; iWcq9: $this->_ion_limit = NULL; goto hbnj5; qxl6q: $this->_ion_where = []; goto pEpjI; gX1kG: if (!isset($this->_ion_limit)) { goto TKpVl; } goto cr6ZA; hBhfJ: ko1qq: goto qxl6q; GvKJt: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto iFB4z; } goto gX1kG; SMGQy: w7Apc: goto AQZVP; gBHz5: u1w5X: goto SzAo5; ymFZD: iFB4z: goto hpM0t; GMpV8: goto u1w5X; goto ymFZD; pEpjI: tQZmS: goto GvKJt; hpM0t: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto iWcq9; cr6ZA: $this->db->limit($this->_ion_limit); goto cB0en; UdVeP: return $this; goto gmQXj; hbnj5: $this->_ion_offset = NULL; goto gBHz5; AQZVP: $this->response = $this->db->get($this->tables["\x67\x72\x6f\x75\x70\x73"]); goto UdVeP; y_B82: $this->trigger_events("\147\162\x6f\x75\x70\163"); goto YMlEo; yxBRJ: foreach ($this->_ion_where as $where) { $this->db->where($where); i4V_w: } goto hBhfJ; gmQXj: } public function group($id = NULL) { goto ub118; KXIqP: return $this->groups(); goto IELud; A4kS6: OmUQs: goto ehpGf; V97ug: $this->where($this->tables["\147\162\157\165\160\x73"] . "\x2e\x69\144", $id); goto A4kS6; ehpGf: $this->limit(1); goto yqzPj; ub118: $this->trigger_events("\x67\162\x6f\165\160"); goto gIOTE; yqzPj: $this->order_by("\x69\144", "\x64\145\x73\143"); goto KXIqP; gIOTE: if (!isset($id)) { goto OmUQs; } goto V97ug; IELud: } public function update($id, array $data) { goto QVAgC; ziEcN: $data["\160\x61\x73\x73\167\x6f\162\x64"] = $this->hash_password($data["\x70\x61\163\163\167\157\x72\144"], $user->{$this->identity_column}); goto HnsnS; TbyfH: goto DKbb9; goto YuJYb; Itw2J: return FALSE; goto bd2T9; UVoYn: $this->set_message("\165\x70\x64\141\164\x65\x5f\163\165\143\143\x65\163\x73\x66\165\x6c"); goto K5nNy; ib4bq: $this->db->trans_commit(); goto yI4MR; WtQnX: $this->db->trans_rollback(); goto adsBa; p4LhG: $data = $this->_filter_data($this->tables["\165\163\x65\x72\x73"], $data); goto ha5G4; wrPXt: if (!($this->db->trans_status() === FALSE)) { goto C7C4m; } goto WtQnX; XM20o: GIJLe: goto nlLgg; YwvzZ: if (!array_key_exists("\160\141\x73\x73\x77\x6f\162\144", $data)) { goto AW4Ah; } goto xusLH; bswBL: $this->trigger_events(["\x70\157\x73\x74\x5f\165\x70\x64\x61\164\x65\x5f\165\x73\145\x72", "\160\x6f\x73\164\x5f\x75\x70\x64\141\x74\145\137\x75\x73\x65\x72\137\x75\x6e\x73\x75\x63\x63\x65\163\163\x66\165\x6c"]); goto X_ebZ; aadQD: $this->trigger_events(["\160\157\x73\164\x5f\165\x70\144\141\x74\x65\x5f\x75\x73\145\x72", "\160\x6f\x73\164\137\x75\160\144\x61\164\145\x5f\x75\x73\x65\x72\137\165\156\163\165\x63\143\x65\163\x73\x66\165\x6c"]); goto qDpcE; HnsnS: if (!($data["\160\x61\x73\x73\x77\157\162\144"] === FALSE)) { goto eQeSb; } goto ZuN13; I2a2b: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, ["\x69\144" => $user->id]); goto wrPXt; YuJYb: OjUKd: goto ziEcN; Y6qJc: $this->db->trans_begin(); goto AqorY; szD25: $this->set_error("\x75\x70\x64\x61\164\x65\137\165\156\x73\165\143\143\x65\163\163\x66\x75\x6c"); goto rH3eI; Icqtz: $user = $this->user($id)->row(); goto Y6qJc; X_ebZ: $this->set_error("\x75\160\144\x61\164\x65\x5f\x75\x6e\163\x75\143\x63\145\163\x73\146\x75\154"); goto Itw2J; nlLgg: $this->trigger_events("\x65\170\x74\162\x61\x5f\x77\150\x65\x72\x65"); goto I2a2b; qDpcE: $this->set_error("\165\x70\x64\x61\164\x65\x5f\165\x6e\163\x75\x63\x63\x65\x73\163\x66\165\154"); goto hvupa; rH3eI: return FALSE; goto WsjB1; v9iCn: $this->db->trans_rollback(); goto Cflgu; WsjB1: C7C4m: goto ib4bq; Cflgu: $this->set_error("\141\x63\x63\157\165\156\164\x5f\x63\x72\x65\x61\164\x69\x6f\156\137\144\x75\160\x6c\x69\x63\141\x74\145\137\x69\x64\x65\156\164\x69\164\x79"); goto aadQD; AqorY: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto KUIGx; } goto v9iCn; X5XuU: unset($data["\x70\x61\x73\x73\x77\157\x72\144"]); goto TbyfH; adsBa: $this->trigger_events(["\160\x6f\163\x74\x5f\165\160\144\141\x74\x65\137\165\x73\145\x72", "\x70\x6f\163\164\x5f\x75\x70\144\141\164\x65\x5f\x75\x73\145\x72\137\165\156\163\x75\x63\143\x65\163\163\x66\165\x6c"]); goto szD25; hvupa: return FALSE; goto GwECM; bd2T9: eQeSb: goto vjN4H; bI2um: AW4Ah: goto XM20o; xusLH: if (!empty($data["\x70\141\163\163\167\x6f\162\144"])) { goto OjUKd; } goto X5XuU; ha5G4: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\163\163\x77\157\x72\144", $data) || array_key_exists("\x65\x6d\141\151\x6c", $data))) { goto GIJLe; } goto YwvzZ; QVAgC: $this->trigger_events("\x70\x72\145\x5f\x75\160\144\141\x74\145\x5f\165\163\145\162"); goto Icqtz; yI4MR: $this->trigger_events(["\x70\157\163\x74\x5f\165\160\x64\x61\164\x65\137\165\163\x65\x72", "\x70\x6f\163\164\x5f\165\x70\x64\141\164\145\137\x75\x73\x65\162\137\x73\x75\143\143\x65\x73\x73\146\165\154"]); goto UVoYn; GwECM: KUIGx: goto p4LhG; ZuN13: $this->db->trans_rollback(); goto bswBL; K5nNy: return TRUE; goto sUikp; vjN4H: DKbb9: goto bI2um; sUikp: } public function delete_user($id) { goto RKJeq; S2AHv: if (!($this->db->trans_status() === FALSE)) { goto uauY6; } goto xWatX; f_XlH: $this->set_message("\144\x65\154\x65\x74\145\137\x73\165\143\143\145\x73\163\x66\x75\x6c"); goto AgO2m; Ed659: return FALSE; goto Ll1y2; zaDFo: $this->trigger_events(["\x70\x6f\163\x74\x5f\x64\x65\154\145\x74\145\137\x75\x73\145\162", "\x70\157\163\x74\137\144\145\154\145\164\x65\x5f\x75\163\145\162\x5f\163\165\143\143\x65\163\163\146\165\154"]); goto f_XlH; GY6EB: $this->db->trans_commit(); goto zaDFo; vEwDY: $this->set_error("\x64\x65\x6c\x65\x74\x65\x5f\x75\x6e\163\x75\143\x63\x65\163\163\146\165\154"); goto Ed659; HiTSK: $this->db->delete($this->tables["\x75\163\x65\162\x73"], ["\151\144" => $id]); goto S2AHv; RKJeq: $this->trigger_events("\x70\162\145\x5f\x64\x65\154\145\x74\x65\x5f\x75\x73\145\162"); goto ajHLh; Ll1y2: uauY6: goto GY6EB; ajHLh: $this->db->trans_begin(); goto EvA62; xWatX: $this->db->trans_rollback(); goto q3UbW; q3UbW: $this->trigger_events(["\x70\157\x73\x74\137\144\x65\x6c\145\x74\x65\137\165\163\x65\162", "\160\x6f\x73\164\x5f\144\145\x6c\145\x74\145\x5f\x75\x73\145\162\137\165\156\x73\165\143\x63\x65\163\x73\146\x75\154"]); goto vEwDY; EvA62: $this->remove_from_group(NULL, $id); goto HiTSK; AgO2m: return TRUE; goto SSJ_J; SSJ_J: } public function update_last_login($id) { goto V_DC8; qM8nP: $this->trigger_events("\145\x78\x74\x72\141\137\167\x68\145\x72\x65"); goto qG6qo; V_DC8: $this->trigger_events("\165\x70\144\141\x74\x65\137\x6c\x61\x73\164\137\154\x6f\147\x69\x6e"); goto A9JSc; giYJ9: return $this->db->affected_rows() == 1; goto sjmdQ; A9JSc: $this->load->helper("\x64\141\x74\x65"); goto qM8nP; qG6qo: $this->db->update($this->tables["\x75\163\145\x72\x73"], ["\x6c\141\x73\164\137\x6c\x6f\x67\151\156" => time()], ["\x69\x64" => $id]); goto giYJ9; sjmdQ: } public function set_lang($lang = "\x65\156") { goto AyU7I; gmfng: if ($this->config->item("\165\x73\145\x72\137\145\170\160\x69\x72\x65", "\x69\x6f\x6e\137\x61\165\164\150") === 0) { goto R7Atc; } goto ZEqnp; ZEqnp: $expire = $this->config->item("\165\163\145\x72\x5f\x65\170\x70\151\162\145", "\x69\157\x6e\x5f\x61\x75\164\150"); goto TjGqF; AyU7I: $this->trigger_events("\x73\145\x74\137\x6c\141\156\x67"); goto gmfng; TjGqF: goto wdr5y; goto encPa; awfKn: wdr5y: goto anDJu; qo2iF: $expire = self::MAX_COOKIE_LIFETIME; goto awfKn; cAwj_: return TRUE; goto clUEi; encPa: R7Atc: goto qo2iF; anDJu: set_cookie(["\x6e\x61\155\x65" => "\x6c\x61\156\x67\x5f\x63\x6f\x64\145", "\x76\x61\154\x75\x65" => $lang, "\145\x78\160\x69\162\145" => $expire]); goto cAwj_; clUEi: } public function set_session($user) { goto kL7C5; JvqNn: return TRUE; goto s6PK3; G4Nqo: $this->session->set_userdata($session_data); goto bLuBQ; bLuBQ: $this->trigger_events("\160\x6f\163\164\x5f\163\x65\164\137\x73\x65\163\163\x69\157\156"); goto JvqNn; kL7C5: $this->trigger_events("\x70\x72\x65\x5f\x73\x65\164\x5f\163\x65\x73\163\x69\157\156"); goto od3Lj; od3Lj: $session_data = ["\151\144\x65\x6e\x74\151\164\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\151\154" => $user->email, "\165\x73\x65\x72\137\151\x64" => $user->id, "\x6f\x6c\144\137\x6c\x61\163\164\137\x6c\157\x67\x69\x6e" => $user->last_login, "\x6c\x61\163\x74\x5f\143\x68\145\x63\153" => time()]; goto G4Nqo; s6PK3: } public function remember_user($identity) { goto TgJvP; EIfCP: return TRUE; goto x8MI6; r3h_g: $this->trigger_events(["\160\157\163\164\137\x72\145\x6d\145\155\x62\x65\162\x5f\165\x73\145\x72", "\x72\145\x6d\145\x6d\142\x65\x72\137\x75\x73\145\162\137\x73\x75\x63\143\x65\x73\x73\x66\x75\154"]); goto EIfCP; fssyR: $this->trigger_events(["\160\157\163\x74\x5f\x72\x65\x6d\145\155\142\x65\x72\137\165\163\145\162", "\x72\x65\x6d\x65\155\x62\145\162\137\165\x73\145\162\137\165\x6e\163\165\x63\143\x65\x73\x73\146\x75\x6c"]); goto A08M3; evDTQ: if ($identity) { goto rdSoM; } goto SVR_2; pWgZE: jXE3B: goto y16xv; y16xv: set_cookie(["\156\x61\x6d\145" => $this->config->item("\162\x65\x6d\145\155\142\x65\162\x5f\143\x6f\x6f\x6b\151\x65\x5f\x6e\141\x6d\x65", "\151\157\x6e\x5f\x61\165\x74\150"), "\166\x61\154\165\x65" => $token->user_code, "\x65\170\x70\x69\162\x65" => $expire]); goto r3h_g; TgJvP: $this->trigger_events("\x70\x72\145\137\x72\145\155\145\x6d\x62\145\x72\x5f\165\x73\145\x72"); goto evDTQ; JvKqn: goto jXE3B; goto ltXk4; pjYq6: mfIgg: goto fssyR; KgACe: $expire = $this->config->item("\165\x73\x65\162\x5f\145\x78\x70\151\162\145", "\151\157\x6e\137\141\165\164\x68"); goto JvKqn; x8MI6: FpnA7: goto pjYq6; Gyx0q: if (!$token->validator_hashed) { goto mfIgg; } goto nnhhr; A08M3: return FALSE; goto ebbY0; nnhhr: $this->db->update($this->tables["\x75\163\145\162\163"], ["\162\145\x6d\145\155\142\x65\162\x5f\x73\145\x6c\145\143\x74\157\x72" => $token->selector, "\162\145\x6d\145\x6d\x62\145\162\137\143\157\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto dF8zt; nuaXW: $token = $this->_generate_selector_validator_couple(); goto Gyx0q; BrtXu: if ($this->config->item("\165\163\145\162\137\x65\170\160\151\x72\145", "\151\x6f\x6e\x5f\x61\165\164\x68") === 0) { goto LQmq8; } goto KgACe; SVR_2: return FALSE; goto FuUIv; FcHnl: $expire = self::MAX_COOKIE_LIFETIME; goto pWgZE; ltXk4: LQmq8: goto FcHnl; FuUIv: rdSoM: goto nuaXW; dF8zt: if (!($this->db->affected_rows() > -1)) { goto FpnA7; } goto BrtXu; ebbY0: } public function login_remembered_user() { goto EysUI; iv1Bg: $this->remember_user($identity); goto gcp5M; tZ7Vv: $this->set_session($user); goto BI3tA; ML0Fe: $query = $this->db->select($this->identity_column . "\x2c\x20\x69\144\x2c\40\145\x6d\141\x69\x6c\x2c\x20\162\x65\155\x65\x6d\x62\x65\x72\137\143\157\144\x65\x2c\40\x6c\x61\x73\164\x5f\x6c\x6f\x67\151\156")->where("\x72\145\155\x65\x6d\x62\145\162\137\163\x65\x6c\145\x63\x74\157\x72", $token->selector)->where("\141\x63\164\x69\166\145", 1)->limit(1)->get($this->tables["\165\163\145\x72\163"]); goto AW37h; EysUI: $this->trigger_events("\160\x72\145\x5f\154\x6f\x67\x69\156\137\162\145\x6d\x65\x6d\x62\x65\x72\x65\144\x5f\x75\x73\x65\x72"); goto Jpj8s; AW37h: if (!($query->num_rows() === 1)) { goto SVKAk; } goto bMtqU; NIVLs: delete_cookie($this->config->item("\x72\145\x6d\145\155\x62\x65\162\x5f\x63\157\x6f\x6b\x69\x65\137\x6e\141\x6d\x65", "\x69\x6f\x6e\137\141\x75\x74\150")); goto q_H_Z; x8Zt6: SVKAk: goto NIVLs; gmAVw: b35aR: goto x8Zt6; mLe71: $this->trigger_events(["\x70\x6f\163\164\137\x6c\157\x67\151\156\137\162\145\155\145\x6d\x62\145\162\145\144\x5f\165\x73\145\162", "\x70\157\x73\164\137\x6c\x6f\x67\x69\x6e\x5f\x72\x65\x6d\145\x6d\142\x65\162\145\x64\x5f\x75\x73\x65\162\x5f\x73\x75\143\143\145\163\163\146\165\154"]); goto Pvy1W; mwxmY: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto b35aR; } goto Uv3Zt; AqH5c: return FALSE; goto x1LH1; R28ZK: if (!($token === FALSE)) { goto bsCz4; } goto gJuIL; bMtqU: $user = $query->row(); goto TR3wH; Ha0Cx: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto R28ZK; EuxaV: if (!$this->config->item("\165\163\x65\x72\137\x65\x78\164\145\x6e\x64\137\x6f\x6e\x5f\154\x6f\x67\x69\x6e", "\151\157\156\137\141\x75\x74\150")) { goto KxnZ2; } goto iv1Bg; Jpj8s: $remember_cookie = get_cookie($this->config->item("\x72\145\x6d\145\x6d\142\x65\x72\x5f\143\157\157\x6b\x69\145\x5f\156\x61\155\x65", "\151\x6f\x6e\x5f\141\165\164\150")); goto Ha0Cx; gcp5M: KxnZ2: goto FMX94; TR3wH: $identity = $user->{$this->identity_column}; goto mwxmY; pTgkk: $this->trigger_events("\x65\170\164\162\141\137\167\x68\145\162\x65"); goto ML0Fe; q_H_Z: $this->trigger_events(["\160\x6f\x73\x74\137\154\157\147\151\x6e\x5f\x72\145\155\145\155\x62\x65\x72\145\x64\137\165\163\145\162", "\x70\x6f\163\164\137\154\157\x67\x69\x6e\x5f\x72\x65\x6d\145\155\x62\x65\x72\145\144\137\x75\x73\x65\162\137\165\156\163\x75\143\143\145\163\x73\x66\165\x6c"]); goto AqH5c; gJuIL: $this->trigger_events(["\x70\157\x73\x74\137\154\x6f\147\151\156\x5f\x72\145\x6d\145\x6d\x62\145\162\145\x64\137\165\163\145\162", "\160\157\x73\x74\x5f\154\157\147\x69\156\x5f\162\145\x6d\145\x6d\142\145\162\145\x64\x5f\x75\x73\145\162\x5f\165\156\163\x75\x63\143\x65\163\x73\x66\x75\x6c"]); goto nsTIN; Uv3Zt: $this->update_last_login($user->id); goto tZ7Vv; nsTIN: return FALSE; goto VaMhB; BI3tA: $this->clear_forgotten_password_code($identity); goto EuxaV; FMX94: $this->session->sess_regenerate(FALSE); goto mLe71; Pvy1W: return TRUE; goto gmAVw; VaMhB: bsCz4: goto pTgkk; x1LH1: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto agwDk; cjNbK: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\160\x73"], $additional_data), $data); goto ioL_t; v5LxI: $group_id = $this->db->insert_id($this->tables["\147\x72\x6f\165\160\x73"] . "\137\151\144\137\x73\x65\161"); goto UFweK; FLWJf: return $group_id; goto FBpke; ZCqiS: return FALSE; goto Nlk1M; UambC: eELrM: goto qvR2P; We6kN: if (!($existing_group !== 0)) { goto dkkQW; } goto u9v0E; B4eTN: if (empty($additional_data)) { goto FpfVF; } goto cjNbK; K8AVW: $this->set_error("\x67\162\157\x75\x70\137\156\141\x6d\145\137\x72\145\x71\165\151\162\x65\x64"); goto o02mU; Nlk1M: dkkQW: goto GTRdW; qvR2P: $existing_group = $this->db->get_where($this->tables["\147\x72\157\165\160\x73"], ["\x6e\141\155\x65" => $group_name])->num_rows(); goto We6kN; o02mU: return FALSE; goto UambC; gy3RD: $this->db->insert($this->tables["\147\x72\157\x75\160\x73"], $data); goto v5LxI; YWPlG: $this->trigger_events("\145\170\x74\x72\141\137\x67\x72\x6f\165\x70\x5f\163\x65\164"); goto gy3RD; GTRdW: $data = ["\156\141\x6d\x65" => $group_name, "\x64\x65\x73\143\162\151\x70\x74\x69\x6f\156" => $group_description]; goto B4eTN; u9v0E: $this->set_error("\x67\x72\x6f\165\160\x5f\x61\154\162\x65\x61\144\x79\x5f\145\x78\x69\163\164\163"); goto ZCqiS; UFweK: $this->set_message("\x67\x72\x6f\165\160\137\143\162\x65\141\164\151\x6f\156\x5f\163\x75\143\x63\x65\163\x73\x66\x75\154"); goto FLWJf; ioL_t: FpfVF: goto YWPlG; agwDk: if ($group_name) { goto eELrM; } goto K8AVW; FBpke: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto IdULL; fCVxe: if (empty($group_name)) { goto NiE7b; } goto D7V5x; seEk0: return FALSE; goto ml_JT; Ysp0w: return FALSE; goto fWYhs; y417B: NiE7b: goto x33jR; Fp7e1: $data["\156\x61\x6d\145"] = $group_name; goto y417B; ml_JT: dKnSV: goto aZZWk; x33jR: $group = $this->db->get_where($this->tables["\147\162\x6f\x75\160\163"], ["\151\x64" => $group_id])->row(); goto HZTbE; ZV1lc: if (empty($additional_data)) { goto kbW87; } goto RRC5Z; nE5iQ: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto GrQcP; } goto wrwGw; IBx9c: $this->db->update($this->tables["\147\x72\x6f\165\x70\163"], $data, ["\x69\x64" => $group_id]); goto NGITj; IdULL: if (!empty($group_id)) { goto dKnSV; } goto seEk0; tYKFl: kbW87: goto IBx9c; RRC5Z: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\x75\160\163"], $additional_data), $data); goto tYKFl; A0M2Y: return FALSE; goto ivZnS; ivZnS: GrQcP: goto Fp7e1; HZTbE: if (!($this->config->item("\x61\144\x6d\x69\156\137\x67\x72\x6f\x75\x70", "\x69\x6f\156\x5f\141\165\164\x68") === $group->name && $group_name !== $group->name)) { goto q2CGB; } goto YMzsr; YMzsr: $this->set_error("\x67\x72\157\x75\x70\x5f\x6e\x61\155\145\137\x61\144\x6d\x69\x6e\x5f\x6e\157\164\137\141\x6c\164\x65\162"); goto Ysp0w; aZZWk: $data = []; goto fCVxe; fWYhs: q2CGB: goto ZV1lc; wrwGw: $this->set_error("\x67\x72\157\165\x70\137\x61\154\x72\145\141\144\x79\137\x65\x78\x69\x73\164\x73"); goto A0M2Y; RB0Cf: return TRUE; goto cqce9; NGITj: $this->set_message("\147\x72\157\165\160\x5f\x75\160\144\141\x74\145\x5f\163\x75\143\143\145\163\x73\146\x75\154"); goto RB0Cf; D7V5x: $existing_group = $this->db->get_where($this->tables["\x67\162\157\165\x70\163"], ["\x6e\x61\155\145" => $group_name])->row(); goto nE5iQ; cqce9: } public function delete_group($group_id = FALSE) { goto O2JHV; RYLcL: $this->set_error("\147\162\157\165\160\137\x64\145\154\145\164\x65\137\x6e\157\164\x61\x6c\154\157\167\x65\x64"); goto lfALe; UMri6: $this->trigger_events(["\x70\x6f\x73\164\x5f\x64\145\154\145\x74\145\137\x67\x72\157\x75\x70", "\160\157\163\x74\137\144\x65\x6c\145\x74\145\x5f\x67\162\x6f\165\160\x5f\x75\x6e\x73\165\x63\x63\145\x73\163\146\165\154"]); goto fv3YK; GMk7A: return FALSE; goto lkCwf; Vn0ki: nVUAy: goto lFIiP; yO2u9: $this->db->delete($this->tables["\x75\x73\145\162\163\137\147\x72\157\x75\x70\x73"], [$this->join["\147\x72\157\165\x70\163"] => $group_id]); goto oBHGY; O2JHV: if (!(!$group_id || empty($group_id))) { goto SHMlQ; } goto UStMF; nXDvE: $this->trigger_events(["\x70\157\163\x74\137\x64\x65\x6c\x65\x74\x65\137\147\162\157\165\160", "\160\157\x73\x74\137\144\x65\x6c\145\164\x65\137\147\162\x6f\x75\x70\137\163\165\143\143\x65\x73\x73\x66\165\154"]); goto zD8o9; fv3YK: $this->set_error("\x67\162\x6f\165\x70\x5f\x64\x65\154\145\164\x65\137\x75\x6e\163\165\143\x63\x65\163\x73\146\165\x6c"); goto GMk7A; zD8o9: $this->set_message("\x67\162\157\165\x70\x5f\144\145\x6c\145\x74\x65\x5f\163\x75\143\x63\145\x73\x73\x66\x75\x6c"); goto CPDws; lkCwf: VIhig: goto tSOyC; lFIiP: $this->trigger_events("\160\x72\145\137\x64\145\154\145\164\x65\x5f\x67\x72\x6f\165\160"); goto u55Io; cFcKH: SHMlQ: goto W4eND; lfALe: return FALSE; goto Vn0ki; kCwMg: $this->trigger_events(["\160\157\163\164\x5f\x64\145\x6c\x65\164\x65\137\x67\162\157\165\x70", "\x70\x6f\x73\x74\137\144\x65\154\x65\164\145\137\147\162\157\165\x70\x5f\156\157\164\141\154\154\x6f\167\x65\144"]); goto RYLcL; UStMF: return FALSE; goto cFcKH; oBHGY: $this->db->delete($this->tables["\147\x72\x6f\x75\160\163"], ["\151\144" => $group_id]); goto TyetB; CPDws: return TRUE; goto i5b_J; CjqJc: $this->db->trans_rollback(); goto UMri6; tSOyC: $this->db->trans_commit(); goto nXDvE; u55Io: $this->db->trans_begin(); goto yO2u9; TyetB: if (!($this->db->trans_status() === FALSE)) { goto VIhig; } goto CjqJc; q3jNv: if (!($group->name == $this->config->item("\x61\x64\x6d\151\156\137\x67\x72\x6f\165\160", "\151\x6f\x6e\137\x61\165\x74\150"))) { goto nVUAy; } goto kCwMg; W4eND: $group = $this->group($group_id)->row(); goto q3jNv; i5b_J: } public function set_hook($event, $name, $class, $method, $arguments) { goto f3xX4; DACCH: $this->_ion_hooks->{$event}[$name]->method = $method; goto HXFuT; Lm848: $this->_ion_hooks->{$event}[$name]->class = $class; goto DACCH; f3xX4: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto Lm848; HXFuT: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto X1ZaC; X1ZaC: } public function remove_hook($event, $name) { goto NynXO; NynXO: if (!isset($this->_ion_hooks->{$event}[$name])) { goto bPdgo; } goto xYETu; I_OcN: bPdgo: goto r1LB2; xYETu: unset($this->_ion_hooks->{$event}[$name]); goto I_OcN; r1LB2: } public function remove_hooks($event) { goto SwAhj; YLvRR: unset($this->_ion_hooks->{$event}); goto rcXrX; SwAhj: if (!isset($this->_ion_hooks->{$event})) { goto Cyk2H; } goto YLvRR; rcXrX: Cyk2H: goto DYopb; DYopb: } protected function _call_hook($event, $name) { goto BjH0R; qcN0Z: u1hhc: goto ja8TV; BjH0R: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto u1hhc; } goto QoNis; QoNis: $hook = $this->_ion_hooks->{$event}[$name]; goto XYPcM; XYPcM: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto qcN0Z; ja8TV: return FALSE; goto OgavZ; OgavZ: } public function trigger_events($events) { goto zaOxJ; FuGNt: GI30C: goto V4XWB; MGVQt: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto pUzlq; } goto BTDpy; zaOxJ: if (is_array($events) && !empty($events)) { goto MlV0a; } goto MGVQt; teCDW: foreach ($events as $event) { $this->trigger_events($event); DOd0m: } goto u1ayi; BTDpy: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); ETUad: } goto UrooP; jOIFV: MlV0a: goto teCDW; UrooP: hB_UM: goto JEEO6; TUWfT: goto GI30C; goto jOIFV; JEEO6: pUzlq: goto TUWfT; u1ayi: ILYVt: goto FuGNt; V4XWB: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto BYHeD; BYHeD: $this->message_start_delimiter = $start_delimiter; goto dtHRH; bYcSw: return TRUE; goto yjmdb; dtHRH: $this->message_end_delimiter = $end_delimiter; goto bYcSw; yjmdb: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto DNrm_; DNrm_: $this->error_start_delimiter = $start_delimiter; goto EaAfF; EaAfF: $this->error_end_delimiter = $end_delimiter; goto B9Xrx; B9Xrx: return TRUE; goto xNoPk; xNoPk: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto HpyuL; IrkuM: return $_output; goto F2mDH; HpyuL: $_output = ''; goto mjEzm; VB8TF: IfrOo: goto IrkuM; mjEzm: foreach ($this->messages as $message) { goto GH4Hn; GH4Hn: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto bt4SS; bt4SS: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto ZVeA2; ZVeA2: fayc8: goto ZEU4t; ZEU4t: } goto VB8TF; F2mDH: } public function messages_array($langify = TRUE) { goto sjEFM; T1FYm: $_output = []; goto zfui2; uGM2r: eUO29: goto WQeP2; FyPgI: return $_output; goto uGM2r; TOutv: moHcP: goto FyPgI; NMGuB: jVUHw: goto T1FYm; MBioc: return $this->messages; goto LEFV_; sjEFM: if ($langify) { goto jVUHw; } goto MBioc; zfui2: foreach ($this->messages as $message) { goto uWekW; dsjSc: pz9zm: goto xMY38; uWekW: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\x23\x23"; goto wQyMu; wQyMu: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto dsjSc; xMY38: } goto TOutv; LEFV_: goto eUO29; goto NMGuB; WQeP2: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto w2wFd; w2wFd: $_output = ''; goto uvzMU; uvzMU: foreach ($this->errors as $error) { goto UKgHy; IGUa7: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto gbnE3; UKgHy: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\43"; goto IGUa7; gbnE3: pQfdC: goto Cwrwy; Cwrwy: } goto eUCQl; eUCQl: NO_3Y: goto pM6yY; pM6yY: return $_output; goto j4Sty; j4Sty: } public function errors_array($langify = TRUE) { goto BhXY_; rgZ27: goto fGxJz; goto qETT8; DmKdA: return $_output; goto sluKw; ELBQy: $_output = []; goto aL5zQ; sluKw: fGxJz: goto nOytW; Di6LV: return $this->errors; goto rgZ27; a48VT: XgEqg: goto DmKdA; qETT8: iazE0: goto ELBQy; BhXY_: if ($langify) { goto iazE0; } goto Di6LV; aL5zQ: foreach ($this->errors as $error) { goto xV9y5; alQ6u: BYRR0: goto ZJy2R; oIvLG: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto alQ6u; xV9y5: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto oIvLG; ZJy2R: } goto a48VT; nOytW: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto DODUW; pHMez: if (!($hash === FALSE)) { goto Nfljx; } goto LPIpI; cEr0b: $this->trigger_events("\145\170\164\x72\141\137\167\150\145\162\145"); goto R0O5b; R0O5b: $this->db->update($this->tables["\165\163\145\x72\163"], $data, [$this->identity_column => $identity]); goto oVqy6; DODUW: $hash = $this->hash_password($password, $identity); goto pHMez; LPIpI: return FALSE; goto nT51P; ykhig: $data = ["\x70\141\x73\163\x77\157\x72\144" => $hash, "\162\145\155\x65\x6d\142\x65\162\x5f\143\157\x64\x65" => NULL, "\146\x6f\x72\x67\157\x74\x74\145\156\x5f\160\141\x73\x73\x77\x6f\x72\144\137\143\157\144\x65" => NULL, "\146\x6f\162\x67\157\164\164\x65\x6e\x5f\160\141\x73\x73\x77\x6f\x72\144\x5f\164\x69\155\x65" => NULL]; goto cEr0b; oVqy6: return $this->db->affected_rows() == 1; goto wcPoD; nT51P: Nfljx: goto ykhig; wcPoD: } protected function _filter_data($table, $data) { goto VBen5; gbVpX: if (!is_array($data)) { goto uge9m; } goto Ua0y4; VBen5: $filtered_data = []; goto sSi4Y; Z4M12: uge9m: goto X3TuA; Ua0y4: foreach ($columns as $column) { goto xCB9e; yJ8l6: F1Cff: goto hv3ei; xCB9e: if (!array_key_exists($column, $data)) { goto NNS8T; } goto WmuN9; OTJ83: NNS8T: goto yJ8l6; WmuN9: $filtered_data[$column] = $data[$column]; goto OTJ83; hv3ei: } goto eFFkC; eFFkC: ZM60U: goto Z4M12; sSi4Y: $columns = $this->db->list_fields($table); goto gbVpX; X3TuA: return $filtered_data; goto KGkbg; KGkbg: } protected function _random_token($result_length = 32) { goto AlWkZ; QTLB1: return FALSE; goto ZTuXL; qPzbM: d2VIR: goto gez91; aq973: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto qPzbM; nJ9Ct: if (!function_exists("\155\x63\x72\x79\160\x74\x5f\143\162\x65\x61\164\145\137\151\x76")) { goto d2VIR; } goto aq973; hrHmy: oE5Hl: goto nJ9Ct; AlWkZ: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto ZYBfY; } goto bu7f6; aT5L7: if (!function_exists("\x72\141\x6e\x64\x6f\x6d\x5f\x62\171\164\x65\163")) { goto oE5Hl; } goto U6ZE7; RHiZd: qARbn: goto QTLB1; bu7f6: $result_length = 32; goto iYCXd; gez91: if (!function_exists("\x6f\x70\145\156\x73\163\154\137\162\141\x6e\x64\157\155\x5f\x70\x73\145\x75\144\157\137\x62\x79\x74\145\163")) { goto qARbn; } goto oujTf; iYCXd: ZYBfY: goto aT5L7; U6ZE7: return bin2hex(random_bytes($result_length / 2)); goto hrHmy; oujTf: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto RHiZd; ZTuXL: } protected function _get_hash_parameters($identity = NULL) { goto hNAs5; X0oVE: if (!($user_id && $this->in_group($this->config->item("\141\144\155\151\156\137\x67\162\157\165\160", "\x69\157\x6e\137\x61\165\164\150"), $user_id))) { goto IC4nL; } goto MUo9x; CRrX8: return $params; goto rN928; SyuJ2: switch ($this->hash_method) { case "\x62\x63\x72\171\x70\x74": $params = ["\x63\x6f\163\164" => $is_admin ? $this->config->item("\x62\x63\x72\x79\160\x74\137\x61\144\x6d\x69\156\137\x63\x6f\163\x74", "\151\157\156\137\x61\x75\x74\150") : $this->config->item("\142\x63\x72\x79\x70\x74\x5f\144\145\x66\141\165\154\164\137\143\x6f\163\164", "\x69\x6f\156\x5f\x61\x75\164\150")]; goto lgt_n; case "\x61\x72\147\x6f\156\62": $params = $is_admin ? $this->config->item("\141\162\147\x6f\x6e\x32\137\x61\x64\x6d\x69\x6e\137\x70\x61\x72\141\155\163", "\151\x6f\x6e\x5f\x61\165\x74\150") : $this->config->item("\x61\162\x67\x6f\156\62\137\x64\x65\146\x61\x75\154\x74\x5f\160\x61\x72\141\x6d\163", "\x69\157\x6e\x5f\141\x75\164\150"); goto lgt_n; default: } goto U7Ge_; ECRsG: $user_id = $this->get_user_id_from_identity($identity); goto X0oVE; Mi184: rNQYO: goto IYb94; bqOGH: IC4nL: goto Mi184; hNAs5: $is_admin = FALSE; goto A1NHn; A1NHn: if (!$identity) { goto rNQYO; } goto ECRsG; n1QmB: lgt_n: goto CRrX8; IYb94: $params = FALSE; goto SyuJ2; U7Ge_: fm3ir: goto n1QmB; MUo9x: $is_admin = TRUE; goto bqOGH; rN928: } protected function _get_hash_algo() { goto SDx1Y; SDx1Y: $algo = FALSE; goto FLj5n; Ge10I: ZUICg: goto WcpQh; KcFZi: return $algo; goto LCeFp; WcpQh: vSO5J: goto KcFZi; FLj5n: switch ($this->hash_method) { case "\142\x63\x72\x79\x70\164": $algo = PASSWORD_BCRYPT; goto vSO5J; case "\x61\162\x67\157\156\62": $algo = PASSWORD_ARGON2I; goto vSO5J; default: } goto Ge10I; LCeFp: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto e74U3; e74U3: $selector = $this->_random_token($selector_size); goto SZJ0D; UvRcQ: $user_code = "{$selector}\56{$validator}"; goto ZRUUr; tgqaG: $validator_hashed = $this->hash_password($validator); goto UvRcQ; SZJ0D: $validator = $this->_random_token($validator_size); goto tgqaG; ZRUUr: return (object) ["\x73\x65\x6c\145\x63\164\157\162" => $selector, "\x76\141\154\151\x64\x61\164\157\x72\x5f\x68\x61\x73\150\145\x64" => $validator_hashed, "\x75\163\x65\x72\x5f\143\157\144\145" => $user_code]; goto lzhhL; lzhhL: } protected function _retrieve_selector_validator_couple($user_code) { goto I2FMe; TvAYO: aJpC_: goto R3iWd; BI98L: $tokens = explode("\x2e", $user_code); goto RRCER; R3iWd: OAps2: goto TMZ1m; I2FMe: if (!$user_code) { goto OAps2; } goto BI98L; TMZ1m: return FALSE; goto AeFss; RRCER: if (!(count($tokens) === 2)) { goto aJpC_; } goto znZL7; znZL7: return (object) ["\163\x65\x6c\145\143\x74\x6f\x72" => $tokens[0], "\166\141\x6c\151\144\x61\x74\x6f\x72" => $tokens[1]]; goto TvAYO; AeFss: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto ALJ1A; BnSId: return $result; goto Dnzy1; qS0yq: $this->trigger_events(["\x70\x6f\x73\x74\x5f\163\x68\141\x31\x5f\x70\x61\163\x73\x77\x6f\x72\x64\137\x6d\151\147\162\141\164\x69\x6f\156", "\160\x6f\x73\164\137\163\150\x61\61\137\x70\141\x73\x73\167\157\162\144\137\155\151\x67\162\141\164\x69\x6f\156\x5f\165\x6e\x73\165\143\x63\145\x73\163\x66\165\154"]); goto IGTYj; HmDvw: goto EUuSZ; goto nsnym; nVnBh: $salt_length = $this->config->item("\x73\141\x6c\x74\x5f\154\x65\x6e\x67\164\150", "\151\x6f\x6e\x5f\141\x75\x74\150"); goto JeFDY; pNpgu: EUuSZ: goto NHr42; YvsAt: $this->trigger_events(["\160\x6f\x73\x74\137\163\x68\x61\x31\137\x70\141\x73\x73\x77\157\162\144\137\155\151\147\x72\x61\x74\151\x6f\x6e", "\x70\157\163\164\137\x73\150\141\x31\x5f\x70\141\x73\163\x77\157\x72\x64\137\155\151\147\x72\x61\164\151\157\x6e\x5f\165\156\163\165\143\x63\x65\x73\x73\x66\165\154"]); goto Kd3DA; eVS0X: if ($this->config->item("\x73\164\x6f\162\x65\137\163\x61\x6c\x74", "\151\x6f\156\x5f\141\165\x74\x68")) { goto IR3Do; } goto nVnBh; Kd3DA: return FALSE; goto meSwB; IGTYj: goto nvdeE; goto Je1fZ; eMSm8: KPOYf: goto UC0fn; vBxdL: nvdeE: goto BnSId; Dnzy1: P_o9G: goto Bk54P; m7wGL: $this->trigger_events(["\x70\x6f\163\164\x5f\163\150\141\x31\x5f\160\141\x73\x73\x77\x6f\162\144\x5f\x6d\151\147\x72\x61\x74\x69\157\x6e", "\x70\x6f\163\x74\137\163\150\x61\x31\x5f\160\141\x73\x73\167\157\x72\144\137\x6d\x69\x67\x72\141\x74\x69\x6f\x6e\x5f\x75\x6e\163\165\143\x63\145\x73\x73\146\165\x6c"]); goto W31hR; JeFDY: if ($salt_length) { goto Xcy9y; } goto yJsvT; Je1fZ: JQw4B: goto uWisF; sikus: if ($result) { goto JQw4B; } goto qS0yq; Gu_lV: $salt = substr($hashed_password_db, 0, $salt_length); goto YzucW; ALJ1A: $this->trigger_events("\x70\x72\x65\x5f\x73\150\141\x31\137\160\x61\x73\x73\x77\157\x72\144\x5f\x6d\151\x67\162\x61\x74\151\157\156"); goto eVS0X; ArmvQ: $hashed_password = sha1($password . $salt_db->salt); goto pNpgu; meSwB: goto P_o9G; goto eMSm8; zgwFf: zIZ_m: goto ArmvQ; A2EJJ: $salt_db = $query->row(); goto mysHD; uWisF: $this->trigger_events(["\160\157\163\164\137\163\150\141\x31\x5f\x70\x61\163\163\167\x6f\x72\144\137\x6d\x69\x67\x72\x61\x74\x69\x6f\x6e", "\x70\x6f\x73\x74\x5f\163\x68\x61\61\137\160\x61\x73\x73\x77\x6f\162\144\137\x6d\151\x67\x72\141\x74\151\157\x6e\x5f\163\x75\x63\x63\145\x73\x73\146\165\x6c"]); goto vBxdL; rCq0J: Xcy9y: goto Gu_lV; yJsvT: $this->trigger_events(["\160\157\x73\x74\137\163\150\x61\61\x5f\160\x61\163\x73\167\x6f\162\144\137\x6d\151\147\162\x61\x74\151\x6f\x6e", "\x70\x6f\x73\x74\137\163\x68\x61\61\x5f\x70\141\x73\163\167\157\162\x64\x5f\155\x69\x67\x72\141\164\151\157\156\x5f\x75\156\x73\x75\143\143\145\x73\x73\146\165\154"]); goto FoXUl; YzucW: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto HmDvw; nsnym: IR3Do: goto z2nLL; UC0fn: $result = $this->_set_password_db($identity, $password); goto sikus; NHr42: if ($hashed_password === $hashed_password_db) { goto KPOYf; } goto YvsAt; mysHD: if (!($query->num_rows() !== 1)) { goto zIZ_m; } goto m7wGL; W31hR: return FALSE; goto zgwFf; z2nLL: $query = $this->db->select("\163\141\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\163"]); goto A2EJJ; FoXUl: return FALSE; goto rCq0J; Bk54P: } }
