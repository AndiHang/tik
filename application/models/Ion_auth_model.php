<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\x50\101\x54\110") or exit("\116\x6f\x20\144\x69\162\x65\143\x74\40\163\x63\x72\151\160\x74\x20\141\143\143\145\x73\163\40\x61\154\x6c\x6f\x77\145\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto oCs8a; eSJoz: $this->load->helper("\144\141\164\x65"); goto I05lt; VJsmm: $this->identity_column = $this->config->item("\151\x64\145\156\164\x69\x74\171", "\x69\x6f\x6e\137\141\165\x74\150"); goto RoO2t; QSwYf: $this->db = $this->load->database($group_name, TRUE, TRUE); goto P6BbB; msnXa: $this->message_end_delimiter = $this->config->item("\x6d\x65\163\163\x61\147\145\137\145\x6e\x64\x5f\x64\x65\154\151\155\x69\164\145\x72", "\151\x6f\x6e\x5f\141\165\x74\x68"); goto wefP7; RoO2t: $this->join = $this->config->item("\x6a\x6f\151\x6e", "\151\157\x6e\x5f\141\165\164\x68"); goto rJ97W; yhyQw: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto IjZnN; I05lt: $this->lang->load("\151\x6f\x6e\137\x61\165\164\150"); goto NS4Sc; Ug87W: $this->db = $CI->db; goto F6mI5; vLGtr: $error_prefix->setAccessible(TRUE); goto yhyQw; LoA48: $form_validation_class = new ReflectionClass("\103\x49\x5f\106\157\162\x6d\137\166\x61\x6c\x69\144\x61\164\x69\157\x6e"); goto WjR9V; hfAm8: IAWZU: goto bssrh; NS4Sc: $group_name = $this->config->item("\144\141\164\141\142\x61\x73\x65\137\147\162\x6f\x75\160\137\x6e\x61\x6d\145", "\x69\157\x6e\137\141\x75\164\x68"); goto iqbk1; cwJ4Q: $this->errors = []; goto hpGJV; fzIAS: $error_suffix->setAccessible(TRUE); goto HYEPS; jwd32: $this->_ion_hooks = new stdClass(); goto WRO1J; WRO1J: $this->trigger_events("\x6d\157\x64\145\x6c\x5f\143\x6f\x6e\163\x74\162\165\x63\164\157\x72"); goto yPKmB; iqbk1: if (empty($group_name)) { goto IAWZU; } goto QSwYf; IjZnN: $this->message_start_delimiter = $this->error_start_delimiter; goto rCrwz; oCs8a: $this->config->load("\151\x6f\x6e\137\x61\x75\164\150", TRUE); goto dqrGU; dqrGU: $this->load->helper("\143\157\157\153\x69\145"); goto eSJoz; wefP7: $this->error_start_delimiter = $this->config->item("\x65\162\162\x6f\x72\137\163\164\141\162\x74\137\144\x65\x6c\151\x6d\151\x74\145\162", "\151\x6f\156\x5f\x61\165\164\x68"); goto HanOk; rCrwz: $error_suffix = $form_validation_class->getProperty("\x5f\x65\x72\x72\157\x72\x5f\163\x75\x66\146\x69\x78"); goto fzIAS; bssrh: $CI =& get_instance(); goto Ug87W; WjR9V: $error_prefix = $form_validation_class->getProperty("\x5f\145\162\162\157\x72\137\x70\x72\x65\146\x69\170"); goto vLGtr; HanOk: $this->error_end_delimiter = $this->config->item("\145\162\162\x6f\x72\137\x65\x6e\144\137\x64\145\x6c\x69\x6d\151\x74\145\x72", "\151\x6f\x6e\137\141\165\164\x68"); goto eT9Mm; n26yg: SRuMq: goto UavPR; hpGJV: $delimiters_source = $this->config->item("\144\x65\154\x69\x6d\x69\164\145\162\x73\x5f\163\x6f\165\x72\143\x65", "\151\x6f\x6e\137\141\165\164\150"); goto q6FT5; q6FT5: if ($delimiters_source === "\146\157\x72\155\137\x76\x61\154\151\x64\x61\x74\x69\157\x6e") { goto SRuMq; } goto NdcWb; HYEPS: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto Mb_x7; HflXQ: $this->messages = []; goto cwJ4Q; f0icT: $this->tables = $this->config->item("\164\x61\x62\154\145\163", "\151\x6f\156\x5f\x61\165\164\150"); goto VJsmm; F6mI5: sI1EL: goto f0icT; rJ97W: $this->hash_method = $this->config->item("\x68\141\x73\x68\x5f\x6d\145\x74\150\x6f\x64", "\x69\157\x6e\x5f\141\x75\x74\150"); goto HflXQ; P6BbB: goto sI1EL; goto hfAm8; Mb_x7: $this->message_end_delimiter = $this->error_end_delimiter; goto wxLo6; NdcWb: $this->message_start_delimiter = $this->config->item("\155\x65\x73\x73\x61\x67\145\137\x73\164\x61\x72\x74\137\144\x65\x6c\151\155\x69\164\x65\162", "\151\x6f\x6e\137\141\165\x74\150"); goto msnXa; UavPR: $this->load->library("\x66\157\x72\x6d\x5f\166\x61\x6c\x69\144\141\164\151\x6f\x6e"); goto LoA48; eT9Mm: goto n4FlY; goto n26yg; wxLo6: n4FlY: goto jwd32; yPKmB: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto h67FQ; h67FQ: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto SSgzz; } goto Qzxj5; KTOXd: $params = $this->_get_hash_parameters($identity); goto dLPlq; Ly4VN: zO3Pi: goto rZZLX; dLPlq: if (!($algo !== FALSE && $params !== FALSE)) { goto zO3Pi; } goto R2n29; Qzxj5: return FALSE; goto sbA_1; R2n29: return password_hash($password, $algo, $params); goto Ly4VN; BwGM0: $algo = $this->_get_hash_algo(); goto KTOXd; sbA_1: SSgzz: goto BwGM0; rZZLX: return FALSE; goto hngkU; hngkU: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto ocl2d; ocl2d: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto DxSFz; } goto HgfAG; HgfAG: return FALSE; goto raJmS; TYz9l: if (strpos($hash_password_db, "\x24") === 0) { goto TQZJz; } goto WRuw3; RrO2Q: N3cQR: goto YPS0b; WRuw3: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto qCzkm; AmjkY: TQZJz: goto c9pya; qCzkm: goto N3cQR; goto AmjkY; c9pya: return password_verify($password, $hash_password_db); goto RrO2Q; raJmS: DxSFz: goto TYz9l; YPS0b: } public function rehash_password_if_needed($hash, $identity, $password) { goto ULtBC; ZJEPT: q2i8o: goto nwLzW; HlwHK: $params = $this->_get_hash_parameters($identity); goto S5p5H; ULtBC: $algo = $this->_get_hash_algo(); goto HlwHK; bxeXo: $this->trigger_events(["\x72\x65\x68\x61\163\x68\137\160\141\163\x73\167\157\162\144", "\x72\145\x68\x61\x73\150\137\160\x61\163\x73\167\157\x72\144\x5f\x73\165\143\x63\x65\x73\x73\146\x75\154"]); goto ZJEPT; nwLzW: RQoOT: goto AQEJY; ThYFv: $this->trigger_events(["\162\145\x68\x61\163\x68\x5f\160\141\x73\x73\167\157\162\144", "\x72\145\x68\141\x73\150\x5f\160\141\x73\163\x77\157\162\x64\x5f\165\x6e\163\x75\x63\x63\145\163\x73\146\x75\x6c"]); goto FngZ_; FVnWN: if (!password_needs_rehash($hash, $algo, $params)) { goto RQoOT; } goto e2PJj; AQEJY: PQR0Z: goto aDFzI; h4NIb: Pxe2U: goto bxeXo; S5p5H: if (!($algo !== FALSE && $params !== FALSE)) { goto PQR0Z; } goto FVnWN; FngZ_: goto q2i8o; goto h4NIb; e2PJj: if ($this->_set_password_db($identity, $password)) { goto Pxe2U; } goto ThYFv; aDFzI: } public function get_user_by_activation_code($user_code) { goto l2FLa; nRSa5: leL61: goto U_9vT; U_9vT: return FALSE; goto KCUKK; l2FLa: $token = $this->_retrieve_selector_validator_couple($user_code); goto XibvO; XibvO: $user = $this->where("\141\x63\164\151\166\x61\x74\151\x6f\x6e\137\x73\x65\x6c\x65\x63\164\x6f\162", $token->selector)->users()->row(); goto X8QNZ; X8QNZ: if (!$user) { goto leL61; } goto NlAEy; RlHLn: x38Sj: goto nRSa5; tQc9S: return $user; goto RlHLn; NlAEy: if (!$this->verify_password($token->validator, $user->activation_code)) { goto x38Sj; } goto tQc9S; KCUKK: } public function activate($id, $code = FALSE) { goto O6Jcw; zbase: $this->set_message("\x61\143\164\x69\166\x61\164\x65\137\x73\x75\x63\143\x65\x73\x73\146\x75\154"); goto DZK1S; v_ZwB: R2BLE: goto ncdwV; S32US: $this->trigger_events("\145\170\164\x72\x61\137\167\x68\145\162\145"); goto PEmmw; ncdwV: ISV2u: goto SGedZ; SGedZ: $this->trigger_events(["\160\x6f\x73\164\x5f\x61\143\164\x69\166\141\164\145", "\x70\x6f\163\x74\137\141\143\x74\151\x76\141\x74\145\x5f\165\x6e\163\x75\143\x63\x65\x73\163\146\165\x6c"]); goto IaJuU; T0KdY: $this->trigger_events(["\160\x6f\163\x74\137\x61\143\164\x69\166\141\x74\145", "\160\157\163\164\x5f\x61\143\164\x69\166\141\x74\145\x5f\x73\x75\143\x63\x65\163\x73\x66\x75\154"]); goto zbase; qONj_: if (!($code !== FALSE)) { goto lkA7N; } goto z42AT; RVIiK: if (!($code === FALSE || $user && $user->id === $id)) { goto ISV2u; } goto FAtg6; bR3VQ: return FALSE; goto dE2mY; PEmmw: $this->db->update($this->tables["\165\x73\x65\x72\163"], $data, ["\x69\x64" => $id]); goto D1CTv; DZK1S: return TRUE; goto v_ZwB; jXylr: lkA7N: goto RVIiK; O6Jcw: $this->trigger_events("\x70\162\x65\137\141\143\x74\151\166\141\x74\x65"); goto qONj_; z42AT: $user = $this->get_user_by_activation_code($code); goto jXylr; FAtg6: $data = ["\x61\143\164\x69\166\x61\164\x69\x6f\x6e\137\x73\145\x6c\145\x63\164\157\x72" => NULL, "\141\143\164\x69\166\141\x74\x69\157\x6e\137\143\157\x64\145" => NULL, "\x61\143\x74\x69\166\x65" => 1]; goto S32US; IaJuU: $this->set_error("\x61\x63\164\x69\166\141\164\145\x5f\165\156\163\x75\x63\x63\x65\x73\x73\x66\165\154"); goto bR3VQ; D1CTv: if (!($this->db->affected_rows() === 1)) { goto R2BLE; } goto T0KdY; dE2mY: } public function deactivate($id = NULL) { goto kab4k; G785d: $this->trigger_events("\x65\170\164\x72\141\x5f\x77\150\x65\x72\145"); goto irnPS; VA7_j: return FALSE; goto sypve; aHg5p: YRDWE: goto gDWPT; HIbzP: goto Uc6dC; goto aHg5p; kab4k: $this->trigger_events("\x64\x65\x61\143\x74\151\x76\x61\164\145"); goto eUWj6; CKSsb: goto daD0D; goto ZKWtm; ALThy: $this->set_error("\x64\x65\141\x63\x74\151\x76\141\164\x65\137\143\x75\162\x72\145\156\164\137\165\163\x65\x72\x5f\x75\x6e\163\165\x63\143\x65\163\163\146\x75\x6c"); goto jMEWy; sypve: Uc6dC: goto qlBXC; A_Lxp: $return = $this->db->affected_rows() == 1; goto eBtlh; gDWPT: $this->set_error("\144\145\x61\143\164\x69\166\x61\x74\145\x5f\x75\156\x73\x75\x63\x63\145\x73\163\146\x75\x6c"); goto VA7_j; yjY6p: $this->set_message("\144\145\141\x63\164\151\x76\141\x74\x65\137\163\165\143\143\145\163\163\x66\165\154"); goto S_2vz; jMEWy: return FALSE; goto N8oRS; eBtlh: if ($return) { goto lWnP_; } goto e6YFW; S_2vz: daD0D: goto cSjix; WBa1k: $this->activation_code = $token->user_code; goto ETQJ7; e6YFW: $this->set_error("\144\x65\141\143\164\151\x76\141\164\x65\x5f\x75\x6e\x73\x75\x63\143\145\163\x73\146\165\x6c"); goto CKSsb; N8oRS: Re0LK: goto HIbzP; qlBXC: $token = $this->_generate_selector_validator_couple(20, 40); goto WBa1k; I9X7p: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto Re0LK; } goto ALThy; ZKWtm: lWnP_: goto yjY6p; ETQJ7: $data = ["\x61\x63\164\151\166\x61\x74\151\157\x6e\137\163\x65\154\x65\x63\x74\157\x72" => $token->selector, "\x61\x63\164\151\x76\141\x74\151\x6f\156\137\x63\157\144\x65" => $token->validator_hashed, "\x61\143\x74\151\166\145" => 0]; goto G785d; eUWj6: if (!isset($id)) { goto YRDWE; } goto I9X7p; cSjix: return $return; goto ZCKn7; irnPS: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, ["\151\144" => $id]); goto A_Lxp; ZCKn7: } public function clear_forgotten_password_code($identity) { goto PTMl5; xb6Tn: return TRUE; goto zPDjB; fEJxR: f4hFf: goto yXsdH; yXsdH: $data = ["\x66\157\x72\x67\157\x74\x74\x65\x6e\x5f\160\x61\x73\163\x77\157\x72\144\x5f\163\x65\x6c\145\143\x74\157\162" => NULL, "\146\157\x72\147\x6f\164\x74\145\156\x5f\160\141\x73\163\x77\x6f\x72\x64\137\x63\157\x64\x65" => NULL, "\x66\157\162\x67\157\x74\164\x65\x6e\137\x70\141\x73\x73\167\157\x72\x64\x5f\164\151\155\145" => NULL]; goto d34th; MUTmz: return FALSE; goto fEJxR; PTMl5: if (!empty($identity)) { goto f4hFf; } goto MUTmz; d34th: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, [$this->identity_column => $identity]); goto xb6Tn; zPDjB: } public function clear_remember_code($identity) { goto xiVDq; WJP3B: $data = ["\x72\145\155\x65\x6d\142\x65\162\137\163\145\x6c\x65\x63\164\x6f\x72" => NULL, "\x72\x65\155\145\x6d\142\145\x72\x5f\143\157\144\x65" => NULL]; goto AU14P; yNXYd: return TRUE; goto uXKDx; Hrtfb: return FALSE; goto e4yOg; e4yOg: MNVyq: goto WJP3B; xiVDq: if (!empty($identity)) { goto MNVyq; } goto Hrtfb; AU14P: $this->db->update($this->tables["\165\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto yNXYd; uXKDx: } public function reset_password($identity, $new) { goto w08wY; pJjEp: return $return; goto ljA1G; rGaAX: i1QtV: goto Y_MFo; w08wY: $this->trigger_events("\160\x72\145\137\143\150\x61\x6e\147\145\137\160\141\x73\x73\x77\157\x72\144"); goto vEz59; hTkFS: $this->set_error("\160\x61\x73\x73\x77\x6f\x72\x64\137\143\x68\x61\x6e\147\145\x5f\165\156\x73\165\143\143\145\x73\163\146\165\154"); goto xx4R8; WgcVp: $this->trigger_events(["\160\157\x73\x74\x5f\x63\150\141\x6e\147\145\x5f\160\x61\x73\163\x77\157\x72\144", "\x70\157\x73\x74\x5f\x63\x68\141\x6e\147\145\x5f\x70\141\163\163\167\x6f\162\144\137\x75\156\x73\x75\x63\x63\145\x73\x73\146\x75\x6c"]); goto hTkFS; xx4R8: goto hWeLg; goto rGaAX; SfawJ: return FALSE; goto SCWCr; cDTRU: hWeLg: goto pJjEp; vEz59: if ($this->identity_check($identity)) { goto MEZKh; } goto xLI0V; SCWCr: MEZKh: goto MovQ5; Y_MFo: $this->trigger_events(["\x70\157\163\164\137\143\x68\x61\156\x67\x65\137\x70\x61\x73\x73\167\x6f\x72\144", "\x70\157\x73\164\x5f\x63\150\x61\156\147\145\x5f\x70\x61\x73\163\167\157\x72\144\x5f\x73\165\x63\143\x65\x73\x73\146\165\154"]); goto MlAl8; MlAl8: $this->set_message("\x70\141\x73\x73\167\x6f\162\144\x5f\143\150\141\x6e\147\145\x5f\x73\165\x63\x63\145\x73\x73\x66\165\x6c"); goto cDTRU; qQjUg: if ($return) { goto i1QtV; } goto WgcVp; xLI0V: $this->trigger_events(["\x70\x6f\163\x74\137\143\150\x61\156\x67\145\x5f\160\141\163\x73\x77\x6f\162\144", "\x70\157\163\164\x5f\143\x68\141\x6e\147\145\137\x70\x61\x73\x73\x77\x6f\162\x64\137\x75\x6e\x73\165\x63\x63\145\x73\x73\x66\x75\154"]); goto SfawJ; MovQ5: $return = $this->_set_password_db($identity, $new); goto qQjUg; ljA1G: } public function change_password($identity, $old, $new) { goto r1UaB; Z7Uxb: RLrTH: goto bVMd9; y0MK8: $this->set_message("\160\141\x73\x73\167\157\162\x64\x5f\143\x68\141\156\x67\x65\137\163\x75\143\x63\x65\x73\163\x66\165\154"); goto Z7Uxb; wS_hp: $this->set_error("\x70\141\x73\163\167\x6f\162\x64\x5f\143\150\141\156\x67\145\x5f\x75\x6e\x73\x75\143\143\x65\x73\x73\146\165\x6c"); goto l3sa4; A2ORA: A9C0j: goto AJdpg; KoUy4: $this->set_error("\x70\141\x73\163\167\157\162\x64\137\143\x68\141\x6e\147\145\137\x75\x6e\x73\x75\143\x63\145\163\x73\x66\165\154"); goto ABgDk; PuBs6: $query = $this->db->select("\151\144\54\x20\160\x61\x73\163\x77\157\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\144\x65\163\x63")->get($this->tables["\165\x73\x65\x72\163"]); goto i183V; yrem4: if (!$this->verify_password($old, $user->password, $identity)) { goto ZvXkd; } goto tb33u; uabEE: $this->trigger_events(["\160\157\163\x74\x5f\143\x68\x61\x6e\x67\145\x5f\x70\141\163\163\x77\157\162\144", "\160\157\x73\164\x5f\x63\150\141\156\147\145\x5f\x70\x61\x73\x73\x77\x6f\162\144\x5f\165\156\x73\x75\143\x63\145\x73\163\x66\x75\x6c"]); goto wS_hp; uSWB3: return FALSE; goto A2ORA; ABgDk: return FALSE; goto LDiSv; QbBYt: xHsND: goto b2srY; yCZrc: ZvXkd: goto KoUy4; bVMd9: return $result; goto yCZrc; i183V: if (!($query->num_rows() !== 1)) { goto A9C0j; } goto vFT4B; l3sa4: goto RLrTH; goto QbBYt; AJdpg: $user = $query->row(); goto yrem4; tb33u: $result = $this->_set_password_db($identity, $new); goto izWr7; vFT4B: $this->trigger_events(["\x70\157\163\164\x5f\x63\150\141\x6e\147\x65\x5f\160\x61\163\x73\167\157\162\144", "\x70\157\163\x74\137\143\x68\x61\x6e\147\145\x5f\x70\x61\163\x73\167\x6f\162\x64\137\165\x6e\x73\x75\143\x63\x65\x73\x73\146\x75\154"]); goto CDKXJ; b2srY: $this->trigger_events(["\160\157\x73\164\137\143\150\x61\x6e\147\x65\x5f\x70\141\x73\163\167\157\162\x64", "\x70\157\x73\x74\137\143\150\x61\x6e\147\x65\137\160\141\x73\x73\167\157\162\x64\137\163\165\x63\143\145\x73\163\146\165\154"]); goto y0MK8; izWr7: if ($result) { goto xHsND; } goto uabEE; r1UaB: $this->trigger_events("\160\x72\145\137\x63\x68\x61\156\147\x65\137\160\141\163\163\167\x6f\x72\x64"); goto ZGoJp; ZGoJp: $this->trigger_events("\145\x78\x74\162\x61\x5f\x77\150\145\162\x65"); goto PuBs6; CDKXJ: $this->set_error("\x70\141\163\x73\x77\x6f\x72\144\137\143\x68\x61\x6e\x67\x65\137\165\156\x73\x75\143\143\x65\163\163\146\165\154"); goto uSWB3; LDiSv: } public function username_check($username = '') { goto SpLoU; oYtiV: if (!empty($username)) { goto flD00; } goto zqhFC; zqhFC: return FALSE; goto jRRMa; SpLoU: $this->trigger_events("\165\163\x65\x72\x6e\141\x6d\145\x5f\143\150\x65\x63\153"); goto oYtiV; CuQwi: $this->trigger_events("\145\x78\164\162\141\137\x77\x68\145\162\145"); goto RsiAu; RsiAu: return $this->db->where("\x75\163\145\162\x6e\141\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\x75\163\x65\x72\x73"]) > 0; goto F41gi; jRRMa: flD00: goto CuQwi; F41gi: } public function email_check($email = '') { goto xbf01; DuJEX: return $this->db->where("\x65\155\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\x75\163\145\x72\x73"]) > 0; goto DiQTf; tPmHh: if (!empty($email)) { goto R1Rjq; } goto u9lvi; kv1ri: $this->trigger_events("\145\x78\164\162\x61\137\x77\x68\145\162\145"); goto DuJEX; xbf01: $this->trigger_events("\x65\x6d\x61\x69\x6c\137\x63\150\145\143\x6b"); goto tPmHh; u9lvi: return FALSE; goto my5Cq; my5Cq: R1Rjq: goto kv1ri; DiQTf: } public function identity_check($identity = '') { goto jirAa; eJxF8: return FALSE; goto WYx5t; dxJgX: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\x65\x72\163"]) > 0; goto xt7Cj; mYYBV: if (!empty($identity)) { goto qhi0F; } goto eJxF8; jirAa: $this->trigger_events("\x69\144\145\x6e\x74\151\x74\171\137\143\150\145\x63\153"); goto mYYBV; WYx5t: qhi0F: goto dxJgX; xt7Cj: } public function get_user_id_from_identity($identity = '') { goto ApmKa; wRKq3: aJ91_: goto RnBew; nQy6D: TjV49: goto X6lDK; fu0HV: return $user->id; goto kEa1G; pv2y4: if (!($query->num_rows() !== 1)) { goto TjV49; } goto XIEpU; lBP5K: return FALSE; goto wRKq3; X6lDK: $user = $query->row(); goto fu0HV; ApmKa: if (!empty($identity)) { goto aJ91_; } goto lBP5K; RnBew: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\x65\x72\163"]); goto pv2y4; XIEpU: return FALSE; goto nQy6D; kEa1G: } public function forgotten_password($identity) { goto fzgO6; VGeO9: $this->trigger_events(["\x70\157\x73\x74\x5f\146\157\x72\x67\x6f\164\x74\x65\x6e\x5f\160\x61\x73\163\167\157\162\x64", "\x70\x6f\163\164\x5f\x66\x6f\162\147\x6f\164\x74\x65\x6e\137\160\x61\163\163\167\x6f\162\144\x5f\x73\165\x63\143\145\x73\163\x66\x75\154"]); goto m6pvJ; fzgO6: if (!empty($identity)) { goto ILHpn; } goto ozH4r; fOYvS: $this->trigger_events(["\160\x6f\163\x74\137\x66\157\162\147\x6f\x74\164\x65\x6e\x5f\x70\x61\x73\x73\167\157\162\144", "\x70\157\x73\x74\137\146\x6f\x72\147\x6f\164\x74\145\156\x5f\x70\141\163\x73\167\157\162\x64\x5f\165\156\163\165\x63\143\x65\163\x73\146\165\x6c"]); goto kzsV_; jmNyr: $token = $this->_generate_selector_validator_couple(20, 80); goto qGWCz; BBhR8: if ($this->db->affected_rows() === 1) { goto UwQvc; } goto fOYvS; XEAYk: UwQvc: goto VGeO9; hOYKE: $this->db->update($this->tables["\x75\163\145\x72\x73"], $update, [$this->identity_column => $identity]); goto BBhR8; m6pvJ: return $token->user_code; goto CgPTN; ozH4r: $this->trigger_events(["\160\x6f\163\x74\137\146\x6f\162\x67\157\x74\x74\x65\x6e\x5f\160\x61\x73\x73\167\x6f\162\144", "\x70\x6f\163\164\137\146\157\162\x67\x6f\x74\164\x65\x6e\x5f\x70\x61\x73\x73\x77\x6f\162\144\137\165\x6e\x73\165\143\x63\145\163\163\146\165\154"]); goto Rn4YC; CgPTN: WsjEC: goto zGj4H; HKq0W: $this->trigger_events("\145\170\x74\x72\141\137\167\x68\x65\x72\x65"); goto hOYKE; qGWCz: $update = ["\x66\157\x72\147\x6f\x74\164\145\156\137\x70\141\163\163\x77\x6f\162\144\x5f\163\145\x6c\145\x63\164\157\x72" => $token->selector, "\x66\x6f\162\147\157\x74\164\x65\156\x5f\160\x61\x73\x73\x77\x6f\x72\x64\x5f\143\157\x64\x65" => $token->validator_hashed, "\x66\157\x72\x67\157\164\x74\x65\x6e\137\160\x61\x73\x73\167\157\162\x64\137\x74\x69\x6d\145" => time()]; goto HKq0W; Rn4YC: return FALSE; goto jLaiI; jLaiI: ILHpn: goto jmNyr; kzsV_: return FALSE; goto tZVZM; tZVZM: goto WsjEC; goto XEAYk; zGj4H: } public function get_user_by_forgotten_password_code($user_code) { goto PqXXh; GQdbb: $user = $this->where("\x66\x6f\x72\x67\x6f\164\164\x65\156\137\x70\141\x73\163\x77\157\x72\144\137\163\145\x6c\145\143\x74\157\162", $token->selector)->users()->row(); goto EaDi2; HhI3e: return FALSE; goto icwxO; PqXXh: $token = $this->_retrieve_selector_validator_couple($user_code); goto GQdbb; f3EbT: return $user; goto lo3DI; lo3DI: fwgJP: goto LLLbn; LLLbn: SH19d: goto HhI3e; EaDi2: if (!$user) { goto SH19d; } goto idrED; idrED: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto fwgJP; } goto f3EbT; icwxO: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto zzjeT; x953d: $this->db->insert($this->tables["\165\163\x65\x72\x73"], $user_data); goto MWh1U; pDsMj: g1rH2: goto gk_6l; hVf1j: if (!(!$this->config->item("\144\145\x66\x61\x75\x6c\164\x5f\x67\162\157\165\160", "\151\x6f\156\x5f\141\x75\164\150") && empty($groups))) { goto kyiZx; } goto ZAzWt; s0q3g: if ($this->identity_check($identity)) { goto LsFw1; } goto hVf1j; h6HYr: vabaD: goto skJdR; TzdFL: IF0Pk: goto yuc69; xaiIa: mjHeQ: goto G5Jhg; uR0Kd: return isset($id) ? $id : FALSE; goto l3cLo; URbF9: if (!($password === FALSE)) { goto JXLTq; } goto J7J6r; dZjXC: goto vabaD; goto uLigL; uLigL: LsFw1: goto JFmHG; PdJd4: kyiZx: goto dZjXC; gk_6l: $default_group = $query; goto qbCzk; zzjeT: $this->trigger_events("\160\x72\x65\x5f\162\x65\x67\x69\x73\164\145\162"); goto Y0Qr1; nuvRu: $this->trigger_events("\145\x78\164\162\x61\137\x73\x65\164"); goto x953d; ZG4L6: return FALSE; goto PdJd4; w6H4P: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\145\x72\x73"], $additional_data), $data); goto nuvRu; PK4Mj: foreach ($groups as $group) { $this->add_to_group($group, $id); qOXJ1: } goto xaiIa; URx9e: $groups[] = $default_group->id; goto TzdFL; J7J6r: $this->set_error("\141\143\143\x6f\165\156\164\x5f\x63\x72\145\x61\164\x69\x6f\156\x5f\165\156\x73\x75\143\143\x65\163\163\x66\165\154"); goto aOi9_; vu5B0: $password = $this->hash_password($password); goto URbF9; qbCzk: $ip_address = $this->input->ip_address(); goto vu5B0; Ihc26: return FALSE; goto h6HYr; JFmHG: $this->set_error("\x61\143\x63\157\x75\x6e\164\x5f\x63\162\145\141\x74\151\157\x6e\x5f\144\165\160\154\x69\x63\x61\164\145\x5f\151\x64\145\156\x74\151\x74\171"); goto Ihc26; G5Jhg: Wcj5J: goto kvwsM; Y0Qr1: $manual_activation = $this->config->item("\x6d\x61\x6e\165\x61\x6c\x5f\141\143\x74\151\166\x61\x74\x69\157\x6e", "\x69\157\156\137\141\x75\164\150"); goto s0q3g; ZAzWt: $this->set_error("\141\143\143\x6f\165\x6e\164\x5f\x63\x72\x65\141\x74\x69\157\x6e\x5f\155\x69\163\x73\x69\x6e\x67\137\x64\145\146\x61\x75\x6c\164\x5f\147\x72\157\x75\x70"); goto ZG4L6; aziwq: $this->set_error("\141\x63\143\157\x75\x6e\164\137\143\x72\x65\141\x74\151\157\x6e\137\x69\156\x76\141\154\x69\x64\137\144\x65\x66\x61\165\x6c\164\137\x67\162\x6f\x75\x70"); goto IyRBP; IyRBP: return FALSE; goto pDsMj; DajUC: JXLTq: goto XPGrk; XPGrk: $data = [$this->identity_column => $identity, "\x75\163\145\x72\x6e\141\155\x65" => $identity, "\x70\141\x73\163\167\157\x72\144" => $password, "\x65\155\x61\x69\x6c" => $email, "\151\x70\137\141\x64\144\162\x65\x73\x73" => $ip_address, "\x63\162\145\141\x74\x65\x64\x5f\157\x6e" => time(), "\x61\x63\x74\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto w6H4P; MWh1U: $id = $this->db->insert_id($this->tables["\165\x73\x65\162\163"] . "\x5f\x69\144\137\x73\145\x71"); goto Oi1gX; aOi9_: return FALSE; goto DajUC; skJdR: $query = $this->db->get_where($this->tables["\147\x72\x6f\165\160\163"], ["\156\141\155\x65" => $this->config->item("\x64\x65\x66\x61\165\154\164\x5f\x67\x72\x6f\x75\160", "\x69\x6f\156\x5f\x61\165\164\150")], 1)->row(); goto wg4vo; yuc69: if (empty($groups)) { goto Wcj5J; } goto PK4Mj; kvwsM: $this->trigger_events("\160\157\163\x74\137\x72\145\147\x69\163\164\145\x72"); goto uR0Kd; Oi1gX: if (!(isset($default_group->id) && empty($groups))) { goto IF0Pk; } goto URx9e; wg4vo: if (!(!isset($query->id) && empty($groups))) { goto g1rH2; } goto aziwq; l3cLo: } public function login($identity, $password, $remember = FALSE) { goto FOn9G; WJc6b: PwHyp: goto vk88M; yoU3K: if (!$this->verify_password($password, $user->password, $identity)) { goto RAk3u; } goto gT8rT; DlNtZ: $this->remember_user($identity); goto eUe23; FOn9G: $this->trigger_events("\x70\162\x65\x5f\154\157\x67\x69\156"); goto G9JRN; qhCUx: rs7tg: goto j58SU; CqcqZ: $this->trigger_events(["\x70\157\163\x74\x5f\x6c\x6f\x67\151\x6e", "\x70\x6f\163\x74\x5f\154\x6f\147\151\156\x5f\163\165\x63\143\145\x73\163\146\x75\154"]); goto Gdn3d; vk88M: $this->hash_password($password); goto OKByE; quU4m: $this->set_error("\x6c\157\x67\x69\156\x5f\164\151\x6d\145\x6f\x75\164"); goto xk0lc; MhBAU: $this->trigger_events("\x70\x6f\x73\x74\137\x6c\x6f\147\x69\156\x5f\x75\156\163\x75\x63\143\145\x73\163\146\165\154"); goto EDUoA; g6u5N: $this->trigger_events("\x65\x78\164\x72\141\137\x77\x68\x65\162\x65"); goto d9P4l; gDVhM: $this->set_error("\x6c\157\147\151\x6e\137\x75\156\x73\165\143\x63\x65\x73\x73\146\165\x6c\137\x6e\x6f\164\x5f\x61\x63\x74\x69\x76\145"); goto MQ7Px; CgFh8: r6zO_: goto U7qsQ; RKzsa: $this->clear_login_attempts($identity); goto ZnQp3; G9JRN: if (!(empty($identity) || empty($password))) { goto txoj1; } goto BJGMY; GvqTT: RAk3u: goto WJc6b; U7qsQ: $this->set_session($user); goto LF0P9; LF0P9: $this->update_last_login($user->id); goto RKzsa; MvB7g: if (!$this->config->item("\x72\145\155\x65\x6d\142\145\162\137\165\163\x65\x72\163", "\x69\x6f\x6e\x5f\x61\x75\164\x68")) { goto rs7tg; } goto jxtF8; Nssw0: txoj1: goto g6u5N; zpDO0: goto waHvI; goto tmr9v; nsrrJ: $user = $query->row(); goto yoU3K; Gdn3d: $this->set_message("\x6c\157\147\x69\156\137\163\165\x63\143\x65\163\x73\x66\x75\154"); goto Xp445; ZnQp3: $this->clear_forgotten_password_code($identity); goto MvB7g; xk0lc: return FALSE; goto mwL3k; MQ7Px: return FALSE; goto CgFh8; j58SU: $this->rehash_password_if_needed($user->password, $identity, $password); goto dgN89; gBg3A: if (!($query->num_rows() === 1)) { goto PwHyp; } goto nsrrJ; EDUoA: $this->set_error("\x6c\157\x67\151\156\137\x75\156\x73\x75\x63\143\x65\x73\x73\x66\x75\x6c"); goto zX7o1; d9P4l: $query = $this->db->select($this->identity_column . "\x2c\x20\x65\155\x61\151\154\54\x20\151\x64\x2c\x20\160\141\x73\x73\x77\157\162\x64\54\40\141\x63\164\x69\x76\145\x2c\40\x6c\141\x73\164\x5f\x6c\157\x67\x69\156")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\x65\163\143")->get($this->tables["\x75\x73\x65\162\163"]); goto e5y56; F2aGp: $this->trigger_events("\160\x6f\x73\164\137\x6c\x6f\x67\151\156\137\165\156\163\x75\143\143\145\x73\x73\x66\x75\154"); goto gDVhM; BJGMY: $this->set_error("\x6c\157\x67\151\156\x5f\165\x6e\x73\x75\x63\143\x65\163\x73\146\165\154"); goto fUusK; mwL3k: DANAI: goto gBg3A; jxtF8: if ($remember) { goto KKv_o; } goto udCP1; e5y56: if (!$this->is_max_login_attempts_exceeded($identity)) { goto DANAI; } goto hqdYA; udCP1: $this->clear_remember_code($identity); goto zpDO0; gT8rT: if (!($user->active == 0)) { goto r6zO_; } goto F2aGp; Xp445: return TRUE; goto GvqTT; OKByE: $this->increase_login_attempts($identity); goto MhBAU; eUe23: waHvI: goto qhCUx; fUusK: return FALSE; goto Nssw0; dgN89: $this->session->sess_regenerate(FALSE); goto CqcqZ; tmr9v: KKv_o: goto DlNtZ; hqdYA: $this->hash_password($password); goto UYFBk; UYFBk: $this->trigger_events("\160\157\x73\164\x5f\154\157\147\x69\156\x5f\x75\156\x73\165\x63\x63\145\x73\163\x66\165\x6c"); goto quU4m; zX7o1: return FALSE; goto ECxL7; ECxL7: } public function recheck_session() { goto tWtpE; MUzN_: $identity = $this->config->item("\151\144\x65\x6e\x74\x69\x74\171", "\x69\157\156\x5f\x61\165\x74\x68"); goto aDNi2; PQoZj: return FALSE; goto vodq7; z9kmV: $last_login = $this->session->userdata("\154\141\163\x74\x5f\x63\x68\x65\143\153"); goto aUJEU; x5Smg: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\x6e\x74\x69\164\171"), "\141\143\164\x69\x76\145" => "\61"])->limit(1)->order_by("\x69\x64", "\x64\x65\163\143")->get($this->tables["\x75\163\x65\x72\163"]); goto m8wbW; tWtpE: $recheck = NULL !== $this->config->item("\x72\145\x63\150\x65\143\153\x5f\164\151\155\145\x72", "\151\157\156\137\141\165\164\x68") ? $this->config->item("\x72\145\x63\x68\145\143\153\137\x74\x69\155\x65\x72", "\151\157\x6e\137\141\165\164\150") : 0; goto xlxqH; uLPud: c0q7Z: goto i_q1j; LsEFn: return (bool) $this->session->userdata("\x69\x64\145\x6e\x74\x69\164\171"); goto a8FbY; Jisvq: U7O25: goto CU8M4; aDNi2: $this->session->unset_userdata([$identity, "\x69\144", "\x75\163\x65\x72\137\x69\144"]); goto PQoZj; i_q1j: $this->session->set_userdata("\154\x61\x73\x74\x5f\x63\x68\145\x63\153", time()); goto QBVU6; aUJEU: if (!($last_login + $recheck < time())) { goto U7O25; } goto x5Smg; xlxqH: if (!($recheck !== 0)) { goto dTj0V; } goto z9kmV; m8wbW: if ($query->num_rows() === 1) { goto c0q7Z; } goto PNinP; QBVU6: US7sn: goto Jisvq; vodq7: goto US7sn; goto uLPud; CU8M4: dTj0V: goto LsEFn; PNinP: $this->trigger_events("\x6c\157\147\x6f\x75\x74"); goto MUzN_; a8FbY: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto HcDQP; iJYkB: if (!($max_attempts > 0)) { goto KRJlF; } goto fEcNQ; HcDQP: if (!$this->config->item("\x74\x72\141\x63\153\x5f\x6c\x6f\147\x69\x6e\x5f\141\x74\x74\x65\x6d\x70\164\x73", "\x69\157\x6e\x5f\141\x75\164\150")) { goto TS9U7; } goto vNVt6; bha82: KRJlF: goto GhTIm; HmZuy: return FALSE; goto NfIbV; vNVt6: $max_attempts = $this->config->item("\x6d\x61\x78\x69\x6d\165\155\137\x6c\x6f\147\x69\156\x5f\141\164\x74\x65\155\160\164\x73", "\151\157\156\x5f\x61\165\x74\150"); goto iJYkB; B1Drr: return $attempts >= $max_attempts; goto bha82; GhTIm: TS9U7: goto HmZuy; fEcNQ: $attempts = $this->get_attempts_num($identity, $ip_address); goto B1Drr; NfIbV: } public function get_attempts_num($identity, $ip_address = NULL) { goto iqg7W; TQnFF: return 0; goto pPKd4; xrU4O: J18ZB: goto Ast_4; sPjoq: $this->db->where("\x74\x69\155\145\x20\76", time() - $this->config->item("\x6c\x6f\x63\153\x6f\165\x74\x5f\164\151\155\145", "\x69\157\x6e\137\x61\x75\x74\x68"), FALSE); goto YEHgt; w3ugB: if (!$this->config->item("\164\162\x61\x63\153\x5f\x6c\x6f\147\151\156\137\151\x70\x5f\141\x64\144\162\x65\x73\163", "\x69\157\156\137\141\x75\x74\x68")) { goto goGCE; } goto CHPYL; CHPYL: if (isset($ip_address)) { goto J18ZB; } goto OrD6a; Ast_4: $this->db->where("\151\x70\x5f\141\x64\x64\162\145\x73\x73", $ip_address); goto vtRfj; HNkeX: $this->db->where("\154\157\147\151\156", $identity); goto w3ugB; PLxda: kUd3u: goto TQnFF; OrD6a: $ip_address = $this->input->ip_address(); goto xrU4O; YEHgt: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\156\x5f\141\x74\164\145\x6d\x70\x74\x73"]); goto WI4jJ; iqg7W: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\154\x6f\x67\151\156\137\x61\164\x74\145\155\x70\x74\163", "\151\x6f\156\x5f\x61\165\x74\150")) { goto kUd3u; } goto uyRyI; WI4jJ: return $qres->num_rows(); goto PLxda; uyRyI: $this->db->select("\61", FALSE); goto HNkeX; vtRfj: goGCE: goto sPjoq; pPKd4: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto lY0ss; Xewhz: $this->db->where("\x69\x70\137\x61\144\144\162\x65\163\163", $ip_address); goto DEJgv; lY0ss: if (!$this->config->item("\x74\x72\141\143\x6b\137\154\x6f\x67\x69\x6e\x5f\141\x74\x74\145\155\160\164\163", "\x69\x6f\x6e\137\x61\x75\164\150")) { goto IQVdf; } goto XtigA; K1nbd: $ip_address = $this->input->ip_address(); goto BG_bQ; BG_bQ: aQ2Dl: goto Xewhz; k2WY6: return 0; goto Et0dd; XtigA: $this->db->select("\x74\151\155\145"); goto d1i_8; WQv8l: if (isset($ip_address)) { goto aQ2Dl; } goto K1nbd; kNnzT: if (!($qres->num_rows() > 0)) { goto jisCC; } goto himQL; d1i_8: $this->db->where("\x6c\x6f\x67\x69\156", $identity); goto W4trA; himQL: return $qres->row()->time; goto bXvQs; DEJgv: CCYbY: goto WKmPt; WKmPt: $this->db->order_by("\151\144", "\144\145\x73\x63"); goto zPcJP; zPcJP: $qres = $this->db->get($this->tables["\154\x6f\x67\151\156\x5f\x61\164\x74\x65\x6d\160\164\163"], 1); goto kNnzT; W4trA: if (!$this->config->item("\164\x72\141\143\x6b\x5f\x6c\157\x67\x69\x6e\x5f\x69\x70\137\x61\x64\x64\162\x65\163\163", "\151\x6f\x6e\x5f\x61\165\164\150")) { goto CCYbY; } goto WQv8l; Tdsta: IQVdf: goto k2WY6; bXvQs: jisCC: goto Tdsta; Et0dd: } public function get_last_attempt_ip($identity) { goto Juhkq; wCIKa: vZDJf: goto cN87R; MiQGg: $qres = $this->db->get($this->tables["\154\x6f\147\151\156\137\x61\x74\164\145\155\x70\x74\163"], 1); goto HdZG5; X9hVY: V5INe: goto wCIKa; Juhkq: if (!($this->config->item("\x74\162\141\x63\153\137\x6c\157\x67\151\x6e\137\x61\x74\164\x65\x6d\160\164\x73", "\x69\x6f\156\137\x61\x75\164\150") && $this->config->item("\164\x72\141\x63\153\x5f\x6c\x6f\147\x69\x6e\x5f\151\160\x5f\x61\144\144\x72\x65\163\163", "\151\157\156\x5f\x61\x75\164\150"))) { goto vZDJf; } goto Rk3EM; Z_qFp: return $qres->row()->ip_address; goto X9hVY; cN87R: return ''; goto IUH58; HdZG5: if (!($qres->num_rows() > 0)) { goto V5INe; } goto Z_qFp; PIb7Z: $this->db->where("\154\x6f\147\x69\156", $identity); goto eOrva; eOrva: $this->db->order_by("\151\x64", "\x64\x65\163\x63"); goto MiQGg; Rk3EM: $this->db->select("\x69\x70\x5f\x61\144\144\162\145\x73\x73"); goto PIb7Z; IUH58: } public function increase_login_attempts($identity) { goto VVFVV; VVFVV: if (!$this->config->item("\x74\x72\141\x63\153\x5f\154\x6f\x67\151\x6e\x5f\x61\x74\x74\145\155\160\164\163", "\151\157\156\137\x61\165\164\150")) { goto v7wym; } goto YNTlz; YNTlz: $data = ["\x69\160\x5f\x61\x64\144\x72\145\163\163" => '', "\x6c\157\x67\x69\156" => $identity, "\x74\x69\155\x65" => time()]; goto HSvdx; PTzk7: v7wym: goto PEwPn; qVttL: return $this->db->insert($this->tables["\x6c\157\147\151\x6e\x5f\x61\x74\x74\x65\x6d\160\164\x73"], $data); goto PTzk7; LOu1p: $data["\151\x70\x5f\141\144\144\162\x65\x73\163"] = $this->input->ip_address(); goto zyuO7; HSvdx: if (!$this->config->item("\164\162\141\x63\x6b\x5f\x6c\x6f\x67\x69\156\137\151\x70\137\x61\144\144\x72\145\163\x73", "\x69\x6f\x6e\137\x61\x75\x74\x68")) { goto f017q; } goto LOu1p; PEwPn: return FALSE; goto hd9TP; zyuO7: f017q: goto qVttL; hd9TP: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto G4IUo; ZMDf4: if (!$this->config->item("\164\162\x61\143\x6b\137\154\157\x67\151\156\x5f\151\x70\x5f\141\144\144\162\145\163\x73", "\x69\157\x6e\137\141\x75\x74\150")) { goto Pp1qF; } goto X8yTy; G4IUo: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\154\x6f\147\x69\156\x5f\x61\x74\x74\x65\x6d\x70\x74\x73", "\x69\157\156\137\141\165\164\150")) { goto nMokV; } goto RYWUD; zOLSt: $ip_address = $this->input->ip_address(); goto VI9RB; rC7j8: return FALSE; goto fGigh; aXs1q: nMokV: goto rC7j8; o16IJ: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto ZMDf4; VI9RB: zDLTR: goto iAuCD; T1OPK: Pp1qF: goto kDsVB; iAuCD: $this->db->where("\x69\160\x5f\x61\144\x64\x72\x65\163\163", $ip_address); goto T1OPK; J0ILD: return $this->db->delete($this->tables["\154\x6f\x67\151\156\x5f\x61\164\x74\145\x6d\x70\164\x73"]); goto aXs1q; RYWUD: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\143\153\x6f\165\x74\137\x74\151\155\x65", "\x69\157\156\137\x61\x75\x74\150")); goto o16IJ; kDsVB: $this->db->or_where("\x74\x69\155\x65\x20\74", time() - $old_attempts_expire_period, FALSE); goto J0ILD; X8yTy: if (isset($ip_address)) { goto zDLTR; } goto zOLSt; fGigh: } public function limit($limit) { goto ZcgSe; wPmdX: return $this; goto eq8zu; qOzHy: $this->_ion_limit = $limit; goto wPmdX; ZcgSe: $this->trigger_events("\154\151\155\x69\164"); goto qOzHy; eq8zu: } public function offset($offset) { goto E8SR2; E8SR2: $this->trigger_events("\157\x66\x66\x73\x65\x74"); goto iOMLB; iOMLB: $this->_ion_offset = $offset; goto MvZgT; MvZgT: return $this; goto uTkJK; uTkJK: } public function where($where, $value = NULL) { goto spKro; Zevp3: $where = [$where => $value]; goto YhjOg; spKro: $this->trigger_events("\x77\150\145\162\145"); goto jrC9J; e2aYN: array_push($this->_ion_where, $where); goto ZNV4F; jrC9J: if (is_array($where)) { goto yC5_Z; } goto Zevp3; YhjOg: yC5_Z: goto e2aYN; ZNV4F: return $this; goto UHBMQ; UHBMQ: } public function like($like, $value = NULL, $position = "\142\157\x74\150") { goto mLfXQ; ww6Pj: array_push($this->_ion_like, ["\x6c\151\153\145" => $like, "\x76\x61\x6c\x75\145" => $value, "\160\x6f\x73\x69\x74\x69\157\156" => $position]); goto aJg6g; mLfXQ: $this->trigger_events("\x6c\151\x6b\145"); goto ww6Pj; aJg6g: return $this; goto H2F19; H2F19: } public function select($select) { goto CsetL; wuTK9: $this->_ion_select[] = $select; goto Ta2Dl; Ta2Dl: return $this; goto dm7n2; CsetL: $this->trigger_events("\x73\145\154\x65\x63\x74"); goto wuTK9; dm7n2: } public function order_by($by, $order = "\144\145\163\143") { goto ecKwI; ecKwI: $this->trigger_events("\157\162\x64\145\x72\137\x62\x79"); goto xijjg; Idnb5: $this->_ion_order = $order; goto bYwSh; bYwSh: return $this; goto c1V6S; xijjg: $this->_ion_order_by = $by; goto Idnb5; c1V6S: } public function row() { goto Ix9Mw; Oq3iT: $row = $this->response->row(); goto JdvKa; JdvKa: return $row; goto ogDYS; Ix9Mw: $this->trigger_events("\162\157\x77"); goto Oq3iT; ogDYS: } public function row_array() { goto bcxJ1; Ub0br: return $row; goto s_RQ3; bcxJ1: $this->trigger_events(["\x72\x6f\167", "\x72\157\x77\137\x61\x72\x72\x61\x79"]); goto zG3nM; zG3nM: $row = $this->response->row_array(); goto Ub0br; s_RQ3: } public function result() { goto NUeJ7; NUeJ7: $this->trigger_events("\162\145\163\165\154\164"); goto CXqzD; S5_io: return $result; goto AzRHd; CXqzD: $result = $this->response->result(); goto S5_io; AzRHd: } public function result_array() { goto yTriC; yTriC: $this->trigger_events(["\x72\145\163\165\x6c\x74", "\162\145\163\x75\x6c\x74\137\141\162\162\141\171"]); goto mLe4H; mLe4H: $result = $this->response->result_array(); goto Vy3AN; Vy3AN: return $result; goto Ge4Vk; Ge4Vk: } public function num_rows() { goto zq5Xt; BhY_6: return $result; goto X1tOt; Gl2dI: $result = $this->response->num_rows(); goto BhY_6; zq5Xt: $this->trigger_events(["\156\x75\155\137\162\157\x77\x73"]); goto Gl2dI; X1tOt: } public function users($groups = NULL) { goto wuIlu; G2QfD: $this->_ion_select = []; goto x6fOP; x6fOP: xvjXi: goto wkDki; jXu0X: if (empty($group_names)) { goto NHsf5; } goto yE7su; ADPIK: AbHYV: goto VGl6I; QrqQR: VKfnG: goto JXfh_; S2OoC: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto wl14H; xSSvA: $group_names = []; goto xmJBo; Oq0Rl: if (empty($group_ids)) { goto w4D0Z; } goto KJN2F; wuIlu: $this->trigger_events("\165\163\145\x72\163"); goto TkARv; D_xeh: if (is_array($groups)) { goto AbHYV; } goto PHJN0; T6nBU: $this->_ion_offset = NULL; goto lMhgt; anu7d: oGcUL: goto AACuT; VGl6I: if (!(isset($groups) && !empty($groups))) { goto otNju; } goto omGxg; OamwK: w4D0Z: goto X_Zr3; jaqu9: otNju: goto ZKlBQ; qPeUF: $this->db->join($this->tables["\165\x73\x65\162\163\137\x67\x72\x6f\165\160\x73"], $this->tables["\165\x73\145\162\x73\x5f\x67\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x75\x73\x65\x72\163"] . "\75" . $this->tables["\x75\x73\x65\162\x73"] . "\56\151\144", "\151\156\156\x65\x72"); goto jaqu9; DWHh3: $this->_ion_where = []; goto QrqQR; PpVWi: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\x6b\145"], $like["\166\x61\x6c\x75\x65"], $like["\x70\x6f\163\x69\164\x69\157\x6e"]); EnfzE: } goto li7Ip; wkDki: if (!isset($groups)) { goto X5Qr8; } goto D_xeh; JXfh_: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto Hpy67; } goto PpVWi; omGxg: $this->db->distinct(); goto qPeUF; lMhgt: LDW2O: goto vpUYL; wl14H: $this->_ion_order = NULL; goto b_MnO; wyz3y: foreach ($this->_ion_where as $where) { $this->db->where($where); fJe8t: } goto SP_sY; vpUYL: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto oGcUL; } goto S2OoC; pIC7g: $this->trigger_events("\145\170\164\x72\x61\x5f\167\x68\145\x72\x65"); goto JiTSX; PHJN0: $groups = [$groups]; goto ADPIK; yoHwE: Hpy67: goto O88NC; dzEkW: sCfIB: goto G2QfD; d5wfe: SY8BS: goto Qb1ax; SP_sY: dtseJ: goto DWHh3; X_Zr3: X5Qr8: goto pIC7g; xsChL: $this->db->select([$this->tables["\165\163\145\x72\x73"] . "\56\x2a", $this->tables["\x75\163\x65\x72\163"] . "\56\151\x64\x20\141\x73\40\x69\x64", $this->tables["\165\163\145\x72\x73"] . "\56\151\144\x20\141\x73\x20\x75\x73\x65\162\137\151\144"]); goto cU1JV; YGUGX: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto acLHy; JiTSX: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto VKfnG; } goto wyz3y; Jb3HD: NHsf5: goto Oq0Rl; z1W75: goto LDW2O; goto FaNS2; xmJBo: foreach ($groups as $group) { goto Q5fUR; KxvSZ: Bi3Tw: goto GNAho; pVtQO: Q85OR: goto KxvSZ; NXn7n: FCDRK: goto IGJBZ; IGJBZ: $group_ids[] = $group; goto pVtQO; iJGLM: $group_names[] = $group; goto UZmkG; Q5fUR: if (is_numeric($group)) { goto FCDRK; } goto iJGLM; UZmkG: goto Q85OR; goto NXn7n; GNAho: } goto Mo5lK; AACuT: $this->response = $this->db->get($this->tables["\x75\163\145\x72\x73"]); goto vvi0i; acLHy: $this->_ion_limit = NULL; goto T6nBU; Ap3hG: $this->db->where_in($this->tables["\147\x72\x6f\x75\x70\163"] . "\x2e\156\141\x6d\145", $group_names); goto Jb3HD; ZKlBQ: $group_ids = []; goto xSSvA; d7FvG: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\x77\x68\145\162\x65\137\151\156" : "\x77\150\145\162\x65\137\151\x6e"; goto jXu0X; hygML: $this->_ion_like = []; goto yoHwE; dMBcE: $this->_ion_limit = NULL; goto fYte3; KJN2F: $this->db->{$or_where_in}($this->tables["\x75\x73\x65\162\x73\137\147\x72\x6f\x75\x70\163"] . "\56" . $this->join["\x67\x72\157\165\160\163"], $group_ids); goto OamwK; fYte3: Ru6OH: goto z1W75; cU1JV: goto xvjXi; goto d5wfe; Qb1ax: foreach ($this->_ion_select as $select) { $this->db->select($select); j6Vw6: } goto dzEkW; b_MnO: $this->_ion_order_by = NULL; goto anu7d; TkARv: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto SY8BS; } goto xsChL; O88NC: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto w3Bzn; } goto oXeGW; yE7su: $this->db->join($this->tables["\147\162\157\165\160\163"], $this->tables["\165\x73\x65\x72\x73\x5f\147\162\157\x75\160\x73"] . "\x2e" . $this->join["\147\x72\x6f\165\160\x73"] . "\40\75\x20" . $this->tables["\x67\x72\157\165\160\163"] . "\x2e\x69\144", "\151\x6e\x6e\x65\162"); goto Ap3hG; oXeGW: if (!isset($this->_ion_limit)) { goto Ru6OH; } goto UuM3e; li7Ip: WGJCF: goto hygML; Mo5lK: aLoq8: goto d7FvG; UuM3e: $this->db->limit($this->_ion_limit); goto dMBcE; vvi0i: return $this; goto dp6J_; FaNS2: w3Bzn: goto YGUGX; dp6J_: } public function user($id = NULL) { goto JLD39; ud7rf: $this->order_by($this->tables["\x75\163\145\162\163"] . "\56\x69\144", "\144\x65\x73\x63"); goto N1Vk1; N1Vk1: $this->where($this->tables["\x75\163\x65\x72\163"] . "\56\x69\144", $id); goto p2DS1; Gt9sS: return $this; goto prEdY; mZZzp: $this->limit(1); goto ud7rf; p2DS1: $this->users(); goto Gt9sS; vyl0f: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\x65\162\x5f\151\144"); goto mZZzp; JLD39: $this->trigger_events("\165\163\x65\162"); goto vyl0f; prEdY: } public function get_users_groups($id = FALSE) { goto qKNms; Oe0RH: $id || ($id = $this->session->userdata("\x75\x73\145\162\137\x69\144")); goto oa_zk; qKNms: $this->trigger_events("\147\145\164\x5f\165\x73\145\162\x73\137\x67\162\157\165\x70"); goto Oe0RH; oa_zk: return $this->db->select($this->tables["\x75\163\145\x72\x73\x5f\x67\x72\157\165\160\163"] . "\x2e" . $this->join["\x67\162\157\x75\x70\x73"] . "\x20\141\x73\40\151\144\x2c\40" . $this->tables["\147\162\157\165\160\x73"] . "\56\156\141\155\x65\x2c\x20" . $this->tables["\x67\x72\157\165\x70\x73"] . "\x2e\144\145\163\x63\x72\x69\x70\164\151\157\x6e")->where($this->tables["\165\163\145\162\x73\x5f\147\162\157\x75\160\163"] . "\56" . $this->join["\165\163\145\x72\x73"], $id)->join($this->tables["\147\162\157\165\160\163"], $this->tables["\x75\x73\145\162\x73\137\x67\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x67\x72\x6f\x75\x70\x73"] . "\75" . $this->tables["\x67\162\x6f\165\160\163"] . "\x2e\x69\x64")->get($this->tables["\x75\x73\145\162\x73\137\x67\x72\x6f\165\x70\x73"]); goto AUMzf; AUMzf: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto C8Tjf; KtyY3: UpDcN: goto yLB23; qcGdV: goto latg0; goto KtyY3; wKA9r: foreach ($check_group as $key => $value) { goto K3zNe; l6O0S: return !$check_all; goto Jfftb; Jfftb: LdeEK: goto YUuZm; xljuD: if (!(in_array($value, $groups) xor $check_all)) { goto LdeEK; } goto l6O0S; K3zNe: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto xljuD; YUuZm: qhkq4: goto V0JLX; V0JLX: } goto h_1Se; yLB23: $groups_array = $this->_cache_user_in_group[$id]; goto IYiX1; d_Jnj: if (is_array($check_group)) { goto jf66t; } goto ZwjQW; IF8m7: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; artlS: } goto Aim_U; X8LYg: $groups_array = []; goto IF8m7; C8Tjf: $this->trigger_events("\x69\156\x5f\147\x72\157\x75\x70"); goto cZY6a; Aim_U: XY1GH: goto FNrwL; ZdRwV: return $check_all; goto KNQLn; HNvFS: jf66t: goto GGtDn; GGtDn: if (isset($this->_cache_user_in_group[$id])) { goto UpDcN; } goto IdWGV; ZwjQW: $check_group = [$check_group]; goto HNvFS; cZY6a: $id || ($id = $this->session->userdata("\x75\x73\x65\x72\x5f\x69\144")); goto d_Jnj; IYiX1: latg0: goto wKA9r; FNrwL: $this->_cache_user_in_group[$id] = $groups_array; goto qcGdV; h_1Se: ReoAi: goto ZdRwV; IdWGV: $users_groups = $this->get_users_groups($id)->result(); goto X8LYg; KNQLn: } public function add_to_group($group_ids, $user_id = FALSE) { goto YMRjT; M1wuP: $group_ids = [$group_ids]; goto ZNTZ0; FqaVl: return $return; goto XXkK2; Oxlp4: jQqRh: goto FqaVl; Dvkun: foreach ($group_ids as $group_id) { goto cQSpR; oRmxK: $group = $this->group($group_id)->result(); goto R0Acu; x82xN: $group_name = $this->_cache_groups[$group_id]; goto CMSpN; mBkoJ: MZR4V: goto XUcyU; tuB_g: $return++; goto mBkoJ; CMSpN: pzTZV: goto OVABk; XUcyU: deBct: goto VBHpi; IzRjz: FVFO1: goto x82xN; q77rr: goto pzTZV; goto IzRjz; CRlif: if (isset($this->_cache_groups[$group_id])) { goto FVFO1; } goto oRmxK; cQSpR: if (!$this->db->insert($this->tables["\x75\x73\145\162\163\137\x67\162\x6f\x75\160\x73"], [$this->join["\147\x72\x6f\165\160\163"] => (float) $group_id, $this->join["\x75\x73\145\x72\x73"] => (float) $user_id])) { goto MZR4V; } goto CRlif; R0Acu: $group_name = $group[0]->name; goto yYHiq; yYHiq: $this->_cache_groups[$group_id] = $group_name; goto q77rr; OVABk: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto tuB_g; VBHpi: } goto Oxlp4; dM01H: if (is_array($group_ids)) { goto hR4F9; } goto M1wuP; ZNTZ0: hR4F9: goto bZXS4; bZXS4: $return = 0; goto Dvkun; I2A4x: $user_id || ($user_id = $this->session->userdata("\165\x73\145\x72\137\151\x64")); goto dM01H; YMRjT: $this->trigger_events("\x61\x64\144\137\164\x6f\x5f\x67\x72\157\x75\160"); goto I2A4x; XXkK2: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto axhD4; aTUHk: GzPT0: goto jyyHn; tOWY2: if (is_array($group_ids)) { goto s6VX4; } goto XeRQP; bh6jO: s6VX4: goto NqZOE; MFM9K: if (!empty($user_id)) { goto ua01h; } goto mZtQz; QAROm: goto GzPT0; goto QCIcL; DAEKg: if (!($return = $this->db->delete($this->tables["\x75\x73\145\x72\163\x5f\147\x72\x6f\x75\160\163"], [$this->join["\x75\163\145\162\163"] => (float) $user_id]))) { goto JgtNX; } goto JxRLF; QCIcL: WbtZ9: goto tOWY2; mZtQz: return FALSE; goto Ey0ps; axhD4: $this->trigger_events("\162\x65\155\x6f\166\145\137\x66\162\157\155\137\147\x72\x6f\x75\x70"); goto MFM9K; b8NCL: $return = TRUE; goto aTUHk; Ey0ps: ua01h: goto dcJVS; I2Zj0: JgtNX: goto QAROm; FIX0U: ANhsU: goto b8NCL; jyyHn: return $return; goto LaFy_; XeRQP: $group_ids = [$group_ids]; goto bh6jO; JxRLF: $this->_cache_user_in_group[$user_id] = []; goto I2Zj0; dcJVS: if (!empty($group_ids)) { goto WbtZ9; } goto DAEKg; NqZOE: foreach ($group_ids as $group_id) { goto nEfHa; gjE5I: TZ0ER: goto Te76W; MQtvT: unset($this->_cache_user_in_group[$user_id][$group_id]); goto aLZqR; ke3JR: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto ie7B1; } goto MQtvT; aLZqR: ie7B1: goto gjE5I; nEfHa: $this->db->delete($this->tables["\x75\x73\145\162\163\137\147\x72\x6f\165\160\163"], [$this->join["\147\x72\x6f\165\160\163"] => (float) $group_id, $this->join["\x75\163\x65\162\163"] => (float) $user_id]); goto ke3JR; Te76W: } goto FIX0U; LaFy_: } public function groups() { goto hUENE; ZfL6d: Lk_fc: goto y9htF; i_J5j: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto FaIUL; y9htF: $this->_ion_where = []; goto vy0e1; gvPw2: goto ErAbB; goto g2BxF; HB0tD: $this->_ion_limit = NULL; goto aOmWl; E6nmb: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto B713T; } goto i_J5j; hUENE: $this->trigger_events("\147\162\x6f\x75\160\x73"); goto s39Vt; rjsc5: $this->db->limit($this->_ion_limit); goto HB0tD; Lr1Ru: ErAbB: goto E6nmb; p7IV6: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto ps49B; } goto XbxDr; vy0e1: o71z8: goto p7IV6; s39Vt: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto o71z8; } goto AnEO4; k_yKw: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto NTIc0; NTIc0: $this->_ion_limit = NULL; goto h31Y7; Djw7S: return $this; goto l40xc; Bm8Jr: $this->response = $this->db->get($this->tables["\147\x72\157\165\x70\163"]); goto Djw7S; FaIUL: B713T: goto Bm8Jr; XbxDr: if (!isset($this->_ion_limit)) { goto YfUjV; } goto rjsc5; g2BxF: ps49B: goto k_yKw; AnEO4: foreach ($this->_ion_where as $where) { $this->db->where($where); gUwGC: } goto ZfL6d; aOmWl: YfUjV: goto gvPw2; h31Y7: $this->_ion_offset = NULL; goto Lr1Ru; l40xc: } public function group($id = NULL) { goto e6yEe; dGHbG: $this->order_by("\151\x64", "\144\145\x73\x63"); goto conYn; nqYnK: if (!isset($id)) { goto Ws8Vl; } goto k5xHP; conYn: return $this->groups(); goto oOv5X; e6yEe: $this->trigger_events("\147\x72\x6f\165\160"); goto nqYnK; EwWHt: $this->limit(1); goto dGHbG; k5xHP: $this->where($this->tables["\147\162\157\165\160\163"] . "\56\151\144", $id); goto GFUsA; GFUsA: Ws8Vl: goto EwWHt; oOv5X: } public function update($id, array $data) { goto FM9NU; g1BTI: $this->db->trans_commit(); goto xbpK4; nBhqQ: Hb16p: goto zaEeu; paDFO: EV088: goto g1BTI; gl2bH: $this->set_error("\165\x70\x64\141\164\145\137\x75\x6e\x73\x75\x63\143\x65\x73\163\x66\x75\154"); goto KrQBC; FM9NU: $this->trigger_events("\x70\x72\x65\137\x75\160\144\x61\x74\145\137\x75\x73\145\162"); goto CswmR; wKYwF: $data["\160\141\163\x73\x77\x6f\162\x64"] = $this->hash_password($data["\x70\x61\x73\163\x77\x6f\x72\x64"], $user->{$this->identity_column}); goto Ydgf_; iX5Gl: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\x73\x73\167\157\x72\x64", $data) || array_key_exists("\x65\x6d\x61\151\154", $data))) { goto Hb16p; } goto YbFJe; HaDz0: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto K1B1w; } goto XsZ8m; SPw6t: K1B1w: goto JJFuV; rdsVn: return FALSE; goto SPw6t; Nasdd: $this->db->trans_rollback(); goto oq6Wh; YV08v: Vsia4: goto wKYwF; YbFJe: if (!array_key_exists("\x70\141\163\x73\x77\157\x72\144", $data)) { goto TpSgT; } goto Cy3sz; oq6Wh: $this->trigger_events(["\160\157\x73\x74\x5f\x75\160\x64\141\x74\145\x5f\x75\163\x65\x72", "\x70\x6f\163\x74\137\x75\x70\144\141\x74\145\137\165\163\145\162\137\165\156\163\165\x63\143\x65\x73\163\146\x75\x6c"]); goto gl2bH; KrQBC: return FALSE; goto paDFO; nT5vz: TpSgT: goto nBhqQ; CswmR: $user = $this->user($id)->row(); goto KqMIO; RLofI: unset($data["\x70\141\163\x73\x77\x6f\x72\144"]); goto n2qVf; XgoK_: $this->set_error("\x75\x70\x64\141\x74\145\x5f\165\156\163\165\143\x63\x65\x73\163\146\165\x6c"); goto Kz_O3; JJFuV: $data = $this->_filter_data($this->tables["\165\x73\145\x72\x73"], $data); goto iX5Gl; Ibb2Y: if (!($this->db->trans_status() === FALSE)) { goto EV088; } goto Nasdd; Cy3sz: if (!empty($data["\x70\x61\163\x73\x77\x6f\162\144"])) { goto Vsia4; } goto RLofI; xnlFS: return TRUE; goto PkaLn; th2cN: $this->set_message("\165\160\x64\141\164\x65\x5f\163\165\143\143\145\x73\x73\x66\165\154"); goto xnlFS; tkEGi: $this->db->trans_rollback(); goto TFMa2; rDide: $this->set_error("\x75\160\x64\141\164\x65\137\x75\x6e\x73\165\x63\143\x65\x73\163\x66\165\x6c"); goto rdsVn; sDOQT: EbuKC: goto nT5vz; n2qVf: goto EbuKC; goto YV08v; Ydgf_: if (!($data["\x70\141\x73\163\x77\157\x72\144"] === FALSE)) { goto CPemT; } goto tkEGi; NKycL: CPemT: goto sDOQT; TFMa2: $this->trigger_events(["\160\157\163\x74\x5f\x75\x70\144\x61\x74\145\x5f\x75\163\x65\x72", "\x70\x6f\163\x74\x5f\x75\160\x64\141\x74\145\x5f\x75\163\x65\162\137\165\156\x73\x75\143\143\145\163\x73\x66\x75\x6c"]); goto XgoK_; XsZ8m: $this->db->trans_rollback(); goto UOcmq; zaEeu: $this->trigger_events("\145\x78\164\x72\x61\137\167\x68\145\162\x65"); goto aWPYN; Kz_O3: return FALSE; goto NKycL; UOcmq: $this->set_error("\141\143\x63\x6f\165\x6e\164\x5f\x63\x72\145\x61\164\151\x6f\x6e\x5f\x64\165\160\x6c\151\x63\x61\x74\145\x5f\151\144\145\x6e\x74\151\164\x79"); goto ql7LX; KqMIO: $this->db->trans_begin(); goto HaDz0; xbpK4: $this->trigger_events(["\x70\157\163\164\x5f\165\160\x64\x61\x74\145\137\165\x73\145\x72", "\160\157\x73\x74\137\165\160\x64\x61\164\145\x5f\x75\x73\x65\162\137\x73\165\x63\143\x65\x73\x73\x66\x75\154"]); goto th2cN; ql7LX: $this->trigger_events(["\160\x6f\x73\164\137\165\160\144\141\x74\145\x5f\165\163\x65\162", "\160\157\x73\x74\x5f\165\x70\x64\141\x74\145\x5f\x75\x73\145\x72\137\x75\156\163\165\143\x63\x65\x73\x73\x66\x75\154"]); goto rDide; aWPYN: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, ["\x69\x64" => $user->id]); goto Ibb2Y; PkaLn: } public function delete_user($id) { goto HQrLL; Tbn22: $this->set_message("\144\x65\x6c\x65\164\145\137\163\x75\x63\143\145\163\163\x66\165\154"); goto YnjUM; akoMn: return FALSE; goto gFIAn; aDuVq: $this->db->trans_rollback(); goto Tzm3y; BSUAt: $this->remove_from_group(NULL, $id); goto Vp_Y1; d9fEp: $this->trigger_events(["\x70\157\x73\164\137\x64\x65\x6c\145\164\x65\x5f\x75\163\145\x72", "\x70\x6f\x73\164\137\144\x65\154\x65\164\x65\x5f\x75\163\145\x72\x5f\163\165\x63\143\145\163\163\x66\165\x6c"]); goto Tbn22; Vu4Ta: $this->db->trans_begin(); goto BSUAt; YnjUM: return TRUE; goto Jma4L; ciaOm: $this->set_error("\144\x65\154\145\x74\x65\x5f\165\156\163\165\143\x63\145\163\163\146\x75\x6c"); goto akoMn; Tzm3y: $this->trigger_events(["\160\157\x73\x74\137\x64\x65\x6c\145\x74\145\x5f\165\163\x65\162", "\160\157\163\x74\x5f\x64\145\154\x65\x74\x65\x5f\x75\163\x65\162\137\165\156\x73\165\143\143\x65\x73\163\146\x75\x6c"]); goto ciaOm; gFIAn: qYsxf: goto gObe4; Vp_Y1: $this->db->delete($this->tables["\x75\163\145\x72\163"], ["\x69\x64" => $id]); goto jXWPS; gObe4: $this->db->trans_commit(); goto d9fEp; HQrLL: $this->trigger_events("\x70\x72\x65\137\x64\145\x6c\x65\x74\x65\137\x75\x73\145\162"); goto Vu4Ta; jXWPS: if (!($this->db->trans_status() === FALSE)) { goto qYsxf; } goto aDuVq; Jma4L: } public function update_last_login($id) { goto LIcL0; fJKbM: $this->load->helper("\x64\x61\164\145"); goto FUprM; Aqved: $this->db->update($this->tables["\165\x73\145\x72\x73"], ["\x6c\141\x73\164\x5f\154\157\147\151\156" => time()], ["\x69\x64" => $id]); goto Gpw1r; LIcL0: $this->trigger_events("\x75\x70\144\141\x74\x65\137\154\x61\163\x74\137\154\x6f\147\x69\x6e"); goto fJKbM; FUprM: $this->trigger_events("\145\170\x74\x72\x61\x5f\167\150\x65\x72\145"); goto Aqved; Gpw1r: return $this->db->affected_rows() == 1; goto ofFaV; ofFaV: } public function set_lang($lang = "\x65\156") { goto qmQh2; CwFIa: if ($this->config->item("\165\163\x65\162\x5f\x65\x78\x70\151\x72\x65", "\x69\157\156\x5f\141\x75\164\x68") === 0) { goto PNFyI; } goto XIPeA; XIPeA: $expire = $this->config->item("\x75\x73\x65\x72\137\145\170\x70\x69\162\x65", "\151\x6f\156\x5f\141\165\x74\x68"); goto t0Wzx; dH5Ms: eDffC: goto P6_Jr; P6_Jr: set_cookie(["\x6e\141\x6d\x65" => "\154\x61\156\147\137\x63\157\144\145", "\x76\141\x6c\165\x65" => $lang, "\x65\x78\160\x69\162\x65" => $expire]); goto C8YEf; t0Wzx: goto eDffC; goto oCfKD; qmQh2: $this->trigger_events("\x73\x65\164\137\x6c\141\x6e\x67"); goto CwFIa; oCfKD: PNFyI: goto gD3WU; C8YEf: return TRUE; goto dc5zG; gD3WU: $expire = self::MAX_COOKIE_LIFETIME; goto dH5Ms; dc5zG: } public function set_session($user) { goto aT_G4; puuZU: return TRUE; goto SDyb6; aT_G4: $this->trigger_events("\x70\162\145\137\x73\x65\164\x5f\x73\x65\163\163\151\157\x6e"); goto PA_PO; DnOfc: $this->trigger_events("\x70\x6f\x73\x74\x5f\x73\x65\164\137\x73\145\x73\163\x69\x6f\156"); goto puuZU; xHWcf: $this->session->set_userdata($session_data); goto DnOfc; PA_PO: $session_data = ["\x69\x64\x65\156\x74\151\x74\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\x69\154" => $user->email, "\x75\163\x65\162\x5f\151\144" => $user->id, "\157\x6c\144\x5f\x6c\141\163\x74\x5f\154\157\147\x69\156" => $user->last_login, "\x6c\x61\163\x74\137\x63\x68\x65\143\153" => time()]; goto xHWcf; SDyb6: } public function remember_user($identity) { goto j0AcU; n6v_2: if (!$token->validator_hashed) { goto ZfJQ0; } goto BCjlq; BonCj: return FALSE; goto mPVCu; J3Whp: if ($this->config->item("\x75\163\145\162\x5f\x65\x78\160\x69\162\145", "\x69\157\156\x5f\141\165\x74\150") === 0) { goto jh8xS; } goto E5MlN; j0AcU: $this->trigger_events("\x70\x72\145\137\x72\145\x6d\x65\155\142\x65\x72\137\165\x73\145\162"); goto sePUK; WRQhY: ZfJQ0: goto vvWL9; kjkMQ: $expire = self::MAX_COOKIE_LIFETIME; goto Oozjh; n4gGk: goto OQad9; goto yzgNJ; vvWL9: $this->trigger_events(["\160\157\x73\x74\x5f\162\145\155\x65\155\x62\145\x72\x5f\165\163\145\x72", "\162\145\155\145\x6d\142\145\x72\137\165\x73\145\162\137\x75\156\x73\165\x63\143\145\163\163\146\165\154"]); goto q5ZZi; GLTkf: $this->trigger_events(["\x70\x6f\163\164\x5f\162\x65\x6d\x65\155\142\145\x72\x5f\x75\163\x65\x72", "\162\145\x6d\x65\155\142\x65\162\x5f\x75\163\x65\x72\x5f\163\x75\143\x63\145\163\x73\x66\165\x6c"]); goto GI0jR; q5ZZi: return FALSE; goto vzkdr; Lmgsp: set_cookie(["\156\141\155\145" => $this->config->item("\x72\145\x6d\x65\155\142\x65\x72\137\x63\157\x6f\x6b\151\145\137\156\x61\x6d\x65", "\151\157\x6e\x5f\x61\x75\x74\x68"), "\166\141\154\x75\x65" => $token->user_code, "\x65\x78\x70\x69\162\x65" => $expire]); goto GLTkf; Oozjh: OQad9: goto Lmgsp; GI0jR: return TRUE; goto dX9V4; E5MlN: $expire = $this->config->item("\165\x73\145\162\137\x65\x78\x70\x69\x72\145", "\151\157\156\137\141\165\164\150"); goto n4gGk; pE6vy: if (!($this->db->affected_rows() > -1)) { goto kjmMj; } goto J3Whp; FwPLH: $token = $this->_generate_selector_validator_couple(); goto n6v_2; BCjlq: $this->db->update($this->tables["\165\163\145\x72\163"], ["\x72\x65\x6d\145\155\x62\x65\x72\x5f\163\145\154\x65\143\164\157\162" => $token->selector, "\x72\x65\x6d\x65\x6d\142\x65\x72\137\143\157\144\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto pE6vy; yzgNJ: jh8xS: goto kjkMQ; sePUK: if ($identity) { goto m0iwN; } goto BonCj; dX9V4: kjmMj: goto WRQhY; mPVCu: m0iwN: goto FwPLH; vzkdr: } public function login_remembered_user() { goto Y_53U; pdloG: if (!($token === FALSE)) { goto G0XPB; } goto ohK_6; HxtX2: G0XPB: goto PO9SD; ohK_6: $this->trigger_events(["\160\x6f\x73\164\x5f\154\x6f\147\x69\x6e\x5f\162\145\155\x65\x6d\142\x65\162\x65\144\x5f\x75\163\145\x72", "\160\x6f\x73\164\137\x6c\x6f\147\x69\156\137\162\x65\x6d\145\x6d\x62\145\x72\x65\144\137\165\x73\x65\x72\x5f\165\156\x73\x75\143\143\145\x73\163\x66\165\x6c"]); goto RW1I1; khdSs: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto pdloG; oqIQy: delete_cookie($this->config->item("\162\145\155\x65\155\142\x65\162\137\143\157\x6f\x6b\151\145\x5f\156\141\x6d\145", "\151\x6f\x6e\x5f\141\165\164\150")); goto kKnEq; ShJYr: if (!($query->num_rows() === 1)) { goto lCPoS; } goto W0HVh; bqWKa: lCPoS: goto oqIQy; ufAwR: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\x65\155\142\145\x72\x5f\x63\x6f\157\x6b\x69\145\137\156\x61\155\145", "\151\x6f\156\137\141\x75\x74\150")); goto khdSs; RW1I1: return FALSE; goto HxtX2; sRtUg: $this->update_last_login($user->id); goto NnIAW; k6Chi: return TRUE; goto Qn_PT; W0HVh: $user = $query->row(); goto uyvwm; ZOHgG: $query = $this->db->select($this->identity_column . "\x2c\40\151\x64\x2c\40\x65\155\141\x69\x6c\54\x20\x72\x65\155\145\155\142\x65\x72\137\143\157\x64\x65\x2c\x20\154\141\163\x74\x5f\x6c\x6f\x67\x69\156")->where("\162\145\155\145\x6d\x62\x65\162\x5f\163\x65\154\145\x63\164\157\162", $token->selector)->where("\x61\143\164\151\x76\145", 1)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto ShJYr; EV1uV: $this->clear_forgotten_password_code($identity); goto YNdwM; nI0lr: return FALSE; goto v0XHs; kKnEq: $this->trigger_events(["\x70\157\163\x74\x5f\154\157\x67\x69\x6e\137\162\145\x6d\145\x6d\142\x65\x72\145\x64\137\x75\163\145\x72", "\x70\x6f\163\x74\x5f\154\157\x67\x69\x6e\137\162\145\x6d\145\155\142\145\x72\x65\144\137\x75\x73\145\x72\x5f\x75\156\163\165\x63\x63\x65\163\x73\x66\165\x6c"]); goto nI0lr; PO9SD: $this->trigger_events("\x65\170\x74\x72\x61\137\167\150\145\x72\145"); goto ZOHgG; NnIAW: $this->set_session($user); goto EV1uV; Y_53U: $this->trigger_events("\x70\x72\145\137\154\x6f\x67\151\156\137\162\145\x6d\145\155\142\x65\162\145\144\137\x75\163\145\x72"); goto ufAwR; P6dg6: $this->session->sess_regenerate(FALSE); goto LB_xd; Ioktt: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto Xnqj1; } goto sRtUg; LB_xd: $this->trigger_events(["\160\157\163\164\137\154\157\147\x69\x6e\x5f\162\145\155\145\155\142\x65\x72\x65\144\137\x75\163\x65\x72", "\160\x6f\163\164\x5f\154\157\x67\151\x6e\x5f\162\145\x6d\145\155\x62\145\162\145\x64\137\165\163\145\x72\137\x73\x75\143\143\145\x73\x73\146\165\x6c"]); goto k6Chi; uyvwm: $identity = $user->{$this->identity_column}; goto Ioktt; YNdwM: if (!$this->config->item("\165\x73\145\x72\x5f\x65\x78\x74\x65\156\x64\x5f\157\156\137\154\157\x67\151\156", "\x69\x6f\x6e\137\141\165\164\x68")) { goto IB5Kj; } goto XdjnB; Qn_PT: Xnqj1: goto bqWKa; QRdyf: IB5Kj: goto P6dg6; XdjnB: $this->remember_user($identity); goto QRdyf; v0XHs: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto JUhPX; uwSfu: kdWlE: goto tzLEz; ARktu: return FALSE; goto UGqcc; q_zJl: $this->db->insert($this->tables["\x67\x72\x6f\165\160\x73"], $data); goto o9c4z; UGqcc: nKXLj: goto hlBnP; v1ViH: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\x75\160\x73"], $additional_data), $data); goto S_DSN; V9ics: $this->set_message("\x67\162\x6f\165\160\x5f\x63\x72\145\141\x74\151\x6f\x6e\x5f\163\x75\143\143\x65\x73\x73\146\x75\x6c"); goto Wh2I3; SjaTP: $this->trigger_events("\x65\170\x74\x72\141\x5f\x67\162\157\165\160\x5f\163\145\x74"); goto q_zJl; tzLEz: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\x75\x70\x73"], ["\156\141\155\x65" => $group_name])->num_rows(); goto h1_xM; SnmTB: $this->set_error("\x67\x72\157\165\160\137\141\154\162\x65\x61\144\x79\137\x65\x78\151\x73\164\163"); goto ARktu; ViSNI: return FALSE; goto uwSfu; Wh2I3: return $group_id; goto tcUGa; S_DSN: sZBNg: goto SjaTP; h1_xM: if (!($existing_group !== 0)) { goto nKXLj; } goto SnmTB; nOFsR: $this->set_error("\147\x72\x6f\165\x70\137\156\x61\x6d\145\x5f\x72\x65\x71\x75\x69\162\x65\144"); goto ViSNI; hlBnP: $data = ["\156\x61\155\x65" => $group_name, "\144\145\x73\143\x72\x69\160\x74\x69\x6f\156" => $group_description]; goto Y6TQA; Y6TQA: if (empty($additional_data)) { goto sZBNg; } goto v1ViH; JUhPX: if ($group_name) { goto kdWlE; } goto nOFsR; o9c4z: $group_id = $this->db->insert_id($this->tables["\147\x72\x6f\165\160\163"] . "\x5f\151\144\137\x73\145\x71"); goto V9ics; tcUGa: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto L_2bH; IYzSg: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\x70\x73"], $additional_data), $data); goto N_Yy6; mADYv: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\x75\x70\x73"], ["\156\x61\155\145" => $group_name])->row(); goto M8LJZ; L_2bH: if (!empty($group_id)) { goto cHbI_; } goto RISwU; M8LJZ: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto TH1pu; } goto rMsTv; RISwU: return FALSE; goto PR73_; lBRBY: $this->set_message("\x67\162\x6f\x75\160\137\165\160\144\141\x74\145\x5f\x73\165\143\143\x65\x73\x73\x66\165\154"); goto SOLvW; cp0R3: $this->set_error("\147\x72\157\165\160\x5f\x6e\141\155\145\137\141\144\x6d\151\x6e\x5f\156\157\x74\137\x61\154\x74\x65\162"); goto kAg2u; rMsTv: $this->set_error("\x67\x72\157\165\x70\x5f\x61\x6c\162\145\x61\x64\x79\137\x65\x78\151\163\x74\163"); goto VLR19; PR73_: cHbI_: goto zcnSc; yBiaG: if (!($this->config->item("\x61\x64\x6d\151\156\x5f\147\162\x6f\x75\x70", "\151\x6f\x6e\x5f\x61\x75\164\150") === $group->name && $group_name !== $group->name)) { goto P8znG; } goto cp0R3; GGnUm: $data["\x6e\141\155\145"] = $group_name; goto B44ny; rhDrc: $group = $this->db->get_where($this->tables["\x67\162\x6f\x75\x70\x73"], ["\x69\x64" => $group_id])->row(); goto yBiaG; kAg2u: return FALSE; goto vpBnW; SOLvW: return TRUE; goto ftLoL; N_Yy6: Lz3wE: goto kf22C; NKTOc: if (empty($additional_data)) { goto Lz3wE; } goto IYzSg; B44ny: diGkL: goto rhDrc; VLR19: return FALSE; goto yiEsA; vpBnW: P8znG: goto NKTOc; zcnSc: $data = []; goto BDAjD; BDAjD: if (empty($group_name)) { goto diGkL; } goto mADYv; yiEsA: TH1pu: goto GGnUm; kf22C: $this->db->update($this->tables["\x67\162\x6f\x75\x70\163"], $data, ["\x69\x64" => $group_id]); goto lBRBY; ftLoL: } public function delete_group($group_id = FALSE) { goto OvEug; FZhCA: $this->set_error("\x67\162\157\165\160\x5f\144\x65\x6c\145\164\x65\137\x6e\157\x74\141\154\154\157\x77\x65\144"); goto oIzE_; tUbSE: $this->set_error("\147\x72\x6f\165\160\137\x64\145\x6c\x65\164\x65\137\x75\156\163\165\143\143\x65\163\163\x66\x75\154"); goto y2Fa_; y2Fa_: return FALSE; goto Qh63u; oIzE_: return FALSE; goto WEmum; xsP3u: $group = $this->group($group_id)->row(); goto dRfFX; ymzD2: if (!($this->db->trans_status() === FALSE)) { goto qgleX; } goto O7sib; md4xZ: DXr72: goto xsP3u; nQ7SA: $this->db->delete($this->tables["\165\163\x65\x72\163\x5f\147\x72\157\x75\x70\x73"], [$this->join["\x67\162\157\165\160\x73"] => $group_id]); goto w2icq; ox36U: $this->trigger_events(["\x70\157\x73\164\137\144\145\x6c\145\x74\145\137\x67\162\157\165\160", "\160\157\163\x74\x5f\144\x65\154\x65\x74\x65\x5f\x67\162\x6f\x75\x70\137\156\x6f\164\141\154\x6c\157\x77\145\x64"]); goto FZhCA; OvEug: if (!(!$group_id || empty($group_id))) { goto DXr72; } goto tB47M; WEmum: SJtlK: goto IiIfx; qbKh3: $this->trigger_events(["\x70\157\163\x74\137\144\x65\154\145\x74\x65\x5f\x67\162\157\x75\160", "\x70\157\x73\164\x5f\x64\x65\154\145\164\145\x5f\147\x72\x6f\x75\x70\137\163\165\x63\x63\x65\163\x73\146\x75\154"]); goto eDX_H; Qh63u: qgleX: goto L3qUR; Kx3xE: return TRUE; goto ONGqs; IiIfx: $this->trigger_events("\160\x72\145\137\x64\145\154\145\164\145\137\147\x72\x6f\x75\x70"); goto f1OCe; O7sib: $this->db->trans_rollback(); goto g65qX; dRfFX: if (!($group->name == $this->config->item("\x61\144\155\151\x6e\137\147\x72\x6f\x75\x70", "\x69\x6f\x6e\137\141\165\x74\x68"))) { goto SJtlK; } goto ox36U; g65qX: $this->trigger_events(["\160\157\163\x74\137\x64\145\154\145\x74\x65\137\147\162\x6f\x75\160", "\160\157\x73\x74\x5f\144\x65\x6c\145\164\x65\137\147\x72\x6f\165\160\137\x75\156\x73\165\x63\143\x65\163\x73\146\x75\154"]); goto tUbSE; eDX_H: $this->set_message("\147\x72\x6f\165\x70\x5f\x64\145\154\x65\164\x65\x5f\163\x75\143\143\x65\163\x73\146\165\x6c"); goto Kx3xE; tB47M: return FALSE; goto md4xZ; w2icq: $this->db->delete($this->tables["\147\x72\157\x75\x70\x73"], ["\x69\x64" => $group_id]); goto ymzD2; f1OCe: $this->db->trans_begin(); goto nQ7SA; L3qUR: $this->db->trans_commit(); goto qbKh3; ONGqs: } public function set_hook($event, $name, $class, $method, $arguments) { goto zzzGg; CAdTk: $this->_ion_hooks->{$event}[$name]->class = $class; goto OOZlC; jDjW4: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto eRo6l; OOZlC: $this->_ion_hooks->{$event}[$name]->method = $method; goto jDjW4; zzzGg: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto CAdTk; eRo6l: } public function remove_hook($event, $name) { goto IZVZX; I8w5y: unset($this->_ion_hooks->{$event}[$name]); goto fYUoj; IZVZX: if (!isset($this->_ion_hooks->{$event}[$name])) { goto Xvgy3; } goto I8w5y; fYUoj: Xvgy3: goto E0f6g; E0f6g: } public function remove_hooks($event) { goto Yb2o8; Yb2o8: if (!isset($this->_ion_hooks->{$event})) { goto b_m0s; } goto yiOry; mGmus: b_m0s: goto q0Xka; yiOry: unset($this->_ion_hooks->{$event}); goto mGmus; q0Xka: } protected function _call_hook($event, $name) { goto eNhXM; eNhXM: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto JhTjo; } goto TTJgz; GhAkP: return FALSE; goto DVYx4; VKzgi: JhTjo: goto GhAkP; Yqk3V: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto VKzgi; TTJgz: $hook = $this->_ion_hooks->{$event}[$name]; goto Yqk3V; DVYx4: } public function trigger_events($events) { goto ozJb6; XtkRd: C1KKo: goto ftHem; vBYe0: foreach ($events as $event) { $this->trigger_events($event); gnQ3L: } goto DAf4V; ftHem: goto ZHwsY; goto sOfdI; wn4Fg: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto C1KKo; } goto LdafK; LdafK: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); oDT0a: } goto TWbCy; ozJb6: if (is_array($events) && !empty($events)) { goto L3C2e; } goto wn4Fg; sOfdI: L3C2e: goto vBYe0; TWbCy: Oiw8n: goto XtkRd; DAf4V: j2DQK: goto mZiuH; mZiuH: ZHwsY: goto yAO3v; yAO3v: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto i5kfQ; yGpyi: return TRUE; goto uFhhM; i5kfQ: $this->message_start_delimiter = $start_delimiter; goto F27G3; F27G3: $this->message_end_delimiter = $end_delimiter; goto yGpyi; uFhhM: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto oc_Cd; zWSIb: return TRUE; goto Z1rDk; Pk6Cs: $this->error_end_delimiter = $end_delimiter; goto zWSIb; oc_Cd: $this->error_start_delimiter = $start_delimiter; goto Pk6Cs; Z1rDk: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto GLSbT; gqMN0: PqQaU: goto qSnsC; DbRzr: foreach ($this->messages as $message) { goto xnRRx; xnRRx: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto HBQzZ; HV0IT: tdk5U: goto jfXSI; HBQzZ: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto HV0IT; jfXSI: } goto gqMN0; qSnsC: return $_output; goto rYKA5; GLSbT: $_output = ''; goto DbRzr; rYKA5: } public function messages_array($langify = TRUE) { goto uOkrj; ppnS4: MSEog: goto tY8LJ; tY8LJ: return $_output; goto vp3mQ; LYZxP: foreach ($this->messages as $message) { goto EtBEi; oNY5A: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto yLt93; EtBEi: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\x23"; goto oNY5A; yLt93: OfW2Z: goto KfTBc; KfTBc: } goto ppnS4; M9_GU: goto dxNJb; goto F_2L1; vp3mQ: dxNJb: goto l9qCM; pbulJ: return $this->messages; goto M9_GU; YEdY7: $_output = []; goto LYZxP; uOkrj: if ($langify) { goto zEcFE; } goto pbulJ; F_2L1: zEcFE: goto YEdY7; l9qCM: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto v95wM; A2n5A: foreach ($this->errors as $error) { goto kLXMu; mRXzS: Im2Ab: goto BmZgP; kLXMu: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\x23\x23"; goto j1VY8; j1VY8: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto mRXzS; BmZgP: } goto U_nH6; U_nH6: HA0j9: goto oOZr9; oOZr9: return $_output; goto LiN2I; v95wM: $_output = ''; goto A2n5A; LiN2I: } public function errors_array($langify = TRUE) { goto qXKY4; R8e5m: Tvftg: goto rfjVi; SqDND: goto X2B0o; goto Sb3vY; Sb3vY: Z77Yz: goto XBk0f; rfjVi: return $_output; goto Xqcxt; Xqcxt: X2B0o: goto o3yHo; xK24u: return $this->errors; goto SqDND; qXKY4: if ($langify) { goto Z77Yz; } goto xK24u; XBk0f: $_output = []; goto INLFa; INLFa: foreach ($this->errors as $error) { goto ycAMQ; SkMVV: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto H4pqH; H4pqH: nwP62: goto HJ8Ie; ycAMQ: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\43\x23"; goto SkMVV; HJ8Ie: } goto R8e5m; o3yHo: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto wOzIK; Aeg1N: if (!($hash === FALSE)) { goto qdeCo; } goto xlOrz; EyIi5: $this->db->update($this->tables["\165\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto wA6kq; xlOrz: return FALSE; goto S95RZ; wA6kq: return $this->db->affected_rows() == 1; goto O1rDt; uoYQP: $this->trigger_events("\145\170\x74\162\141\x5f\x77\150\145\x72\x65"); goto EyIi5; Cylfk: $data = ["\x70\x61\x73\163\167\x6f\162\144" => $hash, "\162\x65\x6d\145\155\x62\x65\162\x5f\143\x6f\144\145" => NULL, "\x66\x6f\x72\147\157\164\x74\x65\x6e\x5f\x70\141\163\x73\x77\x6f\x72\144\x5f\x63\157\x64\x65" => NULL, "\x66\x6f\162\x67\x6f\164\x74\145\x6e\x5f\x70\141\x73\x73\x77\x6f\x72\144\x5f\164\151\155\x65" => NULL]; goto uoYQP; wOzIK: $hash = $this->hash_password($password, $identity); goto Aeg1N; S95RZ: qdeCo: goto Cylfk; O1rDt: } protected function _filter_data($table, $data) { goto cUQNM; SkM0X: foreach ($columns as $column) { goto GfPU0; kFu6b: $filtered_data[$column] = $data[$column]; goto mcYhq; mcYhq: hXjSe: goto D8_xo; D8_xo: LMQ6I: goto jLPdR; GfPU0: if (!array_key_exists($column, $data)) { goto hXjSe; } goto kFu6b; jLPdR: } goto mAP2L; dbEaj: return $filtered_data; goto dsQ_G; W1dwS: if (!is_array($data)) { goto fuNGk; } goto SkM0X; YHMDi: fuNGk: goto dbEaj; NP3vQ: $columns = $this->db->list_fields($table); goto W1dwS; cUQNM: $filtered_data = []; goto NP3vQ; mAP2L: b04V1: goto YHMDi; dsQ_G: } protected function _random_token($result_length = 32) { goto oyOvE; zT3fb: if (!function_exists("\x6d\x63\162\x79\x70\x74\x5f\x63\x72\x65\x61\x74\x65\137\151\x76")) { goto tNJaI; } goto h1fvC; e7u9X: if (!function_exists("\157\160\x65\x6e\163\163\x6c\x5f\162\x61\x6e\144\x6f\155\137\x70\163\145\x75\144\157\137\142\x79\164\x65\x73")) { goto X9jgJ; } goto aEIHY; eFERs: return bin2hex(random_bytes($result_length / 2)); goto ZEEZ_; PAo2T: if (!function_exists("\162\141\156\x64\x6f\155\137\x62\171\164\145\163")) { goto VEmPk; } goto eFERs; aEIHY: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto bd5fJ; oqCoF: tNJaI: goto e7u9X; bd5fJ: X9jgJ: goto OupU9; OupU9: return FALSE; goto HEIhm; oyOvE: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto KHR7d; } goto HCghM; yOphW: KHR7d: goto PAo2T; HCghM: $result_length = 32; goto yOphW; h1fvC: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto oqCoF; ZEEZ_: VEmPk: goto zT3fb; HEIhm: } protected function _get_hash_parameters($identity = NULL) { goto cZxqv; QFoCy: YMzmS: goto ajIYt; ajIYt: WlM6m: goto cdvjf; Jnrze: switch ($this->hash_method) { case "\142\143\162\x79\160\x74": $params = ["\x63\x6f\x73\x74" => $is_admin ? $this->config->item("\x62\143\x72\171\x70\x74\137\141\x64\x6d\151\x6e\137\x63\157\x73\x74", "\x69\157\x6e\x5f\141\165\x74\150") : $this->config->item("\x62\143\162\x79\x70\164\x5f\x64\145\146\141\165\154\x74\x5f\143\x6f\x73\164", "\x69\x6f\x6e\137\141\x75\x74\150")]; goto A2IzX; case "\141\x72\x67\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\x61\162\147\157\156\x32\x5f\x61\x64\155\151\156\137\160\141\x72\141\155\x73", "\x69\157\x6e\137\x61\x75\164\150") : $this->config->item("\x61\162\147\157\156\x32\x5f\144\145\146\x61\x75\154\x74\x5f\x70\x61\162\x61\x6d\x73", "\x69\x6f\156\137\x61\165\164\x68"); goto A2IzX; default: } goto XPG5H; IUPww: A2IzX: goto W56PQ; ulyFR: if (!$identity) { goto WlM6m; } goto EkCdn; EkCdn: $user_id = $this->get_user_id_from_identity($identity); goto KjLxP; PFni4: $is_admin = TRUE; goto QFoCy; XPG5H: kYh0T: goto IUPww; W56PQ: return $params; goto geNJM; cZxqv: $is_admin = FALSE; goto ulyFR; KjLxP: if (!($user_id && $this->in_group($this->config->item("\141\x64\x6d\x69\156\137\x67\x72\x6f\x75\x70", "\151\157\156\x5f\x61\165\164\x68"), $user_id))) { goto YMzmS; } goto PFni4; cdvjf: $params = FALSE; goto Jnrze; geNJM: } protected function _get_hash_algo() { goto d05sD; c_M0O: gR2Cc: goto qYdL9; d05sD: $algo = FALSE; goto h2Ev9; h2Ev9: switch ($this->hash_method) { case "\142\143\x72\x79\x70\x74": $algo = PASSWORD_BCRYPT; goto bPXXo; case "\141\x72\147\157\156\x32": $algo = PASSWORD_ARGON2I; goto bPXXo; default: } goto c_M0O; qYdL9: bPXXo: goto Z0ezf; Z0ezf: return $algo; goto Fk1yW; Fk1yW: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto b5kRn; fBrY2: $validator = $this->_random_token($validator_size); goto syJR6; syJR6: $validator_hashed = $this->hash_password($validator); goto epTAK; b5kRn: $selector = $this->_random_token($selector_size); goto fBrY2; agSlJ: return (object) ["\x73\x65\154\x65\143\x74\x6f\x72" => $selector, "\166\141\154\x69\144\x61\x74\157\x72\x5f\x68\141\163\150\x65\144" => $validator_hashed, "\165\163\145\162\x5f\143\x6f\144\x65" => $user_code]; goto UhzfF; epTAK: $user_code = "{$selector}\x2e{$validator}"; goto agSlJ; UhzfF: } protected function _retrieve_selector_validator_couple($user_code) { goto L5xSv; jr27K: G3Cvs: goto rVoGF; Xuioy: return (object) ["\x73\x65\154\145\x63\164\157\x72" => $tokens[0], "\166\141\154\151\x64\141\x74\157\x72" => $tokens[1]]; goto v1Y20; v1Y20: n03HU: goto jr27K; L5xSv: if (!$user_code) { goto G3Cvs; } goto HT536; AkNFC: if (!(count($tokens) === 2)) { goto n03HU; } goto Xuioy; rVoGF: return FALSE; goto otl2S; HT536: $tokens = explode("\56", $user_code); goto AkNFC; otl2S: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto O57pi; uweh8: zEUxY: goto t8tG0; FpAy9: eNnEP: goto LfKdf; ylyPN: Zuq9v: goto Ufdr8; lEj0w: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto H1uqZ; Bjq7O: $this->trigger_events(["\160\157\x73\x74\137\163\x68\141\61\137\x70\141\163\163\x77\x6f\x72\x64\137\155\151\147\162\141\164\x69\x6f\156", "\160\157\x73\x74\137\163\x68\x61\61\x5f\x70\x61\x73\x73\167\157\162\x64\x5f\x6d\x69\147\162\x61\164\x69\x6f\156\x5f\165\x6e\163\x75\143\x63\145\163\x73\146\165\x6c"]); goto pGOiD; VIdlW: $this->trigger_events(["\x70\157\163\x74\137\x73\150\x61\x31\137\160\x61\163\163\167\x6f\x72\144\137\155\151\x67\162\141\164\x69\157\156", "\160\x6f\163\x74\137\x73\x68\141\x31\137\x70\x61\163\x73\167\x6f\162\x64\137\155\x69\147\x72\x61\164\x69\157\x6e\137\163\x75\x63\143\145\163\163\146\x75\154"]); goto MrWst; sZAPL: return $result; goto FpAy9; u7mrd: $result = $this->_set_password_db($identity, $password); goto k3HZf; iQ0to: $this->trigger_events(["\160\157\x73\164\137\163\150\141\x31\x5f\x70\x61\163\x73\x77\157\162\x64\137\155\x69\x67\x72\x61\x74\151\x6f\156", "\x70\157\x73\x74\x5f\163\x68\x61\x31\137\x70\x61\x73\163\167\x6f\x72\x64\137\155\151\x67\x72\141\x74\x69\x6f\156\137\x75\x6e\x73\165\143\x63\145\x73\x73\146\x75\x6c"]); goto RYIAo; Osrpe: FbFFR: goto u7mrd; H3Udh: goto jXkOu; goto xgEIA; l1aV0: $query = $this->db->select("\x73\141\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto rP_V2; t8tG0: $salt = substr($hashed_password_db, 0, $salt_length); goto lEj0w; LmMXV: $hashed_password = sha1($password . $salt_db->salt); goto ylyPN; H1uqZ: goto Zuq9v; goto D6h9w; k3HZf: if ($result) { goto JWmgE; } goto TObpm; Ufdr8: if ($hashed_password === $hashed_password_db) { goto FbFFR; } goto gpfuH; TObpm: $this->trigger_events(["\160\157\163\164\x5f\163\150\x61\x31\137\160\x61\x73\163\167\x6f\x72\144\137\x6d\151\147\162\141\164\x69\157\156", "\x70\x6f\x73\164\137\163\x68\x61\x31\137\160\141\x73\163\167\157\x72\144\137\155\151\147\162\x61\x74\x69\x6f\x6e\137\x75\156\163\165\143\x63\x65\163\x73\146\x75\x6c"]); goto H3Udh; D6h9w: p7VxQ: goto l1aV0; ooqoJ: if ($this->config->item("\x73\164\157\162\145\137\x73\x61\x6c\164", "\151\157\x6e\x5f\x61\165\164\150")) { goto p7VxQ; } goto gJrG7; RYIAo: return FALSE; goto uweh8; O57pi: $this->trigger_events("\x70\162\145\137\x73\150\x61\x31\137\160\141\163\163\x77\157\162\144\137\155\x69\x67\162\141\x74\151\157\x6e"); goto ooqoJ; Zmdy0: if ($salt_length) { goto zEUxY; } goto iQ0to; SrbHA: YnVyQ: goto LmMXV; rP_V2: $salt_db = $query->row(); goto XaCJJ; xgEIA: JWmgE: goto VIdlW; gpfuH: $this->trigger_events(["\160\x6f\163\164\137\163\x68\x61\61\x5f\160\x61\x73\x73\167\x6f\162\144\x5f\155\x69\x67\x72\141\164\x69\157\156", "\160\x6f\x73\x74\137\163\x68\141\61\137\x70\141\163\x73\167\157\162\x64\x5f\155\151\147\162\141\164\x69\x6f\156\137\x75\x6e\163\x75\x63\143\145\163\163\146\x75\154"]); goto BRmfi; pGOiD: return FALSE; goto SrbHA; XaCJJ: if (!($query->num_rows() !== 1)) { goto YnVyQ; } goto Bjq7O; MrWst: jXkOu: goto sZAPL; gJrG7: $salt_length = $this->config->item("\x73\x61\154\164\x5f\x6c\145\x6e\147\164\x68", "\151\x6f\x6e\137\x61\165\164\150"); goto Zmdy0; BRmfi: return FALSE; goto JOTik; JOTik: goto eNnEP; goto Osrpe; LfKdf: } }
