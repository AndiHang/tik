<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\120\x41\x54\110") or exit("\x4e\157\x20\144\151\162\145\143\164\x20\x73\143\x72\x69\x70\x74\x20\141\x63\143\x65\163\163\x20\x61\x6c\154\157\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto vU5eV; dTVjq: $this->load->helper("\144\x61\x74\x65"); goto Jcoid; ZGibj: b6vTy: goto ahZRj; ahZRj: $this->_ion_hooks = new stdClass(); goto e5yBR; souka: $this->message_start_delimiter = $this->config->item("\155\145\163\163\x61\x67\x65\x5f\163\164\141\x72\x74\x5f\144\x65\x6c\151\x6d\x69\164\x65\162", "\x69\157\x6e\x5f\x61\165\164\150"); goto QJy4p; n0TXl: $error_suffix = $form_validation_class->getProperty("\x5f\145\x72\162\x6f\x72\137\x73\x75\146\x66\x69\170"); goto PQzo7; n9UYL: $this->error_end_delimiter = $this->config->item("\145\x72\x72\157\162\137\x65\156\144\x5f\x64\145\x6c\151\155\x69\164\x65\x72", "\151\157\x6e\137\x61\165\x74\x68"); goto UgiqN; cLx5p: $this->message_end_delimiter = $this->error_end_delimiter; goto ZGibj; e5yBR: $this->trigger_events("\155\157\144\145\154\137\143\x6f\156\163\164\x72\x75\143\164\x6f\x72"); goto y3yIk; bmehi: $this->join = $this->config->item("\152\157\151\x6e", "\x69\x6f\156\x5f\x61\x75\164\x68"); goto BBAjt; ZMPpt: $this->messages = []; goto m6InH; QJy4p: $this->message_end_delimiter = $this->config->item("\x6d\145\163\x73\x61\147\145\x5f\145\156\x64\x5f\144\x65\154\x69\x6d\x69\164\145\162", "\x69\x6f\x6e\137\141\165\x74\x68"); goto wk0M1; qRAV7: $this->tables = $this->config->item("\164\x61\x62\x6c\x65\163", "\x69\157\x6e\137\x61\165\164\x68"); goto XEML_; eHcK5: $group_name = $this->config->item("\144\141\x74\141\142\x61\x73\x65\x5f\147\162\157\x75\x70\x5f\156\141\x6d\145", "\151\x6f\x6e\x5f\141\x75\x74\150"); goto OnxV_; PQzo7: $error_suffix->setAccessible(TRUE); goto B3ooZ; BBAjt: $this->hash_method = $this->config->item("\x68\x61\163\150\x5f\x6d\x65\164\x68\157\x64", "\151\x6f\156\x5f\x61\165\164\x68"); goto ZMPpt; OnxV_: if (empty($group_name)) { goto fptYt; } goto eKxm3; h2taH: if ($delimiters_source === "\x66\x6f\x72\x6d\x5f\166\141\154\151\144\141\x74\151\157\x6e") { goto z6OX4; } goto souka; W21oX: $error_prefix = $form_validation_class->getProperty("\x5f\145\162\x72\x6f\162\x5f\x70\x72\145\x66\151\x78"); goto VJMnb; WFwFV: $this->db = $CI->db; goto KwDLS; kkujx: $this->message_start_delimiter = $this->error_start_delimiter; goto n0TXl; eZsD6: fptYt: goto P9jyK; KaVCR: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto kkujx; mnnMq: $this->load->library("\x66\157\x72\155\137\x76\141\x6c\x69\144\x61\x74\x69\157\156"); goto cN0Et; B3ooZ: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto cLx5p; z78cb: $this->load->helper("\143\157\157\x6b\151\145"); goto dTVjq; UgiqN: goto b6vTy; goto SXbkc; vU5eV: $this->config->load("\151\157\156\x5f\x61\x75\164\x68", TRUE); goto z78cb; y6fK9: $delimiters_source = $this->config->item("\x64\x65\x6c\x69\155\x69\164\145\x72\x73\137\x73\157\x75\162\143\145", "\151\x6f\156\137\141\x75\164\x68"); goto h2taH; eKxm3: $this->db = $this->load->database($group_name, TRUE, TRUE); goto M18Pu; VJMnb: $error_prefix->setAccessible(TRUE); goto KaVCR; cN0Et: $form_validation_class = new ReflectionClass("\103\x49\137\106\x6f\162\155\137\x76\x61\x6c\151\144\141\x74\151\157\x6e"); goto W21oX; SXbkc: z6OX4: goto mnnMq; XEML_: $this->identity_column = $this->config->item("\151\x64\145\156\x74\x69\164\171", "\151\157\x6e\137\141\165\164\x68"); goto bmehi; KwDLS: ZGktS: goto qRAV7; M18Pu: goto ZGktS; goto eZsD6; P9jyK: $CI =& get_instance(); goto WFwFV; wk0M1: $this->error_start_delimiter = $this->config->item("\x65\x72\x72\x6f\x72\137\163\x74\x61\162\x74\137\x64\145\154\151\x6d\151\164\x65\x72", "\x69\157\156\137\x61\165\x74\150"); goto n9UYL; m6InH: $this->errors = []; goto y6fK9; Jcoid: $this->lang->load("\151\157\156\137\x61\x75\x74\150"); goto eHcK5; y3yIk: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto UcV0S; EuRFe: return FALSE; goto OIKxv; OIKxv: wPC1W: goto JRbqG; UcV0S: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto wPC1W; } goto EuRFe; OBkU8: if (!($algo !== FALSE && $params !== FALSE)) { goto EEOzU; } goto BZFPp; DiCM1: return FALSE; goto fmKlb; AowXU: EEOzU: goto DiCM1; WlQfa: $params = $this->_get_hash_parameters($identity); goto OBkU8; BZFPp: return password_hash($password, $algo, $params); goto AowXU; JRbqG: $algo = $this->_get_hash_algo(); goto WlQfa; fmKlb: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto xtu0H; x4Jdn: XXic6: goto mJ9pX; yN291: Nt61s: goto FTZf1; e9J7a: NZqRW: goto pvVgU; ix8Te: return FALSE; goto e9J7a; pvVgU: if (strpos($hash_password_db, "\44") === 0) { goto XXic6; } goto xa9bz; QPGeF: goto Nt61s; goto x4Jdn; mJ9pX: return password_verify($password, $hash_password_db); goto yN291; xa9bz: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto QPGeF; xtu0H: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto NZqRW; } goto ix8Te; FTZf1: } public function rehash_password_if_needed($hash, $identity, $password) { goto WVeW4; uOyIU: kX3nk: goto cdXss; TMXli: goto kX3nk; goto Xb98h; cdXss: BOKaz: goto wxmEk; hYQbe: $params = $this->_get_hash_parameters($identity); goto A1dUs; A1dUs: if (!($algo !== FALSE && $params !== FALSE)) { goto oQq4v; } goto R0cTA; R0cTA: if (!password_needs_rehash($hash, $algo, $params)) { goto BOKaz; } goto hFxcC; wxmEk: oQq4v: goto PvC15; PEss9: $this->trigger_events(["\x72\145\150\x61\x73\x68\137\160\x61\163\163\167\x6f\162\144", "\x72\145\x68\x61\x73\x68\x5f\160\x61\163\x73\167\157\x72\144\137\x73\x75\x63\x63\x65\x73\163\x66\x75\154"]); goto uOyIU; Xb98h: MSetl: goto PEss9; hFxcC: if ($this->_set_password_db($identity, $password)) { goto MSetl; } goto g6QTA; g6QTA: $this->trigger_events(["\x72\145\x68\141\x73\150\137\160\x61\x73\x73\167\157\x72\144", "\x72\x65\150\x61\163\150\137\160\141\x73\163\167\x6f\x72\144\x5f\x75\x6e\163\x75\x63\x63\x65\x73\163\146\x75\154"]); goto TMXli; WVeW4: $algo = $this->_get_hash_algo(); goto hYQbe; PvC15: } public function get_user_by_activation_code($user_code) { goto N_NHX; b9WSo: $user = $this->where("\x61\x63\x74\151\166\x61\x74\x69\x6f\x6e\137\163\x65\154\145\143\x74\x6f\x72", $token->selector)->users()->row(); goto GEK59; KvUzE: return FALSE; goto glpZH; eNhte: MyY_e: goto v7pw7; v7pw7: y7lsP: goto KvUzE; GEK59: if (!$user) { goto y7lsP; } goto BdqTl; BdqTl: if (!$this->verify_password($token->validator, $user->activation_code)) { goto MyY_e; } goto GmDXW; GmDXW: return $user; goto eNhte; N_NHX: $token = $this->_retrieve_selector_validator_couple($user_code); goto b9WSo; glpZH: } public function activate($id, $code = FALSE) { goto qyCu7; z_pS9: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x61\143\164\151\166\x61\164\145", "\x70\x6f\163\x74\137\141\x63\x74\151\166\x61\x74\145\x5f\x75\x6e\x73\165\x63\x63\145\163\163\x66\x75\x6c"]); goto x_0cV; hBdjT: $data = ["\141\143\x74\151\x76\x61\164\151\x6f\156\137\x73\x65\154\145\x63\x74\157\162" => NULL, "\141\x63\x74\151\166\x61\164\x69\157\156\137\x63\157\x64\145" => NULL, "\141\x63\x74\151\x76\145" => 1]; goto zlat_; jyxmb: if (!($code === FALSE || $user && $user->id === $id)) { goto VVLCu; } goto hBdjT; oeunD: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, ["\x69\x64" => $id]); goto t4oU0; ht2fa: VVLCu: goto z_pS9; UYcuX: zLNSo: goto ht2fa; t4oU0: if (!($this->db->affected_rows() === 1)) { goto zLNSo; } goto MzZqy; WZxKw: return FALSE; goto HRptr; zlat_: $this->trigger_events("\145\x78\164\x72\141\x5f\167\150\x65\162\x65"); goto oeunD; hbJ5x: return TRUE; goto UYcuX; MzZqy: $this->trigger_events(["\160\157\x73\164\x5f\141\143\x74\x69\x76\141\x74\x65", "\160\x6f\x73\164\137\141\x63\164\151\x76\141\x74\x65\137\x73\x75\x63\143\x65\163\x73\x66\x75\154"]); goto TuYyn; xqryn: $user = $this->get_user_by_activation_code($code); goto mT6vH; TuYyn: $this->set_message("\x61\143\x74\x69\166\x61\x74\145\x5f\163\x75\x63\143\x65\163\163\146\165\154"); goto hbJ5x; mT6vH: NfJt7: goto jyxmb; qyCu7: $this->trigger_events("\x70\x72\145\137\x61\143\x74\x69\166\141\x74\x65"); goto M5Zh7; x_0cV: $this->set_error("\141\143\164\x69\166\141\164\145\137\x75\x6e\x73\x75\x63\143\145\x73\163\146\x75\x6c"); goto WZxKw; M5Zh7: if (!($code !== FALSE)) { goto NfJt7; } goto xqryn; HRptr: } public function deactivate($id = NULL) { goto e8B9w; M0jfU: $this->trigger_events("\145\x78\164\x72\141\137\167\150\145\162\145"); goto r94zp; DxEoA: return FALSE; goto BU2Kt; P2Hm0: goto hK8gl; goto sou20; JmGsz: CtdXJ: goto P2Hm0; w5zgZ: $this->set_error("\144\x65\x61\x63\x74\151\x76\x61\164\x65\x5f\x63\165\x72\162\x65\156\x74\137\165\x73\x65\162\x5f\165\156\163\165\143\x63\145\163\x73\146\165\154"); goto zfCfk; iH4vm: goto Q0gtq; goto I0d9A; O0_Dj: $return = $this->db->affected_rows() == 1; goto A13wf; SvUtE: $data = ["\141\x63\164\x69\x76\x61\x74\x69\x6f\x6e\137\163\x65\154\x65\143\164\157\x72" => $token->selector, "\141\x63\x74\151\x76\141\x74\x69\157\156\x5f\x63\x6f\144\x65" => $token->validator_hashed, "\141\143\x74\x69\x76\145" => 0]; goto M0jfU; wQEvu: $this->set_message("\144\x65\141\143\164\x69\x76\141\x74\145\137\x73\165\143\x63\145\163\163\146\165\x6c"); goto Wl7LV; zfCfk: return FALSE; goto JmGsz; BU2Kt: hK8gl: goto S0wwk; I0d9A: vygrp: goto wQEvu; k4v7R: if (!isset($id)) { goto MqRC3; } goto bRYxL; GZrfy: $this->set_error("\144\x65\141\x63\164\x69\166\x61\164\x65\x5f\165\156\163\x75\143\143\x65\163\163\146\165\154"); goto DxEoA; FhINp: $this->activation_code = $token->user_code; goto SvUtE; sou20: MqRC3: goto GZrfy; r94zp: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, ["\151\144" => $id]); goto O0_Dj; S0wwk: $token = $this->_generate_selector_validator_couple(20, 40); goto FhINp; CDhme: $this->set_error("\x64\x65\x61\x63\164\x69\x76\141\164\145\137\165\x6e\163\x75\x63\143\x65\163\163\x66\165\154"); goto iH4vm; Wl7LV: Q0gtq: goto gMlrL; bRYxL: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto CtdXJ; } goto w5zgZ; A13wf: if ($return) { goto vygrp; } goto CDhme; e8B9w: $this->trigger_events("\x64\145\x61\x63\x74\x69\x76\141\164\x65"); goto k4v7R; gMlrL: return $return; goto ekdmg; ekdmg: } public function clear_forgotten_password_code($identity) { goto sEi6d; sEi6d: if (!empty($identity)) { goto t5_J9; } goto TMDkL; b1II5: $data = ["\x66\157\162\147\157\164\x74\145\156\137\160\141\163\x73\x77\x6f\162\144\x5f\163\x65\154\145\x63\x74\x6f\x72" => NULL, "\x66\x6f\162\x67\157\x74\164\145\156\137\160\x61\163\x73\x77\x6f\x72\144\137\143\157\x64\145" => NULL, "\146\157\162\147\x6f\x74\164\x65\x6e\137\160\x61\x73\163\x77\x6f\162\x64\137\164\151\x6d\x65" => NULL]; goto HrI2G; TMDkL: return FALSE; goto IeYa6; IeYa6: t5_J9: goto b1II5; Me2fo: return TRUE; goto zCh85; HrI2G: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto Me2fo; zCh85: } public function clear_remember_code($identity) { goto nRRVo; HtTpr: return FALSE; goto w94fR; bPQU_: $data = ["\x72\145\x6d\145\155\142\145\x72\137\163\145\154\x65\x63\164\157\x72" => NULL, "\x72\x65\x6d\x65\x6d\142\145\x72\x5f\143\x6f\144\x65" => NULL]; goto f209k; fszRQ: return TRUE; goto gdwD6; f209k: $this->db->update($this->tables["\165\163\145\x72\163"], $data, [$this->identity_column => $identity]); goto fszRQ; nRRVo: if (!empty($identity)) { goto em9RP; } goto HtTpr; w94fR: em9RP: goto bPQU_; gdwD6: } public function reset_password($identity, $new) { goto hv11e; ZsrcT: imniZ: goto bMttu; hv11e: $this->trigger_events("\160\x72\145\137\x63\150\141\x6e\147\x65\137\160\141\x73\163\x77\157\x72\x64"); goto iUCBN; Ov5tj: cK83t: goto l7To3; iUCBN: if ($this->identity_check($identity)) { goto cK83t; } goto oiuG2; FPLhY: return $return; goto y3Qy1; Hq0Yw: $this->set_error("\160\x61\163\x73\167\157\162\144\x5f\x63\x68\x61\x6e\x67\145\x5f\x75\x6e\163\165\143\x63\x65\163\163\x66\x75\154"); goto VjE05; yc1Ja: $this->set_message("\x70\x61\163\x73\x77\157\x72\x64\137\x63\x68\141\156\147\145\137\x73\x75\x63\x63\x65\163\163\x66\165\154"); goto vH120; ETgnp: $this->trigger_events(["\160\157\x73\164\x5f\x63\150\x61\x6e\x67\145\137\160\141\163\x73\167\x6f\x72\144", "\x70\x6f\x73\x74\137\x63\150\141\156\147\145\137\x70\x61\x73\163\x77\x6f\162\x64\x5f\165\156\x73\165\143\143\145\x73\x73\x66\165\154"]); goto Hq0Yw; vH120: jHhUO: goto FPLhY; SeLxi: if ($return) { goto imniZ; } goto ETgnp; bMttu: $this->trigger_events(["\x70\157\163\x74\x5f\x63\150\141\x6e\x67\145\137\160\141\163\x73\167\157\162\x64", "\x70\x6f\163\164\x5f\143\150\141\x6e\x67\145\x5f\160\x61\x73\x73\167\157\162\144\x5f\163\x75\x63\x63\145\163\163\x66\165\x6c"]); goto yc1Ja; oiuG2: $this->trigger_events(["\160\157\163\x74\x5f\x63\x68\x61\156\147\145\137\160\141\x73\163\167\x6f\x72\144", "\160\157\x73\x74\137\x63\150\x61\156\147\145\137\160\141\163\163\x77\157\x72\144\x5f\x75\x6e\x73\165\x63\143\x65\x73\x73\x66\x75\x6c"]); goto Wz0le; Wz0le: return FALSE; goto Ov5tj; l7To3: $return = $this->_set_password_db($identity, $new); goto SeLxi; VjE05: goto jHhUO; goto ZsrcT; y3Qy1: } public function change_password($identity, $old, $new) { goto rgZsw; PxXet: if (!($query->num_rows() !== 1)) { goto nqP2Q; } goto KdnBn; C9Y6A: $query = $this->db->select("\x69\144\x2c\40\x70\x61\x73\x73\x77\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\145\163\143")->get($this->tables["\x75\163\x65\162\163"]); goto PxXet; L_NAA: $this->set_message("\x70\x61\163\163\167\x6f\x72\x64\x5f\143\x68\141\156\147\145\137\x73\x75\x63\x63\145\x73\x73\146\165\154"); goto zKyRl; AeLTP: $user = $query->row(); goto yYTT7; DFpzI: F7nU6: goto ZPN0D; gaslt: $this->set_error("\160\x61\163\163\x77\157\162\144\x5f\143\x68\x61\x6e\x67\x65\137\165\156\163\x75\x63\143\x65\163\x73\x66\165\x6c"); goto Ygn0z; ZPN0D: $this->trigger_events(["\160\157\x73\x74\137\143\x68\x61\x6e\147\x65\x5f\160\x61\x73\x73\x77\157\x72\x64", "\x70\157\x73\164\137\143\150\141\x6e\x67\x65\x5f\160\x61\x73\x73\x77\157\162\144\x5f\163\165\x63\143\145\x73\163\146\165\154"]); goto L_NAA; CJXP6: $this->trigger_events(["\160\157\x73\164\x5f\143\x68\x61\x6e\147\x65\137\x70\x61\x73\x73\x77\x6f\x72\x64", "\160\157\163\x74\x5f\x63\150\141\x6e\x67\145\137\160\141\x73\163\x77\157\x72\144\x5f\x75\156\163\165\x63\143\x65\163\163\x66\165\x6c"]); goto j0aOa; d_xQH: return FALSE; goto PLsCd; zKyRl: dRh2R: goto lnx_3; Ygn0z: return FALSE; goto pqc58; IkdiV: if ($result) { goto F7nU6; } goto CJXP6; knaJ0: $this->trigger_events("\x65\x78\164\x72\x61\x5f\x77\150\x65\x72\x65"); goto C9Y6A; rgZsw: $this->trigger_events("\160\x72\145\x5f\x63\x68\x61\156\147\x65\137\160\x61\163\x73\x77\x6f\162\144"); goto knaJ0; KdnBn: $this->trigger_events(["\160\x6f\x73\x74\x5f\x63\x68\x61\156\x67\145\137\x70\141\x73\x73\x77\157\x72\x64", "\160\x6f\x73\164\x5f\143\x68\141\156\x67\145\x5f\160\x61\163\163\x77\x6f\162\x64\137\165\156\163\165\143\x63\145\163\x73\x66\165\x6c"]); goto UPu2N; PLsCd: nqP2Q: goto AeLTP; j0aOa: $this->set_error("\x70\x61\x73\163\167\157\x72\144\137\x63\x68\x61\x6e\147\x65\x5f\x75\x6e\x73\x75\143\x63\145\163\x73\x66\165\154"); goto qCWkt; B0uRl: eLpbq: goto gaslt; qCWkt: goto dRh2R; goto DFpzI; lnx_3: return $result; goto B0uRl; UPu2N: $this->set_error("\x70\x61\163\x73\167\x6f\x72\x64\137\143\x68\x61\x6e\x67\145\137\x75\x6e\163\165\x63\x63\145\x73\163\x66\165\x6c"); goto d_xQH; yYTT7: if (!$this->verify_password($old, $user->password, $identity)) { goto eLpbq; } goto z07PU; z07PU: $result = $this->_set_password_db($identity, $new); goto IkdiV; pqc58: } public function username_check($username = '') { goto XZYxO; mm9Ds: return FALSE; goto l8t96; ePwZO: $this->trigger_events("\x65\170\164\x72\x61\137\167\x68\145\x72\145"); goto rXHCR; XZYxO: $this->trigger_events("\x75\163\145\162\156\x61\155\x65\x5f\143\150\145\143\x6b"); goto mO2x3; l8t96: ptjZN: goto ePwZO; mO2x3: if (!empty($username)) { goto ptjZN; } goto mm9Ds; rXHCR: return $this->db->where("\165\x73\145\162\156\x61\x6d\145", $username)->limit(1)->count_all_results($this->tables["\x75\163\145\x72\163"]) > 0; goto lmlIC; lmlIC: } public function email_check($email = '') { goto U2V92; U2V92: $this->trigger_events("\145\x6d\141\x69\x6c\137\x63\x68\x65\143\x6b"); goto TJTcT; TJTcT: if (!empty($email)) { goto phomG; } goto L2DNw; L2DNw: return FALSE; goto zAFP2; oBmoH: $this->trigger_events("\x65\170\x74\x72\x61\x5f\x77\x68\x65\x72\x65"); goto QdHwG; zAFP2: phomG: goto oBmoH; QdHwG: return $this->db->where("\145\155\141\151\154", $email)->limit(1)->count_all_results($this->tables["\x75\x73\x65\x72\x73"]) > 0; goto mIu3h; mIu3h: } public function identity_check($identity = '') { goto bS4zs; bS4zs: $this->trigger_events("\x69\144\145\156\164\151\164\171\137\143\x68\x65\143\153"); goto dsTCW; gJZpK: return FALSE; goto wfzag; dsTCW: if (!empty($identity)) { goto vE3aI; } goto gJZpK; bAYU2: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\x73"]) > 0; goto YzIGt; wfzag: vE3aI: goto bAYU2; YzIGt: } public function get_user_id_from_identity($identity = '') { goto BQHlT; CmvMZ: return $user->id; goto NhN0s; BDCOL: return FALSE; goto pu0NK; T8fmp: return FALSE; goto fxXsq; suq6i: $user = $query->row(); goto CmvMZ; GYafU: if (!($query->num_rows() !== 1)) { goto TxoW9; } goto T8fmp; fxXsq: TxoW9: goto suq6i; BQHlT: if (!empty($identity)) { goto D2Tf9; } goto BDCOL; pu0NK: D2Tf9: goto cj3hu; cj3hu: $query = $this->db->select("\x69\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto GYafU; NhN0s: } public function forgotten_password($identity) { goto Dv6N0; hdOvM: $this->trigger_events(["\x70\x6f\163\x74\137\x66\x6f\162\x67\x6f\164\x74\x65\156\137\160\141\x73\x73\167\x6f\162\144", "\160\157\163\164\137\146\x6f\162\x67\x6f\164\164\145\156\137\x70\x61\163\163\x77\157\x72\144\137\x75\156\x73\x75\x63\143\x65\163\163\146\x75\154"]); goto CAuif; CCwP1: $this->trigger_events(["\x70\x6f\163\x74\x5f\146\157\162\147\x6f\x74\164\x65\156\137\160\x61\x73\x73\167\x6f\x72\x64", "\x70\x6f\163\164\x5f\x66\x6f\162\x67\157\x74\x74\145\x6e\137\x70\x61\163\x73\167\157\162\144\x5f\x73\x75\x63\143\145\163\x73\146\165\x6c"]); goto kvTKf; kvTKf: return $token->user_code; goto Pzc2F; KmGQy: dxnYu: goto gHrdi; HavJl: $this->trigger_events(["\160\157\x73\164\137\x66\x6f\162\x67\157\x74\x74\x65\x6e\137\x70\141\x73\x73\x77\157\162\144", "\160\x6f\163\164\137\146\157\x72\147\x6f\164\164\145\x6e\137\160\x61\163\163\x77\x6f\162\x64\x5f\165\x6e\163\x75\x63\x63\x65\x73\163\x66\165\x6c"]); goto VUk8p; BQ09w: goto wSkpV; goto SdG2a; yO_e5: $this->db->update($this->tables["\x75\x73\x65\x72\163"], $update, [$this->identity_column => $identity]); goto mkTOy; m0z14: $this->trigger_events("\145\x78\164\x72\x61\137\167\x68\x65\x72\x65"); goto yO_e5; VUk8p: return FALSE; goto BQ09w; Pzc2F: wSkpV: goto O4ou_; CAuif: return FALSE; goto KmGQy; Dv6N0: if (!empty($identity)) { goto dxnYu; } goto hdOvM; gHrdi: $token = $this->_generate_selector_validator_couple(20, 80); goto dAl3y; SdG2a: uA5E0: goto CCwP1; mkTOy: if ($this->db->affected_rows() === 1) { goto uA5E0; } goto HavJl; dAl3y: $update = ["\146\x6f\162\x67\157\164\164\145\156\x5f\x70\x61\163\163\x77\x6f\x72\x64\x5f\163\145\x6c\145\143\x74\x6f\x72" => $token->selector, "\x66\x6f\162\x67\x6f\164\164\145\x6e\x5f\x70\141\x73\x73\167\x6f\162\144\137\x63\157\x64\x65" => $token->validator_hashed, "\146\157\162\x67\157\x74\x74\145\156\137\x70\141\x73\x73\x77\157\162\x64\x5f\164\151\155\145" => time()]; goto m0z14; O4ou_: } public function get_user_by_forgotten_password_code($user_code) { goto OmNmD; C1yVR: Ohs20: goto j569A; cnGvy: $user = $this->where("\146\157\162\x67\157\x74\x74\x65\x6e\x5f\160\x61\x73\163\167\157\x72\144\137\x73\x65\154\145\143\164\157\162", $token->selector)->users()->row(); goto QDQdT; j569A: JKlzu: goto tkA21; OmNmD: $token = $this->_retrieve_selector_validator_couple($user_code); goto cnGvy; xMeLz: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto Ohs20; } goto rBugW; tkA21: return FALSE; goto lpwYH; QDQdT: if (!$user) { goto JKlzu; } goto xMeLz; rBugW: return $user; goto C1yVR; lpwYH: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto uVPqJ; H88HV: if ($this->identity_check($identity)) { goto hG43K; } goto zfoR3; zfoR3: if (!(!$this->config->item("\x64\145\146\141\165\154\164\x5f\x67\x72\157\165\x70", "\151\x6f\156\x5f\141\165\x74\150") && empty($groups))) { goto rt9LG; } goto yJ9D1; yJ9D1: $this->set_error("\x61\x63\143\157\x75\156\x74\x5f\x63\x72\145\x61\x74\x69\157\156\137\x6d\x69\163\163\151\x6e\147\137\x64\145\x66\x61\x75\154\164\137\x67\162\157\165\x70"); goto JdkHY; IjIjZ: return FALSE; goto dY2UI; gA1Oq: return FALSE; goto z3eJ3; YBysC: $this->set_error("\141\x63\x63\157\x75\x6e\x74\137\143\x72\x65\141\x74\151\157\156\137\x69\x6e\x76\141\x6c\x69\144\x5f\144\145\146\x61\165\x6c\x74\x5f\x67\162\x6f\165\160"); goto XjQ5m; P7Agd: DvMtW: goto y7LvU; E9UGt: $query = $this->db->get_where($this->tables["\147\x72\x6f\x75\160\163"], ["\156\141\155\x65" => $this->config->item("\144\145\146\141\x75\154\164\137\147\x72\157\165\x70", "\151\x6f\x6e\137\141\x75\x74\150")], 1)->row(); goto jq2um; dY2UI: dOpfx: goto E9UGt; mORUU: foreach ($groups as $group) { $this->add_to_group($group, $id); fofH8: } goto P7Agd; LHfdB: cVjIO: goto b0NDr; O2Fpt: hG43K: goto fMP1e; JdkHY: return FALSE; goto vf6oJ; BNR9K: goto dOpfx; goto O2Fpt; jq2um: if (!(!isset($query->id) && empty($groups))) { goto cVjIO; } goto YBysC; KwpIP: $manual_activation = $this->config->item("\155\141\x6e\165\x61\x6c\x5f\141\143\x74\x69\x76\x61\164\151\x6f\x6e", "\151\x6f\x6e\137\x61\165\x74\150"); goto H88HV; b0NDr: $default_group = $query; goto qaYtV; z3eJ3: LRgD0: goto aVlhC; DRv9T: if (!($password === FALSE)) { goto LRgD0; } goto CVUl2; wGw0v: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\x65\x72\163"], $additional_data), $data); goto fAWbL; fAWbL: $this->trigger_events("\145\170\164\162\x61\137\163\x65\164"); goto m9wIV; BEVoX: $password = $this->hash_password($password); goto DRv9T; ms3CT: if (empty($groups)) { goto ImAOE; } goto mORUU; MUv8V: if (!(isset($default_group->id) && empty($groups))) { goto Lf18s; } goto zfixM; xnFYc: return isset($id) ? $id : FALSE; goto Xjr7v; uVPqJ: $this->trigger_events("\x70\162\145\x5f\x72\145\x67\x69\x73\164\x65\162"); goto KwpIP; y7LvU: ImAOE: goto IUvj1; fMP1e: $this->set_error("\141\143\143\x6f\x75\x6e\x74\137\x63\162\145\x61\164\151\157\x6e\137\144\165\160\x6c\151\x63\x61\x74\x65\x5f\x69\144\x65\156\x74\x69\164\171"); goto IjIjZ; CVUl2: $this->set_error("\x61\143\x63\x6f\165\156\164\137\x63\162\145\141\164\151\x6f\156\137\165\156\163\x75\x63\143\x65\x73\163\x66\165\154"); goto gA1Oq; zfixM: $groups[] = $default_group->id; goto nRT7B; aVlhC: $data = [$this->identity_column => $identity, "\165\163\x65\x72\x6e\x61\x6d\145" => $identity, "\160\141\x73\163\167\157\162\144" => $password, "\x65\155\x61\151\x6c" => $email, "\151\160\x5f\x61\144\144\x72\x65\x73\x73" => $ip_address, "\x63\162\x65\141\x74\x65\x64\x5f\x6f\x6e" => time(), "\x61\143\x74\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto wGw0v; nRT7B: Lf18s: goto ms3CT; qaYtV: $ip_address = $this->input->ip_address(); goto BEVoX; vf6oJ: rt9LG: goto BNR9K; m9wIV: $this->db->insert($this->tables["\x75\163\x65\x72\x73"], $user_data); goto gnmXI; gnmXI: $id = $this->db->insert_id($this->tables["\x75\x73\x65\x72\163"] . "\x5f\x69\x64\x5f\x73\145\x71"); goto MUv8V; XjQ5m: return FALSE; goto LHfdB; IUvj1: $this->trigger_events("\x70\x6f\163\x74\x5f\162\145\147\151\x73\164\x65\x72"); goto xnFYc; Xjr7v: } public function login($identity, $password, $remember = FALSE) { goto oXSdE; Qr2Vq: $query = $this->db->select($this->identity_column . "\54\40\145\155\141\151\154\x2c\x20\151\144\x2c\40\x70\x61\163\x73\x77\x6f\x72\x64\x2c\40\x61\143\164\x69\x76\145\54\x20\x6c\x61\x73\164\x5f\154\157\x67\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\145\x73\143")->get($this->tables["\x75\163\x65\162\163"]); goto PBB5J; ySCw6: return FALSE; goto cw4xS; ywi8M: $this->session->sess_regenerate(FALSE); goto v0H0D; glzbv: $this->set_message("\154\157\x67\x69\x6e\x5f\163\165\143\143\x65\163\163\x66\x75\x6c"); goto DAPzX; wF_eg: $this->set_error("\x6c\157\x67\151\156\137\x75\156\163\x75\143\x63\145\163\x73\146\165\x6c\x5f\x6e\157\x74\x5f\141\143\164\151\166\145"); goto gHjkA; cG6dy: return FALSE; goto uGjvn; efKPg: if (!($query->num_rows() === 1)) { goto gKOJM; } goto o4FFB; dHzrj: $this->clear_forgotten_password_code($identity); goto JU1Qk; gHjkA: return FALSE; goto yvbZy; wC89w: return FALSE; goto rO5d9; JU1Qk: if (!$this->config->item("\x72\145\155\x65\155\x62\145\x72\137\x75\x73\x65\162\163", "\x69\157\156\x5f\141\165\164\150")) { goto e_MTB; } goto sVxmI; Qd8bG: $this->set_error("\154\157\x67\151\x6e\x5f\x75\156\163\165\143\143\x65\x73\x73\x66\165\154"); goto ySCw6; yvbZy: yrGR_: goto MrcsQ; OS7RH: e_MTB: goto LfmcB; qLi83: $this->update_last_login($user->id); goto cAqQO; XQVaO: $this->trigger_events("\x65\170\164\x72\141\137\x77\x68\145\162\x65"); goto Qr2Vq; zCqK0: $this->remember_user($identity); goto R6XLa; oXSdE: $this->trigger_events("\x70\162\x65\137\x6c\x6f\147\151\x6e"); goto MlwgY; MlwgY: if (!(empty($identity) || empty($password))) { goto Mxps4; } goto Qd8bG; DAPzX: return TRUE; goto pWj0Q; sVxmI: if ($remember) { goto DCRB7; } goto S0vIK; VzN3B: $this->trigger_events("\x70\157\x73\164\x5f\154\157\147\151\156\137\165\x6e\163\165\x63\143\x65\163\163\x66\x75\154"); goto wF_eg; LfmcB: $this->rehash_password_if_needed($user->password, $identity, $password); goto ywi8M; f3IHU: goto yk5Bt; goto lcNxF; rO5d9: EnyJN: goto efKPg; lcNxF: DCRB7: goto zCqK0; UVXU1: if (!($user->active == 0)) { goto yrGR_; } goto VzN3B; y1kYu: $this->set_error("\154\157\x67\x69\x6e\x5f\x75\156\x73\165\x63\x63\145\x73\163\146\x75\x6c"); goto cG6dy; v0H0D: $this->trigger_events(["\x70\157\x73\164\x5f\x6c\x6f\147\151\x6e", "\x70\157\x73\164\137\154\157\x67\x69\x6e\x5f\163\165\x63\143\x65\163\x73\x66\165\x6c"]); goto glzbv; cw4xS: Mxps4: goto XQVaO; URSNQ: $this->increase_login_attempts($identity); goto Lgok9; Lgok9: $this->trigger_events("\x70\x6f\x73\x74\x5f\154\x6f\x67\x69\156\137\165\156\x73\165\143\143\145\x73\163\146\x75\154"); goto y1kYu; cAqQO: $this->clear_login_attempts($identity); goto dHzrj; N57d1: $this->set_error("\x6c\x6f\x67\151\156\x5f\x74\x69\x6d\x65\157\x75\x74"); goto wC89w; KIZso: $this->hash_password($password); goto DPpB8; PBB5J: if (!$this->is_max_login_attempts_exceeded($identity)) { goto EnyJN; } goto KIZso; R6XLa: yk5Bt: goto OS7RH; S0vIK: $this->clear_remember_code($identity); goto f3IHU; Dj_26: if (!$this->verify_password($password, $user->password, $identity)) { goto xJt08; } goto UVXU1; qna6P: gKOJM: goto sptMg; MrcsQ: $this->set_session($user); goto qLi83; DPpB8: $this->trigger_events("\160\x6f\x73\x74\137\x6c\157\147\151\x6e\x5f\165\156\163\x75\143\x63\145\x73\163\146\x75\x6c"); goto N57d1; o4FFB: $user = $query->row(); goto Dj_26; sptMg: $this->hash_password($password); goto URSNQ; pWj0Q: xJt08: goto qna6P; uGjvn: } public function recheck_session() { goto taxJq; Vvr2P: $this->trigger_events("\154\157\x67\157\165\164"); goto eQRHW; ofl1p: Ik9XL: goto XetDO; ZGQJl: $this->session->set_userdata("\x6c\x61\x73\x74\x5f\143\150\x65\x63\153", time()); goto x6_Wd; B4rEA: goto mcyVy; goto OZYjT; VmYCi: $query = $this->db->select("\151\144")->where([$this->identity_column => $this->session->userdata("\x69\144\145\156\164\x69\164\171"), "\x61\143\164\151\166\x65" => "\x31"])->limit(1)->order_by("\151\x64", "\144\145\163\143")->get($this->tables["\165\x73\x65\162\163"]); goto lbZ0m; qUT8N: if (!($recheck !== 0)) { goto Ik9XL; } goto DQUVm; VEHDl: $this->session->unset_userdata([$identity, "\151\x64", "\165\x73\x65\162\x5f\151\x64"]); goto z78Uj; x6_Wd: mcyVy: goto TWlKR; eQRHW: $identity = $this->config->item("\151\144\145\156\164\x69\164\x79", "\151\157\156\x5f\141\165\164\x68"); goto VEHDl; z78Uj: return FALSE; goto B4rEA; DQUVm: $last_login = $this->session->userdata("\x6c\x61\163\164\137\143\150\x65\143\x6b"); goto DlKIw; lbZ0m: if ($query->num_rows() === 1) { goto LQkQD; } goto Vvr2P; TWlKR: s2m54: goto ofl1p; XetDO: return (bool) $this->session->userdata("\151\x64\145\x6e\x74\x69\164\x79"); goto Q2FOZ; OZYjT: LQkQD: goto ZGQJl; taxJq: $recheck = NULL !== $this->config->item("\x72\x65\x63\x68\x65\x63\153\x5f\x74\x69\155\x65\x72", "\151\x6f\156\x5f\141\x75\164\150") ? $this->config->item("\x72\x65\x63\150\x65\143\153\137\x74\151\x6d\x65\x72", "\x69\x6f\x6e\137\141\x75\x74\x68") : 0; goto qUT8N; DlKIw: if (!($last_login + $recheck < time())) { goto s2m54; } goto VmYCi; Q2FOZ: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto V4XSZ; a2McC: tT03o: goto BMTfx; BMTfx: return FALSE; goto JHWig; vV5sL: aluir: goto a2McC; p8Lk7: $attempts = $this->get_attempts_num($identity, $ip_address); goto Dzl2r; YTHdn: $max_attempts = $this->config->item("\155\141\170\151\155\x75\155\137\x6c\x6f\147\x69\156\137\141\164\164\x65\x6d\160\x74\163", "\151\x6f\x6e\137\141\x75\x74\150"); goto qZQ1k; qZQ1k: if (!($max_attempts > 0)) { goto aluir; } goto p8Lk7; Dzl2r: return $attempts >= $max_attempts; goto vV5sL; V4XSZ: if (!$this->config->item("\164\x72\141\143\x6b\x5f\x6c\157\147\151\x6e\137\141\164\164\145\155\x70\164\x73", "\151\x6f\156\x5f\141\165\164\x68")) { goto tT03o; } goto YTHdn; JHWig: } public function get_attempts_num($identity, $ip_address = NULL) { goto V715n; FE6Us: $ip_address = $this->input->ip_address(); goto Yz_qv; llTwV: if (isset($ip_address)) { goto inRua; } goto FE6Us; Jxy2I: return 0; goto rRVOQ; ogr75: fap_R: goto Jxy2I; Yz_qv: inRua: goto vfL57; cqCM_: return $qres->num_rows(); goto ogr75; F3KUz: Ku8cC: goto trlag; trlag: $this->db->where("\164\x69\x6d\x65\x20\76", time() - $this->config->item("\154\157\x63\x6b\x6f\165\164\x5f\x74\x69\155\145", "\x69\157\156\137\141\165\164\150"), FALSE); goto GSFx0; QrRHr: if (!$this->config->item("\164\162\x61\x63\x6b\137\x6c\x6f\147\x69\156\x5f\x69\x70\137\x61\x64\x64\x72\145\x73\163", "\x69\x6f\x6e\137\141\x75\164\x68")) { goto Ku8cC; } goto llTwV; vfL57: $this->db->where("\151\160\137\x61\x64\x64\x72\x65\163\x73", $ip_address); goto F3KUz; V715n: if (!$this->config->item("\164\162\x61\143\153\137\x6c\157\147\x69\x6e\137\141\164\x74\145\155\160\x74\x73", "\x69\x6f\x6e\137\x61\165\x74\150")) { goto fap_R; } goto uTs1d; wr4EC: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto QrRHr; uTs1d: $this->db->select("\x31", FALSE); goto wr4EC; GSFx0: $qres = $this->db->get($this->tables["\x6c\157\x67\151\x6e\137\141\x74\164\x65\x6d\160\164\163"]); goto cqCM_; rRVOQ: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto z5iE9; Yb7JO: $this->db->where("\x69\160\x5f\141\144\x64\162\145\x73\x73", $ip_address); goto O5MbL; Egt60: if (!$this->config->item("\164\x72\x61\143\x6b\137\x6c\x6f\x67\x69\x6e\x5f\151\160\x5f\x61\144\144\x72\145\163\x73", "\151\157\x6e\x5f\141\x75\164\x68")) { goto GnGRE; } goto TZTtk; Y95B0: return $qres->row()->time; goto l_4D4; EsmnY: if (!($qres->num_rows() > 0)) { goto Biy8n; } goto Y95B0; JCIoE: $this->db->where("\x6c\157\x67\151\156", $identity); goto Egt60; X33U_: return 0; goto QuZnw; xsEdU: $qres = $this->db->get($this->tables["\154\x6f\147\x69\x6e\137\141\x74\x74\x65\x6d\160\164\163"], 1); goto EsmnY; l_4D4: Biy8n: goto kKZn3; HTUhk: $this->db->select("\164\151\155\145"); goto JCIoE; cnWIc: $ip_address = $this->input->ip_address(); goto voR8s; z5iE9: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\x6c\157\x67\x69\x6e\137\141\164\x74\145\x6d\160\x74\x73", "\x69\x6f\x6e\137\141\x75\164\x68")) { goto ABYJQ; } goto HTUhk; O5MbL: GnGRE: goto kqVbd; voR8s: jyKWa: goto Yb7JO; kKZn3: ABYJQ: goto X33U_; kqVbd: $this->db->order_by("\151\144", "\x64\145\163\x63"); goto xsEdU; TZTtk: if (isset($ip_address)) { goto jyKWa; } goto cnWIc; QuZnw: } public function get_last_attempt_ip($identity) { goto LqTDW; gr4P9: $qres = $this->db->get($this->tables["\154\x6f\x67\x69\x6e\x5f\141\x74\x74\x65\155\x70\x74\163"], 1); goto zJ0S7; L7zPv: zjuPa: goto xT2Nm; GYGWV: $this->db->select("\x69\160\137\141\x64\144\x72\145\163\163"); goto fnpcp; xT2Nm: return ''; goto tEE85; LqTDW: if (!($this->config->item("\x74\162\141\143\153\x5f\154\157\x67\x69\156\137\x61\164\x74\x65\x6d\x70\x74\163", "\x69\x6f\x6e\x5f\x61\x75\164\150") && $this->config->item("\164\x72\141\143\153\x5f\x6c\157\147\151\156\137\x69\160\x5f\141\144\144\162\x65\163\163", "\151\157\156\137\141\165\164\x68"))) { goto zjuPa; } goto GYGWV; zJ0S7: if (!($qres->num_rows() > 0)) { goto jG46R; } goto G3kVi; fnpcp: $this->db->where("\154\157\147\x69\156", $identity); goto PI8Gj; PI8Gj: $this->db->order_by("\151\x64", "\x64\145\x73\x63"); goto gr4P9; wgvCe: jG46R: goto L7zPv; G3kVi: return $qres->row()->ip_address; goto wgvCe; tEE85: } public function increase_login_attempts($identity) { goto KjmrS; JOViV: $data["\151\x70\137\141\144\144\162\145\x73\x73"] = $this->input->ip_address(); goto IOdDs; KjmrS: if (!$this->config->item("\164\x72\141\x63\153\x5f\x6c\157\147\x69\x6e\x5f\141\164\x74\x65\x6d\x70\164\x73", "\x69\157\156\137\141\x75\164\x68")) { goto qMLg2; } goto F_1jO; F_1jO: $data = ["\x69\x70\137\141\144\144\x72\145\x73\x73" => '', "\x6c\157\147\x69\156" => $identity, "\x74\x69\155\145" => time()]; goto ESj3w; S8K2g: return FALSE; goto WJSxD; ESj3w: if (!$this->config->item("\164\162\x61\x63\x6b\137\x6c\x6f\147\x69\x6e\137\x69\160\137\x61\x64\144\x72\145\163\x73", "\151\157\x6e\137\x61\x75\164\x68")) { goto Giwcj; } goto JOViV; IOdDs: Giwcj: goto vAZUB; vAZUB: return $this->db->insert($this->tables["\154\x6f\x67\151\156\x5f\141\164\x74\x65\155\160\164\163"], $data); goto n8izb; n8izb: qMLg2: goto S8K2g; WJSxD: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto PymZ2; z8nEz: if (!$this->config->item("\164\x72\141\143\153\x5f\x6c\157\147\151\156\137\x69\x70\x5f\141\x64\144\162\x65\x73\163", "\151\x6f\156\x5f\x61\x75\164\150")) { goto D9jdI; } goto Y1ECc; sunHq: $this->db->where("\151\x70\x5f\141\x64\x64\x72\x65\x73\163", $ip_address); goto iT12q; qOvuW: FygiW: goto vK8Ne; Y1ECc: if (isset($ip_address)) { goto negM6; } goto U9X3_; vK8Ne: return FALSE; goto Ii3Sr; U9X3_: $ip_address = $this->input->ip_address(); goto xUex9; MA8KN: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\x63\153\157\165\x74\137\x74\151\x6d\x65", "\x69\x6f\x6e\137\x61\x75\x74\150")); goto MclpG; DvjYe: $this->db->or_where("\x74\151\155\x65\40\x3c", time() - $old_attempts_expire_period, FALSE); goto YLi6A; MclpG: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto z8nEz; PymZ2: if (!$this->config->item("\x74\x72\x61\143\x6b\x5f\154\x6f\147\x69\156\137\141\164\x74\x65\x6d\160\164\x73", "\x69\x6f\156\x5f\141\x75\164\x68")) { goto FygiW; } goto MA8KN; iT12q: D9jdI: goto DvjYe; xUex9: negM6: goto sunHq; YLi6A: return $this->db->delete($this->tables["\154\x6f\147\151\x6e\137\141\164\x74\145\x6d\x70\x74\163"]); goto qOvuW; Ii3Sr: } public function limit($limit) { goto cf6wB; DFmmJ: return $this; goto T0vT6; y8zZ9: $this->_ion_limit = $limit; goto DFmmJ; cf6wB: $this->trigger_events("\154\151\x6d\x69\x74"); goto y8zZ9; T0vT6: } public function offset($offset) { goto FqJ9R; T46Xq: return $this; goto cMF4Q; EdEWS: $this->_ion_offset = $offset; goto T46Xq; FqJ9R: $this->trigger_events("\x6f\x66\146\x73\x65\164"); goto EdEWS; cMF4Q: } public function where($where, $value = NULL) { goto GLRQb; GLRQb: $this->trigger_events("\167\150\145\x72\145"); goto faq2v; zvj0z: array_push($this->_ion_where, $where); goto RO1Q6; RO1Q6: return $this; goto AHEbY; OLTze: $where = [$where => $value]; goto EeXZL; EeXZL: KL3D9: goto zvj0z; faq2v: if (is_array($where)) { goto KL3D9; } goto OLTze; AHEbY: } public function like($like, $value = NULL, $position = "\x62\157\164\150") { goto c5Gn1; WUJDd: array_push($this->_ion_like, ["\154\151\x6b\x65" => $like, "\166\x61\154\165\145" => $value, "\x70\x6f\x73\151\164\x69\157\x6e" => $position]); goto vsyi1; vsyi1: return $this; goto UTDYU; c5Gn1: $this->trigger_events("\154\x69\x6b\145"); goto WUJDd; UTDYU: } public function select($select) { goto PJkMS; JYVBe: $this->_ion_select[] = $select; goto Uf3Sh; PJkMS: $this->trigger_events("\163\x65\154\x65\x63\164"); goto JYVBe; Uf3Sh: return $this; goto ox3w8; ox3w8: } public function order_by($by, $order = "\x64\145\163\143") { goto gOcyB; vPcTi: $this->_ion_order_by = $by; goto Mb2ZG; cg8rY: return $this; goto vQfhX; Mb2ZG: $this->_ion_order = $order; goto cg8rY; gOcyB: $this->trigger_events("\157\x72\x64\145\x72\137\x62\x79"); goto vPcTi; vQfhX: } public function row() { goto qktca; qktca: $this->trigger_events("\162\x6f\167"); goto jaVaN; ymgsC: return $row; goto LKOGm; jaVaN: $row = $this->response->row(); goto ymgsC; LKOGm: } public function row_array() { goto zUknE; fiR0C: return $row; goto I_tZE; zUknE: $this->trigger_events(["\162\x6f\167", "\x72\157\167\x5f\x61\x72\x72\141\x79"]); goto tBLaE; tBLaE: $row = $this->response->row_array(); goto fiR0C; I_tZE: } public function result() { goto Mq3k9; Mq3k9: $this->trigger_events("\x72\x65\163\x75\154\x74"); goto ZEx1j; ZEx1j: $result = $this->response->result(); goto SLjP0; SLjP0: return $result; goto hmMRT; hmMRT: } public function result_array() { goto q1zmg; zVlrg: return $result; goto e7EVK; zH4kl: $result = $this->response->result_array(); goto zVlrg; q1zmg: $this->trigger_events(["\162\x65\x73\x75\x6c\x74", "\162\x65\163\165\154\164\137\141\162\x72\141\x79"]); goto zH4kl; e7EVK: } public function num_rows() { goto gWd5Z; gWd5Z: $this->trigger_events(["\156\x75\155\137\162\157\167\x73"]); goto IaLaZ; ou2U4: return $result; goto VA3dT; IaLaZ: $result = $this->response->num_rows(); goto ou2U4; VA3dT: } public function users($groups = NULL) { goto sfwel; Mmn3k: qCe4A: goto HH53t; Dh3Iy: if (empty($group_ids)) { goto idMXl; } goto ktcad; sVh4m: foreach ($this->_ion_where as $where) { $this->db->where($where); pSR41: } goto shYNh; BHdjc: if (is_array($groups)) { goto di0VJ; } goto k9oBH; cEWDN: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\153\145"], $like["\x76\x61\x6c\165\x65"], $like["\160\x6f\x73\151\164\x69\x6f\156"]); hIw9j: } goto yI1sB; SqZiG: $group_names = []; goto jOSoS; k9oBH: $groups = [$groups]; goto Rdo_Q; feVY6: $this->_ion_order = NULL; goto mmWU0; ORhpj: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto mFoQb; } goto vyIKs; qpuQ5: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto t9_e2; } goto sVh4m; jOSoS: foreach ($groups as $group) { goto Rppjw; cnlmw: CIBwx: goto BEAub; MZ4V1: $group_ids[] = $group; goto tEa2A; xsX30: goto ewVMP; goto KgGk7; tEa2A: ewVMP: goto cnlmw; Rppjw: if (is_numeric($group)) { goto Juv3t; } goto QYYpu; KgGk7: Juv3t: goto MZ4V1; QYYpu: $group_names[] = $group; goto xsX30; BEAub: } goto J0n2E; svCPy: $this->db->where_in($this->tables["\147\162\157\x75\x70\x73"] . "\56\156\141\155\145", $group_names); goto Z3xJ9; SrPaq: $this->response = $this->db->get($this->tables["\165\x73\145\162\x73"]); goto W54RC; bw_r4: $this->_ion_offset = NULL; goto DtzR3; ktcad: $this->db->{$or_where_in}($this->tables["\165\x73\x65\162\163\x5f\147\162\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\x6f\165\x70\163"], $group_ids); goto Bw900; R7g2K: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\137\x77\150\145\162\x65\137\x69\x6e" : "\167\x68\x65\x72\145\137\x69\x6e"; goto Z7pvT; Rdo_Q: di0VJ: goto KjdsN; sfwel: $this->trigger_events("\165\163\145\162\163"); goto ORhpj; hyb9M: V9G0X: goto X8qH3; mmWU0: $this->_ion_order_by = NULL; goto IcSY2; ot1d8: $this->_ion_where = []; goto LpNai; LpNai: t9_e2: goto rN0pY; IcSY2: kssPA: goto SrPaq; dmzqN: goto vDX9H; goto hyb9M; Z3xJ9: iLU00: goto Dh3Iy; z1SO4: if (!isset($groups)) { goto tfMdU; } goto BHdjc; n8e2O: $this->_ion_like = []; goto Mmn3k; vyIKs: $this->db->select([$this->tables["\x75\x73\x65\x72\163"] . "\56\x2a", $this->tables["\x75\163\x65\162\x73"] . "\56\151\x64\x20\141\163\x20\x69\144", $this->tables["\165\163\x65\x72\x73"] . "\x2e\151\x64\x20\x61\x73\40\x75\163\145\162\137\x69\144"]); goto bjI1g; ZOqbc: $this->db->join($this->tables["\165\x73\145\x72\x73\137\147\162\x6f\165\160\163"], $this->tables["\165\x73\x65\x72\163\x5f\x67\162\x6f\x75\x70\x73"] . "\x2e" . $this->join["\165\x73\145\162\163"] . "\75" . $this->tables["\x75\163\x65\162\163"] . "\x2e\151\144", "\151\156\156\x65\x72"); goto eDrhn; Z7pvT: if (empty($group_names)) { goto iLU00; } goto iPyBv; HH53t: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto V9G0X; } goto A7EGF; KBipH: $this->_ion_limit = NULL; goto g7iDF; iPyBv: $this->db->join($this->tables["\x67\162\x6f\165\160\163"], $this->tables["\165\163\x65\x72\163\137\147\x72\x6f\165\x70\163"] . "\56" . $this->join["\147\162\157\165\160\x73"] . "\40\x3d\x20" . $this->tables["\x67\x72\x6f\165\x70\x73"] . "\56\x69\144", "\x69\156\156\145\162"); goto svCPy; DtzR3: vDX9H: goto KMeEg; rJAl8: $this->trigger_events("\x65\170\164\162\x61\137\x77\x68\x65\162\x65"); goto qpuQ5; dVhL9: foreach ($this->_ion_select as $select) { $this->db->select($select); yUyn5: } goto hrjZK; X8qH3: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto Jgp_B; yI1sB: rmFhB: goto n8e2O; KMeEg: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto kssPA; } goto o25nI; bjI1g: goto YZkGC; goto AcQvd; GqGEL: $this->_ion_select = []; goto D9S0d; A7EGF: if (!isset($this->_ion_limit)) { goto EUtYx; } goto FhzJ0; W54RC: return $this; goto wPqcF; ulGga: $group_ids = []; goto SqZiG; FhzJ0: $this->db->limit($this->_ion_limit); goto KBipH; g7iDF: EUtYx: goto dmzqN; j0q1m: tfMdU: goto rJAl8; Jgp_B: $this->_ion_limit = NULL; goto bw_r4; rN0pY: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto qCe4A; } goto cEWDN; KjdsN: if (!(isset($groups) && !empty($groups))) { goto ccopp; } goto K9KdJ; Bw900: idMXl: goto j0q1m; D9S0d: YZkGC: goto z1SO4; eDrhn: ccopp: goto ulGga; shYNh: f0Z08: goto ot1d8; AcQvd: mFoQb: goto dVhL9; J0n2E: aTkaT: goto R7g2K; K9KdJ: $this->db->distinct(); goto ZOqbc; hrjZK: PV9tv: goto GqGEL; o25nI: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto feVY6; wPqcF: } public function user($id = NULL) { goto f0oZy; HwR1v: $this->where($this->tables["\165\x73\145\x72\x73"] . "\56\151\144", $id); goto hrgaz; MyMMl: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\145\x72\137\x69\x64"); goto FE4GT; EZQ2y: $this->order_by($this->tables["\x75\x73\145\x72\163"] . "\x2e\151\x64", "\144\145\163\143"); goto HwR1v; hrgaz: $this->users(); goto l5jFc; f0oZy: $this->trigger_events("\x75\163\x65\x72"); goto MyMMl; l5jFc: return $this; goto lH9WG; FE4GT: $this->limit(1); goto EZQ2y; lH9WG: } public function get_users_groups($id = FALSE) { goto SZAG3; zYDh2: $id || ($id = $this->session->userdata("\x75\163\145\x72\137\x69\x64")); goto lRYDO; lRYDO: return $this->db->select($this->tables["\x75\x73\x65\162\x73\137\147\x72\x6f\165\x70\163"] . "\56" . $this->join["\x67\162\157\165\x70\163"] . "\x20\141\163\x20\x69\x64\x2c\40" . $this->tables["\x67\x72\157\x75\160\x73"] . "\x2e\x6e\x61\155\145\54\x20" . $this->tables["\x67\x72\157\x75\x70\163"] . "\x2e\144\145\x73\143\x72\x69\x70\164\x69\x6f\x6e")->where($this->tables["\x75\x73\x65\162\x73\137\147\162\157\165\160\163"] . "\56" . $this->join["\x75\163\145\162\163"], $id)->join($this->tables["\147\x72\157\165\160\163"], $this->tables["\x75\x73\x65\162\x73\137\x67\x72\157\x75\160\163"] . "\56" . $this->join["\147\x72\157\165\x70\x73"] . "\x3d" . $this->tables["\147\x72\x6f\x75\160\163"] . "\x2e\151\x64")->get($this->tables["\165\x73\145\162\163\x5f\147\162\157\165\160\x73"]); goto jYQbm; SZAG3: $this->trigger_events("\147\145\164\137\x75\x73\145\162\x73\137\147\x72\157\165\160"); goto zYDh2; jYQbm: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto nAXkw; azXRX: $users_groups = $this->get_users_groups($id)->result(); goto ehffP; EfDVn: $id || ($id = $this->session->userdata("\x75\x73\x65\x72\x5f\x69\x64")); goto LEGDE; FIM9Q: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; pdxPB: } goto xkGFl; nAXkw: $this->trigger_events("\151\156\137\147\162\157\x75\160"); goto EfDVn; JqB1Z: if (isset($this->_cache_user_in_group[$id])) { goto Zsoje; } goto azXRX; BwY8P: Zsoje: goto A5BaZ; lH9PO: yuoRE: goto JqB1Z; xkGFl: bVhwB: goto fAUoQ; z3bbs: foreach ($check_group as $key => $value) { goto g2Ymn; M0ntv: if (!(in_array($value, $groups) xor $check_all)) { goto Y_XAk; } goto KT60C; f3Grv: lGse0: goto G5lLy; KT60C: return !$check_all; goto mrqFW; g2Ymn: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto M0ntv; mrqFW: Y_XAk: goto f3Grv; G5lLy: } goto P60x7; LzfYg: return $check_all; goto PAQoR; A9UvL: goto Tq3B7; goto BwY8P; C5B2i: $check_group = [$check_group]; goto lH9PO; LEGDE: if (is_array($check_group)) { goto yuoRE; } goto C5B2i; ehffP: $groups_array = []; goto FIM9Q; xUHTa: Tq3B7: goto z3bbs; P60x7: iaShL: goto LzfYg; A5BaZ: $groups_array = $this->_cache_user_in_group[$id]; goto xUHTa; fAUoQ: $this->_cache_user_in_group[$id] = $groups_array; goto A9UvL; PAQoR: } public function add_to_group($group_ids, $user_id = FALSE) { goto TQRGm; jDvGS: if (is_array($group_ids)) { goto sSxbG; } goto PQFq8; wA6qq: qnt1f: goto dUYAc; dUYAc: return $return; goto hS33x; sMfQD: sSxbG: goto nMdQH; TQRGm: $this->trigger_events("\141\144\144\x5f\x74\x6f\x5f\x67\x72\x6f\165\160"); goto KdxVY; PQFq8: $group_ids = [$group_ids]; goto sMfQD; KdxVY: $user_id || ($user_id = $this->session->userdata("\x75\x73\145\x72\x5f\x69\x64")); goto jDvGS; nMdQH: $return = 0; goto B3UoV; B3UoV: foreach ($group_ids as $group_id) { goto TRAAu; Xh3b6: $group_name = $this->_cache_groups[$group_id]; goto wafum; i7rle: T1Xpe: goto WBBcG; SODKA: QcVa4: goto i7rle; wafum: Q1_Yu: goto d77Hs; SXKHw: $return++; goto SODKA; d77Hs: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto SXKHw; TRAAu: if (!$this->db->insert($this->tables["\x75\x73\x65\162\x73\x5f\x67\x72\x6f\x75\x70\163"], [$this->join["\147\162\x6f\165\x70\x73"] => (float) $group_id, $this->join["\x75\163\145\162\163"] => (float) $user_id])) { goto QcVa4; } goto NG0K6; tfFMy: goto Q1_Yu; goto a5tcS; imhkP: $group_name = $group[0]->name; goto RZYnz; NG0K6: if (isset($this->_cache_groups[$group_id])) { goto Q8j1C; } goto K1Yf4; RZYnz: $this->_cache_groups[$group_id] = $group_name; goto tfFMy; a5tcS: Q8j1C: goto Xh3b6; K1Yf4: $group = $this->group($group_id)->result(); goto imhkP; WBBcG: } goto wA6qq; hS33x: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto PPrBG; KCFxg: return $return; goto oSIgg; Y0hIG: if (is_array($group_ids)) { goto jH7mZ; } goto Be9Xx; k9fRU: if (!empty($group_ids)) { goto AnofL; } goto sw3PO; nqh9V: goto GRdS0; goto QnTYF; c7szg: GRdS0: goto KCFxg; mmaD_: return FALSE; goto KYYN4; KYYN4: IS1FK: goto k9fRU; zzoGv: if (!empty($user_id)) { goto IS1FK; } goto mmaD_; eJ2SZ: UWBHn: goto eqKR5; iILa5: foreach ($group_ids as $group_id) { goto w6mzC; w6mzC: $this->db->delete($this->tables["\x75\163\x65\x72\163\x5f\147\162\157\165\160\163"], [$this->join["\147\x72\x6f\165\x70\163"] => (float) $group_id, $this->join["\x75\163\145\162\x73"] => (float) $user_id]); goto up_Ho; MJGkq: unset($this->_cache_user_in_group[$user_id][$group_id]); goto KI7Ap; up_Ho: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto r91Zm; } goto MJGkq; KI7Ap: r91Zm: goto a2Mee; a2Mee: PnIMm: goto RmGC2; RmGC2: } goto eJ2SZ; eqKR5: $return = TRUE; goto c7szg; PPrBG: $this->trigger_events("\x72\145\x6d\x6f\x76\x65\137\146\x72\157\155\137\x67\x72\x6f\165\x70"); goto zzoGv; yS8VP: jH7mZ: goto iILa5; AvU4o: W4D_u: goto nqh9V; sw3PO: if (!($return = $this->db->delete($this->tables["\165\x73\145\162\x73\x5f\x67\x72\157\165\x70\163"], [$this->join["\165\x73\145\x72\x73"] => (float) $user_id]))) { goto W4D_u; } goto DG6sq; DG6sq: $this->_cache_user_in_group[$user_id] = []; goto AvU4o; QnTYF: AnofL: goto Y0hIG; Be9Xx: $group_ids = [$group_ids]; goto yS8VP; oSIgg: } public function groups() { goto l9OH5; rqheC: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto YP9Bm; } goto OyOs4; dG2iJ: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto o1F7p; UM8VO: foreach ($this->_ion_where as $where) { $this->db->where($where); uZh_J: } goto o4NLC; zBqdI: $this->_ion_offset = NULL; goto soDJ7; dGMAG: return $this; goto RLzJl; soDJ7: W3TfF: goto lpQ4f; wPLNm: B3DDc: goto rqheC; OTfV2: DjqnH: goto zjNm2; o1F7p: rSQca: goto rcJl0; zjNm2: goto W3TfF; goto e2rHX; SHiqv: $this->_ion_limit = NULL; goto OTfV2; lpQ4f: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto rSQca; } goto dG2iJ; edlxA: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto kwJhO; e2rHX: YP9Bm: goto edlxA; dNP14: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto B3DDc; } goto UM8VO; o4NLC: hCMmR: goto pJhtK; l9OH5: $this->trigger_events("\x67\x72\157\165\x70\x73"); goto dNP14; pJhtK: $this->_ion_where = []; goto wPLNm; kG0je: $this->db->limit($this->_ion_limit); goto SHiqv; kwJhO: $this->_ion_limit = NULL; goto zBqdI; OyOs4: if (!isset($this->_ion_limit)) { goto DjqnH; } goto kG0je; rcJl0: $this->response = $this->db->get($this->tables["\x67\162\x6f\x75\160\163"]); goto dGMAG; RLzJl: } public function group($id = NULL) { goto EglLu; fz1S7: if (!isset($id)) { goto iqhTk; } goto gXtUf; gXtUf: $this->where($this->tables["\147\x72\x6f\x75\x70\x73"] . "\x2e\x69\144", $id); goto uVKsW; hqAbi: return $this->groups(); goto FH0n2; Zm7S8: $this->order_by("\151\x64", "\x64\x65\x73\143"); goto hqAbi; q3F9E: $this->limit(1); goto Zm7S8; EglLu: $this->trigger_events("\x67\x72\157\165\160"); goto fz1S7; uVKsW: iqhTk: goto q3F9E; FH0n2: } public function update($id, array $data) { goto wq8Sr; fnHUV: return FALSE; goto tJ6Zv; tJ6Zv: hm2uY: goto n1WoM; wq8Sr: $this->trigger_events("\160\162\145\137\x75\160\x64\x61\x74\145\x5f\165\x73\x65\x72"); goto zRGIz; XLIQT: $this->set_error("\x75\x70\144\x61\164\145\x5f\x75\156\x73\x75\143\143\x65\163\163\x66\165\154"); goto fnHUV; bxqNE: return FALSE; goto rbuGR; gJit7: wPcTy: goto LZ0Qd; ao2Oj: $this->set_error("\165\160\144\141\x74\145\x5f\165\156\x73\165\143\143\145\x73\x73\146\165\x6c"); goto UvmG1; JTBU0: $this->trigger_events(["\160\x6f\163\164\137\x75\x70\x64\x61\164\x65\x5f\x75\163\x65\x72", "\x70\x6f\x73\164\137\x75\160\x64\x61\x74\x65\x5f\x75\x73\145\x72\x5f\x73\165\x63\x63\x65\x73\163\x66\x75\154"]); goto N_0Mx; UvmG1: return FALSE; goto du5BD; DwwCi: prh5Q: goto AMBbS; N_0Mx: $this->set_message("\165\x70\144\141\164\x65\137\163\165\143\143\145\163\x73\x66\x75\154"); goto rABQ3; YyjZy: $this->trigger_events(["\x70\157\x73\164\137\165\x70\144\141\164\145\x5f\165\x73\x65\162", "\x70\157\163\x74\x5f\165\160\x64\141\164\x65\137\x75\x73\145\x72\x5f\x75\x6e\x73\x75\143\x63\145\x73\x73\146\x75\x6c"]); goto ehB6h; XgP5b: $this->set_error("\x61\x63\143\157\165\x6e\164\137\143\x72\145\x61\x74\x69\157\156\x5f\x64\165\160\154\151\143\x61\164\145\137\x69\144\x65\156\x74\x69\x74\x79"); goto LHfOs; fAYUq: $this->db->trans_commit(); goto JTBU0; ehB6h: $this->set_error("\x75\160\x64\x61\164\x65\x5f\165\x6e\x73\165\143\x63\x65\x73\163\x66\x75\154"); goto bxqNE; CR9Du: $this->db->trans_rollback(); goto XgP5b; mkXaC: leedR: goto kWj2i; Tvp89: $this->db->trans_rollback(); goto YyjZy; LZ0Qd: $data["\160\141\163\x73\167\157\162\x64"] = $this->hash_password($data["\160\x61\x73\163\167\157\162\x64"], $user->{$this->identity_column}); goto hISWh; kWj2i: $this->trigger_events("\x65\x78\x74\x72\x61\137\x77\x68\145\x72\145"); goto IXdmS; hISWh: if (!($data["\x70\141\x73\163\167\157\x72\144"] === FALSE)) { goto ZadRp; } goto nEYwB; flLij: if (!empty($data["\x70\141\163\163\x77\157\x72\x64"])) { goto wPcTy; } goto Wl6hU; nEYwB: $this->db->trans_rollback(); goto bhm0W; ORAnd: $this->db->trans_begin(); goto QaZLr; yp2BB: goto prh5Q; goto gJit7; AMBbS: XvPXB: goto mkXaC; IXdmS: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, ["\151\144" => $user->id]); goto WP_W7; rABQ3: return TRUE; goto xJaeY; n1WoM: $data = $this->_filter_data($this->tables["\x75\x73\145\162\163"], $data); goto nWYof; bhm0W: $this->trigger_events(["\160\x6f\x73\x74\x5f\x75\160\144\141\x74\x65\137\165\163\145\162", "\160\x6f\x73\x74\x5f\x75\x70\144\x61\164\x65\137\165\x73\145\x72\x5f\x75\x6e\163\x75\x63\143\x65\163\x73\x66\x75\154"]); goto ao2Oj; WP_W7: if (!($this->db->trans_status() === FALSE)) { goto lY9qR; } goto Tvp89; nWYof: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\141\163\x73\x77\x6f\x72\x64", $data) || array_key_exists("\145\x6d\x61\x69\154", $data))) { goto leedR; } goto TXFBG; Wl6hU: unset($data["\160\141\x73\x73\167\157\x72\144"]); goto yp2BB; LHfOs: $this->trigger_events(["\160\157\163\164\137\165\x70\144\141\x74\145\137\x75\163\145\x72", "\160\x6f\163\x74\x5f\165\160\x64\x61\x74\x65\137\165\163\x65\x72\x5f\x75\156\x73\x75\143\143\x65\x73\x73\x66\165\154"]); goto XLIQT; QaZLr: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto hm2uY; } goto CR9Du; du5BD: ZadRp: goto DwwCi; rbuGR: lY9qR: goto fAYUq; zRGIz: $user = $this->user($id)->row(); goto ORAnd; TXFBG: if (!array_key_exists("\x70\141\163\163\x77\x6f\x72\144", $data)) { goto XvPXB; } goto flLij; xJaeY: } public function delete_user($id) { goto U0BPk; lwcCT: $this->db->trans_rollback(); goto tDgxO; poEiS: return TRUE; goto yAFBU; tDgxO: $this->trigger_events(["\x70\157\163\164\137\x64\x65\154\x65\164\x65\137\x75\163\x65\x72", "\160\x6f\x73\x74\x5f\x64\145\154\x65\x74\x65\x5f\x75\163\x65\162\137\165\x6e\x73\x75\x63\143\x65\x73\x73\x66\165\154"]); goto kUCUp; Nhbuf: $this->set_message("\144\145\154\x65\164\145\x5f\163\x75\x63\x63\145\x73\x73\x66\165\x6c"); goto poEiS; U2Wmo: $this->remove_from_group(NULL, $id); goto lS7UM; LhEJh: if (!($this->db->trans_status() === FALSE)) { goto V3Ovj; } goto lwcCT; kUCUp: $this->set_error("\x64\x65\154\x65\164\x65\x5f\165\x6e\163\x75\143\x63\x65\x73\163\x66\x75\154"); goto kKkEs; lXEKV: $this->trigger_events(["\160\x6f\x73\x74\x5f\144\145\x6c\145\x74\x65\x5f\x75\163\145\x72", "\x70\157\x73\164\x5f\x64\145\154\x65\164\x65\x5f\x75\x73\x65\162\x5f\x73\x75\x63\x63\x65\163\163\146\x75\x6c"]); goto Nhbuf; vgYkQ: $this->db->trans_commit(); goto lXEKV; kKkEs: return FALSE; goto D2rsC; U0BPk: $this->trigger_events("\160\162\x65\x5f\144\145\x6c\145\164\x65\x5f\165\163\145\x72"); goto RYv_F; RYv_F: $this->db->trans_begin(); goto U2Wmo; lS7UM: $this->db->delete($this->tables["\x75\163\145\162\163"], ["\x69\144" => $id]); goto LhEJh; D2rsC: V3Ovj: goto vgYkQ; yAFBU: } public function update_last_login($id) { goto ATNft; ATNft: $this->trigger_events("\165\160\x64\141\164\x65\137\x6c\141\163\x74\137\154\x6f\x67\x69\x6e"); goto QeH8x; QeH8x: $this->load->helper("\144\141\164\x65"); goto RU1RY; x168j: $this->db->update($this->tables["\165\163\145\162\163"], ["\154\141\163\164\x5f\154\157\x67\151\x6e" => time()], ["\151\144" => $id]); goto B1rFF; B1rFF: return $this->db->affected_rows() == 1; goto HCSCu; RU1RY: $this->trigger_events("\145\x78\x74\x72\141\137\167\150\145\162\x65"); goto x168j; HCSCu: } public function set_lang($lang = "\x65\156") { goto tCDw0; tCDw0: $this->trigger_events("\163\145\164\137\x6c\x61\x6e\x67"); goto zWGDe; ON595: KaX7O: goto DE56P; zWGDe: if ($this->config->item("\165\x73\x65\x72\137\145\x78\x70\x69\x72\x65", "\151\157\x6e\x5f\x61\165\x74\150") === 0) { goto KaX7O; } goto LSsVA; DE56P: $expire = self::MAX_COOKIE_LIFETIME; goto RbShb; RbShb: rEIg4: goto fIp_j; fIp_j: set_cookie(["\156\x61\x6d\x65" => "\x6c\141\156\147\137\x63\x6f\x64\x65", "\x76\x61\x6c\x75\x65" => $lang, "\x65\x78\x70\151\162\x65" => $expire]); goto Dsa_O; LSsVA: $expire = $this->config->item("\x75\x73\145\x72\137\x65\170\160\151\x72\x65", "\x69\x6f\156\137\x61\x75\x74\150"); goto Ywndy; Ywndy: goto rEIg4; goto ON595; Dsa_O: return TRUE; goto T6pqT; T6pqT: } public function set_session($user) { goto H8v8e; RWHkv: $this->trigger_events("\160\x6f\x73\164\137\163\145\164\137\x73\x65\163\x73\x69\157\x6e"); goto OexYJ; vdfZG: $session_data = ["\x69\144\x65\156\x74\151\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\x6d\141\x69\154" => $user->email, "\165\163\145\x72\x5f\x69\x64" => $user->id, "\x6f\154\144\137\x6c\141\163\x74\x5f\x6c\157\x67\151\156" => $user->last_login, "\154\x61\x73\164\x5f\x63\150\145\x63\153" => time()]; goto Y1P7z; Y1P7z: $this->session->set_userdata($session_data); goto RWHkv; H8v8e: $this->trigger_events("\x70\x72\145\137\163\x65\x74\x5f\x73\x65\x73\163\x69\x6f\x6e"); goto vdfZG; OexYJ: return TRUE; goto sDG5B; sDG5B: } public function remember_user($identity) { goto ggHvm; vUJDw: $this->trigger_events(["\160\157\x73\164\137\162\145\155\145\155\x62\145\x72\137\x75\163\x65\162", "\162\x65\155\145\x6d\142\x65\162\x5f\165\163\145\162\x5f\x73\165\143\x63\x65\x73\163\146\165\x6c"]); goto G_HEN; RfIcF: $this->db->update($this->tables["\165\163\x65\162\163"], ["\162\x65\155\x65\x6d\x62\145\162\137\163\145\x6c\145\x63\x74\x6f\162" => $token->selector, "\162\145\155\x65\155\142\x65\162\x5f\143\x6f\144\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto Av9ta; rHvys: $expire = $this->config->item("\165\163\x65\162\x5f\145\170\x70\151\x72\x65", "\151\157\x6e\x5f\x61\x75\x74\150"); goto w8vC1; QOaHG: u6MH6: goto szhJK; FA_21: return FALSE; goto zbgda; p2wWa: $this->trigger_events(["\x70\x6f\163\164\x5f\162\x65\155\145\x6d\142\145\162\x5f\x75\x73\145\162", "\x72\145\x6d\x65\x6d\142\145\162\137\x75\163\x65\x72\137\x75\x6e\x73\165\x63\143\x65\x73\163\x66\x75\x6c"]); goto OO8iP; Av9ta: if (!($this->db->affected_rows() > -1)) { goto pGgBU; } goto jYnpQ; kCn1N: $token = $this->_generate_selector_validator_couple(); goto A5jxi; jYnpQ: if ($this->config->item("\165\163\x65\162\x5f\x65\170\x70\151\x72\x65", "\151\157\156\137\141\165\164\150") === 0) { goto u6MH6; } goto rHvys; w8vC1: goto yonyM; goto QOaHG; XjmKq: if ($identity) { goto jvIJP; } goto FA_21; gJU15: yonyM: goto OQbK4; szhJK: $expire = self::MAX_COOKIE_LIFETIME; goto gJU15; A5jxi: if (!$token->validator_hashed) { goto BtrZE; } goto RfIcF; OQbK4: set_cookie(["\156\141\x6d\x65" => $this->config->item("\162\x65\155\145\x6d\x62\145\162\x5f\143\157\157\x6b\x69\x65\x5f\x6e\x61\x6d\x65", "\x69\x6f\x6e\137\x61\x75\x74\150"), "\166\x61\x6c\x75\x65" => $token->user_code, "\x65\x78\160\x69\162\145" => $expire]); goto vUJDw; dsZ0Z: BtrZE: goto p2wWa; G_HEN: return TRUE; goto EEa3_; EEa3_: pGgBU: goto dsZ0Z; OO8iP: return FALSE; goto Om5Er; ggHvm: $this->trigger_events("\x70\162\145\x5f\x72\x65\155\145\x6d\x62\145\x72\137\165\x73\x65\x72"); goto XjmKq; zbgda: jvIJP: goto kCn1N; Om5Er: } public function login_remembered_user() { goto DzN7D; YmtGe: sQJHG: goto OwnaP; v0SVn: $this->update_last_login($user->id); goto ji57o; fln9D: return TRUE; goto YmtGe; e0pci: $identity = $user->{$this->identity_column}; goto BsebP; UCgq0: $user = $query->row(); goto e0pci; DzN7D: $this->trigger_events("\160\x72\145\137\x6c\157\147\x69\156\x5f\x72\145\155\x65\155\142\x65\162\145\x64\x5f\165\x73\145\x72"); goto c4vix; l7K78: $this->session->sess_regenerate(FALSE); goto AWfnO; Lnc4s: $this->trigger_events("\145\x78\164\162\141\x5f\167\150\145\162\145"); goto p81iD; AWfnO: $this->trigger_events(["\160\x6f\163\164\x5f\154\157\x67\x69\x6e\137\162\x65\155\145\x6d\x62\145\162\145\x64\137\165\x73\145\x72", "\160\157\x73\x74\137\x6c\x6f\x67\151\x6e\x5f\x72\145\155\145\155\142\x65\162\x65\x64\x5f\x75\x73\145\162\x5f\163\165\x63\143\145\163\x73\146\x75\x6c"]); goto fln9D; p81iD: $query = $this->db->select($this->identity_column . "\54\x20\151\x64\54\40\x65\x6d\x61\151\154\x2c\40\162\x65\x6d\x65\155\142\x65\x72\x5f\x63\157\x64\x65\x2c\x20\154\x61\x73\164\137\x6c\x6f\x67\151\x6e")->where("\x72\145\155\x65\155\x62\145\162\137\163\x65\154\145\x63\164\157\162", $token->selector)->where("\141\x63\164\x69\166\145", 1)->limit(1)->get($this->tables["\165\163\145\x72\x73"]); goto Mrqpl; Ly5Cp: $this->remember_user($identity); goto eSuXn; t3_Er: delete_cookie($this->config->item("\162\145\x6d\145\x6d\142\x65\x72\x5f\143\x6f\x6f\x6b\x69\145\137\x6e\x61\155\145", "\x69\x6f\x6e\x5f\141\165\164\150")); goto dcKMw; WV_vX: if (!($token === FALSE)) { goto YbJMn; } goto pc9bh; ji57o: $this->set_session($user); goto BDqhT; ik7J1: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto WV_vX; b9Hxw: if (!$this->config->item("\x75\x73\x65\162\x5f\145\170\164\x65\x6e\x64\137\x6f\156\137\154\x6f\147\x69\156", "\151\x6f\x6e\x5f\141\165\164\150")) { goto W1Cga; } goto Ly5Cp; Mrqpl: if (!($query->num_rows() === 1)) { goto wlbQ6; } goto UCgq0; NLP67: return FALSE; goto mPr8p; GkEmT: return FALSE; goto F9acg; dcKMw: $this->trigger_events(["\x70\157\163\x74\137\154\157\x67\151\156\x5f\162\x65\x6d\145\x6d\x62\145\162\145\x64\137\x75\x73\145\162", "\x70\157\x73\x74\x5f\154\x6f\147\151\x6e\137\162\145\155\x65\x6d\x62\x65\162\145\x64\137\165\x73\x65\x72\137\x75\156\163\x75\143\x63\x65\x73\163\146\x75\x6c"]); goto GkEmT; BDqhT: $this->clear_forgotten_password_code($identity); goto b9Hxw; pc9bh: $this->trigger_events(["\x70\x6f\163\x74\137\x6c\157\147\151\x6e\x5f\162\x65\155\145\x6d\142\145\162\145\x64\x5f\x75\163\145\162", "\160\x6f\163\x74\137\154\x6f\x67\151\x6e\137\x72\145\155\x65\x6d\142\x65\162\145\x64\x5f\x75\163\145\162\137\165\156\163\x75\143\x63\x65\x73\163\146\165\x6c"]); goto NLP67; c4vix: $remember_cookie = get_cookie($this->config->item("\162\145\155\x65\155\142\145\162\x5f\x63\x6f\157\x6b\151\x65\137\x6e\x61\155\x65", "\x69\157\x6e\x5f\141\165\x74\150")); goto ik7J1; BsebP: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto sQJHG; } goto v0SVn; mPr8p: YbJMn: goto Lnc4s; OwnaP: wlbQ6: goto t3_Er; eSuXn: W1Cga: goto l7K78; F9acg: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto nNUjZ; Bux9T: return FALSE; goto mmdOM; mmdOM: Pkzkf: goto CeCEO; ZBo3n: if (!($existing_group !== 0)) { goto DrzNL; } goto U9akg; WV1zs: $this->set_message("\147\162\x6f\165\x70\137\x63\162\145\141\x74\x69\x6f\x6e\137\x73\x75\x63\143\145\x73\x73\146\x75\x6c"); goto FdsCl; oAuP5: if (empty($additional_data)) { goto MGprM; } goto Y81TC; eBiaN: $group_id = $this->db->insert_id($this->tables["\x67\162\157\x75\160\163"] . "\137\x69\x64\137\x73\x65\161"); goto WV1zs; NGDVh: $data = ["\156\x61\155\x65" => $group_name, "\144\x65\x73\143\x72\x69\160\164\x69\x6f\x6e" => $group_description]; goto oAuP5; c48FQ: $this->trigger_events("\x65\170\x74\162\x61\x5f\147\x72\x6f\165\x70\137\x73\x65\164"); goto P_gR3; nNUjZ: if ($group_name) { goto Pkzkf; } goto JTBHJ; Y81TC: $data = array_merge($this->_filter_data($this->tables["\x67\x72\157\165\160\x73"], $additional_data), $data); goto IwqMS; JTBHJ: $this->set_error("\147\162\157\x75\160\x5f\x6e\x61\155\145\x5f\162\145\x71\x75\151\162\x65\x64"); goto Bux9T; CeCEO: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\165\x70\163"], ["\156\x61\x6d\145" => $group_name])->num_rows(); goto ZBo3n; IwqMS: MGprM: goto c48FQ; FdsCl: return $group_id; goto X49sE; q87z4: DrzNL: goto NGDVh; U9akg: $this->set_error("\x67\x72\157\165\160\137\x61\154\x72\x65\141\144\x79\x5f\145\x78\151\x73\x74\x73"); goto XD_YA; P_gR3: $this->db->insert($this->tables["\x67\162\157\x75\x70\163"], $data); goto eBiaN; XD_YA: return FALSE; goto q87z4; X49sE: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto QbGwx; EJVOJ: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto xMiK6; } goto WWR7K; CM_Ls: $data["\156\x61\155\x65"] = $group_name; goto yIMmc; yIMmc: bGp9Y: goto Zdwe0; Gq_tb: rqvTk: goto KyzdK; RzPzm: xMiK6: goto CM_Ls; D_km4: oAApt: goto Okohs; lK89p: $data = []; goto jQtRV; QbGwx: if (!empty($group_id)) { goto f8Lte; } goto fnGns; FjaBS: return FALSE; goto Gq_tb; WWR7K: $this->set_error("\147\x72\x6f\x75\160\x5f\141\154\162\145\x61\144\171\137\145\x78\151\x73\x74\x73"); goto k2NZo; fnGns: return FALSE; goto TN9_Q; KyzdK: if (empty($additional_data)) { goto oAApt; } goto aTofA; Dgqsz: $this->set_message("\x67\x72\x6f\165\160\137\x75\160\x64\141\x74\145\x5f\x73\165\x63\143\145\163\163\x66\165\x6c"); goto Epa1N; k2NZo: return FALSE; goto RzPzm; Epa1N: return TRUE; goto GxK_L; mzhzb: $existing_group = $this->db->get_where($this->tables["\147\x72\157\165\x70\163"], ["\x6e\141\155\x65" => $group_name])->row(); goto EJVOJ; TN9_Q: f8Lte: goto lK89p; AqhNq: $this->set_error("\x67\x72\157\x75\160\x5f\156\141\155\145\137\141\144\x6d\151\x6e\x5f\x6e\157\x74\x5f\x61\154\x74\x65\x72"); goto FjaBS; Zdwe0: $group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\151\144" => $group_id])->row(); goto V2fZV; Okohs: $this->db->update($this->tables["\x67\162\157\x75\160\x73"], $data, ["\151\x64" => $group_id]); goto Dgqsz; jQtRV: if (empty($group_name)) { goto bGp9Y; } goto mzhzb; aTofA: $data = array_merge($this->_filter_data($this->tables["\147\x72\157\x75\160\163"], $additional_data), $data); goto D_km4; V2fZV: if (!($this->config->item("\x61\144\x6d\151\156\137\x67\162\x6f\x75\160", "\x69\157\x6e\x5f\141\165\x74\150") === $group->name && $group_name !== $group->name)) { goto rqvTk; } goto AqhNq; GxK_L: } public function delete_group($group_id = FALSE) { goto lq6u_; trmDd: $group = $this->group($group_id)->row(); goto numng; LsUva: $this->trigger_events(["\160\x6f\x73\x74\x5f\x64\x65\x6c\145\164\x65\137\147\162\x6f\165\x70", "\x70\x6f\x73\x74\137\x64\145\x6c\145\x74\145\x5f\x67\x72\x6f\x75\160\x5f\165\x6e\x73\x75\x63\x63\145\x73\x73\146\165\154"]); goto H62wy; p6RAg: $this->trigger_events("\x70\162\x65\x5f\x64\x65\154\145\164\x65\137\147\x72\x6f\x75\x70"); goto m765e; ENcPW: $this->set_message("\x67\162\x6f\165\x70\x5f\x64\145\x6c\145\164\145\x5f\x73\165\143\x63\x65\x73\163\x66\165\x6c"); goto c8whs; c8whs: return TRUE; goto MxL2a; fDNMB: $this->db->delete($this->tables["\x75\163\x65\162\x73\x5f\147\x72\157\165\160\x73"], [$this->join["\147\x72\x6f\x75\x70\163"] => $group_id]); goto J3d1P; numng: if (!($group->name == $this->config->item("\x61\x64\x6d\x69\156\x5f\x67\x72\157\165\x70", "\151\157\x6e\137\141\x75\164\x68"))) { goto P3auq; } goto CIOCc; CIOCc: $this->trigger_events(["\x70\x6f\163\x74\137\x64\145\x6c\145\x74\145\137\147\162\x6f\x75\x70", "\160\157\x73\x74\137\x64\145\x6c\145\x74\x65\137\x67\162\157\165\x70\137\x6e\x6f\164\141\x6c\154\x6f\x77\x65\x64"]); goto G1KEh; JSFOg: $this->db->trans_rollback(); goto LsUva; aYzdE: $this->trigger_events(["\160\157\x73\164\137\144\x65\154\x65\164\145\x5f\x67\x72\x6f\165\x70", "\x70\x6f\163\x74\137\144\x65\x6c\145\164\145\x5f\147\162\157\x75\160\x5f\163\165\x63\x63\x65\163\163\146\165\x6c"]); goto ENcPW; H62wy: $this->set_error("\x67\162\x6f\165\160\137\144\145\154\x65\x74\145\137\165\156\163\x75\143\143\x65\x73\163\x66\165\x6c"); goto tLo2A; J3d1P: $this->db->delete($this->tables["\x67\x72\157\x75\x70\x73"], ["\x69\x64" => $group_id]); goto BoEA4; bwejW: P3auq: goto p6RAg; tLo2A: return FALSE; goto fceHS; PdSG1: Xn6rR: goto trmDd; lq6u_: if (!(!$group_id || empty($group_id))) { goto Xn6rR; } goto Thgzr; fceHS: bUzqe: goto R5A7X; G1KEh: $this->set_error("\x67\x72\157\x75\x70\137\x64\145\154\x65\x74\x65\137\156\157\164\141\x6c\x6c\157\167\145\144"); goto zdg3X; R5A7X: $this->db->trans_commit(); goto aYzdE; m765e: $this->db->trans_begin(); goto fDNMB; zdg3X: return FALSE; goto bwejW; Thgzr: return FALSE; goto PdSG1; BoEA4: if (!($this->db->trans_status() === FALSE)) { goto bUzqe; } goto JSFOg; MxL2a: } public function set_hook($event, $name, $class, $method, $arguments) { goto VZ0JK; RY4qy: $this->_ion_hooks->{$event}[$name]->class = $class; goto oA9kw; VZ0JK: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto RY4qy; XJdAB: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto foBXW; oA9kw: $this->_ion_hooks->{$event}[$name]->method = $method; goto XJdAB; foBXW: } public function remove_hook($event, $name) { goto YVV4w; G82FH: O2j6W: goto QM9Zi; pHtfu: unset($this->_ion_hooks->{$event}[$name]); goto G82FH; YVV4w: if (!isset($this->_ion_hooks->{$event}[$name])) { goto O2j6W; } goto pHtfu; QM9Zi: } public function remove_hooks($event) { goto yfCCN; Y5OpT: unset($this->_ion_hooks->{$event}); goto eebxC; eebxC: ejR5x: goto HAjeR; yfCCN: if (!isset($this->_ion_hooks->{$event})) { goto ejR5x; } goto Y5OpT; HAjeR: } protected function _call_hook($event, $name) { goto eeisl; hssHf: irTA1: goto Ugvlh; eeisl: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto irTA1; } goto nfR46; nfR46: $hook = $this->_ion_hooks->{$event}[$name]; goto v1XFk; v1XFk: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto hssHf; Ugvlh: return FALSE; goto j4SOC; j4SOC: } public function trigger_events($events) { goto jluoh; vUer5: f46SE: goto Us3aa; lSB8d: foreach ($events as $event) { $this->trigger_events($event); jhmbC: } goto mknmV; gXYSg: dJE6T: goto k14s0; jluoh: if (is_array($events) && !empty($events)) { goto OF__j; } goto dQvu8; dQvu8: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto qsiKN; } goto wp77d; k14s0: qsiKN: goto S_8jl; S_8jl: goto f46SE; goto Q4LNY; wp77d: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); ipevU: } goto gXYSg; Q4LNY: OF__j: goto lSB8d; mknmV: Mkl6J: goto vUer5; Us3aa: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto migXF; ZJGZB: return TRUE; goto P8Rif; migXF: $this->message_start_delimiter = $start_delimiter; goto lKU5R; lKU5R: $this->message_end_delimiter = $end_delimiter; goto ZJGZB; P8Rif: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto TkSt9; TkSt9: $this->error_start_delimiter = $start_delimiter; goto kcz24; kcz24: $this->error_end_delimiter = $end_delimiter; goto C5gmZ; C5gmZ: return TRUE; goto KZP1_; KZP1_: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto cqsMd; cqsMd: $_output = ''; goto G1q_B; Ij7YM: wnsy1: goto kZ93I; kZ93I: return $_output; goto hALZ5; G1q_B: foreach ($this->messages as $message) { goto Tr7Wz; iVgZX: ROrnu: goto uRRT5; efG1q: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto iVgZX; Tr7Wz: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto efG1q; uRRT5: } goto Ij7YM; hALZ5: } public function messages_array($langify = TRUE) { goto S2x2q; w8trG: ML5pp: goto lw1gv; lw1gv: return $_output; goto DrXDy; S2x2q: if ($langify) { goto KPeOU; } goto bBg33; bBg33: return $this->messages; goto a_5Kd; V6jF4: KPeOU: goto GmYnd; DrXDy: u740i: goto nMCtk; GmYnd: $_output = []; goto su5rm; su5rm: foreach ($this->messages as $message) { goto nO40E; nO40E: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\43\x23"; goto EiAnW; ID1u5: LaDZI: goto rMITK; EiAnW: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto ID1u5; rMITK: } goto w8trG; a_5Kd: goto u740i; goto V6jF4; nMCtk: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto xqKLt; snbzp: return $_output; goto d3EMF; u1KUN: HA8fu: goto snbzp; xqKLt: $_output = ''; goto LDkBi; LDkBi: foreach ($this->errors as $error) { goto AplDe; rO2ib: zbxmU: goto WSNP9; AplDe: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\x23"; goto UWF3e; UWF3e: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto rO2ib; WSNP9: } goto u1KUN; d3EMF: } public function errors_array($langify = TRUE) { goto sAsYH; Yy_Zb: ThBma: goto eRSqA; zqOOp: foreach ($this->errors as $error) { goto acg84; acg84: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\43"; goto Oa3tZ; Oa3tZ: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto wBjJA; wBjJA: ryDr5: goto zr_wU; zr_wU: } goto iEdqL; eRSqA: $_output = []; goto zqOOp; iEdqL: vbl5H: goto IqCSH; KD2GT: goto X4f5r; goto Yy_Zb; e_KVi: return $this->errors; goto KD2GT; sAsYH: if ($langify) { goto ThBma; } goto e_KVi; b4RRs: X4f5r: goto wiP40; IqCSH: return $_output; goto b4RRs; wiP40: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto FciMz; hYv40: if (!($hash === FALSE)) { goto d1qTq; } goto AcRv2; FciMz: $hash = $this->hash_password($password, $identity); goto hYv40; z7XZf: $this->trigger_events("\145\170\164\162\141\137\x77\150\x65\162\145"); goto yc8Lr; b28Rd: d1qTq: goto OjrRs; yc8Lr: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto Y65QW; Y65QW: return $this->db->affected_rows() == 1; goto tFNa1; AcRv2: return FALSE; goto b28Rd; OjrRs: $data = ["\x70\141\x73\163\x77\x6f\x72\x64" => $hash, "\162\145\155\145\155\142\145\162\137\143\157\144\145" => NULL, "\146\x6f\x72\x67\157\164\x74\x65\156\137\160\141\163\x73\167\157\x72\144\x5f\x63\x6f\144\145" => NULL, "\x66\x6f\162\147\157\164\164\145\156\x5f\x70\141\163\163\167\157\162\144\x5f\164\x69\155\x65" => NULL]; goto z7XZf; tFNa1: } protected function _filter_data($table, $data) { goto MCInv; OblIr: if (!is_array($data)) { goto Lm5e3; } goto v6htA; mUodc: $columns = $this->db->list_fields($table); goto OblIr; VQVcy: jHxk8: goto rvxRa; v6htA: foreach ($columns as $column) { goto Vj_8t; S3dcq: $filtered_data[$column] = $data[$column]; goto xp9Re; xp9Re: QImMB: goto IziRh; Vj_8t: if (!array_key_exists($column, $data)) { goto QImMB; } goto S3dcq; IziRh: BDBxt: goto vYZHl; vYZHl: } goto VQVcy; MCInv: $filtered_data = []; goto mUodc; EQb33: return $filtered_data; goto k2FSY; rvxRa: Lm5e3: goto EQb33; k2FSY: } protected function _random_token($result_length = 32) { goto YphuF; lj1LS: CVGDk: goto ocbLu; R_VL6: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto oOc0M; jgRHI: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto HG2EA; BfVlW: return FALSE; goto yxc2q; AKTbz: return bin2hex(random_bytes($result_length / 2)); goto lj1LS; ocbLu: if (!function_exists("\x6d\x63\x72\171\160\164\x5f\143\x72\145\141\x74\145\137\151\x76")) { goto z74vV; } goto R_VL6; dQR2C: if (!function_exists("\157\160\x65\156\163\163\154\x5f\162\141\156\x64\157\155\137\x70\x73\145\x75\x64\x6f\137\142\171\164\145\x73")) { goto CHQY7; } goto jgRHI; TJIir: a6LZd: goto UF3q4; YphuF: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto a6LZd; } goto h0VTI; HG2EA: CHQY7: goto BfVlW; UF3q4: if (!function_exists("\x72\x61\x6e\x64\157\x6d\x5f\x62\x79\164\x65\163")) { goto CVGDk; } goto AKTbz; oOc0M: z74vV: goto dQR2C; h0VTI: $result_length = 32; goto TJIir; yxc2q: } protected function _get_hash_parameters($identity = NULL) { goto JETE2; Grx7l: cyJSI: goto mZ6el; JETE2: $is_admin = FALSE; goto fr108; s262M: $is_admin = TRUE; goto I8FA3; I8FA3: W5y2A: goto Grx7l; Cbu18: $user_id = $this->get_user_id_from_identity($identity); goto ELgiU; pjNXy: return $params; goto HOi_8; ELgiU: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\x69\x6e\x5f\x67\x72\157\165\x70", "\x69\157\x6e\x5f\x61\x75\x74\150"), $user_id))) { goto W5y2A; } goto s262M; yzMV2: switch ($this->hash_method) { case "\142\143\162\x79\160\x74": $params = ["\143\x6f\x73\164" => $is_admin ? $this->config->item("\142\x63\162\171\160\164\x5f\141\144\155\151\x6e\x5f\x63\x6f\163\x74", "\151\157\156\137\141\165\164\150") : $this->config->item("\x62\x63\x72\171\x70\x74\x5f\144\145\x66\141\165\154\x74\137\143\x6f\163\x74", "\x69\x6f\x6e\x5f\x61\x75\x74\x68")]; goto ZzCXt; case "\141\162\x67\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\162\x67\x6f\156\x32\x5f\x61\x64\x6d\151\x6e\137\160\x61\x72\141\x6d\x73", "\151\157\x6e\137\141\165\x74\150") : $this->config->item("\x61\162\x67\157\x6e\x32\137\144\145\x66\141\x75\154\x74\137\160\x61\x72\141\155\x73", "\x69\157\156\x5f\x61\x75\164\x68"); goto ZzCXt; default: } goto kFovG; kFovG: B2Ed3: goto qfzc0; mZ6el: $params = FALSE; goto yzMV2; fr108: if (!$identity) { goto cyJSI; } goto Cbu18; qfzc0: ZzCXt: goto pjNXy; HOi_8: } protected function _get_hash_algo() { goto WT3ST; UjScX: switch ($this->hash_method) { case "\x62\x63\162\171\x70\164": $algo = PASSWORD_BCRYPT; goto n4L2m; case "\x61\162\x67\157\156\x32": $algo = PASSWORD_ARGON2I; goto n4L2m; default: } goto a64T3; a64T3: iMiWf: goto Xi_eL; Xi_eL: n4L2m: goto s51pw; WT3ST: $algo = FALSE; goto UjScX; s51pw: return $algo; goto Ap004; Ap004: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto JBcM9; oRrpT: $validator_hashed = $this->hash_password($validator); goto GTk3R; GTk3R: $user_code = "{$selector}\x2e{$validator}"; goto MApX9; JBcM9: $selector = $this->_random_token($selector_size); goto rVhn3; MApX9: return (object) ["\163\x65\154\145\x63\x74\x6f\x72" => $selector, "\x76\141\x6c\151\144\141\164\x6f\x72\137\x68\x61\163\150\x65\144" => $validator_hashed, "\x75\163\x65\x72\x5f\143\x6f\144\x65" => $user_code]; goto UcdwV; rVhn3: $validator = $this->_random_token($validator_size); goto oRrpT; UcdwV: } protected function _retrieve_selector_validator_couple($user_code) { goto O5nbT; Xmw_E: if (!(count($tokens) === 2)) { goto wh1YT; } goto y119X; nN0wC: wh1YT: goto vRwvF; O979D: return FALSE; goto FSNYN; y119X: return (object) ["\x73\145\154\145\143\x74\x6f\162" => $tokens[0], "\166\141\x6c\x69\x64\141\x74\x6f\162" => $tokens[1]]; goto nN0wC; qbqPk: $tokens = explode("\56", $user_code); goto Xmw_E; O5nbT: if (!$user_code) { goto SmSi2; } goto qbqPk; vRwvF: SmSi2: goto O979D; FSNYN: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto LHFN0; e2Al3: NaJTv: goto Rssou; aC0WX: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\x68\x61\x31\x5f\x70\x61\x73\163\167\x6f\x72\144\137\x6d\151\147\162\x61\x74\151\x6f\x6e", "\160\157\163\164\x5f\163\150\x61\x31\137\160\141\x73\163\x77\x6f\162\x64\137\155\151\147\162\x61\x74\151\x6f\x6e\137\x75\x6e\x73\x75\x63\143\145\x73\x73\146\x75\154"]); goto iRLku; kECjj: return FALSE; goto C_E5P; p93wj: if ($hashed_password === $hashed_password_db) { goto AsvEz; } goto aC0WX; x64KP: $salt_db = $query->row(); goto RHWUi; uSwVz: return FALSE; goto w9UXe; ossI4: if ($salt_length) { goto vwcke; } goto BP1sR; crq5Z: goto Z0j3b; goto bNONW; bGx24: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto fHgK0; Xdhvd: goto NaJTv; goto uBR7B; nzEeM: if ($this->config->item("\163\164\157\x72\145\x5f\163\141\154\164", "\x69\157\156\137\x61\165\x74\x68")) { goto WU_Bk; } goto LPC9f; i6Ydn: cq9RU: goto p93wj; mBya6: $salt = substr($hashed_password_db, 0, $salt_length); goto bGx24; TvaCO: $result = $this->_set_password_db($identity, $password); goto GkztW; BP1sR: $this->trigger_events(["\x70\157\x73\x74\137\x73\150\141\x31\137\160\141\163\x73\167\157\162\144\137\155\x69\147\x72\x61\x74\x69\157\156", "\160\x6f\163\164\137\163\150\141\61\x5f\160\141\163\163\x77\157\162\144\137\x6d\151\x67\x72\x61\164\151\x6f\156\x5f\165\156\x73\x75\143\x63\145\163\x73\146\x75\x6c"]); goto uSwVz; LHFN0: $this->trigger_events("\x70\x72\x65\x5f\163\150\x61\x31\137\160\x61\x73\x73\x77\x6f\x72\x64\x5f\x6d\151\x67\162\141\x74\x69\157\156"); goto nzEeM; blVPu: WU_Bk: goto rctu_; w9UXe: vwcke: goto mBya6; bNONW: AsvEz: goto TvaCO; iRLku: return FALSE; goto crq5Z; C_E5P: LPqId: goto SUpNg; TwZYL: Z0j3b: goto py_7F; GkztW: if ($result) { goto G7hmP; } goto FWo8h; LPC9f: $salt_length = $this->config->item("\x73\141\154\164\x5f\154\x65\156\147\x74\150", "\x69\157\156\137\141\165\x74\x68"); goto ossI4; uBR7B: G7hmP: goto fIM1o; rctu_: $query = $this->db->select("\x73\141\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\x72\x73"]); goto x64KP; SUpNg: $hashed_password = sha1($password . $salt_db->salt); goto i6Ydn; RHWUi: if (!($query->num_rows() !== 1)) { goto LPqId; } goto vJqip; vJqip: $this->trigger_events(["\x70\157\163\x74\x5f\163\150\x61\61\137\x70\x61\163\163\x77\x6f\x72\144\x5f\x6d\151\x67\162\141\164\x69\x6f\156", "\x70\x6f\163\x74\137\163\150\141\x31\137\x70\141\x73\163\x77\157\x72\144\137\x6d\151\147\162\141\x74\x69\x6f\x6e\137\165\x6e\163\165\143\x63\145\163\x73\x66\165\x6c"]); goto kECjj; fHgK0: goto cq9RU; goto blVPu; fIM1o: $this->trigger_events(["\x70\x6f\163\164\x5f\163\x68\141\61\x5f\x70\141\x73\163\167\157\162\x64\x5f\x6d\151\x67\x72\141\164\x69\x6f\x6e", "\160\x6f\163\x74\x5f\x73\150\x61\61\137\x70\141\x73\163\x77\x6f\162\x64\137\155\151\x67\x72\x61\x74\x69\x6f\x6e\x5f\163\x75\143\143\145\x73\163\146\165\x6c"]); goto e2Al3; Rssou: return $result; goto TwZYL; FWo8h: $this->trigger_events(["\160\157\x73\x74\137\163\x68\141\x31\137\x70\x61\163\163\x77\x6f\x72\x64\x5f\x6d\x69\147\x72\141\x74\x69\157\156", "\x70\157\x73\164\x5f\163\150\141\x31\x5f\x70\x61\x73\x73\x77\157\162\x64\137\155\151\x67\x72\141\164\151\157\x6e\x5f\x75\156\163\165\143\143\x65\163\163\x66\x75\154"]); goto Xdhvd; py_7F: } }
