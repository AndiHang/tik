<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\105\120\101\124\x48") or exit("\116\x6f\40\x64\151\x72\145\143\164\x20\x73\x63\x72\151\x70\164\40\141\x63\143\x65\x73\x73\x20\x61\154\x6c\157\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto yyWz4; ZfS20: if ($delimiters_source === "\146\157\162\x6d\137\166\x61\x6c\x69\144\x61\164\x69\157\x6e") { goto qRcxq; } goto Qg7Mp; UN3c0: qRcxq: goto hl1PF; PPZsN: $this->error_end_delimiter = $this->config->item("\145\x72\162\157\x72\137\x65\156\x64\x5f\144\145\x6c\x69\x6d\x69\164\x65\x72", "\x69\157\x6e\137\141\165\x74\150"); goto HQRFc; AYj1T: $error_prefix = $form_validation_class->getProperty("\137\x65\x72\162\x6f\162\x5f\x70\162\145\146\x69\170"); goto jF5Ld; EekYM: $this->_ion_hooks = new stdClass(); goto TUA76; yBWXv: $form_validation_class = new ReflectionClass("\103\x49\137\x46\x6f\162\x6d\x5f\166\x61\154\151\144\141\164\151\157\x6e"); goto AYj1T; Qwk1A: $this->load->helper("\143\157\157\153\151\145"); goto F0WTZ; tTq0c: $this->identity_column = $this->config->item("\x69\x64\x65\x6e\x74\151\164\171", "\x69\x6f\156\137\141\165\x74\x68"); goto j72Cm; Qg7Mp: $this->message_start_delimiter = $this->config->item("\x6d\145\163\163\x61\147\x65\137\163\164\141\x72\x74\x5f\x64\x65\x6c\x69\155\x69\164\145\x72", "\151\x6f\156\137\141\165\164\150"); goto eYo0a; WDFQR: $delimiters_source = $this->config->item("\144\x65\154\x69\155\151\x74\x65\162\x73\137\x73\157\x75\162\x63\145", "\x69\x6f\x6e\137\x61\165\x74\150"); goto ZfS20; F0WTZ: $this->load->helper("\144\x61\x74\x65"); goto gd_q9; BUOo2: nKGg_: goto EekYM; jF5Ld: $error_prefix->setAccessible(TRUE); goto L1azD; kl1ir: $this->error_start_delimiter = $this->config->item("\145\162\x72\157\162\137\163\x74\141\x72\164\x5f\x64\x65\x6c\151\x6d\x69\x74\x65\x72", "\x69\x6f\x6e\137\x61\x75\164\150"); goto PPZsN; b116T: $CI =& get_instance(); goto mdeeb; CU8rv: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto BMkjI; TUA76: $this->trigger_events("\155\157\x64\x65\x6c\x5f\143\x6f\156\x73\164\162\165\143\x74\157\x72"); goto o9irs; jKGLq: if (empty($group_name)) { goto qORUZ; } goto R2WsH; D8WjD: $error_suffix->setAccessible(TRUE); goto CU8rv; W2uKJ: $this->message_start_delimiter = $this->error_start_delimiter; goto jvhfj; D8Qm_: goto zc4Oe; goto ngP58; ngP58: qORUZ: goto b116T; L1azD: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto W2uKJ; yyWz4: $this->config->load("\x69\x6f\156\137\141\165\164\x68", TRUE); goto Qwk1A; R2WsH: $this->db = $this->load->database($group_name, TRUE, TRUE); goto D8Qm_; wayPa: zc4Oe: goto ZwexV; jvhfj: $error_suffix = $form_validation_class->getProperty("\x5f\145\x72\162\x6f\x72\x5f\x73\165\146\x66\151\x78"); goto D8WjD; ZwexV: $this->tables = $this->config->item("\164\141\142\x6c\145\x73", "\x69\x6f\156\137\x61\165\x74\150"); goto tTq0c; hl1PF: $this->load->library("\x66\157\162\x6d\x5f\166\141\154\151\x64\141\164\x69\157\156"); goto yBWXv; gd_q9: $this->lang->load("\151\x6f\156\137\x61\x75\164\x68"); goto wm7kY; HQRFc: goto nKGg_; goto UN3c0; FAyby: $this->errors = []; goto WDFQR; wm7kY: $group_name = $this->config->item("\144\x61\x74\x61\x62\141\163\x65\x5f\147\x72\x6f\165\x70\x5f\x6e\141\x6d\x65", "\x69\157\156\x5f\x61\165\x74\150"); goto jKGLq; W5iOz: $this->messages = []; goto FAyby; BMkjI: $this->message_end_delimiter = $this->error_end_delimiter; goto BUOo2; eYo0a: $this->message_end_delimiter = $this->config->item("\155\145\163\x73\141\147\145\137\145\x6e\144\137\x64\x65\x6c\x69\x6d\151\164\x65\x72", "\151\157\x6e\137\x61\x75\164\x68"); goto kl1ir; mdeeb: $this->db = $CI->db; goto wayPa; oQnTm: $this->hash_method = $this->config->item("\150\x61\x73\x68\137\x6d\145\164\150\157\144", "\x69\x6f\156\137\x61\165\x74\x68"); goto W5iOz; j72Cm: $this->join = $this->config->item("\x6a\x6f\x69\x6e", "\151\157\156\x5f\141\165\x74\150"); goto oQnTm; o9irs: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto bkWrC; Z63kX: $params = $this->_get_hash_parameters($identity); goto ZbOkq; QC92r: return FALSE; goto FWCdw; ZbOkq: if (!($algo !== FALSE && $params !== FALSE)) { goto z0aOi; } goto FxsZE; jxMI_: return FALSE; goto NP1S_; bkWrC: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto hNXpt; } goto jxMI_; gSpK5: $algo = $this->_get_hash_algo(); goto Z63kX; FxsZE: return password_hash($password, $algo, $params); goto HRzaY; NP1S_: hNXpt: goto gSpK5; HRzaY: z0aOi: goto QC92r; FWCdw: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto JBtJ1; U1K1s: if (strpos($hash_password_db, "\x24") === 0) { goto WhCPe; } goto O1vmm; JBtJ1: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto h_0M7; } goto LeaAJ; klyHK: WhCPe: goto DfR1e; LeaAJ: return FALSE; goto XvVNc; O1vmm: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto bHVl5; bHVl5: goto tFmcz; goto klyHK; DfR1e: return password_verify($password, $hash_password_db); goto vVCVc; XvVNc: h_0M7: goto U1K1s; vVCVc: tFmcz: goto hcgB0; hcgB0: } public function rehash_password_if_needed($hash, $identity, $password) { goto gCbRm; hYkyX: if (!($algo !== FALSE && $params !== FALSE)) { goto DnDJT; } goto lFqMV; gCbRm: $algo = $this->_get_hash_algo(); goto eFwzn; jqFih: rx37v: goto Fwd43; XMQaj: Ic4pS: goto jqFih; lFqMV: if (!password_needs_rehash($hash, $algo, $params)) { goto rx37v; } goto AbdOW; DyZvz: $this->trigger_events(["\x72\x65\150\141\x73\150\x5f\160\x61\x73\163\167\x6f\162\x64", "\x72\145\150\x61\x73\x68\137\x70\141\163\x73\x77\x6f\x72\x64\137\x75\156\x73\165\143\143\x65\x73\x73\146\165\154"]); goto vRM8f; Fwd43: DnDJT: goto LEPvH; ky_h2: kx8Ic: goto QNseS; vRM8f: goto Ic4pS; goto ky_h2; eFwzn: $params = $this->_get_hash_parameters($identity); goto hYkyX; AbdOW: if ($this->_set_password_db($identity, $password)) { goto kx8Ic; } goto DyZvz; QNseS: $this->trigger_events(["\162\145\150\141\163\x68\137\x70\x61\x73\163\x77\x6f\x72\144", "\x72\145\150\x61\x73\x68\x5f\160\x61\x73\163\x77\x6f\x72\144\137\x73\x75\x63\x63\x65\163\x73\146\x75\x6c"]); goto XMQaj; LEPvH: } public function get_user_by_activation_code($user_code) { goto ktK7p; h6NjM: return FALSE; goto M5UVL; HTgsL: $user = $this->where("\x61\143\x74\151\x76\x61\164\151\157\156\x5f\x73\145\154\x65\143\x74\x6f\x72", $token->selector)->users()->row(); goto ZI1F6; s2fdT: return $user; goto kHMRr; ktK7p: $token = $this->_retrieve_selector_validator_couple($user_code); goto HTgsL; kHMRr: lqnYX: goto ZO3Zu; be5sI: if (!$this->verify_password($token->validator, $user->activation_code)) { goto lqnYX; } goto s2fdT; ZI1F6: if (!$user) { goto hE3OR; } goto be5sI; ZO3Zu: hE3OR: goto h6NjM; M5UVL: } public function activate($id, $code = FALSE) { goto B3B8r; daUcM: $this->db->update($this->tables["\165\163\x65\x72\163"], $data, ["\151\x64" => $id]); goto VxvOx; HkVoJ: if (!($code !== FALSE)) { goto OAeZJ; } goto DfH7v; JU1MH: return TRUE; goto McdGu; yGHhp: $this->set_message("\141\x63\x74\151\166\x61\164\145\137\x73\x75\x63\x63\145\x73\x73\x66\x75\x6c"); goto JU1MH; dRpGa: $data = ["\141\143\x74\151\166\141\164\151\x6f\156\137\163\x65\154\145\x63\x74\157\x72" => NULL, "\141\x63\164\151\166\141\164\x69\157\x6e\137\143\x6f\x64\x65" => NULL, "\141\x63\x74\151\x76\x65" => 1]; goto hoDp8; e8iCm: if (!($code === FALSE || $user && $user->id === $id)) { goto k_qhN; } goto dRpGa; DOcEY: k_qhN: goto whjO6; whjO6: $this->trigger_events(["\x70\157\163\x74\137\141\143\164\x69\x76\x61\x74\145", "\160\x6f\x73\164\137\x61\x63\164\x69\x76\x61\164\145\x5f\x75\156\x73\165\143\x63\145\x73\x73\146\165\x6c"]); goto Q0DsU; VxvOx: if (!($this->db->affected_rows() === 1)) { goto h6B0W; } goto wxHE0; wTy3U: OAeZJ: goto e8iCm; McdGu: h6B0W: goto DOcEY; hoDp8: $this->trigger_events("\x65\x78\x74\162\x61\137\167\x68\x65\162\x65"); goto daUcM; DfH7v: $user = $this->get_user_by_activation_code($code); goto wTy3U; Q0DsU: $this->set_error("\141\143\164\151\x76\141\x74\x65\x5f\165\x6e\x73\165\x63\x63\145\163\163\x66\x75\x6c"); goto y9Z_O; y9Z_O: return FALSE; goto HKRK_; wxHE0: $this->trigger_events(["\160\x6f\x73\164\x5f\x61\x63\x74\x69\166\x61\x74\x65", "\160\157\163\164\137\x61\x63\x74\151\166\141\x74\x65\137\x73\x75\x63\143\145\x73\163\x66\165\x6c"]); goto yGHhp; B3B8r: $this->trigger_events("\x70\162\145\x5f\141\143\164\x69\166\x61\x74\145"); goto HkVoJ; HKRK_: } public function deactivate($id = NULL) { goto e4TCy; iQ1oy: ZyMmg: goto zxd1_; GPLUu: FrLhI: goto n2CGg; SzrBy: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto ZyMmg; } goto YCRBu; dI7Fo: $this->set_message("\144\x65\x61\x63\x74\x69\x76\141\164\145\x5f\x73\x75\x63\143\x65\x73\163\x66\165\x6c"); goto P6pbX; a__Q5: $token = $this->_generate_selector_validator_couple(20, 40); goto dRqDi; P6pbX: DibN8: goto kX2zp; dRqDi: $this->activation_code = $token->user_code; goto cXHo6; xLhbj: $this->set_error("\x64\145\141\x63\x74\x69\x76\141\164\x65\x5f\x75\x6e\x73\165\x63\x63\145\163\163\x66\165\154"); goto M_bah; kX2zp: return $return; goto FsIhU; wmPIJ: if (!isset($id)) { goto FrLhI; } goto SzrBy; YCRBu: $this->set_error("\144\x65\x61\143\164\151\x76\x61\x74\145\x5f\143\165\162\162\145\x6e\164\x5f\165\x73\x65\x72\137\165\x6e\163\x75\143\x63\145\x73\x73\146\x75\154"); goto ev0Un; ev0Un: return FALSE; goto iQ1oy; ldftN: return FALSE; goto cN_eh; FeOtK: $this->db->update($this->tables["\165\163\145\x72\163"], $data, ["\x69\x64" => $id]); goto oXNVk; cXHo6: $data = ["\x61\143\x74\151\x76\141\164\x69\x6f\x6e\137\x73\x65\x6c\145\x63\164\x6f\x72" => $token->selector, "\x61\x63\164\x69\166\141\164\151\157\x6e\137\143\x6f\x64\x65" => $token->validator_hashed, "\141\143\x74\151\166\145" => 0]; goto WZUID; IcFme: Dw2VF: goto dI7Fo; n2CGg: $this->set_error("\144\145\x61\143\164\x69\166\x61\x74\x65\x5f\x75\156\163\165\143\143\145\x73\163\146\165\154"); goto ldftN; zxd1_: goto GztZA; goto GPLUu; M_bah: goto DibN8; goto IcFme; e4TCy: $this->trigger_events("\x64\145\141\x63\x74\x69\166\x61\164\x65"); goto wmPIJ; T_Dhq: if ($return) { goto Dw2VF; } goto xLhbj; oXNVk: $return = $this->db->affected_rows() == 1; goto T_Dhq; WZUID: $this->trigger_events("\x65\170\164\x72\x61\x5f\167\x68\145\162\145"); goto FeOtK; cN_eh: GztZA: goto a__Q5; FsIhU: } public function clear_forgotten_password_code($identity) { goto vetsy; vetsy: if (!empty($identity)) { goto ph9VO; } goto A1hB6; v3dIJ: ph9VO: goto SYqg9; W1Z9T: return TRUE; goto PGshP; A1hB6: return FALSE; goto v3dIJ; SYqg9: $data = ["\x66\157\162\x67\157\164\x74\145\156\x5f\160\x61\x73\x73\x77\157\x72\144\x5f\x73\145\154\145\143\164\x6f\162" => NULL, "\146\157\x72\x67\x6f\164\x74\145\x6e\x5f\x70\x61\163\163\x77\x6f\x72\144\137\143\x6f\x64\x65" => NULL, "\x66\157\162\147\x6f\x74\x74\145\156\137\x70\x61\163\x73\x77\157\x72\x64\x5f\x74\x69\155\145" => NULL]; goto lFVuX; lFVuX: $this->db->update($this->tables["\x75\163\145\x72\163"], $data, [$this->identity_column => $identity]); goto W1Z9T; PGshP: } public function clear_remember_code($identity) { goto i6F4m; SFEft: return FALSE; goto FI34r; qL5Jy: $data = ["\162\x65\x6d\x65\155\142\x65\162\x5f\163\145\x6c\145\143\164\157\x72" => NULL, "\x72\x65\155\145\155\x62\145\x72\x5f\x63\x6f\144\x65" => NULL]; goto dpuTI; kFrll: return TRUE; goto YPmTg; FI34r: oyh7Q: goto qL5Jy; i6F4m: if (!empty($identity)) { goto oyh7Q; } goto SFEft; dpuTI: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto kFrll; YPmTg: } public function reset_password($identity, $new) { goto cLVZb; B1aDI: $this->trigger_events(["\x70\157\x73\x74\x5f\x63\x68\x61\156\x67\x65\137\x70\x61\163\x73\167\x6f\162\x64", "\160\x6f\163\164\x5f\143\x68\141\x6e\147\145\x5f\x70\x61\x73\x73\167\x6f\x72\144\x5f\165\156\163\x75\143\x63\145\163\x73\x66\165\x6c"]); goto txO5W; RhRqg: IGp1n: goto aA7QT; txO5W: $this->set_error("\160\x61\x73\x73\x77\x6f\162\144\x5f\143\150\141\x6e\147\145\137\165\x6e\x73\x75\143\x63\x65\163\163\x66\165\154"); goto zd0n9; cEXJ4: KP770: goto bPVUw; cRSrd: $this->trigger_events(["\160\x6f\163\x74\137\143\x68\x61\x6e\x67\x65\x5f\x70\141\x73\163\x77\157\162\144", "\160\x6f\x73\x74\137\x63\x68\141\156\147\x65\137\160\141\163\163\x77\x6f\x72\x64\137\165\156\163\x75\x63\143\x65\163\163\x66\x75\x6c"]); goto K9wx_; K9wx_: return FALSE; goto nVwPp; cLVZb: $this->trigger_events("\160\x72\145\x5f\143\x68\x61\x6e\x67\145\137\x70\141\x73\163\167\x6f\x72\x64"); goto Vaq0Q; zd0n9: goto IGp1n; goto cEXJ4; aA7QT: return $return; goto OQ6oI; bPVUw: $this->trigger_events(["\160\x6f\x73\x74\137\x63\x68\141\156\147\x65\137\160\141\163\163\x77\x6f\162\144", "\x70\x6f\163\x74\x5f\x63\150\141\156\147\145\x5f\x70\141\x73\163\x77\157\162\x64\x5f\x73\x75\143\143\x65\163\163\146\x75\x6c"]); goto kaufU; AXf9I: if ($return) { goto KP770; } goto B1aDI; Vaq0Q: if ($this->identity_check($identity)) { goto VIZmS; } goto cRSrd; oWV13: $return = $this->_set_password_db($identity, $new); goto AXf9I; nVwPp: VIZmS: goto oWV13; kaufU: $this->set_message("\160\141\163\x73\167\157\x72\x64\137\x63\x68\141\156\x67\145\137\x73\x75\x63\x63\x65\x73\x73\146\x75\154"); goto RhRqg; OQ6oI: } public function change_password($identity, $old, $new) { goto KtMSA; KtMSA: $this->trigger_events("\x70\x72\145\x5f\143\150\x61\x6e\x67\x65\x5f\x70\x61\x73\163\x77\157\162\144"); goto YIgV1; BJTm3: $result = $this->_set_password_db($identity, $new); goto jjTof; kRN8n: return FALSE; goto ULeOo; jjTof: if ($result) { goto NomG0; } goto eBV5x; EZ9yK: return $result; goto rrP2E; BmifU: NomG0: goto eDr9q; ar8L1: $user = $query->row(); goto foPvN; eDr9q: $this->trigger_events(["\160\x6f\x73\x74\x5f\143\x68\x61\156\x67\145\137\160\x61\163\x73\x77\157\x72\x64", "\x70\x6f\163\164\x5f\x63\150\x61\x6e\147\145\x5f\160\x61\x73\x73\167\x6f\162\144\x5f\x73\x75\143\x63\x65\163\x73\x66\165\x6c"]); goto CfV0m; foPvN: if (!$this->verify_password($old, $user->password, $identity)) { goto m6fsW; } goto BJTm3; Gwdit: goto nxFfQ; goto BmifU; sFk5A: return FALSE; goto cHfX_; YIgV1: $this->trigger_events("\x65\x78\164\x72\x61\137\x77\150\145\x72\145"); goto EfTd0; RRoTA: $this->set_error("\160\x61\x73\163\x77\x6f\162\x64\137\143\x68\141\x6e\147\145\137\165\x6e\163\165\143\143\x65\163\x73\x66\x75\x6c"); goto Gwdit; pVptx: $this->trigger_events(["\x70\157\x73\x74\x5f\x63\150\x61\x6e\x67\145\137\160\141\163\x73\x77\x6f\x72\x64", "\x70\x6f\x73\164\x5f\x63\150\141\156\x67\x65\137\x70\x61\x73\163\167\157\x72\144\137\165\x6e\163\165\x63\143\145\x73\x73\x66\165\154"]); goto UNouR; EfTd0: $query = $this->db->select("\x69\144\x2c\40\x70\141\163\163\x77\157\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\x65\163\143")->get($this->tables["\x75\163\x65\162\163"]); goto bebcb; cHfX_: CEf9Z: goto ar8L1; oOYRb: $this->set_error("\160\141\163\x73\167\x6f\x72\x64\137\x63\x68\x61\x6e\147\x65\x5f\x75\156\163\x75\143\143\x65\163\163\146\165\154"); goto kRN8n; bebcb: if (!($query->num_rows() !== 1)) { goto CEf9Z; } goto pVptx; UNouR: $this->set_error("\x70\x61\163\x73\x77\157\x72\x64\137\x63\x68\x61\156\147\145\x5f\165\x6e\163\165\x63\143\x65\x73\x73\x66\x75\154"); goto sFk5A; rrP2E: m6fsW: goto oOYRb; eBV5x: $this->trigger_events(["\x70\x6f\163\164\137\143\x68\141\x6e\x67\x65\x5f\x70\x61\163\x73\167\x6f\x72\144", "\160\157\x73\x74\137\x63\150\141\156\147\x65\137\160\x61\163\x73\167\157\x72\144\x5f\165\x6e\163\x75\143\143\145\x73\163\146\165\x6c"]); goto RRoTA; kirxg: nxFfQ: goto EZ9yK; CfV0m: $this->set_message("\160\x61\x73\x73\x77\x6f\x72\x64\x5f\143\150\141\156\x67\145\137\x73\165\143\143\x65\163\163\146\x75\154"); goto kirxg; ULeOo: } public function username_check($username = '') { goto mfR6J; mfR6J: $this->trigger_events("\165\x73\145\162\156\x61\x6d\145\137\x63\x68\145\143\153"); goto lBLYU; dns6f: YBXNP: goto LNcWx; ZNI6T: return $this->db->where("\165\163\145\x72\156\x61\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\163"]) > 0; goto MMLv8; LNcWx: $this->trigger_events("\145\x78\x74\162\x61\x5f\167\150\x65\x72\145"); goto ZNI6T; lBLYU: if (!empty($username)) { goto YBXNP; } goto Go_aX; Go_aX: return FALSE; goto dns6f; MMLv8: } public function email_check($email = '') { goto yTXcm; DEB4X: $this->trigger_events("\145\170\164\162\x61\x5f\x77\150\145\x72\145"); goto FIQdm; yTXcm: $this->trigger_events("\x65\155\141\x69\x6c\x5f\x63\150\145\x63\153"); goto PXFrM; FIQdm: return $this->db->where("\145\155\x61\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\163"]) > 0; goto gZXfk; q0JtT: return FALSE; goto kZeZM; kZeZM: p7Dgu: goto DEB4X; PXFrM: if (!empty($email)) { goto p7Dgu; } goto q0JtT; gZXfk: } public function identity_check($identity = '') { goto AfJX4; NAgST: if (!empty($identity)) { goto il38Q; } goto R8kH7; iCu0v: il38Q: goto C2RrT; C2RrT: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\145\x72\163"]) > 0; goto jJ1bg; R8kH7: return FALSE; goto iCu0v; AfJX4: $this->trigger_events("\151\x64\x65\x6e\x74\x69\x74\x79\137\143\150\145\x63\x6b"); goto NAgST; jJ1bg: } public function get_user_id_from_identity($identity = '') { goto rj5Ic; SfVJw: t0h7C: goto i6_iM; c0JK3: return FALSE; goto SfVJw; NDZtw: return FALSE; goto VRPhA; NW5dp: if (!($query->num_rows() !== 1)) { goto t0h7C; } goto c0JK3; hrpaS: return $user->id; goto Xbzzf; naQnj: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto NW5dp; VRPhA: epkHR: goto naQnj; rj5Ic: if (!empty($identity)) { goto epkHR; } goto NDZtw; i6_iM: $user = $query->row(); goto hrpaS; Xbzzf: } public function forgotten_password($identity) { goto HoNZo; qXhNh: zXVlJ: goto wNAh3; fi889: goto POEwY; goto OVjEE; yaink: return FALSE; goto fi889; GjNl2: return FALSE; goto qXhNh; wNAh3: $token = $this->_generate_selector_validator_couple(20, 80); goto Ud9Yz; OVjEE: j2Rg9: goto iNC8B; FV_7p: if ($this->db->affected_rows() === 1) { goto j2Rg9; } goto uJHl0; TUFQo: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $update, [$this->identity_column => $identity]); goto FV_7p; uJHl0: $this->trigger_events(["\160\157\163\x74\x5f\146\157\162\x67\x6f\164\x74\x65\x6e\137\160\141\163\163\x77\157\x72\144", "\160\157\x73\164\x5f\146\157\162\147\157\x74\164\145\x6e\137\160\x61\163\163\167\x6f\162\144\137\165\x6e\x73\x75\143\143\x65\x73\163\x66\x75\x6c"]); goto yaink; WXBp2: return $token->user_code; goto w8gYC; Ud9Yz: $update = ["\x66\x6f\162\x67\x6f\164\164\x65\156\x5f\160\141\x73\163\x77\157\162\x64\x5f\163\145\x6c\x65\x63\164\x6f\162" => $token->selector, "\x66\157\x72\x67\157\x74\x74\145\x6e\137\x70\141\x73\163\x77\157\162\x64\x5f\x63\157\144\145" => $token->validator_hashed, "\146\x6f\162\x67\157\x74\x74\x65\x6e\x5f\x70\x61\163\163\x77\x6f\x72\144\x5f\164\151\155\x65" => time()]; goto MHiSZ; yuF_v: $this->trigger_events(["\160\157\163\164\x5f\146\157\x72\147\157\164\164\x65\x6e\137\x70\x61\163\163\167\157\162\144", "\x70\157\163\x74\x5f\x66\157\x72\147\x6f\164\164\145\x6e\x5f\160\x61\x73\x73\x77\157\x72\x64\137\x75\x6e\163\x75\x63\143\145\163\163\146\165\x6c"]); goto GjNl2; iNC8B: $this->trigger_events(["\x70\x6f\163\x74\x5f\x66\157\x72\x67\x6f\164\164\x65\x6e\x5f\x70\141\163\x73\167\157\x72\144", "\x70\157\163\x74\x5f\x66\157\162\x67\157\164\x74\145\x6e\137\x70\141\163\x73\167\x6f\162\x64\x5f\x73\165\x63\x63\x65\163\163\146\x75\154"]); goto WXBp2; HoNZo: if (!empty($identity)) { goto zXVlJ; } goto yuF_v; MHiSZ: $this->trigger_events("\145\170\164\162\x61\137\x77\x68\145\x72\145"); goto TUFQo; w8gYC: POEwY: goto pHTDZ; pHTDZ: } public function get_user_by_forgotten_password_code($user_code) { goto I3To2; zD_sE: WKELx: goto Nx7J4; Nx7J4: cUWge: goto fKZU3; AhXdi: $user = $this->where("\x66\x6f\162\x67\157\x74\x74\145\x6e\137\x70\x61\x73\x73\167\x6f\162\144\x5f\163\145\154\x65\x63\164\157\162", $token->selector)->users()->row(); goto I5W8q; fKZU3: return FALSE; goto I092r; oQliH: return $user; goto zD_sE; I3To2: $token = $this->_retrieve_selector_validator_couple($user_code); goto AhXdi; I5W8q: if (!$user) { goto cUWge; } goto hZyNa; hZyNa: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto WKELx; } goto oQliH; I092r: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto OFcZ9; TIGtR: return FALSE; goto AqtwG; gfy0X: if (!(isset($default_group->id) && empty($groups))) { goto C0dHG; } goto uLi7l; kRmaz: Cf0km: goto Xl42_; uLi7l: $groups[] = $default_group->id; goto iLqCY; pNxgZ: return FALSE; goto kRmaz; jSlxJ: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\x65\x72\x73"], $additional_data), $data); goto Pl2xa; AqtwG: gO0it: goto pfO98; OFcZ9: $this->trigger_events("\x70\x72\x65\x5f\162\x65\x67\x69\163\x74\x65\162"); goto YzDk1; hzF1n: $default_group = $query; goto qtroL; B0sST: return FALSE; goto kjEDc; qtDy2: $password = $this->hash_password($password); goto V4Cpt; HblzC: return isset($id) ? $id : FALSE; goto NIBOI; BkGGj: sYC8p: goto ib4XT; wDqk0: $this->db->insert($this->tables["\x75\x73\x65\x72\x73"], $user_data); goto hLw8N; V6TiO: foreach ($groups as $group) { $this->add_to_group($group, $id); GaP4r: } goto o3r81; x5zVH: F6536: goto hzF1n; pfO98: goto MlNhS; goto ecuhh; Pl2xa: $this->trigger_events("\x65\x78\x74\162\x61\137\x73\x65\164"); goto wDqk0; aSoLP: if (!(!isset($query->id) && empty($groups))) { goto F6536; } goto ox1oV; TsGEU: $this->set_error("\x61\x63\x63\x6f\165\x6e\x74\x5f\143\x72\145\141\164\x69\157\x6e\137\x6d\x69\x73\163\x69\x6e\x67\x5f\x64\x65\146\x61\x75\x6c\x74\x5f\x67\x72\157\x75\x70"); goto TIGtR; qtroL: $ip_address = $this->input->ip_address(); goto qtDy2; fOyAx: $query = $this->db->get_where($this->tables["\x67\162\157\x75\x70\x73"], ["\156\141\155\145" => $this->config->item("\144\x65\146\x61\x75\x6c\x74\137\147\x72\x6f\x75\160", "\151\157\x6e\x5f\x61\165\x74\x68")], 1)->row(); goto aSoLP; ag0Td: return FALSE; goto x5zVH; jEjrX: if (empty($groups)) { goto sYC8p; } goto V6TiO; Xl42_: $data = [$this->identity_column => $identity, "\165\x73\x65\162\x6e\141\x6d\145" => $identity, "\x70\141\163\163\167\x6f\162\x64" => $password, "\145\x6d\x61\151\x6c" => $email, "\151\x70\x5f\x61\x64\x64\162\145\163\163" => $ip_address, "\143\x72\x65\x61\164\145\x64\137\157\156" => time(), "\x61\143\x74\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto jSlxJ; ib4XT: $this->trigger_events("\160\157\x73\164\x5f\x72\x65\x67\151\163\164\145\162"); goto HblzC; YzDk1: $manual_activation = $this->config->item("\x6d\x61\x6e\x75\141\x6c\137\141\143\x74\151\166\x61\x74\x69\x6f\x6e", "\151\x6f\x6e\x5f\x61\x75\164\150"); goto rbwrC; o3r81: KSUu5: goto BkGGj; ecuhh: aGhkQ: goto McxNT; ox1oV: $this->set_error("\141\x63\x63\157\165\156\164\137\143\162\145\x61\x74\x69\157\x6e\x5f\x69\x6e\x76\141\154\x69\144\137\x64\x65\x66\x61\165\154\x74\x5f\x67\x72\x6f\165\x70"); goto ag0Td; PUnk6: $this->set_error("\141\x63\x63\x6f\x75\x6e\x74\137\x63\162\145\x61\x74\x69\157\156\x5f\165\x6e\163\x75\143\x63\145\x73\x73\x66\165\x6c"); goto pNxgZ; rbwrC: if ($this->identity_check($identity)) { goto aGhkQ; } goto u7GHQ; u7GHQ: if (!(!$this->config->item("\144\x65\146\141\x75\154\x74\137\147\162\x6f\165\x70", "\x69\157\156\x5f\x61\165\164\x68") && empty($groups))) { goto gO0it; } goto TsGEU; hLw8N: $id = $this->db->insert_id($this->tables["\x75\x73\145\x72\163"] . "\137\151\x64\137\x73\x65\161"); goto gfy0X; iLqCY: C0dHG: goto jEjrX; kjEDc: MlNhS: goto fOyAx; V4Cpt: if (!($password === FALSE)) { goto Cf0km; } goto PUnk6; McxNT: $this->set_error("\141\143\143\157\165\x6e\x74\x5f\x63\162\x65\141\164\151\x6f\156\137\144\x75\x70\154\x69\143\x61\x74\x65\x5f\151\x64\x65\x6e\164\x69\164\x79"); goto B0sST; NIBOI: } public function login($identity, $password, $remember = FALSE) { goto hmu0U; DQZaP: TAOBw: goto nC0_H; nC0_H: $this->remember_user($identity); goto PU_P2; m35GC: ZdXbI: goto zOKQ8; slypm: if (!$this->verify_password($password, $user->password, $identity)) { goto N05gu; } goto W1JVx; Usz5d: $this->trigger_events("\x70\x6f\x73\164\137\x6c\x6f\147\151\x6e\137\165\x6e\x73\x75\x63\x63\x65\163\163\x66\165\x6c"); goto fC8TQ; yBJcy: goto lgRLt; goto DQZaP; O7p5X: $this->trigger_events("\160\x6f\163\x74\137\154\157\x67\151\x6e\x5f\x75\156\163\165\143\143\x65\x73\x73\146\165\154"); goto cZ0IH; dnyYi: return FALSE; goto ECHId; TPcjr: $this->set_session($user); goto XbqIx; rwdcj: $this->clear_login_attempts($identity); goto Y3nqu; Y3nqu: $this->clear_forgotten_password_code($identity); goto NK9h4; rBDrJ: $this->trigger_events(["\x70\157\x73\164\x5f\x6c\157\147\x69\156", "\x70\157\163\164\137\x6c\x6f\x67\151\156\137\x73\x75\x63\x63\x65\x73\x73\x66\165\154"]); goto f74oF; PU_P2: lgRLt: goto m35GC; LCyWN: bDFKo: goto tQhGJ; I4q6K: $this->increase_login_attempts($identity); goto CMklN; ECHId: lB2pj: goto MKnpD; BVbjt: $user = $query->row(); goto slypm; cZ0IH: $this->set_error("\x6c\x6f\147\x69\156\x5f\165\x6e\x73\165\x63\x63\145\163\163\x66\x75\154\137\x6e\x6f\x74\137\x61\143\x74\151\166\145"); goto NI7il; m9hhr: beQ_3: goto TPcjr; BQbhG: if (!(empty($identity) || empty($password))) { goto lB2pj; } goto DAggo; dyY1V: $this->session->sess_regenerate(FALSE); goto rBDrJ; NK9h4: if (!$this->config->item("\x72\x65\x6d\x65\x6d\x62\x65\x72\137\x75\x73\145\162\163", "\x69\x6f\x6e\137\x61\165\x74\x68")) { goto ZdXbI; } goto Zwfak; IdY2g: return FALSE; goto j3RcS; l6EBM: $this->hash_password($password); goto Usz5d; VvuQ1: return TRUE; goto G6eh3; tQhGJ: if (!($query->num_rows() === 1)) { goto Ck_1o; } goto BVbjt; XbqIx: $this->update_last_login($user->id); goto rwdcj; yikMg: $this->set_error("\154\157\147\x69\156\137\x75\156\163\165\x63\x63\x65\163\163\146\165\x6c"); goto IdY2g; W1JVx: if (!($user->active == 0)) { goto beQ_3; } goto O7p5X; tDp75: return FALSE; goto LCyWN; C4K50: if (!$this->is_max_login_attempts_exceeded($identity)) { goto bDFKo; } goto l6EBM; hmu0U: $this->trigger_events("\x70\162\x65\x5f\x6c\x6f\x67\151\x6e"); goto BQbhG; TstQw: $this->clear_remember_code($identity); goto yBJcy; zOKQ8: $this->rehash_password_if_needed($user->password, $identity, $password); goto dyY1V; MKnpD: $this->trigger_events("\x65\170\x74\162\141\x5f\167\150\145\x72\145"); goto gB43N; DAggo: $this->set_error("\154\x6f\147\151\x6e\x5f\165\156\163\x75\143\x63\x65\x73\x73\146\165\x6c"); goto dnyYi; fC8TQ: $this->set_error("\x6c\x6f\x67\x69\x6e\x5f\164\151\155\x65\157\x75\x74"); goto tDp75; f74oF: $this->set_message("\x6c\157\x67\151\156\137\x73\x75\x63\143\x65\x73\x73\x66\165\x6c"); goto VvuQ1; gB43N: $query = $this->db->select($this->identity_column . "\54\x20\145\x6d\x61\151\154\x2c\40\x69\144\x2c\40\x70\141\163\x73\x77\x6f\x72\x64\54\x20\x61\x63\x74\151\166\x65\x2c\40\154\141\163\x74\137\x6c\x6f\147\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\144\145\x73\143")->get($this->tables["\165\x73\x65\162\163"]); goto C4K50; Zwfak: if ($remember) { goto TAOBw; } goto TstQw; G6eh3: N05gu: goto V4jF7; CMklN: $this->trigger_events("\160\x6f\163\x74\x5f\154\157\147\151\x6e\137\x75\x6e\163\x75\x63\x63\145\163\x73\x66\165\154"); goto yikMg; XXJ7Z: $this->hash_password($password); goto I4q6K; NI7il: return FALSE; goto m9hhr; V4jF7: Ck_1o: goto XXJ7Z; j3RcS: } public function recheck_session() { goto yfrrh; Uva33: if ($query->num_rows() === 1) { goto qp7Mp; } goto NOJyY; qiFZN: $this->session->set_userdata("\154\141\x73\164\137\x63\150\145\x63\x6b", time()); goto mjwfW; NOJyY: $this->trigger_events("\154\157\147\x6f\165\x74"); goto oa4LL; gqjtD: if (!($last_login + $recheck < time())) { goto jdYof; } goto vYieP; mjwfW: yX0wn: goto NMXLO; ek8gZ: return FALSE; goto fHsOf; NMXLO: jdYof: goto Z7AxW; oa4LL: $identity = $this->config->item("\x69\144\x65\156\x74\x69\164\171", "\x69\x6f\156\137\141\165\164\150"); goto GslFB; fHsOf: goto yX0wn; goto RFsCm; RFsCm: qp7Mp: goto qiFZN; yfrrh: $recheck = NULL !== $this->config->item("\x72\145\143\150\145\x63\x6b\137\x74\151\x6d\145\162", "\151\157\x6e\x5f\141\x75\x74\x68") ? $this->config->item("\x72\145\143\150\145\143\x6b\x5f\x74\x69\155\x65\x72", "\x69\157\156\137\141\165\164\150") : 0; goto hr8K8; vYieP: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\x6e\x74\x69\164\x79"), "\141\x63\x74\x69\x76\x65" => "\x31"])->limit(1)->order_by("\x69\x64", "\x64\145\x73\143")->get($this->tables["\x75\163\x65\x72\x73"]); goto Uva33; GslFB: $this->session->unset_userdata([$identity, "\x69\x64", "\165\x73\x65\x72\x5f\x69\x64"]); goto ek8gZ; H85yk: return (bool) $this->session->userdata("\x69\144\145\x6e\164\x69\x74\x79"); goto pV2Pm; hr8K8: if (!($recheck !== 0)) { goto cc027; } goto zrkIx; Z7AxW: cc027: goto H85yk; zrkIx: $last_login = $this->session->userdata("\154\x61\x73\164\x5f\x63\150\x65\143\153"); goto gqjtD; pV2Pm: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto iHb08; Qnu0b: $attempts = $this->get_attempts_num($identity, $ip_address); goto LExFU; ti2XK: return FALSE; goto Hi8vU; z1MWJ: if (!($max_attempts > 0)) { goto CeQ_d; } goto Qnu0b; iHb08: if (!$this->config->item("\x74\x72\x61\x63\153\x5f\x6c\157\147\151\156\137\x61\164\x74\145\x6d\160\x74\x73", "\x69\157\156\137\x61\x75\x74\150")) { goto FpacA; } goto a7178; a7178: $max_attempts = $this->config->item("\x6d\x61\170\151\x6d\165\x6d\x5f\x6c\x6f\x67\x69\x6e\137\x61\x74\164\x65\x6d\x70\x74\163", "\x69\157\x6e\x5f\141\x75\x74\150"); goto z1MWJ; LExFU: return $attempts >= $max_attempts; goto UpXe4; UpXe4: CeQ_d: goto npyo0; npyo0: FpacA: goto ti2XK; Hi8vU: } public function get_attempts_num($identity, $ip_address = NULL) { goto HKyng; MFVVm: PTR_m: goto p0UOh; YMSvQ: if (isset($ip_address)) { goto PTR_m; } goto V2eOX; Rc2bV: return $qres->num_rows(); goto J0F_8; J0F_8: Z6k5E: goto Y0Eq9; Cy7sW: if (!$this->config->item("\164\x72\141\x63\153\137\x6c\157\147\x69\x6e\x5f\151\x70\x5f\141\x64\x64\x72\145\163\163", "\x69\x6f\x6e\137\x61\x75\164\150")) { goto FRWW1; } goto YMSvQ; YREhs: $this->db->where("\164\151\x6d\145\40\x3e", time() - $this->config->item("\x6c\157\143\153\x6f\165\164\x5f\164\x69\155\145", "\x69\157\156\x5f\x61\165\x74\x68"), FALSE); goto t1YcT; R2iy0: FRWW1: goto YREhs; t1YcT: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\156\137\141\x74\x74\x65\155\x70\x74\163"]); goto Rc2bV; IDRuf: $this->db->select("\61", FALSE); goto ktShk; HKyng: if (!$this->config->item("\x74\x72\x61\x63\153\x5f\x6c\x6f\x67\151\156\137\141\164\x74\x65\x6d\x70\x74\x73", "\151\x6f\156\x5f\x61\x75\164\x68")) { goto Z6k5E; } goto IDRuf; Y0Eq9: return 0; goto esCt3; p0UOh: $this->db->where("\151\x70\x5f\141\x64\x64\162\x65\163\x73", $ip_address); goto R2iy0; V2eOX: $ip_address = $this->input->ip_address(); goto MFVVm; ktShk: $this->db->where("\154\157\x67\151\x6e", $identity); goto Cy7sW; esCt3: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto G4ZYX; M3HIe: uNE00: goto Vtoit; v0lTO: j10JW: goto ZY24p; wlYl_: if (isset($ip_address)) { goto JrgN8; } goto YQuwD; BIZL6: JrgN8: goto GSyBA; ZY24p: YYH8z: goto MJjS_; JkeG3: return $qres->row()->time; goto v0lTO; yXhlH: $this->db->select("\164\x69\155\x65"); goto SWZtF; MJjS_: return 0; goto TUuiU; G4ZYX: if (!$this->config->item("\164\162\141\x63\153\137\154\x6f\147\x69\156\137\141\x74\x74\145\155\x70\x74\x73", "\x69\157\156\137\x61\x75\164\150")) { goto YYH8z; } goto yXhlH; SWZtF: $this->db->where("\154\x6f\x67\x69\156", $identity); goto fpud4; lmBBr: if (!($qres->num_rows() > 0)) { goto j10JW; } goto JkeG3; fpud4: if (!$this->config->item("\x74\x72\141\143\x6b\x5f\154\x6f\147\x69\x6e\137\x69\160\137\141\x64\144\162\145\163\x73", "\151\x6f\x6e\x5f\141\x75\164\150")) { goto uNE00; } goto wlYl_; Vtoit: $this->db->order_by("\x69\144", "\144\145\163\143"); goto UuomW; UuomW: $qres = $this->db->get($this->tables["\154\x6f\147\x69\156\x5f\x61\164\164\x65\x6d\160\164\163"], 1); goto lmBBr; YQuwD: $ip_address = $this->input->ip_address(); goto BIZL6; GSyBA: $this->db->where("\x69\x70\137\x61\144\x64\162\145\163\x73", $ip_address); goto M3HIe; TUuiU: } public function get_last_attempt_ip($identity) { goto y7xUq; lDJeJ: return ''; goto FsiPD; EEpD6: $this->db->select("\x69\160\x5f\x61\x64\144\162\x65\163\163"); goto xRVKM; KES18: Nik1q: goto lDJeJ; y7xUq: if (!($this->config->item("\x74\x72\141\x63\x6b\137\x6c\x6f\147\x69\x6e\137\x61\x74\164\145\x6d\x70\164\163", "\151\157\156\137\x61\x75\164\x68") && $this->config->item("\164\162\x61\143\x6b\137\x6c\157\147\x69\x6e\x5f\151\160\x5f\141\x64\144\x72\x65\163\x73", "\151\157\x6e\x5f\x61\x75\x74\150"))) { goto Nik1q; } goto EEpD6; IoSy7: $qres = $this->db->get($this->tables["\154\x6f\147\151\x6e\x5f\141\x74\164\x65\x6d\160\164\x73"], 1); goto GQR8C; UREFj: return $qres->row()->ip_address; goto P8WaG; P8WaG: wgjWJ: goto KES18; vaLQH: $this->db->order_by("\151\144", "\144\145\x73\x63"); goto IoSy7; xRVKM: $this->db->where("\154\x6f\147\151\156", $identity); goto vaLQH; GQR8C: if (!($qres->num_rows() > 0)) { goto wgjWJ; } goto UREFj; FsiPD: } public function increase_login_attempts($identity) { goto WQl7O; mO0gs: $data["\151\x70\137\141\x64\x64\x72\x65\163\x73"] = $this->input->ip_address(); goto WdHZn; WdHZn: aMRWQ: goto ryELy; i5Pk2: if (!$this->config->item("\x74\162\x61\143\x6b\137\154\157\x67\x69\156\137\151\160\137\141\x64\144\x72\x65\163\163", "\151\x6f\x6e\137\x61\x75\164\150")) { goto aMRWQ; } goto mO0gs; ryELy: return $this->db->insert($this->tables["\x6c\157\x67\151\156\x5f\x61\x74\164\145\155\160\x74\x73"], $data); goto TyBP0; FXhIV: $data = ["\x69\x70\x5f\x61\144\x64\162\x65\x73\163" => '', "\154\157\x67\151\x6e" => $identity, "\164\151\155\145" => time()]; goto i5Pk2; TyBP0: l3Azh: goto i7OXW; WQl7O: if (!$this->config->item("\164\162\141\143\153\x5f\x6c\x6f\x67\x69\x6e\137\x61\164\164\145\x6d\160\164\x73", "\x69\157\x6e\137\x61\x75\x74\150")) { goto l3Azh; } goto FXhIV; i7OXW: return FALSE; goto yjzM7; yjzM7: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto NVMKk; I9H6g: rg13e: goto Fc25k; uQWWD: $ip_address = $this->input->ip_address(); goto XwqBb; Fc25k: return FALSE; goto z5e3h; AlDl2: s1HiZ: goto AIIaW; AIIaW: $this->db->or_where("\x74\151\155\x65\40\74", time() - $old_attempts_expire_period, FALSE); goto JoOsK; ocJjv: $this->db->where("\x69\160\137\x61\144\x64\162\x65\x73\x73", $ip_address); goto AlDl2; lXzn1: if (isset($ip_address)) { goto spKrg; } goto uQWWD; NVMKk: if (!$this->config->item("\x74\x72\141\x63\153\x5f\x6c\157\x67\x69\156\x5f\x61\x74\x74\145\155\160\164\x73", "\151\157\156\x5f\x61\165\164\150")) { goto rg13e; } goto V1qGw; V1qGw: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\x63\153\157\165\164\137\164\x69\x6d\x65", "\151\157\156\137\x61\x75\164\x68")); goto ZlHiM; JoOsK: return $this->db->delete($this->tables["\154\157\147\x69\x6e\137\141\164\x74\x65\155\160\x74\163"]); goto I9H6g; ZlHiM: $this->db->where("\x6c\x6f\x67\x69\x6e", $identity); goto gDr33; gDr33: if (!$this->config->item("\x74\162\x61\x63\x6b\x5f\x6c\x6f\x67\151\156\137\151\160\x5f\x61\144\x64\162\145\x73\x73", "\x69\x6f\156\x5f\x61\165\164\150")) { goto s1HiZ; } goto lXzn1; XwqBb: spKrg: goto ocJjv; z5e3h: } public function limit($limit) { goto X605x; saWUp: return $this; goto hsR_7; X605x: $this->trigger_events("\154\x69\x6d\x69\x74"); goto EWDEM; EWDEM: $this->_ion_limit = $limit; goto saWUp; hsR_7: } public function offset($offset) { goto D_PcK; xPYMd: return $this; goto GnKel; OJffh: $this->_ion_offset = $offset; goto xPYMd; D_PcK: $this->trigger_events("\157\146\146\163\145\164"); goto OJffh; GnKel: } public function where($where, $value = NULL) { goto Hi8aZ; cWvzJ: array_push($this->_ion_where, $where); goto B55vZ; B55vZ: return $this; goto myebf; su1dQ: $where = [$where => $value]; goto pGCE1; g8m6P: if (is_array($where)) { goto R3brv; } goto su1dQ; pGCE1: R3brv: goto cWvzJ; Hi8aZ: $this->trigger_events("\x77\150\x65\x72\x65"); goto g8m6P; myebf: } public function like($like, $value = NULL, $position = "\142\157\x74\150") { goto lg2wF; OD0lD: array_push($this->_ion_like, ["\x6c\x69\x6b\x65" => $like, "\166\x61\x6c\x75\x65" => $value, "\160\157\x73\151\x74\151\x6f\x6e" => $position]); goto TI6Pw; lg2wF: $this->trigger_events("\x6c\x69\x6b\x65"); goto OD0lD; TI6Pw: return $this; goto d9Zh2; d9Zh2: } public function select($select) { goto GLItn; GLItn: $this->trigger_events("\163\x65\x6c\x65\x63\x74"); goto d8OfI; iJta9: return $this; goto Mb3XJ; d8OfI: $this->_ion_select[] = $select; goto iJta9; Mb3XJ: } public function order_by($by, $order = "\144\x65\x73\x63") { goto ab991; iRGjJ: $this->_ion_order_by = $by; goto jwEYO; jwEYO: $this->_ion_order = $order; goto RlgbC; RlgbC: return $this; goto EeDgQ; ab991: $this->trigger_events("\x6f\x72\x64\x65\x72\x5f\x62\x79"); goto iRGjJ; EeDgQ: } public function row() { goto xVvtT; xVvtT: $this->trigger_events("\x72\157\x77"); goto q8SLm; q8SLm: $row = $this->response->row(); goto JYIrG; JYIrG: return $row; goto OCDZJ; OCDZJ: } public function row_array() { goto QWqKL; ZvDOY: return $row; goto GOUNg; lrGCt: $row = $this->response->row_array(); goto ZvDOY; QWqKL: $this->trigger_events(["\162\x6f\x77", "\162\157\167\x5f\x61\162\162\141\x79"]); goto lrGCt; GOUNg: } public function result() { goto pOmUa; YaVkY: return $result; goto iNgL2; pOmUa: $this->trigger_events("\x72\x65\x73\x75\x6c\164"); goto zzrCt; zzrCt: $result = $this->response->result(); goto YaVkY; iNgL2: } public function result_array() { goto vxzu6; i4Eto: $result = $this->response->result_array(); goto bCkFl; bCkFl: return $result; goto OJDrv; vxzu6: $this->trigger_events(["\x72\x65\163\165\x6c\x74", "\162\x65\163\165\154\164\x5f\x61\x72\x72\141\x79"]); goto i4Eto; OJDrv: } public function num_rows() { goto FoMAb; nuaqw: $result = $this->response->num_rows(); goto coxL6; coxL6: return $result; goto ZbUjp; FoMAb: $this->trigger_events(["\156\x75\155\x5f\x72\x6f\167\x73"]); goto nuaqw; ZbUjp: } public function users($groups = NULL) { goto DxO1v; zzl5Q: ueKQG: goto CEQ4k; ZM6lL: if (is_array($groups)) { goto MgAlG; } goto JrJlj; TE7Sa: nEMIq: goto LaiCf; LVY1m: $this->db->join($this->tables["\x67\x72\157\x75\x70\x73"], $this->tables["\x75\163\x65\162\x73\137\x67\162\157\165\x70\x73"] . "\56" . $this->join["\147\162\x6f\x75\160\163"] . "\40\75\40" . $this->tables["\x67\x72\x6f\165\x70\163"] . "\56\x69\x64", "\151\x6e\156\145\162"); goto eGwqp; VCKkS: Q1SXk: goto i2nTO; i2nTO: if (!isset($groups)) { goto dqA6M; } goto ZM6lL; at0vS: $this->_ion_order_by = NULL; goto TE7Sa; rYAGq: whwMt: goto f95Xz; FAtud: isq7v: goto pWNLk; Ng1t8: $this->db->{$or_where_in}($this->tables["\x75\x73\145\x72\x73\x5f\x67\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\x6f\165\x70\163"], $group_ids); goto vu_XX; QCvnQ: xhyb8: goto L5cpu; eGwqp: $this->db->where_in($this->tables["\147\x72\x6f\x75\160\163"] . "\x2e\x6e\141\155\145", $group_names); goto Y25_A; Ah7IP: goto Q1SXk; goto IshZO; xUg6b: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\153\145"], $like["\x76\141\154\165\x65"], $like["\160\x6f\163\x69\164\x69\157\x6e"]); kOZiZ: } goto l_ej0; DxO1v: $this->trigger_events("\x75\163\145\x72\x73"); goto C6dsi; L5cpu: $group_ids = []; goto hg64u; RH4aH: $this->_ion_offset = NULL; goto j5Kuy; pWNLk: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto v97Xw; } goto xUg6b; WBOVR: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto DbIPr; Y25_A: aWxKW: goto EzRyB; V6PqI: MxjsA: goto bz5bN; YHr4z: $this->_ion_select = []; goto VCKkS; T2z62: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto isq7v; } goto lOvwH; y0Z4c: mDAKD: goto omHET; ORf6g: MgAlG: goto yAOy_; uhq2J: $this->db->select([$this->tables["\x75\x73\x65\x72\x73"] . "\56\52", $this->tables["\x75\163\145\x72\x73"] . "\56\x69\x64\40\141\163\x20\151\x64", $this->tables["\165\163\145\x72\x73"] . "\x2e\151\x64\x20\x61\163\x20\x75\163\145\x72\137\x69\x64"]); goto Ah7IP; JrJlj: $groups = [$groups]; goto ORf6g; j5Kuy: paG6_: goto fYkzE; DbIPr: $this->_ion_order = NULL; goto at0vS; yAOy_: if (!(isset($groups) && !empty($groups))) { goto xhyb8; } goto UNgSe; xBy7v: dqA6M: goto idhBm; bz5bN: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\167\150\145\162\145\137\151\156" : "\167\150\145\162\145\x5f\x69\x6e"; goto YcW8h; l_ej0: IshVU: goto UAMmi; UAMmi: $this->_ion_like = []; goto Pf4Lw; hg64u: $group_names = []; goto tvh_i; V43KI: Dedgt: goto YHr4z; cSN_m: $this->_ion_limit = NULL; goto zzl5Q; idhBm: $this->trigger_events("\145\x78\x74\x72\141\137\167\150\x65\162\145"); goto T2z62; LaiCf: $this->response = $this->db->get($this->tables["\165\x73\145\x72\163"]); goto pfSaI; IshZO: klfSe: goto JexJN; fYkzE: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto nEMIq; } goto WBOVR; YcW8h: if (empty($group_names)) { goto aWxKW; } goto LVY1m; tvh_i: foreach ($groups as $group) { goto Wn7Hj; mfvPw: zj6Jb: goto q9q7R; HwbVJ: $group_ids[] = $group; goto gsR6I; Wu2mn: $group_names[] = $group; goto m2A1x; Wn7Hj: if (is_numeric($group)) { goto lXaW9; } goto Wu2mn; m2A1x: goto IWGBy; goto JHw7k; gsR6I: IWGBy: goto mfvPw; JHw7k: lXaW9: goto HwbVJ; q9q7R: } goto V6PqI; WtMIq: $this->db->limit($this->_ion_limit); goto cSN_m; CEQ4k: goto paG6_; goto rYAGq; omHET: $this->_ion_where = []; goto FAtud; C6dsi: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto klfSe; } goto uhq2J; vu_XX: blSox: goto xBy7v; pfSaI: return $this; goto GN8v_; ec1sO: $this->_ion_limit = NULL; goto RH4aH; g5ZYQ: $this->db->join($this->tables["\165\x73\145\x72\x73\x5f\147\x72\x6f\x75\x70\x73"], $this->tables["\x75\x73\x65\162\x73\137\147\162\x6f\x75\160\163"] . "\x2e" . $this->join["\165\x73\x65\162\163"] . "\x3d" . $this->tables["\x75\163\x65\x72\x73"] . "\x2e\151\144", "\x69\x6e\x6e\x65\x72"); goto QCvnQ; EzRyB: if (empty($group_ids)) { goto blSox; } goto Ng1t8; eox5m: if (!isset($this->_ion_limit)) { goto ueKQG; } goto WtMIq; gCUmp: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto whwMt; } goto eox5m; JexJN: foreach ($this->_ion_select as $select) { $this->db->select($select); JcdRT: } goto V43KI; UNgSe: $this->db->distinct(); goto g5ZYQ; lOvwH: foreach ($this->_ion_where as $where) { $this->db->where($where); nQcne: } goto y0Z4c; Pf4Lw: v97Xw: goto gCUmp; f95Xz: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto ec1sO; GN8v_: } public function user($id = NULL) { goto QX6Ii; JkVl3: return $this; goto et2Xe; bUPI4: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\162\x5f\151\x64"); goto JgwWe; QoHRz: $this->where($this->tables["\x75\x73\145\x72\163"] . "\56\x69\x64", $id); goto hO9Oz; hO9Oz: $this->users(); goto JkVl3; JgwWe: $this->limit(1); goto WzwNE; QX6Ii: $this->trigger_events("\x75\x73\145\162"); goto bUPI4; WzwNE: $this->order_by($this->tables["\x75\x73\145\x72\x73"] . "\56\x69\x64", "\144\145\163\143"); goto QoHRz; et2Xe: } public function get_users_groups($id = FALSE) { goto C_Smv; C_Smv: $this->trigger_events("\147\x65\164\x5f\x75\x73\145\x72\x73\x5f\x67\x72\x6f\x75\160"); goto gO0Y4; gO0Y4: $id || ($id = $this->session->userdata("\165\163\x65\x72\x5f\x69\144")); goto d730u; d730u: return $this->db->select($this->tables["\165\x73\x65\x72\x73\x5f\147\x72\157\165\x70\163"] . "\x2e" . $this->join["\147\x72\x6f\x75\160\x73"] . "\x20\x61\x73\40\x69\144\54\x20" . $this->tables["\x67\x72\x6f\165\x70\163"] . "\56\156\141\x6d\x65\x2c\40" . $this->tables["\147\x72\x6f\x75\160\x73"] . "\56\x64\x65\163\143\162\x69\160\164\x69\157\x6e")->where($this->tables["\165\163\x65\162\163\x5f\x67\162\157\x75\x70\x73"] . "\56" . $this->join["\165\163\145\162\x73"], $id)->join($this->tables["\147\x72\157\x75\160\163"], $this->tables["\165\163\x65\x72\163\x5f\x67\162\157\x75\x70\163"] . "\x2e" . $this->join["\147\162\157\165\x70\163"] . "\x3d" . $this->tables["\147\x72\157\x75\x70\x73"] . "\56\x69\x64")->get($this->tables["\x75\x73\145\x72\x73\x5f\x67\x72\x6f\x75\160\163"]); goto K95CR; K95CR: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto AQUrU; zzeAv: cCkV5: goto OXJQo; QYjcp: foreach ($check_group as $key => $value) { goto IUBlb; IUBlb: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto M77vH; M77vH: if (!(in_array($value, $groups) xor $check_all)) { goto jaHiu; } goto DzR3i; XU5i7: lKOX9: goto zZmMu; bg1C7: jaHiu: goto XU5i7; DzR3i: return !$check_all; goto bg1C7; zZmMu: } goto zzeAv; wr66c: goto k221D; goto rZXfH; ZjFJa: YRPNs: goto OK0h7; kLHtt: qVZNf: goto OXsHE; NQpJ3: $groups_array = $this->_cache_user_in_group[$id]; goto x4Sk1; MNo9h: $id || ($id = $this->session->userdata("\x75\x73\145\x72\x5f\151\x64")); goto PAOSx; cvkY5: $users_groups = $this->get_users_groups($id)->result(); goto N4OVA; PAOSx: if (is_array($check_group)) { goto YRPNs; } goto JWLZQ; AQUrU: $this->trigger_events("\151\156\x5f\x67\162\x6f\x75\x70"); goto MNo9h; rZXfH: jBI3e: goto NQpJ3; x4Sk1: k221D: goto QYjcp; mUZd4: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; d06Rv: } goto kLHtt; OK0h7: if (isset($this->_cache_user_in_group[$id])) { goto jBI3e; } goto cvkY5; OXsHE: $this->_cache_user_in_group[$id] = $groups_array; goto wr66c; OXJQo: return $check_all; goto SM6Sr; N4OVA: $groups_array = []; goto mUZd4; JWLZQ: $check_group = [$check_group]; goto ZjFJa; SM6Sr: } public function add_to_group($group_ids, $user_id = FALSE) { goto HhX7i; JMYKV: $group_ids = [$group_ids]; goto LVqov; HhX7i: $this->trigger_events("\x61\144\144\137\164\157\x5f\x67\162\157\165\x70"); goto npTsz; NraFK: IgBCX: goto aTYus; R3dWu: $return = 0; goto v6gu0; aTYus: return $return; goto PGJrB; npTsz: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\x72\137\151\x64")); goto eqj6A; eqj6A: if (is_array($group_ids)) { goto BtbMP; } goto JMYKV; v6gu0: foreach ($group_ids as $group_id) { goto gQUA6; z6JrC: ZtXzi: goto THDEM; UfhEs: Pqbfv: goto s8OF4; THDEM: hkpE9: goto P1yUk; OBm0w: $group_name = $group[0]->name; goto MkxU7; D__r0: rDVMs: goto gLE0B; gLE0B: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto d2TUk; s8OF4: $group_name = $this->_cache_groups[$group_id]; goto D__r0; tT2ac: $group = $this->group($group_id)->result(); goto OBm0w; Wt6Ed: if (isset($this->_cache_groups[$group_id])) { goto Pqbfv; } goto tT2ac; gQUA6: if (!$this->db->insert($this->tables["\x75\x73\145\162\163\137\147\162\x6f\x75\x70\163"], [$this->join["\x67\162\x6f\165\160\163"] => (float) $group_id, $this->join["\165\x73\x65\x72\163"] => (float) $user_id])) { goto ZtXzi; } goto Wt6Ed; MkxU7: $this->_cache_groups[$group_id] = $group_name; goto qOEeh; d2TUk: $return++; goto z6JrC; qOEeh: goto rDVMs; goto UfhEs; P1yUk: } goto NraFK; LVqov: BtbMP: goto R3dWu; PGJrB: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto Zf_8E; LLiNb: if (!empty($user_id)) { goto e9NED; } goto mCuBP; Zf_8E: $this->trigger_events("\x72\145\155\x6f\166\145\137\x66\162\x6f\155\137\x67\x72\157\165\160"); goto LLiNb; hwEan: $return = TRUE; goto b0ACk; xH1fE: if (!($return = $this->db->delete($this->tables["\165\163\145\x72\163\137\x67\162\x6f\x75\160\x73"], [$this->join["\x75\x73\145\x72\x73"] => (float) $user_id]))) { goto eSyfY; } goto jHFJ0; EpID_: e9NED: goto kkMT3; UWOU5: Mn17Q: goto hwEan; lWuEX: GXR6p: goto gEW7e; b0ACk: o0qPK: goto H2xAg; gEW7e: foreach ($group_ids as $group_id) { goto D8jE0; nSfao: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto nKRL7; } goto t8QZf; D8jE0: $this->db->delete($this->tables["\x75\x73\145\x72\163\137\147\162\x6f\165\160\x73"], [$this->join["\147\162\x6f\165\x70\163"] => (float) $group_id, $this->join["\x75\163\x65\162\x73"] => (float) $user_id]); goto nSfao; QN8rp: nKRL7: goto mPIE1; t8QZf: unset($this->_cache_user_in_group[$user_id][$group_id]); goto QN8rp; mPIE1: H0Znb: goto TuVjF; TuVjF: } goto UWOU5; M_gmT: $group_ids = [$group_ids]; goto lWuEX; z_IFC: G1R75: goto YCjx_; jHFJ0: $this->_cache_user_in_group[$user_id] = []; goto GVxC5; cMriX: goto o0qPK; goto z_IFC; kkMT3: if (!empty($group_ids)) { goto G1R75; } goto xH1fE; GVxC5: eSyfY: goto cMriX; mCuBP: return FALSE; goto EpID_; H2xAg: return $return; goto KnW1l; YCjx_: if (is_array($group_ids)) { goto GXR6p; } goto M_gmT; KnW1l: } public function groups() { goto ndkOd; T8kfl: goto jlnOK; goto ddvW9; EvL7v: if (!isset($this->_ion_limit)) { goto phnPZ; } goto Thd63; IOg6J: phnPZ: goto T8kfl; YMkVl: return $this; goto FmVsv; T8UAg: $this->_ion_where = []; goto cVC0g; MEBdO: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto F3646; R3Wnb: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto vlWUG; } goto EvL7v; bix0B: $this->_ion_limit = NULL; goto xrQNP; ndkOd: $this->trigger_events("\x67\x72\157\x75\x70\163"); goto ovkH6; ovkH6: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto yExxM; } goto ZqMdj; eoaej: jlnOK: goto FZjMr; ddvW9: vlWUG: goto QjV7Q; ZqMdj: foreach ($this->_ion_where as $where) { $this->db->where($where); edTDU: } goto fP5DG; fP5DG: weGe4: goto T8UAg; D_Yp2: $this->response = $this->db->get($this->tables["\147\x72\x6f\x75\x70\x73"]); goto YMkVl; cVC0g: yExxM: goto R3Wnb; QjV7Q: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto bix0B; F3646: M78ZU: goto D_Yp2; Thd63: $this->db->limit($this->_ion_limit); goto wwMqE; xrQNP: $this->_ion_offset = NULL; goto eoaej; wwMqE: $this->_ion_limit = NULL; goto IOg6J; FZjMr: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto M78ZU; } goto MEBdO; FmVsv: } public function group($id = NULL) { goto yZmhS; UgAOi: $this->limit(1); goto a05e2; qCmcp: if (!isset($id)) { goto of1WQ; } goto bsa00; GDGiK: return $this->groups(); goto SEHBB; v63U9: of1WQ: goto UgAOi; yZmhS: $this->trigger_events("\147\162\157\165\160"); goto qCmcp; a05e2: $this->order_by("\x69\144", "\x64\145\163\x63"); goto GDGiK; bsa00: $this->where($this->tables["\x67\162\x6f\165\x70\163"] . "\56\x69\x64", $id); goto v63U9; SEHBB: } public function update($id, array $data) { goto AK3yD; ecVwW: return TRUE; goto GVf_6; cyQ7z: sJauE: goto Qjiyq; W4IgY: $this->db->trans_begin(); goto fdwkY; P286Z: if (!array_key_exists("\160\x61\163\x73\x77\157\x72\144", $data)) { goto Fsgkf; } goto S2AVT; YhVXo: $this->trigger_events(["\160\x6f\x73\x74\137\x75\x70\144\x61\164\x65\x5f\x75\163\x65\162", "\x70\157\163\x74\137\165\x70\144\141\x74\x65\x5f\165\x73\145\x72\137\x75\x6e\163\x75\143\143\145\163\163\146\x75\154"]); goto hpEde; D51ZN: Xbwj_: goto qreBd; hpEde: $this->set_error("\x75\160\144\x61\164\145\x5f\x75\x6e\163\x75\143\x63\x65\163\x73\146\165\x6c"); goto Se29n; uUqld: if (!($this->db->trans_status() === FALSE)) { goto ILCL8; } goto l7Hhf; BOk34: return FALSE; goto FKTHi; zjTWd: $this->db->trans_rollback(); goto YhVXo; JHNfn: $this->set_error("\165\x70\x64\141\x74\x65\137\165\x6e\x73\165\x63\x63\145\x73\163\146\x75\x6c"); goto Cwhkq; qC4rM: Q9M2d: goto EUC2F; Cwhkq: return FALSE; goto D51ZN; Qjiyq: $data["\160\x61\163\163\167\157\162\144"] = $this->hash_password($data["\x70\141\x73\x73\x77\x6f\x72\144"], $user->{$this->identity_column}); goto FPyqm; MJEPw: $this->trigger_events("\145\170\x74\162\141\137\x77\x68\145\162\x65"); goto pXY1_; iKAvr: $this->trigger_events(["\x70\x6f\x73\x74\137\165\x70\144\141\164\145\137\165\163\145\162", "\x70\157\163\x74\x5f\x75\160\x64\141\x74\145\x5f\x75\x73\145\162\x5f\165\156\x73\x75\x63\143\145\163\163\x66\165\x6c"]); goto JHNfn; ClTJp: Fsgkf: goto T_44s; Se29n: return FALSE; goto qC4rM; pXY1_: $this->db->update($this->tables["\x75\x73\x65\x72\163"], $data, ["\x69\144" => $user->id]); goto uUqld; WbiG3: $this->set_message("\165\x70\x64\141\x74\145\137\163\x75\143\x63\145\x73\163\x66\165\x6c"); goto ecVwW; FPyqm: if (!($data["\160\x61\x73\x73\x77\x6f\162\144"] === FALSE)) { goto Q9M2d; } goto zjTWd; THu5d: goto Xx05z; goto cyQ7z; Y3v8l: $this->trigger_events(["\160\157\163\164\137\165\x70\144\141\164\145\x5f\x75\x73\145\162", "\x70\x6f\x73\x74\x5f\165\160\x64\x61\x74\145\137\165\x73\145\162\137\x75\x6e\x73\x75\x63\143\x65\x73\x73\146\165\154"]); goto fZr_D; VBPMQ: $this->db->trans_rollback(); goto XLN3Y; c_M30: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\x73\x77\x6f\x72\144", $data) || array_key_exists("\x65\x6d\x61\151\x6c", $data))) { goto jc6R3; } goto P286Z; FKTHi: ILCL8: goto d2fE2; l7Hhf: $this->db->trans_rollback(); goto Y3v8l; xAto_: $user = $this->user($id)->row(); goto W4IgY; fdwkY: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto Xbwj_; } goto VBPMQ; qreBd: $data = $this->_filter_data($this->tables["\x75\x73\x65\162\x73"], $data); goto c_M30; S2AVT: if (!empty($data["\x70\141\163\x73\x77\x6f\x72\144"])) { goto sJauE; } goto D7gAG; T_44s: jc6R3: goto MJEPw; KCfOI: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x75\160\144\x61\164\x65\137\x75\163\145\x72", "\160\157\x73\x74\x5f\165\160\x64\141\164\145\x5f\x75\163\145\x72\137\x73\x75\143\x63\x65\163\x73\x66\x75\154"]); goto WbiG3; d2fE2: $this->db->trans_commit(); goto KCfOI; fZr_D: $this->set_error("\x75\x70\x64\141\164\x65\x5f\x75\156\x73\165\143\143\x65\163\x73\146\x75\x6c"); goto BOk34; AK3yD: $this->trigger_events("\160\x72\145\137\x75\x70\144\x61\164\145\x5f\165\x73\145\162"); goto xAto_; D7gAG: unset($data["\160\141\163\163\167\157\x72\144"]); goto THu5d; XLN3Y: $this->set_error("\141\x63\x63\x6f\165\x6e\x74\137\x63\162\x65\x61\164\x69\x6f\x6e\137\144\165\x70\154\151\x63\141\x74\145\x5f\x69\x64\x65\x6e\x74\151\x74\171"); goto iKAvr; EUC2F: Xx05z: goto ClTJp; GVf_6: } public function delete_user($id) { goto YaXEl; Nf0a0: if (!($this->db->trans_status() === FALSE)) { goto KqMQF; } goto L8n1B; jblMf: KqMQF: goto cE6zu; qAWbm: $this->set_message("\x64\x65\x6c\145\164\x65\x5f\x73\165\143\x63\145\163\x73\x66\x75\154"); goto BY7iX; oYA2L: $this->set_error("\x64\145\x6c\x65\x74\145\137\165\156\163\x75\x63\x63\x65\x73\x73\146\x75\x6c"); goto OfMfJ; D43Lv: $this->remove_from_group(NULL, $id); goto sWvNp; OfMfJ: return FALSE; goto jblMf; ehNQR: $this->db->trans_begin(); goto D43Lv; BY7iX: return TRUE; goto zHbVh; KerRN: $this->trigger_events(["\x70\x6f\163\164\x5f\144\145\x6c\x65\164\x65\x5f\x75\163\145\162", "\x70\157\163\164\x5f\144\145\x6c\x65\x74\145\137\165\x73\x65\162\137\163\165\143\143\x65\x73\x73\146\165\x6c"]); goto qAWbm; L8n1B: $this->db->trans_rollback(); goto K226S; sWvNp: $this->db->delete($this->tables["\165\x73\x65\x72\x73"], ["\x69\144" => $id]); goto Nf0a0; cE6zu: $this->db->trans_commit(); goto KerRN; K226S: $this->trigger_events(["\160\x6f\163\164\137\x64\145\x6c\x65\x74\x65\x5f\x75\163\x65\x72", "\x70\x6f\163\x74\x5f\144\x65\154\x65\164\x65\x5f\165\x73\145\162\x5f\x75\x6e\163\x75\143\x63\x65\x73\x73\146\165\x6c"]); goto oYA2L; YaXEl: $this->trigger_events("\x70\162\145\x5f\144\x65\154\x65\164\145\137\x75\163\145\x72"); goto ehNQR; zHbVh: } public function update_last_login($id) { goto ZTGrm; nySgh: $this->load->helper("\x64\x61\x74\x65"); goto KO0LA; KO0LA: $this->trigger_events("\x65\x78\164\x72\x61\x5f\167\x68\145\x72\145"); goto O62pq; ZTGrm: $this->trigger_events("\165\160\144\141\164\145\137\x6c\141\x73\164\137\154\x6f\x67\151\x6e"); goto nySgh; LSvio: return $this->db->affected_rows() == 1; goto HSlaD; O62pq: $this->db->update($this->tables["\x75\x73\145\162\163"], ["\154\141\x73\164\x5f\154\157\x67\151\x6e" => time()], ["\151\144" => $id]); goto LSvio; HSlaD: } public function set_lang($lang = "\x65\156") { goto bpOvK; abyNS: aByNc: goto M3aHV; Rjvo2: return TRUE; goto KGWUT; Bm8ox: set_cookie(["\x6e\141\x6d\x65" => "\x6c\141\x6e\147\137\143\x6f\x64\x65", "\x76\141\154\165\x65" => $lang, "\x65\x78\160\x69\x72\145" => $expire]); goto Rjvo2; bpOvK: $this->trigger_events("\x73\145\164\137\x6c\141\156\147"); goto oyg7k; oyg7k: if ($this->config->item("\165\x73\145\x72\x5f\x65\x78\160\x69\162\x65", "\151\157\x6e\x5f\x61\x75\x74\150") === 0) { goto aByNc; } goto g5nn4; QpSH_: fcYLE: goto Bm8ox; M3aHV: $expire = self::MAX_COOKIE_LIFETIME; goto QpSH_; g5nn4: $expire = $this->config->item("\x75\163\145\162\x5f\x65\170\160\x69\162\x65", "\151\157\156\137\x61\165\164\x68"); goto jTRSa; jTRSa: goto fcYLE; goto abyNS; KGWUT: } public function set_session($user) { goto t7UK8; x5nB_: $this->trigger_events("\160\x6f\x73\164\x5f\163\145\x74\x5f\163\145\163\x73\x69\x6f\x6e"); goto fmySw; WnBut: $this->session->set_userdata($session_data); goto x5nB_; t7UK8: $this->trigger_events("\x70\162\x65\x5f\163\145\x74\137\x73\x65\x73\163\x69\x6f\x6e"); goto gI9Q4; gI9Q4: $session_data = ["\151\x64\145\x6e\x74\x69\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\x69\x6c" => $user->email, "\x75\x73\x65\162\137\x69\144" => $user->id, "\x6f\154\144\137\154\141\x73\x74\x5f\x6c\157\147\151\x6e" => $user->last_login, "\x6c\x61\x73\164\137\x63\150\145\x63\153" => time()]; goto WnBut; fmySw: return TRUE; goto knaC9; knaC9: } public function remember_user($identity) { goto BRLIj; cLtXV: return FALSE; goto kHY0M; wtTJ0: $expire = $this->config->item("\165\x73\145\x72\x5f\145\x78\160\151\x72\145", "\151\x6f\156\x5f\141\165\164\150"); goto iwFdK; iwFdK: goto z5FP3; goto wWN1M; kHY0M: iDWDa: goto gAjTK; rCkeX: if (!($this->db->affected_rows() > -1)) { goto EMV9H; } goto LR56m; Ojgs0: set_cookie(["\156\141\155\145" => $this->config->item("\x72\x65\155\x65\x6d\142\x65\162\137\143\157\x6f\x6b\151\145\x5f\156\x61\155\145", "\151\x6f\156\137\x61\x75\164\x68"), "\x76\x61\x6c\165\x65" => $token->user_code, "\x65\170\160\x69\x72\145" => $expire]); goto agN8M; agN8M: $this->trigger_events(["\x70\x6f\163\164\x5f\162\x65\x6d\145\x6d\142\145\x72\137\x75\163\x65\162", "\x72\x65\x6d\145\155\142\x65\x72\x5f\165\163\145\x72\x5f\163\165\x63\143\x65\x73\x73\x66\x75\154"]); goto qoDDT; VdOPw: if (!$token->validator_hashed) { goto HtL6A; } goto b6H6A; U0bIy: z5FP3: goto Ojgs0; LR56m: if ($this->config->item("\x75\x73\145\162\x5f\x65\170\160\151\162\145", "\x69\x6f\x6e\137\141\165\164\x68") === 0) { goto ogodS; } goto wtTJ0; Czo15: return FALSE; goto F_vaA; gAjTK: $token = $this->_generate_selector_validator_couple(); goto VdOPw; Xw1H1: EMV9H: goto geC52; geC52: HtL6A: goto PrWqh; wWN1M: ogodS: goto AZz2p; AZz2p: $expire = self::MAX_COOKIE_LIFETIME; goto U0bIy; b6H6A: $this->db->update($this->tables["\x75\163\145\162\x73"], ["\x72\x65\155\x65\155\x62\145\162\137\x73\145\154\145\x63\x74\157\x72" => $token->selector, "\162\x65\x6d\x65\155\x62\x65\x72\137\143\157\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto rCkeX; qoDDT: return TRUE; goto Xw1H1; BRLIj: $this->trigger_events("\x70\162\145\137\x72\x65\155\x65\x6d\142\145\x72\137\x75\x73\x65\162"); goto D6kik; PrWqh: $this->trigger_events(["\x70\x6f\163\164\137\162\145\x6d\x65\155\142\145\162\137\165\163\145\x72", "\162\145\155\x65\x6d\x62\145\x72\x5f\165\x73\145\x72\x5f\165\x6e\163\x75\x63\x63\x65\163\x73\x66\165\x6c"]); goto Czo15; D6kik: if ($identity) { goto iDWDa; } goto cLtXV; F_vaA: } public function login_remembered_user() { goto qH3HU; ouRqs: return TRUE; goto F5Icr; iAZY3: $this->trigger_events(["\x70\157\163\164\137\x6c\157\x67\151\156\x5f\162\x65\155\x65\x6d\142\x65\162\145\144\x5f\x75\x73\x65\162", "\160\x6f\163\x74\x5f\x6c\157\147\151\x6e\137\x72\145\x6d\145\x6d\142\x65\162\145\x64\x5f\165\x73\x65\162\137\165\x6e\163\x75\x63\x63\145\x73\163\x66\x75\x6c"]); goto Ndpm9; qH3HU: $this->trigger_events("\x70\x72\x65\x5f\154\x6f\x67\x69\156\x5f\x72\x65\x6d\x65\155\142\x65\162\145\x64\x5f\165\163\x65\x72"); goto zzosC; eJaIC: R4rHZ: goto o6W_8; hdNtz: if (!($token === FALSE)) { goto RMSQS; } goto cko5x; ERYFl: if (!$this->config->item("\165\163\x65\162\x5f\145\170\164\x65\x6e\x64\x5f\x6f\x6e\x5f\x6c\x6f\x67\x69\x6e", "\x69\x6f\156\x5f\141\x75\x74\x68")) { goto R4rHZ; } goto FGwXr; jee6U: $this->update_last_login($user->id); goto YqPQi; do3Ja: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto hdNtz; o6W_8: $this->session->sess_regenerate(FALSE); goto YinDZ; sh6E4: YaxJd: goto jizJf; jizJf: delete_cookie($this->config->item("\x72\145\155\145\x6d\x62\x65\162\137\143\x6f\x6f\153\x69\145\x5f\x6e\141\155\145", "\x69\x6f\156\x5f\141\x75\164\x68")); goto iAZY3; FGwXr: $this->remember_user($identity); goto eJaIC; kSBoH: $this->clear_forgotten_password_code($identity); goto ERYFl; Fv4OE: $query = $this->db->select($this->identity_column . "\54\x20\x69\x64\54\40\x65\155\141\x69\154\x2c\40\x72\x65\155\x65\155\x62\145\162\x5f\x63\x6f\x64\145\54\40\154\x61\x73\164\x5f\154\x6f\147\151\156")->where("\x72\145\155\145\x6d\142\145\162\137\x73\x65\154\x65\x63\x74\157\162", $token->selector)->where("\141\143\164\x69\x76\x65", 1)->limit(1)->get($this->tables["\x75\x73\145\162\x73"]); goto MQTEy; zzosC: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\x65\x6d\x62\x65\162\137\143\x6f\157\153\151\145\x5f\156\141\155\x65", "\x69\157\156\137\141\x75\x74\150")); goto do3Ja; MQTEy: if (!($query->num_rows() === 1)) { goto YaxJd; } goto q8bHn; YqPQi: $this->set_session($user); goto kSBoH; eNo2I: $this->trigger_events("\145\x78\x74\x72\x61\x5f\x77\x68\145\162\x65"); goto Fv4OE; Ndpm9: return FALSE; goto Ph2u1; Umg_B: $identity = $user->{$this->identity_column}; goto Lb5la; Lb5la: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto NX_PJ; } goto jee6U; cko5x: $this->trigger_events(["\x70\x6f\163\x74\x5f\x6c\x6f\147\151\156\x5f\162\145\155\145\155\142\x65\162\x65\x64\137\165\x73\x65\162", "\x70\x6f\x73\164\137\154\x6f\147\151\156\x5f\162\x65\x6d\x65\x6d\142\x65\162\x65\144\137\165\163\x65\162\137\x75\156\163\165\x63\x63\x65\163\x73\x66\x75\154"]); goto y1Lp1; h5vK8: RMSQS: goto eNo2I; YinDZ: $this->trigger_events(["\160\157\x73\x74\x5f\154\x6f\147\x69\156\137\162\x65\155\x65\155\x62\145\x72\145\144\x5f\x75\x73\x65\162", "\x70\x6f\163\x74\137\154\157\147\x69\x6e\x5f\162\145\155\x65\155\142\145\x72\x65\144\137\165\x73\145\162\x5f\163\165\143\x63\145\163\x73\x66\165\154"]); goto ouRqs; q8bHn: $user = $query->row(); goto Umg_B; F5Icr: NX_PJ: goto sh6E4; y1Lp1: return FALSE; goto h5vK8; Ph2u1: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto QWiQu; HrFCB: $existing_group = $this->db->get_where($this->tables["\147\162\157\165\160\163"], ["\x6e\x61\x6d\145" => $group_name])->num_rows(); goto trlW7; vxVnr: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\160\163"], $additional_data), $data); goto dWfGP; MRaOg: $data = ["\x6e\x61\x6d\145" => $group_name, "\144\x65\x73\x63\162\x69\160\x74\151\157\156" => $group_description]; goto SnQ_Z; vbR7n: $this->set_error("\147\162\x6f\x75\x70\x5f\156\x61\155\x65\x5f\162\x65\x71\165\x69\x72\145\144"); goto dqEfz; uUWgG: $this->set_error("\x67\x72\x6f\165\160\137\x61\x6c\162\x65\x61\144\171\x5f\x65\x78\151\x73\x74\163"); goto T8bPa; dWfGP: yLAlO: goto Xxt3m; ALtO3: $this->set_message("\x67\162\x6f\165\x70\x5f\143\162\x65\141\x74\151\157\156\x5f\163\165\143\143\x65\x73\x73\x66\x75\154"); goto VhRHL; zOmkd: $this->db->insert($this->tables["\147\162\157\165\160\x73"], $data); goto p_H__; T8bPa: return FALSE; goto pq4Vp; dqEfz: return FALSE; goto CK90g; trlW7: if (!($existing_group !== 0)) { goto i5Ftn; } goto uUWgG; QWiQu: if ($group_name) { goto YkPMM; } goto vbR7n; p_H__: $group_id = $this->db->insert_id($this->tables["\x67\x72\157\x75\160\x73"] . "\x5f\151\144\137\163\x65\x71"); goto ALtO3; SnQ_Z: if (empty($additional_data)) { goto yLAlO; } goto vxVnr; Xxt3m: $this->trigger_events("\x65\x78\x74\162\141\137\147\162\x6f\x75\x70\137\x73\145\164"); goto zOmkd; VhRHL: return $group_id; goto mfxq9; pq4Vp: i5Ftn: goto MRaOg; CK90g: YkPMM: goto HrFCB; mfxq9: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto CKFsp; wc3m3: return FALSE; goto TuRf2; mRVlN: $this->db->update($this->tables["\147\162\x6f\x75\x70\163"], $data, ["\151\x64" => $group_id]); goto flTQi; oVBBn: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto jEFs3; } goto mfQaR; J_rS0: if (empty($additional_data)) { goto pc3cO; } goto PXLBo; Jiigr: fRFtv: goto J_rS0; moLqi: return FALSE; goto Jiigr; v8dxh: $existing_group = $this->db->get_where($this->tables["\x67\162\157\165\160\163"], ["\156\x61\x6d\145" => $group_name])->row(); goto oVBBn; lHx0B: $data = []; goto gV0HY; gV0HY: if (empty($group_name)) { goto yrZvu; } goto v8dxh; CzWDn: if (!($this->config->item("\141\144\x6d\151\x6e\x5f\x67\x72\157\x75\x70", "\151\157\156\x5f\x61\165\x74\x68") === $group->name && $group_name !== $group->name)) { goto fRFtv; } goto W7DnT; flTQi: $this->set_message("\x67\162\x6f\165\x70\x5f\x75\x70\x64\x61\x74\x65\137\163\165\143\143\x65\x73\163\x66\165\x6c"); goto rTdk6; bxTjq: $group = $this->db->get_where($this->tables["\x67\x72\x6f\165\x70\163"], ["\x69\x64" => $group_id])->row(); goto CzWDn; mfQaR: $this->set_error("\147\162\x6f\165\160\x5f\x61\x6c\162\x65\x61\144\x79\137\145\x78\151\x73\164\x73"); goto ax6No; CKFsp: if (!empty($group_id)) { goto zdURD; } goto wc3m3; iBaYF: yrZvu: goto bxTjq; W7DnT: $this->set_error("\x67\162\157\x75\x70\137\156\141\x6d\145\137\141\x64\x6d\x69\156\x5f\x6e\157\164\x5f\x61\154\x74\x65\x72"); goto moLqi; TuRf2: zdURD: goto lHx0B; ax6No: return FALSE; goto D8y2Z; Od5nN: pc3cO: goto mRVlN; rTdk6: return TRUE; goto BO0eQ; mBcpa: $data["\x6e\x61\155\145"] = $group_name; goto iBaYF; PXLBo: $data = array_merge($this->_filter_data($this->tables["\147\x72\157\x75\x70\x73"], $additional_data), $data); goto Od5nN; D8y2Z: jEFs3: goto mBcpa; BO0eQ: } public function delete_group($group_id = FALSE) { goto kTGLQ; wNNC0: $this->db->trans_begin(); goto dBc3F; jDate: $group = $this->group($group_id)->row(); goto g8yRk; g4aZf: IQk41: goto Okrg0; CTRxp: return FALSE; goto BifYw; STeI2: $this->trigger_events(["\160\157\x73\164\137\144\145\x6c\145\164\x65\x5f\147\x72\x6f\165\x70", "\160\157\x73\x74\x5f\x64\x65\x6c\145\x74\145\137\x67\x72\157\x75\160\x5f\x75\156\x73\165\143\x63\x65\x73\163\x66\165\154"]); goto vvyAD; PKOT_: $this->set_message("\x67\x72\x6f\165\160\137\144\x65\x6c\x65\164\x65\x5f\x73\165\143\143\x65\x73\x73\146\165\154"); goto B5hcg; B5hcg: return TRUE; goto uSodL; Okrg0: $this->db->trans_commit(); goto MptSY; BifYw: Oylec: goto jDate; Xaf9A: $this->trigger_events("\160\162\x65\x5f\144\145\x6c\x65\x74\145\x5f\x67\162\x6f\165\160"); goto wNNC0; u16Fa: return FALSE; goto g4aZf; g8yRk: if (!($group->name == $this->config->item("\x61\x64\x6d\x69\156\x5f\147\162\x6f\x75\x70", "\151\157\156\x5f\x61\165\164\150"))) { goto Aqq96; } goto iTTWY; HN0z1: if (!($this->db->trans_status() === FALSE)) { goto IQk41; } goto GPg0Q; kTGLQ: if (!(!$group_id || empty($group_id))) { goto Oylec; } goto CTRxp; MlD8R: $this->set_error("\x67\x72\x6f\165\160\x5f\144\x65\154\x65\164\145\x5f\156\x6f\x74\x61\x6c\x6c\157\x77\x65\144"); goto KCDFj; dBc3F: $this->db->delete($this->tables["\165\x73\145\162\x73\137\147\x72\x6f\x75\160\x73"], [$this->join["\x67\x72\x6f\165\160\163"] => $group_id]); goto mvFbl; GPg0Q: $this->db->trans_rollback(); goto STeI2; MptSY: $this->trigger_events(["\160\157\x73\x74\137\144\x65\154\145\164\145\137\147\x72\157\x75\x70", "\160\157\x73\164\137\x64\145\154\145\164\x65\137\x67\162\x6f\165\x70\x5f\163\x75\x63\x63\x65\x73\163\146\x75\x6c"]); goto PKOT_; KCDFj: return FALSE; goto xZ_t3; iTTWY: $this->trigger_events(["\x70\x6f\x73\164\x5f\144\145\154\145\x74\x65\137\147\162\x6f\x75\x70", "\160\x6f\163\x74\137\144\x65\154\x65\164\145\137\x67\x72\x6f\x75\160\x5f\x6e\x6f\164\141\154\154\x6f\x77\145\144"]); goto MlD8R; mvFbl: $this->db->delete($this->tables["\x67\x72\157\x75\x70\x73"], ["\x69\144" => $group_id]); goto HN0z1; vvyAD: $this->set_error("\147\x72\157\165\x70\137\x64\x65\154\x65\x74\x65\137\x75\156\x73\x75\x63\143\x65\163\163\146\x75\x6c"); goto u16Fa; xZ_t3: Aqq96: goto Xaf9A; uSodL: } public function set_hook($event, $name, $class, $method, $arguments) { goto uWGdP; gNF57: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto Ja7m1; uWGdP: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto T1DcO; U6Wd3: $this->_ion_hooks->{$event}[$name]->method = $method; goto gNF57; T1DcO: $this->_ion_hooks->{$event}[$name]->class = $class; goto U6Wd3; Ja7m1: } public function remove_hook($event, $name) { goto C2MJw; C2MJw: if (!isset($this->_ion_hooks->{$event}[$name])) { goto qfxMA; } goto CxCpp; CxCpp: unset($this->_ion_hooks->{$event}[$name]); goto pJ9v_; pJ9v_: qfxMA: goto mbxv4; mbxv4: } public function remove_hooks($event) { goto o8n63; o8n63: if (!isset($this->_ion_hooks->{$event})) { goto GyngF; } goto JTocr; JTocr: unset($this->_ion_hooks->{$event}); goto iuGCN; iuGCN: GyngF: goto N9GWr; N9GWr: } protected function _call_hook($event, $name) { goto Hyqti; G2jmd: FPVaV: goto UEpA6; UEpA6: return FALSE; goto soeJo; zQFsD: $hook = $this->_ion_hooks->{$event}[$name]; goto GNee5; GNee5: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto G2jmd; Hyqti: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto FPVaV; } goto zQFsD; soeJo: } public function trigger_events($events) { goto TEqoG; RC9RF: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); V1HsS: } goto PJRoJ; v6n53: foreach ($events as $event) { $this->trigger_events($event); bGVj9: } goto K6YdP; GvgO3: LE83F: goto v6n53; qkT3J: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto ylTFb; } goto RC9RF; pAJ7q: gJa7l: goto fyaaH; VImRX: goto gJa7l; goto GvgO3; XQNek: ylTFb: goto VImRX; TEqoG: if (is_array($events) && !empty($events)) { goto LE83F; } goto qkT3J; K6YdP: i2rSa: goto pAJ7q; PJRoJ: tc1MS: goto XQNek; fyaaH: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto Re4f1; Re4f1: $this->message_start_delimiter = $start_delimiter; goto jPII7; rsjCj: return TRUE; goto if2xv; jPII7: $this->message_end_delimiter = $end_delimiter; goto rsjCj; if2xv: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto vkFrH; vkFrH: $this->error_start_delimiter = $start_delimiter; goto nkGLS; nkGLS: $this->error_end_delimiter = $end_delimiter; goto a335J; a335J: return TRUE; goto lluGi; lluGi: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto d1igA; enru1: return $_output; goto eWs6f; BPr6J: foreach ($this->messages as $message) { goto pha14; pha14: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto SkDMc; SkDMc: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto pwb92; pwb92: yWBTS: goto QKFXX; QKFXX: } goto qQryp; d1igA: $_output = ''; goto BPr6J; qQryp: W3lk_: goto enru1; eWs6f: } public function messages_array($langify = TRUE) { goto nlv_n; uy3jx: goto sQYvY; goto aIBHe; eyG1e: sQYvY: goto ONVU5; nlv_n: if ($langify) { goto yrNzp; } goto Y1jfE; Y1jfE: return $this->messages; goto uy3jx; NTW8M: return $_output; goto eyG1e; NsGyG: $_output = []; goto n8H4c; n8H4c: foreach ($this->messages as $message) { goto enzgH; knsYV: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto BfaH1; enzgH: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto knsYV; BfaH1: ENrBl: goto DCBIw; DCBIw: } goto mdYrq; aIBHe: yrNzp: goto NsGyG; mdYrq: Lpsx_: goto NTW8M; ONVU5: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto vwvCB; y884N: foreach ($this->errors as $error) { goto OC0gA; y0BDy: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto gSaRh; gSaRh: XhSQF: goto PpxYU; OC0gA: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\43\x23"; goto y0BDy; PpxYU: } goto l_0gE; bJut9: return $_output; goto mkZPu; l_0gE: GoZnW: goto bJut9; vwvCB: $_output = ''; goto y884N; mkZPu: } public function errors_array($langify = TRUE) { goto jOS3V; qSS9v: $_output = []; goto AXs3P; TCh5W: mXJwS: goto ExsaF; U_htT: gLurF: goto qSS9v; Q3gi1: HJJbp: goto L_qLg; kt6ZA: goto mXJwS; goto U_htT; nJdNF: return $this->errors; goto kt6ZA; L_qLg: return $_output; goto TCh5W; AXs3P: foreach ($this->errors as $error) { goto uVmgx; ddfbi: D_niJ: goto oiDRV; uVmgx: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\43\x23"; goto G20Xg; G20Xg: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto ddfbi; oiDRV: } goto Q3gi1; jOS3V: if ($langify) { goto gLurF; } goto nJdNF; ExsaF: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto eO1ea; IF6PT: return FALSE; goto aQu1Y; vZ1bF: if (!($hash === FALSE)) { goto puG_q; } goto IF6PT; ExQ3r: return $this->db->affected_rows() == 1; goto Wu1tP; tAKj9: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto ExQ3r; xysbg: $this->trigger_events("\x65\170\164\x72\141\137\167\x68\x65\162\145"); goto tAKj9; Xkcw4: $data = ["\160\x61\163\x73\167\x6f\162\x64" => $hash, "\162\145\x6d\145\x6d\x62\x65\162\137\143\157\x64\145" => NULL, "\146\157\x72\x67\x6f\164\164\x65\156\137\x70\x61\163\x73\x77\x6f\162\144\x5f\x63\157\x64\x65" => NULL, "\x66\x6f\x72\147\x6f\x74\x74\145\156\137\x70\141\x73\x73\167\157\162\x64\137\x74\x69\155\145" => NULL]; goto xysbg; aQu1Y: puG_q: goto Xkcw4; eO1ea: $hash = $this->hash_password($password, $identity); goto vZ1bF; Wu1tP: } protected function _filter_data($table, $data) { goto UeIhE; TsK9s: xAZcz: goto NEU7J; UeIhE: $filtered_data = []; goto K0p1n; K0p1n: $columns = $this->db->list_fields($table); goto B5VKK; NEU7J: A1Tbm: goto cQ1t_; vQQP7: foreach ($columns as $column) { goto zngQk; Tboin: $filtered_data[$column] = $data[$column]; goto EUWrA; jV_2p: fMPr1: goto tYgaL; zngQk: if (!array_key_exists($column, $data)) { goto fDB1D; } goto Tboin; EUWrA: fDB1D: goto jV_2p; tYgaL: } goto TsK9s; cQ1t_: return $filtered_data; goto rZbzD; B5VKK: if (!is_array($data)) { goto A1Tbm; } goto vQQP7; rZbzD: } protected function _random_token($result_length = 32) { goto Odscv; gYdgk: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto yH9Kd; Odscv: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto Lpm8C; } goto ZkfSv; Z7e1m: if (!function_exists("\x6f\160\145\x6e\x73\x73\154\137\162\x61\x6e\x64\157\155\137\160\x73\145\165\x64\x6f\x5f\142\171\164\x65\x73")) { goto izqqy; } goto mNty_; mNty_: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto uo1RY; KJNmj: Lpm8C: goto LFds8; qLGlR: return FALSE; goto auly9; yJ7Mf: if (!function_exists("\x6d\x63\x72\x79\160\x74\137\143\x72\145\x61\x74\145\x5f\x69\x76")) { goto Fumik; } goto gYdgk; LFds8: if (!function_exists("\x72\141\x6e\144\157\155\137\142\x79\164\x65\x73")) { goto ZzrO3; } goto vInJ5; ZkfSv: $result_length = 32; goto KJNmj; SuUuk: ZzrO3: goto yJ7Mf; uo1RY: izqqy: goto qLGlR; vInJ5: return bin2hex(random_bytes($result_length / 2)); goto SuUuk; yH9Kd: Fumik: goto Z7e1m; auly9: } protected function _get_hash_parameters($identity = NULL) { goto uZqvy; uZqvy: $is_admin = FALSE; goto EtQPt; qEkcG: return $params; goto Sal2G; YJJw1: FQ8SA: goto TqJA9; iqRh9: if (!($user_id && $this->in_group($this->config->item("\x61\x64\155\x69\x6e\137\147\162\x6f\x75\160", "\x69\157\x6e\x5f\x61\165\164\x68"), $user_id))) { goto FQ8SA; } goto pAJfT; pAJfT: $is_admin = TRUE; goto YJJw1; QEiQd: $user_id = $this->get_user_id_from_identity($identity); goto iqRh9; loc19: mbhcu: goto qEkcG; EtQPt: if (!$identity) { goto wOc0I; } goto QEiQd; cMnVt: switch ($this->hash_method) { case "\x62\143\x72\x79\x70\164": $params = ["\x63\157\163\x74" => $is_admin ? $this->config->item("\142\x63\162\x79\160\164\137\141\x64\155\151\x6e\137\143\157\x73\164", "\151\157\156\137\141\x75\x74\150") : $this->config->item("\142\143\162\171\160\x74\x5f\x64\x65\x66\141\x75\154\x74\137\x63\157\x73\x74", "\x69\157\156\x5f\141\165\x74\x68")]; goto mbhcu; case "\141\x72\x67\x6f\x6e\62": $params = $is_admin ? $this->config->item("\141\162\147\x6f\x6e\62\137\x61\x64\x6d\x69\x6e\137\160\141\x72\141\x6d\x73", "\151\x6f\x6e\137\141\x75\x74\150") : $this->config->item("\x61\x72\x67\157\156\x32\137\144\x65\x66\x61\x75\x6c\164\x5f\x70\141\x72\141\x6d\x73", "\x69\x6f\x6e\x5f\141\165\x74\x68"); goto mbhcu; default: } goto HdPKu; HekFS: $params = FALSE; goto cMnVt; HdPKu: BKcJx: goto loc19; TqJA9: wOc0I: goto HekFS; Sal2G: } protected function _get_hash_algo() { goto nav9P; OGmAq: switch ($this->hash_method) { case "\142\143\x72\171\x70\164": $algo = PASSWORD_BCRYPT; goto Q6i1d; case "\141\x72\147\x6f\x6e\62": $algo = PASSWORD_ARGON2I; goto Q6i1d; default: } goto KLOh6; KLOh6: bAwlw: goto KYq30; nav9P: $algo = FALSE; goto OGmAq; KYq30: Q6i1d: goto kzDu7; kzDu7: return $algo; goto rV0cB; rV0cB: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto b6NQL; MmWRd: return (object) ["\163\x65\154\145\x63\164\157\x72" => $selector, "\x76\x61\x6c\151\144\141\x74\157\162\137\x68\x61\163\x68\145\x64" => $validator_hashed, "\x75\163\x65\162\x5f\143\157\144\145" => $user_code]; goto bP6Pm; b6NQL: $selector = $this->_random_token($selector_size); goto wO2lf; bJM3P: $validator_hashed = $this->hash_password($validator); goto yXZF7; yXZF7: $user_code = "{$selector}\x2e{$validator}"; goto MmWRd; wO2lf: $validator = $this->_random_token($validator_size); goto bJM3P; bP6Pm: } protected function _retrieve_selector_validator_couple($user_code) { goto re7ZK; s1Igw: $tokens = explode("\x2e", $user_code); goto NDfOP; M88q8: vKDaL: goto iZCF8; iZCF8: return FALSE; goto dx8bO; re7ZK: if (!$user_code) { goto vKDaL; } goto s1Igw; tfjpC: return (object) ["\163\145\x6c\x65\143\164\x6f\162" => $tokens[0], "\x76\141\x6c\x69\144\x61\164\157\x72" => $tokens[1]]; goto Q29Mg; NDfOP: if (!(count($tokens) === 2)) { goto m7xwJ; } goto tfjpC; Q29Mg: m7xwJ: goto M88q8; dx8bO: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto qgVtC; ZluRw: if ($this->config->item("\x73\x74\x6f\x72\145\137\x73\x61\x6c\x74", "\151\157\156\x5f\141\165\x74\150")) { goto bJ_a7; } goto nl_Zb; PKrLP: jYNXo: goto O7wPy; Xl1EC: $hashed_password = sha1($password . $salt_db->salt); goto v6hx6; v6hx6: QYXQS: goto lBg0s; VT2KY: jiywA: goto xDi1u; lllGB: return FALSE; goto QI01L; AJc0V: $this->trigger_events(["\x70\x6f\x73\164\137\x73\x68\141\x31\137\160\x61\x73\x73\x77\x6f\162\x64\x5f\155\151\147\162\141\164\151\x6f\x6e", "\x70\x6f\163\164\137\x73\150\x61\x31\137\x70\x61\x73\x73\x77\x6f\162\144\x5f\155\151\147\162\x61\x74\151\157\156\137\165\156\163\x75\143\143\x65\163\x73\146\165\154"]); goto chzUL; sjVl6: bJ_a7: goto AZSG_; XvBMn: $this->trigger_events(["\x70\157\163\x74\x5f\x73\x68\141\x31\137\x70\x61\163\x73\x77\x6f\162\144\x5f\x6d\x69\x67\x72\x61\x74\151\x6f\x6e", "\x70\x6f\163\x74\137\x73\x68\x61\x31\x5f\x70\x61\163\x73\x77\x6f\162\144\x5f\155\x69\x67\162\141\x74\x69\x6f\156\x5f\165\156\x73\x75\x63\x63\145\x73\163\x66\165\x6c"]); goto gio9F; CYuzm: if (!($query->num_rows() !== 1)) { goto TTcVD; } goto Hc9YQ; lTINn: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto q2Oki; vceDI: if ($salt_length) { goto jYNXo; } goto XvBMn; Hc9YQ: $this->trigger_events(["\160\157\x73\164\137\x73\x68\141\x31\137\x70\x61\163\163\x77\157\162\144\x5f\155\151\147\x72\x61\164\x69\157\x6e", "\x70\157\163\x74\x5f\x73\x68\x61\x31\x5f\160\141\x73\x73\x77\x6f\162\x64\x5f\x6d\151\147\x72\x61\x74\151\157\x6e\137\165\156\163\x75\143\143\145\163\163\x66\165\x6c"]); goto lllGB; vQBXD: return $result; goto VT2KY; rjsO0: $this->trigger_events(["\160\x6f\x73\164\x5f\x73\x68\141\x31\x5f\x70\141\x73\x73\x77\157\x72\144\x5f\155\x69\x67\162\141\x74\x69\x6f\156", "\x70\x6f\163\x74\137\x73\x68\x61\x31\x5f\x70\141\x73\x73\167\x6f\x72\144\x5f\155\x69\x67\162\141\164\x69\x6f\156\137\163\x75\143\x63\145\x73\x73\x66\165\154"]); goto p5cKD; hMXmR: goto WuN0X; goto KX9w8; O7wPy: $salt = substr($hashed_password_db, 0, $salt_length); goto lTINn; EVF82: $salt_db = $query->row(); goto CYuzm; chzUL: return FALSE; goto Yk7S0; nYpDN: f7211: goto DJr26; qgVtC: $this->trigger_events("\160\x72\145\137\x73\x68\x61\x31\x5f\160\141\163\x73\167\157\x72\x64\137\x6d\x69\147\162\141\x74\151\157\156"); goto ZluRw; KX9w8: krwER: goto rjsO0; gio9F: return FALSE; goto PKrLP; nl_Zb: $salt_length = $this->config->item("\x73\x61\x6c\164\137\x6c\145\156\x67\164\x68", "\151\x6f\x6e\137\x61\x75\164\x68"); goto vceDI; KAIIN: $this->trigger_events(["\x70\157\x73\x74\x5f\x73\150\141\x31\137\x70\x61\163\x73\x77\x6f\162\x64\x5f\155\151\x67\x72\141\164\x69\157\x6e", "\x70\x6f\163\x74\137\163\x68\141\61\x5f\160\141\x73\163\x77\x6f\x72\x64\x5f\x6d\151\147\x72\x61\164\151\x6f\156\x5f\165\156\x73\x75\143\143\145\x73\x73\x66\165\x6c"]); goto hMXmR; qzrTa: if ($result) { goto krwER; } goto KAIIN; Yk7S0: goto jiywA; goto nYpDN; lBg0s: if ($hashed_password === $hashed_password_db) { goto f7211; } goto AJc0V; QI01L: TTcVD: goto Xl1EC; p5cKD: WuN0X: goto vQBXD; q2Oki: goto QYXQS; goto sjVl6; AZSG_: $query = $this->db->select("\163\141\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\162\163"]); goto EVF82; DJr26: $result = $this->_set_password_db($identity, $password); goto qzrTa; xDi1u: } }
