<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\105\x50\101\x54\110") or exit("\116\x6f\x20\144\151\x72\x65\x63\164\x20\x73\x63\162\151\160\x74\40\x61\143\143\x65\x73\x73\x20\x61\x6c\154\x6f\x77\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto u8yUR; u8yUR: $this->config->load("\x69\157\x6e\137\x61\x75\164\x68", TRUE); goto Ku0_y; xvoWr: U5XyM: goto UGE1M; chBz9: $this->trigger_events("\x6d\157\144\x65\x6c\137\143\x6f\156\163\164\162\165\x63\x74\x6f\x72"); goto CC2vo; O_ptE: $this->message_start_delimiter = $this->config->item("\x6d\145\x73\163\x61\x67\145\x5f\x73\x74\x61\x72\x74\137\144\145\154\151\155\151\164\x65\x72", "\x69\157\x6e\137\141\x75\164\150"); goto OLqBF; Ku0_y: $this->load->helper("\x63\157\x6f\153\151\x65"); goto MdVGY; cCTr2: $this->hash_method = $this->config->item("\x68\141\163\x68\137\x6d\145\164\x68\157\144", "\x69\x6f\x6e\137\141\x75\164\150"); goto mbWZc; u0BrK: $error_prefix = $form_validation_class->getProperty("\137\145\x72\x72\157\162\137\x70\162\145\146\x69\170"); goto ZOnFI; GHgbL: $this->error_start_delimiter = $this->config->item("\145\x72\162\x6f\x72\x5f\163\x74\141\x72\164\137\x64\x65\154\x69\x6d\x69\164\x65\x72", "\x69\157\x6e\137\x61\165\x74\x68"); goto QdGGm; OLqBF: $this->message_end_delimiter = $this->config->item("\155\x65\x73\x73\x61\x67\145\137\x65\x6e\x64\137\x64\x65\154\151\155\x69\164\145\162", "\x69\x6f\156\137\141\165\x74\x68"); goto GHgbL; OSDU9: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto L5lWW; MdVGY: $this->load->helper("\144\141\x74\145"); goto oz0VL; JlpKT: $CI =& get_instance(); goto H8DZo; Y_5lg: $this->load->library("\x66\x6f\x72\155\x5f\x76\141\154\x69\x64\x61\x74\x69\157\156"); goto QOqx8; Oj8XJ: $this->join = $this->config->item("\x6a\157\151\156", "\151\157\156\x5f\141\x75\164\x68"); goto cCTr2; VxlH5: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto DlsPt; qKQP7: if ($delimiters_source === "\146\x6f\x72\x6d\137\166\x61\154\151\144\x61\x74\151\157\x6e") { goto MEs2D; } goto O_ptE; rwqIW: goto gU3lL; goto YIguG; QdGGm: $this->error_end_delimiter = $this->config->item("\145\162\x72\x6f\x72\x5f\145\156\144\x5f\x64\x65\x6c\x69\x6d\x69\164\145\162", "\151\x6f\156\137\141\x75\x74\x68"); goto rwqIW; tIClC: $this->identity_column = $this->config->item("\151\x64\145\156\164\x69\164\171", "\x69\x6f\x6e\137\141\x75\x74\150"); goto Oj8XJ; TKvBL: $this->_ion_hooks = new stdClass(); goto chBz9; bkpCn: if (empty($group_name)) { goto a592k; } goto rkfHo; mvXLD: gU3lL: goto TKvBL; Frf55: $delimiters_source = $this->config->item("\x64\x65\154\151\x6d\x69\164\x65\162\163\137\163\157\165\x72\x63\145", "\151\157\x6e\x5f\x61\165\x74\150"); goto qKQP7; YIguG: MEs2D: goto Y_5lg; oz0VL: $this->lang->load("\x69\x6f\x6e\x5f\141\165\x74\150"); goto ReBXJ; Oabiz: a592k: goto JlpKT; DlsPt: $this->message_start_delimiter = $this->error_start_delimiter; goto m6r1c; rkfHo: $this->db = $this->load->database($group_name, TRUE, TRUE); goto aMIve; H8DZo: $this->db = $CI->db; goto xvoWr; UGE1M: $this->tables = $this->config->item("\164\141\x62\x6c\x65\163", "\x69\x6f\x6e\x5f\141\x75\164\x68"); goto tIClC; ReBXJ: $group_name = $this->config->item("\x64\141\x74\x61\142\141\163\145\x5f\147\162\157\x75\x70\x5f\x6e\x61\155\145", "\151\x6f\x6e\x5f\x61\165\x74\150"); goto bkpCn; aMIve: goto U5XyM; goto Oabiz; ZOnFI: $error_prefix->setAccessible(TRUE); goto VxlH5; mbWZc: $this->messages = []; goto UH3JY; UH3JY: $this->errors = []; goto Frf55; L5lWW: $this->message_end_delimiter = $this->error_end_delimiter; goto mvXLD; QOqx8: $form_validation_class = new ReflectionClass("\x43\x49\137\x46\157\x72\155\x5f\x76\141\154\x69\144\x61\x74\151\157\x6e"); goto u0BrK; m6r1c: $error_suffix = $form_validation_class->getProperty("\x5f\x65\162\x72\x6f\162\137\163\165\x66\x66\151\x78"); goto RKXaO; RKXaO: $error_suffix->setAccessible(TRUE); goto OSDU9; CC2vo: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto h0h0T; ZDYgx: nk1zM: goto w5YPi; IoKj7: return FALSE; goto J8WIC; lT1Wv: if (!($algo !== FALSE && $params !== FALSE)) { goto nk1zM; } goto P6Ovg; w5YPi: return FALSE; goto Dc14e; E68Tp: $algo = $this->_get_hash_algo(); goto YupId; h0h0T: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto A18OM; } goto IoKj7; P6Ovg: return password_hash($password, $algo, $params); goto ZDYgx; J8WIC: A18OM: goto E68Tp; YupId: $params = $this->_get_hash_parameters($identity); goto lT1Wv; Dc14e: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto upK2w; upK2w: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto Nvgpk; } goto rToUZ; yq7K0: FKg2M: goto yppyI; yppyI: return password_verify($password, $hash_password_db); goto PX6yA; PX6yA: FC3Qj: goto JMURH; NCNjr: Nvgpk: goto uFgeK; D2DxD: goto FC3Qj; goto yq7K0; rToUZ: return FALSE; goto NCNjr; uFgeK: if (strpos($hash_password_db, "\44") === 0) { goto FKg2M; } goto IWCpK; IWCpK: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto D2DxD; JMURH: } public function rehash_password_if_needed($hash, $identity, $password) { goto KWTA5; Mp37s: HGCar: goto eKj6E; KWTA5: $algo = $this->_get_hash_algo(); goto ISNu8; dr8MP: if ($this->_set_password_db($identity, $password)) { goto QQjGm; } goto e7EY7; NJCCD: QQjGm: goto YZnn4; ISNu8: $params = $this->_get_hash_parameters($identity); goto d0qYO; Vdt17: if (!password_needs_rehash($hash, $algo, $params)) { goto HGCar; } goto dr8MP; e7EY7: $this->trigger_events(["\162\x65\150\141\x73\x68\137\x70\x61\163\x73\x77\157\x72\144", "\x72\x65\x68\x61\x73\150\137\x70\x61\163\x73\167\x6f\162\144\137\x75\156\x73\165\143\143\145\x73\x73\x66\x75\x6c"]); goto TTleE; d0qYO: if (!($algo !== FALSE && $params !== FALSE)) { goto WtO8s; } goto Vdt17; eKj6E: WtO8s: goto WjKxQ; TTleE: goto q0RwP; goto NJCCD; ZzgyQ: q0RwP: goto Mp37s; YZnn4: $this->trigger_events(["\x72\x65\x68\141\x73\150\137\160\x61\x73\x73\x77\x6f\162\144", "\162\145\x68\141\163\x68\x5f\x70\141\163\x73\x77\157\162\x64\137\163\x75\x63\143\145\163\163\x66\165\154"]); goto ZzgyQ; WjKxQ: } public function get_user_by_activation_code($user_code) { goto RYCsC; FrD3y: return $user; goto u0VrT; jzt1f: ViE0w: goto iPO2t; u0VrT: uTb1p: goto jzt1f; wzoWm: if (!$this->verify_password($token->validator, $user->activation_code)) { goto uTb1p; } goto FrD3y; KQ1gk: $user = $this->where("\x61\x63\164\x69\x76\141\x74\151\x6f\x6e\x5f\163\145\154\x65\143\x74\157\162", $token->selector)->users()->row(); goto w4B2n; w4B2n: if (!$user) { goto ViE0w; } goto wzoWm; iPO2t: return FALSE; goto X8ei6; RYCsC: $token = $this->_retrieve_selector_validator_couple($user_code); goto KQ1gk; X8ei6: } public function activate($id, $code = FALSE) { goto dalUT; LeEI0: $this->trigger_events(["\x70\x6f\163\164\x5f\141\143\x74\151\x76\141\x74\x65", "\160\x6f\x73\164\x5f\x61\143\164\x69\x76\141\x74\x65\137\x73\165\x63\x63\145\x73\x73\146\165\x6c"]); goto lRqhK; YIIfa: $data = ["\141\143\164\151\x76\x61\x74\x69\x6f\x6e\x5f\163\145\x6c\145\143\x74\x6f\x72" => NULL, "\141\143\x74\151\166\141\x74\151\157\156\137\x63\157\x64\x65" => NULL, "\x61\x63\x74\151\x76\x65" => 1]; goto l3Wwy; WdH_Z: if (!($code !== FALSE)) { goto Y5BKN; } goto lngqq; pqvGp: return FALSE; goto agETp; XWOX5: KLKpf: goto A2ert; SmNlt: if (!($code === FALSE || $user && $user->id === $id)) { goto kzOmo; } goto YIIfa; lngqq: $user = $this->get_user_by_activation_code($code); goto t6jIS; zSazc: $this->set_error("\x61\143\164\x69\166\x61\x74\x65\x5f\165\x6e\163\x75\x63\x63\145\x73\163\x66\x75\x6c"); goto pqvGp; A2ert: kzOmo: goto ysvZx; dalUT: $this->trigger_events("\x70\x72\145\x5f\x61\143\164\151\166\x61\x74\145"); goto WdH_Z; ysvZx: $this->trigger_events(["\x70\157\163\x74\x5f\x61\143\164\151\x76\141\164\145", "\x70\x6f\163\x74\x5f\x61\143\164\x69\166\x61\x74\145\137\x75\156\x73\x75\x63\143\x65\x73\x73\x66\165\154"]); goto zSazc; t6jIS: Y5BKN: goto SmNlt; l3Wwy: $this->trigger_events("\x65\x78\x74\162\141\137\167\150\x65\x72\x65"); goto a6sj6; lRqhK: $this->set_message("\141\143\164\x69\166\x61\164\x65\137\163\x75\x63\143\x65\163\x73\146\x75\x6c"); goto hKiJI; a6sj6: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, ["\151\144" => $id]); goto QDPUS; QDPUS: if (!($this->db->affected_rows() === 1)) { goto KLKpf; } goto LeEI0; hKiJI: return TRUE; goto XWOX5; agETp: } public function deactivate($id = NULL) { goto Jodu7; hrQ2j: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, ["\x69\144" => $id]); goto JAV0k; Y5FUC: $this->set_error("\x64\145\141\143\x74\x69\166\x61\164\x65\137\x75\x6e\163\165\x63\x63\145\163\x73\146\165\154"); goto TdG1u; Eiev3: $this->set_error("\144\145\x61\143\164\151\166\141\164\x65\137\x75\156\163\x75\143\x63\145\163\x73\x66\x75\x6c"); goto w2QK1; G2ahz: goto XaOVC; goto hCYYy; jmKSV: if ($return) { goto FfoRk; } goto Eiev3; w2QK1: goto zwZ6h; goto Jn_Dg; JAV0k: $return = $this->db->affected_rows() == 1; goto jmKSV; TdG1u: return FALSE; goto ywyQG; EPnDK: zwZ6h: goto vvEkT; dF97Q: $token = $this->_generate_selector_validator_couple(20, 40); goto sxE7Q; sxE7Q: $this->activation_code = $token->user_code; goto B9xm0; mCrls: return FALSE; goto HOjcr; ywyQG: XaOVC: goto dF97Q; vvEkT: return $return; goto e5VH6; na82g: $this->set_error("\x64\145\141\x63\164\x69\166\x61\x74\x65\x5f\143\x75\x72\x72\x65\x6e\164\x5f\x75\163\145\162\137\x75\156\163\x75\x63\x63\145\x73\x73\x66\x75\154"); goto mCrls; Jn_Dg: FfoRk: goto GGtR4; Jodu7: $this->trigger_events("\x64\x65\x61\143\x74\151\x76\141\164\145"); goto rs31V; hCYYy: Y327I: goto Y5FUC; GGtR4: $this->set_message("\144\x65\141\x63\164\x69\x76\x61\x74\x65\137\x73\165\143\x63\x65\163\x73\x66\x75\x6c"); goto EPnDK; B9xm0: $data = ["\141\x63\x74\151\x76\x61\x74\x69\x6f\156\x5f\x73\145\154\x65\x63\x74\157\162" => $token->selector, "\x61\143\x74\151\166\x61\164\151\x6f\x6e\137\x63\157\x64\x65" => $token->validator_hashed, "\x61\143\164\x69\x76\145" => 0]; goto TdWr8; HOjcr: HwTv6: goto G2ahz; UiW2j: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto HwTv6; } goto na82g; rs31V: if (!isset($id)) { goto Y327I; } goto UiW2j; TdWr8: $this->trigger_events("\145\x78\164\162\141\137\167\x68\145\162\145"); goto hrQ2j; e5VH6: } public function clear_forgotten_password_code($identity) { goto Vsc6v; PJRX1: $this->db->update($this->tables["\x75\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto AfUfH; AfUfH: return TRUE; goto aRTJp; GNsBG: return FALSE; goto wtwNH; wtwNH: PZD6b: goto acA8o; acA8o: $data = ["\146\x6f\x72\x67\x6f\164\164\145\x6e\x5f\x70\x61\163\x73\x77\157\x72\144\137\163\145\x6c\x65\x63\x74\157\x72" => NULL, "\x66\157\162\x67\x6f\164\164\x65\156\x5f\x70\141\163\163\x77\157\162\x64\x5f\143\x6f\x64\x65" => NULL, "\146\157\x72\147\x6f\x74\x74\145\156\x5f\160\x61\163\163\167\157\162\144\137\x74\x69\x6d\145" => NULL]; goto PJRX1; Vsc6v: if (!empty($identity)) { goto PZD6b; } goto GNsBG; aRTJp: } public function clear_remember_code($identity) { goto Y9i2s; mm40N: $data = ["\x72\145\x6d\145\155\142\x65\162\137\x73\x65\x6c\x65\143\x74\157\x72" => NULL, "\x72\145\155\x65\155\x62\145\x72\137\143\x6f\x64\x65" => NULL]; goto cHj4B; Y9i2s: if (!empty($identity)) { goto KDD7t; } goto t62bF; bOeit: KDD7t: goto mm40N; TV0QB: return TRUE; goto JzzsE; t62bF: return FALSE; goto bOeit; cHj4B: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto TV0QB; JzzsE: } public function reset_password($identity, $new) { goto eQOqS; UdpFZ: return FALSE; goto w8Vzu; jgHDe: if ($this->identity_check($identity)) { goto aMnok; } goto dzkqb; jF_zl: U6Vc_: goto TQrqE; TQrqE: $this->trigger_events(["\x70\157\x73\164\137\x63\150\x61\x6e\147\145\137\160\x61\x73\x73\x77\x6f\x72\x64", "\x70\x6f\163\164\137\x63\x68\141\156\147\x65\x5f\160\x61\163\163\x77\x6f\162\x64\137\x73\x75\x63\143\x65\x73\163\146\x75\x6c"]); goto p3vtC; f5P2n: goto it3lm; goto jF_zl; w8Vzu: aMnok: goto wfdk1; Zy_fa: return $return; goto nK3oX; dzkqb: $this->trigger_events(["\160\157\163\x74\x5f\143\150\141\156\147\x65\x5f\160\141\163\163\167\x6f\x72\144", "\160\157\163\164\x5f\143\x68\141\x6e\147\145\137\160\x61\x73\163\167\x6f\162\144\x5f\165\x6e\x73\x75\x63\x63\145\163\x73\146\x75\x6c"]); goto UdpFZ; eQOqS: $this->trigger_events("\x70\162\x65\x5f\143\x68\x61\x6e\x67\145\137\160\x61\x73\163\167\x6f\x72\x64"); goto jgHDe; X4uZG: $this->set_error("\x70\x61\163\x73\167\157\162\x64\x5f\x63\x68\x61\156\147\x65\137\x75\156\x73\165\143\x63\x65\x73\163\146\165\x6c"); goto f5P2n; wfdk1: $return = $this->_set_password_db($identity, $new); goto OFl31; zAEcr: $this->trigger_events(["\x70\x6f\163\164\137\143\150\x61\156\147\x65\137\160\141\x73\x73\167\157\x72\144", "\x70\157\163\x74\137\x63\150\x61\x6e\x67\145\x5f\x70\x61\x73\x73\167\157\162\x64\x5f\x75\156\163\165\x63\143\x65\x73\163\146\165\154"]); goto X4uZG; p3vtC: $this->set_message("\x70\141\163\163\x77\x6f\162\x64\x5f\x63\150\141\x6e\x67\145\137\163\165\143\143\145\163\x73\x66\x75\x6c"); goto MhZeZ; MhZeZ: it3lm: goto Zy_fa; OFl31: if ($return) { goto U6Vc_; } goto zAEcr; nK3oX: } public function change_password($identity, $old, $new) { goto arnEF; JdLZ7: if ($result) { goto WHKIo; } goto pJhEE; IKbMR: $result = $this->_set_password_db($identity, $new); goto JdLZ7; YL1vh: $query = $this->db->select("\x69\144\54\x20\160\x61\x73\163\167\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\145\x73\143")->get($this->tables["\165\163\145\x72\x73"]); goto Sfm4a; TGv2W: $this->trigger_events(["\x70\157\163\x74\137\143\150\141\156\147\x65\x5f\160\x61\x73\x73\167\157\162\x64", "\x70\157\x73\x74\x5f\143\x68\141\x6e\x67\145\x5f\160\x61\x73\163\167\x6f\162\144\137\x73\x75\x63\x63\145\x73\163\146\x75\154"]); goto qQkdL; UpBlA: nH9LL: goto kk7qs; nl3u5: if (!$this->verify_password($old, $user->password, $identity)) { goto isTj3; } goto IKbMR; LgJti: isTj3: goto sThE9; HM5Yg: $this->trigger_events(["\x70\157\163\164\x5f\143\x68\x61\x6e\x67\145\137\160\141\163\163\167\157\x72\144", "\x70\157\x73\x74\137\x63\150\x61\156\147\x65\x5f\x70\141\x73\x73\x77\157\162\x64\x5f\165\x6e\163\x75\143\143\x65\163\163\146\x75\x6c"]); goto BW5mS; z8pSb: return FALSE; goto k9HxM; pJhEE: $this->trigger_events(["\160\x6f\163\164\x5f\143\x68\141\156\147\x65\x5f\160\x61\x73\163\x77\x6f\x72\x64", "\160\x6f\x73\164\137\x63\150\141\x6e\x67\145\x5f\x70\141\163\163\167\x6f\x72\x64\x5f\165\156\163\165\143\x63\x65\163\x73\x66\x75\x6c"]); goto DgONq; qQkdL: $this->set_message("\x70\141\x73\x73\167\x6f\162\144\x5f\143\150\141\x6e\x67\145\137\163\165\x63\x63\x65\x73\x73\146\x75\154"); goto UpBlA; arnEF: $this->trigger_events("\x70\162\x65\137\143\150\141\x6e\147\x65\137\x70\x61\163\163\x77\x6f\x72\x64"); goto NYcCh; cXhJQ: WHKIo: goto TGv2W; DgONq: $this->set_error("\x70\x61\163\x73\x77\157\x72\144\137\x63\150\x61\x6e\x67\x65\137\165\156\x73\x75\x63\143\145\x73\163\x66\x75\x6c"); goto otBUV; TzAnF: eHoOa: goto TWbki; BW5mS: $this->set_error("\160\x61\163\x73\167\157\162\x64\x5f\x63\150\141\156\x67\x65\137\x75\156\x73\x75\143\x63\145\x73\x73\146\x75\x6c"); goto O66ke; TWbki: $user = $query->row(); goto nl3u5; Sfm4a: if (!($query->num_rows() !== 1)) { goto eHoOa; } goto HM5Yg; NYcCh: $this->trigger_events("\145\x78\164\x72\x61\137\167\x68\x65\162\x65"); goto YL1vh; sThE9: $this->set_error("\x70\x61\x73\x73\x77\157\x72\x64\137\x63\x68\141\x6e\147\145\x5f\165\x6e\x73\x75\143\143\145\x73\163\146\165\x6c"); goto z8pSb; O66ke: return FALSE; goto TzAnF; otBUV: goto nH9LL; goto cXhJQ; kk7qs: return $result; goto LgJti; k9HxM: } public function username_check($username = '') { goto GuB0w; g6k13: return FALSE; goto aFq4q; aFq4q: QUDjY: goto wxMVS; E9nOA: if (!empty($username)) { goto QUDjY; } goto g6k13; wxMVS: $this->trigger_events("\145\x78\164\162\x61\137\x77\150\145\162\x65"); goto oXLvl; oXLvl: return $this->db->where("\165\x73\145\162\156\141\x6d\145", $username)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\163"]) > 0; goto IXatM; GuB0w: $this->trigger_events("\x75\163\x65\162\x6e\141\155\145\x5f\143\150\145\x63\153"); goto E9nOA; IXatM: } public function email_check($email = '') { goto X6112; PHB9Z: $this->trigger_events("\x65\x78\164\x72\x61\x5f\167\150\x65\162\145"); goto muxuf; X6112: $this->trigger_events("\145\x6d\141\151\154\137\143\x68\145\143\x6b"); goto RuOQi; uOLDP: return FALSE; goto fCw10; muxuf: return $this->db->where("\x65\155\141\x69\154", $email)->limit(1)->count_all_results($this->tables["\x75\163\145\x72\x73"]) > 0; goto d0DK_; fCw10: fXrgQ: goto PHB9Z; RuOQi: if (!empty($email)) { goto fXrgQ; } goto uOLDP; d0DK_: } public function identity_check($identity = '') { goto CYSga; yNv18: u9L2z: goto A4g1i; CYSga: $this->trigger_events("\x69\x64\145\x6e\x74\151\x74\171\137\143\x68\145\143\x6b"); goto W2ic5; A4g1i: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\x65\162\x73"]) > 0; goto j6vwy; SO3C0: return FALSE; goto yNv18; W2ic5: if (!empty($identity)) { goto u9L2z; } goto SO3C0; j6vwy: } public function get_user_id_from_identity($identity = '') { goto Cu1Gf; yJyNc: $user = $query->row(); goto HsPaU; d4w_q: CgU57: goto BzmFz; ri0Cn: return FALSE; goto d4w_q; KI0QA: if (!($query->num_rows() !== 1)) { goto F91KU; } goto uPCtj; Cu1Gf: if (!empty($identity)) { goto CgU57; } goto ri0Cn; nClU8: F91KU: goto yJyNc; HsPaU: return $user->id; goto w_brK; BzmFz: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\145\162\163"]); goto KI0QA; uPCtj: return FALSE; goto nClU8; w_brK: } public function forgotten_password($identity) { goto exwKS; b45tp: if ($this->db->affected_rows() === 1) { goto bB2aP; } goto tgrz1; vajlU: goto JQhVg; goto G_N8Q; igmIJ: xn1Ba: goto iH1f5; tgrz1: $this->trigger_events(["\160\x6f\163\164\137\146\157\x72\x67\x6f\164\x74\145\156\x5f\x70\141\x73\x73\167\x6f\162\x64", "\x70\x6f\x73\164\137\146\x6f\x72\x67\x6f\164\164\145\156\137\x70\141\163\163\x77\157\x72\144\x5f\x75\x6e\x73\x75\x63\x63\145\163\163\146\165\154"]); goto e_i6W; Qm4w3: $this->trigger_events(["\160\157\x73\x74\137\146\157\x72\x67\157\164\164\x65\156\x5f\x70\141\163\x73\167\157\x72\144", "\x70\x6f\x73\x74\137\x66\157\162\147\x6f\x74\164\x65\156\x5f\x70\141\163\x73\x77\157\162\144\x5f\x75\x6e\163\x75\x63\143\x65\x73\x73\x66\x75\154"]); goto cfTg6; fFggX: JQhVg: goto uFDxZ; cfTg6: return FALSE; goto igmIJ; exwKS: if (!empty($identity)) { goto xn1Ba; } goto Qm4w3; D32xC: $this->trigger_events(["\x70\157\163\x74\x5f\146\157\162\147\x6f\x74\x74\x65\x6e\x5f\160\x61\x73\x73\x77\x6f\162\x64", "\160\x6f\x73\x74\137\146\157\162\147\x6f\164\x74\x65\156\x5f\x70\141\x73\x73\167\x6f\162\x64\x5f\163\165\143\x63\145\x73\163\x66\x75\154"]); goto Zrd10; G_N8Q: bB2aP: goto D32xC; CPTVP: $update = ["\146\x6f\162\x67\157\x74\164\x65\x6e\137\160\141\x73\163\167\x6f\162\x64\137\x73\145\x6c\x65\x63\x74\x6f\162" => $token->selector, "\x66\157\x72\147\157\164\164\x65\x6e\137\160\141\163\163\x77\157\x72\144\x5f\143\157\144\x65" => $token->validator_hashed, "\x66\157\162\147\x6f\x74\164\x65\x6e\137\x70\141\163\x73\x77\157\x72\144\x5f\164\x69\x6d\145" => time()]; goto WbCye; e_i6W: return FALSE; goto vajlU; Zrd10: return $token->user_code; goto fFggX; tjwje: $this->db->update($this->tables["\x75\163\x65\162\x73"], $update, [$this->identity_column => $identity]); goto b45tp; WbCye: $this->trigger_events("\x65\170\164\x72\x61\137\167\x68\x65\162\145"); goto tjwje; iH1f5: $token = $this->_generate_selector_validator_couple(20, 80); goto CPTVP; uFDxZ: } public function get_user_by_forgotten_password_code($user_code) { goto cEu00; XZ6gN: return FALSE; goto Ptleg; qOe29: $user = $this->where("\146\157\162\x67\x6f\x74\164\145\156\137\160\x61\x73\x73\167\x6f\x72\x64\x5f\x73\145\154\145\143\x74\157\x72", $token->selector)->users()->row(); goto aq3Fn; aq3Fn: if (!$user) { goto oecdn; } goto d3uI2; d3uI2: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto l1vvH; } goto bamlZ; QXtW7: oecdn: goto XZ6gN; cEu00: $token = $this->_retrieve_selector_validator_couple($user_code); goto qOe29; bamlZ: return $user; goto rcNk8; rcNk8: l1vvH: goto QXtW7; Ptleg: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto sSzVI; ntMDM: $default_group = $query; goto UBiih; wk1Px: $query = $this->db->get_where($this->tables["\x67\162\x6f\165\160\163"], ["\x6e\x61\x6d\x65" => $this->config->item("\x64\145\146\x61\x75\154\164\x5f\x67\162\x6f\165\160", "\x69\x6f\156\x5f\141\x75\x74\150")], 1)->row(); goto qMWgW; aY9Oy: if (!(isset($default_group->id) && empty($groups))) { goto HCL4L; } goto xjMJj; qsMW1: HCL4L: goto iukrO; UBiih: $ip_address = $this->input->ip_address(); goto Bid5O; xjMJj: $groups[] = $default_group->id; goto qsMW1; a6gJD: return FALSE; goto jDc53; gS7ye: return isset($id) ? $id : FALSE; goto d5JgK; jDc53: RoIPq: goto T4h7f; nPn32: foreach ($groups as $group) { $this->add_to_group($group, $id); vDQDn: } goto FqpJZ; jQi00: $this->trigger_events("\145\170\x74\162\141\137\x73\x65\164"); goto sYJBv; sDMJs: pWtGf: goto wk1Px; KAx39: $id = $this->db->insert_id($this->tables["\165\163\145\162\163"] . "\137\x69\x64\x5f\163\x65\x71"); goto aY9Oy; UBVvS: return FALSE; goto sDMJs; Bid5O: $password = $this->hash_password($password); goto vS9kY; zP3WH: $this->set_error("\141\143\x63\x6f\165\156\164\x5f\143\162\145\141\x74\151\157\x6e\x5f\165\156\x73\x75\143\143\x65\x73\x73\x66\x75\154"); goto B6cwv; FqpJZ: tIy01: goto VEYmA; zwXOr: $data = [$this->identity_column => $identity, "\x75\x73\145\162\x6e\x61\x6d\x65" => $identity, "\160\141\x73\x73\167\x6f\162\144" => $password, "\x65\x6d\141\x69\154" => $email, "\x69\160\x5f\x61\x64\144\x72\145\x73\x73" => $ip_address, "\x63\x72\145\x61\x74\145\144\137\157\156" => time(), "\x61\x63\164\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto bXuNs; vS9kY: if (!($password === FALSE)) { goto FH6Iy; } goto zP3WH; VEYmA: pqSeh: goto qNxhe; sYJBv: $this->db->insert($this->tables["\x75\x73\x65\x72\x73"], $user_data); goto KAx39; bXuNs: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\145\x72\x73"], $additional_data), $data); goto jQi00; S8wuQ: $manual_activation = $this->config->item("\x6d\x61\x6e\165\141\x6c\137\x61\x63\x74\151\x76\x61\x74\151\157\x6e", "\x69\157\156\137\141\x75\164\150"); goto ixCN8; Cae8I: $this->set_error("\x61\143\x63\157\165\x6e\x74\x5f\x63\162\x65\141\x74\x69\x6f\156\x5f\151\x6e\x76\x61\154\x69\x64\137\144\145\x66\141\165\x6c\164\137\147\162\x6f\165\x70"); goto IVYkG; zzICW: g4Cru: goto ntMDM; IVYkG: return FALSE; goto zzICW; B6cwv: return FALSE; goto YZYco; NfYCu: $this->set_error("\x61\143\x63\x6f\165\x6e\164\x5f\x63\162\145\x61\x74\x69\157\156\x5f\155\151\x73\163\x69\156\147\137\144\145\x66\141\x75\x6c\164\x5f\147\162\157\x75\x70"); goto a6gJD; YZYco: FH6Iy: goto zwXOr; TYxfd: if (!(!$this->config->item("\x64\145\x66\x61\x75\x6c\164\x5f\147\x72\x6f\x75\x70", "\x69\157\156\x5f\x61\x75\x74\150") && empty($groups))) { goto RoIPq; } goto NfYCu; ixCN8: if ($this->identity_check($identity)) { goto NqsBI; } goto TYxfd; T4h7f: goto pWtGf; goto c0aXg; qNxhe: $this->trigger_events("\x70\x6f\x73\164\x5f\162\x65\x67\151\163\x74\x65\x72"); goto gS7ye; iukrO: if (empty($groups)) { goto pqSeh; } goto nPn32; yT3Qy: $this->set_error("\141\143\143\x6f\x75\156\164\137\x63\x72\145\141\x74\x69\157\156\x5f\144\165\160\x6c\x69\x63\141\164\x65\137\x69\144\x65\x6e\164\x69\x74\171"); goto UBVvS; sSzVI: $this->trigger_events("\160\x72\x65\x5f\x72\x65\x67\x69\x73\164\145\162"); goto S8wuQ; c0aXg: NqsBI: goto yT3Qy; qMWgW: if (!(!isset($query->id) && empty($groups))) { goto g4Cru; } goto Cae8I; d5JgK: } public function login($identity, $password, $remember = FALSE) { goto ktyWm; XZdT0: $this->update_last_login($user->id); goto ASA2p; IkLzI: $user = $query->row(); goto AKJEA; aoc5s: $this->trigger_events("\x70\157\163\x74\137\154\157\147\151\156\137\165\x6e\163\x75\x63\143\x65\163\x73\146\x75\x6c"); goto xnHeJ; dP5lH: kX68y: goto N1FZl; vax20: G5Xf0: goto NnihN; U8Ndi: if (!(empty($identity) || empty($password))) { goto kX68y; } goto s1HjN; kxdJL: $this->trigger_events("\160\x6f\x73\x74\137\154\157\x67\151\156\x5f\165\156\x73\x75\x63\143\145\x73\163\146\x75\x6c"); goto TZQYr; GQs72: $query = $this->db->select($this->identity_column . "\x2c\40\145\x6d\x61\151\154\54\40\x69\x64\54\x20\x70\x61\x73\163\167\157\x72\x64\x2c\x20\x61\x63\x74\151\x76\145\x2c\x20\x6c\x61\x73\164\137\x6c\x6f\147\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\145\x73\x63")->get($this->tables["\x75\163\145\162\x73"]); goto q89SX; qC12w: $this->set_session($user); goto XZdT0; k5Kr9: if ($remember) { goto ZeobB; } goto l4Xtb; Kvkb3: return FALSE; goto hVdFK; cenDe: $this->set_message("\x6c\x6f\147\151\x6e\x5f\163\165\143\x63\x65\163\x73\146\x75\x6c"); goto F704h; ktyWm: $this->trigger_events("\160\162\145\x5f\154\157\x67\151\156"); goto U8Ndi; TZQYr: $this->set_error("\x6c\157\147\x69\156\137\x75\x6e\x73\165\x63\143\x65\x73\x73\x66\x75\154\x5f\156\157\164\x5f\141\143\x74\x69\x76\x65"); goto BLBG3; WNGpK: $this->trigger_events("\160\157\163\x74\x5f\154\x6f\x67\x69\156\x5f\165\x6e\163\165\x63\x63\145\163\x73\146\165\154"); goto P4O1X; IjJB6: $this->hash_password($password); goto Zsp1E; bhN9b: $this->remember_user($identity); goto eDs6_; BLBG3: return FALSE; goto Tu6eG; N1FZl: $this->trigger_events("\x65\x78\164\x72\x61\x5f\167\150\145\x72\x65"); goto GQs72; NnihN: if (!($query->num_rows() === 1)) { goto nMy0I; } goto IkLzI; hExW3: $this->rehash_password_if_needed($user->password, $identity, $password); goto RzV8w; eDs6_: xBPN4: goto P09uu; RzV8w: $this->session->sess_regenerate(FALSE); goto HlzkA; DpaT3: goto xBPN4; goto EIt2W; xnHeJ: $this->set_error("\154\157\x67\151\156\137\165\x6e\163\x75\x63\143\x65\163\163\x66\x75\x6c"); goto Kvkb3; Zsp1E: $this->increase_login_attempts($identity); goto aoc5s; UWOEn: if (!$this->config->item("\162\145\x6d\x65\x6d\142\x65\162\x5f\x75\x73\145\x72\163", "\x69\x6f\x6e\137\141\x75\164\150")) { goto FXNR2; } goto k5Kr9; s1HjN: $this->set_error("\154\x6f\147\151\156\137\x75\156\163\165\x63\143\145\163\163\x66\165\x6c"); goto HBqhP; BtgtX: if (!($user->active == 0)) { goto hTVzm; } goto kxdJL; HBqhP: return FALSE; goto dP5lH; P09uu: FXNR2: goto hExW3; ASA2p: $this->clear_login_attempts($identity); goto DVZx0; u9FQa: $this->hash_password($password); goto WNGpK; DVZx0: $this->clear_forgotten_password_code($identity); goto UWOEn; HlzkA: $this->trigger_events(["\x70\x6f\163\x74\x5f\154\x6f\x67\x69\156", "\x70\157\x73\x74\x5f\x6c\157\147\x69\156\x5f\163\x75\143\143\145\x73\x73\146\x75\x6c"]); goto cenDe; P4O1X: $this->set_error("\x6c\157\147\151\x6e\137\164\151\155\x65\157\x75\164"); goto RdxFz; F704h: return TRUE; goto ZgWRx; RdxFz: return FALSE; goto vax20; l4Xtb: $this->clear_remember_code($identity); goto DpaT3; Tu6eG: hTVzm: goto qC12w; ZgWRx: VCS21: goto yg4cZ; q89SX: if (!$this->is_max_login_attempts_exceeded($identity)) { goto G5Xf0; } goto u9FQa; EIt2W: ZeobB: goto bhN9b; AKJEA: if (!$this->verify_password($password, $user->password, $identity)) { goto VCS21; } goto BtgtX; yg4cZ: nMy0I: goto IjJB6; hVdFK: } public function recheck_session() { goto Op0wo; Y_K5s: goto jESt_; goto kIMnI; Hkazz: jESt_: goto ytRPf; X2QMF: $this->session->set_userdata("\x6c\141\163\164\x5f\x63\x68\145\143\153", time()); goto Hkazz; TDn_J: $last_login = $this->session->userdata("\154\141\x73\x74\x5f\143\x68\x65\143\153"); goto kHmy7; Y8Lrt: $identity = $this->config->item("\151\144\x65\x6e\x74\151\164\x79", "\x69\157\156\137\141\x75\164\x68"); goto NH1Fk; N8yag: AZNTW: goto PXDl6; Op0wo: $recheck = NULL !== $this->config->item("\x72\x65\143\x68\x65\143\153\137\x74\x69\x6d\145\x72", "\x69\x6f\x6e\x5f\141\165\x74\150") ? $this->config->item("\x72\x65\x63\x68\x65\x63\x6b\x5f\164\x69\155\x65\162", "\151\x6f\x6e\x5f\141\165\x74\x68") : 0; goto MUhfh; PXDl6: return (bool) $this->session->userdata("\x69\144\x65\156\164\x69\164\171"); goto jg4PF; kHmy7: if (!($last_login + $recheck < time())) { goto S7GNm; } goto LU4wc; HWiMe: return FALSE; goto Y_K5s; ytRPf: S7GNm: goto N8yag; MUhfh: if (!($recheck !== 0)) { goto AZNTW; } goto TDn_J; kIMnI: J_Jy3: goto X2QMF; Yh2l3: $this->trigger_events("\x6c\x6f\147\157\x75\164"); goto Y8Lrt; ug38W: if ($query->num_rows() === 1) { goto J_Jy3; } goto Yh2l3; LU4wc: $query = $this->db->select("\151\144")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\156\x74\151\164\x79"), "\x61\x63\x74\x69\166\145" => "\61"])->limit(1)->order_by("\x69\x64", "\x64\145\x73\143")->get($this->tables["\165\x73\x65\162\163"]); goto ug38W; NH1Fk: $this->session->unset_userdata([$identity, "\151\x64", "\x75\x73\145\x72\137\151\144"]); goto HWiMe; jg4PF: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto i6hpm; i6hpm: if (!$this->config->item("\x74\x72\141\143\x6b\137\154\157\x67\151\x6e\137\x61\x74\164\145\x6d\160\164\x73", "\151\157\156\x5f\x61\x75\x74\x68")) { goto St8lH; } goto RjCMm; zXDcC: if (!($max_attempts > 0)) { goto l_d9p; } goto IUZLA; IUZLA: $attempts = $this->get_attempts_num($identity, $ip_address); goto vdNas; szseQ: return FALSE; goto ETHNr; RjCMm: $max_attempts = $this->config->item("\x6d\x61\x78\x69\155\x75\155\137\x6c\157\147\x69\156\137\141\x74\164\145\155\160\164\x73", "\x69\157\156\137\141\165\164\x68"); goto zXDcC; Ix2Kl: St8lH: goto szseQ; DGC6z: l_d9p: goto Ix2Kl; vdNas: return $attempts >= $max_attempts; goto DGC6z; ETHNr: } public function get_attempts_num($identity, $ip_address = NULL) { goto CWMil; FbmVw: $this->db->select("\61", FALSE); goto qG1Sf; u2Ktn: $qres = $this->db->get($this->tables["\154\157\x67\x69\156\137\141\x74\164\145\155\x70\164\163"]); goto qPPXP; CWMil: if (!$this->config->item("\164\162\141\143\153\x5f\154\x6f\x67\151\x6e\137\141\164\164\145\x6d\160\x74\163", "\151\157\x6e\x5f\x61\x75\164\150")) { goto OqRtD; } goto FbmVw; QGnR6: eSvhv: goto p_pN3; qPPXP: return $qres->num_rows(); goto tHBUW; N9vXS: return 0; goto zG5jL; p_pN3: $this->db->where("\164\x69\155\x65\40\76", time() - $this->config->item("\154\157\x63\153\157\165\x74\137\164\151\x6d\x65", "\x69\157\x6e\137\x61\x75\x74\150"), FALSE); goto u2Ktn; sxgOS: rQ2Ix: goto Z1OeV; Z1OeV: $this->db->where("\151\160\137\141\x64\x64\162\x65\x73\163", $ip_address); goto QGnR6; mOl9Z: if (!$this->config->item("\x74\162\141\x63\153\x5f\x6c\157\x67\x69\156\137\151\x70\137\141\144\x64\162\145\x73\x73", "\151\157\156\137\141\x75\164\x68")) { goto eSvhv; } goto Lh1b_; tHBUW: OqRtD: goto N9vXS; Lh1b_: if (isset($ip_address)) { goto rQ2Ix; } goto nq0nU; qG1Sf: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto mOl9Z; nq0nU: $ip_address = $this->input->ip_address(); goto sxgOS; zG5jL: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto HDWc0; HvR8A: $qres = $this->db->get($this->tables["\154\157\147\x69\x6e\137\141\164\164\x65\155\160\x74\x73"], 1); goto U3HYS; ABhth: $ip_address = $this->input->ip_address(); goto MkFdq; y01sp: $this->db->order_by("\151\x64", "\144\145\x73\143"); goto HvR8A; L9lTr: $this->db->select("\x74\x69\x6d\x65"); goto GGkcm; HDWc0: if (!$this->config->item("\x74\162\141\143\153\137\154\x6f\x67\151\156\x5f\x61\x74\164\x65\x6d\160\164\163", "\x69\x6f\x6e\137\141\165\164\x68")) { goto sdhMp; } goto L9lTr; U3HYS: if (!($qres->num_rows() > 0)) { goto h84Gp; } goto WSZEp; lBnrG: h84Gp: goto x4Ls3; MkFdq: NsBuK: goto ellUx; B9Pmd: R6K_1: goto y01sp; ZFL2V: if (isset($ip_address)) { goto NsBuK; } goto ABhth; BNOqY: return 0; goto PJfMS; GGkcm: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto QGRO7; WSZEp: return $qres->row()->time; goto lBnrG; x4Ls3: sdhMp: goto BNOqY; ellUx: $this->db->where("\151\160\137\x61\x64\x64\x72\145\163\163", $ip_address); goto B9Pmd; QGRO7: if (!$this->config->item("\164\162\141\x63\x6b\x5f\154\157\x67\x69\156\137\x69\160\137\141\x64\144\x72\145\163\x73", "\151\x6f\x6e\137\141\165\x74\150")) { goto R6K_1; } goto ZFL2V; PJfMS: } public function get_last_attempt_ip($identity) { goto jhDrw; gMz7P: if (!($qres->num_rows() > 0)) { goto F2AWo; } goto YAg7o; DpvSX: $this->db->select("\x69\x70\x5f\x61\x64\144\162\145\163\163"); goto pVdDb; U_BpN: $qres = $this->db->get($this->tables["\x6c\x6f\x67\151\x6e\137\141\164\x74\145\x6d\160\x74\x73"], 1); goto gMz7P; N7r2C: $this->db->order_by("\151\x64", "\x64\x65\x73\x63"); goto U_BpN; jhDrw: if (!($this->config->item("\x74\162\x61\x63\x6b\x5f\154\x6f\147\151\x6e\x5f\141\164\x74\145\155\160\164\x73", "\x69\157\x6e\137\141\x75\164\x68") && $this->config->item("\x74\x72\141\143\153\137\154\157\147\x69\x6e\x5f\151\x70\137\x61\x64\144\x72\x65\x73\x73", "\151\x6f\x6e\137\x61\165\164\150"))) { goto Zu720; } goto DpvSX; ofZC0: F2AWo: goto uZd3b; pVdDb: $this->db->where("\x6c\x6f\x67\x69\x6e", $identity); goto N7r2C; YAg7o: return $qres->row()->ip_address; goto ofZC0; u2kDK: return ''; goto SCGZU; uZd3b: Zu720: goto u2kDK; SCGZU: } public function increase_login_attempts($identity) { goto g0dUb; SsOw4: if (!$this->config->item("\x74\x72\141\143\153\137\154\x6f\x67\x69\156\137\151\160\x5f\141\144\x64\x72\x65\163\163", "\151\157\156\x5f\x61\x75\164\x68")) { goto SfZvJ; } goto VuxAB; VuxAB: $data["\x69\160\137\x61\x64\144\x72\x65\x73\163"] = $this->input->ip_address(); goto KamZp; WsXMh: $data = ["\x69\x70\137\141\144\144\x72\x65\163\x73" => '', "\154\157\147\x69\156" => $identity, "\164\151\155\145" => time()]; goto SsOw4; KamZp: SfZvJ: goto KF_ZZ; URVz8: dpUEl: goto xqTgP; xqTgP: return FALSE; goto PlktQ; KF_ZZ: return $this->db->insert($this->tables["\154\x6f\x67\x69\156\x5f\x61\x74\x74\145\x6d\160\164\x73"], $data); goto URVz8; g0dUb: if (!$this->config->item("\x74\162\141\x63\153\137\154\x6f\147\x69\156\137\141\x74\x74\145\x6d\x70\164\163", "\151\x6f\156\137\141\x75\164\150")) { goto dpUEl; } goto WsXMh; PlktQ: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto j6SgF; txzWQ: $ip_address = $this->input->ip_address(); goto irIw9; Wrqdu: ShBzQ: goto pBLn8; irIw9: f_tPH: goto nYYoU; GPp6T: $this->db->where("\154\157\147\151\x6e", $identity); goto lUVyV; lUVyV: if (!$this->config->item("\164\162\141\x63\x6b\137\154\157\x67\151\156\137\x69\160\x5f\141\x64\144\x72\145\163\163", "\x69\x6f\156\x5f\141\x75\164\x68")) { goto ShBzQ; } goto J26qh; J26qh: if (isset($ip_address)) { goto f_tPH; } goto txzWQ; lUVMt: return $this->db->delete($this->tables["\154\x6f\147\151\x6e\x5f\141\164\164\145\x6d\160\x74\x73"]); goto n3p0j; nYYoU: $this->db->where("\151\160\137\141\x64\144\162\145\163\163", $ip_address); goto Wrqdu; k9vRs: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\x63\153\x6f\x75\164\137\x74\x69\155\x65", "\x69\157\156\137\141\165\x74\x68")); goto GPp6T; qx7R4: return FALSE; goto UBkyd; j6SgF: if (!$this->config->item("\x74\162\x61\143\x6b\137\x6c\157\x67\x69\156\137\141\x74\x74\x65\155\160\x74\x73", "\151\x6f\156\137\x61\165\164\150")) { goto fkuzP; } goto k9vRs; pBLn8: $this->db->or_where("\164\x69\155\x65\x20\74", time() - $old_attempts_expire_period, FALSE); goto lUVMt; n3p0j: fkuzP: goto qx7R4; UBkyd: } public function limit($limit) { goto oYczm; T5DCN: return $this; goto Om41p; oYczm: $this->trigger_events("\x6c\x69\x6d\151\164"); goto ovFHK; ovFHK: $this->_ion_limit = $limit; goto T5DCN; Om41p: } public function offset($offset) { goto S10Oj; V595f: return $this; goto BQfmP; S10Oj: $this->trigger_events("\157\146\146\163\145\164"); goto xJa8F; xJa8F: $this->_ion_offset = $offset; goto V595f; BQfmP: } public function where($where, $value = NULL) { goto eYB61; kEHK6: return $this; goto NTatD; WcTlB: $where = [$where => $value]; goto vqI_y; Xjuot: array_push($this->_ion_where, $where); goto kEHK6; eYB61: $this->trigger_events("\167\x68\145\162\145"); goto NEuLt; NEuLt: if (is_array($where)) { goto ZdCgY; } goto WcTlB; vqI_y: ZdCgY: goto Xjuot; NTatD: } public function like($like, $value = NULL, $position = "\x62\157\x74\150") { goto afBQG; dcZ4g: array_push($this->_ion_like, ["\x6c\151\153\x65" => $like, "\x76\141\x6c\x75\x65" => $value, "\160\157\x73\x69\x74\x69\x6f\x6e" => $position]); goto VHMba; VHMba: return $this; goto OR3Fd; afBQG: $this->trigger_events("\154\x69\153\145"); goto dcZ4g; OR3Fd: } public function select($select) { goto bkHm5; CCPBR: $this->_ion_select[] = $select; goto n0B5P; bkHm5: $this->trigger_events("\x73\145\154\145\x63\164"); goto CCPBR; n0B5P: return $this; goto toGj_; toGj_: } public function order_by($by, $order = "\x64\145\x73\x63") { goto hocVc; ksSzw: return $this; goto HcRQK; bIsKi: $this->_ion_order_by = $by; goto pQcu9; hocVc: $this->trigger_events("\157\162\144\145\162\x5f\142\x79"); goto bIsKi; pQcu9: $this->_ion_order = $order; goto ksSzw; HcRQK: } public function row() { goto zk0SE; aZoUT: return $row; goto ssANo; zk0SE: $this->trigger_events("\162\x6f\x77"); goto gm0Lu; gm0Lu: $row = $this->response->row(); goto aZoUT; ssANo: } public function row_array() { goto uT5sB; R3P2r: return $row; goto EMdra; uT5sB: $this->trigger_events(["\x72\157\x77", "\x72\157\167\137\141\x72\162\141\171"]); goto qEbJ2; qEbJ2: $row = $this->response->row_array(); goto R3P2r; EMdra: } public function result() { goto Dw_h4; Dw_h4: $this->trigger_events("\162\x65\x73\165\154\164"); goto CBlav; CBlav: $result = $this->response->result(); goto VoIU2; VoIU2: return $result; goto zFeLm; zFeLm: } public function result_array() { goto fcdAV; OCIu6: $result = $this->response->result_array(); goto rui10; rui10: return $result; goto W8Hkp; fcdAV: $this->trigger_events(["\x72\x65\163\x75\154\x74", "\162\x65\x73\x75\x6c\164\x5f\141\x72\x72\x61\x79"]); goto OCIu6; W8Hkp: } public function num_rows() { goto PH3bx; zBRbZ: $result = $this->response->num_rows(); goto ndFkJ; PH3bx: $this->trigger_events(["\x6e\165\155\x5f\x72\157\167\163"]); goto zBRbZ; ndFkJ: return $result; goto gWtbg; gWtbg: } public function users($groups = NULL) { goto rYcwg; thm2K: foreach ($this->_ion_where as $where) { $this->db->where($where); pLitQ: } goto gmiAW; MLehq: RvrEW: goto NjESQ; w6EcU: $this->db->{$or_where_in}($this->tables["\165\x73\145\x72\x73\x5f\147\162\x6f\165\x70\x73"] . "\56" . $this->join["\147\162\x6f\165\160\x73"], $group_ids); goto j1FRM; fLveV: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto OBG1G; } goto EmUm6; ca18S: $groups = [$groups]; goto AhdG6; o5Ssn: iqQ2P: goto XCSwB; gmiAW: PJt3p: goto CdHw3; RGAbH: $group_names = []; goto DXFPv; TvJWv: if (!isset($this->_ion_limit)) { goto sKwgr; } goto Tnjmk; t3EEa: wPPrt: goto U35AQ; Zwn6T: orZlm: goto yxhMl; Vf0S6: goto dc3dk; goto o5Ssn; LJwpA: YbkDm: goto hEwWY; Tnjmk: $this->db->limit($this->_ion_limit); goto UAGh3; yfJcv: $this->_ion_select = []; goto Kg7Ug; dWP7W: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto wPPrt; } goto thm2K; bPWAx: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\x6b\145"], $like["\x76\x61\x6c\165\x65"], $like["\x70\x6f\x73\x69\164\151\157\156"]); speJt: } goto LJwpA; U35AQ: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto OrWU0; } goto bPWAx; n6nKm: if (!isset($groups)) { goto qVsdp; } goto yenIL; EmUm6: $this->db->select([$this->tables["\165\x73\x65\x72\x73"] . "\56\52", $this->tables["\165\163\x65\162\x73"] . "\56\x69\x64\40\x61\163\40\151\x64", $this->tables["\165\163\x65\x72\163"] . "\56\151\x64\x20\141\163\x20\x75\163\x65\x72\137\151\x64"]); goto eCOQe; NjESQ: $this->response = $this->db->get($this->tables["\x75\163\145\x72\163"]); goto wKHkw; k6nde: OBG1G: goto PpdZK; yfsLb: mFjUd: goto Tr0Tz; my_8J: if (!(isset($groups) && !empty($groups))) { goto orZlm; } goto NSX0B; hEwWY: $this->_ion_like = []; goto KLF30; wKHkw: return $this; goto uMBfF; TPRZU: $this->_ion_order = NULL; goto sXCz1; Tqqsy: $this->_ion_limit = NULL; goto vQ0VU; DXFPv: foreach ($groups as $group) { goto sFvL_; njvqZ: goto zYh1I; goto WbrNn; npE84: JEwOV: goto v8uTh; txJtY: $group_names[] = $group; goto njvqZ; Xt06A: zYh1I: goto npE84; WbrNn: R2xLS: goto ESH4O; sFvL_: if (is_numeric($group)) { goto R2xLS; } goto txJtY; ESH4O: $group_ids[] = $group; goto Xt06A; v8uTh: } goto hW8HB; eCOQe: goto hTZ5O; goto k6nde; TKfOG: if (empty($group_names)) { goto mFjUd; } goto eRGEW; NSX0B: $this->db->distinct(); goto ihcKo; h80TK: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto TPRZU; wcQUa: dc3dk: goto FyZyj; AhdG6: cp6vX: goto my_8J; OPDYA: qVsdp: goto BOmQL; KLF30: OrWU0: goto Sl7PX; hF2Y2: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\x72\137\167\150\x65\x72\x65\x5f\x69\x6e" : "\167\150\x65\162\145\x5f\x69\x6e"; goto TKfOG; j1FRM: SCOKI: goto OPDYA; Tr0Tz: if (empty($group_ids)) { goto SCOKI; } goto w6EcU; vQ0VU: $this->_ion_offset = NULL; goto wcQUa; bXOaT: sKwgr: goto Vf0S6; XCSwB: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto Tqqsy; yxhMl: $group_ids = []; goto RGAbH; UAGh3: $this->_ion_limit = NULL; goto bXOaT; rYcwg: $this->trigger_events("\165\x73\145\162\163"); goto fLveV; Kg7Ug: hTZ5O: goto n6nKm; CdHw3: $this->_ion_where = []; goto t3EEa; uI6Ea: yvfAX: goto yfJcv; hW8HB: xoUFN: goto hF2Y2; eRGEW: $this->db->join($this->tables["\x67\162\157\x75\160\x73"], $this->tables["\x75\x73\145\x72\x73\137\147\x72\x6f\165\x70\x73"] . "\56" . $this->join["\147\162\x6f\165\x70\163"] . "\x20\75\x20" . $this->tables["\147\x72\x6f\x75\160\x73"] . "\56\151\x64", "\151\156\156\x65\162"); goto wv1VJ; wv1VJ: $this->db->where_in($this->tables["\147\162\x6f\165\160\163"] . "\56\156\141\x6d\145", $group_names); goto yfsLb; Sl7PX: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto iqQ2P; } goto TvJWv; PpdZK: foreach ($this->_ion_select as $select) { $this->db->select($select); VVESY: } goto uI6Ea; FyZyj: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto RvrEW; } goto h80TK; sXCz1: $this->_ion_order_by = NULL; goto MLehq; BOmQL: $this->trigger_events("\145\x78\164\x72\x61\137\167\150\x65\x72\x65"); goto dWP7W; yenIL: if (is_array($groups)) { goto cp6vX; } goto ca18S; ihcKo: $this->db->join($this->tables["\x75\163\x65\162\x73\137\147\162\x6f\165\160\x73"], $this->tables["\x75\x73\145\162\163\137\x67\x72\157\165\x70\163"] . "\56" . $this->join["\165\x73\145\162\163"] . "\x3d" . $this->tables["\x75\x73\x65\x72\x73"] . "\56\151\144", "\151\x6e\x6e\145\162"); goto Zwn6T; uMBfF: } public function user($id = NULL) { goto bPz3B; KmuST: return $this; goto Zxi85; bPz3B: $this->trigger_events("\165\x73\145\x72"); goto yUo8M; XwXGV: $this->where($this->tables["\165\163\145\162\x73"] . "\x2e\151\144", $id); goto ConBI; Jydyn: $this->limit(1); goto hxCm8; hxCm8: $this->order_by($this->tables["\165\x73\x65\x72\x73"] . "\x2e\151\144", "\144\x65\x73\143"); goto XwXGV; ConBI: $this->users(); goto KmuST; yUo8M: $id = isset($id) ? $id : $this->session->userdata("\165\x73\145\162\x5f\151\144"); goto Jydyn; Zxi85: } public function get_users_groups($id = FALSE) { goto Q0rfW; BeQMB: $id || ($id = $this->session->userdata("\x75\163\145\162\137\x69\x64")); goto SnqiO; Q0rfW: $this->trigger_events("\x67\x65\164\137\165\163\145\x72\163\x5f\x67\162\x6f\165\160"); goto BeQMB; SnqiO: return $this->db->select($this->tables["\x75\x73\145\x72\x73\x5f\147\x72\157\165\160\163"] . "\56" . $this->join["\x67\162\157\165\x70\163"] . "\x20\x61\163\x20\x69\144\54\40" . $this->tables["\x67\162\x6f\x75\x70\163"] . "\x2e\156\141\155\145\54\40" . $this->tables["\x67\162\x6f\x75\160\x73"] . "\56\144\x65\163\143\x72\x69\x70\x74\x69\x6f\x6e")->where($this->tables["\165\x73\x65\x72\x73\x5f\x67\x72\157\165\x70\x73"] . "\x2e" . $this->join["\x75\x73\x65\x72\163"], $id)->join($this->tables["\x67\162\x6f\165\x70\163"], $this->tables["\x75\x73\145\162\x73\x5f\x67\162\157\165\160\163"] . "\x2e" . $this->join["\147\162\157\165\160\x73"] . "\75" . $this->tables["\147\162\x6f\x75\160\163"] . "\x2e\151\x64")->get($this->tables["\x75\163\145\162\163\x5f\x67\x72\157\x75\x70\163"]); goto y5mKR; y5mKR: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto fDIWN; NWq1t: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; YS8Zj: } goto bMzhg; SvuSO: if (isset($this->_cache_user_in_group[$id])) { goto XUUGq; } goto dViUZ; IjWW3: return $check_all; goto JYOsj; OrTH0: if (is_array($check_group)) { goto vpqur; } goto Z7mXg; bMzhg: Am6se: goto TtiK3; DKodg: uJFY8: goto IjWW3; Z7mXg: $check_group = [$check_group]; goto ZBneJ; ZBneJ: vpqur: goto SvuSO; iiOrI: goto YP_Xp; goto FfRfX; PcOvs: foreach ($check_group as $key => $value) { goto To2iH; lBTmI: return !$check_all; goto Vi8WC; To2iH: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto AUbjS; AUbjS: if (!(in_array($value, $groups) xor $check_all)) { goto hy30d; } goto lBTmI; hruOX: AxEc3: goto wQZyz; Vi8WC: hy30d: goto hruOX; wQZyz: } goto DKodg; dViUZ: $users_groups = $this->get_users_groups($id)->result(); goto teAaz; GothG: $id || ($id = $this->session->userdata("\165\x73\145\162\137\x69\144")); goto OrTH0; D21mZ: $groups_array = $this->_cache_user_in_group[$id]; goto T73sB; FfRfX: XUUGq: goto D21mZ; TtiK3: $this->_cache_user_in_group[$id] = $groups_array; goto iiOrI; T73sB: YP_Xp: goto PcOvs; fDIWN: $this->trigger_events("\151\x6e\x5f\147\x72\157\x75\x70"); goto GothG; teAaz: $groups_array = []; goto NWq1t; JYOsj: } public function add_to_group($group_ids, $user_id = FALSE) { goto GqcBc; WfYGA: Qoctu: goto qdQIq; qdQIq: $return = 0; goto VXhU_; GqcBc: $this->trigger_events("\141\144\144\137\164\x6f\137\x67\162\157\x75\160"); goto DN0SC; NnFwj: return $return; goto Z2bsk; VXhU_: foreach ($group_ids as $group_id) { goto jzYrI; aY627: DEPMk: goto IJQYR; Z67wM: if (isset($this->_cache_groups[$group_id])) { goto sW0cB; } goto JRzVE; IJQYR: FaulD: goto y0slm; E5hXE: $group_name = $this->_cache_groups[$group_id]; goto xXjiB; eY4N7: $group_name = $group[0]->name; goto kIUSS; jzYrI: if (!$this->db->insert($this->tables["\x75\163\x65\162\x73\x5f\147\x72\x6f\x75\x70\163"], [$this->join["\x67\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\x75\x73\145\x72\163"] => (float) $user_id])) { goto DEPMk; } goto Z67wM; kIUSS: $this->_cache_groups[$group_id] = $group_name; goto QQ_9s; xXjiB: QbCL1: goto N4C1h; N4C1h: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto oQasC; JRzVE: $group = $this->group($group_id)->result(); goto eY4N7; QQ_9s: goto QbCL1; goto osqNJ; osqNJ: sW0cB: goto E5hXE; oQasC: $return++; goto aY627; y0slm: } goto muLiY; muLiY: fNxHH: goto NnFwj; DN0SC: $user_id || ($user_id = $this->session->userdata("\165\163\145\x72\137\x69\144")); goto mvRVz; mvRVz: if (is_array($group_ids)) { goto Qoctu; } goto LEdM6; LEdM6: $group_ids = [$group_ids]; goto WfYGA; Z2bsk: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto Rpp0d; l4xel: wUwiZ: goto P7zZR; JaED3: if (!empty($user_id)) { goto DYsRF; } goto ovNKM; RTDVI: foreach ($group_ids as $group_id) { goto ZtrBa; JW83C: qk3g9: goto Xi9hR; aJHhw: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto tN4f6; } goto WAkzQ; TzBgI: tN4f6: goto JW83C; ZtrBa: $this->db->delete($this->tables["\165\163\145\x72\163\x5f\x67\162\x6f\165\160\163"], [$this->join["\x67\x72\x6f\x75\160\163"] => (float) $group_id, $this->join["\165\163\145\162\x73"] => (float) $user_id]); goto aJHhw; WAkzQ: unset($this->_cache_user_in_group[$user_id][$group_id]); goto TzBgI; Xi9hR: } goto cYvXn; GP0v8: return $return; goto vBjeF; c1wKK: if (!($return = $this->db->delete($this->tables["\x75\x73\x65\162\163\x5f\x67\162\x6f\x75\x70\163"], [$this->join["\165\x73\x65\x72\x73"] => (float) $user_id]))) { goto wUwiZ; } goto pXsox; pSHhM: $group_ids = [$group_ids]; goto Ia2n9; d4QFn: $return = TRUE; goto zZ1Bb; gmGZ0: if (is_array($group_ids)) { goto y2zdT; } goto pSHhM; Lu2PA: g5gYt: goto gmGZ0; Rpp0d: $this->trigger_events("\162\x65\155\x6f\x76\x65\x5f\x66\162\x6f\155\x5f\x67\162\157\165\x70"); goto JaED3; P7zZR: goto ct24o; goto Lu2PA; zZ1Bb: ct24o: goto GP0v8; cYvXn: YnJ7H: goto d4QFn; Ia2n9: y2zdT: goto RTDVI; ovNKM: return FALSE; goto lRvcY; rM5fX: if (!empty($group_ids)) { goto g5gYt; } goto c1wKK; pXsox: $this->_cache_user_in_group[$user_id] = []; goto l4xel; lRvcY: DYsRF: goto rM5fX; vBjeF: } public function groups() { goto e70t7; W8EtL: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto vJe28; lygmj: goto T1Qi0; goto qoUPV; f9grt: foreach ($this->_ion_where as $where) { $this->db->where($where); ZyfBs: } goto jmzmx; R6ZKV: $this->db->limit($this->_ion_limit); goto AJsiK; qoUPV: tWLVi: goto bJf_r; Kzo6o: $this->_ion_limit = NULL; goto wIOz4; bXWMj: $this->_ion_where = []; goto gZPOT; Pn3ki: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto bUYB5; } goto W8EtL; A81QS: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto DQEQX; } goto f9grt; unn0x: bUXOc: goto lygmj; E5qSF: $this->response = $this->db->get($this->tables["\147\x72\x6f\165\160\x73"]); goto HzZ_B; gZPOT: DQEQX: goto jiKZI; jmzmx: pCWem: goto bXWMj; HzZ_B: return $this; goto s8cdV; bJf_r: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto Kzo6o; wIOz4: $this->_ion_offset = NULL; goto eaAfN; eaAfN: T1Qi0: goto Pn3ki; bkIcb: if (!isset($this->_ion_limit)) { goto bUXOc; } goto R6ZKV; e70t7: $this->trigger_events("\147\162\x6f\x75\x70\x73"); goto A81QS; AJsiK: $this->_ion_limit = NULL; goto unn0x; vJe28: bUYB5: goto E5qSF; jiKZI: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto tWLVi; } goto bkIcb; s8cdV: } public function group($id = NULL) { goto Kfeo_; f3hR5: $this->order_by("\151\144", "\x64\145\x73\x63"); goto fnEhX; ZQDI7: mEDG6: goto tESND; Pxq5x: $this->where($this->tables["\147\x72\157\165\160\x73"] . "\x2e\151\144", $id); goto ZQDI7; Kfeo_: $this->trigger_events("\147\162\157\x75\160"); goto fNzwN; tESND: $this->limit(1); goto f3hR5; fNzwN: if (!isset($id)) { goto mEDG6; } goto Pxq5x; fnEhX: return $this->groups(); goto ZTgix; ZTgix: } public function update($id, array $data) { goto fOT17; z61TF: $this->set_error("\x75\x70\x64\x61\x74\145\x5f\x75\156\x73\x75\x63\143\145\163\163\146\165\154"); goto t2pWt; DBL0w: $this->db->trans_rollback(); goto Euscs; sQuGZ: return FALSE; goto t4NwM; HmE0p: x7yyM: goto IhY7x; SORVg: $this->set_error("\141\x63\143\157\x75\x6e\164\x5f\x63\162\145\141\164\151\x6f\156\x5f\144\x75\160\x6c\151\x63\x61\164\x65\137\x69\144\145\x6e\x74\151\164\171"); goto LMNb_; Tx_s_: if (!($this->db->trans_status() === FALSE)) { goto HZpuX; } goto DBL0w; qk0gf: $this->set_message("\x75\x70\x64\141\x74\x65\137\x73\165\143\143\145\x73\163\146\165\154"); goto do0p2; Z2LGd: if (!($data["\x70\x61\163\x73\167\157\162\144"] === FALSE)) { goto X21D_; } goto aBa1Q; Y6V3R: $this->trigger_events("\145\x78\x74\162\x61\137\167\x68\x65\162\x65"); goto pjy1E; t2pWt: return FALSE; goto bSd6r; KN64k: PNfmE: goto yqLHa; t4NwM: JOxkK: goto vkG27; aBa1Q: $this->db->trans_rollback(); goto rm8td; Tpm6u: $this->db->trans_commit(); goto nx9_q; fOT17: $this->trigger_events("\x70\162\x65\x5f\165\160\x64\x61\164\145\137\165\x73\x65\x72"); goto M_g51; qNPvV: goto jWIng; goto KN64k; do0p2: return TRUE; goto d08uv; vkG27: $data = $this->_filter_data($this->tables["\x75\163\x65\x72\163"], $data); goto E73x7; Beejc: HZpuX: goto Tpm6u; qEj2N: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto JOxkK; } goto G1xid; LMNb_: $this->trigger_events(["\160\157\163\x74\137\x75\160\x64\x61\x74\145\137\x75\163\145\x72", "\160\157\163\164\137\165\160\x64\141\164\145\x5f\165\x73\x65\162\x5f\x75\156\163\165\x63\x63\145\x73\x73\146\165\154"]); goto L2AQY; tJA3F: if (!array_key_exists("\x70\x61\163\x73\x77\157\162\x64", $data)) { goto x7yyM; } goto DyrId; PdMu1: return FALSE; goto Beejc; yc2oh: jWIng: goto HmE0p; G1xid: $this->db->trans_rollback(); goto SORVg; rm8td: $this->trigger_events(["\160\157\163\x74\137\x75\160\x64\141\164\x65\x5f\165\163\x65\x72", "\160\x6f\x73\x74\x5f\x75\x70\144\x61\x74\x65\x5f\165\163\145\162\137\165\156\x73\165\143\x63\145\163\x73\x66\x75\x6c"]); goto z61TF; YjAia: $this->db->trans_begin(); goto qEj2N; bSd6r: X21D_: goto yc2oh; yqLHa: $data["\x70\x61\x73\x73\x77\x6f\162\x64"] = $this->hash_password($data["\160\x61\x73\x73\167\157\162\x64"], $user->{$this->identity_column}); goto Z2LGd; L2AQY: $this->set_error("\x75\x70\x64\141\x74\x65\137\165\x6e\x73\x75\x63\x63\145\163\x73\x66\165\154"); goto sQuGZ; IhY7x: hoFvB: goto Y6V3R; pjy1E: $this->db->update($this->tables["\165\163\x65\162\163"], $data, ["\151\144" => $user->id]); goto Tx_s_; DTMDL: unset($data["\x70\141\x73\x73\x77\157\162\144"]); goto qNPvV; E73x7: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\163\167\x6f\x72\144", $data) || array_key_exists("\145\155\141\151\x6c", $data))) { goto hoFvB; } goto tJA3F; Euscs: $this->trigger_events(["\160\157\x73\x74\137\165\160\x64\141\x74\x65\137\x75\163\x65\162", "\160\157\x73\x74\137\165\x70\144\x61\164\x65\137\x75\163\145\162\x5f\165\x6e\x73\165\143\143\x65\163\x73\146\x75\x6c"]); goto WCABK; nx9_q: $this->trigger_events(["\160\157\163\x74\137\x75\x70\x64\x61\x74\145\x5f\165\163\145\162", "\x70\x6f\163\x74\137\165\x70\144\x61\x74\145\x5f\x75\x73\x65\162\137\163\x75\x63\x63\145\163\163\146\x75\154"]); goto qk0gf; M_g51: $user = $this->user($id)->row(); goto YjAia; WCABK: $this->set_error("\x75\160\x64\141\164\x65\137\165\156\163\165\x63\143\145\x73\163\x66\165\x6c"); goto PdMu1; DyrId: if (!empty($data["\x70\141\163\163\167\157\x72\x64"])) { goto PNfmE; } goto DTMDL; d08uv: } public function delete_user($id) { goto trfDQ; Xzvvj: $this->remove_from_group(NULL, $id); goto KRL0O; jMgNH: $this->db->trans_commit(); goto Z5tx_; YoF1d: $this->db->trans_begin(); goto Xzvvj; KRL0O: $this->db->delete($this->tables["\x75\163\x65\162\163"], ["\x69\x64" => $id]); goto KcdEV; zBeQJ: gsORb: goto jMgNH; P1JhK: return TRUE; goto KILJ6; xbGh1: $this->set_error("\x64\x65\x6c\145\164\145\x5f\x75\156\x73\x75\x63\143\x65\163\x73\x66\x75\x6c"); goto ZYCw4; IgzZ5: $this->set_message("\144\x65\154\145\164\145\x5f\x73\x75\143\x63\145\x73\163\146\165\x6c"); goto P1JhK; trfDQ: $this->trigger_events("\x70\x72\145\137\144\x65\x6c\x65\164\x65\137\165\x73\145\x72"); goto YoF1d; mYYGI: $this->db->trans_rollback(); goto kkQsP; Z5tx_: $this->trigger_events(["\160\x6f\163\164\137\144\145\154\145\x74\x65\x5f\x75\x73\145\162", "\160\157\x73\x74\x5f\144\x65\154\x65\x74\x65\x5f\x75\x73\145\162\137\163\165\143\x63\145\x73\163\146\x75\x6c"]); goto IgzZ5; ZYCw4: return FALSE; goto zBeQJ; KcdEV: if (!($this->db->trans_status() === FALSE)) { goto gsORb; } goto mYYGI; kkQsP: $this->trigger_events(["\x70\x6f\163\x74\137\x64\145\x6c\145\x74\145\137\165\x73\x65\x72", "\x70\157\163\164\x5f\144\x65\154\145\164\x65\x5f\165\163\x65\x72\x5f\165\156\x73\165\143\143\x65\163\x73\146\x75\x6c"]); goto xbGh1; KILJ6: } public function update_last_login($id) { goto soUOT; PNNn3: $this->load->helper("\144\x61\164\x65"); goto fcCWr; fcCWr: $this->trigger_events("\145\170\x74\162\141\137\167\x68\x65\162\x65"); goto m5nAN; m5nAN: $this->db->update($this->tables["\x75\163\145\x72\x73"], ["\x6c\141\x73\x74\x5f\154\x6f\147\x69\x6e" => time()], ["\151\144" => $id]); goto AnHg1; soUOT: $this->trigger_events("\x75\x70\144\141\x74\145\x5f\x6c\x61\x73\x74\x5f\x6c\x6f\147\151\156"); goto PNNn3; AnHg1: return $this->db->affected_rows() == 1; goto TtaAY; TtaAY: } public function set_lang($lang = "\145\156") { goto Oe8TT; S_rYm: cX6vN: goto ydfL5; Oe8TT: $this->trigger_events("\x73\x65\164\137\154\x61\x6e\147"); goto vVx1T; vVx1T: if ($this->config->item("\x75\x73\x65\162\x5f\x65\170\x70\x69\x72\x65", "\x69\x6f\156\x5f\141\165\164\150") === 0) { goto cX6vN; } goto hLPpY; Kref1: return TRUE; goto xLsV3; Jkko1: vZIQU: goto TSCc3; hLPpY: $expire = $this->config->item("\x75\163\145\162\x5f\145\x78\160\151\x72\x65", "\x69\x6f\x6e\x5f\141\165\x74\x68"); goto JntHm; TSCc3: set_cookie(["\156\141\x6d\145" => "\x6c\x61\x6e\x67\x5f\143\x6f\144\145", "\166\x61\x6c\x75\x65" => $lang, "\145\x78\160\151\162\145" => $expire]); goto Kref1; JntHm: goto vZIQU; goto S_rYm; ydfL5: $expire = self::MAX_COOKIE_LIFETIME; goto Jkko1; xLsV3: } public function set_session($user) { goto Txi5x; Txi5x: $this->trigger_events("\x70\162\145\137\x73\x65\164\137\163\145\163\163\151\157\156"); goto bl2Sl; sQ3w3: return TRUE; goto XcJkT; bl2Sl: $session_data = ["\151\x64\x65\x6e\x74\x69\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\x6d\x61\x69\x6c" => $user->email, "\x75\163\145\162\x5f\151\144" => $user->id, "\157\x6c\144\137\x6c\141\163\x74\x5f\x6c\x6f\147\151\x6e" => $user->last_login, "\x6c\141\163\164\x5f\x63\x68\145\143\153" => time()]; goto Gszdg; jZK6a: $this->trigger_events("\160\157\163\x74\x5f\163\x65\164\x5f\x73\145\x73\x73\x69\x6f\x6e"); goto sQ3w3; Gszdg: $this->session->set_userdata($session_data); goto jZK6a; XcJkT: } public function remember_user($identity) { goto lum72; wLq1R: return FALSE; goto C1GSm; KOS2Y: if ($identity) { goto XqsjJ; } goto wLq1R; efB3N: goto k4i9r; goto VnZIs; ouaI_: set_cookie(["\x6e\141\x6d\x65" => $this->config->item("\x72\x65\155\x65\x6d\x62\145\162\x5f\x63\x6f\x6f\153\x69\145\x5f\x6e\x61\x6d\x65", "\x69\157\x6e\x5f\141\165\164\x68"), "\x76\141\x6c\165\x65" => $token->user_code, "\145\x78\160\x69\162\x65" => $expire]); goto ZR_Ig; yQTdN: IZ5je: goto o3t26; tRTJd: k4i9r: goto ouaI_; AzgPu: if (!$token->validator_hashed) { goto mrjzY; } goto PjbW4; PjbW4: $this->db->update($this->tables["\x75\163\x65\x72\x73"], ["\x72\145\x6d\x65\x6d\142\x65\x72\137\x73\145\154\145\x63\164\157\162" => $token->selector, "\x72\x65\x6d\145\x6d\142\x65\162\137\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto UThHk; C1GSm: XqsjJ: goto JYraY; wSxf6: if ($this->config->item("\165\x73\x65\x72\137\x65\170\x70\151\162\x65", "\x69\x6f\156\137\x61\165\164\x68") === 0) { goto vH6sf; } goto MHQrz; YA0Un: return TRUE; goto yQTdN; UThHk: if (!($this->db->affected_rows() > -1)) { goto IZ5je; } goto wSxf6; km_Fv: return FALSE; goto HRB3w; lum72: $this->trigger_events("\x70\x72\x65\x5f\x72\145\155\x65\155\x62\145\162\x5f\165\x73\145\x72"); goto KOS2Y; i067J: $expire = self::MAX_COOKIE_LIFETIME; goto tRTJd; mRutv: $this->trigger_events(["\x70\x6f\x73\x74\137\x72\145\155\145\155\142\x65\162\x5f\x75\163\x65\x72", "\x72\x65\155\145\x6d\142\145\162\x5f\165\163\145\162\137\x75\156\163\x75\x63\143\x65\163\163\146\165\154"]); goto km_Fv; ZR_Ig: $this->trigger_events(["\160\x6f\163\164\137\162\x65\155\x65\155\142\x65\x72\x5f\x75\x73\x65\162", "\x72\x65\x6d\x65\x6d\x62\145\x72\x5f\x75\163\145\x72\x5f\163\x75\143\143\145\163\163\x66\x75\154"]); goto YA0Un; VnZIs: vH6sf: goto i067J; JYraY: $token = $this->_generate_selector_validator_couple(); goto AzgPu; o3t26: mrjzY: goto mRutv; MHQrz: $expire = $this->config->item("\165\x73\145\162\137\145\x78\160\x69\162\x65", "\151\157\156\x5f\x61\165\x74\150"); goto efB3N; HRB3w: } public function login_remembered_user() { goto ZVX3O; LOTIJ: EMmqB: goto R2rjZ; b2IIH: return FALSE; goto WMRQL; d0PAt: $user = $query->row(); goto l4ebD; p6veV: FFUJo: goto FkjMw; Wdmsv: $this->trigger_events(["\x70\157\163\x74\137\x6c\157\x67\151\x6e\x5f\162\x65\x6d\x65\155\x62\x65\x72\145\144\x5f\x75\163\x65\162", "\x70\157\163\x74\x5f\154\157\x67\151\x6e\137\x72\x65\155\145\x6d\142\145\x72\145\x64\x5f\x75\163\145\162\x5f\163\x75\x63\x63\145\x73\x73\146\165\x6c"]); goto aoYgD; R2rjZ: delete_cookie($this->config->item("\x72\x65\155\145\155\142\145\162\137\143\157\157\x6b\151\x65\137\156\141\x6d\145", "\x69\157\156\137\141\x75\x74\150")); goto gkrIE; GZTVz: $query = $this->db->select($this->identity_column . "\x2c\x20\151\x64\x2c\x20\x65\x6d\141\x69\x6c\x2c\40\162\145\x6d\x65\155\x62\x65\x72\x5f\x63\157\x64\145\x2c\x20\x6c\141\163\164\x5f\x6c\x6f\147\151\x6e")->where("\162\x65\x6d\145\155\x62\x65\x72\x5f\x73\x65\154\145\143\164\x6f\162", $token->selector)->where("\x61\x63\164\151\166\145", 1)->limit(1)->get($this->tables["\x75\x73\145\162\x73"]); goto FIEBK; j49xP: $this->clear_forgotten_password_code($identity); goto UCFdu; ZVX3O: $this->trigger_events("\160\162\x65\x5f\154\157\147\151\x6e\x5f\162\145\155\145\155\142\145\x72\x65\144\x5f\165\x73\x65\162"); goto NCI2Z; zaSd8: H79Zw: goto LOTIJ; rrcq4: $this->trigger_events(["\160\x6f\163\164\x5f\154\157\x67\x69\x6e\137\x72\145\155\145\155\x62\x65\162\145\x64\x5f\165\163\x65\x72", "\160\157\x73\164\x5f\154\157\147\151\156\137\162\145\x6d\x65\155\x62\145\x72\145\144\137\165\x73\x65\162\x5f\x75\156\x73\x75\143\x63\x65\x73\x73\x66\165\x6c"]); goto xdOUD; l4ebD: $identity = $user->{$this->identity_column}; goto pq6ik; gkrIE: $this->trigger_events(["\160\157\x73\x74\137\x6c\157\x67\x69\x6e\x5f\162\145\155\145\155\x62\145\x72\x65\144\x5f\165\163\x65\x72", "\x70\x6f\163\164\x5f\x6c\157\147\x69\x6e\137\x72\145\x6d\x65\x6d\x62\x65\162\145\x64\x5f\165\x73\145\162\137\165\x6e\163\x75\143\143\145\x73\x73\x66\165\154"]); goto b2IIH; pq6ik: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto H79Zw; } goto vTZ5E; vTZ5E: $this->update_last_login($user->id); goto nNkW6; NCI2Z: $remember_cookie = get_cookie($this->config->item("\x72\x65\x6d\145\x6d\x62\x65\x72\x5f\143\x6f\x6f\x6b\151\145\x5f\156\141\155\145", "\x69\x6f\x6e\137\141\165\x74\150")); goto Wux44; FIEBK: if (!($query->num_rows() === 1)) { goto EMmqB; } goto d0PAt; UCFdu: if (!$this->config->item("\x75\163\145\x72\x5f\145\170\x74\x65\x6e\x64\x5f\x6f\x6e\x5f\154\157\147\x69\156", "\151\x6f\156\137\141\x75\164\150")) { goto FFUJo; } goto cgllv; scZd8: NoLy0: goto Id0HG; cgllv: $this->remember_user($identity); goto p6veV; xdOUD: return FALSE; goto scZd8; QwSaR: if (!($token === FALSE)) { goto NoLy0; } goto rrcq4; nNkW6: $this->set_session($user); goto j49xP; FkjMw: $this->session->sess_regenerate(FALSE); goto Wdmsv; aoYgD: return TRUE; goto zaSd8; Wux44: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto QwSaR; Id0HG: $this->trigger_events("\x65\170\164\x72\141\x5f\x77\x68\x65\x72\145"); goto GZTVz; WMRQL: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto DN4tT; C0iA8: return FALSE; goto m_Dvu; OvgS8: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\165\160\163"], $additional_data), $data); goto J9GHD; U_aiQ: $data = ["\x6e\x61\x6d\x65" => $group_name, "\144\x65\163\143\162\151\x70\x74\151\x6f\156" => $group_description]; goto mrMbG; FUovg: $this->db->insert($this->tables["\147\162\x6f\165\160\x73"], $data); goto m9s1x; UzZym: return FALSE; goto VSSpH; OV7n5: $existing_group = $this->db->get_where($this->tables["\147\162\x6f\165\x70\163"], ["\156\x61\155\x65" => $group_name])->num_rows(); goto bXda4; JUmo6: $this->set_error("\147\162\157\x75\x70\x5f\x61\x6c\162\145\x61\144\x79\137\x65\170\x69\x73\164\163"); goto UzZym; FauOj: $this->set_error("\x67\162\x6f\165\160\x5f\x6e\x61\155\145\137\x72\x65\161\165\151\x72\145\144"); goto C0iA8; m9s1x: $group_id = $this->db->insert_id($this->tables["\x67\162\157\x75\160\x73"] . "\x5f\151\144\137\x73\x65\161"); goto givSb; mrMbG: if (empty($additional_data)) { goto wFGH_; } goto OvgS8; J9GHD: wFGH_: goto X9pCp; X9pCp: $this->trigger_events("\145\170\x74\x72\141\x5f\x67\x72\157\165\x70\137\x73\x65\x74"); goto FUovg; bXda4: if (!($existing_group !== 0)) { goto WNBUB; } goto JUmo6; DN4tT: if ($group_name) { goto XeyjF; } goto FauOj; dNCSv: return $group_id; goto P5Cu7; VSSpH: WNBUB: goto U_aiQ; m_Dvu: XeyjF: goto OV7n5; givSb: $this->set_message("\x67\x72\157\165\x70\x5f\x63\162\145\141\x74\x69\157\x6e\x5f\163\x75\x63\x63\145\x73\x73\x66\165\154"); goto dNCSv; P5Cu7: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto BrP_K; t08Vh: if (empty($additional_data)) { goto CfZWQ; } goto DRoef; pn_24: kLpsL: goto LyAaw; AsEGL: if (empty($group_name)) { goto kLpsL; } goto tqMsK; Xie17: $this->set_message("\147\162\x6f\165\160\x5f\x75\160\144\141\164\x65\x5f\163\165\143\x63\x65\x73\163\x66\x75\154"); goto IeT_t; tqMsK: $existing_group = $this->db->get_where($this->tables["\147\x72\157\x75\160\163"], ["\156\x61\x6d\145" => $group_name])->row(); goto p85jL; Fo3DI: $this->set_error("\147\162\157\x75\x70\x5f\156\141\155\145\x5f\x61\x64\155\x69\x6e\137\156\x6f\164\137\141\x6c\164\x65\x72"); goto Qo44Z; EISp0: $this->db->update($this->tables["\147\162\x6f\x75\x70\x73"], $data, ["\151\144" => $group_id]); goto Xie17; ftvlQ: return FALSE; goto Ug0BY; LyAaw: $group = $this->db->get_where($this->tables["\x67\x72\x6f\165\x70\163"], ["\x69\144" => $group_id])->row(); goto nEaE3; DRoef: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\160\163"], $additional_data), $data); goto YkO6S; IeT_t: return TRUE; goto yyj5J; XPOdi: $this->set_error("\147\x72\157\165\160\x5f\141\x6c\162\x65\141\x64\171\x5f\145\x78\x69\x73\164\163"); goto ftvlQ; eNDJg: xHNXB: goto LPbbU; Ug0BY: RVlNZ: goto bjGtX; Qo44Z: return FALSE; goto b67GV; bjGtX: $data["\156\141\x6d\145"] = $group_name; goto pn_24; nEaE3: if (!($this->config->item("\141\144\x6d\x69\x6e\x5f\x67\x72\x6f\x75\x70", "\151\x6f\x6e\x5f\x61\x75\x74\x68") === $group->name && $group_name !== $group->name)) { goto sTctD; } goto Fo3DI; YkO6S: CfZWQ: goto EISp0; BrP_K: if (!empty($group_id)) { goto xHNXB; } goto dQ_Nj; p85jL: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto RVlNZ; } goto XPOdi; b67GV: sTctD: goto t08Vh; LPbbU: $data = []; goto AsEGL; dQ_Nj: return FALSE; goto eNDJg; yyj5J: } public function delete_group($group_id = FALSE) { goto q3cq3; yG2U6: return TRUE; goto chqoM; Euccs: $this->set_message("\147\x72\157\x75\x70\137\x64\x65\x6c\x65\x74\145\x5f\163\165\143\x63\x65\163\163\146\165\x6c"); goto yG2U6; MmYfg: $this->db->delete($this->tables["\x67\x72\x6f\165\160\x73"], ["\151\144" => $group_id]); goto TBFAL; wnVPR: $this->trigger_events("\x70\162\145\137\144\145\x6c\145\x74\145\137\147\162\x6f\x75\x70"); goto xzyrd; wSlMM: $this->db->delete($this->tables["\x75\163\x65\x72\x73\x5f\x67\162\x6f\165\x70\x73"], [$this->join["\x67\x72\x6f\x75\x70\163"] => $group_id]); goto MmYfg; Ef2YW: $group = $this->group($group_id)->row(); goto pmnLA; tNQWg: $this->db->trans_rollback(); goto kGFSe; pmnLA: if (!($group->name == $this->config->item("\141\144\x6d\151\156\137\x67\162\157\x75\160", "\151\x6f\x6e\137\141\x75\x74\x68"))) { goto MupcX; } goto FG1eV; y5BOq: $this->set_error("\147\162\x6f\x75\x70\137\144\x65\154\145\164\145\137\x6e\157\164\x61\154\x6c\x6f\167\145\x64"); goto xDMA4; M9Mnf: return FALSE; goto sbxFM; xDMA4: return FALSE; goto IO_wC; M3EXE: return FALSE; goto Ep_qQ; TBFAL: if (!($this->db->trans_status() === FALSE)) { goto Mv5qo; } goto tNQWg; xzyrd: $this->db->trans_begin(); goto wSlMM; q3cq3: if (!(!$group_id || empty($group_id))) { goto MKM28; } goto M3EXE; IO_wC: MupcX: goto wnVPR; kGFSe: $this->trigger_events(["\160\x6f\x73\x74\x5f\x64\145\154\x65\x74\x65\137\x67\x72\157\x75\160", "\x70\157\163\x74\x5f\144\x65\x6c\x65\x74\x65\x5f\147\162\x6f\165\x70\137\165\x6e\163\165\143\x63\145\x73\x73\146\x75\x6c"]); goto pijDn; sbxFM: Mv5qo: goto MQPRN; NUiRy: $this->trigger_events(["\x70\157\163\164\x5f\144\145\154\145\164\x65\137\x67\162\157\x75\x70", "\160\157\163\x74\x5f\x64\x65\x6c\x65\x74\145\x5f\147\162\157\165\x70\137\x73\165\x63\x63\x65\163\163\x66\165\x6c"]); goto Euccs; Ep_qQ: MKM28: goto Ef2YW; MQPRN: $this->db->trans_commit(); goto NUiRy; pijDn: $this->set_error("\x67\162\x6f\x75\x70\137\144\x65\x6c\x65\164\145\137\165\x6e\163\x75\x63\143\x65\x73\163\146\165\154"); goto M9Mnf; FG1eV: $this->trigger_events(["\x70\x6f\163\164\137\144\x65\x6c\145\164\x65\137\147\x72\x6f\165\160", "\x70\x6f\163\164\137\x64\145\154\x65\164\x65\137\x67\162\x6f\x75\x70\137\156\157\x74\x61\154\154\157\x77\x65\144"]); goto y5BOq; chqoM: } public function set_hook($event, $name, $class, $method, $arguments) { goto ivrZT; ivrZT: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto LSugh; aD7zE: $this->_ion_hooks->{$event}[$name]->method = $method; goto VIkyB; LSugh: $this->_ion_hooks->{$event}[$name]->class = $class; goto aD7zE; VIkyB: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto lPXkm; lPXkm: } public function remove_hook($event, $name) { goto IlMq4; CElZv: unset($this->_ion_hooks->{$event}[$name]); goto CTIFJ; IlMq4: if (!isset($this->_ion_hooks->{$event}[$name])) { goto xiboQ; } goto CElZv; CTIFJ: xiboQ: goto RBSYo; RBSYo: } public function remove_hooks($event) { goto aXjk7; qzM2F: ilL8O: goto TODs_; r2CcK: unset($this->_ion_hooks->{$event}); goto qzM2F; aXjk7: if (!isset($this->_ion_hooks->{$event})) { goto ilL8O; } goto r2CcK; TODs_: } protected function _call_hook($event, $name) { goto jZ90V; aNBjl: $hook = $this->_ion_hooks->{$event}[$name]; goto YOERc; YOERc: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto xrR0U; xrR0U: RVKQs: goto PXQQ9; jZ90V: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto RVKQs; } goto aNBjl; PXQQ9: return FALSE; goto gZ0Nz; gZ0Nz: } public function trigger_events($events) { goto NG3Ak; xPuMv: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto wiVAf; } goto WN_vt; hHYVF: foreach ($events as $event) { $this->trigger_events($event); FgHej: } goto D493J; XXxvI: goto LP1PR; goto iYj8r; Y2YO6: LP1PR: goto Lal3S; e9Q4a: il9X2: goto MvWDb; D493J: wPJEn: goto Y2YO6; iYj8r: MPu5j: goto hHYVF; MvWDb: wiVAf: goto XXxvI; NG3Ak: if (is_array($events) && !empty($events)) { goto MPu5j; } goto xPuMv; WN_vt: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); uJ9r1: } goto e9Q4a; Lal3S: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto m_7E1; Qxrto: return TRUE; goto plE1x; m_7E1: $this->message_start_delimiter = $start_delimiter; goto OZ5Ag; OZ5Ag: $this->message_end_delimiter = $end_delimiter; goto Qxrto; plE1x: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto i1XQ1; xQI0J: $this->error_end_delimiter = $end_delimiter; goto QHHWi; QHHWi: return TRUE; goto zDgHJ; i1XQ1: $this->error_start_delimiter = $start_delimiter; goto xQI0J; zDgHJ: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto YdAxZ; YdAxZ: $_output = ''; goto e_4j7; XwO79: return $_output; goto LH2H6; G2pgE: Gutqr: goto XwO79; e_4j7: foreach ($this->messages as $message) { goto JT0M9; JT0M9: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto Lyh3P; fZ2uN: mECDo: goto UUm61; Lyh3P: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto fZ2uN; UUm61: } goto G2pgE; LH2H6: } public function messages_array($langify = TRUE) { goto yRDzi; jJmwY: NO_Rd: goto kSbgA; M98Ga: return $_output; goto K3Wk0; yRDzi: if ($langify) { goto NO_Rd; } goto MQ51N; eqdnD: goto qDHuJ; goto jJmwY; K3Wk0: qDHuJ: goto TpLNj; fsO1K: MwWY3: goto M98Ga; huXuL: foreach ($this->messages as $message) { goto UAX0J; gHkXt: tKR8m: goto NA2Sf; UAX0J: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\43"; goto fuyLW; fuyLW: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto gHkXt; NA2Sf: } goto fsO1K; kSbgA: $_output = []; goto huXuL; MQ51N: return $this->messages; goto eqdnD; TpLNj: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto SC5kQ; SC5kQ: $_output = ''; goto on0X_; k0xjs: return $_output; goto jP04Z; on0X_: foreach ($this->errors as $error) { goto K6jdy; JSGd7: N8JZi: goto omRh2; K6jdy: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\x23"; goto JLdWe; JLdWe: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto JSGd7; omRh2: } goto tY8dR; tY8dR: HJmQO: goto k0xjs; jP04Z: } public function errors_array($langify = TRUE) { goto e64d0; vxttJ: goto xQuTI; goto YZLdt; e64d0: if ($langify) { goto qxElK; } goto PhDtp; YYJ0i: CyFj5: goto wqTHG; PhDtp: return $this->errors; goto vxttJ; YZLdt: qxElK: goto jr_Bb; o4zcF: xQuTI: goto wZmsb; wqTHG: return $_output; goto o4zcF; OLHVG: foreach ($this->errors as $error) { goto s5nla; LKVin: FDQ8_: goto sSsds; s5nla: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\43"; goto ZMroj; ZMroj: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto LKVin; sSsds: } goto YYJ0i; jr_Bb: $_output = []; goto OLHVG; wZmsb: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto DkHHr; XDaf2: return $this->db->affected_rows() == 1; goto ewyCJ; HYgbS: $this->trigger_events("\145\170\x74\x72\141\137\167\150\x65\x72\x65"); goto lTS5X; pS4nU: $data = ["\x70\141\163\163\167\157\x72\x64" => $hash, "\162\145\155\x65\x6d\142\145\x72\x5f\x63\x6f\x64\x65" => NULL, "\x66\157\x72\147\x6f\164\164\145\x6e\x5f\x70\141\163\163\167\157\162\x64\x5f\x63\157\144\145" => NULL, "\x66\x6f\162\x67\x6f\x74\x74\x65\156\137\160\x61\x73\163\167\x6f\x72\x64\x5f\x74\x69\155\x65" => NULL]; goto HYgbS; AXECj: VYPVq: goto pS4nU; e8Hjh: if (!($hash === FALSE)) { goto VYPVq; } goto FRNKf; DkHHr: $hash = $this->hash_password($password, $identity); goto e8Hjh; FRNKf: return FALSE; goto AXECj; lTS5X: $this->db->update($this->tables["\x75\x73\145\162\x73"], $data, [$this->identity_column => $identity]); goto XDaf2; ewyCJ: } protected function _filter_data($table, $data) { goto rU_lg; EDGus: foreach ($columns as $column) { goto n7UuI; k6yFJ: $filtered_data[$column] = $data[$column]; goto FgGJG; n7UuI: if (!array_key_exists($column, $data)) { goto zreVB; } goto k6yFJ; enyM8: j9mp1: goto IrcY3; FgGJG: zreVB: goto enyM8; IrcY3: } goto ww1U3; wusAc: if (!is_array($data)) { goto SoSD5; } goto EDGus; HsyJq: $columns = $this->db->list_fields($table); goto wusAc; ww1U3: w6kEN: goto NpM8Z; NpM8Z: SoSD5: goto R99Mu; rU_lg: $filtered_data = []; goto HsyJq; R99Mu: return $filtered_data; goto u5Bb0; u5Bb0: } protected function _random_token($result_length = 32) { goto k0pMt; rfCck: UO9Gv: goto ZEOat; IKZoc: $result_length = 32; goto AWMsA; PEdkl: return bin2hex(random_bytes($result_length / 2)); goto Mou1T; AWMsA: Nj_Vj: goto D6yW4; k0pMt: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto Nj_Vj; } goto IKZoc; ioB5j: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto rfCck; YVt1Y: return FALSE; goto ZRPHT; D6yW4: if (!function_exists("\162\x61\x6e\x64\157\x6d\x5f\142\171\164\x65\163")) { goto EVgKQ; } goto PEdkl; s4hLB: t5Faz: goto YVt1Y; ZEOat: if (!function_exists("\x6f\x70\145\156\x73\163\x6c\x5f\162\141\156\144\x6f\x6d\x5f\x70\x73\x65\165\x64\x6f\x5f\x62\x79\164\145\163")) { goto t5Faz; } goto UGCVf; Mou1T: EVgKQ: goto PG9tx; UGCVf: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto s4hLB; PG9tx: if (!function_exists("\x6d\143\162\x79\160\164\137\x63\x72\145\x61\164\145\x5f\151\x76")) { goto UO9Gv; } goto ioB5j; ZRPHT: } protected function _get_hash_parameters($identity = NULL) { goto Gcfyr; xTfXs: $user_id = $this->get_user_id_from_identity($identity); goto m8yVe; Gcfyr: $is_admin = FALSE; goto K2Qzg; K2Qzg: if (!$identity) { goto pViPj; } goto xTfXs; h7n5C: pViPj: goto gneXF; rrLER: YNUP0: goto OSHxR; gneXF: $params = FALSE; goto yS_KL; QYpfU: return $params; goto EZ3vi; UpcGP: id5_h: goto h7n5C; yS_KL: switch ($this->hash_method) { case "\142\x63\x72\x79\x70\x74": $params = ["\x63\157\x73\164" => $is_admin ? $this->config->item("\142\143\x72\171\x70\164\137\141\x64\155\x69\156\137\143\157\x73\164", "\151\157\156\137\141\x75\164\x68") : $this->config->item("\142\x63\162\x79\160\164\137\x64\145\146\141\x75\x6c\164\137\143\x6f\x73\164", "\x69\157\x6e\x5f\141\x75\x74\x68")]; goto JMVmd; case "\x61\x72\147\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\x61\162\x67\157\x6e\x32\x5f\141\144\155\151\x6e\x5f\x70\x61\x72\141\x6d\x73", "\x69\157\156\137\x61\x75\164\x68") : $this->config->item("\x61\162\147\157\156\62\x5f\144\x65\x66\x61\x75\154\x74\x5f\x70\x61\162\x61\155\x73", "\x69\x6f\156\x5f\x61\165\164\150"); goto JMVmd; default: } goto rrLER; m8yVe: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\x69\x6e\x5f\x67\162\x6f\x75\160", "\151\157\156\137\x61\165\164\x68"), $user_id))) { goto id5_h; } goto U93ia; U93ia: $is_admin = TRUE; goto UpcGP; OSHxR: JMVmd: goto QYpfU; EZ3vi: } protected function _get_hash_algo() { goto NPnPK; dZTue: switch ($this->hash_method) { case "\142\143\162\171\160\x74": $algo = PASSWORD_BCRYPT; goto tTJKH; case "\141\162\x67\x6f\x6e\62": $algo = PASSWORD_ARGON2I; goto tTJKH; default: } goto Pkpgx; NPnPK: $algo = FALSE; goto dZTue; O7rxB: return $algo; goto emNTy; aWDGL: tTJKH: goto O7rxB; Pkpgx: X8IZT: goto aWDGL; emNTy: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto liXwT; liXwT: $selector = $this->_random_token($selector_size); goto RfRKa; RfRKa: $validator = $this->_random_token($validator_size); goto YEpux; Rg75B: return (object) ["\163\x65\154\x65\143\x74\157\x72" => $selector, "\166\141\x6c\x69\144\x61\164\157\162\x5f\150\141\x73\x68\x65\x64" => $validator_hashed, "\165\x73\145\x72\137\143\x6f\x64\x65" => $user_code]; goto viEBH; m7_AH: $user_code = "{$selector}\56{$validator}"; goto Rg75B; YEpux: $validator_hashed = $this->hash_password($validator); goto m7_AH; viEBH: } protected function _retrieve_selector_validator_couple($user_code) { goto ApDUE; OM26E: return (object) ["\163\x65\154\145\x63\x74\x6f\x72" => $tokens[0], "\x76\x61\154\151\x64\141\x74\x6f\x72" => $tokens[1]]; goto Hnq1_; LO63H: UeY5w: goto qtI0u; Hnq1_: Z5yGV: goto LO63H; ApDUE: if (!$user_code) { goto UeY5w; } goto PqPKN; qtI0u: return FALSE; goto L8W07; PqPKN: $tokens = explode("\56", $user_code); goto LR4WL; LR4WL: if (!(count($tokens) === 2)) { goto Z5yGV; } goto OM26E; L8W07: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto Ij0YP; FOxYm: if ($result) { goto oXC49; } goto TiAdi; CgRuZ: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\150\x61\x31\137\160\141\x73\163\x77\x6f\x72\x64\137\155\x69\x67\x72\x61\x74\x69\157\x6e", "\160\x6f\163\x74\137\163\150\141\61\137\x70\x61\x73\x73\167\157\162\144\x5f\x6d\151\147\162\x61\x74\x69\x6f\x6e\x5f\165\x6e\163\165\x63\x63\145\x73\163\146\165\x6c"]); goto Jpt2A; t3IR8: bq5qf: goto maBe3; dX0z7: $this->trigger_events(["\160\157\x73\164\137\163\150\141\61\x5f\160\x61\163\163\x77\157\162\x64\137\x6d\x69\x67\x72\x61\x74\151\x6f\156", "\160\157\x73\x74\x5f\163\150\x61\x31\x5f\x70\141\x73\x73\x77\x6f\x72\x64\x5f\x6d\151\147\162\141\x74\151\157\x6e\x5f\165\x6e\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c"]); goto txmAX; qkvvw: evhTH: goto K1J_5; txmAX: return FALSE; goto qkvvw; c8yPq: if (!($query->num_rows() !== 1)) { goto evhTH; } goto dX0z7; UQrYv: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\x68\141\x31\x5f\x70\141\x73\x73\x77\x6f\x72\x64\137\155\151\147\x72\x61\164\151\x6f\156", "\x70\157\x73\x74\x5f\163\150\141\61\137\x70\141\163\163\x77\157\x72\x64\137\x6d\151\x67\x72\x61\x74\x69\x6f\x6e\137\163\x75\x63\143\x65\163\x73\x66\165\154"]); goto tKXmp; dOj8w: goto gNzvr; goto Wxt9o; g7LuP: return FALSE; goto t3IR8; tKXmp: wZHNl: goto ktXku; m04NB: DVCvH: goto upSDi; deAr7: $this->trigger_events(["\160\x6f\x73\x74\x5f\163\150\141\61\x5f\x70\x61\163\163\x77\157\x72\144\137\155\x69\x67\x72\x61\164\151\157\156", "\160\157\x73\164\x5f\x73\x68\141\61\137\160\141\163\x73\167\157\162\144\137\x6d\x69\x67\162\x61\x74\x69\x6f\x6e\x5f\x75\x6e\x73\165\x63\x63\x65\x73\163\x66\x75\154"]); goto g7LuP; gMkzt: DzHqz: goto xgUYK; Ij0YP: $this->trigger_events("\160\162\145\x5f\x73\x68\141\x31\137\160\141\x73\x73\167\157\162\x64\137\155\151\147\162\x61\164\151\157\x6e"); goto iMO_n; n3vL2: $salt_db = $query->row(); goto c8yPq; Wxt9o: dGR8M: goto yTV4h; Gowaq: oXC49: goto UQrYv; ENyqX: gNzvr: goto QDszQ; lCUeY: if ($salt_length) { goto bq5qf; } goto deAr7; lGh9k: goto wZHNl; goto Gowaq; B0Rqj: $salt_length = $this->config->item("\163\141\x6c\164\137\x6c\145\x6e\x67\164\x68", "\x69\157\x6e\x5f\141\x75\164\150"); goto lCUeY; TiAdi: $this->trigger_events(["\x70\x6f\x73\164\137\x73\x68\141\61\x5f\160\141\x73\163\x77\x6f\162\144\137\155\151\147\x72\x61\x74\151\x6f\156", "\160\157\163\x74\137\163\x68\x61\61\x5f\x70\141\x73\x73\167\x6f\162\x64\137\x6d\151\x67\x72\x61\164\151\157\156\x5f\165\156\x73\165\143\x63\145\x73\163\146\165\x6c"]); goto lGh9k; maBe3: $salt = substr($hashed_password_db, 0, $salt_length); goto EmVrn; iMO_n: if ($this->config->item("\x73\x74\157\162\145\137\x73\x61\x6c\x74", "\151\x6f\156\137\141\x75\164\x68")) { goto dGR8M; } goto B0Rqj; EmVrn: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto dOj8w; yTV4h: $query = $this->db->select("\163\x61\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\x73"]); goto n3vL2; K1J_5: $hashed_password = sha1($password . $salt_db->salt); goto ENyqX; Jpt2A: return FALSE; goto qWfNG; QDszQ: if ($hashed_password === $hashed_password_db) { goto DVCvH; } goto CgRuZ; qWfNG: goto DzHqz; goto m04NB; upSDi: $result = $this->_set_password_db($identity, $password); goto FOxYm; ktXku: return $result; goto gMkzt; xgUYK: } }
