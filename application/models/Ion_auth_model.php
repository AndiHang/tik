<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\x45\120\101\124\x48") or exit("\x4e\x6f\x20\x64\x69\162\145\x63\x74\40\163\x63\x72\x69\x70\x74\40\x61\143\x63\x65\x73\163\40\141\154\154\157\x77\145\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto amCrr; Cluzr: Y8Gpn: goto AZnih; g4h9U: $this->message_end_delimiter = $this->config->item("\x6d\x65\163\x73\x61\147\x65\x5f\145\156\144\137\144\x65\x6c\151\155\x69\x74\x65\162", "\151\157\x6e\x5f\141\165\164\150"); goto dZECi; vNJrX: $error_suffix = $form_validation_class->getProperty("\137\x65\162\162\157\162\x5f\163\x75\146\146\x69\170"); goto SFxbn; W1bsp: $this->load->helper("\144\141\x74\145"); goto JxiDG; n6P2l: $this->messages = []; goto ZDunW; VjeRB: $this->hash_method = $this->config->item("\x68\141\163\150\x5f\155\x65\164\x68\157\x64", "\x69\x6f\x6e\137\141\165\x74\150"); goto n6P2l; juuzG: $this->load->library("\146\157\162\155\x5f\166\141\x6c\151\x64\141\164\151\157\x6e"); goto MGaXA; MGaXA: $form_validation_class = new ReflectionClass("\103\111\137\106\x6f\162\155\137\x76\x61\154\x69\144\141\164\151\x6f\156"); goto NJhK6; rbgCs: $this->db = $CI->db; goto IUznJ; DhqTB: $this->message_start_delimiter = $this->config->item("\x6d\x65\163\x73\x61\147\x65\137\x73\164\141\x72\164\137\144\145\154\151\x6d\151\x74\x65\x72", "\151\157\x6e\x5f\x61\x75\164\150"); goto g4h9U; mdhYA: $this->error_end_delimiter = $this->config->item("\x65\x72\x72\x6f\162\x5f\x65\156\144\x5f\x64\x65\x6c\151\x6d\x69\x74\x65\x72", "\151\157\156\x5f\141\x75\x74\x68"); goto q2Yc_; S60tp: $error_prefix->setAccessible(TRUE); goto hQ5Ln; SFxbn: $error_suffix->setAccessible(TRUE); goto YBDMM; wZSSQ: if ($delimiters_source === "\146\157\x72\155\x5f\x76\141\154\151\144\141\x74\151\x6f\156") { goto AC3_V; } goto DhqTB; FXC79: $this->tables = $this->config->item("\x74\141\142\x6c\145\163", "\x69\x6f\x6e\137\x61\x75\x74\x68"); goto pXkWX; nk9sM: $this->load->helper("\143\157\157\x6b\x69\145"); goto W1bsp; hQ5Ln: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto aABUf; R3qs5: AC3_V: goto juuzG; AZnih: $this->_ion_hooks = new stdClass(); goto qcHuM; hfEIz: $group_name = $this->config->item("\144\x61\x74\x61\x62\141\x73\145\137\x67\x72\x6f\165\160\x5f\156\x61\x6d\x65", "\151\157\156\x5f\141\x75\164\x68"); goto wSIev; qcHuM: $this->trigger_events("\x6d\x6f\144\145\154\137\143\157\156\163\164\x72\165\143\164\x6f\162"); goto JTY_M; q3oR2: $CI =& get_instance(); goto rbgCs; q2Yc_: goto Y8Gpn; goto R3qs5; dZECi: $this->error_start_delimiter = $this->config->item("\145\x72\x72\x6f\162\137\x73\164\x61\x72\164\137\144\145\x6c\x69\155\151\164\x65\162", "\x69\x6f\x6e\x5f\x61\165\x74\x68"); goto mdhYA; IUznJ: mnv8x: goto FXC79; WGgiE: bxp6I: goto q3oR2; YBDMM: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto n5Pi1; pXkWX: $this->identity_column = $this->config->item("\x69\x64\145\156\x74\x69\164\x79", "\151\157\156\x5f\x61\x75\164\x68"); goto SdQV0; JxiDG: $this->lang->load("\x69\157\x6e\137\x61\x75\164\150"); goto hfEIz; ZDunW: $this->errors = []; goto q3DTl; Cd9fS: goto mnv8x; goto WGgiE; wSIev: if (empty($group_name)) { goto bxp6I; } goto KExFt; aABUf: $this->message_start_delimiter = $this->error_start_delimiter; goto vNJrX; amCrr: $this->config->load("\151\x6f\x6e\137\141\x75\164\x68", TRUE); goto nk9sM; q3DTl: $delimiters_source = $this->config->item("\144\145\x6c\x69\x6d\x69\164\145\162\x73\x5f\x73\157\165\x72\x63\x65", "\x69\x6f\x6e\x5f\x61\x75\164\x68"); goto wZSSQ; NJhK6: $error_prefix = $form_validation_class->getProperty("\x5f\x65\x72\162\x6f\x72\137\160\162\145\146\x69\170"); goto S60tp; n5Pi1: $this->message_end_delimiter = $this->error_end_delimiter; goto Cluzr; SdQV0: $this->join = $this->config->item("\152\157\x69\156", "\x69\x6f\x6e\x5f\141\x75\x74\150"); goto VjeRB; KExFt: $this->db = $this->load->database($group_name, TRUE, TRUE); goto Cd9fS; JTY_M: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto vaumg; PdLwv: if (!($algo !== FALSE && $params !== FALSE)) { goto EiahU; } goto BDdWQ; vaumg: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto bCQNP; } goto vWHyu; BDdWQ: return password_hash($password, $algo, $params); goto UBxDk; KEO9y: return FALSE; goto cCj3L; E55Kg: $params = $this->_get_hash_parameters($identity); goto PdLwv; UBxDk: EiahU: goto KEO9y; vWHyu: return FALSE; goto DVFar; DVFar: bCQNP: goto k7b7v; k7b7v: $algo = $this->_get_hash_algo(); goto E55Kg; cCj3L: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto MStcx; MStcx: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto moCUd; } goto HGq1C; HGq1C: return FALSE; goto gEElN; APVUO: if (strpos($hash_password_db, "\x24") === 0) { goto bVxd9; } goto dPjIi; gEElN: moCUd: goto APVUO; dPjIi: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto TuYvK; I5JlD: return password_verify($password, $hash_password_db); goto iibFI; iibFI: ujyub: goto gos3G; vV8S6: bVxd9: goto I5JlD; TuYvK: goto ujyub; goto vV8S6; gos3G: } public function rehash_password_if_needed($hash, $identity, $password) { goto W5IfL; TLA_R: g_T57: goto AWBdk; WiBtd: $params = $this->_get_hash_parameters($identity); goto eS9Vt; gryra: SFNfX: goto ok4AX; Nedfd: $this->trigger_events(["\x72\145\150\x61\x73\150\x5f\x70\x61\163\x73\167\x6f\x72\x64", "\x72\x65\x68\x61\163\150\137\x70\x61\x73\163\167\x6f\162\x64\137\x75\x6e\x73\165\143\x63\x65\x73\163\146\165\154"]); goto HQSjp; WY4xB: rSazY: goto gryra; ok4AX: R4Kf3: goto LJap9; W5IfL: $algo = $this->_get_hash_algo(); goto WiBtd; AWBdk: $this->trigger_events(["\162\x65\x68\141\163\150\x5f\x70\x61\163\163\167\x6f\162\x64", "\x72\145\150\x61\x73\x68\137\x70\x61\163\163\167\x6f\x72\144\137\x73\165\143\143\145\x73\163\x66\165\154"]); goto WY4xB; coZ_7: if (!password_needs_rehash($hash, $algo, $params)) { goto SFNfX; } goto aW4CK; eS9Vt: if (!($algo !== FALSE && $params !== FALSE)) { goto R4Kf3; } goto coZ_7; HQSjp: goto rSazY; goto TLA_R; aW4CK: if ($this->_set_password_db($identity, $password)) { goto g_T57; } goto Nedfd; LJap9: } public function get_user_by_activation_code($user_code) { goto zKKbB; BdsYQ: return $user; goto yeL9l; ETJt3: YTER9: goto nhcR6; yeL9l: JbQqI: goto ETJt3; nZEIb: if (!$this->verify_password($token->validator, $user->activation_code)) { goto JbQqI; } goto BdsYQ; nhcR6: return FALSE; goto Kt30k; Os2A0: $user = $this->where("\x61\x63\x74\151\166\141\x74\x69\x6f\156\137\x73\145\x6c\x65\x63\x74\157\162", $token->selector)->users()->row(); goto zLwH0; zKKbB: $token = $this->_retrieve_selector_validator_couple($user_code); goto Os2A0; zLwH0: if (!$user) { goto YTER9; } goto nZEIb; Kt30k: } public function activate($id, $code = FALSE) { goto zCiD2; Mh1CC: $this->trigger_events(["\160\157\x73\164\x5f\141\x63\164\151\x76\141\164\x65", "\160\157\163\164\x5f\141\x63\x74\x69\x76\x61\164\x65\x5f\x75\156\163\x75\143\143\x65\x73\163\146\165\x6c"]); goto tTpuq; noxS1: $this->set_message("\x61\143\164\151\x76\x61\x74\145\137\x73\165\143\143\145\163\163\x66\165\x6c"); goto dsW7g; dsW7g: return TRUE; goto FypDa; ntmvB: return FALSE; goto LC5He; tTpuq: $this->set_error("\141\x63\164\x69\x76\x61\164\145\137\x75\x6e\163\x75\x63\x63\x65\x73\x73\146\165\x6c"); goto ntmvB; cROpN: if (!($this->db->affected_rows() === 1)) { goto Bl_Sg; } goto XGZpc; GyOhh: $data = ["\x61\143\x74\151\166\x61\164\x69\157\156\x5f\x73\x65\154\x65\x63\164\x6f\162" => NULL, "\x61\x63\164\x69\166\141\x74\151\157\x6e\137\x63\157\144\145" => NULL, "\x61\x63\x74\x69\x76\145" => 1]; goto Mt0Kt; OxMrw: if (!($code !== FALSE)) { goto d0PqW; } goto eXBLa; BaLJy: if (!($code === FALSE || $user && $user->id === $id)) { goto VWsnB; } goto GyOhh; Mt0Kt: $this->trigger_events("\145\x78\x74\162\x61\x5f\x77\x68\145\x72\x65"); goto o6Dpo; zCiD2: $this->trigger_events("\x70\x72\x65\x5f\x61\x63\164\151\x76\x61\164\x65"); goto OxMrw; y9cfY: VWsnB: goto Mh1CC; SvamD: d0PqW: goto BaLJy; XGZpc: $this->trigger_events(["\x70\157\x73\x74\137\141\x63\164\151\x76\141\164\145", "\160\157\163\164\x5f\141\x63\x74\x69\x76\141\164\145\x5f\163\165\x63\143\145\163\x73\146\165\x6c"]); goto noxS1; FypDa: Bl_Sg: goto y9cfY; eXBLa: $user = $this->get_user_by_activation_code($code); goto SvamD; o6Dpo: $this->db->update($this->tables["\x75\x73\x65\162\163"], $data, ["\x69\x64" => $id]); goto cROpN; LC5He: } public function deactivate($id = NULL) { goto wK1Fq; gxzMq: $this->trigger_events("\x65\x78\164\162\141\x5f\167\x68\145\162\145"); goto g078M; A0hFo: $this->set_error("\x64\x65\141\143\164\151\166\141\x74\x65\137\x63\165\x72\x72\145\156\x74\137\x75\163\145\162\x5f\165\156\163\165\x63\x63\145\x73\163\x66\x75\154"); goto LVJtI; SvTOv: $token = $this->_generate_selector_validator_couple(20, 40); goto k1haE; k1haE: $this->activation_code = $token->user_code; goto wEOVy; wK1Fq: $this->trigger_events("\x64\x65\x61\143\x74\151\x76\141\x74\x65"); goto rL8ES; Ec4IZ: $return = $this->db->affected_rows() == 1; goto vg0OA; lgHYw: $this->set_message("\144\145\141\x63\164\x69\x76\141\164\x65\x5f\163\165\x63\143\145\x73\x73\x66\x75\154"); goto KEN8G; g078M: $this->db->update($this->tables["\165\x73\145\162\163"], $data, ["\151\x64" => $id]); goto Ec4IZ; SZdNF: o1llq: goto SvTOv; SJ_HZ: $this->set_error("\144\x65\x61\143\x74\151\x76\x61\164\x65\x5f\x75\x6e\x73\165\143\x63\145\x73\163\146\165\154"); goto v5qIG; vg0OA: if ($return) { goto lNu8Z; } goto fOmiy; fOmiy: $this->set_error("\x64\145\141\x63\x74\x69\x76\x61\164\x65\137\165\156\163\165\x63\143\x65\163\163\146\165\x6c"); goto FHIHo; LXD6T: lNu8Z: goto lgHYw; Nr7hK: return $return; goto uUrPN; rL8ES: if (!isset($id)) { goto BMNpa; } goto b_uCG; v5qIG: return FALSE; goto SZdNF; b_uCG: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto G_Mfm; } goto A0hFo; Zuvt5: BMNpa: goto SJ_HZ; KEN8G: iyaGf: goto Nr7hK; zyaGP: goto o1llq; goto Zuvt5; LVJtI: return FALSE; goto ftic_; wEOVy: $data = ["\x61\x63\x74\x69\x76\141\164\x69\x6f\156\x5f\x73\145\x6c\145\x63\x74\x6f\162" => $token->selector, "\x61\x63\164\x69\x76\141\x74\151\157\156\x5f\x63\157\x64\145" => $token->validator_hashed, "\x61\x63\164\151\x76\145" => 0]; goto gxzMq; FHIHo: goto iyaGf; goto LXD6T; ftic_: G_Mfm: goto zyaGP; uUrPN: } public function clear_forgotten_password_code($identity) { goto Ms4FN; VkXIV: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto nejS2; bjZGi: $data = ["\146\x6f\x72\x67\157\x74\x74\x65\x6e\x5f\x70\x61\x73\163\x77\157\x72\144\137\x73\145\x6c\145\143\164\157\162" => NULL, "\x66\157\162\147\157\164\x74\x65\x6e\137\x70\x61\x73\x73\x77\157\x72\x64\137\143\x6f\144\145" => NULL, "\146\157\x72\x67\157\164\x74\145\x6e\x5f\160\141\x73\x73\167\157\x72\144\137\x74\x69\155\x65" => NULL]; goto VkXIV; qNxii: return FALSE; goto Lncjc; Ms4FN: if (!empty($identity)) { goto pklmT; } goto qNxii; nejS2: return TRUE; goto N22iI; Lncjc: pklmT: goto bjZGi; N22iI: } public function clear_remember_code($identity) { goto JqodA; h_GO5: $this->db->update($this->tables["\x75\163\145\162\163"], $data, [$this->identity_column => $identity]); goto qEQ0q; jOuPX: return FALSE; goto DkYhK; aHRJZ: $data = ["\162\145\155\145\155\x62\x65\162\137\x73\x65\154\145\143\164\x6f\x72" => NULL, "\x72\145\155\145\155\142\x65\162\137\x63\157\144\145" => NULL]; goto h_GO5; qEQ0q: return TRUE; goto w_8sF; DkYhK: BAM_e: goto aHRJZ; JqodA: if (!empty($identity)) { goto BAM_e; } goto jOuPX; w_8sF: } public function reset_password($identity, $new) { goto JxtEg; I2brQ: h2n1o: goto CsxFO; ejfPv: $this->trigger_events(["\160\157\163\x74\137\x63\x68\x61\156\147\x65\137\160\x61\x73\x73\x77\x6f\x72\x64", "\160\x6f\x73\164\137\143\x68\141\x6e\x67\x65\137\x70\x61\163\x73\x77\157\x72\144\137\x75\156\163\165\143\x63\x65\163\x73\x66\x75\154"]); goto toHzl; CsxFO: return $return; goto bjpEL; JxtEg: $this->trigger_events("\x70\162\145\x5f\143\150\x61\156\147\145\x5f\x70\141\x73\163\167\157\x72\x64"); goto Lzd0m; GYD6d: Ne08e: goto mZr1N; cVPdo: goto h2n1o; goto mlJfr; vyyrx: $this->trigger_events(["\x70\157\x73\x74\137\x63\150\x61\156\147\x65\137\x70\141\163\x73\x77\157\x72\x64", "\x70\x6f\163\x74\137\x63\x68\x61\x6e\x67\x65\137\x70\x61\163\163\x77\x6f\162\x64\137\x73\165\143\x63\x65\163\163\x66\165\154"]); goto No16n; LUcNz: return FALSE; goto GYD6d; qQUXP: $this->trigger_events(["\x70\157\x73\x74\137\143\x68\141\156\147\x65\x5f\160\x61\x73\163\167\157\x72\144", "\x70\x6f\163\x74\x5f\143\x68\x61\156\x67\145\x5f\160\141\x73\163\167\157\162\x64\137\x75\x6e\x73\x75\143\x63\145\x73\163\x66\x75\x6c"]); goto LUcNz; Lzd0m: if ($this->identity_check($identity)) { goto Ne08e; } goto qQUXP; mlJfr: Psn6D: goto vyyrx; No16n: $this->set_message("\x70\141\x73\163\x77\x6f\162\144\137\x63\x68\141\x6e\x67\x65\x5f\x73\x75\x63\143\145\163\x73\146\165\x6c"); goto I2brQ; toHzl: $this->set_error("\160\141\x73\x73\167\157\x72\144\x5f\x63\150\x61\156\x67\x65\137\x75\x6e\x73\165\143\143\x65\x73\163\x66\165\x6c"); goto cVPdo; hWXX2: if ($return) { goto Psn6D; } goto ejfPv; mZr1N: $return = $this->_set_password_db($identity, $new); goto hWXX2; bjpEL: } public function change_password($identity, $old, $new) { goto DRtwf; XflQY: $user = $query->row(); goto WYGRl; bNxkQ: $result = $this->_set_password_db($identity, $new); goto yUQbM; KY_r_: $this->trigger_events("\145\x78\164\162\x61\x5f\x77\x68\x65\x72\145"); goto qA0MH; Gss7L: goto uxmpU; goto fAsX4; DRtwf: $this->trigger_events("\x70\x72\x65\x5f\143\x68\x61\x6e\147\145\x5f\160\x61\163\x73\x77\157\162\144"); goto KY_r_; qA0MH: $query = $this->db->select("\151\144\54\x20\x70\141\x73\x73\x77\157\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\145\163\143")->get($this->tables["\x75\163\x65\162\x73"]); goto FC35N; Zx1H7: $this->set_error("\160\141\163\163\167\157\162\144\137\x63\150\x61\156\x67\x65\137\x75\x6e\163\x75\143\x63\x65\163\x73\x66\x75\154"); goto XU0FG; AZ5bs: $this->set_message("\160\141\x73\163\x77\157\162\144\137\x63\150\x61\156\147\x65\137\x73\165\143\x63\x65\163\x73\x66\165\154"); goto awAej; UAgJH: return $result; goto bCJx7; XU0FG: return FALSE; goto xBgk2; fAsX4: LB3CU: goto wcxL0; yUQbM: if ($result) { goto LB3CU; } goto SM5XF; Fc2h7: $this->set_error("\x70\141\163\163\167\x6f\x72\x64\x5f\x63\x68\x61\156\x67\x65\137\165\x6e\163\165\143\143\145\x73\163\x66\165\x6c"); goto Gss7L; IGNzr: return FALSE; goto smxfP; FC35N: if (!($query->num_rows() !== 1)) { goto v1pFt; } goto X5msF; WYGRl: if (!$this->verify_password($old, $user->password, $identity)) { goto ssgBn; } goto bNxkQ; wcxL0: $this->trigger_events(["\160\157\x73\164\137\143\x68\x61\x6e\147\145\x5f\160\x61\x73\163\x77\157\x72\144", "\160\157\163\164\x5f\143\x68\x61\156\x67\145\137\160\x61\x73\163\167\x6f\x72\144\x5f\163\x75\143\x63\x65\x73\x73\146\x75\154"]); goto AZ5bs; X5msF: $this->trigger_events(["\160\x6f\163\164\137\143\150\141\x6e\x67\x65\x5f\x70\141\x73\x73\x77\x6f\162\144", "\160\157\163\164\x5f\x63\x68\141\x6e\147\x65\137\160\141\x73\x73\167\157\x72\144\137\165\156\163\165\143\143\145\163\x73\146\165\x6c"]); goto v8Whp; v8Whp: $this->set_error("\x70\x61\x73\163\x77\x6f\162\144\x5f\x63\150\141\x6e\147\145\137\165\156\163\165\x63\x63\x65\x73\x73\146\165\x6c"); goto IGNzr; SM5XF: $this->trigger_events(["\160\157\x73\164\137\143\x68\x61\156\147\x65\x5f\x70\141\163\x73\167\x6f\x72\144", "\x70\x6f\163\164\137\x63\x68\x61\156\x67\145\137\160\x61\x73\163\167\157\162\144\137\x75\x6e\163\165\143\x63\145\x73\163\146\x75\x6c"]); goto Fc2h7; awAej: uxmpU: goto UAgJH; smxfP: v1pFt: goto XflQY; bCJx7: ssgBn: goto Zx1H7; xBgk2: } public function username_check($username = '') { goto TxVIq; o63NK: return $this->db->where("\x75\163\145\162\156\141\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\x73"]) > 0; goto O4FtC; PRrEd: cLaFq: goto IbXjG; x3L1a: return FALSE; goto PRrEd; Eggdg: if (!empty($username)) { goto cLaFq; } goto x3L1a; TxVIq: $this->trigger_events("\165\163\145\162\156\141\x6d\x65\137\143\150\145\x63\153"); goto Eggdg; IbXjG: $this->trigger_events("\x65\x78\164\x72\141\137\x77\150\x65\162\145"); goto o63NK; O4FtC: } public function email_check($email = '') { goto kfSsQ; q4HOo: $this->trigger_events("\145\x78\x74\162\141\x5f\x77\x68\145\162\x65"); goto CNK5Y; kfSsQ: $this->trigger_events("\x65\x6d\141\x69\x6c\x5f\143\150\x65\143\x6b"); goto gYvhP; gYvhP: if (!empty($email)) { goto Id0Ww; } goto I27RM; I27RM: return FALSE; goto u2xbW; CNK5Y: return $this->db->where("\145\155\141\151\154", $email)->limit(1)->count_all_results($this->tables["\x75\163\x65\162\163"]) > 0; goto jxHQH; u2xbW: Id0Ww: goto q4HOo; jxHQH: } public function identity_check($identity = '') { goto lj4id; lj4id: $this->trigger_events("\151\144\x65\156\x74\151\x74\171\137\x63\x68\145\143\x6b"); goto xKepO; in_AS: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\162\x73"]) > 0; goto Px2E7; FTuKf: return FALSE; goto DIS9F; xKepO: if (!empty($identity)) { goto L0eHb; } goto FTuKf; DIS9F: L0eHb: goto in_AS; Px2E7: } public function get_user_id_from_identity($identity = '') { goto IGpiD; rF551: yHAbH: goto nwOqE; pTPZl: if (!($query->num_rows() !== 1)) { goto JFQmT; } goto WTpkg; Mxhss: JFQmT: goto n0bI7; WTpkg: return FALSE; goto Mxhss; mZhMH: return $user->id; goto wdsDO; nwOqE: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\162\163"]); goto pTPZl; IGpiD: if (!empty($identity)) { goto yHAbH; } goto fU92Q; n0bI7: $user = $query->row(); goto mZhMH; fU92Q: return FALSE; goto rF551; wdsDO: } public function forgotten_password($identity) { goto G3M3Z; tTXw2: $this->trigger_events(["\x70\x6f\163\164\137\146\157\x72\x67\157\x74\164\x65\x6e\137\x70\141\x73\163\x77\x6f\162\x64", "\x70\157\x73\x74\137\x66\x6f\162\147\x6f\x74\164\x65\x6e\x5f\160\x61\x73\163\x77\x6f\x72\144\137\163\165\x63\x63\x65\x73\x73\146\x75\154"]); goto DCTeF; lJFPN: $this->trigger_events(["\x70\x6f\163\x74\x5f\146\x6f\x72\147\x6f\x74\x74\145\156\137\160\x61\163\x73\x77\x6f\162\144", "\x70\157\163\164\137\146\157\x72\x67\157\x74\164\145\156\x5f\160\x61\163\163\x77\x6f\162\144\137\165\x6e\x73\165\143\x63\145\163\x73\x66\165\x6c"]); goto ROUE3; s6slx: goto TFWBN; goto J3rG6; G3M3Z: if (!empty($identity)) { goto DsqDM; } goto bkjHZ; t15nQ: $this->trigger_events("\x65\170\164\x72\x61\137\x77\150\145\x72\145"); goto LTwaS; kLMlv: $token = $this->_generate_selector_validator_couple(20, 80); goto KLYlA; bX9RQ: return FALSE; goto bkI1J; J3rG6: Z16s7: goto tTXw2; ROUE3: return FALSE; goto s6slx; bkjHZ: $this->trigger_events(["\160\x6f\x73\164\137\x66\157\162\147\157\164\x74\145\x6e\x5f\x70\141\x73\x73\x77\x6f\x72\x64", "\x70\x6f\x73\x74\x5f\x66\x6f\x72\147\157\x74\x74\x65\156\x5f\160\x61\x73\163\167\x6f\162\144\137\165\x6e\x73\165\143\x63\145\x73\x73\x66\165\x6c"]); goto bX9RQ; KLYlA: $update = ["\x66\x6f\x72\147\157\164\164\145\x6e\x5f\x70\141\163\x73\167\157\x72\144\x5f\163\x65\x6c\x65\143\x74\x6f\162" => $token->selector, "\146\x6f\162\147\157\164\x74\145\x6e\137\x70\x61\163\x73\x77\x6f\x72\144\x5f\x63\x6f\144\x65" => $token->validator_hashed, "\x66\157\162\147\157\164\164\x65\156\x5f\x70\x61\163\163\167\x6f\162\144\137\x74\151\155\x65" => time()]; goto t15nQ; MOijk: if ($this->db->affected_rows() === 1) { goto Z16s7; } goto lJFPN; LTwaS: $this->db->update($this->tables["\165\x73\x65\162\163"], $update, [$this->identity_column => $identity]); goto MOijk; bkI1J: DsqDM: goto kLMlv; Dz78K: TFWBN: goto dMtN1; DCTeF: return $token->user_code; goto Dz78K; dMtN1: } public function get_user_by_forgotten_password_code($user_code) { goto ELvo1; ELvo1: $token = $this->_retrieve_selector_validator_couple($user_code); goto ipopL; geRGO: HfukZ: goto CkFqC; HfaIv: r67Oj: goto geRGO; ipopL: $user = $this->where("\146\x6f\162\x67\x6f\164\x74\145\x6e\137\160\141\163\163\167\x6f\x72\x64\x5f\163\x65\154\x65\x63\x74\157\162", $token->selector)->users()->row(); goto Vy6RQ; zYu9W: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto r67Oj; } goto RouvW; RouvW: return $user; goto HfaIv; CkFqC: return FALSE; goto RX1XU; Vy6RQ: if (!$user) { goto HfukZ; } goto zYu9W; RX1XU: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto xehd9; xehd9: $this->trigger_events("\160\162\x65\137\x72\x65\x67\151\x73\x74\x65\x72"); goto UJ9Ro; tVI47: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\145\162\163"], $additional_data), $data); goto QTMjj; PjrKz: $this->set_error("\x61\x63\x63\157\x75\156\x74\x5f\x63\x72\145\x61\164\x69\157\156\x5f\165\x6e\x73\x75\x63\143\x65\x73\x73\146\x75\154"); goto VTZDt; yjoyO: if (empty($groups)) { goto uriaK; } goto BdlME; QTMjj: $this->trigger_events("\x65\x78\x74\162\x61\137\163\145\x74"); goto Mvp0R; jQzmr: goto R5srO; goto eMC9R; ToOB8: $ip_address = $this->input->ip_address(); goto G4Km3; mIq8Y: $this->set_error("\x61\143\x63\x6f\x75\x6e\x74\x5f\x63\x72\145\x61\164\151\157\x6e\x5f\155\151\163\163\151\156\147\x5f\144\145\x66\141\165\154\x74\137\x67\x72\x6f\165\160"); goto CgYuM; ovKAd: $this->trigger_events("\x70\x6f\163\164\x5f\162\x65\x67\x69\163\164\145\x72"); goto e0Lep; EfYBm: $id = $this->db->insert_id($this->tables["\165\x73\145\x72\x73"] . "\x5f\151\144\x5f\163\x65\x71"); goto AYlyl; SRdXN: uriaK: goto ovKAd; TVcjP: e4PMm: goto yjoyO; Hkpo_: $default_group = $query; goto ToOB8; gsVfH: R5srO: goto TDrf8; NFq_x: $groups[] = $default_group->id; goto TVcjP; iVhOJ: TDcKA: goto Hkpo_; AYlyl: if (!(isset($default_group->id) && empty($groups))) { goto e4PMm; } goto NFq_x; TDrf8: $query = $this->db->get_where($this->tables["\147\162\x6f\165\x70\x73"], ["\156\x61\155\x65" => $this->config->item("\144\x65\x66\141\165\x6c\x74\x5f\147\162\x6f\165\160", "\151\x6f\x6e\x5f\x61\x75\x74\x68")], 1)->row(); goto JZhcy; qcz76: if (!(!$this->config->item("\144\145\x66\141\165\x6c\164\137\147\162\x6f\165\x70", "\x69\157\x6e\x5f\141\x75\x74\150") && empty($groups))) { goto tyU16; } goto mIq8Y; eMC9R: tE4re: goto EfZxN; dmxBt: $data = [$this->identity_column => $identity, "\165\163\x65\x72\156\x61\x6d\145" => $identity, "\160\141\163\x73\167\x6f\162\x64" => $password, "\145\x6d\x61\151\154" => $email, "\151\160\137\x61\x64\x64\162\145\163\x73" => $ip_address, "\143\x72\x65\x61\x74\145\144\x5f\x6f\x6e" => time(), "\x61\x63\164\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto tVI47; jCsLn: tyU16: goto jQzmr; UJ9Ro: $manual_activation = $this->config->item("\155\x61\156\x75\x61\154\137\x61\143\164\151\166\x61\x74\x69\157\x6e", "\151\157\156\137\x61\165\164\x68"); goto C62wJ; N6zV4: if (!($password === FALSE)) { goto uFU2w; } goto PjrKz; KegeS: return FALSE; goto gsVfH; G4Km3: $password = $this->hash_password($password); goto N6zV4; POon8: $this->set_error("\x61\x63\x63\x6f\165\156\164\137\143\162\x65\x61\x74\151\x6f\x6e\137\x69\x6e\166\141\154\151\144\137\x64\x65\x66\x61\165\154\164\x5f\147\x72\x6f\x75\x70"); goto AlMXG; BdlME: foreach ($groups as $group) { $this->add_to_group($group, $id); v1yDm: } goto RlAek; JZhcy: if (!(!isset($query->id) && empty($groups))) { goto TDcKA; } goto POon8; Mvp0R: $this->db->insert($this->tables["\x75\163\x65\x72\163"], $user_data); goto EfYBm; RlAek: IF4j_: goto SRdXN; EfZxN: $this->set_error("\x61\143\x63\157\165\x6e\x74\x5f\x63\162\x65\141\164\x69\x6f\156\137\x64\165\x70\154\x69\143\x61\x74\x65\x5f\151\x64\145\156\x74\x69\x74\171"); goto KegeS; C62wJ: if ($this->identity_check($identity)) { goto tE4re; } goto qcz76; CgYuM: return FALSE; goto jCsLn; AlMXG: return FALSE; goto iVhOJ; VTZDt: return FALSE; goto kdlK3; kdlK3: uFU2w: goto dmxBt; e0Lep: return isset($id) ? $id : FALSE; goto GdwXA; GdwXA: } public function login($identity, $password, $remember = FALSE) { goto l8zvU; sUjp8: if (!$this->config->item("\x72\145\155\145\x6d\142\145\x72\137\165\x73\145\x72\x73", "\x69\x6f\x6e\x5f\x61\165\164\x68")) { goto cExsW; } goto rTgLp; IIKZD: if (!($user->active == 0)) { goto Q3dxX; } goto Q9csb; B8LJN: mnHh_: goto coUxW; hb3dJ: return FALSE; goto W4jaG; kQWM2: $this->rehash_password_if_needed($user->password, $identity, $password); goto wbFZk; pnj0s: xr67p: goto jJRYS; i7wwU: $user = $query->row(); goto oOlHs; wbFZk: $this->session->sess_regenerate(FALSE); goto Ct91t; Vbt9f: Zd0NI: goto VyqR4; VyqR4: cExsW: goto kQWM2; oOlHs: if (!$this->verify_password($password, $user->password, $identity)) { goto iuj9O; } goto IIKZD; tTqmL: $query = $this->db->select($this->identity_column . "\x2c\40\x65\x6d\x61\x69\154\x2c\x20\151\x64\54\40\160\141\163\163\167\157\x72\x64\54\x20\141\143\164\x69\x76\145\x2c\x20\154\141\163\x74\137\154\157\x67\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\x65\163\143")->get($this->tables["\165\163\145\162\163"]); goto gEoPM; coUxW: $this->trigger_events("\145\x78\164\162\141\137\x77\150\x65\162\145"); goto tTqmL; HP7hH: $this->hash_password($password); goto PjGhl; NFXmc: return FALSE; goto B8LJN; Ct91t: $this->trigger_events(["\x70\157\x73\164\137\154\x6f\x67\151\x6e", "\160\157\x73\164\x5f\154\157\x67\151\156\x5f\163\165\x63\x63\145\163\x73\146\165\154"]); goto A1Rg3; rTgLp: if ($remember) { goto xr67p; } goto GvJLh; p2a5J: $this->set_error("\154\x6f\147\151\156\137\x75\156\163\165\143\x63\145\x73\x73\x66\x75\x6c"); goto azvEJ; gEoPM: if (!$this->is_max_login_attempts_exceeded($identity)) { goto dSHvl; } goto HP7hH; lB59o: $this->set_session($user); goto XsNpx; Zzy6z: return TRUE; goto Sbgcw; ObJ4n: A4XNx: goto QVhHw; azvEJ: return FALSE; goto RiVrU; PjGhl: $this->trigger_events("\x70\x6f\x73\164\137\x6c\x6f\147\x69\156\x5f\x75\156\x73\165\x63\x63\145\163\x73\146\165\x6c"); goto bxutB; bBgSD: return FALSE; goto b1kzG; QVhHw: $this->hash_password($password); goto tGYT1; j79Lu: goto Zd0NI; goto pnj0s; X6edO: $this->trigger_events("\x70\157\163\164\137\x6c\x6f\147\151\156\137\165\x6e\163\x75\143\x63\145\x73\163\x66\165\x6c"); goto p2a5J; XsNpx: $this->update_last_login($user->id); goto PzoXF; A1Rg3: $this->set_message("\154\x6f\147\151\156\x5f\x73\x75\143\143\145\163\163\x66\165\x6c"); goto Zzy6z; l8zvU: $this->trigger_events("\160\x72\145\x5f\x6c\157\x67\x69\x6e"); goto nelLB; bxutB: $this->set_error("\x6c\x6f\147\151\156\x5f\164\151\x6d\145\157\x75\x74"); goto bBgSD; soFjc: $this->clear_forgotten_password_code($identity); goto sUjp8; Sbgcw: iuj9O: goto ObJ4n; GvJLh: $this->clear_remember_code($identity); goto j79Lu; aOvE4: $this->set_error("\x6c\157\147\151\x6e\137\x75\x6e\x73\165\143\x63\x65\163\163\x66\x75\x6c"); goto NFXmc; Q9csb: $this->trigger_events("\160\157\x73\164\137\x6c\157\x67\x69\156\137\165\156\163\x75\x63\143\x65\163\163\146\165\x6c"); goto FFm53; W4jaG: Q3dxX: goto lB59o; nelLB: if (!(empty($identity) || empty($password))) { goto mnHh_; } goto aOvE4; b1kzG: dSHvl: goto N_Ei8; PzoXF: $this->clear_login_attempts($identity); goto soFjc; tGYT1: $this->increase_login_attempts($identity); goto X6edO; FFm53: $this->set_error("\154\157\147\x69\156\137\165\x6e\x73\x75\x63\x63\x65\x73\163\x66\x75\x6c\137\x6e\157\x74\137\x61\143\164\x69\166\x65"); goto hb3dJ; N_Ei8: if (!($query->num_rows() === 1)) { goto A4XNx; } goto i7wwU; jJRYS: $this->remember_user($identity); goto Vbt9f; RiVrU: } public function recheck_session() { goto m0bUE; u9B9n: $this->session->set_userdata("\154\141\x73\164\137\x63\150\x65\x63\x6b", time()); goto v0gZo; YwUr3: if (!($last_login + $recheck < time())) { goto ZAA9a; } goto T3_4I; a0Et1: $identity = $this->config->item("\151\144\x65\x6e\x74\151\164\171", "\151\157\156\137\141\x75\x74\x68"); goto oY7yw; h8ym3: ZAA9a: goto SjZHh; KtHzn: if ($query->num_rows() === 1) { goto LkNPB; } goto FEJzD; Sui3L: goto L5FRU; goto ImvxW; oY7yw: $this->session->unset_userdata([$identity, "\151\x64", "\165\x73\x65\x72\137\151\144"]); goto q8pMW; ImvxW: LkNPB: goto u9B9n; q8pMW: return FALSE; goto Sui3L; v0gZo: L5FRU: goto h8ym3; XzoA3: if (!($recheck !== 0)) { goto dPyKl; } goto rVykq; m0bUE: $recheck = NULL !== $this->config->item("\x72\145\x63\x68\x65\x63\153\137\x74\x69\x6d\x65\x72", "\x69\157\x6e\137\141\165\164\150") ? $this->config->item("\x72\x65\x63\150\145\x63\153\137\x74\x69\x6d\145\162", "\x69\157\156\x5f\x61\x75\164\150") : 0; goto XzoA3; SjZHh: dPyKl: goto SZ2JC; T3_4I: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\x69\x64\145\x6e\164\151\x74\x79"), "\141\143\x74\x69\x76\145" => "\x31"])->limit(1)->order_by("\151\144", "\x64\145\x73\x63")->get($this->tables["\165\x73\145\x72\163"]); goto KtHzn; SZ2JC: return (bool) $this->session->userdata("\151\x64\x65\x6e\x74\x69\164\171"); goto fcZdy; FEJzD: $this->trigger_events("\x6c\x6f\x67\x6f\165\x74"); goto a0Et1; rVykq: $last_login = $this->session->userdata("\154\141\x73\164\x5f\143\150\x65\143\x6b"); goto YwUr3; fcZdy: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto O5VmQ; O5VmQ: if (!$this->config->item("\x74\x72\x61\x63\153\137\154\x6f\147\151\x6e\x5f\x61\x74\164\145\155\x70\164\x73", "\x69\x6f\156\137\x61\x75\x74\150")) { goto pO2gN; } goto cDB6T; xjMx1: pO2gN: goto mdg1m; KsNE0: $attempts = $this->get_attempts_num($identity, $ip_address); goto M5Oc5; M5Oc5: return $attempts >= $max_attempts; goto EaaL5; cDB6T: $max_attempts = $this->config->item("\155\x61\170\151\x6d\165\155\x5f\x6c\157\x67\151\x6e\137\141\x74\x74\145\155\x70\x74\x73", "\x69\x6f\x6e\137\x61\165\x74\x68"); goto eb8Y1; EaaL5: Znug3: goto xjMx1; eb8Y1: if (!($max_attempts > 0)) { goto Znug3; } goto KsNE0; mdg1m: return FALSE; goto EunoC; EunoC: } public function get_attempts_num($identity, $ip_address = NULL) { goto Izd8n; LSABM: $this->db->select("\x31", FALSE); goto fUyNt; TT86O: $this->db->where("\151\160\137\x61\144\x64\x72\145\163\163", $ip_address); goto oTauY; POQS5: $ip_address = $this->input->ip_address(); goto h3SnP; cy99r: G5V03: goto AgQxL; M0ICD: if (isset($ip_address)) { goto WYWzF; } goto POQS5; qWfMI: $qres = $this->db->get($this->tables["\154\x6f\147\151\x6e\x5f\x61\x74\164\145\155\160\164\x73"]); goto BN6MQ; SBbDr: $this->db->where("\x74\151\x6d\x65\40\x3e", time() - $this->config->item("\154\x6f\143\153\x6f\165\164\x5f\164\151\155\x65", "\151\157\156\x5f\x61\x75\164\150"), FALSE); goto qWfMI; oTauY: Br3TK: goto SBbDr; fUyNt: $this->db->where("\x6c\x6f\x67\151\156", $identity); goto wlNv0; h3SnP: WYWzF: goto TT86O; BN6MQ: return $qres->num_rows(); goto cy99r; AgQxL: return 0; goto jP0CF; wlNv0: if (!$this->config->item("\164\x72\141\x63\153\x5f\x6c\157\147\x69\x6e\x5f\x69\x70\x5f\141\x64\144\x72\145\163\x73", "\x69\157\156\137\141\x75\x74\150")) { goto Br3TK; } goto M0ICD; Izd8n: if (!$this->config->item("\164\162\x61\x63\153\137\x6c\x6f\147\x69\156\x5f\141\x74\x74\145\x6d\160\164\163", "\151\x6f\x6e\x5f\141\x75\x74\150")) { goto G5V03; } goto LSABM; jP0CF: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto TT39e; lTIeQ: zXXb4: goto I8ITt; cFoNk: $qres = $this->db->get($this->tables["\x6c\157\x67\151\x6e\137\x61\x74\x74\x65\x6d\x70\x74\x73"], 1); goto MOlgt; kIVvj: $ip_address = $this->input->ip_address(); goto GaoIj; pym_m: return $qres->row()->time; goto YKw38; uYYRn: $this->db->where("\x69\x70\137\141\x64\144\x72\145\x73\x73", $ip_address); goto Xg26q; Y6joX: if (!$this->config->item("\x74\162\141\143\153\x5f\154\157\x67\151\x6e\137\x69\x70\137\141\x64\x64\162\x65\x73\163", "\x69\x6f\156\x5f\141\x75\164\x68")) { goto TpXCN; } goto zWnZ5; GaoIj: aod8R: goto uYYRn; Xg26q: TpXCN: goto p3yF0; xW_F4: $this->db->where("\154\157\x67\x69\156", $identity); goto Y6joX; YKw38: zma9x: goto lTIeQ; MOlgt: if (!($qres->num_rows() > 0)) { goto zma9x; } goto pym_m; zWnZ5: if (isset($ip_address)) { goto aod8R; } goto kIVvj; TT39e: if (!$this->config->item("\x74\162\x61\x63\153\137\x6c\157\147\151\x6e\x5f\x61\x74\164\145\155\x70\x74\x73", "\x69\x6f\156\137\x61\165\x74\x68")) { goto zXXb4; } goto hTS6o; p3yF0: $this->db->order_by("\151\144", "\144\145\x73\143"); goto cFoNk; I8ITt: return 0; goto vBOKm; hTS6o: $this->db->select("\x74\151\x6d\x65"); goto xW_F4; vBOKm: } public function get_last_attempt_ip($identity) { goto xdaG6; Od2up: return $qres->row()->ip_address; goto eGf5U; avs7a: TPzNF: goto w1aKV; eGf5U: V07iT: goto avs7a; EkMSK: $qres = $this->db->get($this->tables["\x6c\x6f\147\151\x6e\x5f\x61\164\164\x65\x6d\160\164\x73"], 1); goto vXK35; eMXug: $this->db->select("\x69\160\137\141\x64\x64\162\x65\163\163"); goto NX2Eu; NX2Eu: $this->db->where("\154\157\x67\151\156", $identity); goto nkdRV; w1aKV: return ''; goto RsyiH; nkdRV: $this->db->order_by("\x69\144", "\144\145\163\x63"); goto EkMSK; xdaG6: if (!($this->config->item("\164\x72\x61\143\x6b\137\154\157\147\151\156\x5f\141\x74\164\145\x6d\160\164\163", "\151\x6f\156\137\x61\x75\164\x68") && $this->config->item("\164\x72\141\x63\153\x5f\x6c\x6f\147\x69\156\137\x69\160\137\x61\144\144\x72\x65\163\x73", "\151\x6f\x6e\x5f\x61\x75\164\150"))) { goto TPzNF; } goto eMXug; vXK35: if (!($qres->num_rows() > 0)) { goto V07iT; } goto Od2up; RsyiH: } public function increase_login_attempts($identity) { goto tfWgH; wWgzh: if (!$this->config->item("\164\x72\x61\x63\153\x5f\x6c\157\147\x69\156\137\151\x70\137\x61\x64\144\162\x65\163\x73", "\x69\157\156\x5f\141\x75\164\x68")) { goto BZv9z; } goto GE7CJ; m4SKz: ow1Tl: goto zSohm; tfWgH: if (!$this->config->item("\164\162\x61\143\x6b\x5f\154\x6f\147\x69\x6e\x5f\x61\164\x74\145\x6d\160\164\x73", "\151\x6f\x6e\x5f\x61\165\164\x68")) { goto ow1Tl; } goto nemqa; k0Ch4: BZv9z: goto KBYRg; zSohm: return FALSE; goto DWYqS; GE7CJ: $data["\x69\x70\137\141\144\x64\162\x65\163\163"] = $this->input->ip_address(); goto k0Ch4; nemqa: $data = ["\x69\160\137\x61\144\x64\162\145\163\163" => '', "\154\157\x67\x69\x6e" => $identity, "\x74\151\x6d\x65" => time()]; goto wWgzh; KBYRg: return $this->db->insert($this->tables["\x6c\x6f\x67\x69\x6e\137\x61\x74\x74\x65\x6d\x70\164\163"], $data); goto m4SKz; DWYqS: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto B1xz8; SfV3R: $ip_address = $this->input->ip_address(); goto YlSt7; LtG7v: $this->db->where("\x69\x70\137\141\144\x64\162\145\x73\x73", $ip_address); goto kL3Nb; L5ejm: return $this->db->delete($this->tables["\154\x6f\x67\151\x6e\x5f\x61\x74\x74\x65\x6d\160\164\163"]); goto G1sKN; vUdLe: return FALSE; goto Q8Dsx; B1xz8: if (!$this->config->item("\164\x72\141\x63\153\x5f\x6c\157\147\x69\x6e\137\141\x74\x74\145\x6d\x70\164\x73", "\151\x6f\156\137\x61\x75\x74\150")) { goto znYn7; } goto FUNpl; kL3Nb: NsyS0: goto FdIkR; YlSt7: qUqy2: goto LtG7v; FdIkR: $this->db->or_where("\164\x69\155\x65\x20\x3c", time() - $old_attempts_expire_period, FALSE); goto L5ejm; G1sKN: znYn7: goto vUdLe; woLuF: if (isset($ip_address)) { goto qUqy2; } goto SfV3R; foo1A: $this->db->where("\154\x6f\x67\151\156", $identity); goto L3M4K; L3M4K: if (!$this->config->item("\164\162\141\x63\x6b\x5f\x6c\157\x67\x69\156\137\151\x70\x5f\141\x64\144\x72\x65\x73\x73", "\151\157\156\137\x61\x75\164\x68")) { goto NsyS0; } goto woLuF; FUNpl: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\143\153\x6f\165\164\137\x74\151\x6d\145", "\151\157\x6e\x5f\141\x75\x74\x68")); goto foo1A; Q8Dsx: } public function limit($limit) { goto yyfpC; rpGX4: return $this; goto ZnZ3j; yyfpC: $this->trigger_events("\154\x69\155\151\x74"); goto C7Ex_; C7Ex_: $this->_ion_limit = $limit; goto rpGX4; ZnZ3j: } public function offset($offset) { goto Vp0tq; JLb5H: $this->_ion_offset = $offset; goto Uos0v; Vp0tq: $this->trigger_events("\x6f\x66\x66\163\145\x74"); goto JLb5H; Uos0v: return $this; goto AU6I_; AU6I_: } public function where($where, $value = NULL) { goto loj0t; LEi1F: array_push($this->_ion_where, $where); goto nuGtl; NkflJ: $where = [$where => $value]; goto a_uSs; a_uSs: V6eg3: goto LEi1F; nuGtl: return $this; goto NAaSu; hgbGa: if (is_array($where)) { goto V6eg3; } goto NkflJ; loj0t: $this->trigger_events("\x77\150\x65\162\145"); goto hgbGa; NAaSu: } public function like($like, $value = NULL, $position = "\x62\157\164\x68") { goto XqrWb; qIMQq: return $this; goto rw0N4; EjrIT: array_push($this->_ion_like, ["\154\151\153\x65" => $like, "\166\141\154\x75\x65" => $value, "\160\x6f\x73\x69\164\151\x6f\x6e" => $position]); goto qIMQq; XqrWb: $this->trigger_events("\x6c\x69\x6b\145"); goto EjrIT; rw0N4: } public function select($select) { goto eZ6Ga; ZqFJC: return $this; goto gCa_I; eZ6Ga: $this->trigger_events("\163\145\154\x65\143\164"); goto l5lVC; l5lVC: $this->_ion_select[] = $select; goto ZqFJC; gCa_I: } public function order_by($by, $order = "\144\x65\x73\143") { goto mfa3B; ubbVq: $this->_ion_order_by = $by; goto Oz272; mfa3B: $this->trigger_events("\157\x72\x64\x65\162\x5f\142\171"); goto ubbVq; u8qqZ: return $this; goto K2Ji7; Oz272: $this->_ion_order = $order; goto u8qqZ; K2Ji7: } public function row() { goto Gr8LU; BdP8x: $row = $this->response->row(); goto wpfQ_; wpfQ_: return $row; goto z_xSZ; Gr8LU: $this->trigger_events("\x72\x6f\167"); goto BdP8x; z_xSZ: } public function row_array() { goto tWZBb; tWZBb: $this->trigger_events(["\162\157\x77", "\x72\x6f\x77\x5f\x61\162\x72\x61\x79"]); goto JyeOx; LavU8: return $row; goto OAbV0; JyeOx: $row = $this->response->row_array(); goto LavU8; OAbV0: } public function result() { goto aGO7M; fcGkD: return $result; goto sJhuq; aGO7M: $this->trigger_events("\x72\145\163\x75\154\x74"); goto XTzZi; XTzZi: $result = $this->response->result(); goto fcGkD; sJhuq: } public function result_array() { goto qr1Ab; qr1Ab: $this->trigger_events(["\x72\x65\x73\x75\x6c\164", "\162\145\163\165\154\x74\x5f\141\162\162\141\x79"]); goto X2O7E; H2FIq: return $result; goto ZA0zr; X2O7E: $result = $this->response->result_array(); goto H2FIq; ZA0zr: } public function num_rows() { goto J5WSX; J5WSX: $this->trigger_events(["\x6e\165\x6d\137\162\157\167\163"]); goto YFycj; YFycj: $result = $this->response->num_rows(); goto Mj0SC; Mj0SC: return $result; goto BuzNj; BuzNj: } public function users($groups = NULL) { goto i5Njj; sM3G7: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto eehBj; qlsg4: $this->db->{$or_where_in}($this->tables["\x75\x73\x65\162\163\137\147\x72\x6f\165\x70\163"] . "\x2e" . $this->join["\x67\162\157\165\x70\163"], $group_ids); goto HbNed; QMEpA: goto wJnfR; goto dM87_; y3TKK: foreach ($this->_ion_where as $where) { $this->db->where($where); opSO_: } goto e9811; BM50U: ij5Td: goto g8a0K; qoeK7: WFVVf: goto iy3ey; HbNed: NFkuB: goto CY2o9; CPDVb: $this->_ion_order_by = NULL; goto J4iic; CHZjs: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\153\145"], $like["\166\141\154\x75\x65"], $like["\160\157\x73\x69\x74\151\157\x6e"]); vLXeK: } goto BM50U; lm_6H: $this->db->distinct(); goto W61ZF; W61ZF: $this->db->join($this->tables["\x75\x73\145\x72\x73\x5f\x67\162\x6f\x75\160\163"], $this->tables["\x75\163\145\162\163\x5f\147\162\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x75\163\145\162\x73"] . "\x3d" . $this->tables["\165\163\x65\x72\163"] . "\56\x69\x64", "\151\156\x6e\x65\x72"); goto BEia8; QCWfN: if (!isset($groups)) { goto OFKfx; } goto yHYRd; B6A6H: ei5Ay: goto vQ2Y4; EAMhF: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto ei5Ay; } goto y3TKK; RAFSO: if (empty($group_ids)) { goto NFkuB; } goto qlsg4; xK9dO: gmVSC: goto RQmdP; e9811: Bb5hc: goto SBvdn; E3nZt: if (!(isset($groups) && !empty($groups))) { goto LptXk; } goto lm_6H; i5Njj: $this->trigger_events("\165\x73\145\x72\163"); goto erW5V; rqyyt: if (!isset($this->_ion_limit)) { goto Vt0xF; } goto XZGy5; vQ2Y4: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto gmVSC; } goto CHZjs; fXct6: LSE24: goto sM3G7; WO2bp: $group_ids = []; goto R4BQa; XRk07: $groups = [$groups]; goto oq_Ph; SBvdn: $this->_ion_where = []; goto B6A6H; g8a0K: $this->_ion_like = []; goto xK9dO; bINWY: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto j8JLc; NWLFS: cN1Hp: goto REX6K; REX6K: $this->_ion_select = []; goto gfFdI; RQmdP: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto LSE24; } goto rqyyt; BEia8: LptXk: goto WO2bp; CY2o9: OFKfx: goto KccWX; lbFap: $this->db->join($this->tables["\x67\162\x6f\165\160\163"], $this->tables["\x75\163\x65\x72\x73\137\x67\x72\157\x75\160\163"] . "\56" . $this->join["\x67\162\x6f\165\x70\163"] . "\x20\x3d\x20" . $this->tables["\147\x72\x6f\x75\x70\163"] . "\x2e\x69\x64", "\x69\x6e\156\x65\162"); goto jJmRj; XZGy5: $this->db->limit($this->_ion_limit); goto Yq50h; oq_Ph: xR_us: goto E3nZt; R4BQa: $group_names = []; goto FiuzY; FiuzY: foreach ($groups as $group) { goto Bn2Lz; Cs5Lf: $group_ids[] = $group; goto iyYag; Rq3FF: qLSqx: goto F0VF3; EoPMp: HWNBo: goto Cs5Lf; iyYag: hRkPR: goto Rq3FF; nESoO: goto hRkPR; goto EoPMp; ADGuo: $group_names[] = $group; goto nESoO; Bn2Lz: if (is_numeric($group)) { goto HWNBo; } goto ADGuo; F0VF3: } goto qoeK7; mn1dh: MRog6: goto Vylto; gfFdI: wJnfR: goto QCWfN; yHYRd: if (is_array($groups)) { goto xR_us; } goto XRk07; StMih: if (empty($group_names)) { goto FogbY; } goto lbFap; Vylto: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto Ln5dB; } goto bINWY; j8JLc: $this->_ion_order = NULL; goto CPDVb; eehBj: $this->_ion_limit = NULL; goto Kv23t; erW5V: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto sltp0; } goto qooUW; z5RBy: goto MRog6; goto fXct6; SgyDb: return $this; goto tFT0B; KccWX: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\167\x68\145\x72\145"); goto EAMhF; qooUW: $this->db->select([$this->tables["\165\163\145\x72\163"] . "\x2e\x2a", $this->tables["\x75\x73\145\x72\x73"] . "\x2e\x69\144\x20\x61\163\40\x69\144", $this->tables["\x75\x73\145\x72\x73"] . "\56\x69\144\40\x61\163\x20\165\x73\145\162\137\x69\x64"]); goto QMEpA; iy3ey: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\x72\x5f\167\x68\x65\x72\x65\137\151\156" : "\x77\x68\x65\x72\145\x5f\x69\156"; goto StMih; MajOq: foreach ($this->_ion_select as $select) { $this->db->select($select); XsJPf: } goto NWLFS; Kv23t: $this->_ion_offset = NULL; goto mn1dh; SnEpw: $this->response = $this->db->get($this->tables["\x75\x73\145\x72\x73"]); goto SgyDb; J4iic: Ln5dB: goto SnEpw; jJmRj: $this->db->where_in($this->tables["\147\162\157\165\x70\x73"] . "\56\156\141\x6d\x65", $group_names); goto hQkzV; dM87_: sltp0: goto MajOq; Yq50h: $this->_ion_limit = NULL; goto IEm4C; hQkzV: FogbY: goto RAFSO; IEm4C: Vt0xF: goto z5RBy; tFT0B: } public function user($id = NULL) { goto e3gUa; e3gUa: $this->trigger_events("\165\163\145\162"); goto V0srI; loRLy: $this->order_by($this->tables["\165\163\145\162\163"] . "\x2e\151\144", "\144\x65\x73\143"); goto kAkTG; V0srI: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\145\x72\x5f\151\x64"); goto DUmqS; DUmqS: $this->limit(1); goto loRLy; vNwCf: return $this; goto lYXAS; OilF_: $this->users(); goto vNwCf; kAkTG: $this->where($this->tables["\x75\163\145\162\163"] . "\x2e\151\x64", $id); goto OilF_; lYXAS: } public function get_users_groups($id = FALSE) { goto Lku71; AKx6B: $id || ($id = $this->session->userdata("\x75\163\145\162\x5f\151\144")); goto vd5u2; Lku71: $this->trigger_events("\x67\x65\x74\x5f\x75\x73\x65\x72\163\137\147\x72\x6f\165\x70"); goto AKx6B; vd5u2: return $this->db->select($this->tables["\165\x73\x65\x72\x73\x5f\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x67\x72\x6f\165\x70\163"] . "\40\141\163\40\x69\x64\x2c\40" . $this->tables["\x67\x72\157\x75\x70\163"] . "\x2e\x6e\x61\x6d\x65\54\40" . $this->tables["\147\x72\157\165\160\x73"] . "\x2e\x64\x65\163\143\162\x69\160\164\151\157\x6e")->where($this->tables["\x75\163\145\x72\x73\x5f\147\x72\157\x75\x70\163"] . "\56" . $this->join["\165\x73\x65\162\163"], $id)->join($this->tables["\147\x72\x6f\165\x70\x73"], $this->tables["\x75\163\145\162\x73\x5f\147\x72\157\165\160\x73"] . "\x2e" . $this->join["\147\x72\157\x75\160\163"] . "\x3d" . $this->tables["\147\x72\157\165\160\163"] . "\x2e\x69\x64")->get($this->tables["\x75\163\x65\x72\163\137\147\x72\x6f\x75\x70\x73"]); goto sC64W; sC64W: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto NLM2O; BJoHJ: goto iwu5y; goto uKhEI; uKhEI: DMplE: goto dGGmS; Q8asf: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; Nq25P: } goto A11Y_; OqoLi: ZT2DF: goto whJtL; yx2o2: iwu5y: goto Jfy6_; E_Nuj: return $check_all; goto yRZKc; gmjdz: $this->_cache_user_in_group[$id] = $groups_array; goto BJoHJ; dGGmS: $groups_array = $this->_cache_user_in_group[$id]; goto yx2o2; whJtL: if (isset($this->_cache_user_in_group[$id])) { goto DMplE; } goto AswN7; R94FD: $check_group = [$check_group]; goto OqoLi; A11Y_: GXLwf: goto gmjdz; Jfy6_: foreach ($check_group as $key => $value) { goto ovtUY; VgucH: if (!(in_array($value, $groups) xor $check_all)) { goto pxPSt; } goto MIZ4s; ovtUY: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto VgucH; MIZ4s: return !$check_all; goto S9eoK; E2mWE: r3AvT: goto QaOw2; S9eoK: pxPSt: goto E2mWE; QaOw2: } goto lTjz2; AswN7: $users_groups = $this->get_users_groups($id)->result(); goto pfH7k; A3qzt: if (is_array($check_group)) { goto ZT2DF; } goto R94FD; oMEfW: $id || ($id = $this->session->userdata("\165\163\x65\x72\137\x69\x64")); goto A3qzt; lTjz2: yx08_: goto E_Nuj; pfH7k: $groups_array = []; goto Q8asf; NLM2O: $this->trigger_events("\151\x6e\137\147\162\x6f\x75\160"); goto oMEfW; yRZKc: } public function add_to_group($group_ids, $user_id = FALSE) { goto qPszc; PTtQw: $user_id || ($user_id = $this->session->userdata("\165\x73\145\162\137\x69\x64")); goto mqDSR; VL9WV: $group_ids = [$group_ids]; goto Gt39U; mqDSR: if (is_array($group_ids)) { goto x07j7; } goto VL9WV; plai0: return $return; goto Ryg72; CqjpD: U65z9: goto plai0; qPszc: $this->trigger_events("\x61\144\x64\137\x74\157\x5f\147\x72\157\165\x70"); goto PTtQw; Gt39U: x07j7: goto lMYSr; lMYSr: $return = 0; goto B8l58; B8l58: foreach ($group_ids as $group_id) { goto Vt5iB; Vt5iB: if (!$this->db->insert($this->tables["\165\163\145\x72\163\x5f\147\x72\x6f\165\x70\163"], [$this->join["\x67\x72\157\165\160\x73"] => (float) $group_id, $this->join["\165\163\145\x72\163"] => (float) $user_id])) { goto Xg8yH; } goto Tvk3K; HLxIJ: goto IVGQT; goto IjBTp; lG5Sw: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto B174S; B174S: $return++; goto QVtCf; IjBTp: SAlf_: goto aj0uK; aj0uK: $group_name = $this->_cache_groups[$group_id]; goto Hdqj3; zcyuw: $group_name = $group[0]->name; goto LzK07; Hdqj3: IVGQT: goto lG5Sw; Tvk3K: if (isset($this->_cache_groups[$group_id])) { goto SAlf_; } goto pzTjT; pzTjT: $group = $this->group($group_id)->result(); goto zcyuw; LzK07: $this->_cache_groups[$group_id] = $group_name; goto HLxIJ; QVtCf: Xg8yH: goto ghcmD; ghcmD: zsmDu: goto J66rO; J66rO: } goto CqjpD; Ryg72: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto OT5qn; Sfgfz: foreach ($group_ids as $group_id) { goto g4U7N; wjSpg: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto Z5ugZ; } goto LJMpo; LJMpo: unset($this->_cache_user_in_group[$user_id][$group_id]); goto hagi8; hagi8: Z5ugZ: goto UzFBl; UzFBl: b34kM: goto xeMfZ; g4U7N: $this->db->delete($this->tables["\165\x73\x65\162\163\137\147\162\x6f\165\160\163"], [$this->join["\147\x72\157\165\160\163"] => (float) $group_id, $this->join["\x75\x73\145\x72\163"] => (float) $user_id]); goto wjSpg; xeMfZ: } goto VbOKG; QGja0: syA_p: goto sZpGV; Dr_Yi: return FALSE; goto E0Gxd; luKNt: return $return; goto Ki4Vp; E0Gxd: hg3hf: goto MzSSU; K5VQI: $return = TRUE; goto VZpfT; bGsKE: if (!empty($user_id)) { goto hg3hf; } goto Dr_Yi; OT5qn: $this->trigger_events("\162\x65\155\x6f\x76\145\x5f\x66\x72\x6f\155\x5f\x67\x72\x6f\x75\x70"); goto bGsKE; WivAk: $group_ids = [$group_ids]; goto klI_C; MzSSU: if (!empty($group_ids)) { goto syA_p; } goto ZyB6Q; sZpGV: if (is_array($group_ids)) { goto Fkh16; } goto WivAk; VbOKG: EyZEy: goto K5VQI; klI_C: Fkh16: goto Sfgfz; WFi_V: $this->_cache_user_in_group[$user_id] = []; goto sRVZo; ZyB6Q: if (!($return = $this->db->delete($this->tables["\165\x73\x65\x72\x73\137\x67\x72\x6f\165\x70\163"], [$this->join["\x75\x73\145\x72\x73"] => (float) $user_id]))) { goto kxChf; } goto WFi_V; yDpa0: goto F2kri; goto QGja0; VZpfT: F2kri: goto luKNt; sRVZo: kxChf: goto yDpa0; Ki4Vp: } public function groups() { goto cMbfd; Ns3V0: X5Twg: goto suH5Q; uXzub: goto X5Twg; goto aTxW_; iJoVV: $this->_ion_limit = NULL; goto n1oSr; lXH0w: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto iJoVV; ntiuY: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto blCw6; } goto s2krH; H9DPX: ACqP9: goto ntiuY; W2aKk: return $this; goto lCgdc; n1oSr: $this->_ion_offset = NULL; goto Ns3V0; s2krH: if (!isset($this->_ion_limit)) { goto zZvqc; } goto Kl7yo; C1OoM: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto ACqP9; } goto euKvr; YcLLR: $this->response = $this->db->get($this->tables["\147\x72\157\165\x70\163"]); goto W2aKk; euKvr: foreach ($this->_ion_where as $where) { $this->db->where($where); LPAOm: } goto oNOMm; tRGFD: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto FPVGK; BRGN0: zZvqc: goto uXzub; r7WuG: $this->_ion_where = []; goto H9DPX; suH5Q: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto b6YQL; } goto tRGFD; FPVGK: b6YQL: goto YcLLR; oNOMm: RmwwS: goto r7WuG; koT42: $this->_ion_limit = NULL; goto BRGN0; cMbfd: $this->trigger_events("\x67\162\x6f\165\x70\x73"); goto C1OoM; aTxW_: blCw6: goto lXH0w; Kl7yo: $this->db->limit($this->_ion_limit); goto koT42; lCgdc: } public function group($id = NULL) { goto cQOYu; XgX5r: $this->limit(1); goto t07t_; q2Zbr: dGWVB: goto XgX5r; t07t_: $this->order_by("\x69\x64", "\144\145\163\x63"); goto VrDg3; cQOYu: $this->trigger_events("\147\x72\157\165\x70"); goto lgEmw; VrDg3: return $this->groups(); goto QfAvU; lgEmw: if (!isset($id)) { goto dGWVB; } goto j_Bss; j_Bss: $this->where($this->tables["\x67\x72\x6f\165\160\163"] . "\56\151\x64", $id); goto q2Zbr; QfAvU: } public function update($id, array $data) { goto mf91i; LB120: $this->set_error("\165\x70\144\141\164\x65\x5f\165\x6e\163\x75\143\x63\145\x73\163\x66\x75\154"); goto IpThC; MPzK1: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto aFbYU; } goto nABsN; a0mft: $data["\x70\141\x73\163\x77\x6f\162\x64"] = $this->hash_password($data["\x70\141\x73\163\x77\157\162\x64"], $user->{$this->identity_column}); goto UQfAU; f2uQY: $this->trigger_events("\145\170\164\162\x61\x5f\167\x68\x65\162\145"); goto l9rjs; aDbBD: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\x73\163\x77\157\x72\144", $data) || array_key_exists("\x65\x6d\141\151\154", $data))) { goto uQnDI; } goto KlBGJ; T27Zx: $this->db->trans_rollback(); goto pLpop; VT1ni: goto EtZFq; goto YW7uZ; gu7H1: IXUy8: goto DQc_X; UQfAU: if (!($data["\x70\x61\x73\x73\167\157\162\144"] === FALSE)) { goto IXUy8; } goto jB3uM; KdEaW: $this->db->trans_commit(); goto uQM8g; i4Gvq: JxGWd: goto KdEaW; uQM8g: $this->trigger_events(["\x70\157\x73\x74\x5f\165\160\x64\141\x74\145\137\x75\x73\x65\162", "\160\157\x73\164\x5f\165\x70\x64\141\x74\145\x5f\165\163\145\162\x5f\163\165\x63\143\145\x73\163\146\x75\154"]); goto yyZMc; KlBGJ: if (!array_key_exists("\x70\x61\x73\163\167\x6f\x72\x64", $data)) { goto oxuMY; } goto vyExN; DQc_X: EtZFq: goto yupc4; AVODb: $this->set_error("\x61\x63\143\x6f\x75\x6e\x74\x5f\143\162\145\141\164\151\x6f\x6e\137\144\x75\x70\154\x69\x63\x61\164\145\137\151\144\x65\x6e\164\151\x74\x79"); goto hkEy4; yyZMc: $this->set_message("\165\x70\144\x61\164\145\137\x73\x75\x63\x63\145\x73\x73\x66\165\x6c"); goto PNQN_; YW7uZ: t0Rca: goto a0mft; vyExN: if (!empty($data["\x70\x61\163\x73\167\x6f\162\144"])) { goto t0Rca; } goto igPZz; K_9Ia: return FALSE; goto dosJm; Zi5SC: if (!($this->db->trans_status() === FALSE)) { goto JxGWd; } goto T27Zx; IpThC: return FALSE; goto i4Gvq; igPZz: unset($data["\x70\141\x73\163\167\x6f\x72\144"]); goto VT1ni; jB3uM: $this->db->trans_rollback(); goto e3iK2; dosJm: aFbYU: goto DghnU; DghnU: $data = $this->_filter_data($this->tables["\165\163\145\162\x73"], $data); goto aDbBD; i02QC: uQnDI: goto f2uQY; pbBMh: return FALSE; goto gu7H1; mf91i: $this->trigger_events("\160\x72\x65\137\165\160\144\x61\x74\x65\137\165\x73\145\162"); goto zmuC1; KjzGT: $this->set_error("\165\160\x64\x61\164\x65\137\165\156\x73\x75\143\143\145\163\163\146\165\154"); goto pbBMh; pLpop: $this->trigger_events(["\160\x6f\x73\x74\137\165\160\x64\141\x74\145\137\x75\x73\145\x72", "\x70\157\163\x74\x5f\x75\160\144\141\x74\x65\x5f\x75\163\145\x72\x5f\165\156\x73\165\143\143\x65\x73\163\x66\165\154"]); goto LB120; hkEy4: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\160\x64\141\x74\x65\x5f\x75\163\145\162", "\160\x6f\163\164\137\165\160\x64\141\164\145\x5f\165\x73\145\x72\137\x75\x6e\x73\165\x63\143\145\163\163\146\x75\154"]); goto DGzyO; kxhlq: $this->db->trans_begin(); goto MPzK1; nABsN: $this->db->trans_rollback(); goto AVODb; l9rjs: $this->db->update($this->tables["\165\x73\145\162\163"], $data, ["\151\x64" => $user->id]); goto Zi5SC; PNQN_: return TRUE; goto aWkqm; zmuC1: $user = $this->user($id)->row(); goto kxhlq; DGzyO: $this->set_error("\x75\x70\x64\141\164\x65\137\165\x6e\x73\x75\143\143\x65\163\x73\146\165\x6c"); goto K_9Ia; e3iK2: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\160\x64\x61\x74\145\137\165\163\x65\x72", "\160\157\x73\x74\x5f\165\160\x64\x61\164\x65\x5f\x75\x73\145\162\x5f\x75\x6e\x73\x75\143\143\145\163\163\x66\165\x6c"]); goto KjzGT; yupc4: oxuMY: goto i02QC; aWkqm: } public function delete_user($id) { goto H1FVw; pjZHN: if (!($this->db->trans_status() === FALSE)) { goto xd_8p; } goto XoacU; bMfMn: $this->trigger_events(["\x70\x6f\163\164\x5f\x64\x65\154\145\x74\x65\137\x75\x73\x65\x72", "\x70\157\x73\164\x5f\144\x65\x6c\x65\x74\x65\x5f\x75\x73\x65\162\137\x75\x6e\163\x75\143\x63\145\x73\163\146\x75\x6c"]); goto MfOj9; agY71: xd_8p: goto OVqEJ; dpgXf: $this->set_message("\x64\x65\x6c\x65\164\145\137\163\165\x63\x63\x65\x73\163\146\x75\154"); goto wkT_P; tBh_V: $this->db->trans_begin(); goto lvByt; lvByt: $this->remove_from_group(NULL, $id); goto ZAr0m; GXlvL: return FALSE; goto agY71; ZAr0m: $this->db->delete($this->tables["\x75\163\145\x72\x73"], ["\151\144" => $id]); goto pjZHN; wkT_P: return TRUE; goto IFXUM; JY1J4: $this->trigger_events(["\x70\157\x73\164\137\x64\145\x6c\145\x74\145\137\165\x73\145\162", "\x70\157\163\x74\x5f\144\145\154\145\x74\x65\x5f\x75\163\x65\162\x5f\163\x75\x63\x63\x65\163\163\146\x75\154"]); goto dpgXf; H1FVw: $this->trigger_events("\160\162\145\137\144\145\x6c\145\x74\145\137\x75\x73\x65\162"); goto tBh_V; XoacU: $this->db->trans_rollback(); goto bMfMn; MfOj9: $this->set_error("\x64\x65\x6c\x65\164\145\137\x75\x6e\x73\165\143\x63\x65\163\163\146\x75\x6c"); goto GXlvL; OVqEJ: $this->db->trans_commit(); goto JY1J4; IFXUM: } public function update_last_login($id) { goto Io22n; m52FE: $this->db->update($this->tables["\165\x73\145\x72\163"], ["\x6c\141\x73\x74\137\x6c\157\147\x69\156" => time()], ["\x69\144" => $id]); goto dS5u3; dS5u3: return $this->db->affected_rows() == 1; goto pYkru; dyLuO: $this->trigger_events("\145\x78\164\162\141\x5f\167\x68\x65\162\145"); goto m52FE; Io22n: $this->trigger_events("\165\x70\144\141\164\x65\137\x6c\141\x73\x74\x5f\x6c\157\147\x69\156"); goto D_Pqj; D_Pqj: $this->load->helper("\x64\141\x74\145"); goto dyLuO; pYkru: } public function set_lang($lang = "\145\156") { goto giKyQ; UKmtY: $expire = self::MAX_COOKIE_LIFETIME; goto Nr3td; OSohc: if ($this->config->item("\x75\163\145\162\137\x65\x78\x70\151\x72\145", "\151\x6f\x6e\137\141\165\164\x68") === 0) { goto YkUVf; } goto c1nqq; FeQEP: YkUVf: goto UKmtY; eOZ1A: set_cookie(["\x6e\141\155\145" => "\154\141\x6e\147\x5f\143\157\x64\145", "\x76\x61\x6c\165\x65" => $lang, "\145\x78\x70\x69\x72\145" => $expire]); goto uwupo; q0uhF: goto wCkrf; goto FeQEP; c1nqq: $expire = $this->config->item("\165\163\x65\162\x5f\x65\170\160\x69\162\145", "\151\157\x6e\x5f\x61\165\x74\x68"); goto q0uhF; Nr3td: wCkrf: goto eOZ1A; giKyQ: $this->trigger_events("\163\145\x74\x5f\x6c\x61\x6e\x67"); goto OSohc; uwupo: return TRUE; goto BjZ8T; BjZ8T: } public function set_session($user) { goto QR8OP; NeuOS: $this->session->set_userdata($session_data); goto p5LRO; z11ms: $session_data = ["\x69\144\145\x6e\x74\151\164\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\x69\154" => $user->email, "\165\x73\x65\162\x5f\x69\144" => $user->id, "\x6f\x6c\x64\137\154\141\163\x74\137\x6c\157\147\x69\156" => $user->last_login, "\x6c\x61\x73\164\137\143\150\145\143\x6b" => time()]; goto NeuOS; Z_pMM: return TRUE; goto rgdHm; QR8OP: $this->trigger_events("\160\162\145\137\163\x65\x74\137\163\145\x73\x73\x69\x6f\156"); goto z11ms; p5LRO: $this->trigger_events("\x70\157\x73\x74\x5f\x73\145\164\x5f\x73\145\163\x73\151\157\x6e"); goto Z_pMM; rgdHm: } public function remember_user($identity) { goto LKS0h; TdQfa: return TRUE; goto pZW5Z; vIFRB: y4PJS: goto fKh8d; EoGJn: lYuOq: goto cPbJb; okSb6: $token = $this->_generate_selector_validator_couple(); goto rmBnK; fKh8d: set_cookie(["\x6e\x61\155\145" => $this->config->item("\162\145\x6d\x65\x6d\x62\145\x72\137\143\157\157\x6b\151\x65\137\156\141\155\145", "\x69\x6f\156\137\141\165\164\x68"), "\x76\x61\154\x75\145" => $token->user_code, "\x65\170\x70\x69\x72\145" => $expire]); goto ra6DG; cPbJb: $expire = self::MAX_COOKIE_LIFETIME; goto vIFRB; QWQM1: $expire = $this->config->item("\165\163\145\162\x5f\145\x78\x70\151\162\x65", "\x69\157\x6e\137\x61\x75\x74\x68"); goto jUKSi; i1aX_: if ($this->config->item("\x75\163\x65\162\137\x65\x78\160\151\162\x65", "\x69\157\x6e\x5f\x61\165\x74\150") === 0) { goto lYuOq; } goto QWQM1; C58MG: J1HSo: goto PgxND; pZW5Z: sk__f: goto C58MG; A3Iq8: if ($identity) { goto Jl4K6; } goto AmgmW; PgxND: $this->trigger_events(["\x70\157\163\x74\x5f\162\x65\x6d\145\155\142\x65\162\137\x75\163\145\x72", "\162\x65\155\x65\x6d\142\145\162\x5f\165\163\145\162\137\x75\x6e\163\165\143\143\x65\163\163\146\165\x6c"]); goto F0ogo; L0JDk: if (!($this->db->affected_rows() > -1)) { goto sk__f; } goto i1aX_; F0ogo: return FALSE; goto ENwBO; LKS0h: $this->trigger_events("\x70\x72\145\137\162\145\x6d\145\x6d\142\145\x72\137\x75\x73\x65\162"); goto A3Iq8; rmBnK: if (!$token->validator_hashed) { goto J1HSo; } goto Sqo5O; AmgmW: return FALSE; goto oaASh; jUKSi: goto y4PJS; goto EoGJn; oaASh: Jl4K6: goto okSb6; ra6DG: $this->trigger_events(["\160\157\163\x74\x5f\162\145\155\145\x6d\x62\x65\162\137\x75\x73\x65\162", "\x72\145\x6d\x65\155\142\x65\x72\137\x75\x73\145\162\137\163\165\143\x63\145\163\x73\x66\165\x6c"]); goto TdQfa; Sqo5O: $this->db->update($this->tables["\165\163\x65\162\163"], ["\x72\145\x6d\x65\155\x62\x65\162\137\163\x65\154\145\x63\164\157\162" => $token->selector, "\162\145\x6d\x65\x6d\x62\x65\x72\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto L0JDk; ENwBO: } public function login_remembered_user() { goto EF2TJ; zLhbc: $user = $query->row(); goto kHm4S; KbJxb: $this->trigger_events("\145\170\x74\x72\x61\137\x77\x68\145\162\x65"); goto SCexW; p8r1M: $this->remember_user($identity); goto g9iAU; g_UqX: if (!($query->num_rows() === 1)) { goto IkN9U; } goto zLhbc; zoDu0: $remember_cookie = get_cookie($this->config->item("\x72\x65\155\145\155\x62\145\x72\137\x63\x6f\157\x6b\151\x65\137\x6e\x61\x6d\145", "\151\x6f\x6e\137\141\x75\164\150")); goto mlEvQ; bYK3m: if (!($token === FALSE)) { goto uSmlf; } goto EV1QB; EV1QB: $this->trigger_events(["\x70\157\x73\164\137\154\x6f\147\x69\x6e\x5f\x72\145\x6d\x65\x6d\142\145\x72\145\144\x5f\165\x73\145\x72", "\x70\157\x73\164\x5f\x6c\x6f\147\151\x6e\x5f\x72\145\155\x65\155\142\145\162\145\144\x5f\x75\163\145\162\x5f\x75\x6e\163\165\143\x63\145\163\x73\x66\165\154"]); goto io7PX; o7HSU: IkN9U: goto TFumq; YrorG: $this->update_last_login($user->id); goto fGPMl; kHm4S: $identity = $user->{$this->identity_column}; goto iLjg6; mlEvQ: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto bYK3m; jXm5h: uSmlf: goto KbJxb; pa71Z: $this->session->sess_regenerate(FALSE); goto T22vR; a6vMK: $this->clear_forgotten_password_code($identity); goto s2NR0; T22vR: $this->trigger_events(["\160\157\x73\164\x5f\154\157\147\x69\x6e\x5f\x72\145\155\145\x6d\x62\x65\x72\x65\144\137\x75\x73\145\162", "\160\157\x73\164\x5f\154\157\147\x69\x6e\x5f\x72\145\155\145\x6d\142\x65\162\x65\x64\x5f\165\163\x65\x72\137\163\165\143\x63\145\163\x73\146\165\x6c"]); goto Dtu1x; SCexW: $query = $this->db->select($this->identity_column . "\54\x20\x69\x64\54\x20\145\155\x61\151\154\x2c\x20\x72\x65\155\x65\155\x62\x65\162\x5f\x63\157\x64\x65\x2c\40\x6c\x61\163\164\x5f\x6c\157\147\151\x6e")->where("\162\x65\155\x65\155\142\x65\162\x5f\x73\145\154\145\143\x74\x6f\162", $token->selector)->where("\x61\x63\164\151\x76\145", 1)->limit(1)->get($this->tables["\x75\163\145\162\x73"]); goto g_UqX; fGPMl: $this->set_session($user); goto a6vMK; LKU_5: return FALSE; goto WYCQs; Dtu1x: return TRUE; goto IvUe2; g9iAU: KC_2g: goto pa71Z; TFumq: delete_cookie($this->config->item("\x72\145\155\145\x6d\142\x65\162\x5f\143\x6f\157\x6b\x69\145\x5f\156\x61\155\x65", "\x69\157\x6e\137\141\165\164\150")); goto UI2Mt; EF2TJ: $this->trigger_events("\x70\162\145\x5f\154\x6f\x67\151\156\x5f\x72\145\155\145\155\142\x65\x72\x65\144\137\165\x73\x65\x72"); goto zoDu0; s2NR0: if (!$this->config->item("\165\163\145\x72\x5f\145\170\164\x65\x6e\x64\137\x6f\x6e\x5f\x6c\x6f\x67\151\x6e", "\151\157\x6e\x5f\141\165\164\x68")) { goto KC_2g; } goto p8r1M; UI2Mt: $this->trigger_events(["\160\157\x73\164\137\154\157\x67\x69\156\137\162\x65\x6d\145\155\x62\x65\x72\145\x64\137\165\163\145\162", "\160\157\163\x74\137\154\x6f\147\151\156\137\162\145\x6d\145\x6d\x62\145\162\145\x64\137\165\163\x65\x72\x5f\165\156\x73\165\143\x63\x65\163\163\146\165\154"]); goto LKU_5; io7PX: return FALSE; goto jXm5h; iLjg6: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto dGVCx; } goto YrorG; IvUe2: dGVCx: goto o7HSU; WYCQs: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto DvY2n; aXxgA: return FALSE; goto DR5Gl; Tlkes: yh8rX: goto pMUso; pMUso: $data = ["\156\141\155\145" => $group_name, "\144\x65\x73\143\162\x69\x70\164\x69\x6f\x6e" => $group_description]; goto bFE32; H_nba: $group_id = $this->db->insert_id($this->tables["\147\x72\157\x75\x70\x73"] . "\137\151\x64\x5f\163\x65\x71"); goto kw0Gn; dYef4: D5x7v: goto IQyHv; zKpU0: $existing_group = $this->db->get_where($this->tables["\147\162\x6f\165\x70\163"], ["\156\x61\155\x65" => $group_name])->num_rows(); goto DLx_0; DR5Gl: OB0yv: goto zKpU0; DvY2n: if ($group_name) { goto OB0yv; } goto QK7IE; kOiuK: return FALSE; goto Tlkes; kw0Gn: $this->set_message("\x67\162\x6f\x75\x70\137\x63\162\145\141\x74\151\x6f\x6e\137\163\165\143\x63\x65\x73\163\146\x75\154"); goto Z40Dz; Z40Dz: return $group_id; goto ck9nv; bFE32: if (empty($additional_data)) { goto D5x7v; } goto bvzdA; IQyHv: $this->trigger_events("\x65\170\164\x72\x61\137\x67\x72\x6f\x75\160\137\x73\145\x74"); goto TvE9r; bvzdA: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\160\163"], $additional_data), $data); goto dYef4; QK7IE: $this->set_error("\x67\x72\x6f\x75\x70\137\156\x61\155\145\137\x72\x65\x71\x75\151\162\145\x64"); goto aXxgA; GMFbN: $this->set_error("\x67\162\157\x75\160\137\x61\154\162\145\x61\x64\171\x5f\145\170\151\163\164\x73"); goto kOiuK; DLx_0: if (!($existing_group !== 0)) { goto yh8rX; } goto GMFbN; TvE9r: $this->db->insert($this->tables["\147\x72\x6f\x75\x70\163"], $data); goto H_nba; ck9nv: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto uC8C8; ovwJM: if (empty($group_name)) { goto Q7ppB; } goto ksdGI; ZfpSk: $this->set_error("\x67\x72\157\x75\160\x5f\x6e\x61\155\x65\x5f\x61\x64\155\x69\x6e\137\x6e\x6f\x74\137\x61\x6c\x74\x65\162"); goto wg7Ab; uysTh: if (empty($additional_data)) { goto W5BHd; } goto aC3qL; wg7Ab: return FALSE; goto PfLQs; Cp4J9: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto CZAU_; } goto e0xo2; IiSc3: return TRUE; goto JDSuj; KED81: return FALSE; goto SX4gu; dr1ri: return FALSE; goto e59x7; WpRvb: if (!($this->config->item("\141\x64\x6d\x69\x6e\137\x67\162\x6f\x75\160", "\151\157\x6e\x5f\141\165\164\x68") === $group->name && $group_name !== $group->name)) { goto Ztg3V; } goto ZfpSk; ddJZI: $data["\156\x61\x6d\x65"] = $group_name; goto G6g5Y; nTKE1: W5BHd: goto uKEWL; G6g5Y: Q7ppB: goto zxEbt; PfLQs: Ztg3V: goto uysTh; ksdGI: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\165\160\163"], ["\156\141\155\145" => $group_name])->row(); goto Cp4J9; aC3qL: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\160\x73"], $additional_data), $data); goto nTKE1; R0NN9: $data = []; goto ovwJM; e0xo2: $this->set_error("\x67\x72\x6f\x75\160\137\x61\154\x72\x65\x61\x64\171\137\145\x78\x69\163\164\163"); goto KED81; SX4gu: CZAU_: goto ddJZI; zxEbt: $group = $this->db->get_where($this->tables["\x67\x72\157\165\x70\163"], ["\151\144" => $group_id])->row(); goto WpRvb; uKEWL: $this->db->update($this->tables["\x67\x72\x6f\x75\160\x73"], $data, ["\x69\144" => $group_id]); goto wuTsF; e59x7: Ji71x: goto R0NN9; uC8C8: if (!empty($group_id)) { goto Ji71x; } goto dr1ri; wuTsF: $this->set_message("\x67\162\x6f\x75\160\x5f\165\160\x64\141\x74\145\x5f\163\165\143\143\145\x73\x73\146\165\154"); goto IiSc3; JDSuj: } public function delete_group($group_id = FALSE) { goto C8VPz; Elbeb: return FALSE; goto eiaD_; jai9w: AEktl: goto R9GnP; hW1nh: $this->trigger_events(["\160\x6f\x73\x74\x5f\x64\x65\154\x65\x74\145\137\x67\162\157\165\x70", "\x70\x6f\x73\164\x5f\144\x65\x6c\x65\x74\145\x5f\147\162\157\165\160\x5f\x73\165\x63\x63\145\x73\x73\146\165\x6c"]); goto Q4lvC; b1LAR: if (!($this->db->trans_status() === FALSE)) { goto AEktl; } goto NcM3i; Q4lvC: $this->set_message("\147\162\x6f\165\x70\137\x64\145\154\x65\164\145\137\x73\165\143\x63\x65\x73\x73\146\165\x6c"); goto odNBl; QzjvZ: gq2mk: goto FOdCV; C8VPz: if (!(!$group_id || empty($group_id))) { goto cN2WT; } goto Elbeb; eiaD_: cN2WT: goto XZXZW; RcU9D: return FALSE; goto jai9w; pkAIt: $this->db->trans_begin(); goto otvBM; Bm_3k: $this->db->delete($this->tables["\147\162\157\165\x70\x73"], ["\x69\x64" => $group_id]); goto b1LAR; otvBM: $this->db->delete($this->tables["\165\x73\145\162\163\137\x67\162\157\x75\160\163"], [$this->join["\x67\162\x6f\165\x70\x73"] => $group_id]); goto Bm_3k; SPrFL: if (!($group->name == $this->config->item("\x61\x64\155\151\x6e\137\147\162\x6f\165\x70", "\151\x6f\x6e\137\x61\165\164\150"))) { goto gq2mk; } goto oD3Nk; MERfv: $this->set_error("\147\162\157\x75\160\x5f\144\x65\154\145\x74\145\137\x6e\x6f\164\141\154\154\157\167\x65\144"); goto K2K4X; FOdCV: $this->trigger_events("\160\162\145\137\144\145\154\x65\x74\145\137\x67\162\157\x75\160"); goto pkAIt; K2K4X: return FALSE; goto QzjvZ; odNBl: return TRUE; goto XhDOF; NcM3i: $this->db->trans_rollback(); goto F2qMl; R9GnP: $this->db->trans_commit(); goto hW1nh; F2qMl: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x64\145\x6c\x65\x74\x65\137\x67\x72\x6f\x75\160", "\160\157\x73\164\137\144\145\x6c\145\x74\145\137\147\x72\x6f\165\x70\137\165\x6e\x73\x75\x63\x63\x65\x73\x73\146\165\154"]); goto C8P_5; oD3Nk: $this->trigger_events(["\x70\x6f\163\x74\137\144\145\154\145\164\145\137\x67\162\x6f\x75\x70", "\x70\x6f\163\164\137\x64\x65\154\145\164\145\137\x67\x72\x6f\165\x70\x5f\156\157\x74\141\154\154\x6f\167\x65\x64"]); goto MERfv; C8P_5: $this->set_error("\147\162\x6f\x75\x70\x5f\x64\145\x6c\145\164\145\x5f\x75\x6e\163\x75\x63\143\x65\163\163\x66\165\x6c"); goto RcU9D; XZXZW: $group = $this->group($group_id)->row(); goto SPrFL; XhDOF: } public function set_hook($event, $name, $class, $method, $arguments) { goto TB65h; DJP_T: $this->_ion_hooks->{$event}[$name]->method = $method; goto YEWMR; TB65h: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto NzBdp; NzBdp: $this->_ion_hooks->{$event}[$name]->class = $class; goto DJP_T; YEWMR: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto rUnzg; rUnzg: } public function remove_hook($event, $name) { goto uF2Ym; uF2Ym: if (!isset($this->_ion_hooks->{$event}[$name])) { goto MM_pG; } goto PQtJ6; PQtJ6: unset($this->_ion_hooks->{$event}[$name]); goto nQzMm; nQzMm: MM_pG: goto tO7MW; tO7MW: } public function remove_hooks($event) { goto is8V8; lrvq2: fCNpM: goto TRJVE; is8V8: if (!isset($this->_ion_hooks->{$event})) { goto fCNpM; } goto I0rzm; I0rzm: unset($this->_ion_hooks->{$event}); goto lrvq2; TRJVE: } protected function _call_hook($event, $name) { goto IpT62; u8E0C: $hook = $this->_ion_hooks->{$event}[$name]; goto bp_T4; MxmvM: return FALSE; goto B_ECq; bp_T4: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto NzacE; IpT62: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto rSFP0; } goto u8E0C; NzacE: rSFP0: goto MxmvM; B_ECq: } public function trigger_events($events) { goto oqIJI; C_HMb: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); lNR3E: } goto G8ch2; jMSj8: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto l8YEO; } goto C_HMb; DHowv: FbZOw: goto i028Q; i028Q: xfl8I: goto L2xNm; oqIJI: if (is_array($events) && !empty($events)) { goto J6xaK; } goto jMSj8; JDP1s: goto xfl8I; goto dkN8c; D70PD: l8YEO: goto JDP1s; G8ch2: RYjpS: goto D70PD; obaSL: foreach ($events as $event) { $this->trigger_events($event); et9ya: } goto DHowv; dkN8c: J6xaK: goto obaSL; L2xNm: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto g7g80; g7g80: $this->message_start_delimiter = $start_delimiter; goto bmptz; bmptz: $this->message_end_delimiter = $end_delimiter; goto Fco4K; Fco4K: return TRUE; goto SfNqx; SfNqx: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto bZKj6; jtydL: $this->error_end_delimiter = $end_delimiter; goto X4XKH; X4XKH: return TRUE; goto u7d5E; bZKj6: $this->error_start_delimiter = $start_delimiter; goto jtydL; u7d5E: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto PS3Rd; R4LJV: return $_output; goto JqYmj; acFiJ: foreach ($this->messages as $message) { goto q336e; JahgA: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto VfpXD; VfpXD: oY1FK: goto zvCVL; q336e: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\43"; goto JahgA; zvCVL: } goto rEzxj; PS3Rd: $_output = ''; goto acFiJ; rEzxj: R43vU: goto R4LJV; JqYmj: } public function messages_array($langify = TRUE) { goto tJAMy; LGIBT: foreach ($this->messages as $message) { goto RGYca; dmfJY: bvlEN: goto P1J37; RGYca: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto m_lBA; m_lBA: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto dmfJY; P1J37: } goto w0LYq; CN52q: $_output = []; goto LGIBT; UMeUF: return $_output; goto OIsmr; w0LYq: facYC: goto UMeUF; wXgy7: goto mCL3f; goto jPTW8; OIsmr: mCL3f: goto p3Win; jPTW8: iZL79: goto CN52q; tJAMy: if ($langify) { goto iZL79; } goto vGF_F; vGF_F: return $this->messages; goto wXgy7; p3Win: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto He79P; ia2mS: qpb7_: goto HV51z; LekQI: foreach ($this->errors as $error) { goto ogbMb; ogbMb: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\43"; goto eBhU1; INc08: Vx40j: goto yzFFm; eBhU1: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto INc08; yzFFm: } goto ia2mS; HV51z: return $_output; goto EVwo8; He79P: $_output = ''; goto LekQI; EVwo8: } public function errors_array($langify = TRUE) { goto LWE1Y; cavxj: return $this->errors; goto iaAJT; LWE1Y: if ($langify) { goto Sblea; } goto cavxj; KMwoV: HpNsC: goto mZoUt; Is45Y: $_output = []; goto IoVh1; IoVh1: foreach ($this->errors as $error) { goto jSRG2; jSRG2: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto tFcHW; m1VaE: WT7YL: goto eFkAC; tFcHW: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto m1VaE; eFkAC: } goto tmDFU; aABHv: return $_output; goto KMwoV; iaAJT: goto HpNsC; goto ltsnU; tmDFU: RcthO: goto aABHv; ltsnU: Sblea: goto Is45Y; mZoUt: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto dmi_F; R9In5: if (!($hash === FALSE)) { goto it4Tm; } goto rY8as; LUBA0: $data = ["\160\141\163\x73\x77\x6f\x72\x64" => $hash, "\162\145\x6d\x65\155\x62\145\x72\137\143\157\x64\145" => NULL, "\x66\x6f\x72\x67\x6f\x74\164\x65\x6e\137\160\141\163\x73\167\x6f\x72\x64\137\143\157\x64\145" => NULL, "\146\x6f\162\x67\x6f\164\x74\145\x6e\x5f\x70\141\x73\163\167\x6f\162\x64\137\164\x69\155\145" => NULL]; goto EZYZR; dmi_F: $hash = $this->hash_password($password, $identity); goto R9In5; tmlYs: return $this->db->affected_rows() == 1; goto f2O4M; AXAGP: it4Tm: goto LUBA0; C0wvS: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto tmlYs; rY8as: return FALSE; goto AXAGP; EZYZR: $this->trigger_events("\x65\170\164\162\141\x5f\167\150\145\162\145"); goto C0wvS; f2O4M: } protected function _filter_data($table, $data) { goto ubGpz; x5aIV: foreach ($columns as $column) { goto RvxbY; jIgin: uwPX2: goto ecV1t; RvxbY: if (!array_key_exists($column, $data)) { goto eTpQ5; } goto fCr3o; G1XAY: eTpQ5: goto jIgin; fCr3o: $filtered_data[$column] = $data[$column]; goto G1XAY; ecV1t: } goto p1z8u; CPdDr: tpF5P: goto f5bBo; ubGpz: $filtered_data = []; goto IRWLf; U_9F6: if (!is_array($data)) { goto tpF5P; } goto x5aIV; p1z8u: OLRqb: goto CPdDr; f5bBo: return $filtered_data; goto vGpAP; IRWLf: $columns = $this->db->list_fields($table); goto U_9F6; vGpAP: } protected function _random_token($result_length = 32) { goto Bnuof; YU7Cd: $result_length = 32; goto DCDyC; IU8zB: if (!function_exists("\x6f\x70\x65\156\163\163\x6c\x5f\162\141\x6e\x64\x6f\x6d\137\160\x73\x65\x75\144\157\x5f\x62\x79\x74\x65\163")) { goto oktUU; } goto G4E5E; EcKzo: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto ARALh; g7c6A: oktUU: goto gszya; JXGA_: return bin2hex(random_bytes($result_length / 2)); goto ND9Bz; UyfQk: if (!function_exists("\x72\x61\x6e\x64\x6f\155\x5f\x62\x79\x74\x65\163")) { goto cjFRK; } goto JXGA_; G4E5E: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto g7c6A; gszya: return FALSE; goto RxLXs; Bnuof: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto vIUpe; } goto YU7Cd; ARALh: ox9ZO: goto IU8zB; ND9Bz: cjFRK: goto aCGJC; aCGJC: if (!function_exists("\x6d\x63\x72\171\160\x74\x5f\143\162\145\141\x74\145\x5f\x69\166")) { goto ox9ZO; } goto EcKzo; DCDyC: vIUpe: goto UyfQk; RxLXs: } protected function _get_hash_parameters($identity = NULL) { goto aX8eF; vJXkR: Y2IFN: goto lFN1X; lFN1X: return $params; goto DVdmG; zjwim: P6w27: goto Xmaol; mwUNG: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\151\x6e\137\147\162\x6f\x75\x70", "\x69\157\156\137\x61\165\x74\150"), $user_id))) { goto P6w27; } goto OH2Ko; OH2Ko: $is_admin = TRUE; goto zjwim; qblOU: switch ($this->hash_method) { case "\x62\143\x72\171\x70\x74": $params = ["\x63\x6f\x73\164" => $is_admin ? $this->config->item("\142\143\162\171\160\164\137\x61\144\x6d\151\x6e\137\x63\157\x73\x74", "\151\x6f\156\137\141\165\164\150") : $this->config->item("\142\143\162\171\160\x74\x5f\x64\145\x66\141\x75\154\x74\x5f\143\x6f\x73\x74", "\151\x6f\x6e\x5f\141\165\x74\x68")]; goto Y2IFN; case "\141\x72\x67\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\162\147\157\x6e\62\137\x61\144\155\151\156\x5f\160\x61\162\x61\x6d\x73", "\x69\x6f\156\x5f\x61\x75\164\x68") : $this->config->item("\141\162\147\x6f\x6e\x32\137\144\145\146\141\165\x6c\164\x5f\160\x61\162\x61\x6d\x73", "\151\157\156\137\141\165\x74\x68"); goto Y2IFN; default: } goto Gn6R1; Xmaol: uTZcw: goto fboDl; uk_gJ: $user_id = $this->get_user_id_from_identity($identity); goto mwUNG; OVIYN: if (!$identity) { goto uTZcw; } goto uk_gJ; fboDl: $params = FALSE; goto qblOU; Gn6R1: tqqrc: goto vJXkR; aX8eF: $is_admin = FALSE; goto OVIYN; DVdmG: } protected function _get_hash_algo() { goto FD3UD; FD3UD: $algo = FALSE; goto Ga68f; WWIr0: return $algo; goto mgQdN; IN1gQ: V4ez0: goto WWIr0; Ga68f: switch ($this->hash_method) { case "\142\143\162\x79\x70\164": $algo = PASSWORD_BCRYPT; goto V4ez0; case "\141\162\147\x6f\x6e\x32": $algo = PASSWORD_ARGON2I; goto V4ez0; default: } goto t724I; t724I: Pnlja: goto IN1gQ; mgQdN: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto jwBWz; rLGLu: $validator = $this->_random_token($validator_size); goto Nt7vb; sQfAr: return (object) ["\x73\x65\x6c\x65\x63\x74\157\162" => $selector, "\x76\x61\154\151\x64\x61\164\x6f\162\x5f\150\141\163\150\x65\144" => $validator_hashed, "\165\163\x65\x72\137\143\157\144\x65" => $user_code]; goto rdfOw; Nt7vb: $validator_hashed = $this->hash_password($validator); goto Q_2So; jwBWz: $selector = $this->_random_token($selector_size); goto rLGLu; Q_2So: $user_code = "{$selector}\x2e{$validator}"; goto sQfAr; rdfOw: } protected function _retrieve_selector_validator_couple($user_code) { goto dzK8k; AnD3o: $tokens = explode("\x2e", $user_code); goto Ag9k9; dzK8k: if (!$user_code) { goto CJ_z3; } goto AnD3o; R70k8: return FALSE; goto dZA0Q; Ag9k9: if (!(count($tokens) === 2)) { goto Ia2pq; } goto ECqNL; uSeVc: CJ_z3: goto R70k8; JbH8x: Ia2pq: goto uSeVc; ECqNL: return (object) ["\163\x65\x6c\x65\x63\x74\157\x72" => $tokens[0], "\x76\141\154\151\x64\x61\x74\x6f\162" => $tokens[1]]; goto JbH8x; dZA0Q: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto UVXy7; jiJPS: YqdDl: goto JnDY_; AL3mH: goto lJtsp; goto iCxqV; gf6tj: $result = $this->_set_password_db($identity, $password); goto yPSjB; tnFxp: if (!($query->num_rows() !== 1)) { goto LxIoD; } goto zEb4x; VIyh5: xwenT: goto yS8E3; c89fN: if ($this->config->item("\163\x74\157\162\x65\137\163\x61\154\164", "\151\157\x6e\x5f\x61\x75\164\150")) { goto YqdDl; } goto Cc4eT; iKGy_: return FALSE; goto noLhm; J1QYp: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto rgwoC; yS8E3: return $result; goto qrNnb; U7uBa: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x73\x68\x61\x31\x5f\160\x61\163\x73\x77\x6f\x72\x64\x5f\155\151\x67\x72\x61\x74\x69\157\x6e", "\x70\157\x73\x74\137\163\x68\141\61\137\x70\141\163\x73\x77\x6f\162\x64\137\x6d\151\x67\x72\x61\x74\151\157\156\x5f\165\156\x73\x75\143\x63\145\x73\x73\146\x75\154"]); goto LWI0L; LWI0L: return FALSE; goto tD5gS; JzPSE: $this->trigger_events(["\160\x6f\x73\x74\137\x73\x68\141\x31\x5f\160\x61\163\x73\167\157\162\x64\x5f\155\151\x67\x72\x61\x74\151\157\x6e", "\160\x6f\163\164\x5f\163\150\x61\61\x5f\x70\x61\163\163\167\x6f\x72\144\137\155\x69\x67\x72\x61\164\x69\157\x6e\x5f\x75\x6e\x73\x75\x63\x63\x65\x73\x73\146\165\x6c"]); goto B1ekc; B1ekc: goto xwenT; goto V9Pq8; V9Pq8: IVz_k: goto KF4jR; KF4jR: $this->trigger_events(["\160\157\163\x74\137\x73\150\141\x31\137\160\141\163\x73\167\157\x72\144\x5f\x6d\x69\147\162\141\164\151\x6f\156", "\160\157\163\x74\x5f\x73\x68\x61\61\x5f\x70\x61\163\163\x77\x6f\x72\x64\x5f\155\x69\x67\x72\x61\x74\x69\157\156\x5f\x73\x75\x63\x63\x65\163\x73\146\165\154"]); goto VIyh5; ZzmWR: return FALSE; goto AL3mH; noLhm: LxIoD: goto S0FMf; rgwoC: goto vw4UT; goto jiJPS; hrilq: if ($hashed_password === $hashed_password_db) { goto zQ4Am; } goto rTZFl; Cc4eT: $salt_length = $this->config->item("\163\x61\154\164\137\154\145\156\x67\164\150", "\151\x6f\156\137\x61\165\164\150"); goto PYXcS; UVXy7: $this->trigger_events("\x70\x72\145\137\x73\150\141\61\x5f\x70\141\x73\163\167\x6f\x72\x64\x5f\x6d\151\147\x72\141\164\151\x6f\156"); goto c89fN; zEb4x: $this->trigger_events(["\160\157\x73\x74\x5f\x73\150\x61\x31\137\160\141\x73\163\x77\157\x72\x64\x5f\155\x69\147\162\141\164\151\x6f\156", "\x70\157\163\164\137\163\150\x61\61\137\x70\x61\163\163\167\x6f\162\x64\x5f\x6d\151\147\x72\x61\164\x69\157\x6e\x5f\165\156\163\165\143\x63\145\x73\163\x66\165\x6c"]); goto iKGy_; wYSrw: vw4UT: goto hrilq; PYXcS: if ($salt_length) { goto plRIM; } goto U7uBa; JnDY_: $query = $this->db->select("\163\141\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\x72\x73"]); goto N8QvS; GW4m1: $salt = substr($hashed_password_db, 0, $salt_length); goto J1QYp; qrNnb: lJtsp: goto u0FC0; S0FMf: $hashed_password = sha1($password . $salt_db->salt); goto wYSrw; N8QvS: $salt_db = $query->row(); goto tnFxp; iCxqV: zQ4Am: goto gf6tj; yPSjB: if ($result) { goto IVz_k; } goto JzPSE; tD5gS: plRIM: goto GW4m1; rTZFl: $this->trigger_events(["\160\157\163\x74\x5f\x73\x68\141\x31\x5f\160\x61\163\x73\167\157\x72\x64\x5f\x6d\x69\147\162\141\x74\151\157\156", "\x70\157\x73\x74\137\163\150\x61\x31\137\160\141\x73\x73\167\x6f\x72\x64\137\155\x69\x67\162\x61\164\x69\x6f\156\x5f\x75\x6e\163\165\143\x63\145\163\x73\x66\x75\154"]); goto ZzmWR; u0FC0: } }
