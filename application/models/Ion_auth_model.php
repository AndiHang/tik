<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\105\x50\x41\124\x48") or exit("\x4e\157\40\144\151\162\145\143\x74\x20\x73\143\162\x69\160\x74\x20\141\x63\x63\145\x73\x73\40\x61\x6c\154\x6f\167\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto ud1LE; J0cJK: $this->lang->load("\151\157\156\137\141\x75\x74\150"); goto AdBKA; Lfzxp: $this->message_end_delimiter = $this->error_end_delimiter; goto NfG3Z; dUqmf: $this->db = $this->load->database($group_name, TRUE, TRUE); goto xKKF7; wPQjH: GR3tq: goto ZNpjL; jtJKl: $delimiters_source = $this->config->item("\x64\x65\x6c\x69\x6d\x69\x74\145\162\163\x5f\163\x6f\x75\162\x63\145", "\x69\157\x6e\x5f\x61\x75\x74\150"); goto oLsFG; VrQBy: $this->identity_column = $this->config->item("\151\144\x65\x6e\x74\x69\164\171", "\x69\x6f\x6e\137\141\x75\164\x68"); goto Ia2qL; bXvw_: $this->hash_method = $this->config->item("\150\x61\163\150\137\155\x65\x74\x68\x6f\x64", "\151\157\156\x5f\x61\x75\164\150"); goto hVZUy; ynDII: $this->error_start_delimiter = $this->config->item("\145\x72\x72\x6f\162\x5f\163\164\141\162\164\137\x64\145\154\151\x6d\151\x74\x65\x72", "\x69\x6f\156\137\x61\x75\164\x68"); goto Uh7xC; xKKF7: goto GR3tq; goto P0pFt; b7gu0: $this->load->library("\x66\157\x72\x6d\x5f\166\x61\154\x69\144\x61\x74\151\x6f\156"); goto DOazT; MKNUo: $this->message_start_delimiter = $this->error_start_delimiter; goto Z9CxK; DOazT: $form_validation_class = new ReflectionClass("\x43\x49\x5f\106\x6f\162\x6d\137\166\x61\x6c\x69\x64\141\x74\x69\x6f\x6e"); goto r0RlA; Ck3xj: $this->errors = []; goto jtJKl; H_zsS: $error_suffix->setAccessible(TRUE); goto Kp_mE; oLsFG: if ($delimiters_source === "\146\x6f\162\155\x5f\166\141\154\151\144\141\164\151\157\156") { goto i9sWY; } goto xmc7L; Uh7xC: $this->error_end_delimiter = $this->config->item("\x65\x72\162\x6f\162\137\145\x6e\x64\x5f\x64\145\x6c\151\x6d\151\164\145\162", "\151\157\156\137\x61\x75\164\150"); goto H1M_b; X_xYn: $CI =& get_instance(); goto Cm_4o; ZNpjL: $this->tables = $this->config->item("\164\x61\x62\154\x65\163", "\151\x6f\x6e\137\x61\x75\x74\150"); goto VrQBy; r0RlA: $error_prefix = $form_validation_class->getProperty("\137\145\162\162\157\x72\137\x70\162\145\146\151\170"); goto y9MiG; Ia2qL: $this->join = $this->config->item("\x6a\x6f\x69\x6e", "\151\x6f\156\x5f\141\165\x74\150"); goto bXvw_; Cm_4o: $this->db = $CI->db; goto wPQjH; qFmao: $this->load->helper("\144\x61\164\145"); goto J0cJK; P0pFt: areKx: goto X_xYn; hVZUy: $this->messages = []; goto Ck3xj; nemwL: $this->load->helper("\x63\157\x6f\153\151\145"); goto qFmao; NfG3Z: foWuA: goto Ou8F0; AdBKA: $group_name = $this->config->item("\144\141\164\x61\142\141\x73\145\x5f\x67\162\157\165\x70\x5f\156\x61\x6d\145", "\151\157\x6e\137\x61\165\x74\150"); goto nNi08; H1M_b: goto foWuA; goto tQ4V5; tQ4V5: i9sWY: goto b7gu0; xmc7L: $this->message_start_delimiter = $this->config->item("\x6d\145\x73\x73\141\x67\x65\137\163\164\x61\x72\x74\137\144\x65\154\151\155\x69\164\x65\x72", "\x69\x6f\x6e\137\x61\165\164\150"); goto gJwB2; Z9CxK: $error_suffix = $form_validation_class->getProperty("\137\145\x72\x72\157\x72\x5f\163\165\146\146\151\170"); goto H_zsS; nNi08: if (empty($group_name)) { goto areKx; } goto dUqmf; Kp_mE: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto Lfzxp; aeUM4: $this->trigger_events("\x6d\157\x64\x65\x6c\x5f\143\157\156\x73\164\162\x75\143\x74\x6f\x72"); goto hbiuZ; Ou8F0: $this->_ion_hooks = new stdClass(); goto aeUM4; AiK8Q: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto MKNUo; gJwB2: $this->message_end_delimiter = $this->config->item("\155\x65\163\163\x61\147\x65\x5f\145\x6e\144\x5f\x64\145\x6c\151\x6d\x69\164\x65\x72", "\151\x6f\156\x5f\x61\x75\164\x68"); goto ynDII; y9MiG: $error_prefix->setAccessible(TRUE); goto AiK8Q; ud1LE: $this->config->load("\151\157\x6e\137\x61\165\x74\150", TRUE); goto nemwL; hbiuZ: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto ZYlx9; g1jls: TVk6n: goto dM7UO; y8dCH: $params = $this->_get_hash_parameters($identity); goto JugcK; JugcK: if (!($algo !== FALSE && $params !== FALSE)) { goto dIyqO; } goto JO6WU; Ae1J6: dIyqO: goto hY3zX; JO6WU: return password_hash($password, $algo, $params); goto Ae1J6; hY3zX: return FALSE; goto lpRNK; dM7UO: $algo = $this->_get_hash_algo(); goto y8dCH; ZYlx9: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto TVk6n; } goto ClJBe; ClJBe: return FALSE; goto g1jls; lpRNK: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto DtupY; ckrB8: goto e7OxE; goto HXbuM; ndrTI: return FALSE; goto ef55W; fI126: return password_verify($password, $hash_password_db); goto RnsrJ; HXbuM: G4mUx: goto fI126; RnsrJ: e7OxE: goto vQZD3; uh5_D: if (strpos($hash_password_db, "\44") === 0) { goto G4mUx; } goto sq9lV; ef55W: zpyyf: goto uh5_D; sq9lV: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto ckrB8; DtupY: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto zpyyf; } goto ndrTI; vQZD3: } public function rehash_password_if_needed($hash, $identity, $password) { goto GV2Mg; dR5D2: if (!password_needs_rehash($hash, $algo, $params)) { goto BuLoK; } goto scXcc; nmAPU: BuLoK: goto w1VQW; tv06Y: $this->trigger_events(["\162\145\150\141\x73\150\137\x70\141\x73\x73\167\x6f\x72\x64", "\x72\145\150\x61\163\x68\x5f\160\x61\x73\x73\167\x6f\162\x64\137\165\x6e\163\x75\x63\x63\145\163\x73\x66\x75\154"]); goto wepZP; YpJqF: $params = $this->_get_hash_parameters($identity); goto v13GM; LfbYs: JMdiw: goto gUM5i; v13GM: if (!($algo !== FALSE && $params !== FALSE)) { goto mQ6cD; } goto dR5D2; GV2Mg: $algo = $this->_get_hash_algo(); goto YpJqF; wepZP: goto BopJC; goto LfbYs; uFtYX: BopJC: goto nmAPU; gUM5i: $this->trigger_events(["\x72\x65\150\x61\163\150\137\160\141\163\x73\x77\x6f\x72\144", "\162\145\x68\141\163\150\x5f\160\x61\x73\x73\167\157\162\x64\137\163\x75\143\x63\145\x73\x73\x66\x75\x6c"]); goto uFtYX; scXcc: if ($this->_set_password_db($identity, $password)) { goto JMdiw; } goto tv06Y; w1VQW: mQ6cD: goto qz5oX; qz5oX: } public function get_user_by_activation_code($user_code) { goto KAsf7; NmMA1: TODbA: goto UUyXd; vRrEE: return $user; goto NmMA1; Y5JPQ: if (!$user) { goto NG2lZ; } goto xs_PR; xs_PR: if (!$this->verify_password($token->validator, $user->activation_code)) { goto TODbA; } goto vRrEE; zqU_Q: $user = $this->where("\x61\x63\164\x69\x76\x61\164\x69\x6f\x6e\137\163\x65\154\x65\143\164\x6f\162", $token->selector)->users()->row(); goto Y5JPQ; KAsf7: $token = $this->_retrieve_selector_validator_couple($user_code); goto zqU_Q; WClDt: return FALSE; goto wRzyp; UUyXd: NG2lZ: goto WClDt; wRzyp: } public function activate($id, $code = FALSE) { goto B14dq; cTD59: $this->trigger_events("\x65\170\x74\x72\141\x5f\167\150\x65\x72\x65"); goto OW0kF; W9Dxb: if (!($this->db->affected_rows() === 1)) { goto ltgkD; } goto XqMVq; qk4iG: $data = ["\x61\x63\x74\x69\166\x61\164\151\x6f\x6e\137\163\x65\x6c\x65\x63\x74\157\162" => NULL, "\x61\x63\x74\151\x76\141\x74\x69\x6f\x6e\x5f\143\157\x64\145" => NULL, "\x61\x63\x74\151\166\x65" => 1]; goto cTD59; Pm30G: if (!($code !== FALSE)) { goto O4Wlj; } goto RwNPO; JdiWP: ltgkD: goto gDpPd; cYfGv: O4Wlj: goto s6Jbg; qcfOC: return FALSE; goto krGAJ; B14dq: $this->trigger_events("\160\x72\145\137\x61\143\x74\x69\166\x61\x74\x65"); goto Pm30G; gDpPd: gYIEQ: goto sZ8NL; ZjpL6: $this->set_error("\141\x63\164\151\166\141\164\x65\137\x75\x6e\x73\165\x63\x63\145\x73\163\x66\x75\x6c"); goto qcfOC; SSfyq: $this->set_message("\141\x63\x74\x69\166\141\x74\x65\137\x73\165\x63\x63\145\x73\x73\146\165\x6c"); goto aRZGZ; aRZGZ: return TRUE; goto JdiWP; OW0kF: $this->db->update($this->tables["\x75\163\x65\x72\163"], $data, ["\x69\x64" => $id]); goto W9Dxb; sZ8NL: $this->trigger_events(["\x70\157\x73\x74\x5f\141\143\x74\151\166\141\164\x65", "\160\x6f\163\x74\137\141\x63\164\x69\166\141\x74\x65\137\x75\x6e\163\165\143\143\145\163\x73\x66\x75\x6c"]); goto ZjpL6; RwNPO: $user = $this->get_user_by_activation_code($code); goto cYfGv; XqMVq: $this->trigger_events(["\x70\x6f\x73\x74\137\x61\143\x74\x69\166\x61\x74\x65", "\x70\x6f\x73\x74\137\x61\143\164\x69\166\141\164\145\x5f\x73\165\x63\143\145\x73\x73\146\165\154"]); goto SSfyq; s6Jbg: if (!($code === FALSE || $user && $user->id === $id)) { goto gYIEQ; } goto qk4iG; krGAJ: } public function deactivate($id = NULL) { goto YNa4E; bY8GX: $token = $this->_generate_selector_validator_couple(20, 40); goto jPhY1; CjcRJ: $data = ["\x61\143\164\x69\166\x61\x74\x69\157\x6e\x5f\163\x65\154\x65\143\x74\157\162" => $token->selector, "\x61\x63\164\x69\x76\x61\x74\151\157\x6e\x5f\143\157\144\x65" => $token->validator_hashed, "\x61\x63\164\151\x76\145" => 0]; goto ZCu4T; eM1dj: $this->set_message("\x64\145\x61\143\164\151\x76\141\164\145\x5f\163\165\x63\x63\x65\163\x73\x66\165\154"); goto jgRsK; Islax: goto SQr1x; goto FJcvD; VW3Le: goto moKZ6; goto gLe7b; YNa4E: $this->trigger_events("\x64\x65\141\143\164\151\166\x61\x74\x65"); goto pNyuT; pNyuT: if (!isset($id)) { goto Cz_KV; } goto AJ9f4; WG143: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, ["\151\x64" => $id]); goto xQiTv; SUKVq: if ($return) { goto n1Pw0; } goto cVh7m; OqxXA: SQr1x: goto bY8GX; EdwTk: return $return; goto jIPwI; jgRsK: moKZ6: goto EdwTk; xQiTv: $return = $this->db->affected_rows() == 1; goto SUKVq; jPhY1: $this->activation_code = $token->user_code; goto CjcRJ; ZCu4T: $this->trigger_events("\145\170\x74\x72\141\137\167\x68\145\x72\x65"); goto WG143; AJ9f4: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto jp8LQ; } goto GC_DA; cVh7m: $this->set_error("\144\145\x61\143\164\x69\x76\141\164\145\x5f\x75\x6e\x73\165\143\143\x65\x73\163\x66\165\154"); goto VW3Le; hS9Sd: return FALSE; goto x6hJM; gLe7b: n1Pw0: goto eM1dj; dM4I9: $this->set_error("\144\145\141\x63\164\151\x76\x61\x74\145\x5f\x75\x6e\163\165\143\x63\x65\x73\x73\146\165\x6c"); goto LildR; FJcvD: Cz_KV: goto dM4I9; LildR: return FALSE; goto OqxXA; GC_DA: $this->set_error("\x64\x65\x61\x63\164\x69\166\141\x74\x65\x5f\143\165\162\162\145\156\x74\137\x75\163\145\162\137\165\x6e\x73\165\143\x63\x65\x73\163\146\x75\154"); goto hS9Sd; x6hJM: jp8LQ: goto Islax; jIPwI: } public function clear_forgotten_password_code($identity) { goto VXoK_; vrudt: $this->db->update($this->tables["\165\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto xwTBM; ms7r5: return FALSE; goto dssKF; bb_5g: $data = ["\x66\157\162\147\x6f\x74\164\x65\x6e\x5f\160\141\163\163\x77\x6f\162\x64\x5f\163\145\154\145\143\164\x6f\162" => NULL, "\x66\157\x72\x67\157\164\x74\145\156\x5f\x70\141\163\x73\167\157\x72\144\x5f\143\x6f\144\x65" => NULL, "\x66\157\162\x67\157\x74\164\x65\156\137\x70\x61\x73\163\167\157\162\144\x5f\164\x69\x6d\x65" => NULL]; goto vrudt; VXoK_: if (!empty($identity)) { goto EGsvL; } goto ms7r5; xwTBM: return TRUE; goto YI4yt; dssKF: EGsvL: goto bb_5g; YI4yt: } public function clear_remember_code($identity) { goto SJgYn; LMBfB: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto WJzmo; GLw5M: return FALSE; goto V1l0J; SJgYn: if (!empty($identity)) { goto bfiaW; } goto GLw5M; V1l0J: bfiaW: goto aXx9B; aXx9B: $data = ["\x72\x65\155\145\x6d\142\145\162\x5f\x73\x65\154\x65\143\x74\x6f\x72" => NULL, "\162\x65\x6d\145\x6d\142\145\x72\x5f\x63\x6f\144\145" => NULL]; goto LMBfB; WJzmo: return TRUE; goto O6Wl0; O6Wl0: } public function reset_password($identity, $new) { goto ClV5Y; kLl9f: cZYiu: goto MCA13; MCA13: $return = $this->_set_password_db($identity, $new); goto zkbwf; rDfPa: $this->trigger_events(["\160\x6f\x73\164\x5f\143\150\x61\156\147\145\x5f\160\x61\x73\163\167\x6f\x72\x64", "\x70\x6f\x73\164\x5f\x63\150\x61\156\147\145\137\160\141\x73\163\167\157\162\144\x5f\163\165\143\x63\x65\163\163\146\x75\x6c"]); goto dZaV9; IwlvZ: $this->set_error("\160\141\163\x73\167\157\x72\144\137\143\150\x61\x6e\x67\145\137\165\x6e\x73\x75\x63\x63\145\163\x73\146\165\154"); goto mbzvG; tp8hY: return FALSE; goto kLl9f; zkbwf: if ($return) { goto TB8kN; } goto wmEKh; NZp0R: $this->trigger_events(["\160\x6f\163\x74\x5f\x63\x68\141\x6e\147\x65\x5f\x70\x61\163\163\167\x6f\162\x64", "\x70\157\163\x74\x5f\x63\x68\141\x6e\147\x65\x5f\160\141\163\163\x77\x6f\x72\144\137\x75\x6e\163\165\143\143\x65\163\163\x66\x75\154"]); goto tp8hY; dVBlC: return $return; goto zglXv; vKZG4: if ($this->identity_check($identity)) { goto cZYiu; } goto NZp0R; PSNS5: lyrIe: goto dVBlC; dZaV9: $this->set_message("\x70\x61\163\163\167\x6f\x72\x64\x5f\143\x68\x61\156\x67\145\x5f\163\x75\x63\143\x65\163\163\146\x75\x6c"); goto PSNS5; mbzvG: goto lyrIe; goto reiN7; reiN7: TB8kN: goto rDfPa; ClV5Y: $this->trigger_events("\160\x72\x65\x5f\143\x68\141\x6e\x67\145\x5f\160\x61\163\163\167\x6f\162\x64"); goto vKZG4; wmEKh: $this->trigger_events(["\x70\157\163\x74\137\x63\x68\141\x6e\x67\145\137\x70\x61\163\163\x77\157\162\x64", "\160\x6f\x73\164\x5f\x63\150\x61\156\x67\x65\137\160\x61\163\163\x77\x6f\162\144\x5f\165\x6e\x73\165\143\143\145\x73\163\146\165\x6c"]); goto IwlvZ; zglXv: } public function change_password($identity, $old, $new) { goto RIiet; iO4Tj: return $result; goto syU32; Isc4o: G5Qdf: goto u2YK9; b8_dj: $this->trigger_events(["\x70\x6f\163\164\137\143\150\x61\x6e\147\x65\x5f\160\x61\x73\x73\167\157\162\x64", "\x70\x6f\x73\164\137\143\150\x61\x6e\147\x65\x5f\x70\141\163\x73\x77\157\162\x64\x5f\x75\156\163\x75\143\143\x65\x73\163\x66\x75\154"]); goto p3d_L; s00y9: $this->set_error("\160\x61\163\x73\x77\157\162\x64\137\143\x68\x61\x6e\x67\x65\x5f\x75\156\x73\165\x63\143\145\163\163\146\x75\x6c"); goto Ua28K; RIiet: $this->trigger_events("\x70\162\x65\x5f\143\150\141\x6e\147\145\137\x70\141\163\163\x77\157\x72\144"); goto nIElj; p3d_L: $this->set_error("\x70\x61\x73\x73\x77\157\x72\144\137\143\150\141\156\147\145\x5f\165\156\163\165\x63\143\145\x73\x73\x66\165\x6c"); goto iG424; LKtIJ: $this->set_message("\x70\141\x73\x73\167\x6f\162\144\137\143\150\141\x6e\147\x65\x5f\x73\165\x63\x63\x65\x73\163\146\165\x6c"); goto cHk5Z; Ua28K: return FALSE; goto Isc4o; xXnrk: return FALSE; goto J7tdo; iG424: goto xhy_F; goto M0k3Z; qCEbc: if (!$this->verify_password($old, $user->password, $identity)) { goto pUewt; } goto DnRTG; qjvQt: $this->set_error("\x70\141\163\x73\x77\157\162\x64\137\143\x68\141\x6e\x67\x65\137\165\x6e\163\165\143\x63\x65\163\x73\x66\x75\154"); goto xXnrk; cHk5Z: xhy_F: goto iO4Tj; u_C1g: $this->trigger_events(["\160\x6f\x73\x74\x5f\143\150\x61\156\147\145\137\160\141\163\163\167\x6f\x72\x64", "\x70\157\163\x74\137\143\150\141\x6e\x67\x65\x5f\x70\141\x73\163\167\x6f\x72\144\x5f\x75\x6e\163\x75\x63\143\x65\163\163\146\165\154"]); goto s00y9; syU32: pUewt: goto qjvQt; nIElj: $this->trigger_events("\x65\170\164\x72\x61\137\x77\x68\x65\x72\x65"); goto wB2T1; wB2T1: $query = $this->db->select("\151\x64\x2c\40\160\141\x73\x73\167\x6f\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\x65\x73\x63")->get($this->tables["\165\x73\x65\x72\163"]); goto V_ABp; V_ABp: if (!($query->num_rows() !== 1)) { goto G5Qdf; } goto u_C1g; DnRTG: $result = $this->_set_password_db($identity, $new); goto kVWOQ; u2YK9: $user = $query->row(); goto qCEbc; kVWOQ: if ($result) { goto O_nQL; } goto b8_dj; UpPMG: $this->trigger_events(["\x70\157\x73\x74\x5f\143\150\x61\x6e\x67\x65\137\x70\141\x73\x73\167\x6f\162\x64", "\x70\157\163\x74\x5f\x63\x68\x61\156\147\x65\137\160\x61\163\x73\167\x6f\162\x64\x5f\163\x75\143\x63\x65\163\x73\x66\165\154"]); goto LKtIJ; M0k3Z: O_nQL: goto UpPMG; J7tdo: } public function username_check($username = '') { goto zi2Vq; mhtkD: $this->trigger_events("\145\x78\164\162\x61\137\x77\x68\145\x72\x65"); goto RNM35; yawcK: BOyoD: goto mhtkD; EVGpy: return FALSE; goto yawcK; Y8JrD: if (!empty($username)) { goto BOyoD; } goto EVGpy; RNM35: return $this->db->where("\x75\163\145\162\156\141\155\x65", $username)->limit(1)->count_all_results($this->tables["\165\163\145\162\x73"]) > 0; goto Vd08r; zi2Vq: $this->trigger_events("\x75\163\145\162\156\141\155\x65\x5f\x63\x68\145\x63\153"); goto Y8JrD; Vd08r: } public function email_check($email = '') { goto x6ibG; x6ibG: $this->trigger_events("\145\x6d\141\x69\x6c\137\143\150\145\x63\x6b"); goto UDbLF; QRRnK: return $this->db->where("\145\155\x61\151\154", $email)->limit(1)->count_all_results($this->tables["\x75\x73\145\162\163"]) > 0; goto amk3l; bB4pr: $this->trigger_events("\145\170\x74\x72\x61\x5f\x77\150\x65\162\145"); goto QRRnK; p29Bl: return FALSE; goto BB0ew; UDbLF: if (!empty($email)) { goto bn71R; } goto p29Bl; BB0ew: bn71R: goto bB4pr; amk3l: } public function identity_check($identity = '') { goto aXn3r; J2hfz: if (!empty($identity)) { goto Punja; } goto Lx3nk; aXn3r: $this->trigger_events("\151\144\x65\x6e\x74\151\x74\171\137\143\150\145\x63\153"); goto J2hfz; JvKs3: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\162\163"]) > 0; goto mQmtk; ZJ1kK: Punja: goto JvKs3; Lx3nk: return FALSE; goto ZJ1kK; mQmtk: } public function get_user_id_from_identity($identity = '') { goto lO8cp; rXdIe: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\145\162\x73"]); goto rxUkC; rSIkP: MCHUu: goto UwG32; rxUkC: if (!($query->num_rows() !== 1)) { goto MCHUu; } goto vLO27; lO8cp: if (!empty($identity)) { goto RFhJE; } goto k5fB3; UwG32: $user = $query->row(); goto Y6Ani; vLO27: return FALSE; goto rSIkP; Y6Ani: return $user->id; goto IZto4; k5fB3: return FALSE; goto KQush; KQush: RFhJE: goto rXdIe; IZto4: } public function forgotten_password($identity) { goto xOC2y; ts6zZ: return FALSE; goto hB9cm; G7FVU: $this->trigger_events(["\x70\157\x73\x74\137\x66\x6f\162\x67\157\x74\x74\145\156\x5f\x70\141\163\x73\167\157\x72\x64", "\160\157\x73\164\137\146\157\162\147\157\x74\164\145\156\x5f\x70\x61\163\x73\x77\157\162\144\137\165\x6e\x73\165\143\x63\x65\163\x73\x66\x75\154"]); goto ts6zZ; PIVRx: LLwCG: goto G_tzT; Tx0Zy: $this->trigger_events(["\160\x6f\163\164\137\x66\157\162\147\157\x74\164\145\156\137\x70\141\163\163\167\157\x72\x64", "\160\157\163\x74\x5f\146\157\162\147\x6f\164\164\145\156\x5f\x70\141\163\163\167\x6f\162\144\x5f\165\x6e\x73\x75\x63\143\145\x73\163\x66\165\x6c"]); goto cCK3Q; Lw8Li: $token = $this->_generate_selector_validator_couple(20, 80); goto aj3gr; Qg1Bp: goto LLwCG; goto aAXLX; xOC2y: if (!empty($identity)) { goto eGinm; } goto G7FVU; A6Vlr: $this->trigger_events(["\160\x6f\x73\164\137\146\157\x72\147\157\164\x74\x65\156\x5f\x70\x61\163\163\167\157\x72\x64", "\160\157\x73\x74\137\x66\x6f\x72\147\157\x74\164\145\156\137\160\141\x73\163\167\x6f\x72\x64\x5f\x73\x75\x63\143\145\x73\x73\x66\x75\x6c"]); goto f23mM; aj3gr: $update = ["\x66\157\162\x67\x6f\x74\x74\145\156\137\160\141\163\163\x77\157\162\x64\137\x73\145\154\145\143\x74\157\x72" => $token->selector, "\146\157\162\147\157\x74\164\x65\156\137\160\141\163\x73\167\x6f\x72\x64\137\143\157\144\145" => $token->validator_hashed, "\146\157\x72\x67\157\164\164\145\x6e\137\x70\x61\163\163\x77\157\162\144\137\164\x69\155\145" => time()]; goto tiXUD; cCK3Q: return FALSE; goto Qg1Bp; vtQyk: if ($this->db->affected_rows() === 1) { goto myp_3; } goto Tx0Zy; aAXLX: myp_3: goto A6Vlr; xcMN7: $this->db->update($this->tables["\165\163\145\162\163"], $update, [$this->identity_column => $identity]); goto vtQyk; hB9cm: eGinm: goto Lw8Li; f23mM: return $token->user_code; goto PIVRx; tiXUD: $this->trigger_events("\x65\170\164\162\141\x5f\167\x68\145\162\145"); goto xcMN7; G_tzT: } public function get_user_by_forgotten_password_code($user_code) { goto wjqOm; byl8O: $user = $this->where("\146\x6f\162\x67\x6f\x74\164\145\156\x5f\x70\x61\163\x73\x77\x6f\x72\x64\137\163\x65\154\145\143\164\x6f\x72", $token->selector)->users()->row(); goto zUKgL; zUKgL: if (!$user) { goto ACC66; } goto Eibsv; E8QfS: return $user; goto OHxbR; yKLe1: ACC66: goto U3t11; wjqOm: $token = $this->_retrieve_selector_validator_couple($user_code); goto byl8O; OHxbR: qx0SI: goto yKLe1; U3t11: return FALSE; goto JkhNr; Eibsv: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto qx0SI; } goto E8QfS; JkhNr: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto gz37Q; v2uYL: $this->trigger_events("\160\157\163\164\137\162\x65\x67\151\x73\x74\x65\x72"); goto tdaP7; hMcRR: $ip_address = $this->input->ip_address(); goto FSGVq; tdaP7: return isset($id) ? $id : FALSE; goto hvEci; pEQFk: return FALSE; goto GuVaW; VEZBz: sFeG3: goto v2uYL; Vgpgw: Mu4E0: goto k8fxz; LWXo4: return FALSE; goto Oc2xF; JyECM: $this->set_error("\x61\143\x63\157\165\x6e\x74\137\x63\x72\145\141\164\151\x6f\x6e\x5f\151\x6e\166\x61\x6c\151\x64\x5f\x64\145\146\141\165\x6c\x74\137\x67\x72\157\165\160"); goto pEQFk; XBDX9: goto Mu4E0; goto QZg0Q; Oc2xF: isqwD: goto XBDX9; Mw8jZ: if (!(isset($default_group->id) && empty($groups))) { goto jSgys; } goto wespv; DHaUr: $default_group = $query; goto hMcRR; j83wq: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\x65\x72\163"], $additional_data), $data); goto UTkeV; ZzAFj: foreach ($groups as $group) { $this->add_to_group($group, $id); BgG__: } goto VjcPN; FSGVq: $password = $this->hash_password($password); goto dAGcB; GuVaW: Eg2EM: goto DHaUr; UTkeV: $this->trigger_events("\145\x78\164\162\141\137\x73\145\164"); goto wkvv3; dAGcB: if (!($password === FALSE)) { goto wqQRN; } goto eeIyx; G437x: if ($this->identity_check($identity)) { goto b2uw9; } goto lPQ23; fn7cW: $data = [$this->identity_column => $identity, "\x75\x73\145\x72\x6e\x61\155\145" => $identity, "\160\x61\163\163\x77\x6f\162\144" => $password, "\x65\x6d\141\x69\154" => $email, "\x69\160\137\x61\144\x64\162\x65\163\x73" => $ip_address, "\x63\x72\145\x61\164\x65\144\x5f\157\x6e" => time(), "\141\x63\x74\x69\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto j83wq; Dg_Nv: $this->set_error("\141\x63\143\x6f\x75\156\164\x5f\143\x72\x65\141\164\151\x6f\x6e\x5f\x64\165\160\154\151\x63\141\164\145\137\151\144\x65\x6e\x74\151\x74\171"); goto wsjKC; eVD5n: $this->set_error("\141\143\143\157\165\x6e\164\x5f\143\x72\145\141\164\x69\157\156\x5f\x6d\151\163\163\x69\156\x67\137\144\x65\x66\x61\x75\x6c\164\x5f\147\162\x6f\x75\160"); goto LWXo4; gz37Q: $this->trigger_events("\x70\x72\145\137\162\x65\x67\x69\163\164\145\x72"); goto g4VoM; g4VoM: $manual_activation = $this->config->item("\x6d\x61\x6e\165\141\154\x5f\141\x63\164\x69\166\141\x74\151\157\x6e", "\x69\x6f\x6e\137\x61\x75\164\x68"); goto G437x; wespv: $groups[] = $default_group->id; goto iaicZ; bFTTx: if (!(!isset($query->id) && empty($groups))) { goto Eg2EM; } goto JyECM; VjcPN: nPNE5: goto VEZBz; vnAbV: $id = $this->db->insert_id($this->tables["\165\x73\145\x72\163"] . "\137\x69\x64\x5f\163\x65\161"); goto Mw8jZ; wsjKC: return FALSE; goto Vgpgw; eC5vT: if (empty($groups)) { goto sFeG3; } goto ZzAFj; k8fxz: $query = $this->db->get_where($this->tables["\x67\162\x6f\165\x70\163"], ["\156\x61\155\145" => $this->config->item("\144\x65\146\141\x75\x6c\164\137\147\x72\x6f\165\x70", "\151\x6f\x6e\137\x61\165\164\x68")], 1)->row(); goto bFTTx; iaicZ: jSgys: goto eC5vT; YIkzn: return FALSE; goto QuF5P; wkvv3: $this->db->insert($this->tables["\165\x73\145\x72\163"], $user_data); goto vnAbV; QZg0Q: b2uw9: goto Dg_Nv; QuF5P: wqQRN: goto fn7cW; lPQ23: if (!(!$this->config->item("\144\145\146\x61\x75\154\164\x5f\x67\162\157\165\x70", "\151\157\x6e\x5f\141\x75\x74\150") && empty($groups))) { goto isqwD; } goto eVD5n; eeIyx: $this->set_error("\x61\143\143\x6f\x75\156\x74\x5f\143\162\x65\141\x74\x69\157\x6e\137\165\156\163\165\x63\143\x65\x73\163\146\165\154"); goto YIkzn; hvEci: } public function login($identity, $password, $remember = FALSE) { goto cLKEg; AY6SS: nnVmn: goto cExfd; ZE2kr: DgBJt: goto XamHv; bNaAa: $this->set_message("\x6c\157\147\x69\156\137\x73\x75\x63\x63\145\163\163\x66\x75\x6c"); goto IH6RV; iIrf_: $this->trigger_events("\x70\157\163\x74\137\x6c\x6f\147\151\x6e\137\165\156\x73\165\143\143\145\163\163\146\165\154"); goto Q9x8N; XamHv: $this->hash_password($password); goto Yj2xq; MvjzV: y63w8: goto w1eWM; An3kS: if (!(empty($identity) || empty($password))) { goto A40Um; } goto Umns2; Ep_Vp: $this->trigger_events(["\160\x6f\163\164\x5f\x6c\x6f\147\151\x6e", "\160\157\x73\x74\137\154\157\x67\x69\156\137\163\165\143\x63\x65\x73\163\x66\x75\x6c"]); goto bNaAa; JiPXl: CZuPo: goto mNWpj; BTr0t: if ($remember) { goto nnVmn; } goto VxUq1; malAG: return FALSE; goto MvjzV; DGJo3: $this->hash_password($password); goto kUnk5; MvZiZ: $query = $this->db->select($this->identity_column . "\54\40\x65\x6d\141\151\x6c\54\x20\x69\x64\54\x20\x70\x61\163\163\167\x6f\162\144\x2c\40\x61\143\x74\151\166\145\x2c\40\x6c\x61\163\x74\137\x6c\x6f\147\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\163\143")->get($this->tables["\165\x73\145\162\163"]); goto USL8u; ZjjRh: A40Um: goto z2P6Q; uOsxj: $this->rehash_password_if_needed($user->password, $identity, $password); goto Zb6qt; ZHvNl: return FALSE; goto pCvBp; Zb6qt: $this->session->sess_regenerate(FALSE); goto Ep_Vp; z2P6Q: $this->trigger_events("\145\x78\164\x72\141\137\167\x68\x65\162\145"); goto MvZiZ; TO0MQ: return FALSE; goto JiPXl; IH6RV: return TRUE; goto ZJr0j; IrOwq: if (!$this->verify_password($password, $user->password, $identity)) { goto EIXy2; } goto JrkV0; CemE_: $this->clear_login_attempts($identity); goto HcXhu; VxUq1: $this->clear_remember_code($identity); goto Q8_mc; Yj2xq: $this->increase_login_attempts($identity); goto iIrf_; z4nK8: HNBk2: goto PFp1k; KVgVp: $this->set_error("\154\x6f\147\151\156\137\165\x6e\x73\165\143\143\145\x73\163\146\x75\154\x5f\x6e\x6f\x74\x5f\141\143\x74\x69\166\x65"); goto malAG; Umns2: $this->set_error("\x6c\157\147\151\156\x5f\x75\x6e\x73\165\x63\x63\x65\x73\x73\x66\x75\154"); goto HTbZq; cExfd: $this->remember_user($identity); goto z4nK8; HcXhu: $this->clear_forgotten_password_code($identity); goto Vl74q; w1eWM: $this->set_session($user); goto r_xry; JrkV0: if (!($user->active == 0)) { goto y63w8; } goto PzowP; cvxSP: $this->set_error("\x6c\157\x67\x69\156\137\164\x69\x6d\145\157\165\x74"); goto TO0MQ; Vl74q: if (!$this->config->item("\162\145\x6d\145\155\x62\x65\162\137\x75\163\145\x72\163", "\x69\x6f\156\x5f\141\165\164\150")) { goto QYqVi; } goto BTr0t; PzowP: $this->trigger_events("\x70\157\x73\x74\137\154\157\x67\151\156\137\x75\x6e\x73\165\143\143\145\x73\163\x66\165\x6c"); goto KVgVp; k2uz0: $user = $query->row(); goto IrOwq; cLKEg: $this->trigger_events("\160\x72\x65\x5f\x6c\x6f\147\151\x6e"); goto An3kS; ZJr0j: EIXy2: goto ZE2kr; mNWpj: if (!($query->num_rows() === 1)) { goto DgBJt; } goto k2uz0; kUnk5: $this->trigger_events("\160\x6f\163\x74\137\154\157\x67\x69\156\x5f\x75\156\163\165\x63\x63\x65\163\x73\x66\x75\x6c"); goto cvxSP; HTbZq: return FALSE; goto ZjjRh; PFp1k: QYqVi: goto uOsxj; USL8u: if (!$this->is_max_login_attempts_exceeded($identity)) { goto CZuPo; } goto DGJo3; Q9x8N: $this->set_error("\154\157\x67\151\156\137\165\156\x73\x75\143\x63\x65\x73\163\146\165\x6c"); goto ZHvNl; Q8_mc: goto HNBk2; goto AY6SS; r_xry: $this->update_last_login($user->id); goto CemE_; pCvBp: } public function recheck_session() { goto UzEoh; jdOju: goto U_LIn; goto fQ1sx; Pk4WC: TAVzg: goto verDi; verDi: jueW8: goto dRWL3; rd3tc: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\151\144\x65\x6e\164\151\x74\x79"), "\141\143\x74\x69\x76\x65" => "\61"])->limit(1)->order_by("\x69\144", "\x64\145\x73\x63")->get($this->tables["\165\x73\145\x72\163"]); goto kQYOZ; tOqW1: return FALSE; goto jdOju; UzEoh: $recheck = NULL !== $this->config->item("\162\145\143\150\x65\x63\153\137\x74\151\x6d\145\x72", "\151\157\156\x5f\x61\165\164\x68") ? $this->config->item("\162\x65\x63\150\x65\x63\x6b\x5f\x74\151\x6d\x65\162", "\x69\157\x6e\137\141\165\x74\150") : 0; goto iWjVy; iWjVy: if (!($recheck !== 0)) { goto jueW8; } goto rlBAV; fQ1sx: tQdBR: goto Q2exs; dxGR7: $this->session->unset_userdata([$identity, "\151\144", "\165\163\145\162\x5f\x69\144"]); goto tOqW1; dRWL3: return (bool) $this->session->userdata("\151\x64\x65\x6e\x74\x69\164\171"); goto KlkPy; tHv1Z: $this->trigger_events("\154\x6f\147\157\165\164"); goto WhNjH; ChGv3: if (!($last_login + $recheck < time())) { goto TAVzg; } goto rd3tc; riOYt: U_LIn: goto Pk4WC; kQYOZ: if ($query->num_rows() === 1) { goto tQdBR; } goto tHv1Z; WhNjH: $identity = $this->config->item("\x69\144\145\156\164\x69\164\171", "\x69\x6f\x6e\137\141\x75\164\150"); goto dxGR7; Q2exs: $this->session->set_userdata("\154\141\163\x74\x5f\143\x68\145\x63\153", time()); goto riOYt; rlBAV: $last_login = $this->session->userdata("\154\141\x73\x74\137\x63\150\145\143\153"); goto ChGv3; KlkPy: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto Xp0kv; Xp0kv: if (!$this->config->item("\x74\x72\x61\143\153\137\154\157\x67\151\x6e\x5f\x61\x74\x74\x65\x6d\x70\x74\163", "\151\157\x6e\137\141\x75\164\150")) { goto O0zGO; } goto ejI7r; taOwX: Z9yIr: goto SLMDp; xohI5: return $attempts >= $max_attempts; goto taOwX; Jdki5: $attempts = $this->get_attempts_num($identity, $ip_address); goto xohI5; SLMDp: O0zGO: goto op8zX; ejI7r: $max_attempts = $this->config->item("\155\x61\x78\x69\155\x75\155\137\x6c\157\x67\151\156\x5f\141\164\164\145\155\x70\x74\163", "\x69\x6f\156\x5f\x61\x75\x74\150"); goto mhTua; op8zX: return FALSE; goto hkrsB; mhTua: if (!($max_attempts > 0)) { goto Z9yIr; } goto Jdki5; hkrsB: } public function get_attempts_num($identity, $ip_address = NULL) { goto RwlFk; WfCyE: VNct7: goto yQQAS; N9IIL: $this->db->select("\61", FALSE); goto igAGM; bOYj9: return 0; goto vaMet; ruVIX: $ip_address = $this->input->ip_address(); goto CAbV7; igAGM: $this->db->where("\154\157\x67\x69\x6e", $identity); goto CwUov; Iu4JR: T7K9k: goto bOYj9; UFDVm: if (isset($ip_address)) { goto QtQ8O; } goto ruVIX; yQQAS: $this->db->where("\164\151\155\x65\40\76", time() - $this->config->item("\154\x6f\143\x6b\157\165\x74\x5f\x74\x69\x6d\x65", "\151\x6f\156\x5f\x61\165\x74\x68"), FALSE); goto IPRvQ; ye0yC: $this->db->where("\151\x70\137\x61\x64\x64\x72\x65\x73\x73", $ip_address); goto WfCyE; IPRvQ: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\x5f\141\x74\x74\x65\155\x70\164\163"]); goto PvSPo; CAbV7: QtQ8O: goto ye0yC; RwlFk: if (!$this->config->item("\x74\x72\141\143\153\137\154\x6f\x67\x69\156\x5f\141\x74\x74\145\155\x70\x74\163", "\151\x6f\156\137\x61\165\x74\x68")) { goto T7K9k; } goto N9IIL; PvSPo: return $qres->num_rows(); goto Iu4JR; CwUov: if (!$this->config->item("\164\x72\x61\x63\x6b\137\x6c\157\147\x69\156\x5f\151\160\137\141\144\144\x72\145\x73\163", "\151\x6f\x6e\137\141\165\164\x68")) { goto VNct7; } goto UFDVm; vaMet: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto zaVmI; BSw7_: return 0; goto iQhzr; GzkhW: $this->db->where("\151\x70\137\141\144\x64\162\x65\x73\x73", $ip_address); goto Zcjlj; TKkL2: $this->db->select("\x74\151\x6d\x65"); goto psESk; Cg3zd: if (isset($ip_address)) { goto s5fJY; } goto QKdHN; Zcjlj: jhedi: goto SlTNB; iTTxw: s5fJY: goto GzkhW; QKdHN: $ip_address = $this->input->ip_address(); goto iTTxw; bpIn0: if (!($qres->num_rows() > 0)) { goto PqC8m; } goto ijDVE; MUzZo: PqC8m: goto WZXbw; ijDVE: return $qres->row()->time; goto MUzZo; zaVmI: if (!$this->config->item("\x74\x72\141\143\x6b\137\154\157\x67\x69\x6e\137\x61\x74\x74\145\x6d\x70\164\163", "\151\x6f\156\x5f\x61\x75\x74\x68")) { goto zlO0Z; } goto TKkL2; w83Ut: if (!$this->config->item("\x74\x72\141\143\x6b\x5f\x6c\x6f\147\151\156\137\x69\160\x5f\141\x64\144\162\145\x73\163", "\x69\157\x6e\x5f\x61\x75\164\150")) { goto jhedi; } goto Cg3zd; WZXbw: zlO0Z: goto BSw7_; SlTNB: $this->db->order_by("\x69\x64", "\144\145\x73\143"); goto QmhzL; QmhzL: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\156\x5f\x61\164\x74\145\155\160\x74\163"], 1); goto bpIn0; psESk: $this->db->where("\154\157\147\x69\156", $identity); goto w83Ut; iQhzr: } public function get_last_attempt_ip($identity) { goto la0iw; dpBLT: return ''; goto OEcuP; P4yyk: OSFI2: goto dpBLT; ZRFa6: $this->db->select("\151\x70\x5f\141\x64\x64\162\x65\x73\163"); goto G072L; QzNl1: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\x6e\137\x61\x74\164\x65\155\x70\x74\x73"], 1); goto HC8vN; OwqIp: Z7MDw: goto P4yyk; la0iw: if (!($this->config->item("\x74\162\141\143\153\137\x6c\x6f\x67\x69\156\137\x61\x74\164\x65\155\x70\164\163", "\x69\x6f\156\137\x61\x75\x74\150") && $this->config->item("\164\162\x61\x63\x6b\137\154\157\147\151\156\x5f\151\x70\137\x61\x64\x64\x72\145\x73\163", "\151\157\156\x5f\141\x75\x74\150"))) { goto OSFI2; } goto ZRFa6; JTwfN: $this->db->order_by("\151\x64", "\144\145\163\143"); goto QzNl1; ugHbj: return $qres->row()->ip_address; goto OwqIp; G072L: $this->db->where("\x6c\x6f\147\x69\x6e", $identity); goto JTwfN; HC8vN: if (!($qres->num_rows() > 0)) { goto Z7MDw; } goto ugHbj; OEcuP: } public function increase_login_attempts($identity) { goto YhDPf; eeZ48: TWjow: goto G4uhO; G4uhO: return $this->db->insert($this->tables["\154\x6f\147\151\x6e\137\x61\x74\164\x65\x6d\x70\x74\163"], $data); goto YvVk4; YvVk4: icSh_: goto GNhV2; LqzQc: if (!$this->config->item("\x74\x72\x61\143\x6b\137\154\157\147\151\156\137\x69\x70\137\x61\x64\144\x72\145\163\163", "\151\x6f\x6e\137\x61\x75\164\x68")) { goto TWjow; } goto lCUkl; lCUkl: $data["\x69\x70\137\141\x64\x64\162\145\163\163"] = $this->input->ip_address(); goto eeZ48; YhDPf: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\x6f\x67\151\x6e\137\x61\164\x74\x65\x6d\160\164\163", "\151\157\156\x5f\141\x75\x74\x68")) { goto icSh_; } goto q6f4J; q6f4J: $data = ["\x69\160\x5f\x61\x64\x64\162\145\x73\x73" => '', "\154\157\147\151\x6e" => $identity, "\164\151\155\145" => time()]; goto LqzQc; GNhV2: return FALSE; goto w4Vrt; w4Vrt: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto G8KXx; ubDAb: ulQyx: goto k_2pU; zuXWL: $this->db->where("\151\160\137\141\144\144\x72\x65\163\x73", $ip_address); goto ubDAb; fXYSv: xI2w1: goto zuXWL; W3JXn: $ip_address = $this->input->ip_address(); goto fXYSv; doNmq: $this->db->where("\x6c\x6f\147\151\x6e", $identity); goto mroUf; lg3lG: if (isset($ip_address)) { goto xI2w1; } goto W3JXn; j40Dn: sgBXh: goto oN7_R; kAT1c: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\x63\153\x6f\x75\164\x5f\x74\151\155\145", "\151\x6f\156\137\141\x75\164\x68")); goto doNmq; OpnSo: return $this->db->delete($this->tables["\x6c\x6f\x67\x69\x6e\x5f\x61\164\x74\x65\x6d\x70\164\163"]); goto j40Dn; oN7_R: return FALSE; goto W4KBY; G8KXx: if (!$this->config->item("\x74\162\141\x63\x6b\137\154\x6f\x67\x69\x6e\x5f\141\164\x74\145\x6d\x70\164\x73", "\x69\x6f\156\x5f\141\x75\x74\x68")) { goto sgBXh; } goto kAT1c; mroUf: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\157\x67\x69\x6e\x5f\151\x70\137\x61\x64\144\162\145\163\x73", "\x69\x6f\x6e\137\x61\x75\164\x68")) { goto ulQyx; } goto lg3lG; k_2pU: $this->db->or_where("\164\151\x6d\x65\40\74", time() - $old_attempts_expire_period, FALSE); goto OpnSo; W4KBY: } public function limit($limit) { goto tEGyj; tEGyj: $this->trigger_events("\x6c\151\x6d\151\x74"); goto IDdte; IDdte: $this->_ion_limit = $limit; goto RuYOT; RuYOT: return $this; goto hi0_6; hi0_6: } public function offset($offset) { goto lwKp0; wlbnZ: $this->_ion_offset = $offset; goto naUSy; lwKp0: $this->trigger_events("\157\x66\146\x73\145\164"); goto wlbnZ; naUSy: return $this; goto jnnkv; jnnkv: } public function where($where, $value = NULL) { goto WzYzT; vlpSa: CQcwu: goto ybdi4; sQAZg: $where = [$where => $value]; goto vlpSa; ybdi4: array_push($this->_ion_where, $where); goto H8JBG; H8JBG: return $this; goto mH7e8; WzYzT: $this->trigger_events("\167\150\145\162\x65"); goto pBFsp; pBFsp: if (is_array($where)) { goto CQcwu; } goto sQAZg; mH7e8: } public function like($like, $value = NULL, $position = "\x62\157\x74\150") { goto hWF5g; hWF5g: $this->trigger_events("\154\x69\x6b\145"); goto fcxa1; WPzoG: return $this; goto VYZl0; fcxa1: array_push($this->_ion_like, ["\x6c\x69\x6b\145" => $like, "\x76\x61\154\x75\145" => $value, "\160\x6f\163\151\x74\x69\x6f\x6e" => $position]); goto WPzoG; VYZl0: } public function select($select) { goto VvF4q; IdFM3: $this->_ion_select[] = $select; goto zYUFF; zYUFF: return $this; goto N3F2U; VvF4q: $this->trigger_events("\x73\x65\x6c\x65\143\164"); goto IdFM3; N3F2U: } public function order_by($by, $order = "\x64\x65\163\x63") { goto z6mUT; z6mUT: $this->trigger_events("\157\x72\144\x65\162\137\x62\171"); goto KSx1v; KSx1v: $this->_ion_order_by = $by; goto iBpvk; iBpvk: $this->_ion_order = $order; goto xOVSm; xOVSm: return $this; goto i2HvQ; i2HvQ: } public function row() { goto YvZo8; AbVcq: $row = $this->response->row(); goto nDgpM; YvZo8: $this->trigger_events("\162\x6f\x77"); goto AbVcq; nDgpM: return $row; goto tzSck; tzSck: } public function row_array() { goto bGzjN; M9pky: return $row; goto DYy3T; EPpkz: $row = $this->response->row_array(); goto M9pky; bGzjN: $this->trigger_events(["\x72\x6f\167", "\162\x6f\167\137\x61\x72\162\141\171"]); goto EPpkz; DYy3T: } public function result() { goto xxFbZ; xxFbZ: $this->trigger_events("\162\x65\163\165\x6c\164"); goto ptxUz; yxLA0: return $result; goto G_F0H; ptxUz: $result = $this->response->result(); goto yxLA0; G_F0H: } public function result_array() { goto FbNyz; xAZFE: return $result; goto I2SS0; gu0gD: $result = $this->response->result_array(); goto xAZFE; FbNyz: $this->trigger_events(["\162\x65\x73\165\154\x74", "\x72\x65\163\x75\x6c\x74\137\141\162\x72\x61\x79"]); goto gu0gD; I2SS0: } public function num_rows() { goto GLBQ8; usYpQ: $result = $this->response->num_rows(); goto V7b3T; GLBQ8: $this->trigger_events(["\156\165\155\137\x72\x6f\x77\163"]); goto usYpQ; V7b3T: return $result; goto COXIX; COXIX: } public function users($groups = NULL) { goto wdb6Q; yRYE3: onrvP: goto fLvOx; c3D69: XQ6Ns: goto V2usr; mmiOM: I8gQ9: goto kS9np; kguFN: $this->_ion_like = []; goto pSAYM; KyBVu: $this->response = $this->db->get($this->tables["\x75\163\x65\162\163"]); goto mcgoU; wLaBU: $this->_ion_order = NULL; goto NWM4P; zdl73: U37XV: goto MiVpR; V2usr: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto XPDip; } goto EleqF; jyJUe: AqeOa: goto hmzrT; qyCkS: if (!isset($groups)) { goto oWYx0; } goto VeG2O; lHYcg: goto w5QZS; goto jyJUe; el3oy: BDRcV: goto qOyaa; ga_E7: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto wLaBU; bmir1: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto AqeOa; } goto Q08C4; Lrtdo: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto nN3rs; } goto BNesr; kS9np: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto NfM5C; } goto ga_E7; i2BaT: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto eSqUx; O5owj: B5K9J: goto QUDzr; BTrit: $this->db->join($this->tables["\165\163\x65\x72\x73\x5f\147\x72\x6f\x75\160\163"], $this->tables["\x75\163\145\x72\x73\x5f\x67\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\165\163\x65\x72\x73"] . "\75" . $this->tables["\165\x73\145\x72\x73"] . "\56\x69\x64", "\x69\156\x6e\145\x72"); goto fMI81; qo8Ne: $this->db->distinct(); goto BTrit; ehGH2: $this->db->join($this->tables["\x67\162\x6f\165\160\163"], $this->tables["\165\x73\145\x72\x73\137\147\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\147\162\x6f\165\160\x73"] . "\x20\75\x20" . $this->tables["\x67\x72\x6f\165\160\x73"] . "\56\151\x64", "\151\156\156\145\x72"); goto qPnmx; BNesr: if (!isset($this->_ion_limit)) { goto onrvP; } goto xLo7S; EJW8W: $this->trigger_events("\x65\170\x74\x72\141\x5f\x77\150\145\x72\145"); goto P69RM; qPnmx: $this->db->where_in($this->tables["\x67\162\x6f\x75\160\x73"] . "\x2e\x6e\141\155\145", $group_names); goto g7y2A; hmzrT: foreach ($this->_ion_select as $select) { $this->db->select($select); ZQA91: } goto zdl73; mcgoU: return $this; goto DmgmI; EleqF: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\153\145"], $like["\x76\x61\x6c\x75\145"], $like["\160\157\x73\151\164\151\x6f\x6e"]); gx7Sb: } goto cYfCH; AjMmU: zP33v: goto Ip422; AaFso: $this->_ion_offset = NULL; goto mmiOM; NWM4P: $this->_ion_order_by = NULL; goto sa84_; QUDzr: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\x72\137\167\x68\145\162\145\x5f\151\156" : "\x77\x68\x65\x72\x65\x5f\151\156"; goto qksx3; xLo7S: $this->db->limit($this->_ion_limit); goto qH3fX; qOyaa: if (!(isset($groups) && !empty($groups))) { goto VxX54; } goto qo8Ne; AqW6R: foreach ($groups as $group) { goto QJbVG; B2A4I: R2xij: goto Rugej; Fa6aa: $group_names[] = $group; goto TmcSI; Rugej: wizGK: goto p9z4g; TmcSI: goto R2xij; goto UKWFj; QJbVG: if (is_numeric($group)) { goto t4bG5; } goto Fa6aa; UKWFj: t4bG5: goto Fxow1; Fxow1: $group_ids[] = $group; goto B2A4I; p9z4g: } goto O5owj; Knr6l: oWYx0: goto EJW8W; pSAYM: XPDip: goto Lrtdo; MiVpR: $this->_ion_select = []; goto EWH9h; fLvOx: goto I8gQ9; goto PYGKS; p5Abi: foreach ($this->_ion_where as $where) { $this->db->where($where); lxklY: } goto AjMmU; cYfCH: QYYCj: goto kguFN; Ip422: $this->_ion_where = []; goto c3D69; rFd_k: $this->db->{$or_where_in}($this->tables["\165\163\145\162\x73\x5f\147\x72\x6f\x75\160\163"] . "\x2e" . $this->join["\x67\162\157\x75\160\x73"], $group_ids); goto GYAXU; GYAXU: dUR52: goto Knr6l; Q08C4: $this->db->select([$this->tables["\x75\x73\x65\162\x73"] . "\x2e\x2a", $this->tables["\165\163\145\x72\x73"] . "\56\x69\144\x20\141\x73\40\x69\144", $this->tables["\x75\163\x65\x72\x73"] . "\x2e\151\x64\40\x61\x73\40\x75\x73\x65\162\x5f\x69\x64"]); goto lHYcg; qH3fX: $this->_ion_limit = NULL; goto yRYE3; qksx3: if (empty($group_names)) { goto exUui; } goto ehGH2; WVWzl: $group_names = []; goto AqW6R; sa84_: NfM5C: goto KyBVu; wdb6Q: $this->trigger_events("\x75\163\x65\x72\163"); goto bmir1; YdEWq: if (empty($group_ids)) { goto dUR52; } goto rFd_k; P69RM: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto XQ6Ns; } goto p5Abi; itL5S: $groups = [$groups]; goto el3oy; g7y2A: exUui: goto YdEWq; VeG2O: if (is_array($groups)) { goto BDRcV; } goto itL5S; fMI81: VxX54: goto XjLiA; eSqUx: $this->_ion_limit = NULL; goto AaFso; EWH9h: w5QZS: goto qyCkS; PYGKS: nN3rs: goto i2BaT; XjLiA: $group_ids = []; goto WVWzl; DmgmI: } public function user($id = NULL) { goto bk_bv; BX3Y2: return $this; goto V1v5j; N1q7w: $this->where($this->tables["\165\x73\x65\x72\x73"] . "\56\x69\144", $id); goto TEMdE; biQFk: $this->order_by($this->tables["\165\x73\145\162\x73"] . "\x2e\151\144", "\x64\x65\163\x63"); goto N1q7w; bk_bv: $this->trigger_events("\165\163\145\162"); goto XxWCz; TEMdE: $this->users(); goto BX3Y2; XxWCz: $id = isset($id) ? $id : $this->session->userdata("\165\x73\145\162\137\151\x64"); goto ppjaB; ppjaB: $this->limit(1); goto biQFk; V1v5j: } public function get_users_groups($id = FALSE) { goto zUaPQ; zIqzN: $id || ($id = $this->session->userdata("\165\x73\145\162\x5f\151\x64")); goto kSBWa; zUaPQ: $this->trigger_events("\147\145\x74\x5f\x75\163\x65\162\x73\137\147\162\x6f\165\160"); goto zIqzN; kSBWa: return $this->db->select($this->tables["\x75\x73\145\162\163\137\x67\162\157\x75\x70\163"] . "\x2e" . $this->join["\x67\x72\x6f\x75\x70\x73"] . "\x20\x61\x73\x20\x69\144\x2c\x20" . $this->tables["\x67\162\157\x75\160\x73"] . "\56\x6e\141\155\x65\x2c\40" . $this->tables["\x67\162\x6f\165\160\163"] . "\x2e\x64\145\x73\143\x72\151\x70\x74\x69\157\156")->where($this->tables["\165\x73\x65\162\163\137\x67\x72\x6f\165\160\163"] . "\56" . $this->join["\165\163\x65\x72\163"], $id)->join($this->tables["\x67\x72\157\x75\x70\x73"], $this->tables["\x75\163\145\162\163\137\147\x72\x6f\x75\160\x73"] . "\56" . $this->join["\147\x72\157\x75\160\x73"] . "\x3d" . $this->tables["\x67\x72\157\165\x70\163"] . "\x2e\x69\x64")->get($this->tables["\165\163\145\x72\x73\137\147\162\157\x75\160\163"]); goto uWwpD; uWwpD: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto wyMOi; S4hPu: Oqk7u: goto Ry7bn; wyMOi: $this->trigger_events("\x69\x6e\x5f\x67\162\x6f\165\x70"); goto jTAA7; Xquei: goto fiMqL; goto S4hPu; tflQO: $groups_array = []; goto NJpH3; am6et: $check_group = [$check_group]; goto d4VPP; spQR5: if (isset($this->_cache_user_in_group[$id])) { goto Oqk7u; } goto IrUDc; NJpH3: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; khnx5: } goto JZ2sH; Dl7ps: return $check_all; goto Ki3Ag; jTAA7: $id || ($id = $this->session->userdata("\x75\x73\145\162\137\151\144")); goto wppyi; JZ2sH: o3i8s: goto fKUIe; gePPQ: fiMqL: goto Mxyxl; wppyi: if (is_array($check_group)) { goto CrfDE; } goto am6et; Ry7bn: $groups_array = $this->_cache_user_in_group[$id]; goto gePPQ; upD93: rw0KN: goto Dl7ps; Mxyxl: foreach ($check_group as $key => $value) { goto kmYvM; hcgOK: IGW0C: goto YcOPf; uRDg_: return !$check_all; goto hcgOK; YcOPf: PKlCD: goto ut8D0; RrSQ3: if (!(in_array($value, $groups) xor $check_all)) { goto IGW0C; } goto uRDg_; kmYvM: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto RrSQ3; ut8D0: } goto upD93; fKUIe: $this->_cache_user_in_group[$id] = $groups_array; goto Xquei; d4VPP: CrfDE: goto spQR5; IrUDc: $users_groups = $this->get_users_groups($id)->result(); goto tflQO; Ki3Ag: } public function add_to_group($group_ids, $user_id = FALSE) { goto QVLCO; J3rRT: return $return; goto MCwaY; yF2Ea: if (is_array($group_ids)) { goto kzaFq; } goto JkkTx; JkkTx: $group_ids = [$group_ids]; goto sZdnr; CbHNt: $return = 0; goto o9Gcj; sZdnr: kzaFq: goto CbHNt; o9Gcj: foreach ($group_ids as $group_id) { goto ScOT5; aJVT3: th0zA: goto qtQrF; V8R9r: $group = $this->group($group_id)->result(); goto FMbtM; GTzxU: $this->_cache_groups[$group_id] = $group_name; goto UXnWW; KJ7Vh: if (isset($this->_cache_groups[$group_id])) { goto DMrjs; } goto V8R9r; lhdKq: $group_name = $this->_cache_groups[$group_id]; goto aJVT3; qtQrF: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto cjeou; euCCo: DMrjs: goto lhdKq; FMbtM: $group_name = $group[0]->name; goto GTzxU; kUsvE: KfpiQ: goto R4N3I; cjeou: $return++; goto ALTah; ALTah: dtBzZ: goto kUsvE; UXnWW: goto th0zA; goto euCCo; ScOT5: if (!$this->db->insert($this->tables["\x75\x73\145\x72\x73\x5f\147\x72\x6f\165\x70\x73"], [$this->join["\x67\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\x75\163\145\x72\163"] => (float) $user_id])) { goto dtBzZ; } goto KJ7Vh; R4N3I: } goto iYKr1; JxljX: $user_id || ($user_id = $this->session->userdata("\x75\163\x65\162\x5f\151\144")); goto yF2Ea; iYKr1: hkyVQ: goto J3rRT; QVLCO: $this->trigger_events("\141\144\x64\x5f\164\157\137\147\x72\157\165\x70"); goto JxljX; MCwaY: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto HNzXx; gZKTw: $return = TRUE; goto OqgzM; KFAL_: if (!empty($group_ids)) { goto Cu7Co; } goto LBkO4; S0kRE: UyNRB: goto ka0aN; yma_d: return $return; goto Uzfgm; LnZuy: if (!empty($user_id)) { goto kS0as; } goto Mv6Ai; HtUgC: $group_ids = [$group_ids]; goto S0kRE; OqgzM: kmK1y: goto yma_d; Cicas: if (is_array($group_ids)) { goto UyNRB; } goto HtUgC; b5eJW: vPKwq: goto VgKxX; ka0aN: foreach ($group_ids as $group_id) { goto EKKCx; WPYcN: pYdVr: goto e_1Wc; uOlk9: unset($this->_cache_user_in_group[$user_id][$group_id]); goto WPYcN; e_1Wc: Dsk1X: goto h94Ks; s3hBW: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto pYdVr; } goto uOlk9; EKKCx: $this->db->delete($this->tables["\x75\x73\145\x72\x73\x5f\147\x72\x6f\165\160\163"], [$this->join["\x67\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\165\163\x65\x72\x73"] => (float) $user_id]); goto s3hBW; h94Ks: } goto vBALh; HNzXx: $this->trigger_events("\162\x65\x6d\x6f\x76\145\137\146\x72\x6f\x6d\x5f\x67\x72\157\165\x70"); goto LnZuy; LBkO4: if (!($return = $this->db->delete($this->tables["\x75\x73\145\162\x73\137\147\162\x6f\165\x70\x73"], [$this->join["\x75\163\x65\x72\x73"] => (float) $user_id]))) { goto vPKwq; } goto QrMIw; vxEkC: Cu7Co: goto Cicas; fzMkv: kS0as: goto KFAL_; VgKxX: goto kmK1y; goto vxEkC; QrMIw: $this->_cache_user_in_group[$user_id] = []; goto b5eJW; Mv6Ai: return FALSE; goto fzMkv; vBALh: u8upi: goto gZKTw; Uzfgm: } public function groups() { goto eKeal; Mg9b2: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto UlW7Z; Kwwwg: $this->response = $this->db->get($this->tables["\x67\162\157\x75\160\163"]); goto cBVNH; C9shT: $this->_ion_where = []; goto WB1z1; WB1z1: Yzwvs: goto rMIe9; xIpQJ: oy3yT: goto C9shT; gO_QU: goto VkLtT; goto Kbp_8; UVofH: if (!isset($this->_ion_limit)) { goto m5hPv; } goto QyIZb; UlW7Z: $this->_ion_limit = NULL; goto Crssq; QyIZb: $this->db->limit($this->_ion_limit); goto zA3Ac; cBVNH: return $this; goto KZhhE; L24Vc: ma4Yz: goto Kwwwg; rMIe9: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto QKVlc; } goto UVofH; iiJbd: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto L24Vc; O2zwa: VkLtT: goto Ikn3U; prRR4: m5hPv: goto gO_QU; zA3Ac: $this->_ion_limit = NULL; goto prRR4; Crssq: $this->_ion_offset = NULL; goto O2zwa; eLdfF: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto Yzwvs; } goto nbhaI; Ikn3U: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto ma4Yz; } goto iiJbd; eKeal: $this->trigger_events("\147\x72\157\x75\160\x73"); goto eLdfF; Kbp_8: QKVlc: goto Mg9b2; nbhaI: foreach ($this->_ion_where as $where) { $this->db->where($where); RIlL4: } goto xIpQJ; KZhhE: } public function group($id = NULL) { goto qziWj; qziWj: $this->trigger_events("\147\x72\157\165\160"); goto cGIdF; k3ztu: $this->where($this->tables["\147\x72\157\x75\160\x73"] . "\x2e\x69\x64", $id); goto pTsbr; dUIcB: return $this->groups(); goto TbKFF; aJVVj: $this->limit(1); goto tFAxP; cGIdF: if (!isset($id)) { goto IuGiM; } goto k3ztu; pTsbr: IuGiM: goto aJVVj; tFAxP: $this->order_by("\x69\x64", "\x64\145\163\x63"); goto dUIcB; TbKFF: } public function update($id, array $data) { goto blTQs; j2vr6: O5FoL: goto UAZjy; XhzdM: return FALSE; goto j2vr6; I3odB: $this->trigger_events(["\160\157\163\x74\137\165\160\x64\141\164\145\137\165\x73\x65\162", "\x70\x6f\163\x74\137\x75\x70\x64\x61\164\x65\137\165\x73\145\x72\137\165\156\163\x75\x63\143\145\163\163\x66\x75\154"]); goto IsQtm; TGIt9: return TRUE; goto myDqz; WvW0s: YURIy: goto GRp23; utkbW: $this->set_error("\165\x70\x64\x61\164\x65\137\x75\156\163\165\x63\x63\145\163\163\146\x75\x6c"); goto XhzdM; oP0gq: if (!array_key_exists("\160\141\x73\163\x77\157\162\144", $data)) { goto k5j1O; } goto geVvU; EuiNi: $this->trigger_events(["\160\x6f\163\164\x5f\165\160\144\x61\164\x65\137\x75\x73\x65\x72", "\160\157\x73\164\x5f\165\x70\144\141\164\145\137\165\163\145\x72\x5f\x75\156\x73\165\143\143\x65\x73\163\146\165\x6c"]); goto rjYv1; Mt7aY: $this->db->trans_rollback(); goto EuiNi; DwnY_: $this->trigger_events(["\160\157\x73\164\137\x75\160\144\141\164\x65\x5f\x75\x73\145\x72", "\x70\157\163\164\137\165\160\x64\x61\164\145\x5f\165\163\x65\162\137\x73\165\x63\143\x65\163\x73\146\x75\x6c"]); goto pMPt2; ZPCYA: goto EGtRi; goto WvW0s; oTSjp: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, ["\x69\144" => $user->id]); goto v_urS; i97o0: $this->db->trans_rollback(); goto Llsz7; kd9aK: EGtRi: goto oNvxm; rjYv1: $this->set_error("\x75\x70\144\141\164\x65\137\165\x6e\x73\x75\143\143\x65\163\163\146\165\x6c"); goto E7O6F; fqmOk: unset($data["\160\x61\163\x73\x77\x6f\162\144"]); goto ZPCYA; Z92MV: FmZ9b: goto jZe2C; ZThA3: return FALSE; goto eMAXx; E7O6F: return FALSE; goto Z92MV; NLIyU: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\163\x73\x77\157\162\144", $data) || array_key_exists("\145\155\x61\151\154", $data))) { goto YVDxs; } goto oP0gq; mGCYo: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto O5FoL; } goto i97o0; Llsz7: $this->set_error("\x61\143\x63\157\165\156\164\x5f\143\x72\145\x61\164\151\157\156\137\144\x75\160\154\x69\x63\141\x74\x65\x5f\x69\144\x65\x6e\x74\151\164\171"); goto WiafP; ZkW0n: $user = $this->user($id)->row(); goto LsxDg; oNvxm: k5j1O: goto cx2yU; WiafP: $this->trigger_events(["\160\x6f\x73\164\x5f\165\160\144\141\x74\x65\137\x75\x73\x65\162", "\160\x6f\163\164\137\165\x70\x64\141\x74\145\137\165\163\x65\x72\137\165\156\x73\x75\143\x63\x65\163\163\146\165\154"]); goto utkbW; jZe2C: $this->db->trans_commit(); goto DwnY_; DMA90: $this->trigger_events("\x65\x78\x74\162\141\137\x77\150\x65\162\145"); goto oTSjp; blTQs: $this->trigger_events("\160\x72\x65\x5f\x75\160\144\141\x74\145\x5f\x75\163\145\x72"); goto ZkW0n; HROn6: $this->db->trans_rollback(); goto I3odB; qiXPQ: if (!($data["\x70\141\163\x73\x77\x6f\x72\x64"] === FALSE)) { goto ggo21; } goto HROn6; IsQtm: $this->set_error("\165\160\x64\141\164\145\x5f\165\156\163\x75\x63\143\x65\163\163\x66\x75\154"); goto ZThA3; LsxDg: $this->db->trans_begin(); goto mGCYo; UAZjy: $data = $this->_filter_data($this->tables["\x75\163\145\162\x73"], $data); goto NLIyU; GRp23: $data["\160\x61\x73\x73\167\157\x72\x64"] = $this->hash_password($data["\x70\141\x73\163\x77\157\162\144"], $user->{$this->identity_column}); goto qiXPQ; cx2yU: YVDxs: goto DMA90; pMPt2: $this->set_message("\165\x70\144\141\164\x65\x5f\x73\165\x63\x63\145\163\x73\146\x75\154"); goto TGIt9; geVvU: if (!empty($data["\160\141\163\x73\167\157\162\x64"])) { goto YURIy; } goto fqmOk; eMAXx: ggo21: goto kd9aK; v_urS: if (!($this->db->trans_status() === FALSE)) { goto FmZ9b; } goto Mt7aY; myDqz: } public function delete_user($id) { goto bgYWU; ddQWh: $this->db->trans_commit(); goto TGgoS; bgYWU: $this->trigger_events("\x70\x72\145\x5f\x64\145\154\x65\164\145\x5f\x75\x73\x65\162"); goto vZUqB; LWTc4: $this->db->trans_rollback(); goto yAi06; mVo6R: $this->set_error("\144\x65\154\x65\x74\145\x5f\x75\x6e\163\x75\x63\x63\145\x73\163\146\165\154"); goto E6BWZ; jN489: if (!($this->db->trans_status() === FALSE)) { goto feIhN; } goto LWTc4; fmCje: $this->db->delete($this->tables["\x75\x73\145\x72\x73"], ["\x69\x64" => $id]); goto jN489; TGgoS: $this->trigger_events(["\x70\157\163\x74\x5f\x64\x65\154\145\164\145\x5f\x75\163\145\162", "\160\x6f\x73\164\137\x64\145\154\145\164\145\137\165\x73\x65\x72\137\x73\x75\143\x63\145\x73\163\146\x75\x6c"]); goto lXn2a; vZUqB: $this->db->trans_begin(); goto GKC7A; yAi06: $this->trigger_events(["\x70\x6f\163\x74\137\144\x65\154\x65\x74\x65\x5f\x75\x73\145\162", "\x70\x6f\163\164\x5f\144\145\154\x65\164\x65\x5f\x75\x73\145\x72\137\x75\x6e\163\165\143\143\x65\x73\163\x66\165\154"]); goto mVo6R; E6BWZ: return FALSE; goto fH6r1; GKC7A: $this->remove_from_group(NULL, $id); goto fmCje; fH6r1: feIhN: goto ddQWh; lXn2a: $this->set_message("\x64\x65\x6c\145\164\145\x5f\163\x75\x63\x63\x65\163\x73\x66\x75\x6c"); goto avKg_; avKg_: return TRUE; goto nQFbc; nQFbc: } public function update_last_login($id) { goto SpLVL; saCYH: $this->db->update($this->tables["\x75\163\145\x72\163"], ["\x6c\x61\163\x74\x5f\154\157\x67\151\x6e" => time()], ["\x69\144" => $id]); goto Q7PjF; SpLVL: $this->trigger_events("\165\160\x64\x61\x74\145\x5f\154\141\163\164\x5f\x6c\x6f\147\151\x6e"); goto xw64U; lW_iz: $this->trigger_events("\x65\170\x74\x72\141\137\167\x68\x65\x72\x65"); goto saCYH; xw64U: $this->load->helper("\x64\x61\164\x65"); goto lW_iz; Q7PjF: return $this->db->affected_rows() == 1; goto dlBaA; dlBaA: } public function set_lang($lang = "\x65\x6e") { goto py7U2; L5e2o: if ($this->config->item("\165\163\145\x72\x5f\x65\x78\x70\151\162\x65", "\151\157\x6e\x5f\141\165\x74\150") === 0) { goto Lw1HX; } goto xes8i; xes8i: $expire = $this->config->item("\x75\x73\x65\x72\137\x65\x78\160\x69\x72\145", "\151\x6f\x6e\x5f\141\165\164\150"); goto uK4MD; kC7dV: set_cookie(["\156\x61\x6d\x65" => "\x6c\x61\x6e\147\x5f\143\157\144\145", "\166\x61\154\x75\x65" => $lang, "\x65\170\160\x69\x72\x65" => $expire]); goto vhUSv; vhUSv: return TRUE; goto P5dUy; vvFa5: $expire = self::MAX_COOKIE_LIFETIME; goto EJJ2W; EJJ2W: Ui3jk: goto kC7dV; py7U2: $this->trigger_events("\163\x65\164\137\x6c\141\x6e\147"); goto L5e2o; vSGbH: Lw1HX: goto vvFa5; uK4MD: goto Ui3jk; goto vSGbH; P5dUy: } public function set_session($user) { goto sSnkH; ruARz: $session_data = ["\x69\x64\145\x6e\164\151\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\151\x6c" => $user->email, "\x75\x73\145\x72\x5f\x69\144" => $user->id, "\157\154\144\x5f\x6c\141\163\164\137\x6c\x6f\147\151\x6e" => $user->last_login, "\154\141\163\x74\x5f\x63\150\x65\143\x6b" => time()]; goto RUXrO; gho4h: return TRUE; goto sX0j5; sSnkH: $this->trigger_events("\160\x72\145\x5f\163\x65\x74\x5f\163\x65\x73\x73\x69\157\x6e"); goto ruARz; RUXrO: $this->session->set_userdata($session_data); goto aPfZ8; aPfZ8: $this->trigger_events("\x70\157\x73\164\137\x73\145\164\x5f\x73\x65\163\x73\151\x6f\156"); goto gho4h; sX0j5: } public function remember_user($identity) { goto uMPHd; IlLQN: EbZNO: goto KALfX; xslJj: O0PT7: goto BCQrX; wRhag: TRD8K: goto xslJj; MrqIf: return FALSE; goto rqFa0; gTXMS: if (!$token->validator_hashed) { goto O0PT7; } goto xmTxT; K_vtr: $expire = $this->config->item("\165\163\145\x72\137\145\x78\160\151\x72\x65", "\151\x6f\156\x5f\x61\x75\164\x68"); goto aoxH2; CnNBx: EbeyC: goto VVxx2; L4AFY: if (!($this->db->affected_rows() > -1)) { goto TRD8K; } goto ghnzZ; YbQhJ: if ($identity) { goto fgUa2; } goto MrqIf; rqFa0: fgUa2: goto S85Hc; aoxH2: goto EbZNO; goto CnNBx; BCQrX: $this->trigger_events(["\x70\157\x73\x74\x5f\x72\145\x6d\145\155\x62\145\x72\x5f\x75\163\145\162", "\162\x65\155\x65\155\142\145\162\137\165\163\x65\x72\137\x75\156\x73\x75\x63\143\145\163\163\x66\165\154"]); goto HxkKe; ghnzZ: if ($this->config->item("\x75\163\x65\162\x5f\145\x78\160\151\162\145", "\151\x6f\x6e\x5f\141\165\x74\150") === 0) { goto EbeyC; } goto K_vtr; VVxx2: $expire = self::MAX_COOKIE_LIFETIME; goto IlLQN; S85Hc: $token = $this->_generate_selector_validator_couple(); goto gTXMS; tc3o5: $this->trigger_events(["\160\157\x73\164\x5f\162\x65\155\145\x6d\142\145\x72\x5f\165\x73\x65\162", "\x72\145\155\145\155\x62\x65\162\137\165\x73\x65\x72\137\x73\x75\143\143\145\163\x73\146\x75\154"]); goto awPmP; xmTxT: $this->db->update($this->tables["\165\x73\x65\x72\163"], ["\162\145\155\145\x6d\x62\x65\x72\x5f\163\145\154\145\x63\x74\157\162" => $token->selector, "\x72\145\x6d\x65\155\x62\x65\x72\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto L4AFY; KALfX: set_cookie(["\x6e\141\x6d\145" => $this->config->item("\x72\145\155\x65\x6d\142\x65\x72\x5f\x63\157\157\153\151\145\137\156\x61\x6d\x65", "\151\x6f\156\x5f\141\x75\x74\150"), "\166\x61\154\165\x65" => $token->user_code, "\145\170\160\x69\162\x65" => $expire]); goto tc3o5; HxkKe: return FALSE; goto aiZdN; uMPHd: $this->trigger_events("\x70\x72\145\x5f\162\145\x6d\145\x6d\142\x65\162\x5f\165\163\145\x72"); goto YbQhJ; awPmP: return TRUE; goto wRhag; aiZdN: } public function login_remembered_user() { goto C5831; GQJLp: $this->session->sess_regenerate(FALSE); goto HTHEg; t_QNp: delete_cookie($this->config->item("\x72\145\155\x65\155\x62\x65\162\137\143\157\157\153\151\x65\x5f\x6e\x61\155\145", "\x69\157\156\x5f\x61\x75\164\x68")); goto RKdwF; CSo4x: qpcXG: goto u7KIk; qGbNg: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto qpcXG; } goto QLfWe; feIyW: return FALSE; goto QvC7h; zEZbT: $this->set_session($user); goto N5vf6; QLfWe: $this->update_last_login($user->id); goto zEZbT; J8gTF: $remember_cookie = get_cookie($this->config->item("\x72\145\x6d\x65\155\142\x65\x72\x5f\x63\x6f\157\x6b\151\145\137\156\141\x6d\145", "\151\157\x6e\x5f\141\x75\164\150")); goto B2PVV; eZhR7: $query = $this->db->select($this->identity_column . "\54\40\151\144\x2c\x20\145\x6d\141\x69\x6c\54\x20\162\145\155\145\x6d\142\145\162\137\x63\x6f\x64\145\x2c\40\x6c\x61\163\x74\137\x6c\x6f\147\151\x6e")->where("\162\x65\155\145\x6d\x62\x65\162\x5f\163\145\154\x65\x63\164\157\x72", $token->selector)->where("\141\x63\164\x69\166\x65", 1)->limit(1)->get($this->tables["\165\163\145\x72\163"]); goto NoOME; N5vf6: $this->clear_forgotten_password_code($identity); goto dgpzW; zVt7G: pN_d1: goto Qhzno; TEvY5: return FALSE; goto zVt7G; C5831: $this->trigger_events("\x70\x72\x65\137\x6c\x6f\147\151\x6e\x5f\162\x65\155\x65\155\142\145\162\x65\x64\x5f\165\163\145\x72"); goto J8gTF; tUJuC: $identity = $user->{$this->identity_column}; goto qGbNg; RKdwF: $this->trigger_events(["\160\x6f\163\x74\137\154\157\x67\151\x6e\x5f\162\x65\155\145\x6d\x62\x65\162\x65\x64\137\165\x73\x65\162", "\160\x6f\163\x74\x5f\x6c\x6f\147\x69\156\x5f\x72\145\155\x65\x6d\x62\x65\162\x65\144\x5f\x75\x73\x65\x72\x5f\x75\156\163\165\143\143\x65\163\163\146\x75\154"]); goto feIyW; B2PVV: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto iEQeY; YrndA: gcyqI: goto GQJLp; Qhzno: $this->trigger_events("\145\170\x74\162\x61\x5f\x77\x68\x65\x72\145"); goto eZhR7; IX8z9: $this->remember_user($identity); goto YrndA; NoOME: if (!($query->num_rows() === 1)) { goto iM51i; } goto MqnYp; dgpzW: if (!$this->config->item("\165\x73\x65\x72\x5f\x65\x78\164\x65\x6e\144\137\157\x6e\x5f\x6c\x6f\x67\151\x6e", "\151\x6f\156\137\141\165\164\150")) { goto gcyqI; } goto IX8z9; u7KIk: iM51i: goto t_QNp; vFWfa: return TRUE; goto CSo4x; iEQeY: if (!($token === FALSE)) { goto pN_d1; } goto KkajJ; KkajJ: $this->trigger_events(["\x70\157\x73\x74\x5f\x6c\157\x67\151\156\137\162\x65\155\145\155\142\x65\x72\145\x64\137\x75\163\145\x72", "\x70\157\163\164\137\154\x6f\147\151\156\x5f\162\x65\x6d\145\155\x62\145\x72\145\x64\137\165\x73\x65\162\x5f\x75\x6e\x73\165\x63\x63\x65\163\x73\146\x75\154"]); goto TEvY5; MqnYp: $user = $query->row(); goto tUJuC; HTHEg: $this->trigger_events(["\x70\x6f\163\x74\x5f\154\x6f\x67\x69\x6e\x5f\x72\145\155\x65\155\x62\145\162\145\144\x5f\165\x73\x65\x72", "\160\157\x73\x74\x5f\x6c\x6f\x67\151\156\x5f\162\145\155\145\x6d\142\x65\x72\x65\144\137\165\163\x65\x72\137\163\165\143\x63\145\163\163\146\x75\x6c"]); goto vFWfa; QvC7h: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto B3fmz; nEtYI: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\165\160\163"], ["\156\x61\155\145" => $group_name])->num_rows(); goto JgsNr; dmHdq: return $group_id; goto lou4Q; g0pFj: $group_id = $this->db->insert_id($this->tables["\147\162\x6f\x75\x70\163"] . "\x5f\x69\x64\137\163\x65\161"); goto PHQbR; bWNNq: $this->db->insert($this->tables["\x67\162\157\x75\160\163"], $data); goto g0pFj; RR3gm: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\x70\163"], $additional_data), $data); goto Zwvcq; PHQbR: $this->set_message("\x67\x72\157\x75\x70\x5f\x63\162\x65\141\x74\151\x6f\156\x5f\163\x75\143\143\145\x73\x73\x66\165\154"); goto dmHdq; ZPUUO: QNuh_: goto nEtYI; yXj7B: $this->set_error("\147\x72\157\165\160\137\x61\154\x72\x65\141\x64\x79\137\x65\x78\x69\x73\164\163"); goto r0CJ2; JgsNr: if (!($existing_group !== 0)) { goto TZxN9; } goto yXj7B; BhoxH: $this->trigger_events("\x65\x78\x74\162\141\x5f\x67\162\x6f\x75\x70\x5f\163\x65\x74"); goto bWNNq; WOYfX: return FALSE; goto ZPUUO; r0CJ2: return FALSE; goto XsVki; B3fmz: if ($group_name) { goto QNuh_; } goto IsYKd; Zwvcq: B6F1r: goto BhoxH; Yzymp: if (empty($additional_data)) { goto B6F1r; } goto RR3gm; IsYKd: $this->set_error("\147\x72\x6f\165\x70\137\x6e\x61\155\145\137\x72\145\161\x75\151\162\x65\x64"); goto WOYfX; BaqbV: $data = ["\156\x61\155\x65" => $group_name, "\144\145\x73\x63\162\x69\160\x74\x69\x6f\x6e" => $group_description]; goto Yzymp; XsVki: TZxN9: goto BaqbV; lou4Q: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto NVAN8; Hqki6: WP5mR: goto znXDO; heHYh: $this->db->update($this->tables["\x67\x72\x6f\165\160\163"], $data, ["\151\x64" => $group_id]); goto iy7ms; NVAN8: if (!empty($group_id)) { goto WP5mR; } goto v43Z4; Icy9C: if (empty($additional_data)) { goto L64lD; } goto QkeoE; WfMol: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto ZQaAy; } goto btj7S; ccRyq: L64lD: goto heHYh; btj7S: $this->set_error("\x67\162\x6f\165\160\x5f\x61\154\x72\x65\141\144\171\137\x65\170\x69\163\x74\163"); goto xr6bK; jsH34: if (!($this->config->item("\141\144\x6d\x69\156\x5f\x67\x72\x6f\x75\x70", "\151\157\x6e\137\141\x75\164\x68") === $group->name && $group_name !== $group->name)) { goto A8_tf; } goto J2YQ4; iy7ms: $this->set_message("\x67\162\157\x75\x70\x5f\165\160\144\141\x74\x65\x5f\163\165\x63\x63\145\x73\x73\146\165\x6c"); goto EvHrJ; fhQyg: $data["\x6e\141\155\x65"] = $group_name; goto DBGwq; J2YQ4: $this->set_error("\x67\x72\157\x75\x70\x5f\156\141\155\x65\137\141\144\x6d\151\156\137\156\x6f\164\x5f\141\154\x74\x65\x72"); goto NX9rp; xr6bK: return FALSE; goto aXYTu; NX9rp: return FALSE; goto Z6aW3; znXDO: $data = []; goto azcT9; QkeoE: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\x70\163"], $additional_data), $data); goto ccRyq; cb_fi: $existing_group = $this->db->get_where($this->tables["\147\x72\157\x75\160\x73"], ["\156\x61\x6d\x65" => $group_name])->row(); goto WfMol; EvHrJ: return TRUE; goto qJZ56; v43Z4: return FALSE; goto Hqki6; pEjET: $group = $this->db->get_where($this->tables["\147\x72\157\165\160\x73"], ["\151\144" => $group_id])->row(); goto jsH34; DBGwq: aqzld: goto pEjET; Z6aW3: A8_tf: goto Icy9C; aXYTu: ZQaAy: goto fhQyg; azcT9: if (empty($group_name)) { goto aqzld; } goto cb_fi; qJZ56: } public function delete_group($group_id = FALSE) { goto vFapo; lTiKQ: if (!($group->name == $this->config->item("\x61\144\155\x69\x6e\x5f\147\162\x6f\x75\160", "\151\x6f\x6e\137\141\165\x74\150"))) { goto tZJhM; } goto nAjoK; lZcKA: $this->set_error("\x67\x72\157\x75\160\x5f\144\145\x6c\x65\164\x65\137\156\157\164\x61\154\x6c\x6f\x77\x65\x64"); goto fcDSJ; T0x97: $this->trigger_events(["\160\157\163\x74\137\144\145\x6c\x65\x74\x65\x5f\x67\x72\157\165\x70", "\160\x6f\x73\x74\137\144\145\154\145\164\145\x5f\x67\162\157\x75\x70\x5f\x73\x75\x63\143\145\x73\163\x66\x75\154"]); goto ssjMa; PS8zW: return TRUE; goto tARfI; nU7zN: u6NFf: goto szax2; kKIlw: return FALSE; goto nU7zN; H51ic: tZJhM: goto LDvN8; hDddV: aBsAF: goto fMVn4; LJvIP: return FALSE; goto hDddV; OtFTU: if (!($this->db->trans_status() === FALSE)) { goto u6NFf; } goto F2bjI; nAjoK: $this->trigger_events(["\160\x6f\x73\164\137\144\x65\x6c\x65\x74\145\x5f\147\162\x6f\x75\160", "\x70\x6f\163\164\x5f\x64\145\x6c\145\164\145\x5f\147\x72\x6f\x75\x70\x5f\156\157\164\x61\154\x6c\157\x77\x65\x64"]); goto lZcKA; xptFQ: $this->db->delete($this->tables["\165\163\x65\162\x73\137\x67\x72\157\x75\160\x73"], [$this->join["\x67\x72\x6f\x75\x70\163"] => $group_id]); goto fdKyq; szax2: $this->db->trans_commit(); goto T0x97; LDvN8: $this->trigger_events("\x70\x72\x65\137\x64\145\154\145\164\x65\137\147\162\x6f\x75\x70"); goto A2cPc; fMVn4: $group = $this->group($group_id)->row(); goto lTiKQ; vFapo: if (!(!$group_id || empty($group_id))) { goto aBsAF; } goto LJvIP; nF2_P: $this->set_error("\147\162\x6f\165\160\x5f\x64\x65\154\145\164\145\x5f\165\156\x73\x75\143\x63\x65\163\163\146\165\x6c"); goto kKIlw; fcDSJ: return FALSE; goto H51ic; F2bjI: $this->db->trans_rollback(); goto kxvDl; kxvDl: $this->trigger_events(["\x70\x6f\163\164\137\x64\x65\x6c\145\x74\145\137\147\162\157\x75\160", "\x70\x6f\x73\164\x5f\x64\x65\154\x65\x74\145\x5f\147\x72\x6f\165\x70\137\165\x6e\x73\165\143\x63\145\x73\x73\146\165\x6c"]); goto nF2_P; ssjMa: $this->set_message("\147\x72\157\x75\x70\137\x64\x65\154\x65\164\x65\137\163\165\143\143\x65\163\x73\x66\x75\154"); goto PS8zW; A2cPc: $this->db->trans_begin(); goto xptFQ; fdKyq: $this->db->delete($this->tables["\147\162\x6f\x75\x70\163"], ["\151\x64" => $group_id]); goto OtFTU; tARfI: } public function set_hook($event, $name, $class, $method, $arguments) { goto ditPI; ditPI: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto uglCO; uglCO: $this->_ion_hooks->{$event}[$name]->class = $class; goto ER3JC; ER3JC: $this->_ion_hooks->{$event}[$name]->method = $method; goto Vo0uE; Vo0uE: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto rkL76; rkL76: } public function remove_hook($event, $name) { goto KVeAs; sI5zs: Wf_q5: goto cPkoB; AaZty: unset($this->_ion_hooks->{$event}[$name]); goto sI5zs; KVeAs: if (!isset($this->_ion_hooks->{$event}[$name])) { goto Wf_q5; } goto AaZty; cPkoB: } public function remove_hooks($event) { goto scQa9; scQa9: if (!isset($this->_ion_hooks->{$event})) { goto LGXwR; } goto HKv6z; HKv6z: unset($this->_ion_hooks->{$event}); goto QMf6V; QMf6V: LGXwR: goto tRWbe; tRWbe: } protected function _call_hook($event, $name) { goto RRz2T; f9TKP: return FALSE; goto Y6eAl; RRz2T: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto fXWvx; } goto CtgjL; HV8my: fXWvx: goto f9TKP; CtgjL: $hook = $this->_ion_hooks->{$event}[$name]; goto jjum7; jjum7: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto HV8my; Y6eAl: } public function trigger_events($events) { goto trfeU; b2C58: aDhoY: goto SQSJA; Rd5JN: foreach ($events as $event) { $this->trigger_events($event); WsXeB: } goto BHfIX; SQSJA: goto EieFp; goto f1kwg; hLucB: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto aDhoY; } goto Rs0P0; VvMS3: EieFp: goto ZYpXW; trfeU: if (is_array($events) && !empty($events)) { goto wLWOD; } goto hLucB; f1kwg: wLWOD: goto Rd5JN; cJSO5: OC3Eu: goto b2C58; Rs0P0: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); wR8aT: } goto cJSO5; BHfIX: XIfUW: goto VvMS3; ZYpXW: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto NWL3H; NWL3H: $this->message_start_delimiter = $start_delimiter; goto kAt29; xcmvU: return TRUE; goto TeL_5; kAt29: $this->message_end_delimiter = $end_delimiter; goto xcmvU; TeL_5: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto ztNMD; vabQZ: return TRUE; goto gWwzR; HfNPN: $this->error_end_delimiter = $end_delimiter; goto vabQZ; ztNMD: $this->error_start_delimiter = $start_delimiter; goto HfNPN; gWwzR: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto Vf7Up; lUWuz: foreach ($this->messages as $message) { goto Su58q; tG6Jl: RzQpn: goto DFkga; qlLB1: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto tG6Jl; Su58q: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto qlLB1; DFkga: } goto vJRNe; vJRNe: RSXV5: goto eQ8o2; eQ8o2: return $_output; goto V8ceo; Vf7Up: $_output = ''; goto lUWuz; V8ceo: } public function messages_array($langify = TRUE) { goto qM4VG; E0ywA: goto ZKIkx; goto CO2wc; OcWEJ: $_output = []; goto lupGI; lupGI: foreach ($this->messages as $message) { goto wZ9NN; hprmQ: acUda: goto F8mjC; oNZpC: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto hprmQ; wZ9NN: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto oNZpC; F8mjC: } goto iPZs3; eSpIG: return $this->messages; goto E0ywA; CO2wc: xM5G8: goto OcWEJ; iPZs3: icu6_: goto KMS1E; fRQgN: ZKIkx: goto h2FME; qM4VG: if ($langify) { goto xM5G8; } goto eSpIG; KMS1E: return $_output; goto fRQgN; h2FME: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto IjavL; x1xz3: return $_output; goto PySeO; kM40l: mki0T: goto x1xz3; OhnPD: foreach ($this->errors as $error) { goto iYjYx; iYjYx: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\x23"; goto KMgTc; KMgTc: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto LzbuW; LzbuW: lE1PW: goto hH2_D; hH2_D: } goto kM40l; IjavL: $_output = ''; goto OhnPD; PySeO: } public function errors_array($langify = TRUE) { goto DAFxA; dtOVJ: rDp_g: goto ldO4T; rKPnO: UYbFk: goto pxOo2; Z3Jte: goto rDp_g; goto rKPnO; DZ2UY: return $this->errors; goto Z3Jte; DAFxA: if ($langify) { goto UYbFk; } goto DZ2UY; fe8je: return $_output; goto dtOVJ; Y3FOg: foreach ($this->errors as $error) { goto GArdw; ZLgmn: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto G3Bt8; GArdw: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto ZLgmn; G3Bt8: AabAQ: goto sALib; sALib: } goto NtWeH; NtWeH: D2RHl: goto fe8je; pxOo2: $_output = []; goto Y3FOg; ldO4T: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto jS_2Q; D1TtE: $this->db->update($this->tables["\165\163\145\162\x73"], $data, [$this->identity_column => $identity]); goto BSoi3; vNlc1: $this->trigger_events("\x65\x78\164\162\141\137\x77\150\145\x72\145"); goto D1TtE; v27CU: RXu3c: goto lGmu8; mp9gJ: return FALSE; goto v27CU; jS_2Q: $hash = $this->hash_password($password, $identity); goto kIssR; BSoi3: return $this->db->affected_rows() == 1; goto yPadV; kIssR: if (!($hash === FALSE)) { goto RXu3c; } goto mp9gJ; lGmu8: $data = ["\160\141\163\163\x77\157\x72\x64" => $hash, "\162\x65\155\x65\155\142\145\162\137\x63\x6f\x64\x65" => NULL, "\146\x6f\x72\x67\157\x74\164\145\x6e\137\x70\141\163\x73\x77\157\x72\144\137\x63\157\144\145" => NULL, "\x66\157\x72\147\x6f\x74\164\x65\156\x5f\160\x61\x73\163\167\x6f\162\144\x5f\164\151\x6d\145" => NULL]; goto vNlc1; yPadV: } protected function _filter_data($table, $data) { goto zUG1I; LhY2M: $columns = $this->db->list_fields($table); goto eNiyg; eNiyg: if (!is_array($data)) { goto qBmzg; } goto XvYld; q3pIa: ayuPM: goto dh2wn; XvYld: foreach ($columns as $column) { goto uuUdA; vY3Ax: cRxEW: goto wBpj0; WJptw: jjvQW: goto vY3Ax; uuUdA: if (!array_key_exists($column, $data)) { goto jjvQW; } goto jATBi; jATBi: $filtered_data[$column] = $data[$column]; goto WJptw; wBpj0: } goto q3pIa; PW0FT: return $filtered_data; goto AVFmh; dh2wn: qBmzg: goto PW0FT; zUG1I: $filtered_data = []; goto LhY2M; AVFmh: } protected function _random_token($result_length = 32) { goto qYMmq; SeTcJ: $result_length = 32; goto re9CX; T9RpR: if (!function_exists("\162\x61\156\144\x6f\155\x5f\142\x79\164\145\x73")) { goto HMO5m; } goto UBdIO; W130J: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto AChBt; fshu0: Ra5K4: goto uY3ng; uY3ng: return FALSE; goto w8I6I; NOHN6: if (!function_exists("\157\x70\x65\x6e\x73\x73\154\137\162\141\156\144\157\x6d\137\x70\x73\x65\x75\x64\x6f\137\142\171\164\145\x73")) { goto Ra5K4; } goto p13BD; IlF8y: HMO5m: goto NUGWE; re9CX: TWRle: goto T9RpR; p13BD: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto fshu0; qYMmq: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto TWRle; } goto SeTcJ; NUGWE: if (!function_exists("\x6d\143\x72\x79\x70\x74\x5f\x63\162\145\141\x74\x65\137\x69\166")) { goto BZTv6; } goto W130J; AChBt: BZTv6: goto NOHN6; UBdIO: return bin2hex(random_bytes($result_length / 2)); goto IlF8y; w8I6I: } protected function _get_hash_parameters($identity = NULL) { goto THMUK; wUtso: switch ($this->hash_method) { case "\142\143\x72\x79\x70\x74": $params = ["\x63\157\163\164" => $is_admin ? $this->config->item("\142\x63\162\171\160\164\x5f\x61\x64\155\151\156\x5f\143\x6f\163\164", "\151\x6f\156\x5f\x61\x75\x74\x68") : $this->config->item("\x62\143\x72\171\x70\164\137\144\145\146\141\165\x6c\164\x5f\x63\x6f\x73\164", "\x69\x6f\x6e\x5f\x61\165\164\x68")]; goto f0Jhx; case "\x61\162\147\x6f\x6e\62": $params = $is_admin ? $this->config->item("\141\162\x67\x6f\156\x32\137\x61\x64\155\x69\x6e\x5f\160\141\x72\141\x6d\163", "\x69\x6f\156\x5f\x61\165\x74\150") : $this->config->item("\x61\x72\x67\157\x6e\62\137\x64\x65\x66\x61\x75\154\x74\137\160\141\x72\141\155\163", "\151\x6f\156\x5f\x61\x75\164\x68"); goto f0Jhx; default: } goto LVw7_; LVw7_: jAink: goto bFMZp; aJoAR: if (!($user_id && $this->in_group($this->config->item("\x61\x64\x6d\x69\156\x5f\147\x72\x6f\165\160", "\x69\x6f\x6e\x5f\x61\165\x74\x68"), $user_id))) { goto tuQdZ; } goto dqrHg; EY6L2: if (!$identity) { goto XHpkP; } goto m2Ruo; bFMZp: f0Jhx: goto uuS2R; m2Ruo: $user_id = $this->get_user_id_from_identity($identity); goto aJoAR; rvu0L: XHpkP: goto k8kfz; dqrHg: $is_admin = TRUE; goto wG4P1; wG4P1: tuQdZ: goto rvu0L; k8kfz: $params = FALSE; goto wUtso; THMUK: $is_admin = FALSE; goto EY6L2; uuS2R: return $params; goto KTEzj; KTEzj: } protected function _get_hash_algo() { goto RKAFR; DVq53: return $algo; goto AYI4V; Lnn3t: switch ($this->hash_method) { case "\142\143\162\171\160\x74": $algo = PASSWORD_BCRYPT; goto MP9Zr; case "\x61\162\147\x6f\x6e\62": $algo = PASSWORD_ARGON2I; goto MP9Zr; default: } goto otqgh; otqgh: EEEcW: goto S5r5N; S5r5N: MP9Zr: goto DVq53; RKAFR: $algo = FALSE; goto Lnn3t; AYI4V: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto FlR1G; UIPlp: $validator_hashed = $this->hash_password($validator); goto ESKRh; FlR1G: $selector = $this->_random_token($selector_size); goto Efhsj; ESKRh: $user_code = "{$selector}\x2e{$validator}"; goto JlWZ8; JlWZ8: return (object) ["\x73\145\154\x65\x63\164\157\162" => $selector, "\x76\x61\x6c\x69\x64\141\164\157\162\x5f\x68\141\x73\150\145\144" => $validator_hashed, "\x75\x73\x65\162\x5f\143\x6f\144\145" => $user_code]; goto kQVxW; Efhsj: $validator = $this->_random_token($validator_size); goto UIPlp; kQVxW: } protected function _retrieve_selector_validator_couple($user_code) { goto I2rjF; I2rjF: if (!$user_code) { goto UQLcd; } goto lgGyf; lgGyf: $tokens = explode("\56", $user_code); goto agjH1; agjH1: if (!(count($tokens) === 2)) { goto rjD8u; } goto Hkm0a; XIRks: return FALSE; goto YLLy7; sPQTL: UQLcd: goto XIRks; Hkm0a: return (object) ["\163\x65\154\145\143\x74\157\162" => $tokens[0], "\166\x61\x6c\x69\144\141\164\157\162" => $tokens[1]]; goto ev71n; ev71n: rjD8u: goto sPQTL; YLLy7: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto C0csK; Uac9b: $this->trigger_events(["\160\x6f\x73\x74\x5f\163\x68\x61\x31\x5f\x70\x61\163\163\x77\x6f\x72\x64\137\x6d\x69\x67\x72\x61\164\151\157\x6e", "\x70\157\x73\164\x5f\163\x68\141\x31\137\x70\141\x73\x73\167\157\x72\x64\x5f\x6d\x69\147\162\141\x74\151\157\156\x5f\x75\x6e\163\165\143\x63\145\x73\163\146\x75\154"]); goto cqoc9; nLXKc: $this->trigger_events(["\x70\157\163\x74\x5f\x73\150\141\61\x5f\x70\141\163\x73\167\x6f\162\144\137\155\x69\147\x72\141\x74\x69\157\156", "\x70\157\x73\164\x5f\x73\x68\141\x31\x5f\160\x61\163\163\167\157\x72\x64\x5f\155\x69\x67\x72\141\164\151\157\x6e\137\x75\156\163\x75\x63\143\x65\x73\163\146\x75\154"]); goto a_G1l; Y9ZGQ: N68fF: goto mvVyT; yC21S: $result = $this->_set_password_db($identity, $password); goto PNfZR; ziZXN: return $result; goto L8DQg; MNT5s: UO5Hu: goto x_tJL; PNfZR: if ($result) { goto UO5Hu; } goto E7wK2; E7wK2: $this->trigger_events(["\x70\x6f\x73\164\137\163\x68\141\61\137\160\141\163\x73\167\x6f\162\144\x5f\x6d\x69\x67\162\x61\164\x69\157\x6e", "\x70\x6f\x73\164\x5f\x73\150\x61\x31\137\160\x61\163\x73\167\x6f\162\144\x5f\x6d\x69\x67\x72\141\x74\151\157\156\x5f\x75\156\x73\x75\x63\143\x65\163\x73\x66\165\154"]); goto m2zmQ; J38Nn: $salt = substr($hashed_password_db, 0, $salt_length); goto cr1AQ; C0csK: $this->trigger_events("\160\162\x65\137\163\150\x61\x31\137\x70\141\x73\163\x77\x6f\162\144\137\x6d\x69\147\162\141\164\151\x6f\156"); goto JIDFh; k62VT: if ($salt_length) { goto SuN7b; } goto Uac9b; XVC0_: G9RLb: goto ziZXN; L8DQg: tQDiW: goto ZqBZU; m1vOk: if (!($query->num_rows() !== 1)) { goto Y51y8; } goto ApeYa; R27Yj: if ($hashed_password === $hashed_password_db) { goto gte4M; } goto nLXKc; J53pX: hSu4H: goto R27Yj; Zmpg0: $hashed_password = sha1($password . $salt_db->salt); goto J53pX; Xi2qA: $salt_db = $query->row(); goto m1vOk; m2zmQ: goto G9RLb; goto MNT5s; rDKWc: SuN7b: goto J38Nn; bgqlU: goto tQDiW; goto e1Cyy; a_G1l: return FALSE; goto bgqlU; PJAf0: Y51y8: goto Zmpg0; x_tJL: $this->trigger_events(["\160\157\x73\x74\137\163\x68\x61\61\137\x70\x61\x73\x73\x77\x6f\162\144\137\x6d\x69\x67\x72\141\164\151\157\x6e", "\x70\157\x73\x74\137\163\x68\141\x31\137\x70\x61\163\x73\167\157\x72\x64\x5f\x6d\x69\x67\162\x61\x74\x69\157\x6e\x5f\x73\165\143\143\x65\163\163\x66\165\x6c"]); goto XVC0_; JIDFh: if ($this->config->item("\x73\164\x6f\x72\x65\x5f\163\x61\x6c\x74", "\151\x6f\x6e\x5f\141\x75\x74\150")) { goto N68fF; } goto UuMUk; ApeYa: $this->trigger_events(["\160\157\163\x74\137\163\x68\141\x31\137\x70\x61\x73\163\x77\157\162\x64\137\155\151\147\x72\141\x74\151\x6f\x6e", "\160\157\x73\164\x5f\x73\x68\141\61\x5f\160\x61\163\x73\167\x6f\162\x64\x5f\x6d\151\x67\x72\141\x74\x69\x6f\156\x5f\x75\156\x73\x75\x63\143\x65\163\x73\x66\x75\154"]); goto DYD6W; cqoc9: return FALSE; goto rDKWc; DYD6W: return FALSE; goto PJAf0; PDJwG: goto hSu4H; goto Y9ZGQ; UuMUk: $salt_length = $this->config->item("\x73\141\154\164\x5f\154\145\x6e\x67\x74\150", "\x69\x6f\156\x5f\x61\165\164\150"); goto k62VT; mvVyT: $query = $this->db->select("\x73\141\154\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto Xi2qA; e1Cyy: gte4M: goto yC21S; cr1AQ: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto PDJwG; ZqBZU: } }
