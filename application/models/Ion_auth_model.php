<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\x53\105\x50\x41\x54\110") or exit("\x4e\157\40\144\x69\x72\x65\x63\x74\x20\163\143\x72\x69\160\x74\x20\x61\143\x63\145\x73\x73\x20\141\x6c\154\x6f\167\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto CNnIH; o8ayU: $this->load->helper("\x63\x6f\x6f\153\x69\x65"); goto qAKrM; H3XJu: $this->lang->load("\151\157\156\137\141\x75\x74\x68"); goto XcNrq; i4Mkw: $this->messages = []; goto KIKes; hM0TR: $this->trigger_events("\x6d\157\x64\145\154\137\x63\157\156\x73\x74\x72\x75\x63\164\157\x72"); goto jPQb2; yoga7: $error_prefix = $form_validation_class->getProperty("\137\145\x72\x72\157\162\x5f\160\x72\145\146\x69\x78"); goto lV1Rh; KIKes: $this->errors = []; goto TBV33; QoNXG: $this->identity_column = $this->config->item("\x69\x64\x65\156\x74\151\x74\x79", "\151\x6f\x6e\x5f\x61\x75\x74\150"); goto U0hyQ; d7rGa: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto lrczK; MMqsx: $this->hash_method = $this->config->item("\x68\x61\x73\150\137\155\145\x74\x68\x6f\144", "\x69\157\x6e\137\x61\165\x74\150"); goto i4Mkw; fJ7O1: $this->load->library("\x66\x6f\162\x6d\137\x76\141\154\151\x64\x61\x74\x69\x6f\156"); goto VEeLM; Vb9_w: $this->message_start_delimiter = $this->config->item("\155\145\x73\x73\141\147\x65\x5f\163\x74\x61\162\164\137\x64\145\x6c\x69\x6d\x69\164\x65\162", "\151\157\156\137\141\x75\164\x68"); goto bgKiH; YQNY5: $CI =& get_instance(); goto YZCAt; U0hyQ: $this->join = $this->config->item("\x6a\x6f\x69\x6e", "\x69\x6f\156\137\141\x75\164\x68"); goto MMqsx; gOQRf: $this->message_start_delimiter = $this->error_start_delimiter; goto QjNw2; oTjey: goto VQX7U; goto SyTQE; XcNrq: $group_name = $this->config->item("\144\x61\x74\x61\x62\141\x73\x65\137\x67\162\x6f\x75\x70\x5f\156\x61\x6d\145", "\x69\x6f\156\137\x61\x75\x74\x68"); goto xQUFr; lrczK: $this->message_end_delimiter = $this->error_end_delimiter; goto bA9WW; Nfxba: $this->db = $this->load->database($group_name, TRUE, TRUE); goto uQqmP; TBV33: $delimiters_source = $this->config->item("\x64\x65\154\151\155\151\164\145\x72\163\x5f\163\x6f\165\x72\143\x65", "\151\157\x6e\137\x61\165\x74\x68"); goto vlRiB; uQqmP: goto Zd2fm; goto gQwhN; CNnIH: $this->config->load("\x69\x6f\x6e\137\x61\165\164\150", TRUE); goto o8ayU; QjNw2: $error_suffix = $form_validation_class->getProperty("\137\145\x72\x72\x6f\x72\x5f\x73\x75\x66\146\151\170"); goto Gp6Ko; SyTQE: u_YWG: goto fJ7O1; VEeLM: $form_validation_class = new ReflectionClass("\103\111\137\106\157\x72\155\137\166\x61\154\151\x64\x61\x74\x69\x6f\x6e"); goto yoga7; Hvbt2: $this->error_end_delimiter = $this->config->item("\x65\x72\162\x6f\x72\x5f\145\x6e\144\x5f\144\x65\154\x69\x6d\151\164\145\x72", "\151\157\x6e\x5f\x61\165\x74\x68"); goto oTjey; OXp1M: $this->tables = $this->config->item("\x74\141\x62\x6c\x65\163", "\x69\157\x6e\137\141\x75\164\150"); goto QoNXG; YZCAt: $this->db = $CI->db; goto wW63u; bgKiH: $this->message_end_delimiter = $this->config->item("\155\145\163\x73\141\x67\x65\137\x65\x6e\144\x5f\x64\145\154\x69\x6d\151\164\x65\x72", "\x69\x6f\156\137\x61\165\x74\x68"); goto JDkD3; lV1Rh: $error_prefix->setAccessible(TRUE); goto t_DFR; JDkD3: $this->error_start_delimiter = $this->config->item("\145\x72\x72\157\x72\137\x73\164\x61\162\x74\137\144\145\x6c\x69\x6d\x69\x74\145\x72", "\151\157\x6e\x5f\x61\165\164\150"); goto Hvbt2; wW63u: Zd2fm: goto OXp1M; KoYCo: $this->_ion_hooks = new stdClass(); goto hM0TR; vlRiB: if ($delimiters_source === "\x66\x6f\x72\155\137\166\141\x6c\x69\144\141\x74\151\157\156") { goto u_YWG; } goto Vb9_w; t_DFR: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto gOQRf; xQUFr: if (empty($group_name)) { goto tMU1c; } goto Nfxba; qAKrM: $this->load->helper("\144\x61\x74\145"); goto H3XJu; gQwhN: tMU1c: goto YQNY5; Gp6Ko: $error_suffix->setAccessible(TRUE); goto d7rGa; bA9WW: VQX7U: goto KoYCo; jPQb2: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto J2i0l; Qwhhk: Uyp6D: goto zxhxb; gv2y1: NgcA8: goto bewCZ; zxhxb: return FALSE; goto NnPA6; J2i0l: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto NgcA8; } goto XeVeO; yIxpQ: return password_hash($password, $algo, $params); goto Qwhhk; XeVeO: return FALSE; goto gv2y1; G5VJc: if (!($algo !== FALSE && $params !== FALSE)) { goto Uyp6D; } goto yIxpQ; rPTiX: $params = $this->_get_hash_parameters($identity); goto G5VJc; bewCZ: $algo = $this->_get_hash_algo(); goto rPTiX; NnPA6: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto yZdey; qQGRK: return FALSE; goto gJYjG; nGo3O: return password_verify($password, $hash_password_db); goto nrtfE; nrtfE: U0SnU: goto v3KWO; gJYjG: R6RvW: goto kdu1E; wdz4o: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto AMGXg; kdu1E: if (strpos($hash_password_db, "\44") === 0) { goto UzkOd; } goto wdz4o; slwDF: UzkOd: goto nGo3O; AMGXg: goto U0SnU; goto slwDF; yZdey: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto R6RvW; } goto qQGRK; v3KWO: } public function rehash_password_if_needed($hash, $identity, $password) { goto d58L5; tjdHK: jB6mM: goto jHhrT; mbk5C: ObBT5: goto tjdHK; s8BC2: goto tT_Rn; goto gjOkS; gjOkS: rLIwc: goto Rico5; y9n9b: tT_Rn: goto mbk5C; Rico5: $this->trigger_events(["\162\x65\x68\x61\163\x68\137\160\x61\163\163\x77\x6f\x72\x64", "\x72\145\150\141\163\x68\x5f\160\x61\163\163\167\x6f\162\x64\137\x73\x75\x63\x63\145\x73\x73\x66\165\154"]); goto y9n9b; ZpNTQ: if (!($algo !== FALSE && $params !== FALSE)) { goto jB6mM; } goto Q13_D; Q13_D: if (!password_needs_rehash($hash, $algo, $params)) { goto ObBT5; } goto I9Xdo; I9Xdo: if ($this->_set_password_db($identity, $password)) { goto rLIwc; } goto nhEvR; nhEvR: $this->trigger_events(["\162\x65\x68\x61\x73\150\x5f\160\141\x73\x73\167\157\162\x64", "\162\145\150\141\x73\150\x5f\x70\x61\x73\163\x77\x6f\x72\x64\x5f\165\x6e\x73\x75\x63\x63\145\x73\163\146\165\x6c"]); goto s8BC2; MC24G: $params = $this->_get_hash_parameters($identity); goto ZpNTQ; d58L5: $algo = $this->_get_hash_algo(); goto MC24G; jHhrT: } public function get_user_by_activation_code($user_code) { goto qICkl; hRIdB: if (!$user) { goto IPkEK; } goto XvrUO; qICkl: $token = $this->_retrieve_selector_validator_couple($user_code); goto Gufxk; XvrUO: if (!$this->verify_password($token->validator, $user->activation_code)) { goto jI3Tn; } goto Yv3Rl; Fd65m: jI3Tn: goto WCaVE; WCaVE: IPkEK: goto gyF7M; Gufxk: $user = $this->where("\141\143\x74\151\x76\141\164\x69\157\x6e\x5f\x73\x65\x6c\145\143\x74\x6f\x72", $token->selector)->users()->row(); goto hRIdB; gyF7M: return FALSE; goto F2AdM; Yv3Rl: return $user; goto Fd65m; F2AdM: } public function activate($id, $code = FALSE) { goto AaHIy; N4QRT: return FALSE; goto DFFLC; BbeW1: MezSl: goto MBINL; xpa_D: if (!($this->db->affected_rows() === 1)) { goto zjapV; } goto rYTSO; ii0iN: $data = ["\x61\143\164\151\x76\x61\x74\151\x6f\x6e\x5f\x73\145\x6c\x65\143\164\x6f\x72" => NULL, "\141\x63\x74\151\166\141\164\x69\157\156\137\x63\x6f\x64\145" => NULL, "\x61\143\164\x69\x76\x65" => 1]; goto X7lUl; rYTSO: $this->trigger_events(["\x70\157\x73\164\137\141\143\164\x69\166\141\164\145", "\x70\x6f\163\x74\137\141\x63\x74\x69\166\x61\x74\x65\137\163\165\143\x63\145\163\x73\x66\x75\x6c"]); goto vbC2A; MBINL: if (!($code === FALSE || $user && $user->id === $id)) { goto tdoOo; } goto ii0iN; Cmc_Z: tdoOo: goto kkwbi; eVuhg: $user = $this->get_user_by_activation_code($code); goto BbeW1; AaHIy: $this->trigger_events("\x70\x72\x65\x5f\x61\x63\x74\x69\x76\141\x74\x65"); goto XO9QA; kkwbi: $this->trigger_events(["\x70\x6f\x73\x74\137\x61\143\x74\151\166\141\164\x65", "\160\157\x73\x74\137\x61\143\x74\151\x76\x61\x74\x65\x5f\x75\156\163\x75\x63\143\145\163\x73\146\165\154"]); goto dRuhf; XO9QA: if (!($code !== FALSE)) { goto MezSl; } goto eVuhg; H3NpM: $this->db->update($this->tables["\165\x73\x65\x72\163"], $data, ["\151\x64" => $id]); goto xpa_D; vbC2A: $this->set_message("\141\x63\x74\x69\x76\141\x74\x65\x5f\x73\x75\143\143\x65\163\163\x66\165\x6c"); goto GQ69O; GQ69O: return TRUE; goto iJRo4; X7lUl: $this->trigger_events("\x65\x78\x74\162\141\137\x77\x68\145\162\145"); goto H3NpM; dRuhf: $this->set_error("\141\x63\x74\x69\166\141\164\145\137\165\156\163\x75\143\x63\x65\x73\x73\x66\x75\154"); goto N4QRT; iJRo4: zjapV: goto Cmc_Z; DFFLC: } public function deactivate($id = NULL) { goto xBsSV; DH12I: $this->activation_code = $token->user_code; goto hQRw6; a0Nn1: $this->set_error("\x64\x65\x61\143\x74\151\x76\141\164\x65\137\165\x6e\x73\165\x63\x63\145\x73\x73\146\165\x6c"); goto NDYMs; zNuVi: if (!isset($id)) { goto uYxJw; } goto wXPD_; IPXR1: $this->set_message("\144\x65\141\x63\164\x69\x76\141\164\x65\137\163\165\x63\143\145\163\163\146\x75\154"); goto TOBxT; w0POL: $this->db->update($this->tables["\165\x73\145\x72\163"], $data, ["\151\x64" => $id]); goto M8vtc; wXPD_: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto uVarL; } goto DP5R3; KCERz: goto kiaqV; goto y2YiS; M8vtc: $return = $this->db->affected_rows() == 1; goto gQaR5; hQRw6: $data = ["\141\x63\x74\151\166\141\164\151\x6f\x6e\137\x73\x65\x6c\145\x63\x74\x6f\162" => $token->selector, "\141\143\164\x69\x76\141\x74\x69\x6f\x6e\137\x63\157\x64\x65" => $token->validator_hashed, "\x61\x63\164\x69\x76\145" => 0]; goto XdTOq; ayEsS: lzIIR: goto IPXR1; kkkGi: uVarL: goto KCERz; djjfN: $this->set_error("\x64\145\141\143\164\151\166\141\164\145\x5f\x75\x6e\163\x75\143\x63\x65\x73\x73\x66\x75\x6c"); goto ZMx20; kPoQj: $token = $this->_generate_selector_validator_couple(20, 40); goto DH12I; NDYMs: goto f3Mkt; goto ayEsS; T0gCV: kiaqV: goto kPoQj; y2YiS: uYxJw: goto djjfN; MONuA: return $return; goto Uh2Hm; DP5R3: $this->set_error("\x64\x65\141\x63\164\x69\166\x61\164\145\137\x63\165\x72\x72\x65\x6e\164\137\165\x73\145\162\x5f\x75\x6e\x73\165\143\x63\x65\x73\163\x66\165\154"); goto e7buG; XdTOq: $this->trigger_events("\x65\170\x74\162\x61\137\167\150\x65\x72\x65"); goto w0POL; gQaR5: if ($return) { goto lzIIR; } goto a0Nn1; xBsSV: $this->trigger_events("\144\145\x61\x63\164\151\166\x61\x74\145"); goto zNuVi; TOBxT: f3Mkt: goto MONuA; ZMx20: return FALSE; goto T0gCV; e7buG: return FALSE; goto kkkGi; Uh2Hm: } public function clear_forgotten_password_code($identity) { goto JWhsC; vMP_8: return TRUE; goto RWWap; OBRZ9: return FALSE; goto NzZL7; JWhsC: if (!empty($identity)) { goto syniX; } goto OBRZ9; z7ldu: $data = ["\146\x6f\162\x67\x6f\x74\x74\x65\x6e\137\160\x61\x73\163\167\x6f\x72\x64\x5f\x73\x65\154\145\x63\164\x6f\162" => NULL, "\x66\x6f\162\x67\x6f\x74\x74\145\156\137\160\141\163\163\x77\157\x72\x64\x5f\x63\x6f\x64\145" => NULL, "\146\157\x72\147\157\x74\164\145\156\137\x70\x61\x73\163\x77\x6f\162\144\x5f\x74\151\155\x65" => NULL]; goto m8jRd; m8jRd: $this->db->update($this->tables["\x75\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto vMP_8; NzZL7: syniX: goto z7ldu; RWWap: } public function clear_remember_code($identity) { goto BST7Q; BST7Q: if (!empty($identity)) { goto YLPMq; } goto b6758; nFggJ: $this->db->update($this->tables["\165\163\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto yWl9l; gs0Zv: $data = ["\162\x65\x6d\x65\155\x62\x65\162\x5f\x73\x65\154\145\x63\x74\x6f\162" => NULL, "\162\x65\155\145\155\x62\x65\x72\x5f\143\x6f\x64\145" => NULL]; goto nFggJ; uqWfQ: YLPMq: goto gs0Zv; yWl9l: return TRUE; goto clC2J; b6758: return FALSE; goto uqWfQ; clC2J: } public function reset_password($identity, $new) { goto lpssD; LvoHA: FktdL: goto y9WM8; tkBh6: $this->trigger_events(["\x70\x6f\163\164\x5f\143\150\x61\x6e\x67\145\137\160\x61\163\x73\167\x6f\x72\x64", "\160\157\x73\x74\137\143\150\x61\156\147\145\137\x70\141\163\x73\x77\x6f\162\144\x5f\x75\156\163\x75\143\x63\145\x73\x73\x66\165\x6c"]); goto mGNQy; qMZRj: goto Gb4I2; goto LvoHA; z4NwO: if ($return) { goto FktdL; } goto tkBh6; QJWgS: return $return; goto lMash; GqVvn: Gb4I2: goto QJWgS; y9WM8: $this->trigger_events(["\160\157\x73\164\x5f\143\150\141\x6e\147\x65\137\160\x61\x73\x73\167\x6f\x72\x64", "\x70\157\x73\x74\137\143\x68\x61\x6e\x67\145\137\x70\141\163\163\167\157\162\144\137\x73\x75\143\143\x65\x73\163\146\x75\154"]); goto py1bS; uXWJm: $this->trigger_events(["\160\x6f\163\164\x5f\x63\150\141\x6e\x67\145\x5f\x70\x61\x73\163\167\x6f\162\x64", "\x70\157\x73\164\137\x63\150\x61\156\x67\x65\x5f\x70\141\163\163\x77\157\162\x64\x5f\x75\x6e\163\165\143\143\x65\163\x73\146\165\154"]); goto v332F; lpssD: $this->trigger_events("\160\162\x65\x5f\x63\150\x61\x6e\x67\x65\137\160\x61\x73\163\167\157\x72\x64"); goto SEq0S; SEq0S: if ($this->identity_check($identity)) { goto NSUgE; } goto uXWJm; py1bS: $this->set_message("\x70\141\x73\163\x77\157\162\x64\x5f\143\150\x61\156\x67\145\137\x73\x75\x63\x63\x65\x73\163\x66\165\154"); goto GqVvn; MHjik: NSUgE: goto KJesr; v332F: return FALSE; goto MHjik; KJesr: $return = $this->_set_password_db($identity, $new); goto z4NwO; mGNQy: $this->set_error("\160\141\163\163\x77\157\162\144\137\x63\150\141\x6e\147\145\137\165\156\x73\x75\x63\143\145\x73\163\x66\165\154"); goto qMZRj; lMash: } public function change_password($identity, $old, $new) { goto pdv_t; QC4BG: i3BUo: goto ENYtC; LEIRl: return FALSE; goto QC4BG; Gxjpj: $query = $this->db->select("\x69\x64\54\x20\x70\x61\163\163\x77\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\x65\163\x63")->get($this->tables["\165\x73\145\x72\163"]); goto dEEm5; yTc9k: $this->trigger_events("\x65\170\x74\162\141\x5f\167\150\145\162\x65"); goto Gxjpj; Sq06Q: $this->set_error("\x70\x61\x73\x73\x77\157\x72\144\137\x63\x68\141\x6e\x67\x65\x5f\x75\x6e\x73\x75\x63\143\145\163\163\146\x75\x6c"); goto fU47Y; BVQ85: $this->set_error("\160\x61\x73\163\167\157\162\x64\x5f\143\150\141\x6e\147\145\x5f\165\x6e\163\165\143\x63\145\x73\163\146\165\x6c"); goto LEIRl; oTR8V: if (!$this->verify_password($old, $user->password, $identity)) { goto G7mMh; } goto JWrka; bmjsJ: return $result; goto qgl2o; Cf1vS: $this->set_error("\x70\x61\163\x73\167\157\162\x64\137\x63\x68\x61\x6e\147\x65\137\x75\156\x73\x75\143\143\145\x73\163\x66\x75\x6c"); goto gQgA9; j1Bp_: B00BH: goto B93x0; JWrka: $result = $this->_set_password_db($identity, $new); goto WHDWO; gZ97a: $this->set_message("\160\141\x73\163\167\x6f\x72\144\x5f\x63\x68\x61\156\x67\x65\x5f\x73\165\x63\143\145\x73\163\146\165\x6c"); goto jlwLd; gQgA9: goto FAcQy; goto j1Bp_; ENYtC: $user = $query->row(); goto oTR8V; jlwLd: FAcQy: goto bmjsJ; pdv_t: $this->trigger_events("\160\162\x65\137\143\150\141\x6e\x67\145\x5f\x70\141\163\163\x77\157\162\144"); goto yTc9k; dEEm5: if (!($query->num_rows() !== 1)) { goto i3BUo; } goto LNLkD; WHDWO: if ($result) { goto B00BH; } goto uPAp1; qgl2o: G7mMh: goto Sq06Q; LNLkD: $this->trigger_events(["\160\157\x73\x74\137\x63\x68\x61\156\x67\x65\137\160\141\163\x73\x77\x6f\x72\144", "\x70\x6f\163\164\137\143\150\x61\156\147\x65\x5f\160\x61\163\x73\167\157\x72\144\137\165\x6e\163\x75\x63\x63\x65\163\163\x66\x75\154"]); goto BVQ85; uPAp1: $this->trigger_events(["\160\157\163\164\x5f\143\150\141\156\147\x65\x5f\x70\x61\x73\163\x77\x6f\x72\144", "\160\157\163\164\x5f\x63\150\x61\156\x67\x65\137\x70\141\163\x73\x77\157\x72\x64\x5f\165\x6e\163\165\x63\143\x65\x73\163\146\x75\x6c"]); goto Cf1vS; B93x0: $this->trigger_events(["\160\x6f\163\164\x5f\x63\x68\141\x6e\x67\x65\137\x70\141\x73\163\x77\157\x72\144", "\x70\157\163\x74\x5f\x63\150\x61\x6e\147\x65\137\x70\141\x73\163\x77\x6f\162\144\x5f\163\165\x63\143\x65\x73\x73\146\165\154"]); goto gZ97a; fU47Y: return FALSE; goto Moctl; Moctl: } public function username_check($username = '') { goto jTH3V; f1G0B: return $this->db->where("\165\x73\145\x72\x6e\141\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\x75\x73\x65\162\163"]) > 0; goto eDvb1; wzgF9: return FALSE; goto crplp; jTH3V: $this->trigger_events("\x75\163\x65\x72\x6e\141\155\145\x5f\143\150\x65\143\153"); goto GQUqQ; iEF71: $this->trigger_events("\145\170\x74\162\141\137\167\x68\x65\162\145"); goto f1G0B; crplp: ohRVe: goto iEF71; GQUqQ: if (!empty($username)) { goto ohRVe; } goto wzgF9; eDvb1: } public function email_check($email = '') { goto lxOF1; ARGOL: YLEAm: goto PNXuT; PHtKd: return $this->db->where("\x65\x6d\141\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\x73"]) > 0; goto FzFZh; lxOF1: $this->trigger_events("\145\x6d\141\x69\x6c\x5f\x63\x68\145\x63\x6b"); goto qzq8S; PNXuT: $this->trigger_events("\x65\170\x74\162\141\137\x77\150\145\162\145"); goto PHtKd; qzq8S: if (!empty($email)) { goto YLEAm; } goto IRbfs; IRbfs: return FALSE; goto ARGOL; FzFZh: } public function identity_check($identity = '') { goto KLya9; LRW11: return FALSE; goto Q7AKb; Q7AKb: f5_hS: goto AkdAI; AkdAI: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\145\162\x73"]) > 0; goto CWWws; CGMeL: if (!empty($identity)) { goto f5_hS; } goto LRW11; KLya9: $this->trigger_events("\x69\144\x65\x6e\x74\151\x74\x79\137\x63\x68\145\143\x6b"); goto CGMeL; CWWws: } public function get_user_id_from_identity($identity = '') { goto IkkDZ; S6Saq: $user = $query->row(); goto Fv6ma; TlsLB: if (!($query->num_rows() !== 1)) { goto QZxqt; } goto uEI0C; uEI0C: return FALSE; goto HDFmW; Fv6ma: return $user->id; goto s351Y; HDFmW: QZxqt: goto S6Saq; IkkDZ: if (!empty($identity)) { goto y4UpA; } goto vywFI; vywFI: return FALSE; goto NCIxY; X09my: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\x73"]); goto TlsLB; NCIxY: y4UpA: goto X09my; s351Y: } public function forgotten_password($identity) { goto C7WCn; e_BHS: goto uYOKJ; goto zy4ZP; DQK6U: return FALSE; goto e_BHS; TJAHU: $update = ["\x66\x6f\x72\x67\157\x74\x74\145\x6e\137\x70\x61\163\x73\167\157\x72\144\x5f\163\x65\154\145\x63\164\157\x72" => $token->selector, "\x66\x6f\x72\147\x6f\164\x74\x65\x6e\x5f\x70\x61\163\163\167\157\x72\x64\137\143\x6f\x64\145" => $token->validator_hashed, "\x66\157\x72\147\x6f\164\x74\145\x6e\x5f\160\x61\x73\163\167\157\x72\144\137\x74\151\x6d\145" => time()]; goto HgbHX; pTAMa: $this->trigger_events(["\x70\x6f\x73\164\137\146\x6f\162\147\157\164\x74\145\156\137\160\x61\163\163\167\x6f\162\144", "\x70\157\x73\x74\137\146\157\x72\x67\157\164\164\x65\156\x5f\160\x61\163\163\167\x6f\x72\x64\x5f\x75\x6e\163\165\143\x63\145\163\163\146\165\x6c"]); goto TYHNf; zy4ZP: G2rIz: goto yDk7S; kQQrY: if ($this->db->affected_rows() === 1) { goto G2rIz; } goto D7iWC; rIYma: $token = $this->_generate_selector_validator_couple(20, 80); goto TJAHU; TYHNf: return FALSE; goto S9nXN; HgbHX: $this->trigger_events("\x65\170\x74\x72\x61\137\167\x68\x65\x72\145"); goto CI1b7; CI1b7: $this->db->update($this->tables["\165\163\x65\x72\x73"], $update, [$this->identity_column => $identity]); goto kQQrY; D7iWC: $this->trigger_events(["\x70\x6f\163\x74\x5f\x66\157\162\147\x6f\x74\x74\x65\x6e\x5f\160\141\163\x73\x77\157\x72\x64", "\x70\x6f\163\x74\x5f\146\x6f\x72\x67\x6f\164\164\x65\x6e\x5f\160\141\x73\163\x77\x6f\x72\x64\137\165\x6e\163\x75\x63\143\x65\163\163\146\165\x6c"]); goto DQK6U; C7WCn: if (!empty($identity)) { goto PHXBz; } goto pTAMa; s4e06: return $token->user_code; goto yRmpx; S9nXN: PHXBz: goto rIYma; yRmpx: uYOKJ: goto HoSjv; yDk7S: $this->trigger_events(["\160\x6f\163\x74\x5f\x66\157\x72\147\157\x74\x74\x65\x6e\x5f\160\141\x73\163\x77\157\162\x64", "\160\157\163\164\137\x66\157\162\x67\157\164\x74\x65\156\x5f\160\141\163\x73\167\x6f\x72\144\137\163\165\x63\x63\145\163\163\x66\165\154"]); goto s4e06; HoSjv: } public function get_user_by_forgotten_password_code($user_code) { goto ap6gy; uPT8e: $user = $this->where("\x66\x6f\x72\147\x6f\164\164\x65\x6e\x5f\x70\141\x73\x73\x77\157\162\x64\x5f\163\145\x6c\145\143\x74\157\162", $token->selector)->users()->row(); goto H0MYZ; wpyUP: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto h6STp; } goto K_gj9; KKFSR: return FALSE; goto lZ5ea; K_gj9: return $user; goto QcNqW; QcNqW: h6STp: goto gf72T; gf72T: vxMki: goto KKFSR; ap6gy: $token = $this->_retrieve_selector_validator_couple($user_code); goto uPT8e; H0MYZ: if (!$user) { goto vxMki; } goto wpyUP; lZ5ea: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto bmc0y; PepWi: return FALSE; goto Rs0lG; Rs0lG: l_zsd: goto se_rg; hfx6f: if (!(isset($default_group->id) && empty($groups))) { goto vChzF; } goto DPm7G; awA7d: YFqzu: goto g_Zb3; q51JZ: if (empty($groups)) { goto YFqzu; } goto D1khC; VMLCs: return FALSE; goto Lhuzx; SZTEX: yebVt: goto ctRZZ; JVPK2: mA6LZ: goto d74t3; OIp59: return isset($id) ? $id : FALSE; goto RISxz; Lhuzx: kN3ta: goto pyNmL; osrbV: if ($this->identity_check($identity)) { goto yebVt; } goto VxoaW; Yxeve: $data = [$this->identity_column => $identity, "\165\163\145\162\156\141\x6d\145" => $identity, "\160\x61\x73\x73\x77\157\162\x64" => $password, "\145\x6d\141\151\154" => $email, "\x69\x70\x5f\141\144\144\162\145\163\x73" => $ip_address, "\143\x72\x65\141\164\x65\x64\137\x6f\156" => time(), "\141\x63\x74\x69\166\145" => $manual_activation === FALSE ? 1 : 0]; goto XMaNW; g_Zb3: $this->trigger_events("\160\157\x73\x74\137\162\x65\x67\x69\x73\x74\145\x72"); goto OIp59; oRjrA: $ip_address = $this->input->ip_address(); goto wPx7F; xx9SO: return FALSE; goto I4mL7; awkpn: $this->set_error("\141\143\143\157\x75\x6e\164\137\x63\x72\x65\141\x74\x69\x6f\x6e\137\x75\x6e\163\x75\x63\143\x65\x73\x73\146\x75\154"); goto xx9SO; ctRZZ: $this->set_error("\141\x63\x63\157\165\x6e\164\137\x63\162\145\141\164\x69\157\156\x5f\144\x75\x70\x6c\151\x63\x61\x74\145\137\151\x64\x65\156\x74\151\164\171"); goto VMLCs; bmc0y: $this->trigger_events("\x70\x72\145\x5f\162\x65\x67\x69\x73\164\x65\162"); goto JRDZY; nKykB: vChzF: goto q51JZ; VxoaW: if (!(!$this->config->item("\144\145\x66\x61\x75\154\164\137\x67\162\x6f\x75\x70", "\x69\x6f\156\x5f\x61\165\164\150") && empty($groups))) { goto mA6LZ; } goto wYdWS; RFsEU: if (!(!isset($query->id) && empty($groups))) { goto l_zsd; } goto LVh2I; XMaNW: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\145\162\x73"], $additional_data), $data); goto Prhzh; Prhzh: $this->trigger_events("\145\x78\x74\x72\141\x5f\163\145\x74"); goto Ty4Lu; DPm7G: $groups[] = $default_group->id; goto nKykB; wPx7F: $password = $this->hash_password($password); goto VQmpb; NCS7w: return FALSE; goto JVPK2; wYdWS: $this->set_error("\x61\x63\x63\x6f\x75\156\164\137\x63\x72\x65\141\164\x69\x6f\x6e\137\x6d\151\163\163\x69\x6e\x67\137\x64\x65\x66\141\165\x6c\164\x5f\x67\x72\x6f\x75\x70"); goto NCS7w; zu_5m: vHYsf: goto awA7d; pyNmL: $query = $this->db->get_where($this->tables["\x67\x72\x6f\165\160\x73"], ["\x6e\141\155\x65" => $this->config->item("\144\x65\146\x61\x75\154\x74\137\147\162\157\165\160", "\151\157\x6e\137\x61\165\164\x68")], 1)->row(); goto RFsEU; vO2CA: $id = $this->db->insert_id($this->tables["\x75\163\145\x72\163"] . "\137\151\144\137\x73\x65\161"); goto hfx6f; Ty4Lu: $this->db->insert($this->tables["\165\163\145\x72\x73"], $user_data); goto vO2CA; I4mL7: aQ4My: goto Yxeve; D1khC: foreach ($groups as $group) { $this->add_to_group($group, $id); qiOPx: } goto zu_5m; se_rg: $default_group = $query; goto oRjrA; d74t3: goto kN3ta; goto SZTEX; LVh2I: $this->set_error("\x61\x63\143\x6f\165\x6e\164\137\x63\162\145\141\x74\x69\x6f\x6e\137\x69\x6e\x76\141\154\151\144\x5f\144\145\146\x61\165\154\x74\x5f\147\x72\157\165\160"); goto PepWi; VQmpb: if (!($password === FALSE)) { goto aQ4My; } goto awkpn; JRDZY: $manual_activation = $this->config->item("\x6d\141\156\165\x61\x6c\137\x61\143\x74\151\166\x61\x74\151\157\156", "\151\x6f\x6e\137\x61\x75\x74\150"); goto osrbV; RISxz: } public function login($identity, $password, $remember = FALSE) { goto Fjjf6; YdfAF: if (!$this->verify_password($password, $user->password, $identity)) { goto HvPJg; } goto Fl_ic; o3epz: goto LrYJe; goto BQFWo; jguOv: $this->trigger_events("\x70\157\x73\x74\x5f\154\x6f\147\151\156\137\x75\156\163\x75\x63\x63\x65\163\x73\x66\165\154"); goto bL8X1; A9FJD: $this->update_last_login($user->id); goto CmAe9; lSLOM: $this->increase_login_attempts($identity); goto vQe_d; ecsuv: iMcgy: goto dDnV5; vQe_d: $this->trigger_events("\x70\x6f\x73\x74\137\x6c\157\147\151\x6e\137\x75\156\163\x75\x63\x63\145\x73\163\x66\x75\154"); goto a9W7t; Y7DEq: return FALSE; goto ecsuv; l5bbD: C8DHF: goto cTaht; zqZ5p: return FALSE; goto f4V8n; Q9Rh6: $this->hash_password($password); goto IFVOu; BTXCi: $user = $query->row(); goto YdfAF; kEDW7: $this->set_message("\154\x6f\147\151\x6e\x5f\163\165\143\143\x65\163\163\x66\x75\154"); goto OaDYK; cTaht: $this->trigger_events("\145\170\164\x72\141\137\x77\x68\145\162\x65"); goto XTs28; bEawm: QWVRj: goto TToP6; Fl_ic: if (!($user->active == 0)) { goto iMcgy; } goto jguOv; Ui9jM: $this->rehash_password_if_needed($user->password, $identity, $password); goto eokjl; j9aOF: if (!$this->config->item("\x72\x65\155\145\x6d\x62\x65\162\x5f\165\x73\145\x72\163", "\x69\x6f\156\137\x61\165\164\x68")) { goto P3uc_; } goto RV1v0; sPTIF: P3uc_: goto Ui9jM; XfpvE: $this->remember_user($identity); goto DZumy; Ogn4N: $this->clear_forgotten_password_code($identity); goto j9aOF; OaDYK: return TRUE; goto dWVYZ; RDdX8: $this->clear_remember_code($identity); goto o3epz; Fjjf6: $this->trigger_events("\160\162\145\x5f\154\157\x67\151\x6e"); goto ApbIv; ApbIv: if (!(empty($identity) || empty($password))) { goto C8DHF; } goto CrcE4; BQFWo: SA6_D: goto XfpvE; i5n5I: if (!$this->is_max_login_attempts_exceeded($identity)) { goto YYldH; } goto Q9Rh6; eokjl: $this->session->sess_regenerate(FALSE); goto Pq7fb; f4V8n: YYldH: goto NhdHw; DZumy: LrYJe: goto sPTIF; XTs28: $query = $this->db->select($this->identity_column . "\x2c\40\145\155\141\x69\x6c\54\x20\x69\x64\x2c\40\160\141\x73\x73\x77\157\162\144\x2c\x20\141\143\x74\151\x76\145\54\x20\x6c\141\163\164\137\x6c\157\147\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\x73\143")->get($this->tables["\165\x73\x65\x72\x73"]); goto i5n5I; a9W7t: $this->set_error("\154\157\147\151\x6e\x5f\x75\156\163\x75\143\143\145\163\x73\x66\x75\x6c"); goto RGCtd; IFVOu: $this->trigger_events("\160\x6f\163\x74\x5f\x6c\x6f\x67\x69\x6e\137\165\156\x73\x75\x63\x63\x65\163\x73\146\x75\x6c"); goto ugCVN; CmAe9: $this->clear_login_attempts($identity); goto Ogn4N; TToP6: $this->hash_password($password); goto lSLOM; RGCtd: return FALSE; goto alQxl; oJubG: return FALSE; goto l5bbD; CrcE4: $this->set_error("\x6c\157\x67\x69\156\x5f\165\156\x73\x75\143\x63\x65\163\163\146\x75\x6c"); goto oJubG; NhdHw: if (!($query->num_rows() === 1)) { goto QWVRj; } goto BTXCi; dWVYZ: HvPJg: goto bEawm; Pq7fb: $this->trigger_events(["\x70\157\163\164\137\x6c\157\147\x69\x6e", "\x70\x6f\x73\x74\137\x6c\x6f\x67\x69\x6e\137\x73\165\143\x63\x65\x73\163\x66\x75\x6c"]); goto kEDW7; bL8X1: $this->set_error("\x6c\157\147\151\x6e\137\165\x6e\x73\165\x63\x63\145\x73\x73\146\165\x6c\x5f\156\157\x74\x5f\x61\143\x74\x69\x76\145"); goto Y7DEq; RV1v0: if ($remember) { goto SA6_D; } goto RDdX8; dDnV5: $this->set_session($user); goto A9FJD; ugCVN: $this->set_error("\154\157\147\x69\156\x5f\164\x69\155\145\x6f\x75\164"); goto zqZ5p; alQxl: } public function recheck_session() { goto swP78; RS2WN: if (!($recheck !== 0)) { goto ukjd6; } goto eNK0h; JgepU: goto A0uow; goto B72BH; JNa_q: ukjd6: goto nQt5p; eNK0h: $last_login = $this->session->userdata("\x6c\141\163\x74\137\x63\x68\145\143\153"); goto DbfL6; OjbeA: ZnvT7: goto JNa_q; DbfL6: if (!($last_login + $recheck < time())) { goto ZnvT7; } goto fDmt2; c8Anp: A0uow: goto OjbeA; d2FrP: if ($query->num_rows() === 1) { goto ea9OV; } goto m5dBZ; m5dBZ: $this->trigger_events("\154\x6f\x67\x6f\x75\164"); goto EFAxx; bJ3m_: $this->session->set_userdata("\154\141\x73\x74\x5f\143\x68\145\143\x6b", time()); goto c8Anp; swP78: $recheck = NULL !== $this->config->item("\162\x65\x63\150\145\143\x6b\x5f\164\x69\155\x65\162", "\151\x6f\156\x5f\141\x75\x74\150") ? $this->config->item("\x72\145\143\x68\x65\143\x6b\x5f\164\x69\x6d\145\162", "\x69\x6f\x6e\137\141\x75\164\x68") : 0; goto RS2WN; gqiYM: return FALSE; goto JgepU; EFAxx: $identity = $this->config->item("\x69\144\x65\156\164\x69\164\171", "\151\157\x6e\x5f\x61\165\x74\150"); goto YX1kH; nQt5p: return (bool) $this->session->userdata("\x69\144\x65\156\x74\x69\x74\x79"); goto ZHP8P; B72BH: ea9OV: goto bJ3m_; fDmt2: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\x64\x65\x6e\x74\x69\x74\171"), "\141\x63\164\x69\x76\145" => "\x31"])->limit(1)->order_by("\x69\144", "\144\145\163\x63")->get($this->tables["\165\163\145\162\x73"]); goto d2FrP; YX1kH: $this->session->unset_userdata([$identity, "\x69\144", "\165\163\x65\162\x5f\x69\144"]); goto gqiYM; ZHP8P: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto QZSsA; QZSsA: if (!$this->config->item("\x74\162\141\143\x6b\x5f\x6c\157\147\151\x6e\x5f\x61\x74\164\145\x6d\x70\x74\163", "\x69\157\x6e\137\x61\165\x74\x68")) { goto fh2X4; } goto yhXWO; Z7Y0e: return $attempts >= $max_attempts; goto arhLV; yhXWO: $max_attempts = $this->config->item("\155\141\170\x69\155\165\x6d\x5f\154\x6f\147\x69\x6e\137\x61\164\x74\x65\x6d\x70\164\x73", "\151\x6f\156\x5f\141\x75\x74\x68"); goto IpduR; i8r7v: $attempts = $this->get_attempts_num($identity, $ip_address); goto Z7Y0e; PI9HZ: fh2X4: goto j0mxC; IpduR: if (!($max_attempts > 0)) { goto dFENA; } goto i8r7v; j0mxC: return FALSE; goto OsjTq; arhLV: dFENA: goto PI9HZ; OsjTq: } public function get_attempts_num($identity, $ip_address = NULL) { goto oUSTT; Lhtrb: $this->db->where("\x6c\x6f\x67\151\x6e", $identity); goto ZsfQn; MNB_x: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\x6e\x5f\141\x74\164\145\x6d\x70\x74\x73"]); goto KRG6I; PAAH0: MPB6w: goto Z2L5i; Z2L5i: return 0; goto vS6K_; f9lRQ: $ip_address = $this->input->ip_address(); goto H2NY4; ZsfQn: if (!$this->config->item("\164\x72\x61\143\x6b\137\154\x6f\x67\151\156\137\151\x70\137\141\144\x64\x72\145\163\163", "\x69\157\156\x5f\x61\165\x74\150")) { goto lYRuX; } goto nxzfA; LNxql: $this->db->select("\x31", FALSE); goto Lhtrb; jOkEr: lYRuX: goto fPnSP; oUSTT: if (!$this->config->item("\x74\x72\141\143\x6b\137\154\x6f\147\x69\156\x5f\x61\164\x74\x65\x6d\160\164\x73", "\151\157\156\137\x61\x75\164\150")) { goto MPB6w; } goto LNxql; H2NY4: w_hsZ: goto m92Ze; KRG6I: return $qres->num_rows(); goto PAAH0; nxzfA: if (isset($ip_address)) { goto w_hsZ; } goto f9lRQ; fPnSP: $this->db->where("\x74\151\155\145\40\76", time() - $this->config->item("\x6c\x6f\143\153\x6f\165\x74\137\x74\151\155\145", "\x69\157\156\137\x61\165\164\150"), FALSE); goto MNB_x; m92Ze: $this->db->where("\x69\160\x5f\141\x64\x64\162\x65\x73\x73", $ip_address); goto jOkEr; vS6K_: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto ph7QB; W8fRW: return $qres->row()->time; goto Wm2ec; Mm1RH: $this->db->where("\x69\160\137\x61\x64\144\162\145\x73\163", $ip_address); goto jK1Z9; vLIZE: $this->db->select("\164\151\155\145"); goto cnksj; WS2NS: SVQ5k: goto Mm1RH; Cgo05: if (!$this->config->item("\164\162\141\x63\x6b\137\154\157\147\151\156\x5f\x69\x70\x5f\141\144\144\x72\145\x73\x73", "\151\157\x6e\137\x61\165\x74\x68")) { goto oiEqe; } goto uiSFV; H9OLE: if (!($qres->num_rows() > 0)) { goto Rha5f; } goto W8fRW; WGmxw: $qres = $this->db->get($this->tables["\154\157\x67\151\x6e\137\141\164\x74\x65\x6d\160\164\163"], 1); goto H9OLE; uiSFV: if (isset($ip_address)) { goto SVQ5k; } goto cIUMw; jK1Z9: oiEqe: goto b0jU8; b0jU8: $this->db->order_by("\x69\144", "\144\x65\163\143"); goto WGmxw; cIUMw: $ip_address = $this->input->ip_address(); goto WS2NS; ph7QB: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\x6c\x6f\x67\151\x6e\137\141\x74\x74\x65\x6d\x70\x74\163", "\151\x6f\156\x5f\x61\x75\x74\150")) { goto CZ6eU; } goto vLIZE; URkCs: return 0; goto Mxtsa; cnksj: $this->db->where("\x6c\157\x67\x69\156", $identity); goto Cgo05; Wm2ec: Rha5f: goto d3DHR; d3DHR: CZ6eU: goto URkCs; Mxtsa: } public function get_last_attempt_ip($identity) { goto KOvyo; Us8us: u_vA0: goto LYhev; MSQaW: $this->db->select("\x69\x70\137\x61\144\144\162\x65\163\163"); goto njWPQ; XZ5dt: return ''; goto Hcyjx; LYhev: Ju1DH: goto XZ5dt; idh1W: $this->db->order_by("\151\x64", "\144\145\163\x63"); goto a8_LR; njWPQ: $this->db->where("\154\x6f\x67\151\x6e", $identity); goto idh1W; a8_LR: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\156\x5f\x61\164\x74\x65\x6d\x70\x74\x73"], 1); goto A1gGT; KOvyo: if (!($this->config->item("\x74\162\141\x63\x6b\x5f\154\157\x67\151\x6e\137\141\x74\x74\x65\155\160\x74\x73", "\151\157\x6e\137\141\x75\x74\150") && $this->config->item("\164\x72\x61\x63\153\137\x6c\x6f\147\x69\156\x5f\x69\160\137\141\x64\144\162\145\x73\163", "\151\x6f\156\137\141\165\x74\150"))) { goto Ju1DH; } goto MSQaW; wtNQk: return $qres->row()->ip_address; goto Us8us; A1gGT: if (!($qres->num_rows() > 0)) { goto u_vA0; } goto wtNQk; Hcyjx: } public function increase_login_attempts($identity) { goto kf7qk; kf7qk: if (!$this->config->item("\164\x72\141\x63\153\x5f\154\x6f\147\151\x6e\137\x61\x74\164\x65\155\160\x74\163", "\x69\x6f\x6e\137\x61\165\164\150")) { goto kC1fz; } goto SvLd_; bSgTd: kC1fz: goto ZK3No; t6iAh: pI6xo: goto DZHEH; ZK3No: return FALSE; goto RsUxa; SvLd_: $data = ["\151\x70\x5f\x61\x64\144\x72\145\x73\163" => '', "\154\x6f\147\x69\156" => $identity, "\164\x69\x6d\x65" => time()]; goto IrF4A; BGeBD: $data["\151\x70\137\x61\144\x64\x72\x65\x73\163"] = $this->input->ip_address(); goto t6iAh; DZHEH: return $this->db->insert($this->tables["\154\x6f\147\x69\156\137\x61\x74\x74\145\x6d\160\164\x73"], $data); goto bSgTd; IrF4A: if (!$this->config->item("\164\162\141\143\153\137\154\x6f\x67\151\156\137\x69\x70\137\x61\x64\144\162\x65\x73\163", "\x69\x6f\156\x5f\141\x75\x74\150")) { goto pI6xo; } goto BGeBD; RsUxa: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto l4jy3; PBLKO: $ip_address = $this->input->ip_address(); goto xqrbj; gbV71: $this->db->where("\x6c\157\147\151\156", $identity); goto vVcWg; l4jy3: if (!$this->config->item("\x74\162\141\x63\x6b\x5f\x6c\157\147\x69\156\x5f\141\164\x74\145\155\x70\x74\x73", "\x69\x6f\156\137\141\x75\x74\x68")) { goto Ht7_b; } goto Ah4g5; vVcWg: if (!$this->config->item("\x74\162\x61\x63\153\137\x6c\x6f\x67\151\x6e\137\x69\x70\137\141\x64\144\x72\x65\163\163", "\151\157\156\137\x61\165\x74\x68")) { goto Hf5ch; } goto pHs4T; xqrbj: iHwps: goto ewxs9; qIRWZ: return $this->db->delete($this->tables["\154\157\x67\x69\156\x5f\141\164\164\x65\155\x70\164\163"]); goto Xaz2v; McWEB: return FALSE; goto DVQdD; ewxs9: $this->db->where("\151\x70\x5f\x61\144\144\162\x65\x73\163", $ip_address); goto onX1O; dUa1I: $this->db->or_where("\164\151\x6d\x65\x20\74", time() - $old_attempts_expire_period, FALSE); goto qIRWZ; onX1O: Hf5ch: goto dUa1I; Xaz2v: Ht7_b: goto McWEB; pHs4T: if (isset($ip_address)) { goto iHwps; } goto PBLKO; Ah4g5: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\143\153\x6f\x75\x74\x5f\164\x69\x6d\145", "\x69\x6f\156\x5f\x61\x75\164\150")); goto gbV71; DVQdD: } public function limit($limit) { goto NXGI5; d3U7X: return $this; goto owBke; vUjqe: $this->_ion_limit = $limit; goto d3U7X; NXGI5: $this->trigger_events("\x6c\151\155\151\164"); goto vUjqe; owBke: } public function offset($offset) { goto KgW25; G1Yp7: return $this; goto t72wk; kLnXj: $this->_ion_offset = $offset; goto G1Yp7; KgW25: $this->trigger_events("\x6f\x66\146\163\145\164"); goto kLnXj; t72wk: } public function where($where, $value = NULL) { goto Xaw4r; wLT1Y: $where = [$where => $value]; goto BhZr3; lSQjH: return $this; goto s56yS; Xaw4r: $this->trigger_events("\x77\150\145\x72\145"); goto wJbYT; PKgua: array_push($this->_ion_where, $where); goto lSQjH; BhZr3: n9JSA: goto PKgua; wJbYT: if (is_array($where)) { goto n9JSA; } goto wLT1Y; s56yS: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\x68") { goto HLgpM; l0tZe: array_push($this->_ion_like, ["\154\151\153\145" => $like, "\166\x61\x6c\165\145" => $value, "\160\157\163\x69\x74\x69\x6f\x6e" => $position]); goto ILgsn; ILgsn: return $this; goto CXxkF; HLgpM: $this->trigger_events("\154\x69\x6b\x65"); goto l0tZe; CXxkF: } public function select($select) { goto wfSbp; wfSbp: $this->trigger_events("\163\145\154\x65\143\x74"); goto QSIW8; QSIW8: $this->_ion_select[] = $select; goto WKzC4; WKzC4: return $this; goto VQ7dP; VQ7dP: } public function order_by($by, $order = "\x64\145\163\143") { goto cQPc6; lKuAZ: $this->_ion_order = $order; goto tBxr2; tBxr2: return $this; goto YK4z5; cQPc6: $this->trigger_events("\157\162\x64\145\162\x5f\x62\x79"); goto jZ6sZ; jZ6sZ: $this->_ion_order_by = $by; goto lKuAZ; YK4z5: } public function row() { goto KkmIW; cSKcx: $row = $this->response->row(); goto nJAZX; KkmIW: $this->trigger_events("\162\157\167"); goto cSKcx; nJAZX: return $row; goto DUF04; DUF04: } public function row_array() { goto C4xGy; aklTG: $row = $this->response->row_array(); goto dgBa2; dgBa2: return $row; goto DRveN; C4xGy: $this->trigger_events(["\x72\157\167", "\x72\x6f\x77\137\141\x72\x72\141\x79"]); goto aklTG; DRveN: } public function result() { goto ujlhI; ujlhI: $this->trigger_events("\x72\x65\x73\165\x6c\164"); goto lr4RG; DZA5T: return $result; goto n209r; lr4RG: $result = $this->response->result(); goto DZA5T; n209r: } public function result_array() { goto zBK3p; fxYwg: $result = $this->response->result_array(); goto n3W_B; n3W_B: return $result; goto KqqF5; zBK3p: $this->trigger_events(["\162\145\163\x75\154\164", "\162\145\163\x75\154\x74\137\x61\x72\x72\141\171"]); goto fxYwg; KqqF5: } public function num_rows() { goto YiTv9; DlR0u: return $result; goto W0XnB; YiTv9: $this->trigger_events(["\x6e\x75\155\137\x72\x6f\x77\163"]); goto lF1y2; lF1y2: $result = $this->response->num_rows(); goto DlR0u; W0XnB: } public function users($groups = NULL) { goto cfMiJ; QHZfs: PmKgI: goto xlHRQ; QnsxM: goto eltkL; goto SEjB5; gnI9P: $this->_ion_offset = NULL; goto rglui; v2dn0: d58Dx: goto cFDmd; mgMx9: $this->db->join($this->tables["\x75\163\145\x72\163\x5f\147\162\x6f\x75\160\163"], $this->tables["\165\x73\145\x72\x73\x5f\x67\162\x6f\x75\x70\163"] . "\56" . $this->join["\x75\x73\x65\162\163"] . "\x3d" . $this->tables["\165\163\145\x72\x73"] . "\56\151\144", "\x69\x6e\x6e\x65\x72"); goto OjKyV; SF1bD: if (is_array($groups)) { goto c_Jkp; } goto onYdr; mM0PJ: $this->trigger_events("\145\x78\164\x72\x61\137\x77\x68\x65\x72\x65"); goto cjuM8; VCoUV: $this->db->{$or_where_in}($this->tables["\165\163\145\162\163\x5f\147\x72\x6f\x75\x70\163"] . "\x2e" . $this->join["\x67\x72\157\165\160\x73"], $group_ids); goto qHnXv; rl79O: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\137\167\150\x65\x72\145\137\x69\x6e" : "\x77\150\145\x72\x65\x5f\x69\x6e"; goto TEbZQ; onYdr: $groups = [$groups]; goto LFRca; YUeM4: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto ZgWlt; } goto WkPc0; xr8Kq: $this->db->join($this->tables["\x67\162\157\x75\160\x73"], $this->tables["\x75\163\x65\x72\x73\137\x67\x72\x6f\165\160\163"] . "\56" . $this->join["\147\162\x6f\x75\x70\x73"] . "\40\75\40" . $this->tables["\x67\162\x6f\165\160\x73"] . "\x2e\151\x64", "\151\156\156\145\x72"); goto lL0Hd; OZ97i: $group_ids = []; goto XUMkr; cfMiJ: $this->trigger_events("\165\163\145\x72\x73"); goto axoLb; hYif3: lJJ7F: goto zjFJH; bBWRb: s6w2W: goto QnsxM; j1V9P: YF3T3: goto lBjxU; PuujZ: TWtbg: goto Rlrc2; Q3ils: dZJz3: goto DA98r; Rlrc2: if (empty($group_ids)) { goto WomcP; } goto VCoUV; dyKhd: $this->_ion_order_by = NULL; goto BjBFU; DA98r: $this->_ion_select = []; goto v2dn0; WUeAX: foreach ($this->_ion_where as $where) { $this->db->where($where); h9xdl: } goto hYif3; zjFJH: $this->_ion_where = []; goto inJW8; HHNYn: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto k2Vue; OjKyV: G0oSV: goto OZ97i; k_rwT: xQn1y: goto mM0PJ; LFRca: c_Jkp: goto jMKtZ; axoLb: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto YF3T3; } goto I0bzi; qHnXv: WomcP: goto k_rwT; wqoRj: $this->db->distinct(); goto mgMx9; t6ed5: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto mpxgw; } goto OGuK6; LQJHY: mpxgw: goto YUeM4; BjBFU: w_wbj: goto XNbB2; inJW8: Bal9T: goto t6ed5; I0bzi: $this->db->select([$this->tables["\x75\163\145\x72\163"] . "\x2e\52", $this->tables["\x75\163\x65\x72\163"] . "\x2e\x69\x64\x20\141\x73\40\x69\144", $this->tables["\x75\x73\x65\162\163"] . "\x2e\151\144\x20\x61\x73\x20\x75\163\x65\162\x5f\x69\x64"]); goto OJ632; IWc2r: $this->db->limit($this->_ion_limit); goto Ffgm6; OGuK6: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\x6b\x65"], $like["\166\x61\x6c\165\x65"], $like["\160\x6f\x73\x69\164\x69\x6f\156"]); kMoqf: } goto QHZfs; k2Vue: $this->_ion_limit = NULL; goto gnI9P; B_5zq: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto DKyCk; CA8md: NwIUb: goto rl79O; Ffgm6: $this->_ion_limit = NULL; goto bBWRb; jMKtZ: if (!(isset($groups) && !empty($groups))) { goto G0oSV; } goto wqoRj; lL0Hd: $this->db->where_in($this->tables["\x67\162\x6f\x75\160\x73"] . "\x2e\x6e\141\x6d\x65", $group_names); goto PuujZ; XNbB2: $this->response = $this->db->get($this->tables["\x75\163\145\162\163"]); goto F7gni; lBjxU: foreach ($this->_ion_select as $select) { $this->db->select($select); aAnfm: } goto Q3ils; cFDmd: if (!isset($groups)) { goto xQn1y; } goto SF1bD; sUS3E: foreach ($groups as $group) { goto wFuxD; cNL6d: Dlx2t: goto bILMU; bILMU: ZdGwC: goto kUjEZ; yRJiE: Jv6Hg: goto XA_Eh; wFuxD: if (is_numeric($group)) { goto Jv6Hg; } goto hYXXt; gqyXf: goto Dlx2t; goto yRJiE; XA_Eh: $group_ids[] = $group; goto cNL6d; hYXXt: $group_names[] = $group; goto gqyXf; kUjEZ: } goto CA8md; F7gni: return $this; goto mpEF1; xlHRQ: $this->_ion_like = []; goto LQJHY; DKyCk: $this->_ion_order = NULL; goto dyKhd; OJ632: goto d58Dx; goto j1V9P; SEjB5: ZgWlt: goto HHNYn; rglui: eltkL: goto LD8sI; XUMkr: $group_names = []; goto sUS3E; WkPc0: if (!isset($this->_ion_limit)) { goto s6w2W; } goto IWc2r; TEbZQ: if (empty($group_names)) { goto TWtbg; } goto xr8Kq; cjuM8: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto Bal9T; } goto WUeAX; LD8sI: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto w_wbj; } goto B_5zq; mpEF1: } public function user($id = NULL) { goto LumXW; x9AbZ: $this->users(); goto UBxOL; LumXW: $this->trigger_events("\x75\163\x65\x72"); goto wfmW1; q7z7o: $this->limit(1); goto tROOT; ywnCv: $this->where($this->tables["\x75\163\145\162\x73"] . "\56\151\x64", $id); goto x9AbZ; wfmW1: $id = isset($id) ? $id : $this->session->userdata("\165\163\145\162\137\x69\144"); goto q7z7o; tROOT: $this->order_by($this->tables["\165\x73\x65\162\163"] . "\x2e\151\144", "\144\145\163\x63"); goto ywnCv; UBxOL: return $this; goto da3p1; da3p1: } public function get_users_groups($id = FALSE) { goto Amngk; Amngk: $this->trigger_events("\x67\x65\x74\137\165\163\145\162\163\x5f\147\x72\x6f\x75\x70"); goto nIAba; Xs_Va: return $this->db->select($this->tables["\x75\163\145\162\163\137\147\x72\157\165\160\163"] . "\56" . $this->join["\x67\x72\x6f\165\x70\x73"] . "\40\141\x73\x20\x69\144\x2c\40" . $this->tables["\x67\x72\x6f\165\x70\163"] . "\56\156\141\155\145\x2c\x20" . $this->tables["\147\162\157\x75\x70\x73"] . "\56\144\145\x73\x63\x72\x69\x70\164\x69\157\156")->where($this->tables["\165\163\x65\x72\x73\137\x67\x72\x6f\165\x70\x73"] . "\x2e" . $this->join["\x75\163\145\x72\163"], $id)->join($this->tables["\x67\x72\157\x75\x70\163"], $this->tables["\165\x73\x65\x72\163\x5f\147\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\x67\162\x6f\x75\x70\163"] . "\x3d" . $this->tables["\147\x72\x6f\x75\x70\163"] . "\56\x69\x64")->get($this->tables["\165\163\x65\x72\163\137\x67\x72\157\165\x70\163"]); goto jP9MG; nIAba: $id || ($id = $this->session->userdata("\x75\163\145\x72\137\x69\144")); goto Xs_Va; jP9MG: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto QunPp; K_Jiu: goto YnJt9; goto ZBzLG; RCEvn: B03AP: goto f32gZ; QunPp: $this->trigger_events("\151\156\x5f\x67\162\157\x75\x70"); goto xGWWa; tdpqp: YnJt9: goto sYR8T; TkFr9: $users_groups = $this->get_users_groups($id)->result(); goto qG2lF; xGWWa: $id || ($id = $this->session->userdata("\165\x73\x65\162\137\x69\144")); goto dCrKw; VgMXf: hHRTk: goto sZKId; GNqe5: ACnX0: goto hMLYf; ZBzLG: GNFjq: goto l2Mye; TnuRX: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; Eq4qU: } goto GNqe5; sYR8T: foreach ($check_group as $key => $value) { goto SfUtC; mghHx: return !$check_all; goto q7VDE; ToOkT: if (!(in_array($value, $groups) xor $check_all)) { goto I5GHB; } goto mghHx; yBvdx: qtiWJ: goto X4fpu; q7VDE: I5GHB: goto yBvdx; SfUtC: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto ToOkT; X4fpu: } goto VgMXf; f32gZ: if (isset($this->_cache_user_in_group[$id])) { goto GNFjq; } goto TkFr9; sZKId: return $check_all; goto FuqoZ; l2Mye: $groups_array = $this->_cache_user_in_group[$id]; goto tdpqp; dCrKw: if (is_array($check_group)) { goto B03AP; } goto qH131; qG2lF: $groups_array = []; goto TnuRX; hMLYf: $this->_cache_user_in_group[$id] = $groups_array; goto K_Jiu; qH131: $check_group = [$check_group]; goto RCEvn; FuqoZ: } public function add_to_group($group_ids, $user_id = FALSE) { goto AR1zr; QDPDr: foreach ($group_ids as $group_id) { goto XJVp0; t3m9B: $group = $this->group($group_id)->result(); goto D8yyu; esB73: $group_name = $this->_cache_groups[$group_id]; goto NkpM6; pckwV: goto TgHNv; goto J1Mr3; J1Mr3: IQPhi: goto esB73; D8yyu: $group_name = $group[0]->name; goto CHIv4; V8UpQ: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto GEU_a; L7FX_: if (isset($this->_cache_groups[$group_id])) { goto IQPhi; } goto t3m9B; oz41z: LJTSG: goto TMLmh; CHIv4: $this->_cache_groups[$group_id] = $group_name; goto pckwV; NkpM6: TgHNv: goto V8UpQ; TMLmh: hcMK8: goto vnLGM; GEU_a: $return++; goto oz41z; XJVp0: if (!$this->db->insert($this->tables["\165\163\x65\x72\x73\x5f\x67\162\157\x75\160\163"], [$this->join["\147\162\157\x75\x70\163"] => (float) $group_id, $this->join["\165\x73\145\162\x73"] => (float) $user_id])) { goto LJTSG; } goto L7FX_; vnLGM: } goto tqQJM; tqQJM: d8fll: goto br5m2; xQDes: if (is_array($group_ids)) { goto F_GLk; } goto K5OFF; bFX47: F_GLk: goto U9Ew8; U9Ew8: $return = 0; goto QDPDr; br5m2: return $return; goto QjUrB; AR1zr: $this->trigger_events("\x61\144\x64\137\164\157\x5f\147\162\157\x75\x70"); goto YjnXj; K5OFF: $group_ids = [$group_ids]; goto bFX47; YjnXj: $user_id || ($user_id = $this->session->userdata("\165\163\145\162\x5f\x69\x64")); goto xQDes; QjUrB: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto LbYMH; FVAgi: goto rJqoj; goto y1BDy; pJ18n: A2S4X: goto BMhYs; dNi0t: if (!($return = $this->db->delete($this->tables["\165\163\x65\x72\163\x5f\147\x72\x6f\x75\160\x73"], [$this->join["\165\163\x65\x72\163"] => (float) $user_id]))) { goto XZ_Ic; } goto QrkNW; pjUi0: if (!empty($group_ids)) { goto n3gwJ; } goto dNi0t; BMhYs: $return = TRUE; goto z1oMK; y1BDy: n3gwJ: goto muJFq; yeqTP: XZ_Ic: goto FVAgi; N6S2L: return $return; goto BYyVM; mcepD: foreach ($group_ids as $group_id) { goto JZc5Q; JZc5Q: $this->db->delete($this->tables["\165\163\145\162\x73\137\x67\x72\157\x75\160\x73"], [$this->join["\147\x72\x6f\x75\160\x73"] => (float) $group_id, $this->join["\165\163\x65\x72\x73"] => (float) $user_id]); goto hQaP3; i6tuS: NHU9e: goto NG2C2; hQaP3: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto EsLLq; } goto jipKu; jipKu: unset($this->_cache_user_in_group[$user_id][$group_id]); goto HhW16; HhW16: EsLLq: goto i6tuS; NG2C2: } goto pJ18n; aTaOm: return FALSE; goto vUv6W; LbYMH: $this->trigger_events("\162\145\155\x6f\166\145\x5f\x66\x72\x6f\x6d\x5f\x67\x72\157\165\x70"); goto sfwen; q1rGW: UCJd_: goto mcepD; QrkNW: $this->_cache_user_in_group[$user_id] = []; goto yeqTP; e2gFs: $group_ids = [$group_ids]; goto q1rGW; muJFq: if (is_array($group_ids)) { goto UCJd_; } goto e2gFs; vUv6W: Frb6o: goto pjUi0; z1oMK: rJqoj: goto N6S2L; sfwen: if (!empty($user_id)) { goto Frb6o; } goto aTaOm; BYyVM: } public function groups() { goto BlnXF; uegIv: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto WtrhB; KLD_S: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto ClfTC; } goto VD0lY; PonPh: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto KCiBr; } goto ueLoi; zoP91: $this->_ion_where = []; goto eZ59t; kgJOw: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto txlDP; VitAx: return $this; goto crXYX; jyiy2: ClfTC: goto kgJOw; JlAuj: VhuGU: goto zoP91; Hsbnq: $this->response = $this->db->get($this->tables["\147\162\157\165\160\163"]); goto VitAx; eZ59t: KCiBr: goto KLD_S; D64S1: $this->db->limit($this->_ion_limit); goto a1__p; a1__p: $this->_ion_limit = NULL; goto g_DJ2; HC9B3: $this->_ion_offset = NULL; goto GQkFe; BlnXF: $this->trigger_events("\147\x72\157\165\160\x73"); goto PonPh; GQkFe: cARGE: goto ZgUjk; txlDP: $this->_ion_limit = NULL; goto HC9B3; VD0lY: if (!isset($this->_ion_limit)) { goto i20Q3; } goto D64S1; WtrhB: KIwFS: goto Hsbnq; g_DJ2: i20Q3: goto NJ7gN; ZgUjk: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto KIwFS; } goto uegIv; ueLoi: foreach ($this->_ion_where as $where) { $this->db->where($where); PdgXn: } goto JlAuj; NJ7gN: goto cARGE; goto jyiy2; crXYX: } public function group($id = NULL) { goto TbGwC; iSpuY: if (!isset($id)) { goto an11l; } goto IBvR3; SDQfl: $this->limit(1); goto ecbVe; MepkK: return $this->groups(); goto e6pC1; TbGwC: $this->trigger_events("\147\x72\x6f\165\x70"); goto iSpuY; IBvR3: $this->where($this->tables["\147\162\x6f\x75\x70\163"] . "\x2e\151\144", $id); goto IInj0; ecbVe: $this->order_by("\x69\144", "\144\x65\x73\x63"); goto MepkK; IInj0: an11l: goto SDQfl; e6pC1: } public function update($id, array $data) { goto Ubgm6; HZCvX: dgXFS: goto iaVdf; SCo6y: $user = $this->user($id)->row(); goto OwJ1x; QHdHs: if (!($data["\160\x61\x73\x73\x77\x6f\162\144"] === FALSE)) { goto zVIIs; } goto R5fNF; cEawh: unset($data["\x70\x61\163\x73\167\157\x72\x64"]); goto HdxnL; HdxnL: goto zkZo7; goto YUvZb; lXlcG: $this->trigger_events(["\x70\157\x73\164\137\165\x70\x64\x61\164\x65\137\165\x73\145\x72", "\160\x6f\x73\x74\137\165\160\x64\x61\x74\x65\137\165\163\x65\162\x5f\x73\165\143\143\x65\x73\163\x66\x75\x6c"]); goto QHPJq; W3Csq: $this->trigger_events(["\x70\157\163\164\137\165\x70\x64\x61\164\145\137\x75\x73\x65\162", "\160\x6f\x73\164\137\x75\x70\x64\141\x74\145\137\x75\163\x65\162\137\165\156\x73\165\x63\x63\145\x73\163\146\x75\154"]); goto iX0n9; XtKdr: return FALSE; goto kpZdK; dIGF3: zVIIs: goto oAShP; adIwU: $this->db->trans_rollback(); goto W3Csq; TVArb: $data = $this->_filter_data($this->tables["\x75\163\145\x72\163"], $data); goto XNvrl; OwJ1x: $this->db->trans_begin(); goto VHBTC; tncsM: if (!($this->db->trans_status() === FALSE)) { goto l9QH1; } goto adIwU; VHBTC: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto mPLQq; } goto v2fsy; EaIfp: $this->db->update($this->tables["\x75\163\145\x72\163"], $data, ["\x69\144" => $user->id]); goto tncsM; MaHPo: $this->trigger_events(["\160\157\163\164\137\165\160\144\141\164\x65\137\x75\163\x65\162", "\x70\x6f\163\164\x5f\x75\x70\x64\x61\x74\145\x5f\x75\x73\145\x72\x5f\165\x6e\163\x75\x63\143\x65\163\x73\x66\165\x6c"]); goto wsSET; XNvrl: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\163\163\x77\157\x72\144", $data) || array_key_exists("\x65\x6d\141\x69\x6c", $data))) { goto dgXFS; } goto VuNyn; e9iVS: $this->set_error("\141\143\x63\x6f\165\x6e\164\x5f\x63\x72\145\x61\164\x69\x6f\x6e\137\144\x75\160\154\x69\x63\141\164\x65\x5f\x69\x64\x65\156\x74\x69\x74\171"); goto p68f3; HDbES: if (!empty($data["\x70\x61\x73\163\167\x6f\162\144"])) { goto o6unF; } goto cEawh; kpZdK: mPLQq: goto TVArb; rHN9C: l9QH1: goto bhuE6; fDfre: return TRUE; goto AROO8; C7I7e: return FALSE; goto dIGF3; LkMqK: $this->set_error("\165\160\144\x61\164\x65\x5f\165\156\x73\x75\x63\143\145\x73\x73\146\165\x6c"); goto XtKdr; VuNyn: if (!array_key_exists("\x70\x61\163\x73\167\157\162\x64", $data)) { goto txC0c; } goto HDbES; p68f3: $this->trigger_events(["\x70\157\163\x74\137\165\x70\144\x61\x74\145\137\x75\163\x65\162", "\x70\x6f\x73\x74\137\165\x70\144\x61\x74\x65\x5f\165\163\145\x72\x5f\x75\x6e\x73\x75\143\x63\x65\163\163\x66\x75\x6c"]); goto LkMqK; iaVdf: $this->trigger_events("\x65\x78\164\162\141\137\x77\150\x65\x72\x65"); goto EaIfp; wsSET: $this->set_error("\165\x70\x64\141\x74\145\137\x75\x6e\x73\x75\143\x63\x65\x73\163\x66\x75\154"); goto C7I7e; QHPJq: $this->set_message("\165\x70\144\x61\x74\x65\137\163\165\143\143\145\163\163\x66\x75\x6c"); goto fDfre; IcHye: txC0c: goto HZCvX; oAShP: zkZo7: goto IcHye; YUvZb: o6unF: goto hg6ji; bhuE6: $this->db->trans_commit(); goto lXlcG; Ubgm6: $this->trigger_events("\x70\162\145\137\x75\x70\x64\141\164\145\x5f\165\x73\145\x72"); goto SCo6y; v2fsy: $this->db->trans_rollback(); goto e9iVS; iX0n9: $this->set_error("\x75\160\144\141\x74\145\x5f\165\x6e\163\165\143\x63\x65\163\x73\x66\165\x6c"); goto Ed4kL; Ed4kL: return FALSE; goto rHN9C; R5fNF: $this->db->trans_rollback(); goto MaHPo; hg6ji: $data["\x70\141\x73\163\x77\157\162\x64"] = $this->hash_password($data["\160\x61\163\x73\x77\157\x72\144"], $user->{$this->identity_column}); goto QHdHs; AROO8: } public function delete_user($id) { goto FZQhx; oZI7e: $this->trigger_events(["\x70\x6f\x73\164\x5f\144\145\x6c\145\164\145\137\165\x73\145\162", "\160\x6f\163\164\x5f\144\145\154\145\164\x65\x5f\165\x73\145\162\137\x75\x6e\x73\165\143\x63\x65\x73\x73\x66\165\154"]); goto XWQuM; xLrcs: if (!($this->db->trans_status() === FALSE)) { goto dkfTX; } goto T5kB5; yk3Y7: return TRUE; goto PV0rP; te_mJ: $this->db->delete($this->tables["\x75\x73\145\x72\163"], ["\151\x64" => $id]); goto xLrcs; AIVwb: $this->db->trans_commit(); goto sQtPW; so7Ww: $this->db->trans_begin(); goto AM1lD; T5kB5: $this->db->trans_rollback(); goto oZI7e; sQtPW: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x64\145\154\x65\x74\145\137\165\163\x65\x72", "\160\x6f\x73\164\x5f\144\145\x6c\x65\x74\x65\x5f\x75\163\x65\162\137\x73\165\x63\x63\145\163\163\x66\x75\x6c"]); goto C36a1; C36a1: $this->set_message("\144\145\154\145\x74\145\137\x73\165\x63\x63\x65\x73\163\x66\165\154"); goto yk3Y7; NGFQ_: dkfTX: goto AIVwb; FZQhx: $this->trigger_events("\160\162\145\x5f\x64\x65\x6c\x65\164\145\x5f\165\163\145\162"); goto so7Ww; XWQuM: $this->set_error("\x64\x65\154\145\164\145\x5f\x75\156\163\x75\143\x63\145\x73\x73\x66\165\154"); goto MmBGJ; MmBGJ: return FALSE; goto NGFQ_; AM1lD: $this->remove_from_group(NULL, $id); goto te_mJ; PV0rP: } public function update_last_login($id) { goto qYRCO; qYRCO: $this->trigger_events("\x75\x70\144\141\x74\145\137\154\141\163\164\x5f\x6c\157\147\151\x6e"); goto Hom_o; Hom_o: $this->load->helper("\144\x61\164\x65"); goto Z2d7w; j_HKS: return $this->db->affected_rows() == 1; goto BBjk1; Z2d7w: $this->trigger_events("\145\170\x74\x72\141\x5f\167\150\145\x72\x65"); goto bBX6s; bBX6s: $this->db->update($this->tables["\x75\x73\x65\x72\163"], ["\x6c\x61\163\164\x5f\154\157\147\151\x6e" => time()], ["\151\x64" => $id]); goto j_HKS; BBjk1: } public function set_lang($lang = "\145\x6e") { goto GrgZh; dpmaQ: return TRUE; goto a7Vpa; ZyV4c: $expire = $this->config->item("\165\163\x65\x72\x5f\x65\x78\x70\x69\x72\x65", "\151\x6f\x6e\x5f\x61\165\164\x68"); goto BQ0g_; Q1mMz: r3I6R: goto adVaz; U2957: $expire = self::MAX_COOKIE_LIFETIME; goto Q1mMz; BQ0g_: goto r3I6R; goto sWRYM; WVl71: if ($this->config->item("\x75\163\x65\x72\137\x65\170\x70\151\162\145", "\x69\x6f\x6e\137\x61\x75\164\x68") === 0) { goto LPXGl; } goto ZyV4c; GrgZh: $this->trigger_events("\163\x65\164\x5f\x6c\141\156\147"); goto WVl71; adVaz: set_cookie(["\x6e\x61\155\x65" => "\x6c\x61\x6e\x67\x5f\x63\157\144\x65", "\x76\x61\x6c\x75\x65" => $lang, "\x65\x78\x70\x69\162\145" => $expire]); goto dpmaQ; sWRYM: LPXGl: goto U2957; a7Vpa: } public function set_session($user) { goto x4Y8Y; fLFjH: $this->session->set_userdata($session_data); goto n_XOt; r0GVd: return TRUE; goto h2V8G; B925l: $session_data = ["\151\x64\145\156\x74\x69\164\171" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\151\x6c" => $user->email, "\165\163\x65\x72\x5f\x69\x64" => $user->id, "\x6f\154\x64\137\154\x61\x73\164\137\x6c\157\147\151\x6e" => $user->last_login, "\154\141\x73\x74\x5f\143\x68\145\143\153" => time()]; goto fLFjH; x4Y8Y: $this->trigger_events("\160\x72\145\137\x73\x65\164\137\163\145\163\x73\x69\x6f\156"); goto B925l; n_XOt: $this->trigger_events("\160\x6f\x73\x74\137\163\x65\x74\x5f\163\x65\x73\x73\x69\157\156"); goto r0GVd; h2V8G: } public function remember_user($identity) { goto sxHRX; Exmzc: $expire = self::MAX_COOKIE_LIFETIME; goto A3eQ0; TX3H2: if ($identity) { goto mwzK0; } goto xCQXe; K3Q7A: hnd71: goto Exmzc; p4Jhs: $expire = $this->config->item("\x75\x73\145\162\x5f\x65\x78\160\151\x72\145", "\x69\157\156\x5f\x61\165\164\x68"); goto H66VW; TrIk0: $this->db->update($this->tables["\165\x73\x65\x72\163"], ["\162\145\155\145\155\142\145\162\x5f\163\145\x6c\145\143\164\x6f\162" => $token->selector, "\162\145\155\145\x6d\x62\145\162\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto PE5FI; uTkxH: return TRUE; goto vENCK; eL0Zk: mwzK0: goto Cjeoq; Amh_r: if ($this->config->item("\x75\x73\145\162\137\145\170\160\151\162\x65", "\x69\x6f\x6e\x5f\141\165\x74\x68") === 0) { goto hnd71; } goto p4Jhs; xvShH: return FALSE; goto sq3KK; vzWqQ: set_cookie(["\x6e\141\155\145" => $this->config->item("\162\145\155\145\155\x62\145\x72\x5f\x63\x6f\157\153\x69\145\x5f\x6e\x61\x6d\145", "\x69\x6f\156\x5f\x61\x75\164\150"), "\x76\x61\154\x75\x65" => $token->user_code, "\145\170\160\x69\x72\145" => $expire]); goto zvYx5; H66VW: goto kRXCU; goto K3Q7A; rJplX: ewnoO: goto DJNHJ; Cjeoq: $token = $this->_generate_selector_validator_couple(); goto UdOpr; UdOpr: if (!$token->validator_hashed) { goto ewnoO; } goto TrIk0; sxHRX: $this->trigger_events("\160\x72\145\x5f\162\x65\155\x65\x6d\142\x65\162\x5f\165\163\145\162"); goto TX3H2; DJNHJ: $this->trigger_events(["\160\x6f\x73\164\137\x72\145\x6d\145\155\x62\x65\x72\137\165\163\x65\x72", "\x72\x65\x6d\145\155\x62\x65\162\x5f\165\x73\145\x72\137\165\x6e\x73\x75\143\x63\145\x73\163\146\165\x6c"]); goto xvShH; xCQXe: return FALSE; goto eL0Zk; PE5FI: if (!($this->db->affected_rows() > -1)) { goto KrDsF; } goto Amh_r; zvYx5: $this->trigger_events(["\x70\x6f\163\164\137\x72\x65\155\x65\155\x62\145\x72\137\165\x73\x65\x72", "\162\145\x6d\x65\x6d\142\x65\162\x5f\165\x73\x65\x72\137\163\x75\x63\143\145\163\163\x66\x75\x6c"]); goto uTkxH; A3eQ0: kRXCU: goto vzWqQ; vENCK: KrDsF: goto rJplX; sq3KK: } public function login_remembered_user() { goto lA8Jv; whxE3: JBJpe: goto tX43q; UinJr: return TRUE; goto aSkNU; Vi10a: $this->remember_user($identity); goto whxE3; g2bs5: return FALSE; goto RbN9q; alFun: eGerl: goto jxHbn; k6HLc: $this->trigger_events("\145\170\164\162\x61\137\167\x68\x65\162\145"); goto DfGqk; aSkNU: mt4C8: goto alFun; ml0ol: if (!($token === FALSE)) { goto vVGJX; } goto Xe4W2; C8IBZ: $this->trigger_events(["\160\157\163\x74\137\154\157\x67\151\156\x5f\x72\x65\155\145\x6d\x62\145\x72\x65\x64\x5f\165\163\x65\162", "\160\x6f\163\x74\x5f\154\157\x67\151\x6e\137\162\145\x6d\x65\x6d\x62\x65\x72\x65\144\137\165\163\145\162\137\x73\x75\143\x63\x65\163\163\x66\165\x6c"]); goto UinJr; phUat: $identity = $user->{$this->identity_column}; goto WMZVj; U5ZLN: if (!($query->num_rows() === 1)) { goto eGerl; } goto j0r71; tX43q: $this->session->sess_regenerate(FALSE); goto C8IBZ; lA8Jv: $this->trigger_events("\x70\162\145\x5f\x6c\x6f\x67\151\156\137\162\x65\155\145\155\x62\x65\x72\x65\x64\137\165\163\145\x72"); goto QCEBJ; vGaMe: $this->update_last_login($user->id); goto a0uIO; j0r71: $user = $query->row(); goto phUat; WMZVj: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto mt4C8; } goto vGaMe; EndFT: $this->trigger_events(["\160\x6f\x73\164\x5f\x6c\x6f\147\151\156\137\x72\145\155\145\x6d\x62\x65\162\145\144\x5f\x75\x73\145\x72", "\160\157\163\164\x5f\154\x6f\x67\151\x6e\x5f\x72\x65\155\x65\155\x62\x65\x72\145\x64\x5f\x75\163\145\x72\137\165\x6e\x73\x75\143\x63\145\163\163\x66\x75\154"]); goto FyVly; hWEcZ: $this->clear_forgotten_password_code($identity); goto V5kzG; FyVly: return FALSE; goto B53_R; DfGqk: $query = $this->db->select($this->identity_column . "\54\40\x69\144\x2c\40\x65\155\x61\151\154\54\40\x72\x65\155\145\155\x62\145\162\x5f\143\157\x64\x65\x2c\40\x6c\x61\x73\x74\137\154\x6f\x67\151\156")->where("\162\x65\155\x65\x6d\x62\x65\x72\x5f\x73\x65\x6c\x65\143\x74\x6f\162", $token->selector)->where("\x61\x63\164\x69\166\145", 1)->limit(1)->get($this->tables["\x75\163\x65\x72\163"]); goto U5ZLN; QIhsp: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto ml0ol; Xe4W2: $this->trigger_events(["\160\157\163\x74\137\x6c\x6f\x67\151\x6e\137\162\x65\x6d\x65\155\x62\145\162\145\144\137\165\163\x65\162", "\160\157\163\164\x5f\154\x6f\147\151\156\137\162\x65\x6d\145\155\x62\x65\162\x65\x64\137\x75\x73\145\x72\137\x75\x6e\163\165\x63\143\x65\x73\x73\146\165\x6c"]); goto g2bs5; jxHbn: delete_cookie($this->config->item("\162\145\x6d\x65\x6d\x62\145\x72\137\143\157\x6f\x6b\x69\x65\137\156\141\x6d\x65", "\x69\x6f\156\x5f\141\165\x74\150")); goto EndFT; V5kzG: if (!$this->config->item("\165\x73\145\162\137\145\x78\x74\x65\156\144\x5f\x6f\x6e\137\x6c\x6f\147\151\x6e", "\151\x6f\x6e\137\x61\165\164\x68")) { goto JBJpe; } goto Vi10a; QCEBJ: $remember_cookie = get_cookie($this->config->item("\x72\x65\x6d\x65\x6d\x62\145\162\x5f\143\x6f\x6f\x6b\x69\x65\137\156\x61\x6d\x65", "\151\x6f\x6e\x5f\x61\x75\164\x68")); goto QIhsp; a0uIO: $this->set_session($user); goto hWEcZ; RbN9q: vVGJX: goto k6HLc; B53_R: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto GjHjm; vNytG: $this->set_error("\147\x72\x6f\x75\x70\137\x6e\x61\x6d\145\x5f\162\x65\x71\x75\151\162\x65\144"); goto BbEEY; d5Ahx: if (!($existing_group !== 0)) { goto upRJu; } goto mVQRW; A4rtK: $this->trigger_events("\145\x78\x74\x72\x61\137\147\x72\x6f\x75\x70\x5f\x73\x65\164"); goto M9lI6; mAtcx: WRAqB: goto A4rtK; VNVCL: WnKsP: goto ozDRW; qpe7j: return FALSE; goto cCGGs; GjHjm: if ($group_name) { goto WnKsP; } goto vNytG; BbEEY: return FALSE; goto VNVCL; FPJwr: $this->set_message("\x67\x72\157\165\160\x5f\143\162\x65\x61\164\x69\157\156\137\163\165\x63\x63\x65\x73\x73\x66\165\154"); goto pszBZ; mVQRW: $this->set_error("\x67\x72\x6f\165\160\137\x61\154\162\x65\141\x64\x79\137\x65\x78\151\163\164\x73"); goto qpe7j; pszBZ: return $group_id; goto V0hJB; TInbQ: $data = ["\x6e\x61\x6d\x65" => $group_name, "\144\145\163\x63\x72\x69\x70\164\x69\x6f\156" => $group_description]; goto jB94q; cCGGs: upRJu: goto TInbQ; FXgOQ: $group_id = $this->db->insert_id($this->tables["\x67\162\x6f\165\160\x73"] . "\137\x69\144\137\x73\145\161"); goto FPJwr; jB94q: if (empty($additional_data)) { goto WRAqB; } goto x9KmP; x9KmP: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\x75\x70\163"], $additional_data), $data); goto mAtcx; ozDRW: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\163"], ["\x6e\141\155\x65" => $group_name])->num_rows(); goto d5Ahx; M9lI6: $this->db->insert($this->tables["\x67\x72\x6f\x75\x70\x73"], $data); goto FXgOQ; V0hJB: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto GoawY; A_iZv: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\165\160\163"], ["\x6e\x61\x6d\x65" => $group_name])->row(); goto OWTHk; ngHfs: $this->set_error("\x67\162\x6f\165\160\137\141\154\x72\145\141\144\x79\137\145\170\151\x73\x74\x73"); goto Q1S_N; vzPXu: if (!($this->config->item("\141\144\x6d\151\156\x5f\x67\x72\x6f\x75\160", "\x69\157\x6e\x5f\141\x75\x74\x68") === $group->name && $group_name !== $group->name)) { goto Wd9t7; } goto qm_1s; qm_1s: $this->set_error("\x67\162\157\x75\160\137\x6e\141\155\145\137\141\x64\x6d\151\x6e\137\156\157\164\x5f\x61\x6c\x74\145\x72"); goto X3trx; OWTHk: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto x1Qu7; } goto ngHfs; jSJ2Y: $data["\x6e\x61\x6d\145"] = $group_name; goto SdbeW; vsrWT: $group = $this->db->get_where($this->tables["\x67\x72\157\x75\160\163"], ["\151\x64" => $group_id])->row(); goto vzPXu; GoawY: if (!empty($group_id)) { goto DPJ8C; } goto fKZQl; qSYZH: x1Qu7: goto jSJ2Y; fKZQl: return FALSE; goto V0w12; N3slg: Wd9t7: goto rGHBu; X3trx: return FALSE; goto N3slg; JQwA0: $this->db->update($this->tables["\147\x72\157\x75\160\x73"], $data, ["\x69\144" => $group_id]); goto cS1xP; rcYvu: mnmdq: goto JQwA0; Q1S_N: return FALSE; goto qSYZH; V0w12: DPJ8C: goto o18Dq; g_24A: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\x70\163"], $additional_data), $data); goto rcYvu; o18Dq: $data = []; goto z23hn; cS1xP: $this->set_message("\147\x72\x6f\165\160\137\165\160\x64\141\164\x65\137\x73\x75\143\143\145\163\x73\146\x75\x6c"); goto ugL4g; rGHBu: if (empty($additional_data)) { goto mnmdq; } goto g_24A; z23hn: if (empty($group_name)) { goto sbe0t; } goto A_iZv; ugL4g: return TRUE; goto eSE7S; SdbeW: sbe0t: goto vsrWT; eSE7S: } public function delete_group($group_id = FALSE) { goto anMen; XtzjV: return FALSE; goto FquG1; H1UX7: $this->trigger_events(["\x70\x6f\163\164\137\144\145\154\x65\164\145\137\x67\x72\x6f\165\x70", "\160\x6f\x73\164\137\144\145\x6c\145\x74\145\x5f\x67\162\x6f\165\160\x5f\165\x6e\163\x75\143\x63\145\x73\163\146\x75\x6c"]); goto PvY9r; CQX6A: $group = $this->group($group_id)->row(); goto yqNqZ; gy451: $this->set_message("\147\162\157\165\160\137\144\145\154\x65\164\145\x5f\163\x75\143\143\145\163\163\x66\x75\x6c"); goto H60Az; FquG1: PtH44: goto f403O; ypR4h: $this->db->delete($this->tables["\x67\162\157\165\160\x73"], ["\151\x64" => $group_id]); goto AxZud; anMen: if (!(!$group_id || empty($group_id))) { goto bFWQo; } goto XqaZz; m1hcv: $this->db->trans_rollback(); goto H1UX7; a9wkx: $this->db->delete($this->tables["\165\163\145\162\163\x5f\x67\x72\157\165\160\163"], [$this->join["\147\162\157\165\160\163"] => $group_id]); goto ypR4h; acYot: $this->trigger_events(["\x70\157\163\x74\137\144\x65\154\x65\164\x65\137\147\162\x6f\165\x70", "\x70\x6f\x73\164\x5f\x64\145\x6c\145\164\x65\137\147\162\157\x75\160\137\156\x6f\164\x61\154\x6c\157\x77\145\144"]); goto yE8oH; f403O: $this->db->trans_commit(); goto M1EDx; yE8oH: $this->set_error("\147\162\157\x75\x70\x5f\144\145\154\145\x74\x65\x5f\156\157\164\x61\154\x6c\x6f\x77\145\x64"); goto ESXOk; AxZud: if (!($this->db->trans_status() === FALSE)) { goto PtH44; } goto m1hcv; kj5ch: $this->db->trans_begin(); goto a9wkx; ESXOk: return FALSE; goto lvG3O; H60Az: return TRUE; goto G3OLa; yqNqZ: if (!($group->name == $this->config->item("\141\x64\155\151\x6e\x5f\x67\162\157\x75\x70", "\x69\157\156\x5f\x61\165\x74\150"))) { goto o6L9W; } goto acYot; M1EDx: $this->trigger_events(["\160\x6f\x73\x74\x5f\x64\x65\x6c\x65\x74\145\137\x67\x72\x6f\165\x70", "\160\x6f\x73\x74\x5f\144\145\x6c\x65\164\x65\x5f\x67\162\157\165\160\x5f\163\x75\143\143\x65\163\x73\146\x75\154"]); goto gy451; EKX1k: $this->trigger_events("\x70\162\x65\137\144\x65\x6c\145\164\x65\137\x67\x72\157\165\160"); goto kj5ch; PvY9r: $this->set_error("\x67\x72\157\x75\160\137\144\x65\x6c\145\164\x65\x5f\x75\156\x73\165\143\143\x65\x73\163\146\165\x6c"); goto XtzjV; v5Y6r: bFWQo: goto CQX6A; XqaZz: return FALSE; goto v5Y6r; lvG3O: o6L9W: goto EKX1k; G3OLa: } public function set_hook($event, $name, $class, $method, $arguments) { goto Sfd1t; ssoN8: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto VhTDZ; Cwr0A: $this->_ion_hooks->{$event}[$name]->class = $class; goto TphLy; TphLy: $this->_ion_hooks->{$event}[$name]->method = $method; goto ssoN8; Sfd1t: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto Cwr0A; VhTDZ: } public function remove_hook($event, $name) { goto YKcwC; slpR8: unset($this->_ion_hooks->{$event}[$name]); goto do_uo; YKcwC: if (!isset($this->_ion_hooks->{$event}[$name])) { goto v3os9; } goto slpR8; do_uo: v3os9: goto IccIm; IccIm: } public function remove_hooks($event) { goto evb4G; evb4G: if (!isset($this->_ion_hooks->{$event})) { goto OS_a8; } goto YatXK; YatXK: unset($this->_ion_hooks->{$event}); goto m9NSl; m9NSl: OS_a8: goto ZUQQB; ZUQQB: } protected function _call_hook($event, $name) { goto rCENP; ueFDi: PV2Yf: goto d4K0F; VYpiR: $hook = $this->_ion_hooks->{$event}[$name]; goto JPPYk; JPPYk: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto ueFDi; d4K0F: return FALSE; goto Xt3Wy; rCENP: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto PV2Yf; } goto VYpiR; Xt3Wy: } public function trigger_events($events) { goto QleZE; LF0hk: jn5OE: goto dBkNv; wDzuk: foreach ($events as $event) { $this->trigger_events($event); n1BSf: } goto NagGC; h5q2E: Qy8Ur: goto LF0hk; TlsBj: OBpVv: goto ribaV; NagGC: LoCUJ: goto TlsBj; mykoA: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto jn5OE; } goto g6aSW; G3KG2: tlSbY: goto wDzuk; g6aSW: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); GPUuK: } goto h5q2E; QleZE: if (is_array($events) && !empty($events)) { goto tlSbY; } goto mykoA; dBkNv: goto OBpVv; goto G3KG2; ribaV: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto v9BLH; kCJKB: $this->message_end_delimiter = $end_delimiter; goto xc8jl; xc8jl: return TRUE; goto jR9j5; v9BLH: $this->message_start_delimiter = $start_delimiter; goto kCJKB; jR9j5: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto urYHj; Wi3VH: return TRUE; goto leJpD; urYHj: $this->error_start_delimiter = $start_delimiter; goto ZJaj7; ZJaj7: $this->error_end_delimiter = $end_delimiter; goto Wi3VH; leJpD: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto ceiWU; OR09C: foreach ($this->messages as $message) { goto ww8EQ; ww8EQ: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\43"; goto o5g9a; o5g9a: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto YBNZn; YBNZn: epKMX: goto b5It9; b5It9: } goto reYYy; fOKx0: return $_output; goto N9jsJ; reYYy: pK7Io: goto fOKx0; ceiWU: $_output = ''; goto OR09C; N9jsJ: } public function messages_array($langify = TRUE) { goto R8gb5; Zh6E4: $_output = []; goto E1LuI; BDW9k: pln5C: goto ArcJd; TW_WP: goto pln5C; goto x0pc0; x0pc0: U082E: goto Zh6E4; E1LuI: foreach ($this->messages as $message) { goto JLloV; pje1K: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto LzbF5; LzbF5: w_CPd: goto E2y_r; JLloV: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\43\43"; goto pje1K; E2y_r: } goto c_bV1; c_bV1: eKh7t: goto rDDGL; azUgj: return $this->messages; goto TW_WP; rDDGL: return $_output; goto BDW9k; R8gb5: if ($langify) { goto U082E; } goto azUgj; ArcJd: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto SFddX; SFddX: $_output = ''; goto lw0DK; Y4183: return $_output; goto rB7wv; lw0DK: foreach ($this->errors as $error) { goto wLj02; wLj02: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\x23\x23"; goto SZDVd; SZDVd: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto r3Cd8; r3Cd8: NyVC0: goto hMAZJ; hMAZJ: } goto iqoJ4; iqoJ4: pQyiE: goto Y4183; rB7wv: } public function errors_array($langify = TRUE) { goto pptl6; XbOU6: wE554: goto zd2X4; EWG3L: goto wE554; goto TOcTP; sbo9p: Dozeq: goto h85du; kB_3F: return $this->errors; goto EWG3L; Tydo3: foreach ($this->errors as $error) { goto Xf5KY; MScnX: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto k85Dz; Xf5KY: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\43"; goto MScnX; k85Dz: JHkiI: goto dxI3h; dxI3h: } goto sbo9p; h85du: return $_output; goto XbOU6; EmA_V: $_output = []; goto Tydo3; pptl6: if ($langify) { goto wQiyl; } goto kB_3F; TOcTP: wQiyl: goto EmA_V; zd2X4: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto UCepo; qCOBJ: return FALSE; goto Odo00; Odo00: JOECc: goto GQAGN; to0UN: $this->trigger_events("\145\x78\x74\162\141\x5f\x77\150\x65\x72\x65"); goto SZr1T; UCepo: $hash = $this->hash_password($password, $identity); goto QBWGZ; SZr1T: $this->db->update($this->tables["\165\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto Qq2LH; QBWGZ: if (!($hash === FALSE)) { goto JOECc; } goto qCOBJ; Qq2LH: return $this->db->affected_rows() == 1; goto ZENVn; GQAGN: $data = ["\x70\141\163\163\167\x6f\x72\x64" => $hash, "\162\145\x6d\x65\155\x62\x65\x72\137\143\157\144\x65" => NULL, "\x66\x6f\162\x67\x6f\x74\x74\x65\x6e\x5f\160\141\x73\x73\167\157\x72\144\x5f\x63\157\144\x65" => NULL, "\146\157\162\x67\157\x74\164\145\156\137\160\141\163\163\x77\157\162\144\137\x74\151\x6d\x65" => NULL]; goto to0UN; ZENVn: } protected function _filter_data($table, $data) { goto VYO9T; ZG00V: $columns = $this->db->list_fields($table); goto oGQQL; QoY0X: BhH4U: goto iw3sd; zHyMy: foreach ($columns as $column) { goto xWMwD; f76Q4: U2mAL: goto aKM2D; Dsrui: CtZum: goto f76Q4; AEghm: $filtered_data[$column] = $data[$column]; goto Dsrui; xWMwD: if (!array_key_exists($column, $data)) { goto CtZum; } goto AEghm; aKM2D: } goto SpwD9; iw3sd: return $filtered_data; goto JewuG; oGQQL: if (!is_array($data)) { goto BhH4U; } goto zHyMy; VYO9T: $filtered_data = []; goto ZG00V; SpwD9: UO22x: goto QoY0X; JewuG: } protected function _random_token($result_length = 32) { goto M0UJ2; uBZ9g: if (!function_exists("\157\160\145\x6e\163\x73\x6c\137\162\x61\x6e\144\x6f\155\137\x70\x73\x65\x75\x64\x6f\137\142\171\164\145\x73")) { goto qWG1J; } goto L_EuH; I7oxH: return FALSE; goto lp1kE; LhIv5: if (!function_exists("\155\x63\162\171\x70\164\137\143\162\x65\x61\x74\x65\x5f\x69\166")) { goto lKtFx; } goto m827m; K8HtO: if (!function_exists("\x72\x61\x6e\144\x6f\155\137\142\171\x74\145\x73")) { goto e33dD; } goto yNWSV; m827m: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto vhgEI; hFrW7: qWG1J: goto I7oxH; vhgEI: lKtFx: goto uBZ9g; M0UJ2: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto yul_j; } goto xztfe; JgQsB: yul_j: goto K8HtO; yNWSV: return bin2hex(random_bytes($result_length / 2)); goto cYmiH; cYmiH: e33dD: goto LhIv5; xztfe: $result_length = 32; goto JgQsB; L_EuH: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto hFrW7; lp1kE: } protected function _get_hash_parameters($identity = NULL) { goto ofQDe; IZQN8: ALfKc: goto JjM3i; IV0J4: switch ($this->hash_method) { case "\142\143\162\x79\x70\x74": $params = ["\x63\157\x73\164" => $is_admin ? $this->config->item("\142\143\162\x79\160\164\x5f\x61\144\x6d\151\156\x5f\x63\x6f\x73\x74", "\151\157\156\x5f\141\165\x74\x68") : $this->config->item("\142\143\x72\171\x70\x74\x5f\144\145\146\141\165\x6c\x74\137\143\157\163\164", "\151\x6f\156\137\x61\x75\x74\x68")]; goto ALfKc; case "\141\x72\x67\x6f\156\62": $params = $is_admin ? $this->config->item("\x61\162\147\x6f\x6e\62\137\141\144\x6d\151\156\137\x70\x61\x72\141\x6d\x73", "\x69\157\x6e\x5f\x61\165\x74\x68") : $this->config->item("\141\162\x67\x6f\x6e\x32\x5f\144\x65\x66\x61\x75\x6c\164\x5f\160\141\x72\141\x6d\x73", "\151\157\156\x5f\x61\165\x74\150"); goto ALfKc; default: } goto atneb; atneb: PrPvu: goto IZQN8; aWdrP: if (!($user_id && $this->in_group($this->config->item("\x61\144\155\151\x6e\137\x67\x72\x6f\x75\160", "\x69\x6f\x6e\137\x61\165\x74\150"), $user_id))) { goto u89x0; } goto AR1Gx; ootbb: $user_id = $this->get_user_id_from_identity($identity); goto aWdrP; AR1Gx: $is_admin = TRUE; goto Giu8S; JjM3i: return $params; goto j6VT1; His55: oVDFr: goto GZV1c; ofQDe: $is_admin = FALSE; goto BIUWS; GZV1c: $params = FALSE; goto IV0J4; Giu8S: u89x0: goto His55; BIUWS: if (!$identity) { goto oVDFr; } goto ootbb; j6VT1: } protected function _get_hash_algo() { goto WxC9S; q_lMl: switch ($this->hash_method) { case "\142\143\x72\x79\x70\x74": $algo = PASSWORD_BCRYPT; goto XfwyT; case "\x61\162\x67\x6f\x6e\62": $algo = PASSWORD_ARGON2I; goto XfwyT; default: } goto V4qls; rqx79: return $algo; goto b8d2o; zx4qz: XfwyT: goto rqx79; WxC9S: $algo = FALSE; goto q_lMl; V4qls: Q9Y27: goto zx4qz; b8d2o: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto jtuoF; GsHV1: $validator_hashed = $this->hash_password($validator); goto jok4j; avCA3: return (object) ["\x73\x65\x6c\145\143\x74\157\x72" => $selector, "\166\x61\154\151\144\141\164\x6f\x72\x5f\150\141\163\150\x65\144" => $validator_hashed, "\165\x73\x65\x72\x5f\x63\157\x64\x65" => $user_code]; goto oiGt1; jok4j: $user_code = "{$selector}\56{$validator}"; goto avCA3; gd4ts: $validator = $this->_random_token($validator_size); goto GsHV1; jtuoF: $selector = $this->_random_token($selector_size); goto gd4ts; oiGt1: } protected function _retrieve_selector_validator_couple($user_code) { goto dKN9A; TniW9: NxcDs: goto yXWX5; ZuUEu: $tokens = explode("\x2e", $user_code); goto v00d5; TSi1y: CFISn: goto TniW9; jN3yw: return (object) ["\163\145\x6c\145\143\164\157\162" => $tokens[0], "\x76\141\154\151\x64\141\164\157\162" => $tokens[1]]; goto TSi1y; dKN9A: if (!$user_code) { goto NxcDs; } goto ZuUEu; yXWX5: return FALSE; goto d2z0U; v00d5: if (!(count($tokens) === 2)) { goto CFISn; } goto jN3yw; d2z0U: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto cLQMB; tZOJj: if ($hashed_password === $hashed_password_db) { goto l__AL; } goto Pqe4H; TL_aW: goto pRuXO; goto GH1zA; inU51: $query = $this->db->select("\163\x61\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\x73"]); goto EaCfO; vS3Q6: fjWms: goto aYee1; P3P9M: return FALSE; goto gL_dY; iVXIt: return FALSE; goto Xki53; lpJoH: $this->trigger_events(["\160\x6f\163\x74\x5f\163\150\x61\x31\137\160\141\163\163\x77\157\x72\x64\x5f\155\x69\x67\x72\x61\x74\x69\x6f\x6e", "\160\157\x73\164\x5f\163\150\141\61\137\160\x61\163\x73\167\x6f\x72\144\137\155\x69\147\162\141\164\x69\x6f\x6e\x5f\x75\x6e\163\x75\x63\143\x65\x73\x73\x66\x75\154"]); goto P3P9M; GH1zA: B7FO3: goto inU51; mVxhJ: if (!($query->num_rows() !== 1)) { goto aw4ju; } goto lpJoH; jCmTt: if ($result) { goto PZRIw; } goto UhzH8; aYee1: $salt = substr($hashed_password_db, 0, $salt_length); goto IYMGB; Xki53: goto vW5Sn; goto Ail1U; IYMGB: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto TL_aW; oCMPK: $this->trigger_events(["\x70\157\x73\164\x5f\163\150\141\x31\137\x70\x61\x73\163\x77\x6f\x72\x64\x5f\155\151\x67\x72\x61\164\151\157\156", "\160\x6f\163\x74\x5f\163\x68\141\61\x5f\x70\x61\163\x73\167\157\162\144\137\x6d\x69\147\162\x61\164\x69\157\156\137\x75\x6e\x73\165\x63\143\x65\x73\163\x66\x75\154"]); goto IXtIP; Ail1U: l__AL: goto BNCtm; BNCtm: $result = $this->_set_password_db($identity, $password); goto jCmTt; ar4V_: pRuXO: goto tZOJj; EUppm: if ($salt_length) { goto fjWms; } goto oCMPK; fw7R3: if ($this->config->item("\x73\164\x6f\162\x65\x5f\x73\x61\x6c\164", "\x69\x6f\x6e\x5f\x61\165\x74\150")) { goto B7FO3; } goto zUU1P; EaCfO: $salt_db = $query->row(); goto mVxhJ; iMRuM: PZRIw: goto xvZn3; xvZn3: $this->trigger_events(["\160\x6f\x73\164\x5f\x73\x68\141\x31\137\160\141\163\x73\167\157\162\x64\137\x6d\x69\147\x72\x61\164\x69\157\x6e", "\x70\x6f\x73\x74\137\163\x68\141\x31\137\x70\x61\163\x73\167\157\x72\144\x5f\155\x69\x67\x72\x61\x74\x69\157\x6e\137\163\165\x63\x63\145\163\x73\x66\x75\154"]); goto CBfGR; oCjmB: vW5Sn: goto mgc80; li1e3: $hashed_password = sha1($password . $salt_db->salt); goto ar4V_; UZvxj: goto vy_93; goto iMRuM; bbxn4: return $result; goto oCjmB; gL_dY: aw4ju: goto li1e3; CBfGR: vy_93: goto bbxn4; zUU1P: $salt_length = $this->config->item("\x73\x61\x6c\164\137\x6c\x65\156\147\x74\x68", "\151\x6f\x6e\x5f\141\165\x74\150"); goto EUppm; IXtIP: return FALSE; goto vS3Q6; cLQMB: $this->trigger_events("\x70\162\x65\x5f\163\150\141\61\137\x70\x61\163\x73\x77\x6f\x72\144\137\155\151\147\x72\x61\x74\x69\157\156"); goto fw7R3; UhzH8: $this->trigger_events(["\x70\x6f\163\164\137\163\150\x61\61\x5f\x70\141\163\163\167\157\x72\x64\x5f\x6d\151\x67\x72\141\x74\x69\157\156", "\160\x6f\x73\x74\137\x73\150\141\x31\x5f\160\141\163\163\x77\x6f\162\144\137\x6d\x69\147\162\x61\164\x69\x6f\156\137\165\156\163\x75\143\143\145\x73\x73\146\x75\154"]); goto UZvxj; Pqe4H: $this->trigger_events(["\160\x6f\163\x74\137\x73\150\x61\x31\x5f\160\141\x73\163\x77\157\162\144\x5f\x6d\x69\x67\162\x61\164\151\157\x6e", "\160\x6f\x73\164\x5f\x73\150\141\x31\137\x70\141\163\x73\x77\x6f\162\x64\137\155\x69\147\x72\x61\x74\x69\157\x6e\x5f\x75\x6e\x73\165\143\x63\145\x73\163\x66\165\154"]); goto iVXIt; mgc80: } }
