<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\x45\120\x41\124\x48") or exit("\116\x6f\x20\144\x69\x72\x65\143\x74\x20\163\143\162\x69\160\164\x20\x61\x63\x63\145\163\x73\x20\x61\x6c\x6c\x6f\167\x65\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto N4_vz; zurGv: $error_prefix->setAccessible(TRUE); goto C1uEJ; z7rwH: $this->error_start_delimiter = $this->config->item("\145\x72\162\x6f\162\x5f\163\164\141\162\164\137\x64\x65\x6c\x69\x6d\151\164\x65\162", "\151\157\156\x5f\141\x75\164\x68"); goto bTtkS; bPeil: $this->trigger_events("\x6d\x6f\144\145\x6c\137\143\x6f\x6e\x73\x74\162\x75\x63\164\x6f\x72"); goto k79ms; FFmHO: $this->lang->load("\x69\157\156\x5f\141\x75\x74\x68"); goto d_Wer; inuAi: $this->load->helper("\x64\141\164\x65"); goto FFmHO; zjDaw: $form_validation_class = new ReflectionClass("\103\x49\x5f\106\x6f\x72\x6d\x5f\166\141\154\151\x64\141\164\x69\x6f\x6e"); goto dUqz0; fNCh4: $this->db = $this->load->database($group_name, TRUE, TRUE); goto vASHH; ngiJM: $this->tables = $this->config->item("\x74\141\x62\x6c\x65\163", "\x69\x6f\x6e\137\x61\x75\x74\x68"); goto N7vMH; M602s: ZwyrE: goto TGCxd; FhyOL: $error_suffix->setAccessible(TRUE); goto MqS4p; TPQRW: $this->messages = []; goto uo4B0; yNFkf: $delimiters_source = $this->config->item("\144\x65\x6c\151\155\151\164\x65\162\x73\x5f\x73\x6f\x75\x72\143\145", "\151\157\x6e\137\141\x75\x74\150"); goto HTXfm; X2_kI: $this->db = $CI->db; goto Nyqur; XSagt: goto ZwyrE; goto EAsyR; C1uEJ: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto MyOqY; uo4B0: $this->errors = []; goto yNFkf; TGCxd: $this->_ion_hooks = new stdClass(); goto bPeil; bTtkS: $this->error_end_delimiter = $this->config->item("\145\x72\162\157\x72\x5f\145\156\144\x5f\x64\x65\x6c\151\155\x69\164\145\162", "\151\157\156\x5f\x61\165\164\x68"); goto XSagt; AEvY6: $this->load->helper("\x63\x6f\157\153\151\x65"); goto inuAi; dUqz0: $error_prefix = $form_validation_class->getProperty("\x5f\x65\162\162\x6f\x72\137\x70\162\145\146\151\x78"); goto zurGv; EAsyR: smmRQ: goto Igwi9; vASHH: goto HSMYZ; goto O9EI2; o1zrA: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\162\x6f\162\137\x73\x75\146\x66\x69\x78"); goto FhyOL; Nyqur: HSMYZ: goto ngiJM; fu2NO: $this->message_end_delimiter = $this->config->item("\x6d\145\163\163\141\x67\145\x5f\145\x6e\x64\x5f\x64\x65\154\151\155\151\164\145\162", "\x69\157\156\137\x61\165\x74\150"); goto z7rwH; Igwi9: $this->load->library("\146\x6f\x72\155\x5f\166\x61\154\x69\x64\141\x74\151\x6f\x6e"); goto zjDaw; s1XQV: $this->message_end_delimiter = $this->error_end_delimiter; goto M602s; MqS4p: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto s1XQV; Stq8k: $this->message_start_delimiter = $this->config->item("\x6d\x65\163\163\x61\147\x65\137\x73\x74\141\162\164\137\x64\x65\x6c\x69\155\x69\164\145\x72", "\x69\x6f\x6e\137\x61\x75\164\150"); goto fu2NO; N7vMH: $this->identity_column = $this->config->item("\x69\x64\x65\x6e\164\151\x74\171", "\x69\x6f\156\137\141\x75\x74\x68"); goto y5thy; ukZX9: $this->hash_method = $this->config->item("\150\x61\163\150\x5f\155\145\x74\x68\157\x64", "\x69\x6f\156\x5f\x61\x75\164\x68"); goto TPQRW; KSSSn: $CI =& get_instance(); goto X2_kI; qaz6B: if (empty($group_name)) { goto dSOm4; } goto fNCh4; O9EI2: dSOm4: goto KSSSn; N4_vz: $this->config->load("\151\157\x6e\137\x61\165\x74\x68", TRUE); goto AEvY6; MyOqY: $this->message_start_delimiter = $this->error_start_delimiter; goto o1zrA; d_Wer: $group_name = $this->config->item("\144\x61\164\x61\x62\141\x73\x65\x5f\147\x72\x6f\x75\x70\137\156\x61\x6d\145", "\151\157\156\137\x61\x75\164\x68"); goto qaz6B; HTXfm: if ($delimiters_source === "\146\157\x72\x6d\x5f\x76\141\154\x69\x64\x61\164\x69\x6f\156") { goto smmRQ; } goto Stq8k; y5thy: $this->join = $this->config->item("\x6a\x6f\x69\156", "\x69\x6f\x6e\137\x61\165\164\150"); goto ukZX9; k79ms: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto yACFn; DTTUX: if (!($algo !== FALSE && $params !== FALSE)) { goto HVGC7; } goto hYde_; AcjZp: $algo = $this->_get_hash_algo(); goto YZlpX; YZlpX: $params = $this->_get_hash_parameters($identity); goto DTTUX; IJUqG: rZPWE: goto AcjZp; k5yX4: return FALSE; goto fUWwg; V0f2I: HVGC7: goto k5yX4; yiWQd: return FALSE; goto IJUqG; yACFn: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto rZPWE; } goto yiWQd; hYde_: return password_hash($password, $algo, $params); goto V0f2I; fUWwg: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto pFmkX; fBmzJ: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto PtF1V; E69GC: d_aEN: goto L_Ooj; pVd0V: fN9BI: goto YAFKG; reAn3: Mrovn: goto yP8TN; PtF1V: goto fN9BI; goto reAn3; lbwzn: return FALSE; goto E69GC; L_Ooj: if (strpos($hash_password_db, "\44") === 0) { goto Mrovn; } goto fBmzJ; yP8TN: return password_verify($password, $hash_password_db); goto pVd0V; pFmkX: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto d_aEN; } goto lbwzn; YAFKG: } public function rehash_password_if_needed($hash, $identity, $password) { goto VGtPv; hSKwa: $this->trigger_events(["\x72\145\150\141\163\150\x5f\160\x61\163\163\x77\157\162\144", "\162\145\x68\x61\163\x68\x5f\160\x61\163\x73\167\x6f\x72\144\137\x75\156\x73\x75\143\x63\x65\163\163\x66\x75\x6c"]); goto Dgykz; doQ2s: if ($this->_set_password_db($identity, $password)) { goto wlXFU; } goto hSKwa; GxzGD: $params = $this->_get_hash_parameters($identity); goto gu3KK; VGtPv: $algo = $this->_get_hash_algo(); goto GxzGD; k6Ctq: if (!password_needs_rehash($hash, $algo, $params)) { goto WCJNM; } goto doQ2s; Dgykz: goto alkw_; goto t5X8Z; kbqSN: Kt11k: goto LwIu3; t5X8Z: wlXFU: goto Oi44C; Oi44C: $this->trigger_events(["\162\x65\x68\x61\163\150\x5f\x70\141\163\163\x77\157\x72\144", "\162\145\150\141\163\150\137\160\x61\163\x73\167\157\162\x64\x5f\163\x75\x63\143\145\x73\163\x66\x75\x6c"]); goto YGvQv; gu3KK: if (!($algo !== FALSE && $params !== FALSE)) { goto Kt11k; } goto k6Ctq; YGvQv: alkw_: goto DsyDz; DsyDz: WCJNM: goto kbqSN; LwIu3: } public function get_user_by_activation_code($user_code) { goto iY7rA; iY7rA: $token = $this->_retrieve_selector_validator_couple($user_code); goto uSNkU; wrrtw: return $user; goto FKLCf; FKLCf: QIdhG: goto ozzX6; ozzX6: T0zSo: goto EzLnc; EzLnc: return FALSE; goto t99wU; uSNkU: $user = $this->where("\x61\x63\x74\x69\x76\x61\x74\151\x6f\156\x5f\x73\x65\154\145\x63\x74\x6f\x72", $token->selector)->users()->row(); goto bTsRR; QNtQi: if (!$this->verify_password($token->validator, $user->activation_code)) { goto QIdhG; } goto wrrtw; bTsRR: if (!$user) { goto T0zSo; } goto QNtQi; t99wU: } public function activate($id, $code = FALSE) { goto Iy6cD; aZ1qh: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, ["\151\x64" => $id]); goto gZMOt; IJU2y: $this->set_error("\141\143\164\x69\166\141\x74\145\137\x75\156\163\165\143\143\145\x73\x73\x66\165\154"); goto rRjAp; i488a: if (!($code !== FALSE)) { goto fyP8q; } goto H6UFt; rRjAp: return FALSE; goto R7ADw; ZMQkd: $this->set_message("\141\x63\164\151\166\x61\164\x65\x5f\163\165\x63\x63\145\163\x73\146\165\x6c"); goto St6bf; H6UFt: $user = $this->get_user_by_activation_code($code); goto XpIeZ; cTkht: $data = ["\141\143\164\x69\166\x61\x74\151\x6f\x6e\137\163\145\x6c\145\x63\x74\157\162" => NULL, "\141\x63\x74\x69\166\141\164\x69\x6f\156\x5f\143\x6f\144\145" => NULL, "\141\143\x74\x69\166\x65" => 1]; goto OWbn4; DG0D_: if (!($code === FALSE || $user && $user->id === $id)) { goto rt8OX; } goto cTkht; V2CPC: $this->trigger_events(["\160\x6f\x73\x74\137\141\143\x74\151\x76\x61\x74\x65", "\160\x6f\x73\164\x5f\x61\143\164\x69\166\x61\x74\145\x5f\x75\x6e\x73\x75\143\143\x65\163\x73\146\165\x6c"]); goto IJU2y; OWbn4: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\x77\x68\x65\162\145"); goto aZ1qh; CbfCL: rt8OX: goto V2CPC; TIKjt: TzpAu: goto CbfCL; Iy6cD: $this->trigger_events("\x70\162\x65\x5f\141\143\x74\x69\x76\x61\164\x65"); goto i488a; gZMOt: if (!($this->db->affected_rows() === 1)) { goto TzpAu; } goto v0O9Y; XpIeZ: fyP8q: goto DG0D_; v0O9Y: $this->trigger_events(["\x70\157\x73\x74\x5f\x61\x63\x74\151\x76\141\x74\145", "\x70\x6f\163\x74\137\x61\143\164\151\x76\141\164\x65\137\163\x75\143\x63\x65\x73\163\146\165\x6c"]); goto ZMQkd; St6bf: return TRUE; goto TIKjt; R7ADw: } public function deactivate($id = NULL) { goto FOht0; gXa0h: $this->set_error("\144\145\141\x63\164\151\x76\x61\164\145\x5f\x63\165\x72\162\x65\x6e\164\137\165\163\145\x72\x5f\165\x6e\163\x75\143\x63\145\163\163\146\165\x6c"); goto olvJc; SSZpQ: if (!isset($id)) { goto ZzDPz; } goto vD1g1; FOht0: $this->trigger_events("\x64\145\141\143\164\x69\x76\x61\x74\x65"); goto SSZpQ; yDVzl: Juw2T: goto KAUN3; RLMjc: $data = ["\141\x63\164\151\166\141\164\x69\157\x6e\137\163\145\x6c\x65\x63\x74\x6f\162" => $token->selector, "\141\x63\x74\x69\x76\141\x74\151\x6f\156\x5f\143\x6f\x64\145" => $token->validator_hashed, "\141\143\164\151\x76\145" => 0]; goto XxMrb; olvJc: return FALSE; goto yDVzl; iHOEm: if ($return) { goto gZTs8; } goto m6Ils; x31FY: gZTs8: goto qdCxJ; NJO5y: ZzDPz: goto vB0QL; qdCxJ: $this->set_message("\x64\x65\x61\x63\x74\x69\x76\141\x74\145\137\163\165\x63\x63\x65\163\x73\146\x75\154"); goto s763O; GHRWo: E34Wc: goto G5QBK; XsW_U: return $return; goto e7vgo; G5QBK: $token = $this->_generate_selector_validator_couple(20, 40); goto atnr5; KAUN3: goto E34Wc; goto NJO5y; atnr5: $this->activation_code = $token->user_code; goto RLMjc; SWKO7: $return = $this->db->affected_rows() == 1; goto iHOEm; X1Dm5: return FALSE; goto GHRWo; m6Ils: $this->set_error("\x64\145\141\143\x74\x69\x76\141\164\x65\137\x75\x6e\x73\x75\x63\143\145\x73\163\x66\x75\x6c"); goto t1pHU; s763O: eaBNK: goto XsW_U; t1pHU: goto eaBNK; goto x31FY; vD1g1: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto Juw2T; } goto gXa0h; Zsn0D: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, ["\151\x64" => $id]); goto SWKO7; XxMrb: $this->trigger_events("\x65\170\x74\x72\141\x5f\x77\150\x65\x72\x65"); goto Zsn0D; vB0QL: $this->set_error("\x64\145\x61\x63\164\151\166\x61\164\145\137\x75\156\163\x75\143\143\145\x73\x73\x66\165\x6c"); goto X1Dm5; e7vgo: } public function clear_forgotten_password_code($identity) { goto IBiPI; mdHGr: return FALSE; goto hXRvH; m3Yoh: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto qYgdS; hXRvH: OK8jk: goto DY5tZ; qYgdS: return TRUE; goto vMA6k; DY5tZ: $data = ["\146\157\x72\147\157\x74\x74\x65\156\137\x70\x61\163\163\x77\157\x72\x64\137\163\145\x6c\x65\x63\x74\157\162" => NULL, "\146\x6f\x72\147\157\164\x74\x65\x6e\137\x70\x61\x73\x73\167\x6f\x72\x64\137\x63\157\144\145" => NULL, "\x66\x6f\162\x67\157\164\x74\145\156\137\x70\x61\x73\x73\167\x6f\x72\144\x5f\x74\151\x6d\145" => NULL]; goto m3Yoh; IBiPI: if (!empty($identity)) { goto OK8jk; } goto mdHGr; vMA6k: } public function clear_remember_code($identity) { goto PNsyF; SFoKT: return FALSE; goto eN6qF; PNsyF: if (!empty($identity)) { goto IpRNj; } goto SFoKT; eN6qF: IpRNj: goto ia7Bk; DxlM9: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, [$this->identity_column => $identity]); goto XYj54; XYj54: return TRUE; goto ruhMC; ia7Bk: $data = ["\162\x65\x6d\145\155\142\145\162\x5f\x73\x65\154\145\143\164\157\162" => NULL, "\162\145\x6d\145\x6d\142\x65\162\x5f\x63\157\x64\x65" => NULL]; goto DxlM9; ruhMC: } public function reset_password($identity, $new) { goto ES9zh; c7xv3: $this->set_error("\160\141\x73\163\167\x6f\162\144\137\143\150\141\x6e\x67\x65\x5f\x75\x6e\163\x75\143\143\x65\x73\163\x66\x75\x6c"); goto F1V7M; F1V7M: goto Vy1Uh; goto u6RKh; nTsB2: return FALSE; goto waBrr; bsnjy: if ($return) { goto wKIbN; } goto Q9_bm; u6RKh: wKIbN: goto j86YA; s26jq: Vy1Uh: goto UPW0r; waBrr: SMmr5: goto CSiWH; UPW0r: return $return; goto zl6GD; ES9zh: $this->trigger_events("\160\162\x65\x5f\143\x68\141\156\147\x65\137\x70\x61\163\x73\167\157\x72\x64"); goto d1RGE; CSiWH: $return = $this->_set_password_db($identity, $new); goto bsnjy; d1RGE: if ($this->identity_check($identity)) { goto SMmr5; } goto UBhI8; otTWN: $this->set_message("\160\141\x73\163\167\157\x72\144\x5f\143\150\x61\156\x67\x65\x5f\163\x75\143\x63\x65\163\x73\146\165\x6c"); goto s26jq; UBhI8: $this->trigger_events(["\x70\x6f\163\164\137\x63\150\x61\x6e\147\x65\x5f\x70\x61\163\x73\x77\157\162\x64", "\160\x6f\x73\x74\137\x63\150\141\x6e\147\145\137\160\x61\x73\163\x77\157\x72\x64\x5f\x75\x6e\x73\x75\x63\143\x65\163\163\x66\x75\x6c"]); goto nTsB2; Q9_bm: $this->trigger_events(["\x70\157\x73\x74\137\x63\150\x61\156\x67\145\137\x70\x61\x73\x73\x77\157\x72\x64", "\x70\x6f\163\164\x5f\x63\x68\x61\x6e\147\x65\137\160\141\x73\163\167\x6f\x72\144\137\x75\x6e\163\x75\x63\143\145\163\x73\146\165\x6c"]); goto c7xv3; j86YA: $this->trigger_events(["\x70\x6f\163\x74\x5f\x63\150\141\156\x67\145\137\160\141\x73\x73\167\157\162\144", "\x70\x6f\163\164\x5f\143\150\x61\156\147\x65\x5f\160\141\163\x73\x77\x6f\x72\144\137\163\x75\x63\143\x65\163\x73\146\x75\154"]); goto otTWN; zl6GD: } public function change_password($identity, $old, $new) { goto J9VSP; V35qQ: if (!($query->num_rows() !== 1)) { goto TB_V7; } goto wFFEx; nzV71: return FALSE; goto F53qM; yS91B: if ($result) { goto VBzZY; } goto ErNzS; dZ4yd: $this->trigger_events("\x65\170\x74\x72\141\137\x77\x68\145\x72\x65"); goto pCIp5; pCIp5: $query = $this->db->select("\151\144\x2c\40\x70\141\163\163\x77\x6f\162\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\144\145\x73\143")->get($this->tables["\x75\x73\x65\162\x73"]); goto V35qQ; R_SXi: $result = $this->_set_password_db($identity, $new); goto yS91B; ZdKcf: $this->set_error("\160\x61\163\163\167\x6f\x72\144\137\143\x68\x61\x6e\x67\x65\137\x75\x6e\163\x75\143\x63\x65\163\163\146\165\x6c"); goto nzV71; atjtw: VBzZY: goto m9ZUZ; J9VSP: $this->trigger_events("\x70\x72\145\137\x63\150\141\x6e\147\145\137\x70\x61\x73\163\167\157\162\x64"); goto dZ4yd; HAQ2S: return $result; goto LV5cf; wFFEx: $this->trigger_events(["\160\157\x73\164\x5f\x63\x68\141\x6e\x67\x65\137\x70\141\163\x73\167\157\162\x64", "\x70\157\163\x74\x5f\x63\x68\141\x6e\x67\x65\x5f\160\141\163\163\167\x6f\x72\x64\137\x75\156\163\x75\x63\143\145\x73\163\x66\x75\x6c"]); goto ZdKcf; aEF3z: if (!$this->verify_password($old, $user->password, $identity)) { goto E2VPw; } goto R_SXi; CFUrI: $this->set_message("\x70\141\x73\163\167\157\x72\x64\x5f\143\x68\x61\x6e\x67\145\x5f\163\165\x63\143\x65\x73\x73\146\165\154"); goto jSmJf; n3gBn: $this->set_error("\x70\141\163\163\167\157\x72\144\x5f\143\150\141\x6e\x67\145\137\165\156\163\x75\x63\143\x65\163\x73\146\x75\x6c"); goto w7TW2; Ir2H1: $user = $query->row(); goto aEF3z; w7TW2: goto jZmkq; goto atjtw; RQTme: return FALSE; goto zLtwJ; ErNzS: $this->trigger_events(["\160\157\163\x74\137\143\150\x61\156\x67\145\137\x70\x61\163\x73\x77\157\x72\x64", "\160\x6f\163\x74\137\143\x68\x61\156\x67\x65\137\160\x61\163\x73\x77\157\162\144\137\x75\156\x73\x75\143\143\x65\x73\x73\x66\x75\154"]); goto n3gBn; jSmJf: jZmkq: goto HAQ2S; F53qM: TB_V7: goto Ir2H1; m9ZUZ: $this->trigger_events(["\160\x6f\163\164\x5f\143\x68\x61\x6e\x67\x65\x5f\160\x61\x73\x73\167\x6f\x72\144", "\160\157\x73\164\137\x63\150\141\156\x67\145\x5f\160\x61\x73\x73\167\x6f\162\x64\x5f\163\x75\x63\143\145\163\163\146\165\x6c"]); goto CFUrI; vLnru: $this->set_error("\x70\141\163\x73\x77\157\162\144\x5f\x63\150\x61\x6e\147\x65\x5f\165\x6e\x73\x75\x63\x63\x65\x73\x73\146\165\x6c"); goto RQTme; LV5cf: E2VPw: goto vLnru; zLtwJ: } public function username_check($username = '') { goto oI7fb; Axvmk: if (!empty($username)) { goto ejim1; } goto Mn12j; aP4ky: return $this->db->where("\165\x73\x65\162\156\x61\155\145", $username)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\163"]) > 0; goto AiEDz; Tr0NB: $this->trigger_events("\145\x78\x74\x72\141\137\x77\x68\145\x72\x65"); goto aP4ky; Mn12j: return FALSE; goto j6pwf; oI7fb: $this->trigger_events("\x75\x73\145\162\x6e\141\155\145\137\x63\150\x65\x63\153"); goto Axvmk; j6pwf: ejim1: goto Tr0NB; AiEDz: } public function email_check($email = '') { goto yUYGh; rznGh: $this->trigger_events("\x65\x78\164\162\141\x5f\167\150\x65\162\x65"); goto ndu67; L502_: return FALSE; goto Ocm5p; ndu67: return $this->db->where("\145\x6d\x61\x69\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\145\x72\x73"]) > 0; goto lfYor; hhJ68: if (!empty($email)) { goto ndHmm; } goto L502_; Ocm5p: ndHmm: goto rznGh; yUYGh: $this->trigger_events("\145\155\141\x69\x6c\137\143\150\x65\x63\x6b"); goto hhJ68; lfYor: } public function identity_check($identity = '') { goto arrRV; arrRV: $this->trigger_events("\151\144\x65\x6e\x74\x69\164\171\x5f\x63\150\145\x63\153"); goto YlcG7; o8Fqf: K51NN: goto q3693; q3693: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\145\162\163"]) > 0; goto iIe5u; ovQD1: return FALSE; goto o8Fqf; YlcG7: if (!empty($identity)) { goto K51NN; } goto ovQD1; iIe5u: } public function get_user_id_from_identity($identity = '') { goto ac3DE; wMRRY: return FALSE; goto jmR47; zdAvH: $user = $query->row(); goto HD48F; HD48F: return $user->id; goto aEBAu; b2xem: PY5i3: goto zdAvH; MGvhZ: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\x72\x73"]); goto t7wdl; ac3DE: if (!empty($identity)) { goto Fl2HV; } goto wMRRY; t7wdl: if (!($query->num_rows() !== 1)) { goto PY5i3; } goto iw5JW; iw5JW: return FALSE; goto b2xem; jmR47: Fl2HV: goto MGvhZ; aEBAu: } public function forgotten_password($identity) { goto ajIlv; o0MJW: $this->trigger_events("\x65\x78\164\x72\x61\137\x77\150\x65\x72\x65"); goto Pky4w; VWFhE: JPZi8: goto tnD25; U_a2P: QuAeN: goto fejKS; Pky4w: $this->db->update($this->tables["\x75\x73\145\162\163"], $update, [$this->identity_column => $identity]); goto QGcuM; rNunu: $this->trigger_events(["\160\157\x73\164\x5f\146\x6f\162\x67\x6f\x74\164\x65\156\137\160\x61\x73\x73\x77\157\x72\144", "\x70\157\x73\164\x5f\146\157\x72\147\x6f\x74\x74\x65\156\137\160\141\163\x73\167\157\162\x64\x5f\x75\156\163\165\143\143\x65\163\163\x66\x75\154"]); goto Q9x77; QGcuM: if ($this->db->affected_rows() === 1) { goto JPZi8; } goto KnDYS; Oi_SC: return FALSE; goto k3Zru; Q9x77: return FALSE; goto U_a2P; GJwDr: ekxKP: goto W9Y9K; ajIlv: if (!empty($identity)) { goto QuAeN; } goto rNunu; fejKS: $token = $this->_generate_selector_validator_couple(20, 80); goto oLVbx; FPKyK: return $token->user_code; goto GJwDr; KnDYS: $this->trigger_events(["\x70\x6f\x73\164\x5f\x66\x6f\162\147\157\x74\164\x65\x6e\137\x70\141\x73\x73\167\157\x72\x64", "\160\157\x73\164\137\x66\x6f\162\147\x6f\x74\164\145\156\x5f\160\141\x73\x73\167\157\x72\x64\137\x75\156\163\165\143\143\145\163\x73\146\x75\x6c"]); goto Oi_SC; oLVbx: $update = ["\x66\x6f\162\x67\x6f\164\x74\x65\x6e\137\x70\141\163\163\167\x6f\x72\x64\x5f\x73\145\154\145\143\164\x6f\162" => $token->selector, "\146\157\162\147\x6f\164\164\145\156\x5f\x70\141\x73\163\167\x6f\x72\x64\x5f\x63\x6f\144\145" => $token->validator_hashed, "\146\x6f\162\147\x6f\164\164\145\156\x5f\x70\141\163\163\x77\x6f\x72\x64\137\164\x69\155\145" => time()]; goto o0MJW; k3Zru: goto ekxKP; goto VWFhE; tnD25: $this->trigger_events(["\x70\x6f\x73\164\137\x66\157\162\147\x6f\164\164\x65\x6e\137\160\141\163\163\x77\157\162\x64", "\160\157\163\164\137\146\x6f\x72\x67\x6f\x74\164\x65\x6e\137\x70\x61\163\x73\167\157\x72\x64\137\163\165\x63\143\x65\x73\163\x66\x75\154"]); goto FPKyK; W9Y9K: } public function get_user_by_forgotten_password_code($user_code) { goto CAEX5; QmrJc: return $user; goto jQiTl; GQ2Yi: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto UzXQI; } goto QmrJc; CAEX5: $token = $this->_retrieve_selector_validator_couple($user_code); goto XKQ3K; MglfQ: WpPM3: goto en_eE; jQiTl: UzXQI: goto MglfQ; en_eE: return FALSE; goto pZi50; qak3C: if (!$user) { goto WpPM3; } goto GQ2Yi; XKQ3K: $user = $this->where("\x66\x6f\x72\147\x6f\x74\x74\145\x6e\x5f\x70\x61\x73\x73\167\x6f\x72\144\x5f\x73\x65\154\145\x63\164\157\x72", $token->selector)->users()->row(); goto qak3C; pZi50: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto iRFE5; wunER: $data = [$this->identity_column => $identity, "\x75\163\x65\x72\x6e\141\155\145" => $identity, "\x70\x61\163\163\167\x6f\x72\144" => $password, "\x65\x6d\x61\151\154" => $email, "\x69\160\x5f\141\x64\x64\x72\145\163\163" => $ip_address, "\x63\x72\x65\141\164\145\144\137\x6f\x6e" => time(), "\x61\x63\x74\x69\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto GAwQ_; vsZlu: $default_group = $query; goto rxq0j; TCBSF: $this->trigger_events("\160\157\163\164\x5f\x72\145\147\x69\x73\x74\x65\162"); goto Od93e; auY28: klSG9: goto xD1Zi; alpy0: $manual_activation = $this->config->item("\155\141\156\x75\x61\x6c\137\x61\x63\x74\151\x76\x61\x74\x69\157\x6e", "\151\x6f\156\137\141\x75\x74\150"); goto ZULqJ; BRzPh: $this->set_error("\x61\x63\143\157\165\156\164\137\143\162\145\141\x74\151\x6f\x6e\137\165\156\163\x75\143\143\x65\163\163\x66\165\154"); goto fEYhj; xD1Zi: QSMQ7: goto TCBSF; wvWjQ: return FALSE; goto TEKza; NMNfj: if (!(!$this->config->item("\x64\145\146\x61\165\x6c\x74\x5f\x67\x72\x6f\165\160", "\x69\x6f\156\137\x61\165\x74\150") && empty($groups))) { goto Eebbh; } goto uuN1s; wgxBq: la2f3: goto SKg_I; fRnw4: $this->set_error("\x61\x63\143\x6f\x75\x6e\164\137\143\162\145\141\x74\151\157\x6e\x5f\x64\x75\x70\x6c\151\143\x61\164\x65\x5f\x69\144\145\x6e\x74\x69\164\x79"); goto wvWjQ; F134D: Eebbh: goto SabOd; TEKza: Ote1w: goto YqKhU; reXhH: abt7q: goto wunER; ZULqJ: if ($this->identity_check($identity)) { goto CK9v4; } goto NMNfj; GAwQ_: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\x65\x72\163"], $additional_data), $data); goto axzhn; cIPsG: return FALSE; goto I_W2C; YSuBv: $this->db->insert($this->tables["\165\x73\145\162\x73"], $user_data); goto kbH97; cUbw2: if (!($password === FALSE)) { goto abt7q; } goto BRzPh; I_W2C: uUdkP: goto vsZlu; QrPcw: $password = $this->hash_password($password); goto cUbw2; SabOd: goto Ote1w; goto Ro_b7; rxq0j: $ip_address = $this->input->ip_address(); goto QrPcw; kbH97: $id = $this->db->insert_id($this->tables["\165\163\x65\x72\163"] . "\x5f\151\x64\x5f\x73\145\x71"); goto y6sOb; RnsRH: $this->set_error("\141\143\x63\157\165\x6e\164\137\x63\162\145\141\164\151\157\x6e\137\x69\156\x76\141\154\x69\x64\x5f\x64\145\146\x61\x75\x6c\x74\x5f\x67\162\x6f\x75\x70"); goto cIPsG; Od93e: return isset($id) ? $id : FALSE; goto jkEq4; YqKhU: $query = $this->db->get_where($this->tables["\x67\162\x6f\165\160\163"], ["\156\141\x6d\x65" => $this->config->item("\144\145\146\141\165\x6c\164\137\147\162\x6f\x75\x70", "\151\157\x6e\137\x61\165\x74\x68")], 1)->row(); goto r2qE7; pKi4G: $groups[] = $default_group->id; goto wgxBq; SKg_I: if (empty($groups)) { goto QSMQ7; } goto sKqnq; iRFE5: $this->trigger_events("\160\x72\x65\137\162\145\147\x69\x73\x74\x65\162"); goto alpy0; fEYhj: return FALSE; goto reXhH; axzhn: $this->trigger_events("\x65\x78\164\x72\x61\x5f\x73\x65\164"); goto YSuBv; uuN1s: $this->set_error("\x61\x63\143\157\165\x6e\164\x5f\143\x72\145\141\x74\151\x6f\x6e\x5f\x6d\x69\163\163\x69\156\x67\x5f\144\x65\x66\x61\x75\154\164\x5f\147\162\157\x75\160"); goto gXthk; r2qE7: if (!(!isset($query->id) && empty($groups))) { goto uUdkP; } goto RnsRH; gXthk: return FALSE; goto F134D; Ro_b7: CK9v4: goto fRnw4; sKqnq: foreach ($groups as $group) { $this->add_to_group($group, $id); DkjGN: } goto auY28; y6sOb: if (!(isset($default_group->id) && empty($groups))) { goto la2f3; } goto pKi4G; jkEq4: } public function login($identity, $password, $remember = FALSE) { goto aALKF; JrWCF: ef4tX: goto FUSkF; WaYac: $this->trigger_events("\160\x6f\163\164\x5f\x6c\x6f\x67\151\156\x5f\165\x6e\x73\x75\x63\x63\x65\x73\x73\x66\165\154"); goto g3GAq; YSHgf: return FALSE; goto M0lJP; XvyOq: $this->remember_user($identity); goto Id3D0; SmkOh: $this->rehash_password_if_needed($user->password, $identity, $password); goto B6C5l; ZfEI2: if (!($query->num_rows() === 1)) { goto PMVxw; } goto dAFk3; tG0YS: $this->set_message("\154\157\x67\151\156\137\163\165\143\143\145\x73\163\x66\165\x6c"); goto L5ADH; aALKF: $this->trigger_events("\160\x72\x65\x5f\x6c\157\147\151\156"); goto VrF5L; AyLOX: $query = $this->db->select($this->identity_column . "\54\x20\x65\155\x61\151\x6c\x2c\40\x69\x64\54\40\x70\141\163\x73\167\x6f\x72\144\x2c\x20\x61\x63\x74\151\x76\145\x2c\x20\154\141\x73\x74\x5f\154\x6f\x67\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\145\163\143")->get($this->tables["\x75\163\x65\162\x73"]); goto vam1r; jwdRQ: A6_dB: goto XvyOq; cWENQ: $this->set_error("\154\x6f\x67\x69\156\137\x74\x69\155\x65\157\x75\164"); goto YSHgf; Q1ZGk: $this->hash_password($password); goto WDE2p; abOPl: return FALSE; goto JrWCF; OcfdK: $this->clear_login_attempts($identity); goto UT4gs; ggHLU: goto DDLew; goto jwdRQ; SfnCm: if (!$this->config->item("\x72\x65\x6d\x65\x6d\x62\x65\162\x5f\165\163\145\162\x73", "\151\x6f\x6e\x5f\141\165\164\150")) { goto GVn8f; } goto lIWZY; Y5yzS: jtWz3: goto dDxHj; dvyiO: $this->trigger_events(["\160\157\x73\164\x5f\x6c\x6f\147\x69\156", "\x70\157\x73\164\x5f\x6c\157\x67\x69\156\x5f\x73\x75\x63\x63\145\163\x73\146\165\x6c"]); goto tG0YS; vam1r: if (!$this->is_max_login_attempts_exceeded($identity)) { goto NwCHx; } goto ni2u9; Ixyxl: return FALSE; goto Y5yzS; Db5gD: GVn8f: goto SmkOh; HwdTO: $this->set_error("\154\x6f\147\x69\156\137\x75\156\x73\x75\x63\x63\145\163\x73\x66\165\x6c"); goto abOPl; M0lJP: NwCHx: goto ZfEI2; dAFk3: $user = $query->row(); goto cy7u8; j9E0v: $this->clear_remember_code($identity); goto ggHLU; g3GAq: $this->set_error("\154\x6f\x67\151\x6e\x5f\165\x6e\x73\165\143\143\x65\x73\163\146\x75\154"); goto ZfrxH; WeCK9: r6FbD: goto j3Wh0; lIWZY: if ($remember) { goto A6_dB; } goto j9E0v; ru1oX: $this->trigger_events("\x70\x6f\x73\164\137\154\157\147\x69\x6e\137\165\156\163\165\143\143\x65\x73\x73\x66\165\x6c"); goto cWENQ; j3Wh0: PMVxw: goto Q1ZGk; FUSkF: $this->trigger_events("\145\x78\164\x72\x61\137\x77\x68\x65\162\145"); goto AyLOX; j1Cob: $this->trigger_events("\x70\157\163\164\x5f\x6c\157\x67\x69\x6e\137\165\156\x73\x75\x63\143\x65\163\x73\146\x75\154"); goto jMfaS; WDE2p: $this->increase_login_attempts($identity); goto WaYac; ZfrxH: return FALSE; goto oZ_n1; jMfaS: $this->set_error("\154\157\x67\x69\x6e\137\x75\156\163\165\143\143\145\x73\x73\x66\165\x6c\x5f\156\157\x74\x5f\141\143\x74\x69\166\145"); goto Ixyxl; eGAWh: $this->update_last_login($user->id); goto OcfdK; cy7u8: if (!$this->verify_password($password, $user->password, $identity)) { goto r6FbD; } goto oKKT3; oKKT3: if (!($user->active == 0)) { goto jtWz3; } goto j1Cob; Id3D0: DDLew: goto Db5gD; L5ADH: return TRUE; goto WeCK9; UT4gs: $this->clear_forgotten_password_code($identity); goto SfnCm; VrF5L: if (!(empty($identity) || empty($password))) { goto ef4tX; } goto HwdTO; B6C5l: $this->session->sess_regenerate(FALSE); goto dvyiO; ni2u9: $this->hash_password($password); goto ru1oX; dDxHj: $this->set_session($user); goto eGAWh; oZ_n1: } public function recheck_session() { goto KmNfn; Z92xt: return FALSE; goto LbNDK; xfU30: return (bool) $this->session->userdata("\151\144\x65\156\x74\151\164\171"); goto Z6mgH; D002S: $this->session->set_userdata("\154\x61\163\x74\137\x63\x68\x65\x63\153", time()); goto ltYnx; LbNDK: goto i6RIg; goto Uu1G_; sG7b0: $identity = $this->config->item("\151\144\145\x6e\x74\x69\x74\x79", "\x69\x6f\x6e\x5f\x61\165\164\x68"); goto OMRDu; jXQsB: $last_login = $this->session->userdata("\154\141\163\164\137\x63\x68\x65\x63\x6b"); goto jkZKe; OMRDu: $this->session->unset_userdata([$identity, "\151\x64", "\165\x73\145\162\137\x69\x64"]); goto Z92xt; Uu1G_: PTUps: goto D002S; jkZKe: if (!($last_login + $recheck < time())) { goto Z8jeO; } goto DTNbS; DTNbS: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\144\x65\156\164\151\x74\x79"), "\x61\x63\x74\x69\166\x65" => "\61"])->limit(1)->order_by("\x69\x64", "\x64\x65\x73\x63")->get($this->tables["\x75\x73\145\162\x73"]); goto gNxLf; X3PF2: if (!($recheck !== 0)) { goto gogjF; } goto jXQsB; ltYnx: i6RIg: goto YVo9e; YVo9e: Z8jeO: goto cPK1r; KmNfn: $recheck = NULL !== $this->config->item("\162\145\143\x68\145\143\x6b\x5f\164\151\x6d\145\x72", "\x69\157\x6e\137\141\x75\164\150") ? $this->config->item("\x72\145\143\150\x65\143\x6b\x5f\x74\151\x6d\x65\x72", "\151\x6f\x6e\x5f\141\165\x74\150") : 0; goto X3PF2; uT7Uy: $this->trigger_events("\154\157\x67\x6f\x75\164"); goto sG7b0; cPK1r: gogjF: goto xfU30; gNxLf: if ($query->num_rows() === 1) { goto PTUps; } goto uT7Uy; Z6mgH: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto kXwy0; m_0NL: if (!($max_attempts > 0)) { goto I5Lms; } goto sAAjR; sAAjR: $attempts = $this->get_attempts_num($identity, $ip_address); goto M8yBd; IGESK: LlpL9: goto Xfyob; E4NY2: $max_attempts = $this->config->item("\x6d\141\x78\151\x6d\x75\155\137\x6c\157\147\151\x6e\137\x61\164\x74\145\x6d\160\164\x73", "\151\x6f\156\x5f\x61\x75\x74\x68"); goto m_0NL; jLYz8: I5Lms: goto IGESK; kXwy0: if (!$this->config->item("\164\162\141\143\153\x5f\x6c\x6f\147\x69\x6e\x5f\141\x74\x74\145\x6d\x70\164\x73", "\x69\157\x6e\x5f\x61\x75\x74\x68")) { goto LlpL9; } goto E4NY2; Xfyob: return FALSE; goto sKg_n; M8yBd: return $attempts >= $max_attempts; goto jLYz8; sKg_n: } public function get_attempts_num($identity, $ip_address = NULL) { goto GTAFL; we2k3: if (isset($ip_address)) { goto zcrBf; } goto zIBPr; tx6Ey: $this->db->select("\61", FALSE); goto JJlp0; GTAFL: if (!$this->config->item("\164\x72\x61\143\x6b\x5f\154\157\147\151\x6e\x5f\141\x74\x74\x65\x6d\160\x74\163", "\151\x6f\156\x5f\141\165\164\x68")) { goto f4M6q; } goto tx6Ey; xsPKu: $this->db->where("\x74\x69\x6d\x65\x20\76", time() - $this->config->item("\154\x6f\143\153\157\165\x74\x5f\x74\x69\155\x65", "\x69\x6f\156\x5f\141\165\x74\x68"), FALSE); goto BS_Nz; pJhrd: return $qres->num_rows(); goto f1FyL; JJlp0: $this->db->where("\154\157\147\x69\156", $identity); goto YLX7c; eI0B2: $this->db->where("\x69\x70\137\x61\144\x64\x72\145\x73\x73", $ip_address); goto O9OuI; O9OuI: AIKCc: goto xsPKu; f1FyL: f4M6q: goto rAIW8; zIBPr: $ip_address = $this->input->ip_address(); goto ZQinF; YLX7c: if (!$this->config->item("\164\162\x61\143\153\137\x6c\x6f\147\x69\x6e\137\x69\x70\137\141\144\144\162\145\163\163", "\151\x6f\x6e\x5f\141\165\164\150")) { goto AIKCc; } goto we2k3; ZQinF: zcrBf: goto eI0B2; BS_Nz: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\x6e\x5f\x61\x74\x74\x65\155\x70\x74\163"]); goto pJhrd; rAIW8: return 0; goto XEnhC; XEnhC: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto AUG1P; f2YmL: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\156\x5f\x61\164\164\145\155\160\x74\x73"], 1); goto e4pL2; urUDM: if (isset($ip_address)) { goto f_T8_; } goto zBHii; AUG1P: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\x6c\157\x67\x69\x6e\x5f\x61\164\164\145\x6d\x70\x74\163", "\x69\157\x6e\x5f\141\165\164\x68")) { goto yqFIr; } goto VqacD; VqacD: $this->db->select("\x74\x69\155\x65"); goto qRyCY; zBHii: $ip_address = $this->input->ip_address(); goto HA37h; EY1Ce: yqFIr: goto EDQAt; HA37h: f_T8_: goto Hdd1l; EDQAt: return 0; goto L5yel; gmZLe: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\x6f\x67\x69\x6e\x5f\x69\160\137\x61\144\144\x72\x65\163\163", "\151\x6f\156\x5f\x61\x75\164\150")) { goto zYYkk; } goto urUDM; e4pL2: if (!($qres->num_rows() > 0)) { goto xqq_4; } goto ggobL; V6AO7: zYYkk: goto VP3Hs; ggobL: return $qres->row()->time; goto plMRu; qRyCY: $this->db->where("\x6c\157\147\x69\156", $identity); goto gmZLe; Hdd1l: $this->db->where("\x69\x70\x5f\x61\x64\x64\162\145\x73\x73", $ip_address); goto V6AO7; plMRu: xqq_4: goto EY1Ce; VP3Hs: $this->db->order_by("\x69\x64", "\144\x65\163\x63"); goto f2YmL; L5yel: } public function get_last_attempt_ip($identity) { goto haedw; jSNla: $this->db->select("\151\160\137\x61\144\144\162\x65\163\163"); goto Ga1Ga; YqkdX: return $qres->row()->ip_address; goto Hwbe8; Hwbe8: TdQyC: goto U_wLW; U_wLW: Kde1f: goto Rc4xq; Ga1Ga: $this->db->where("\154\x6f\147\151\156", $identity); goto DzpAX; dFw9x: if (!($qres->num_rows() > 0)) { goto TdQyC; } goto YqkdX; haedw: if (!($this->config->item("\x74\162\141\x63\153\x5f\154\157\x67\x69\x6e\x5f\x61\164\x74\145\155\160\164\163", "\151\x6f\x6e\x5f\x61\x75\164\150") && $this->config->item("\164\162\x61\x63\153\x5f\x6c\157\x67\x69\x6e\137\151\160\x5f\141\144\x64\x72\x65\x73\x73", "\151\157\156\x5f\x61\x75\164\150"))) { goto Kde1f; } goto jSNla; Rc4xq: return ''; goto hzb6O; DROSF: $qres = $this->db->get($this->tables["\154\x6f\147\x69\156\137\x61\164\x74\x65\x6d\x70\164\x73"], 1); goto dFw9x; DzpAX: $this->db->order_by("\x69\x64", "\144\145\x73\143"); goto DROSF; hzb6O: } public function increase_login_attempts($identity) { goto vUwYD; dnASt: return $this->db->insert($this->tables["\154\x6f\147\x69\x6e\137\x61\164\164\x65\x6d\x70\164\x73"], $data); goto MLiRV; Nmvq3: YP9hF: goto dnASt; KqOG0: $data["\151\160\x5f\x61\x64\144\162\145\163\x73"] = $this->input->ip_address(); goto Nmvq3; OM3rc: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\157\147\x69\156\x5f\x69\x70\x5f\x61\144\x64\x72\x65\163\x73", "\151\157\156\x5f\141\x75\164\x68")) { goto YP9hF; } goto KqOG0; XRvp3: return FALSE; goto VfVLo; MLiRV: x1ll_: goto XRvp3; Q3oJA: $data = ["\151\160\x5f\x61\x64\144\x72\x65\163\x73" => '', "\154\157\x67\x69\x6e" => $identity, "\164\x69\155\x65" => time()]; goto OM3rc; vUwYD: if (!$this->config->item("\164\162\141\143\x6b\137\x6c\157\147\151\x6e\137\141\164\x74\x65\x6d\x70\164\x73", "\151\157\x6e\137\141\x75\x74\x68")) { goto x1ll_; } goto Q3oJA; VfVLo: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto wOM0E; j10SN: if (isset($ip_address)) { goto LJlZ9; } goto dSALD; JP0Kv: TiWgU: goto PPYxh; PPYxh: return FALSE; goto z5LDz; wOM0E: if (!$this->config->item("\x74\162\141\x63\x6b\137\154\157\147\x69\156\x5f\141\x74\x74\145\x6d\160\x74\x73", "\151\x6f\x6e\x5f\141\165\164\150")) { goto TiWgU; } goto HIpbS; dSALD: $ip_address = $this->input->ip_address(); goto tkXu5; CW_sl: $this->db->or_where("\164\x69\x6d\145\40\74", time() - $old_attempts_expire_period, FALSE); goto tMGPQ; IftoD: PoC2w: goto CW_sl; e1UxU: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto zI6Xl; xxzNN: $this->db->where("\x69\160\x5f\x61\144\x64\162\x65\x73\x73", $ip_address); goto IftoD; HIpbS: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\x63\153\157\x75\164\137\164\151\x6d\x65", "\x69\x6f\x6e\x5f\141\x75\x74\150")); goto e1UxU; tMGPQ: return $this->db->delete($this->tables["\154\157\147\151\156\x5f\141\164\164\145\155\x70\164\163"]); goto JP0Kv; zI6Xl: if (!$this->config->item("\164\162\x61\x63\x6b\137\x6c\x6f\x67\x69\x6e\x5f\151\160\x5f\x61\x64\x64\162\145\x73\x73", "\151\x6f\156\137\141\165\x74\x68")) { goto PoC2w; } goto j10SN; tkXu5: LJlZ9: goto xxzNN; z5LDz: } public function limit($limit) { goto MhiXR; MhiXR: $this->trigger_events("\154\x69\155\151\x74"); goto UFRKm; UFRKm: $this->_ion_limit = $limit; goto JQ2qa; JQ2qa: return $this; goto qi5cU; qi5cU: } public function offset($offset) { goto cFPTZ; wnIKJ: return $this; goto O6ITA; r_fBz: $this->_ion_offset = $offset; goto wnIKJ; cFPTZ: $this->trigger_events("\x6f\x66\146\x73\x65\164"); goto r_fBz; O6ITA: } public function where($where, $value = NULL) { goto Z10MX; ThCym: return $this; goto X717p; agiYF: cAvkg: goto AFlDJ; c81Eb: if (is_array($where)) { goto cAvkg; } goto JpF0k; AFlDJ: array_push($this->_ion_where, $where); goto ThCym; JpF0k: $where = [$where => $value]; goto agiYF; Z10MX: $this->trigger_events("\x77\150\145\x72\x65"); goto c81Eb; X717p: } public function like($like, $value = NULL, $position = "\142\x6f\164\150") { goto UiF9o; FB7_V: array_push($this->_ion_like, ["\x6c\151\x6b\x65" => $like, "\x76\141\x6c\165\x65" => $value, "\160\157\x73\151\x74\151\x6f\156" => $position]); goto j3ppM; UiF9o: $this->trigger_events("\x6c\151\x6b\x65"); goto FB7_V; j3ppM: return $this; goto I33K5; I33K5: } public function select($select) { goto o_FnT; AFB8V: $this->_ion_select[] = $select; goto g8dQb; g8dQb: return $this; goto rgG15; o_FnT: $this->trigger_events("\x73\x65\x6c\145\143\x74"); goto AFB8V; rgG15: } public function order_by($by, $order = "\144\145\163\x63") { goto honcU; J_s2E: $this->_ion_order = $order; goto xb3CW; honcU: $this->trigger_events("\157\162\x64\145\x72\137\142\171"); goto RwVYu; RwVYu: $this->_ion_order_by = $by; goto J_s2E; xb3CW: return $this; goto eRfD0; eRfD0: } public function row() { goto jo_0V; jo_0V: $this->trigger_events("\162\157\167"); goto QTkI8; QTkI8: $row = $this->response->row(); goto gdp_b; gdp_b: return $row; goto xqakg; xqakg: } public function row_array() { goto NWNQ4; NWNQ4: $this->trigger_events(["\x72\x6f\167", "\162\157\x77\x5f\141\x72\x72\141\171"]); goto D3h3r; yu0gn: return $row; goto SUfPE; D3h3r: $row = $this->response->row_array(); goto yu0gn; SUfPE: } public function result() { goto bQeAd; FL83x: return $result; goto aYPxa; bQeAd: $this->trigger_events("\x72\x65\x73\x75\154\164"); goto Zizva; Zizva: $result = $this->response->result(); goto FL83x; aYPxa: } public function result_array() { goto DUMNB; BksX1: return $result; goto pKHSR; DUMNB: $this->trigger_events(["\162\145\x73\165\x6c\164", "\x72\145\x73\165\x6c\x74\137\x61\x72\162\x61\x79"]); goto bTWbs; bTWbs: $result = $this->response->result_array(); goto BksX1; pKHSR: } public function num_rows() { goto vZ0gi; vZ0gi: $this->trigger_events(["\x6e\x75\155\137\162\x6f\167\x73"]); goto D4pBT; lgoQJ: return $result; goto VTvCy; D4pBT: $result = $this->response->num_rows(); goto lgoQJ; VTvCy: } public function users($groups = NULL) { goto Bb7P8; KIux2: $this->db->where_in($this->tables["\147\162\157\x75\160\x73"] . "\56\x6e\x61\155\x65", $group_names); goto FJCsD; fGyPF: jOZzx: goto HaXNm; UnsFi: $this->db->join($this->tables["\x67\162\x6f\165\160\x73"], $this->tables["\165\x73\145\x72\163\x5f\x67\162\x6f\x75\160\x73"] . "\x2e" . $this->join["\x67\162\x6f\165\160\163"] . "\40\x3d\40" . $this->tables["\x67\162\157\165\x70\163"] . "\56\151\x64", "\151\x6e\x6e\145\x72"); goto KIux2; JmSES: goto w9hx3; goto or5wu; diSsY: $this->db->{$or_where_in}($this->tables["\x75\163\145\162\x73\137\x67\162\x6f\165\x70\x73"] . "\56" . $this->join["\147\162\x6f\x75\x70\163"], $group_ids); goto vYWYC; B96yg: $this->_ion_order_by = NULL; goto fGyPF; HZC22: $groups = [$groups]; goto v_Km4; Bb7P8: $this->trigger_events("\165\163\145\162\163"); goto d8GLu; mLhgS: Fy2CV: goto AD93K; SJE2l: b1Aba: goto TVkwL; AD93K: $group_ids = []; goto uP4MG; KO7Jv: $this->_ion_limit = NULL; goto VHlLJ; YKUDR: if (empty($group_ids)) { goto M1C_7; } goto diSsY; m881P: nJDLW: goto vwsJX; x92oW: if (!isset($this->_ion_limit)) { goto B8e7V; } goto ZOMOR; pkWzC: if (!isset($groups)) { goto R0efm; } goto NNYKH; fzmEv: return $this; goto Pmm25; ZOMOR: $this->db->limit($this->_ion_limit); goto wAy8A; jOw2H: a4m3N: goto TrH7r; Iq5Ep: mSc7G: goto qxlK7; DIYkE: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto jOZzx; } goto lIT8T; xx4qV: $this->_ion_select = []; goto rWfgP; v_Km4: klMrC: goto V1_ur; BZUQT: rFGct: goto xx4qV; DldBD: Pzv1q: goto DIYkE; Z74eI: foreach ($this->_ion_select as $select) { $this->db->select($select); u8PbU: } goto BZUQT; NNYKH: if (is_array($groups)) { goto klMrC; } goto HZC22; CqN0l: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto X9iK4; } goto NKFVu; NKFVu: foreach ($this->_ion_where as $where) { $this->db->where($where); lp_Dw: } goto Iq5Ep; VHlLJ: $this->_ion_offset = NULL; goto DldBD; Bw6a7: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\x6b\x65"], $like["\x76\141\154\x75\x65"], $like["\160\157\163\151\x74\151\x6f\156"]); ZHQz9: } goto m881P; SZMwn: R0efm: goto WW_gy; uxYgF: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto a4m3N; } goto Bw6a7; yRj3E: $this->db->join($this->tables["\165\x73\145\x72\163\137\147\162\157\165\x70\x73"], $this->tables["\x75\x73\145\162\163\137\147\162\x6f\x75\x70\163"] . "\x2e" . $this->join["\165\x73\x65\162\163"] . "\x3d" . $this->tables["\x75\163\145\162\x73"] . "\56\151\x64", "\x69\156\x6e\x65\x72"); goto mLhgS; vf7A7: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\137\167\x68\x65\x72\145\137\151\x6e" : "\x77\150\x65\162\x65\x5f\151\x6e"; goto QZVxd; vwsJX: $this->_ion_like = []; goto jOw2H; sgIDg: foreach ($groups as $group) { goto H1gp2; fvH1K: OKnQ_: goto nRGa0; R2hPi: z7Rff: goto ihLzY; C0dzK: $group_names[] = $group; goto gZu3U; nRGa0: PQATL: goto QMuLG; gZu3U: goto OKnQ_; goto R2hPi; H1gp2: if (is_numeric($group)) { goto z7Rff; } goto C0dzK; ihLzY: $group_ids[] = $group; goto fvH1K; QMuLG: } goto nKXiU; uP4MG: $group_names = []; goto sgIDg; Vhqus: X9iK4: goto uxYgF; wAy8A: $this->_ion_limit = NULL; goto hLH21; rWfgP: w9hx3: goto pkWzC; FJCsD: DZp8R: goto YKUDR; or5wu: cGyis: goto Z74eI; nKXiU: dt0pf: goto vf7A7; RAr79: $this->_ion_order = NULL; goto B96yg; pcKb1: goto Pzv1q; goto SJE2l; d8GLu: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto cGyis; } goto dCGvy; zck2l: $this->db->distinct(); goto yRj3E; V1_ur: if (!(isset($groups) && !empty($groups))) { goto Fy2CV; } goto zck2l; HaXNm: $this->response = $this->db->get($this->tables["\165\x73\145\162\x73"]); goto fzmEv; WW_gy: $this->trigger_events("\145\170\x74\162\x61\x5f\167\x68\x65\x72\x65"); goto CqN0l; TrH7r: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto b1Aba; } goto x92oW; vYWYC: M1C_7: goto SZMwn; qxlK7: $this->_ion_where = []; goto Vhqus; TVkwL: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto KO7Jv; QZVxd: if (empty($group_names)) { goto DZp8R; } goto UnsFi; hLH21: B8e7V: goto pcKb1; dCGvy: $this->db->select([$this->tables["\165\x73\145\162\x73"] . "\x2e\x2a", $this->tables["\x75\163\145\x72\163"] . "\x2e\151\144\40\141\x73\x20\x69\144", $this->tables["\x75\163\x65\x72\x73"] . "\x2e\151\x64\x20\141\163\40\165\x73\145\162\x5f\151\144"]); goto JmSES; lIT8T: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto RAr79; Pmm25: } public function user($id = NULL) { goto lLPo7; FJj71: $this->where($this->tables["\165\x73\x65\x72\163"] . "\56\151\x64", $id); goto SuKhd; wW4YJ: $id = isset($id) ? $id : $this->session->userdata("\165\163\x65\x72\x5f\x69\144"); goto TOvP1; vqOfX: return $this; goto Xcg_O; B2MBA: $this->order_by($this->tables["\165\x73\145\162\x73"] . "\x2e\x69\144", "\144\x65\163\x63"); goto FJj71; SuKhd: $this->users(); goto vqOfX; lLPo7: $this->trigger_events("\x75\163\x65\x72"); goto wW4YJ; TOvP1: $this->limit(1); goto B2MBA; Xcg_O: } public function get_users_groups($id = FALSE) { goto cQLhX; zMKJ3: return $this->db->select($this->tables["\165\163\x65\162\163\137\x67\x72\x6f\165\x70\x73"] . "\x2e" . $this->join["\147\162\x6f\165\x70\163"] . "\x20\141\x73\x20\x69\144\54\x20" . $this->tables["\147\x72\x6f\165\x70\x73"] . "\x2e\x6e\141\155\x65\x2c\40" . $this->tables["\x67\x72\x6f\x75\x70\163"] . "\x2e\144\145\x73\x63\162\151\160\x74\x69\157\x6e")->where($this->tables["\x75\x73\x65\x72\163\137\147\x72\x6f\165\160\163"] . "\x2e" . $this->join["\165\163\x65\162\x73"], $id)->join($this->tables["\x67\162\157\x75\160\x73"], $this->tables["\165\163\145\x72\x73\137\x67\x72\x6f\165\x70\163"] . "\x2e" . $this->join["\147\162\157\165\160\x73"] . "\x3d" . $this->tables["\x67\162\x6f\x75\x70\163"] . "\56\151\x64")->get($this->tables["\165\x73\x65\162\x73\137\x67\162\x6f\165\160\x73"]); goto gQ0_T; cQLhX: $this->trigger_events("\x67\145\x74\x5f\x75\x73\145\x72\x73\137\147\x72\157\165\160"); goto bATLJ; bATLJ: $id || ($id = $this->session->userdata("\x75\163\145\x72\x5f\151\x64")); goto zMKJ3; gQ0_T: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto LzokT; PEycU: if (is_array($check_group)) { goto UlX0s; } goto SjXrR; M7puO: B_ZPz: goto u0T0s; L8v8o: if (isset($this->_cache_user_in_group[$id])) { goto B_ZPz; } goto k69M4; bp3ds: UlX0s: goto L8v8o; aMjcG: goto CYSRV; goto M7puO; qQFl0: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; ohTxN: } goto pcFST; tDmr9: CYSRV: goto TdC9G; Hzs6i: $this->_cache_user_in_group[$id] = $groups_array; goto aMjcG; pcFST: v8NE5: goto Hzs6i; SjXrR: $check_group = [$check_group]; goto bp3ds; md50p: return $check_all; goto FBEHU; JAPSu: r_ulx: goto md50p; LzokT: $this->trigger_events("\x69\156\x5f\147\162\x6f\x75\160"); goto t1JWr; GlluI: $groups_array = []; goto qQFl0; t1JWr: $id || ($id = $this->session->userdata("\165\x73\145\x72\137\x69\x64")); goto PEycU; u0T0s: $groups_array = $this->_cache_user_in_group[$id]; goto tDmr9; k69M4: $users_groups = $this->get_users_groups($id)->result(); goto GlluI; TdC9G: foreach ($check_group as $key => $value) { goto lA1gV; jRnAY: tb3bs: goto ijlH3; yyQbi: if (!(in_array($value, $groups) xor $check_all)) { goto tb3bs; } goto xSm9f; lA1gV: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto yyQbi; ijlH3: U_jUE: goto VyWm3; xSm9f: return !$check_all; goto jRnAY; VyWm3: } goto JAPSu; FBEHU: } public function add_to_group($group_ids, $user_id = FALSE) { goto QinWC; wVQyq: $return = 0; goto ffDeO; MhpHL: $user_id || ($user_id = $this->session->userdata("\165\163\145\162\x5f\x69\x64")); goto Uf_uv; dnAfg: CL2Xk: goto E1FBU; ffDeO: foreach ($group_ids as $group_id) { goto Veu1e; C_u8C: if (isset($this->_cache_groups[$group_id])) { goto ZiEVM; } goto IBqhA; Km0BE: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto W1xSp; z7jyF: o3GHH: goto PjiFp; fHKta: $this->_cache_groups[$group_id] = $group_name; goto Tb3YF; IBqhA: $group = $this->group($group_id)->result(); goto pLS5n; ij5zA: ZiEVM: goto BSavJ; BSavJ: $group_name = $this->_cache_groups[$group_id]; goto W1l7k; W1xSp: $return++; goto z7jyF; W1l7k: D2tTe: goto Km0BE; PjiFp: dC0oO: goto O5XGn; pLS5n: $group_name = $group[0]->name; goto fHKta; Tb3YF: goto D2tTe; goto ij5zA; Veu1e: if (!$this->db->insert($this->tables["\x75\163\145\x72\x73\x5f\x67\162\157\x75\160\x73"], [$this->join["\x67\x72\x6f\165\x70\x73"] => (float) $group_id, $this->join["\165\163\x65\x72\163"] => (float) $user_id])) { goto o3GHH; } goto C_u8C; O5XGn: } goto dnAfg; E1FBU: return $return; goto hWjN9; mYxve: $group_ids = [$group_ids]; goto FT4jh; FT4jh: w09Ah: goto wVQyq; Uf_uv: if (is_array($group_ids)) { goto w09Ah; } goto mYxve; QinWC: $this->trigger_events("\x61\144\144\x5f\164\157\x5f\x67\162\157\165\x70"); goto MhpHL; hWjN9: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto bUBy5; pSFvr: BAH54: goto u3znU; Btc09: goto BAH54; goto QuRPs; JjeQY: if (!empty($user_id)) { goto UGEtX; } goto IZuqI; JqLCu: if (!empty($group_ids)) { goto MucUn; } goto zGUaf; frlL1: if (is_array($group_ids)) { goto pvDI7; } goto DHvJ_; TNCiU: QcIov: goto Btc09; ODIa1: foreach ($group_ids as $group_id) { goto mIP_0; mIP_0: $this->db->delete($this->tables["\x75\x73\x65\162\x73\x5f\x67\162\x6f\x75\x70\x73"], [$this->join["\x67\162\x6f\165\x70\163"] => (float) $group_id, $this->join["\x75\163\x65\162\x73"] => (float) $user_id]); goto fwYJf; fwYJf: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto q3hcu; } goto GsI9w; GsI9w: unset($this->_cache_user_in_group[$user_id][$group_id]); goto pkgCz; pkgCz: q3hcu: goto FilKs; FilKs: dL1Gl: goto UoV6S; UoV6S: } goto cDu6f; bUBy5: $this->trigger_events("\x72\145\155\x6f\166\x65\137\x66\x72\157\x6d\137\x67\x72\157\x75\x70"); goto JjeQY; zGUaf: if (!($return = $this->db->delete($this->tables["\165\x73\x65\x72\163\137\147\x72\x6f\165\160\163"], [$this->join["\x75\x73\145\162\x73"] => (float) $user_id]))) { goto QcIov; } goto WzdtT; u3znU: return $return; goto TBMiW; IZuqI: return FALSE; goto X40aw; cDu6f: yUYtD: goto Z3J4_; DHvJ_: $group_ids = [$group_ids]; goto Anpz8; Z3J4_: $return = TRUE; goto pSFvr; Anpz8: pvDI7: goto ODIa1; WzdtT: $this->_cache_user_in_group[$user_id] = []; goto TNCiU; X40aw: UGEtX: goto JqLCu; QuRPs: MucUn: goto frlL1; TBMiW: } public function groups() { goto Q1f4d; rH0Jb: DW4Dt: goto j02ni; TpBbH: lY3x0: goto xkMup; Hw2ug: rdN8L: goto l2Svu; jzyHe: $this->_ion_limit = NULL; goto xlytF; Q1f4d: $this->trigger_events("\147\x72\x6f\165\160\x73"); goto nvct4; ab1PI: $this->_ion_limit = NULL; goto WxIlt; nvct4: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto rdN8L; } goto oUXNi; dIi6z: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto ab1PI; j02ni: $this->response = $this->db->get($this->tables["\147\162\x6f\165\x70\x73"]); goto mrLGD; l2Svu: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto wBkk6; } goto d17mG; oUXNi: foreach ($this->_ion_where as $where) { $this->db->where($where); jpEMR: } goto TpBbH; yHa6x: wBkk6: goto dIi6z; J0S2w: tHL3u: goto h9NVq; xkMup: $this->_ion_where = []; goto Hw2ug; h9NVq: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto DW4Dt; } goto totKt; d17mG: if (!isset($this->_ion_limit)) { goto bNgcm; } goto XjugV; XjugV: $this->db->limit($this->_ion_limit); goto jzyHe; mrLGD: return $this; goto wCF1a; totKt: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto rH0Jb; WxIlt: $this->_ion_offset = NULL; goto J0S2w; xlytF: bNgcm: goto KA9Td; KA9Td: goto tHL3u; goto yHa6x; wCF1a: } public function group($id = NULL) { goto AOvqY; MuXWP: $this->order_by("\151\x64", "\144\x65\163\x63"); goto siDFG; AOvqY: $this->trigger_events("\x67\162\x6f\x75\x70"); goto ydeQu; ydeQu: if (!isset($id)) { goto z3866; } goto fIPxI; hLfXY: $this->limit(1); goto MuXWP; siDFG: return $this->groups(); goto ZqC3M; VsBsv: z3866: goto hLfXY; fIPxI: $this->where($this->tables["\x67\162\157\165\x70\163"] . "\x2e\x69\144", $id); goto VsBsv; ZqC3M: } public function update($id, array $data) { goto QxDWn; smhi6: daY_X: goto p5NSQ; qHe3Z: $this->trigger_events("\x65\170\164\x72\x61\137\x77\x68\145\x72\x65"); goto U4uRg; U4uRg: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, ["\x69\x64" => $user->id]); goto A9yhQ; lkw2B: $this->db->trans_begin(); goto KwiFk; QxDWn: $this->trigger_events("\x70\x72\x65\x5f\x75\x70\144\141\x74\145\137\165\x73\145\x72"); goto w7ADs; K1ffQ: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\x73\167\157\x72\144", $data) || array_key_exists("\145\155\x61\151\x6c", $data))) { goto t60z8; } goto mEtuu; p_E1i: $this->db->trans_commit(); goto pLSBB; pLSBB: $this->trigger_events(["\160\x6f\163\164\x5f\165\x70\x64\141\164\145\x5f\165\x73\x65\x72", "\x70\157\x73\x74\x5f\x75\160\x64\141\x74\x65\137\x75\x73\x65\162\x5f\163\165\x63\x63\x65\x73\163\146\x75\154"]); goto IOr1Y; FLKkS: $data = $this->_filter_data($this->tables["\165\163\x65\x72\163"], $data); goto K1ffQ; w7ADs: $user = $this->user($id)->row(); goto lkw2B; JKhxc: if (!($data["\x70\x61\163\x73\167\157\x72\x64"] === FALSE)) { goto MGRKE; } goto pc7mm; pyKtG: return TRUE; goto Pp5l2; Ze1kq: return FALSE; goto by2jL; Nv6TB: return FALSE; goto ppJ0z; hLyg5: $this->trigger_events(["\x70\157\163\164\137\165\160\144\x61\x74\x65\x5f\165\163\145\x72", "\160\x6f\x73\x74\137\x75\x70\144\x61\164\x65\137\x75\x73\145\x72\x5f\x75\156\163\x75\143\143\x65\x73\x73\146\x75\x6c"]); goto hrq0P; crV4v: fhmBx: goto p_E1i; IOr1Y: $this->set_message("\165\160\x64\141\x74\x65\137\163\x75\x63\x63\x65\x73\163\x66\x75\x6c"); goto pyKtG; t0tXm: $this->set_error("\165\x70\x64\x61\x74\145\137\165\156\x73\165\x63\x63\x65\x73\163\x66\165\154"); goto Nv6TB; dZ37P: $this->db->trans_rollback(); goto E0PhF; pc7mm: $this->db->trans_rollback(); goto RpdB_; p5NSQ: iFtL4: goto Up6ef; hrq0P: $this->set_error("\x75\160\144\141\x74\x65\x5f\x75\156\x73\165\x63\143\x65\x73\x73\146\165\x6c"); goto TT0nj; qAcRL: $this->trigger_events(["\160\x6f\163\x74\x5f\x75\x70\144\141\164\145\x5f\165\163\x65\162", "\x70\157\x73\164\137\x75\160\144\141\164\x65\137\165\x73\x65\162\x5f\x75\156\x73\x75\143\143\x65\163\163\146\165\154"]); goto t0tXm; E0PhF: $this->set_error("\141\x63\143\x6f\165\156\x74\137\x63\x72\145\141\x74\151\157\156\x5f\144\165\x70\x6c\x69\143\x61\164\x65\x5f\x69\144\x65\156\164\151\x74\x79"); goto qAcRL; gbHCJ: unset($data["\160\x61\x73\163\167\x6f\x72\144"]); goto w93up; ppJ0z: prpEf: goto FLKkS; gutVt: $this->set_error("\165\160\144\x61\x74\x65\137\165\156\163\x75\x63\143\145\163\x73\x66\165\x6c"); goto Ze1kq; w93up: goto daY_X; goto pwyVj; A9yhQ: if (!($this->db->trans_status() === FALSE)) { goto fhmBx; } goto YC6aO; dfKwa: if (!empty($data["\160\141\163\x73\x77\x6f\162\144"])) { goto h258m; } goto gbHCJ; mEtuu: if (!array_key_exists("\160\x61\163\x73\167\157\x72\x64", $data)) { goto iFtL4; } goto dfKwa; RpdB_: $this->trigger_events(["\x70\157\163\164\x5f\165\160\x64\x61\x74\x65\x5f\165\163\145\x72", "\160\157\163\164\x5f\x75\160\x64\141\164\x65\137\x75\x73\145\162\x5f\165\x6e\163\165\143\x63\x65\163\163\x66\x75\154"]); goto gutVt; KwiFk: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto prpEf; } goto dZ37P; pwyVj: h258m: goto YkNu9; Up6ef: t60z8: goto qHe3Z; TT0nj: return FALSE; goto crV4v; YC6aO: $this->db->trans_rollback(); goto hLyg5; YkNu9: $data["\x70\x61\x73\163\x77\x6f\162\144"] = $this->hash_password($data["\x70\x61\x73\163\x77\x6f\x72\x64"], $user->{$this->identity_column}); goto JKhxc; by2jL: MGRKE: goto smhi6; Pp5l2: } public function delete_user($id) { goto e5VSz; Hq_CH: return TRUE; goto Q3JgW; Y1sec: $this->remove_from_group(NULL, $id); goto IR6hY; Wen2Y: $this->db->trans_commit(); goto ZHiGk; rOgO3: $this->set_message("\144\x65\x6c\x65\x74\145\x5f\x73\x75\x63\x63\145\x73\x73\x66\x75\x6c"); goto Hq_CH; US7gb: $this->trigger_events(["\160\157\163\164\137\x64\145\x6c\145\164\145\x5f\165\163\x65\x72", "\x70\157\163\x74\137\x64\x65\x6c\x65\x74\145\137\165\163\x65\x72\x5f\x75\x6e\163\x75\x63\143\x65\x73\x73\x66\x75\x6c"]); goto OIwSz; ZHiGk: $this->trigger_events(["\x70\157\163\164\137\x64\145\154\145\164\145\x5f\x75\x73\145\162", "\160\157\163\164\x5f\144\x65\154\x65\164\x65\x5f\165\163\145\162\137\x73\x75\x63\143\x65\163\163\146\165\x6c"]); goto rOgO3; ezIrn: if (!($this->db->trans_status() === FALSE)) { goto WlK57; } goto syA5V; IR6hY: $this->db->delete($this->tables["\165\163\145\162\x73"], ["\x69\144" => $id]); goto ezIrn; gsD2N: return FALSE; goto E8XhC; e5VSz: $this->trigger_events("\160\162\x65\x5f\x64\145\x6c\x65\164\x65\137\x75\163\145\x72"); goto fLd32; OIwSz: $this->set_error("\x64\x65\154\x65\x74\145\x5f\165\x6e\163\165\143\x63\x65\163\163\x66\x75\154"); goto gsD2N; syA5V: $this->db->trans_rollback(); goto US7gb; fLd32: $this->db->trans_begin(); goto Y1sec; E8XhC: WlK57: goto Wen2Y; Q3JgW: } public function update_last_login($id) { goto WXw0K; X_tf8: return $this->db->affected_rows() == 1; goto LgLLB; ve0f8: $this->load->helper("\x64\x61\x74\145"); goto PZIb2; L_oo1: $this->db->update($this->tables["\x75\163\x65\x72\x73"], ["\x6c\141\163\x74\x5f\x6c\x6f\147\x69\x6e" => time()], ["\151\144" => $id]); goto X_tf8; WXw0K: $this->trigger_events("\165\160\x64\141\x74\x65\137\x6c\141\x73\164\x5f\154\x6f\x67\151\x6e"); goto ve0f8; PZIb2: $this->trigger_events("\145\x78\x74\x72\141\137\167\x68\x65\162\x65"); goto L_oo1; LgLLB: } public function set_lang($lang = "\x65\x6e") { goto EKuqx; wk6zF: return TRUE; goto Sis63; pbRay: if ($this->config->item("\165\x73\x65\162\137\x65\170\160\x69\x72\145", "\x69\x6f\156\137\x61\x75\x74\x68") === 0) { goto XtIXi; } goto Dx3nf; dGxjR: XtIXi: goto egq4o; wjUtN: goto gBZN2; goto dGxjR; egq4o: $expire = self::MAX_COOKIE_LIFETIME; goto x8CPc; Dx3nf: $expire = $this->config->item("\165\163\145\162\137\145\170\x70\x69\x72\145", "\x69\x6f\156\137\x61\x75\164\x68"); goto wjUtN; x8CPc: gBZN2: goto lVRGa; lVRGa: set_cookie(["\156\141\x6d\145" => "\154\x61\156\147\x5f\x63\157\x64\x65", "\166\141\x6c\165\x65" => $lang, "\145\x78\160\x69\162\145" => $expire]); goto wk6zF; EKuqx: $this->trigger_events("\163\x65\164\137\154\x61\x6e\147"); goto pbRay; Sis63: } public function set_session($user) { goto pD2PV; z4koR: $this->session->set_userdata($session_data); goto YrAPZ; pD2PV: $this->trigger_events("\160\162\x65\x5f\x73\x65\x74\137\163\145\x73\163\151\x6f\x6e"); goto vpA7V; vpA7V: $session_data = ["\x69\x64\x65\x6e\x74\151\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\x6d\x61\x69\154" => $user->email, "\165\163\x65\162\x5f\151\x64" => $user->id, "\x6f\x6c\x64\137\x6c\x61\x73\x74\x5f\154\157\147\x69\156" => $user->last_login, "\x6c\x61\163\164\137\x63\150\145\143\x6b" => time()]; goto z4koR; YrAPZ: $this->trigger_events("\x70\157\x73\x74\137\x73\x65\x74\137\x73\145\x73\x73\x69\x6f\156"); goto Qqdc5; Qqdc5: return TRUE; goto BLN9r; BLN9r: } public function remember_user($identity) { goto hqIul; hKPwL: gfw8p: goto IKiSy; Mj3_6: OfN_U: goto n9Fy9; hqIul: $this->trigger_events("\160\162\x65\137\162\145\155\145\155\x62\x65\x72\137\165\x73\145\162"); goto kVLav; jJ3Ic: goto gfw8p; goto Mj3_6; b8kTR: gtFqd: goto L5xAJ; YoO23: if (!($this->db->affected_rows() > -1)) { goto gtFqd; } goto EaJYs; n9Fy9: $expire = self::MAX_COOKIE_LIFETIME; goto hKPwL; ZpXXP: if (!$token->validator_hashed) { goto sDJAf; } goto b3qsG; q2QSQ: j59EN: goto iV2MD; IKiSy: set_cookie(["\x6e\x61\155\145" => $this->config->item("\x72\x65\155\x65\x6d\142\x65\162\137\143\157\x6f\x6b\x69\x65\137\x6e\x61\x6d\x65", "\x69\x6f\x6e\x5f\141\x75\x74\150"), "\166\x61\x6c\x75\145" => $token->user_code, "\x65\170\160\151\162\145" => $expire]); goto cc3XD; aev5x: return FALSE; goto E_AKQ; iV2MD: $token = $this->_generate_selector_validator_couple(); goto ZpXXP; kVLav: if ($identity) { goto j59EN; } goto k5lWq; cc3XD: $this->trigger_events(["\x70\x6f\163\x74\137\162\145\x6d\145\155\x62\x65\x72\x5f\x75\163\145\x72", "\x72\x65\x6d\145\x6d\142\x65\x72\137\165\163\x65\162\137\163\165\x63\143\145\x73\163\x66\x75\x6c"]); goto ZqMlM; Np052: $this->trigger_events(["\x70\x6f\163\x74\137\162\x65\x6d\x65\155\x62\145\x72\137\165\x73\145\162", "\162\x65\x6d\x65\155\x62\x65\x72\137\165\x73\145\x72\137\165\156\x73\165\x63\x63\145\x73\x73\146\165\x6c"]); goto aev5x; EaJYs: if ($this->config->item("\165\163\145\x72\137\x65\170\x70\x69\162\x65", "\x69\157\x6e\137\141\x75\164\x68") === 0) { goto OfN_U; } goto xQ7Yq; L5xAJ: sDJAf: goto Np052; xQ7Yq: $expire = $this->config->item("\x75\163\x65\x72\137\x65\x78\x70\151\162\145", "\x69\157\x6e\x5f\x61\165\164\150"); goto jJ3Ic; ZqMlM: return TRUE; goto b8kTR; b3qsG: $this->db->update($this->tables["\165\x73\x65\x72\163"], ["\x72\145\155\x65\155\142\145\162\137\163\x65\154\145\143\164\x6f\162" => $token->selector, "\x72\x65\155\x65\x6d\x62\145\162\x5f\143\x6f\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto YoO23; k5lWq: return FALSE; goto q2QSQ; E_AKQ: } public function login_remembered_user() { goto fvc42; Xo3ja: return FALSE; goto GPB41; ymBFb: return FALSE; goto GfhLm; Omg73: return TRUE; goto AwX2G; OiJGA: if (!($token === FALSE)) { goto ly3Cz; } goto qpiDU; MSqc7: $identity = $user->{$this->identity_column}; goto mKLrK; AwX2G: WGBYU: goto g54G_; D_lF8: delete_cookie($this->config->item("\x72\x65\155\x65\x6d\x62\x65\x72\137\x63\157\157\153\x69\x65\137\156\x61\x6d\145", "\x69\x6f\156\137\x61\x75\164\x68")); goto vBoSO; qpiDU: $this->trigger_events(["\x70\157\x73\164\137\x6c\x6f\147\x69\156\x5f\162\x65\x6d\145\155\x62\x65\x72\145\144\x5f\165\x73\145\162", "\x70\x6f\x73\164\137\154\x6f\x67\x69\x6e\137\162\145\155\x65\155\x62\145\x72\x65\x64\137\165\163\145\x72\x5f\165\156\x73\x75\143\x63\145\x73\x73\x66\x75\154"]); goto ymBFb; SFm4z: $this->session->sess_regenerate(FALSE); goto ZWN3q; mr81I: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto OiJGA; XcxQL: $this->clear_forgotten_password_code($identity); goto iW49V; vBoSO: $this->trigger_events(["\160\x6f\x73\164\x5f\154\x6f\147\x69\x6e\137\x72\145\155\145\x6d\x62\145\x72\145\x64\137\165\x73\145\x72", "\x70\157\x73\164\137\x6c\157\x67\151\156\x5f\162\x65\155\145\155\x62\145\162\145\144\137\165\163\x65\x72\x5f\165\156\163\x75\143\143\x65\x73\x73\x66\165\154"]); goto Xo3ja; wKf2j: UJT6D: goto SFm4z; v1m6r: $this->set_session($user); goto XcxQL; g54G_: Rv80z: goto D_lF8; ZWN3q: $this->trigger_events(["\160\x6f\163\164\137\154\x6f\147\151\x6e\137\x72\145\x6d\145\155\x62\x65\162\x65\144\x5f\x75\163\145\162", "\160\x6f\163\x74\x5f\154\157\147\x69\x6e\137\x72\145\155\145\155\x62\145\162\145\144\137\x75\163\145\x72\x5f\163\165\143\143\x65\x73\163\x66\165\x6c"]); goto Omg73; w_0MH: if (!($query->num_rows() === 1)) { goto Rv80z; } goto mLWDx; fvc42: $this->trigger_events("\x70\162\x65\x5f\x6c\x6f\147\151\156\137\162\x65\155\x65\155\142\x65\162\145\144\x5f\165\163\145\x72"); goto RWRje; mKLrK: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto WGBYU; } goto ToWhb; ToWhb: $this->update_last_login($user->id); goto v1m6r; iW49V: if (!$this->config->item("\165\x73\x65\162\137\145\x78\164\x65\156\144\x5f\x6f\x6e\x5f\x6c\157\x67\151\156", "\x69\x6f\156\x5f\x61\165\164\150")) { goto UJT6D; } goto CciuH; x1AmX: $query = $this->db->select($this->identity_column . "\54\40\x69\144\54\40\145\x6d\141\x69\x6c\x2c\40\162\145\155\x65\155\142\145\162\x5f\x63\157\144\145\x2c\x20\x6c\x61\163\164\137\154\157\147\x69\156")->where("\162\x65\155\x65\155\x62\x65\x72\x5f\163\145\x6c\x65\143\x74\x6f\162", $token->selector)->where("\x61\143\x74\x69\166\145", 1)->limit(1)->get($this->tables["\x75\163\x65\x72\163"]); goto w_0MH; GfhLm: ly3Cz: goto HBfQX; CciuH: $this->remember_user($identity); goto wKf2j; mLWDx: $user = $query->row(); goto MSqc7; HBfQX: $this->trigger_events("\x65\170\x74\162\x61\x5f\167\x68\x65\x72\x65"); goto x1AmX; RWRje: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\145\155\142\x65\x72\x5f\x63\157\157\153\151\145\137\156\141\155\x65", "\x69\157\x6e\137\141\x75\x74\150")); goto mr81I; GPB41: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto cvVZo; kdaku: $this->set_error("\x67\x72\x6f\165\x70\x5f\x6e\x61\x6d\145\x5f\x72\x65\x71\x75\x69\162\145\144"); goto O31tD; ejf_U: $this->db->insert($this->tables["\147\x72\x6f\x75\x70\163"], $data); goto zLQLv; Do3gg: if (empty($additional_data)) { goto uE6z3; } goto oAo6L; O31tD: return FALSE; goto Bam9B; pvQcA: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\163"], ["\x6e\141\x6d\145" => $group_name])->num_rows(); goto VrXFx; xpyuR: $data = ["\x6e\x61\x6d\145" => $group_name, "\x64\145\x73\143\162\x69\160\x74\151\157\x6e" => $group_description]; goto Do3gg; hmel8: FROCJ: goto xpyuR; G_rSo: return $group_id; goto s49OA; oAo6L: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\165\160\x73"], $additional_data), $data); goto eHVbb; cvVZo: if ($group_name) { goto B1cxa; } goto kdaku; Bam9B: B1cxa: goto pvQcA; os5Xh: $this->set_message("\147\162\157\165\x70\137\143\x72\145\141\x74\151\x6f\x6e\x5f\163\x75\x63\x63\x65\163\x73\146\x75\154"); goto G_rSo; adbTH: $this->set_error("\147\162\x6f\165\160\137\141\154\162\145\x61\x64\x79\137\145\170\151\163\x74\x73"); goto AmcNa; VrXFx: if (!($existing_group !== 0)) { goto FROCJ; } goto adbTH; eHVbb: uE6z3: goto qoIJ1; qoIJ1: $this->trigger_events("\145\170\164\162\141\137\x67\x72\x6f\x75\160\137\163\x65\x74"); goto ejf_U; zLQLv: $group_id = $this->db->insert_id($this->tables["\x67\162\x6f\165\x70\x73"] . "\137\x69\x64\x5f\x73\145\x71"); goto os5Xh; AmcNa: return FALSE; goto hmel8; s49OA: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto TUazv; PiFx7: Prpdn: goto CHZ92; o7ML6: if (empty($additional_data)) { goto S4aQu; } goto BdPKV; aj5En: if (empty($group_name)) { goto oOzFH; } goto WUTxP; BhAtL: $this->db->update($this->tables["\147\x72\157\165\x70\163"], $data, ["\151\144" => $group_id]); goto JtaYh; TUazv: if (!empty($group_id)) { goto fGhcu; } goto uN0vw; NVp2R: $this->set_error("\147\162\157\x75\x70\x5f\x6e\141\x6d\x65\x5f\x61\144\x6d\151\156\137\156\157\x74\x5f\141\x6c\x74\x65\x72"); goto jLobE; KV9Bu: fGhcu: goto fieqV; BdPKV: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\165\x70\x73"], $additional_data), $data); goto GxM7d; Oc7k8: return FALSE; goto PiFx7; A9A4B: $group = $this->db->get_where($this->tables["\147\162\x6f\x75\x70\x73"], ["\151\x64" => $group_id])->row(); goto Fcf9l; cDV3x: oOzFH: goto A9A4B; gEV_p: zEiHF: goto o7ML6; uN0vw: return FALSE; goto KV9Bu; GxM7d: S4aQu: goto BhAtL; wsPTb: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto Prpdn; } goto efpZk; JtaYh: $this->set_message("\147\162\x6f\165\160\x5f\165\x70\144\x61\x74\x65\x5f\163\x75\143\x63\x65\163\163\x66\165\154"); goto Kgzqu; jLobE: return FALSE; goto gEV_p; Fcf9l: if (!($this->config->item("\141\x64\155\x69\x6e\137\147\x72\157\165\160", "\x69\x6f\x6e\137\141\x75\164\x68") === $group->name && $group_name !== $group->name)) { goto zEiHF; } goto NVp2R; WUTxP: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\165\160\163"], ["\156\141\155\145" => $group_name])->row(); goto wsPTb; CHZ92: $data["\156\141\155\145"] = $group_name; goto cDV3x; Kgzqu: return TRUE; goto je0H_; efpZk: $this->set_error("\x67\x72\x6f\165\x70\x5f\x61\x6c\x72\x65\x61\144\171\x5f\x65\x78\x69\163\164\163"); goto Oc7k8; fieqV: $data = []; goto aj5En; je0H_: } public function delete_group($group_id = FALSE) { goto CU4CW; EtQh4: $group = $this->group($group_id)->row(); goto ZhgLl; nKm8V: $this->set_error("\147\x72\157\x75\x70\x5f\144\x65\x6c\x65\164\x65\137\x6e\x6f\x74\x61\x6c\x6c\x6f\x77\x65\x64"); goto CMpN0; SxOyf: $this->set_error("\147\x72\157\165\160\137\x64\x65\x6c\x65\x74\145\x5f\x75\156\163\165\143\143\x65\x73\163\146\165\x6c"); goto iJO3z; oUvxZ: $this->trigger_events(["\x70\157\163\x74\137\x64\x65\x6c\x65\164\x65\x5f\147\x72\157\x75\x70", "\160\157\x73\164\137\x64\145\154\145\164\x65\x5f\147\162\x6f\x75\x70\x5f\163\x75\143\x63\145\163\x73\x66\x75\x6c"]); goto S2Tco; CMpN0: return FALSE; goto d8Y07; ZhgLl: if (!($group->name == $this->config->item("\x61\x64\x6d\x69\156\137\x67\162\157\165\x70", "\x69\x6f\x6e\x5f\141\x75\164\x68"))) { goto H7d_b; } goto ib3fG; PiqgA: if (!($this->db->trans_status() === FALSE)) { goto HmrBc; } goto L5PcK; UEoYv: $this->db->delete($this->tables["\x75\163\145\162\163\137\x67\162\x6f\165\160\163"], [$this->join["\x67\x72\157\x75\160\x73"] => $group_id]); goto i_PjM; b4v_f: xD116: goto EtQh4; d8Y07: H7d_b: goto R29ls; iJO3z: return FALSE; goto hNU9U; hFaQy: return TRUE; goto LhnjX; hNU9U: HmrBc: goto RXOKZ; L5PcK: $this->db->trans_rollback(); goto j5Af1; OwUKJ: return FALSE; goto b4v_f; CU4CW: if (!(!$group_id || empty($group_id))) { goto xD116; } goto OwUKJ; S2Tco: $this->set_message("\147\x72\x6f\x75\x70\137\x64\x65\x6c\145\164\x65\137\x73\165\143\143\x65\163\163\x66\165\x6c"); goto hFaQy; j5Af1: $this->trigger_events(["\x70\157\x73\x74\137\x64\x65\x6c\145\164\145\137\x67\162\x6f\165\160", "\x70\157\x73\x74\137\144\x65\154\x65\x74\x65\137\x67\162\157\x75\x70\137\x75\x6e\163\165\x63\x63\x65\163\163\146\x75\x6c"]); goto SxOyf; R29ls: $this->trigger_events("\x70\162\145\137\x64\x65\154\145\164\x65\x5f\x67\x72\157\x75\160"); goto im1tc; im1tc: $this->db->trans_begin(); goto UEoYv; RXOKZ: $this->db->trans_commit(); goto oUvxZ; ib3fG: $this->trigger_events(["\160\x6f\163\164\137\144\x65\x6c\x65\164\145\x5f\x67\162\x6f\165\160", "\160\x6f\x73\x74\x5f\x64\x65\x6c\145\x74\x65\137\147\x72\x6f\165\160\137\x6e\x6f\164\141\154\x6c\x6f\x77\145\x64"]); goto nKm8V; i_PjM: $this->db->delete($this->tables["\147\162\x6f\165\x70\x73"], ["\151\144" => $group_id]); goto PiqgA; LhnjX: } public function set_hook($event, $name, $class, $method, $arguments) { goto KcXuV; KMIf1: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto VpUvV; I3Od4: $this->_ion_hooks->{$event}[$name]->method = $method; goto KMIf1; KcXuV: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto ImMuV; ImMuV: $this->_ion_hooks->{$event}[$name]->class = $class; goto I3Od4; VpUvV: } public function remove_hook($event, $name) { goto E_f9A; DMPS3: ShdHj: goto LL21s; pZcWG: unset($this->_ion_hooks->{$event}[$name]); goto DMPS3; E_f9A: if (!isset($this->_ion_hooks->{$event}[$name])) { goto ShdHj; } goto pZcWG; LL21s: } public function remove_hooks($event) { goto wCybh; wCybh: if (!isset($this->_ion_hooks->{$event})) { goto FgaQB; } goto ux8Ac; ux8Ac: unset($this->_ion_hooks->{$event}); goto mAJZR; mAJZR: FgaQB: goto K8NT_; K8NT_: } protected function _call_hook($event, $name) { goto pijWu; Mb2OC: return FALSE; goto x2lr6; pijWu: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto djcTt; } goto s4ZM4; TmvVt: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto bjSkb; s4ZM4: $hook = $this->_ion_hooks->{$event}[$name]; goto TmvVt; bjSkb: djcTt: goto Mb2OC; x2lr6: } public function trigger_events($events) { goto Cg0hL; Cg0hL: if (is_array($events) && !empty($events)) { goto nVUMX; } goto lpbbA; mSfoq: Ylf9C: goto XP_wY; wWv92: JqPML: goto ttuGH; IWoVC: foreach ($events as $event) { $this->trigger_events($event); ys2Nl: } goto p1w4S; lpbbA: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto Ylf9C; } goto VfKZ9; sw4PA: F0b27: goto mSfoq; Z3EXj: nVUMX: goto IWoVC; VfKZ9: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); i2LiD: } goto sw4PA; p1w4S: doKON: goto wWv92; XP_wY: goto JqPML; goto Z3EXj; ttuGH: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto i8GT5; xosL2: return TRUE; goto ePK8e; i8GT5: $this->message_start_delimiter = $start_delimiter; goto f9Y2m; f9Y2m: $this->message_end_delimiter = $end_delimiter; goto xosL2; ePK8e: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto XOfvI; L90y2: return TRUE; goto E2vu5; XOfvI: $this->error_start_delimiter = $start_delimiter; goto Vq0bw; Vq0bw: $this->error_end_delimiter = $end_delimiter; goto L90y2; E2vu5: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto H9NKv; kkLYn: return $_output; goto B7Htb; H9NKv: $_output = ''; goto y3iU2; hOJoY: OY58c: goto kkLYn; y3iU2: foreach ($this->messages as $message) { goto Xl_A6; Vzsnh: MIn3y: goto Y_4hn; Xl_A6: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\x23\x23"; goto zr8Y0; zr8Y0: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto Vzsnh; Y_4hn: } goto hOJoY; B7Htb: } public function messages_array($langify = TRUE) { goto JQzXB; pjEA1: return $_output; goto W0jBp; W0jBp: lo3So: goto WrNQH; IdoET: return $this->messages; goto uoTok; JAqPJ: LBFRj: goto pjEA1; JQzXB: if ($langify) { goto F1Iz3; } goto IdoET; jUC1B: foreach ($this->messages as $message) { goto iU3GP; V_TE7: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto NkITt; NkITt: DOypZ: goto XO2FC; iU3GP: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto V_TE7; XO2FC: } goto JAqPJ; NDgHG: $_output = []; goto jUC1B; Ydd2W: F1Iz3: goto NDgHG; uoTok: goto lo3So; goto Ydd2W; WrNQH: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto EpTHN; sUraS: return $_output; goto wLqVi; EpTHN: $_output = ''; goto DMTIe; DMTIe: foreach ($this->errors as $error) { goto xLPXV; xLPXV: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\x23\x23"; goto s9zsI; s9zsI: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto UXOk2; UXOk2: bggp8: goto Wpinn; Wpinn: } goto unK4o; unK4o: C0lii: goto sUraS; wLqVi: } public function errors_array($langify = TRUE) { goto jBMB7; cJI3P: $_output = []; goto j7S18; j8Ard: sLu8y: goto cJI3P; l5vrG: MfVrS: goto KVX8Q; TZgml: goto NpGyv; goto j8Ard; j7S18: foreach ($this->errors as $error) { goto YC7eR; YC7eR: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto bsu60; bsu60: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto uoEcz; uoEcz: fCsVN: goto dpAbK; dpAbK: } goto l5vrG; jBMB7: if ($langify) { goto sLu8y; } goto lMaLD; KVX8Q: return $_output; goto FVUK2; lMaLD: return $this->errors; goto TZgml; FVUK2: NpGyv: goto N0Dd9; N0Dd9: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto dAacH; dAacH: $hash = $this->hash_password($password, $identity); goto bgVZl; OxfnN: tzLPN: goto a5lrK; Cc8vM: $this->db->update($this->tables["\165\163\145\x72\163"], $data, [$this->identity_column => $identity]); goto nivmg; nivmg: return $this->db->affected_rows() == 1; goto CPlwN; a5lrK: $data = ["\160\x61\x73\x73\x77\157\162\x64" => $hash, "\x72\x65\x6d\x65\155\x62\145\162\x5f\143\157\144\x65" => NULL, "\x66\157\162\x67\x6f\164\164\x65\156\x5f\160\x61\x73\x73\x77\157\162\144\137\143\x6f\x64\x65" => NULL, "\x66\x6f\x72\x67\x6f\164\x74\x65\156\x5f\160\x61\x73\163\167\157\x72\x64\x5f\x74\x69\155\x65" => NULL]; goto USyyL; bgVZl: if (!($hash === FALSE)) { goto tzLPN; } goto ufJLQ; USyyL: $this->trigger_events("\145\x78\x74\x72\141\x5f\x77\x68\x65\x72\145"); goto Cc8vM; ufJLQ: return FALSE; goto OxfnN; CPlwN: } protected function _filter_data($table, $data) { goto iKpS3; QGs2w: return $filtered_data; goto vjgXO; Tx_n1: M7AFi: goto QGs2w; uTpVI: $columns = $this->db->list_fields($table); goto CfxF1; vanUw: foreach ($columns as $column) { goto zayy8; i2tZV: $filtered_data[$column] = $data[$column]; goto Ztsk6; mlmDT: mYSC7: goto SZtpp; zayy8: if (!array_key_exists($column, $data)) { goto La7Vh; } goto i2tZV; Ztsk6: La7Vh: goto mlmDT; SZtpp: } goto nfY7N; nfY7N: RqYMG: goto Tx_n1; iKpS3: $filtered_data = []; goto uTpVI; CfxF1: if (!is_array($data)) { goto M7AFi; } goto vanUw; vjgXO: } protected function _random_token($result_length = 32) { goto Lkpr4; P3NYR: j4vAm: goto klbmI; zcIx2: NRC1n: goto MzSz3; s0akZ: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto P3NYR; CIdGG: dk8A7: goto PbnK5; bPUSy: $result_length = 32; goto CIdGG; TJh0u: P_cgB: goto Mme31; Lkpr4: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto dk8A7; } goto bPUSy; O0Rlo: return bin2hex(random_bytes($result_length / 2)); goto TJh0u; MzSz3: if (!function_exists("\x6f\x70\145\156\x73\x73\154\137\x72\141\156\144\x6f\155\x5f\x70\163\x65\x75\144\157\x5f\142\x79\x74\x65\x73")) { goto j4vAm; } goto s0akZ; Mme31: if (!function_exists("\155\143\x72\x79\160\164\x5f\143\x72\x65\141\164\145\137\x69\166")) { goto NRC1n; } goto CWama; CWama: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto zcIx2; klbmI: return FALSE; goto Ifor6; PbnK5: if (!function_exists("\x72\x61\x6e\144\157\x6d\x5f\x62\x79\x74\x65\163")) { goto P_cgB; } goto O0Rlo; Ifor6: } protected function _get_hash_parameters($identity = NULL) { goto Cj4iB; rICtR: $is_admin = TRUE; goto AaG9K; sMIx2: elU33: goto mx1vh; ESVJQ: cHivc: goto piBA4; gmtEO: wBocx: goto sMIx2; FPffc: if (!($user_id && $this->in_group($this->config->item("\x61\x64\x6d\x69\x6e\x5f\x67\162\x6f\x75\160", "\151\157\156\137\x61\165\164\x68"), $user_id))) { goto DBji2; } goto rICtR; mx1vh: return $params; goto WW26y; hZt1m: $user_id = $this->get_user_id_from_identity($identity); goto FPffc; piBA4: $params = FALSE; goto oQnZZ; oQnZZ: switch ($this->hash_method) { case "\x62\x63\x72\171\160\x74": $params = ["\x63\157\163\x74" => $is_admin ? $this->config->item("\x62\x63\x72\x79\160\x74\137\141\x64\155\151\156\x5f\143\x6f\x73\x74", "\x69\x6f\x6e\137\141\x75\x74\x68") : $this->config->item("\142\x63\162\171\x70\x74\x5f\144\x65\x66\x61\x75\154\x74\x5f\x63\x6f\x73\x74", "\x69\157\156\x5f\x61\x75\164\x68")]; goto elU33; case "\x61\162\x67\157\x6e\x32": $params = $is_admin ? $this->config->item("\x61\x72\147\x6f\156\62\137\141\x64\155\151\x6e\x5f\160\141\162\x61\x6d\x73", "\151\157\x6e\137\141\x75\x74\x68") : $this->config->item("\141\x72\147\157\156\x32\x5f\144\x65\146\x61\x75\154\x74\137\x70\141\x72\141\x6d\x73", "\151\x6f\156\x5f\x61\165\164\150"); goto elU33; default: } goto gmtEO; HyTa3: if (!$identity) { goto cHivc; } goto hZt1m; AaG9K: DBji2: goto ESVJQ; Cj4iB: $is_admin = FALSE; goto HyTa3; WW26y: } protected function _get_hash_algo() { goto KWnd9; W7KPf: return $algo; goto ohtKa; tEx3F: s9RaP: goto W7KPf; iAvdV: XGbtP: goto tEx3F; KWnd9: $algo = FALSE; goto MXMlG; MXMlG: switch ($this->hash_method) { case "\142\x63\x72\x79\160\164": $algo = PASSWORD_BCRYPT; goto s9RaP; case "\x61\x72\x67\x6f\x6e\x32": $algo = PASSWORD_ARGON2I; goto s9RaP; default: } goto iAvdV; ohtKa: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto Zg_Xb; zh1oC: $validator_hashed = $this->hash_password($validator); goto MPNX2; EgF3O: $validator = $this->_random_token($validator_size); goto zh1oC; MPNX2: $user_code = "{$selector}\56{$validator}"; goto eJ9Zk; Zg_Xb: $selector = $this->_random_token($selector_size); goto EgF3O; eJ9Zk: return (object) ["\163\145\x6c\x65\143\x74\157\x72" => $selector, "\166\141\154\151\x64\141\x74\x6f\162\x5f\150\x61\x73\x68\x65\x64" => $validator_hashed, "\165\163\x65\x72\x5f\x63\x6f\144\x65" => $user_code]; goto Y8uUJ; Y8uUJ: } protected function _retrieve_selector_validator_couple($user_code) { goto n8ZMf; Dz6BI: return (object) ["\163\x65\154\x65\143\164\157\x72" => $tokens[0], "\x76\141\154\x69\144\141\164\x6f\162" => $tokens[1]]; goto GBWEC; M_sAk: return FALSE; goto aF2P8; GBWEC: Ca_RQ: goto mwBVY; mwBVY: LKu9T: goto M_sAk; n8ZMf: if (!$user_code) { goto LKu9T; } goto YG32V; TMKZQ: if (!(count($tokens) === 2)) { goto Ca_RQ; } goto Dz6BI; YG32V: $tokens = explode("\x2e", $user_code); goto TMKZQ; aF2P8: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto nFZxh; ZFndV: if ($salt_length) { goto OSjh1; } goto XHIuW; Z55zg: $this->trigger_events(["\x70\157\163\164\x5f\x73\150\141\61\x5f\x70\141\x73\163\x77\157\x72\x64\137\x6d\151\x67\x72\141\x74\x69\157\156", "\160\157\163\x74\x5f\163\150\141\61\137\160\x61\163\163\167\x6f\x72\x64\137\155\151\x67\162\x61\x74\x69\157\156\137\165\156\x73\x75\143\143\145\163\163\146\165\x6c"]); goto Sf1Cb; Z7C2r: $salt = substr($hashed_password_db, 0, $salt_length); goto y4_N5; vbyhp: if (!($query->num_rows() !== 1)) { goto Il1eS; } goto tNpY_; zaRE5: $query = $this->db->select("\x73\141\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\163"]); goto HuLuF; gHhay: OSjh1: goto Z7C2r; niAUK: if ($result) { goto seahz; } goto tML5V; XHIuW: $this->trigger_events(["\x70\157\x73\x74\x5f\163\150\141\61\x5f\x70\141\x73\x73\x77\x6f\x72\144\137\x6d\x69\x67\162\x61\164\x69\x6f\x6e", "\160\157\x73\164\x5f\x73\150\141\x31\137\160\x61\x73\x73\x77\x6f\x72\x64\137\x6d\x69\x67\162\141\x74\151\x6f\x6e\137\165\x6e\163\x75\x63\143\x65\163\163\146\x75\154"]); goto ph2MJ; gh67y: return FALSE; goto uirfS; n7GGE: return $result; goto XURf9; uirfS: Il1eS: goto mkpXY; OVlRC: v2zIt: goto f71LC; XWr2J: $result = $this->_set_password_db($identity, $password); goto niAUK; Yc3cu: if ($this->config->item("\x73\164\x6f\162\145\137\x73\141\154\x74", "\151\x6f\156\137\141\165\164\x68")) { goto T1PQp; } goto KyWVs; lupib: goto OnV6V; goto bSQIx; qL_1M: OnV6V: goto n7GGE; tNpY_: $this->trigger_events(["\x70\x6f\163\x74\x5f\163\x68\x61\61\137\x70\x61\x73\163\x77\157\x72\x64\137\x6d\151\147\162\141\x74\x69\157\156", "\x70\x6f\x73\x74\137\163\150\141\61\x5f\x70\x61\x73\163\x77\157\162\144\x5f\x6d\151\147\162\x61\164\151\x6f\x6e\137\165\x6e\163\x75\143\x63\x65\163\163\146\165\154"]); goto gh67y; mkpXY: $hashed_password = sha1($password . $salt_db->salt); goto OVlRC; tML5V: $this->trigger_events(["\x70\x6f\x73\x74\x5f\163\x68\x61\x31\137\160\141\x73\163\167\157\x72\144\x5f\x6d\x69\x67\162\141\x74\151\x6f\x6e", "\x70\x6f\x73\x74\x5f\163\x68\x61\x31\137\160\141\x73\x73\167\x6f\162\x64\x5f\x6d\151\x67\162\141\164\151\x6f\156\137\165\x6e\x73\165\143\x63\145\x73\163\x66\x75\154"]); goto lupib; f71LC: if ($hashed_password === $hashed_password_db) { goto aPjMG; } goto Z55zg; y4_N5: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto WiUAB; bQtqv: T1PQp: goto zaRE5; SRkMQ: aPjMG: goto XWr2J; ph2MJ: return FALSE; goto gHhay; WiUAB: goto v2zIt; goto bQtqv; HuLuF: $salt_db = $query->row(); goto vbyhp; nFZxh: $this->trigger_events("\160\162\145\137\163\150\141\61\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\137\x6d\151\147\162\x61\164\x69\157\156"); goto Yc3cu; tulIZ: $this->trigger_events(["\x70\x6f\x73\164\137\x73\150\x61\61\x5f\160\x61\x73\x73\x77\x6f\162\x64\x5f\x6d\151\147\x72\141\x74\151\157\x6e", "\160\157\163\x74\x5f\x73\x68\x61\x31\137\160\x61\163\x73\x77\157\162\144\137\x6d\x69\x67\162\x61\x74\x69\157\x6e\x5f\163\165\x63\143\145\x73\x73\x66\165\154"]); goto qL_1M; bSQIx: seahz: goto tulIZ; KyWVs: $salt_length = $this->config->item("\163\x61\x6c\x74\x5f\x6c\145\156\147\164\150", "\x69\x6f\156\x5f\x61\165\x74\150"); goto ZFndV; XURf9: hgvzz: goto H7phd; SDS7x: goto hgvzz; goto SRkMQ; Sf1Cb: return FALSE; goto SDS7x; H7phd: } }
