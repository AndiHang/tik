<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\x45\x50\x41\x54\110") or exit("\x4e\x6f\x20\144\x69\162\145\x63\164\40\x73\x63\162\x69\x70\x74\x20\141\x63\x63\145\x73\163\40\x61\154\x6c\x6f\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto W7u28; MuMlW: $this->message_start_delimiter = $this->error_start_delimiter; goto gvP3t; lHVtP: $this->error_start_delimiter = $this->config->item("\145\162\162\157\162\x5f\x73\x74\141\162\x74\x5f\x64\x65\x6c\x69\155\x69\x74\x65\162", "\x69\x6f\156\x5f\141\165\x74\x68"); goto Zmk03; cZC3j: $error_prefix->setAccessible(TRUE); goto uXJtd; a6tTY: $this->db = $CI->db; goto m2XVO; o1deR: $this->load->library("\x66\157\162\x6d\137\x76\141\x6c\151\144\x61\164\151\x6f\x6e"); goto qMqa9; Zmk03: $this->error_end_delimiter = $this->config->item("\x65\x72\x72\x6f\162\x5f\145\x6e\x64\x5f\144\x65\154\151\155\151\x74\145\162", "\x69\157\x6e\x5f\141\165\164\x68"); goto okCnG; qMqa9: $form_validation_class = new ReflectionClass("\x43\x49\137\106\157\162\155\137\x76\x61\154\x69\144\x61\164\x69\x6f\156"); goto kydwQ; m2XVO: O6cB2: goto jDPXQ; M68wd: $this->lang->load("\151\157\x6e\x5f\x61\165\164\150"); goto HCviN; HCviN: $group_name = $this->config->item("\144\141\164\x61\142\141\163\x65\x5f\x67\162\157\x75\160\x5f\156\x61\x6d\x65", "\x69\157\156\x5f\x61\x75\x74\150"); goto XyxK6; mUU8E: $this->trigger_events("\x6d\157\x64\x65\x6c\x5f\143\x6f\x6e\163\x74\162\165\143\164\x6f\162"); goto r6yod; jQVoY: $error_suffix->setAccessible(TRUE); goto tMkJP; K7zPm: $this->_ion_hooks = new stdClass(); goto mUU8E; qUQwV: cnI7L: goto YXzs7; fwJFT: $this->load->helper("\x64\141\x74\x65"); goto M68wd; o1UeM: $this->errors = []; goto lYmlQ; cALJ4: DHTtq: goto K7zPm; okCnG: goto DHTtq; goto gPPWe; Z9l5a: $this->message_start_delimiter = $this->config->item("\155\x65\x73\x73\x61\147\145\x5f\x73\164\x61\x72\x74\x5f\144\x65\154\x69\155\151\164\x65\x72", "\x69\157\156\137\x61\x75\164\x68"); goto mJt98; szgo2: goto O6cB2; goto qUQwV; jTLNE: $this->identity_column = $this->config->item("\x69\144\145\156\x74\151\x74\x79", "\x69\157\156\x5f\141\165\164\150"); goto SeWJK; jDPXQ: $this->tables = $this->config->item("\164\141\142\154\145\x73", "\x69\x6f\x6e\137\x61\x75\164\x68"); goto jTLNE; mJt98: $this->message_end_delimiter = $this->config->item("\x6d\145\163\x73\141\x67\145\x5f\x65\x6e\144\137\144\145\x6c\x69\155\151\164\145\x72", "\x69\157\x6e\137\141\x75\164\150"); goto lHVtP; YtpBo: $this->load->helper("\143\x6f\157\x6b\151\145"); goto fwJFT; W7u28: $this->config->load("\151\x6f\x6e\x5f\141\x75\x74\x68", TRUE); goto YtpBo; X56gD: $this->hash_method = $this->config->item("\x68\141\x73\150\137\155\x65\164\x68\157\x64", "\x69\157\x6e\x5f\141\x75\164\150"); goto UMM2W; E_BKC: $this->message_end_delimiter = $this->error_end_delimiter; goto cALJ4; qUGpy: if ($delimiters_source === "\146\157\162\155\x5f\166\x61\x6c\151\144\141\x74\151\x6f\156") { goto hGbmI; } goto Z9l5a; gvP3t: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\x72\157\x72\137\x73\x75\x66\146\x69\170"); goto jQVoY; lYmlQ: $delimiters_source = $this->config->item("\144\x65\154\151\x6d\x69\x74\x65\162\163\x5f\163\157\x75\162\143\x65", "\x69\x6f\x6e\137\141\165\164\x68"); goto qUGpy; SeWJK: $this->join = $this->config->item("\152\x6f\x69\156", "\151\x6f\x6e\137\x61\x75\164\x68"); goto X56gD; XyxK6: if (empty($group_name)) { goto cnI7L; } goto IeJDM; YXzs7: $CI =& get_instance(); goto a6tTY; gPPWe: hGbmI: goto o1deR; uXJtd: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto MuMlW; kydwQ: $error_prefix = $form_validation_class->getProperty("\x5f\x65\x72\x72\x6f\x72\137\160\x72\145\x66\x69\170"); goto cZC3j; IeJDM: $this->db = $this->load->database($group_name, TRUE, TRUE); goto szgo2; tMkJP: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto E_BKC; UMM2W: $this->messages = []; goto o1UeM; r6yod: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto vqp3J; tLaIh: return FALSE; goto UIMAZ; vp2Zg: if (!($algo !== FALSE && $params !== FALSE)) { goto BTgma; } goto lqJRB; I9e6l: $params = $this->_get_hash_parameters($identity); goto vp2Zg; FKMi3: BTgma: goto tLaIh; FdNfK: $algo = $this->_get_hash_algo(); goto I9e6l; cct0y: return FALSE; goto wIvfl; wIvfl: RfzqB: goto FdNfK; lqJRB: return password_hash($password, $algo, $params); goto FKMi3; vqp3J: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto RfzqB; } goto cct0y; UIMAZ: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto jGXRp; uppBk: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto DhZa8; DhZa8: goto d8b3F; goto LG5l3; TavNp: return FALSE; goto HqSPs; A7FqY: d8b3F: goto k5s2j; lEsgc: return password_verify($password, $hash_password_db); goto A7FqY; LG5l3: U2Ypk: goto lEsgc; zdupa: if (strpos($hash_password_db, "\44") === 0) { goto U2Ypk; } goto uppBk; jGXRp: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto Te9_K; } goto TavNp; HqSPs: Te9_K: goto zdupa; k5s2j: } public function rehash_password_if_needed($hash, $identity, $password) { goto Yz_VA; lGqsK: if (!($algo !== FALSE && $params !== FALSE)) { goto jNTny; } goto IsY_w; KfLgl: if ($this->_set_password_db($identity, $password)) { goto XiaQh; } goto jEmlu; TZDon: XiaQh: goto knbw3; IsY_w: if (!password_needs_rehash($hash, $algo, $params)) { goto xZs17; } goto KfLgl; MOB0U: jNTny: goto A19A4; BeUcK: xZs17: goto MOB0U; Yz_VA: $algo = $this->_get_hash_algo(); goto xHliW; cpHM6: TpQU5: goto BeUcK; jEmlu: $this->trigger_events(["\x72\x65\x68\x61\x73\x68\x5f\160\x61\163\163\x77\x6f\x72\144", "\x72\x65\x68\x61\163\x68\x5f\x70\141\x73\163\167\x6f\162\144\137\x75\156\163\165\x63\143\x65\163\x73\x66\165\x6c"]); goto iZgHP; iZgHP: goto TpQU5; goto TZDon; xHliW: $params = $this->_get_hash_parameters($identity); goto lGqsK; knbw3: $this->trigger_events(["\x72\145\150\x61\x73\x68\137\160\141\163\163\167\x6f\x72\144", "\x72\145\150\x61\163\150\137\x70\x61\x73\x73\x77\157\162\144\x5f\163\165\143\143\x65\x73\163\x66\165\154"]); goto cpHM6; A19A4: } public function get_user_by_activation_code($user_code) { goto Jfbnz; Jfbnz: $token = $this->_retrieve_selector_validator_couple($user_code); goto Cxjzt; aPjlT: if (!$user) { goto eI29K; } goto THk6y; RCNI0: Rt_rA: goto O0rpO; Cxjzt: $user = $this->where("\x61\x63\x74\x69\x76\x61\x74\x69\157\x6e\x5f\163\x65\154\x65\x63\164\x6f\162", $token->selector)->users()->row(); goto aPjlT; THk6y: if (!$this->verify_password($token->validator, $user->activation_code)) { goto Rt_rA; } goto ru7Pw; R_ii5: return FALSE; goto ikLTe; ru7Pw: return $user; goto RCNI0; O0rpO: eI29K: goto R_ii5; ikLTe: } public function activate($id, $code = FALSE) { goto XFbjx; J8LE_: $user = $this->get_user_by_activation_code($code); goto T81yg; HH3uO: $this->trigger_events(["\160\x6f\163\164\137\x61\143\164\x69\x76\141\x74\145", "\x70\157\163\x74\137\x61\x63\x74\151\x76\141\164\x65\137\165\x6e\163\x75\143\x63\145\163\163\146\165\x6c"]); goto QWjwz; gQxOW: $this->set_message("\141\143\164\151\x76\141\x74\145\137\163\x75\143\143\145\163\163\x66\x75\154"); goto Xz0Ug; Xz0Ug: return TRUE; goto uM7Pu; R2lR9: if (!($code !== FALSE)) { goto sT06a; } goto J8LE_; Oq1QL: if (!($code === FALSE || $user && $user->id === $id)) { goto abjUP; } goto Swoxv; uM7Pu: CyLLR: goto YwPAP; Swoxv: $data = ["\x61\143\x74\x69\x76\x61\164\x69\157\x6e\137\163\x65\154\x65\143\164\157\x72" => NULL, "\x61\143\x74\x69\x76\141\x74\151\x6f\156\137\x63\157\144\x65" => NULL, "\x61\x63\164\x69\166\x65" => 1]; goto Pw5Nk; Pw5Nk: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\150\145\x72\145"); goto XRyv7; XRyv7: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, ["\151\x64" => $id]); goto w15ZU; qAOJb: return FALSE; goto y039p; YwPAP: abjUP: goto HH3uO; XFbjx: $this->trigger_events("\160\x72\145\x5f\x61\x63\x74\151\x76\141\x74\x65"); goto R2lR9; w15ZU: if (!($this->db->affected_rows() === 1)) { goto CyLLR; } goto r55CI; QWjwz: $this->set_error("\x61\x63\x74\151\166\x61\x74\145\x5f\x75\x6e\x73\x75\x63\143\145\163\163\146\x75\154"); goto qAOJb; r55CI: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x61\x63\x74\x69\x76\x61\x74\145", "\x70\x6f\x73\x74\137\x61\143\164\151\166\x61\x74\x65\x5f\x73\165\x63\143\x65\163\163\146\x75\154"]); goto gQxOW; T81yg: sT06a: goto Oq1QL; y039p: } public function deactivate($id = NULL) { goto ULRT0; TizNc: $this->set_message("\x64\x65\x61\143\x74\151\166\141\x74\x65\137\163\165\x63\143\x65\x73\163\146\165\x6c"); goto VDfl6; RXuU1: return $return; goto kCOTX; zEyLM: $this->set_error("\x64\145\141\x63\164\x69\166\x61\x74\145\137\x63\165\x72\162\x65\156\x74\x5f\165\163\x65\x72\x5f\165\156\163\x75\x63\143\x65\x73\x73\146\165\x6c"); goto wFikB; Rphrt: $this->trigger_events("\145\x78\164\162\141\137\167\150\x65\162\x65"); goto UH2eI; wFikB: return FALSE; goto ZlrOa; XpAcl: $return = $this->db->affected_rows() == 1; goto hphan; hphan: if ($return) { goto z5b3E; } goto yNjON; luMVp: if (!isset($id)) { goto ZWkiF; } goto gy30d; gy30d: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto CaGHB; } goto zEyLM; WwQcK: vI2Vp: goto Vm1Rk; Vm1Rk: $token = $this->_generate_selector_validator_couple(20, 40); goto kH763; N6c_G: $data = ["\x61\143\x74\151\x76\141\164\151\157\156\137\x73\x65\x6c\x65\143\164\x6f\x72" => $token->selector, "\x61\x63\164\x69\166\x61\x74\151\x6f\156\x5f\x63\x6f\x64\x65" => $token->validator_hashed, "\x61\x63\164\x69\166\145" => 0]; goto Rphrt; UY63N: return FALSE; goto WwQcK; ZlrOa: CaGHB: goto kqanr; ffMN0: z5b3E: goto TizNc; cQc7v: goto eh5Cc; goto ffMN0; UH2eI: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, ["\151\x64" => $id]); goto XpAcl; kqanr: goto vI2Vp; goto mybik; yNjON: $this->set_error("\144\x65\141\x63\164\151\x76\x61\164\x65\137\x75\156\x73\165\143\143\145\x73\x73\x66\165\154"); goto cQc7v; kH763: $this->activation_code = $token->user_code; goto N6c_G; mybik: ZWkiF: goto KU5ul; ULRT0: $this->trigger_events("\144\x65\x61\x63\164\151\166\141\164\x65"); goto luMVp; VDfl6: eh5Cc: goto RXuU1; KU5ul: $this->set_error("\144\145\141\x63\164\151\x76\141\x74\145\x5f\165\x6e\x73\x75\x63\x63\x65\x73\x73\x66\165\154"); goto UY63N; kCOTX: } public function clear_forgotten_password_code($identity) { goto Xk8MG; wANsy: return FALSE; goto zc0n4; kNTy3: return TRUE; goto ezzjs; qSOI_: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto kNTy3; Xk8MG: if (!empty($identity)) { goto G6NH4; } goto wANsy; zc0n4: G6NH4: goto kwSPE; kwSPE: $data = ["\146\x6f\162\147\x6f\164\x74\145\156\137\160\x61\163\163\x77\157\x72\144\137\163\145\x6c\x65\143\x74\157\162" => NULL, "\146\157\x72\x67\157\164\x74\145\156\137\160\x61\x73\163\x77\x6f\x72\144\137\143\157\144\145" => NULL, "\x66\x6f\162\147\157\x74\164\x65\x6e\x5f\160\x61\163\x73\x77\x6f\162\x64\137\x74\x69\x6d\x65" => NULL]; goto qSOI_; ezzjs: } public function clear_remember_code($identity) { goto Wbs2A; rVyUy: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, [$this->identity_column => $identity]); goto h_vNm; XjjKG: $data = ["\162\145\155\145\x6d\x62\145\x72\137\x73\145\154\x65\x63\164\x6f\162" => NULL, "\x72\x65\155\145\x6d\x62\x65\x72\x5f\x63\157\144\145" => NULL]; goto rVyUy; RdwGJ: return FALSE; goto gJUwI; h_vNm: return TRUE; goto U5chs; gJUwI: hihZZ: goto XjjKG; Wbs2A: if (!empty($identity)) { goto hihZZ; } goto RdwGJ; U5chs: } public function reset_password($identity, $new) { goto Cx9cr; SQwd5: return $return; goto XYYys; x0cD_: if ($return) { goto zhxiX; } goto pPvdw; dwdwb: $this->set_error("\x70\141\163\163\x77\x6f\162\x64\x5f\143\x68\x61\x6e\x67\x65\137\x75\156\x73\165\143\x63\x65\163\163\x66\165\154"); goto Pvvrr; T7y6Z: return FALSE; goto My7fX; u7xJy: $this->trigger_events(["\x70\157\163\164\137\x63\150\x61\x6e\x67\x65\137\160\141\163\163\x77\x6f\162\x64", "\x70\x6f\x73\164\137\143\x68\x61\x6e\x67\x65\137\x70\141\163\163\167\x6f\162\144\x5f\x73\x75\143\143\145\163\163\146\165\154"]); goto g1J5_; g1J5_: $this->set_message("\x70\141\x73\x73\x77\157\x72\144\x5f\x63\150\x61\156\x67\x65\137\x73\x75\x63\143\145\163\x73\x66\165\154"); goto l07xc; ASPDb: $this->trigger_events(["\x70\x6f\x73\x74\137\143\150\141\x6e\147\145\x5f\x70\141\x73\x73\167\x6f\x72\144", "\160\x6f\x73\164\137\x63\150\x61\156\147\145\x5f\160\x61\163\x73\x77\x6f\162\x64\x5f\x75\x6e\163\165\143\143\x65\x73\163\x66\165\154"]); goto T7y6Z; zc3nR: if ($this->identity_check($identity)) { goto N65xZ; } goto ASPDb; pPvdw: $this->trigger_events(["\x70\x6f\x73\164\137\143\x68\141\x6e\147\x65\x5f\x70\x61\163\x73\x77\157\x72\x64", "\160\157\163\164\137\143\150\141\x6e\147\145\x5f\160\x61\x73\x73\167\x6f\162\144\137\x75\x6e\x73\x75\x63\143\x65\163\x73\146\165\x6c"]); goto dwdwb; WzroP: $return = $this->_set_password_db($identity, $new); goto x0cD_; Pvvrr: goto v1Ix8; goto A4FQX; Cx9cr: $this->trigger_events("\x70\x72\145\137\x63\x68\x61\x6e\x67\x65\x5f\160\x61\163\163\167\x6f\162\x64"); goto zc3nR; l07xc: v1Ix8: goto SQwd5; My7fX: N65xZ: goto WzroP; A4FQX: zhxiX: goto u7xJy; XYYys: } public function change_password($identity, $old, $new) { goto WcPVs; wy_so: return FALSE; goto RBgVu; vcBps: jADHE: goto angz0; RBgVu: BgP0l: goto vPwfF; pCTQN: $this->set_message("\x70\x61\163\x73\x77\x6f\x72\x64\137\x63\150\141\156\147\x65\x5f\163\x75\143\x63\x65\163\163\x66\x75\x6c"); goto REyyy; e2agv: goto D5rpS; goto vcBps; so6yV: $this->trigger_events(["\160\157\x73\x74\137\x63\x68\141\156\x67\x65\x5f\160\x61\x73\x73\x77\x6f\162\144", "\x70\x6f\x73\164\137\143\150\x61\156\147\x65\137\x70\x61\163\163\x77\x6f\162\144\x5f\165\x6e\x73\x75\143\x63\145\x73\x73\x66\x75\154"]); goto veolf; veolf: $this->set_error("\160\x61\x73\x73\x77\x6f\x72\144\x5f\x63\150\x61\x6e\x67\x65\137\165\x6e\163\x75\x63\x63\x65\x73\163\146\x75\154"); goto e2agv; xuptg: return $result; goto FuU6E; angz0: $this->trigger_events(["\x70\x6f\x73\x74\137\143\x68\x61\x6e\x67\145\137\x70\141\163\x73\x77\157\162\144", "\160\x6f\x73\x74\137\143\150\x61\156\147\145\x5f\160\141\163\163\x77\157\162\144\x5f\x73\165\x63\143\145\163\x73\x66\165\x6c"]); goto pCTQN; GSUbt: $this->set_error("\160\141\x73\163\167\x6f\162\144\137\143\150\141\x6e\147\145\137\165\x6e\163\x75\x63\x63\x65\163\163\x66\x75\154"); goto Mt5Ry; kI8t4: if (!($query->num_rows() !== 1)) { goto BgP0l; } goto H5XmB; gmARG: $result = $this->_set_password_db($identity, $new); goto IJ0kh; KXuxe: $this->set_error("\160\141\x73\163\x77\x6f\x72\x64\137\x63\x68\x61\x6e\x67\145\x5f\x75\156\x73\x75\143\x63\x65\163\x73\146\x75\x6c"); goto wy_so; WcPVs: $this->trigger_events("\x70\x72\x65\x5f\x63\150\141\x6e\x67\x65\137\x70\141\163\163\x77\157\x72\x64"); goto YxoZT; H5XmB: $this->trigger_events(["\x70\157\x73\x74\137\x63\150\x61\156\147\x65\137\x70\141\163\x73\167\x6f\162\x64", "\160\157\163\x74\x5f\x63\x68\x61\x6e\x67\x65\137\x70\141\x73\x73\x77\157\x72\x64\137\165\156\163\x75\143\x63\x65\163\163\146\165\x6c"]); goto KXuxe; IJ0kh: if ($result) { goto jADHE; } goto so6yV; FuU6E: kWXVx: goto GSUbt; Mt5Ry: return FALSE; goto WKlK6; REyyy: D5rpS: goto xuptg; YxoZT: $this->trigger_events("\x65\x78\x74\x72\141\x5f\167\x68\145\x72\145"); goto iPbEE; iPbEE: $query = $this->db->select("\151\144\x2c\x20\160\x61\x73\163\x77\x6f\x72\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\x73\143")->get($this->tables["\165\163\145\x72\163"]); goto kI8t4; vPwfF: $user = $query->row(); goto B8npk; B8npk: if (!$this->verify_password($old, $user->password, $identity)) { goto kWXVx; } goto gmARG; WKlK6: } public function username_check($username = '') { goto lupyY; wsqHF: return $this->db->where("\x75\163\x65\162\156\x61\155\x65", $username)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\x73"]) > 0; goto I2PEh; bvGOK: $this->trigger_events("\145\170\164\x72\x61\x5f\x77\x68\145\x72\x65"); goto wsqHF; uoSug: return FALSE; goto cTHwu; cTHwu: yXIDF: goto bvGOK; lupyY: $this->trigger_events("\x75\x73\x65\x72\x6e\x61\x6d\x65\x5f\x63\150\145\x63\x6b"); goto ygKPF; ygKPF: if (!empty($username)) { goto yXIDF; } goto uoSug; I2PEh: } public function email_check($email = '') { goto Vd18o; LMNV3: if (!empty($email)) { goto Yf0Hg; } goto Vzm1x; Vd18o: $this->trigger_events("\145\x6d\141\151\x6c\137\x63\150\x65\143\x6b"); goto LMNV3; Fzs8P: $this->trigger_events("\x65\170\x74\x72\x61\x5f\167\x68\145\x72\145"); goto bnKyq; bnKyq: return $this->db->where("\145\x6d\141\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\x73\145\x72\163"]) > 0; goto adsVo; yVhug: Yf0Hg: goto Fzs8P; Vzm1x: return FALSE; goto yVhug; adsVo: } public function identity_check($identity = '') { goto baz9t; BwdTK: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\145\162\163"]) > 0; goto bBqGn; r9MKs: whC_z: goto BwdTK; SPsoX: if (!empty($identity)) { goto whC_z; } goto wvP8n; wvP8n: return FALSE; goto r9MKs; baz9t: $this->trigger_events("\151\x64\x65\156\164\x69\164\171\137\143\150\145\143\153"); goto SPsoX; bBqGn: } public function get_user_id_from_identity($identity = '') { goto mclmT; em75b: return FALSE; goto qx1UM; wT88y: if (!($query->num_rows() !== 1)) { goto l4Gu7; } goto em75b; x22TG: uouI7: goto c2J9p; onPic: return FALSE; goto x22TG; W2cuD: return $user->id; goto gHsdL; c2J9p: $query = $this->db->select("\151\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\145\162\x73"]); goto wT88y; nCOpn: $user = $query->row(); goto W2cuD; mclmT: if (!empty($identity)) { goto uouI7; } goto onPic; qx1UM: l4Gu7: goto nCOpn; gHsdL: } public function forgotten_password($identity) { goto W2gyJ; RmA4S: return $token->user_code; goto U23zO; wuNy2: $this->trigger_events(["\x70\x6f\163\164\137\x66\x6f\x72\x67\157\164\x74\x65\x6e\137\160\x61\x73\163\x77\157\162\x64", "\160\157\x73\164\137\146\157\162\x67\x6f\x74\164\145\156\x5f\160\141\163\x73\x77\x6f\162\x64\137\x73\165\x63\x63\x65\163\163\146\165\x6c"]); goto RmA4S; YEO0Z: xV06d: goto lOTjY; A91cW: $this->trigger_events("\145\170\x74\162\x61\x5f\167\x68\145\162\x65"); goto gMJDR; wBQGC: HqlM6: goto wuNy2; W2gyJ: if (!empty($identity)) { goto xV06d; } goto mUzkO; HbMqp: return FALSE; goto wgbw1; JIusu: if ($this->db->affected_rows() === 1) { goto HqlM6; } goto hH7Mv; wgbw1: goto Wavro; goto wBQGC; gMJDR: $this->db->update($this->tables["\165\163\x65\162\163"], $update, [$this->identity_column => $identity]); goto JIusu; kgDV7: $update = ["\146\157\x72\147\x6f\164\x74\x65\x6e\137\160\141\x73\163\167\157\x72\x64\137\x73\x65\154\x65\x63\x74\157\x72" => $token->selector, "\146\x6f\x72\147\157\x74\x74\145\156\x5f\160\141\x73\x73\167\x6f\x72\x64\137\143\157\144\145" => $token->validator_hashed, "\146\157\x72\147\x6f\x74\164\x65\x6e\137\x70\x61\163\x73\167\157\x72\144\x5f\164\x69\x6d\x65" => time()]; goto A91cW; hH7Mv: $this->trigger_events(["\160\157\x73\x74\137\146\x6f\x72\x67\157\x74\164\145\x6e\137\x70\x61\163\x73\x77\x6f\162\144", "\x70\x6f\x73\x74\137\146\157\x72\147\157\x74\x74\x65\x6e\x5f\160\x61\x73\x73\x77\157\162\x64\137\x75\x6e\x73\165\x63\x63\x65\163\x73\146\165\154"]); goto HbMqp; lOTjY: $token = $this->_generate_selector_validator_couple(20, 80); goto kgDV7; mUzkO: $this->trigger_events(["\160\x6f\163\164\x5f\x66\157\x72\x67\157\x74\164\x65\x6e\137\160\x61\x73\x73\167\157\162\x64", "\x70\x6f\x73\164\137\x66\x6f\x72\x67\x6f\164\164\145\x6e\x5f\x70\x61\x73\163\x77\157\162\x64\137\165\156\x73\165\x63\x63\x65\x73\x73\146\165\154"]); goto pv5rM; U23zO: Wavro: goto J5Xx0; pv5rM: return FALSE; goto YEO0Z; J5Xx0: } public function get_user_by_forgotten_password_code($user_code) { goto z_W5v; z_W5v: $token = $this->_retrieve_selector_validator_couple($user_code); goto C4BqV; B0MTD: return $user; goto JHsGf; C4BqV: $user = $this->where("\146\157\x72\147\x6f\x74\164\145\x6e\x5f\x70\x61\x73\x73\x77\157\x72\144\137\163\145\x6c\145\143\x74\157\x72", $token->selector)->users()->row(); goto r4L2r; ug1YX: UPz1c: goto YWT63; YWT63: return FALSE; goto UYgv5; JHsGf: dvE_H: goto ug1YX; r4L2r: if (!$user) { goto UPz1c; } goto y_lgV; y_lgV: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto dvE_H; } goto B0MTD; UYgv5: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto VF_Db; nhWSq: $this->set_error("\141\143\x63\157\165\x6e\164\137\143\162\145\141\x74\x69\157\156\137\x69\x6e\166\x61\154\x69\x64\137\144\x65\x66\141\165\x6c\x74\137\x67\x72\157\165\x70"); goto m6V9w; TmGba: JsJZK: goto IeSp2; DQ92u: CxATg: goto OGfmf; tY0Z2: if ($this->identity_check($identity)) { goto H1z3Y; } goto Rkt7G; Yb5rX: $id = $this->db->insert_id($this->tables["\x75\x73\145\162\163"] . "\x5f\151\x64\x5f\163\x65\x71"); goto URVhh; m6V9w: return FALSE; goto Jx1u8; OGfmf: $this->trigger_events("\160\157\x73\164\137\162\145\147\x69\x73\x74\145\162"); goto RAzcT; vEIug: if (!(!isset($query->id) && empty($groups))) { goto pXXWx; } goto nhWSq; RAzcT: return isset($id) ? $id : FALSE; goto R5EA9; Jx1u8: pXXWx: goto TbHN_; Rkt7G: if (!(!$this->config->item("\144\145\x66\x61\x75\x6c\x74\x5f\x67\162\157\x75\160", "\151\157\x6e\x5f\x61\x75\x74\x68") && empty($groups))) { goto KJzTK; } goto F3tfB; ZrxDc: KJzTK: goto hm0LA; A2tLg: $data = [$this->identity_column => $identity, "\165\x73\145\162\x6e\x61\x6d\145" => $identity, "\x70\x61\x73\163\167\x6f\x72\144" => $password, "\145\x6d\141\x69\154" => $email, "\151\160\x5f\141\x64\144\x72\145\x73\x73" => $ip_address, "\x63\x72\145\141\x74\x65\144\x5f\157\156" => time(), "\141\x63\x74\151\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto UHKRV; bW_yi: if (!($password === FALSE)) { goto sR92E; } goto Ylq5K; hm0LA: goto JsJZK; goto vMK2c; s_3Eq: $this->db->insert($this->tables["\165\163\145\162\x73"], $user_data); goto Yb5rX; k0OX1: $this->set_error("\141\x63\x63\x6f\165\156\x74\137\x63\162\x65\141\x74\x69\157\156\137\144\x75\160\x6c\151\143\141\164\145\137\151\144\145\x6e\x74\151\x74\x79"); goto qiFAY; qiFAY: return FALSE; goto TmGba; wpRA6: $manual_activation = $this->config->item("\x6d\141\156\x75\141\154\137\141\143\x74\151\166\x61\164\x69\x6f\156", "\151\157\x6e\137\x61\165\164\150"); goto tY0Z2; dyc_S: $ip_address = $this->input->ip_address(); goto WJsis; Ylq5K: $this->set_error("\141\x63\143\157\x75\x6e\x74\137\x63\x72\x65\141\164\151\x6f\x6e\x5f\165\x6e\163\165\x63\x63\x65\x73\163\x66\x75\154"); goto W3Ofo; vMK2c: H1z3Y: goto k0OX1; W3Ofo: return FALSE; goto wxGh5; gBfP0: gm0dw: goto DQ92u; URVhh: if (!(isset($default_group->id) && empty($groups))) { goto mtWv4; } goto CM3fo; TbHN_: $default_group = $query; goto dyc_S; H1uE7: foreach ($groups as $group) { $this->add_to_group($group, $id); VjWpE: } goto gBfP0; wxGh5: sR92E: goto A2tLg; IeSp2: $query = $this->db->get_where($this->tables["\x67\x72\157\x75\160\x73"], ["\156\141\x6d\x65" => $this->config->item("\144\145\146\141\x75\154\164\x5f\x67\162\x6f\165\160", "\151\x6f\156\137\x61\x75\164\x68")], 1)->row(); goto vEIug; y5SFN: $this->trigger_events("\145\170\x74\x72\x61\x5f\x73\145\x74"); goto s_3Eq; xGCmv: mtWv4: goto QV2o7; ylvYK: return FALSE; goto ZrxDc; UHKRV: $user_data = array_merge($this->_filter_data($this->tables["\165\163\x65\162\163"], $additional_data), $data); goto y5SFN; F3tfB: $this->set_error("\141\143\143\x6f\165\156\x74\x5f\143\x72\145\141\x74\151\157\x6e\137\155\x69\163\163\x69\x6e\x67\x5f\144\145\146\x61\165\154\x74\137\x67\162\157\x75\160"); goto ylvYK; WJsis: $password = $this->hash_password($password); goto bW_yi; QV2o7: if (empty($groups)) { goto CxATg; } goto H1uE7; VF_Db: $this->trigger_events("\160\162\145\137\x72\x65\x67\151\163\x74\x65\162"); goto wpRA6; CM3fo: $groups[] = $default_group->id; goto xGCmv; R5EA9: } public function login($identity, $password, $remember = FALSE) { goto gK7FU; m003y: if (!$this->verify_password($password, $user->password, $identity)) { goto ZILGh; } goto lXB33; ey6v0: return TRUE; goto LQ12D; Jlo2v: $this->set_error("\154\157\x67\x69\156\x5f\165\156\163\x75\x63\x63\x65\163\163\146\165\x6c"); goto OryJM; NSbIE: $this->trigger_events("\x70\157\163\x74\137\154\157\147\x69\x6e\x5f\165\x6e\x73\x75\143\143\x65\163\x73\146\165\x6c"); goto bAVYD; eOTpU: goto PbTNg; goto dsZQL; Hjfl8: $this->clear_login_attempts($identity); goto hBTF6; ZeZZP: return FALSE; goto jAvdG; V4ACH: $this->trigger_events("\160\x6f\163\164\x5f\x6c\x6f\147\151\156\137\x75\x6e\x73\165\x63\143\x65\x73\163\x66\x75\154"); goto XI0Fp; LQ12D: ZILGh: goto ZkoJT; gK7FU: $this->trigger_events("\x70\162\x65\x5f\154\x6f\147\x69\156"); goto gUIJP; LoQT7: $this->trigger_events("\x65\x78\x74\162\141\x5f\167\150\145\x72\145"); goto WtlXt; ZkoJT: XZxY2: goto NfoqL; cOYMz: if ($remember) { goto ZlTJa; } goto qAvwy; a57CG: $this->hash_password($password); goto qCmrW; l1RB3: return FALSE; goto au1Ip; QaEOF: PbTNg: goto AQvPK; McKHl: return FALSE; goto Pu2PT; drByV: $this->set_error("\154\x6f\147\x69\x6e\137\x74\151\x6d\x65\157\x75\164"); goto l1RB3; bAVYD: $this->set_error("\154\x6f\x67\x69\156\x5f\165\156\x73\x75\143\x63\145\163\x73\146\165\x6c\137\156\157\164\x5f\x61\x63\164\x69\x76\x65"); goto McKHl; qAvwy: $this->clear_remember_code($identity); goto eOTpU; dsZQL: ZlTJa: goto Vwi9G; au1Ip: ATd3q: goto n63RC; vP07Q: $user = $query->row(); goto m003y; Pu2PT: CEPi_: goto Umvt8; hBTF6: $this->clear_forgotten_password_code($identity); goto pAhWv; gUIJP: if (!(empty($identity) || empty($password))) { goto Si9D5; } goto Jlo2v; lXB33: if (!($user->active == 0)) { goto CEPi_; } goto NSbIE; WtlXt: $query = $this->db->select($this->identity_column . "\54\x20\145\155\141\x69\x6c\54\40\x69\144\54\40\x70\141\x73\x73\167\x6f\x72\144\54\x20\141\143\x74\x69\166\145\54\40\x6c\x61\x73\x74\137\154\x6f\147\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\x73\143")->get($this->tables["\165\x73\x65\162\163"]); goto Us7EZ; AQvPK: mJx5R: goto xH2TE; qCmrW: $this->trigger_events("\x70\157\163\164\137\x6c\x6f\x67\151\156\137\x75\156\163\x75\x63\143\x65\163\163\x66\x75\x6c"); goto drByV; Umvt8: $this->set_session($user); goto eBiYx; Us7EZ: if (!$this->is_max_login_attempts_exceeded($identity)) { goto ATd3q; } goto a57CG; NfoqL: $this->hash_password($password); goto r06jG; r06jG: $this->increase_login_attempts($identity); goto V4ACH; XI0Fp: $this->set_error("\154\157\147\151\x6e\137\x75\156\163\165\x63\x63\145\x73\163\146\165\154"); goto ZeZZP; Vwi9G: $this->remember_user($identity); goto QaEOF; pAhWv: if (!$this->config->item("\162\145\x6d\145\155\142\x65\x72\137\165\x73\145\162\x73", "\x69\x6f\156\x5f\x61\165\164\x68")) { goto mJx5R; } goto cOYMz; WeYU5: $this->set_message("\154\157\147\x69\156\137\x73\x75\143\x63\x65\163\163\146\x75\154"); goto ey6v0; n63RC: if (!($query->num_rows() === 1)) { goto XZxY2; } goto vP07Q; xH2TE: $this->rehash_password_if_needed($user->password, $identity, $password); goto SaZQn; pUa_Z: $this->trigger_events(["\x70\157\163\x74\137\154\x6f\147\151\x6e", "\160\x6f\163\x74\x5f\x6c\157\x67\151\156\x5f\x73\x75\x63\143\145\163\x73\x66\165\x6c"]); goto WeYU5; eBiYx: $this->update_last_login($user->id); goto Hjfl8; SaZQn: $this->session->sess_regenerate(FALSE); goto pUa_Z; OryJM: return FALSE; goto naBT2; naBT2: Si9D5: goto LoQT7; jAvdG: } public function recheck_session() { goto YcbJU; eprDO: goto bWfUD; goto A1ZUK; TfkHf: if ($query->num_rows() === 1) { goto rm6Ea; } goto JWssq; PXG2K: if (!($recheck !== 0)) { goto RQLBN; } goto HlCkK; JWssq: $this->trigger_events("\x6c\x6f\147\x6f\x75\164"); goto BIP5Q; AVhkM: if (!($last_login + $recheck < time())) { goto QY42_; } goto G_9ul; YcbJU: $recheck = NULL !== $this->config->item("\x72\x65\x63\150\145\x63\x6b\x5f\164\x69\x6d\145\x72", "\151\157\156\137\141\165\x74\150") ? $this->config->item("\162\145\x63\x68\x65\x63\x6b\x5f\164\x69\x6d\x65\162", "\x69\x6f\x6e\x5f\x61\x75\x74\150") : 0; goto PXG2K; A1ZUK: rm6Ea: goto yDpfr; zzzQU: $this->session->unset_userdata([$identity, "\151\x64", "\165\x73\x65\x72\x5f\x69\144"]); goto MWMzz; r7gI8: return (bool) $this->session->userdata("\x69\144\x65\x6e\164\151\164\x79"); goto Su6FF; HlCkK: $last_login = $this->session->userdata("\x6c\141\x73\164\137\x63\150\x65\x63\153"); goto AVhkM; MWMzz: return FALSE; goto eprDO; vd7KD: QY42_: goto LK6d7; yDpfr: $this->session->set_userdata("\x6c\141\163\x74\x5f\143\x68\145\x63\153", time()); goto IgHHJ; LK6d7: RQLBN: goto r7gI8; IgHHJ: bWfUD: goto vd7KD; G_9ul: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\151\144\145\x6e\164\151\164\x79"), "\141\x63\164\x69\x76\145" => "\61"])->limit(1)->order_by("\151\x64", "\144\145\163\x63")->get($this->tables["\x75\x73\145\x72\x73"]); goto TfkHf; BIP5Q: $identity = $this->config->item("\151\144\x65\x6e\164\x69\164\171", "\x69\157\x6e\x5f\x61\165\164\150"); goto zzzQU; Su6FF: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto LT48S; zT8UI: $attempts = $this->get_attempts_num($identity, $ip_address); goto B5U2I; nk5Na: return FALSE; goto IiQSa; tnWRg: pY_m6: goto wvX9H; yNeB6: $max_attempts = $this->config->item("\155\141\x78\x69\155\x75\155\137\x6c\x6f\x67\x69\x6e\x5f\x61\x74\164\145\155\x70\x74\x73", "\x69\x6f\x6e\x5f\x61\x75\164\150"); goto uDzJj; wvX9H: lRrDI: goto nk5Na; LT48S: if (!$this->config->item("\x74\162\x61\143\x6b\x5f\154\x6f\147\x69\x6e\137\x61\164\x74\x65\x6d\x70\164\x73", "\x69\157\156\137\141\x75\x74\150")) { goto lRrDI; } goto yNeB6; B5U2I: return $attempts >= $max_attempts; goto tnWRg; uDzJj: if (!($max_attempts > 0)) { goto pY_m6; } goto zT8UI; IiQSa: } public function get_attempts_num($identity, $ip_address = NULL) { goto R1mDB; R1mDB: if (!$this->config->item("\x74\162\141\143\153\x5f\x6c\157\x67\151\x6e\137\x61\x74\x74\145\155\x70\164\163", "\x69\x6f\156\137\141\165\x74\x68")) { goto aU0Lx; } goto jm16H; zkTKd: $qres = $this->db->get($this->tables["\154\157\x67\151\156\137\x61\164\164\145\155\x70\164\x73"]); goto jYe5Z; WxP6l: $this->db->where("\151\160\x5f\141\x64\x64\x72\x65\x73\163", $ip_address); goto Qqq_J; jYe5Z: return $qres->num_rows(); goto S4_jf; TcII1: $this->db->where("\154\157\147\151\x6e", $identity); goto BiTWQ; RDe6a: if (isset($ip_address)) { goto uW9U2; } goto Y47lV; AXcUc: $this->db->where("\x74\x69\x6d\x65\40\76", time() - $this->config->item("\154\x6f\x63\x6b\x6f\165\164\x5f\164\151\155\x65", "\151\157\x6e\137\x61\x75\x74\x68"), FALSE); goto zkTKd; S4_jf: aU0Lx: goto twqVK; jm16H: $this->db->select("\61", FALSE); goto TcII1; twqVK: return 0; goto IAiP4; Y47lV: $ip_address = $this->input->ip_address(); goto rrF60; rrF60: uW9U2: goto WxP6l; Qqq_J: RvywW: goto AXcUc; BiTWQ: if (!$this->config->item("\164\162\141\x63\x6b\x5f\x6c\x6f\147\x69\x6e\137\151\x70\137\x61\x64\144\x72\145\x73\x73", "\151\x6f\x6e\137\141\165\x74\x68")) { goto RvywW; } goto RDe6a; IAiP4: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto ye9Vw; q94ki: f2xEX: goto BpZ8e; BpZ8e: return 0; goto H99Mf; L3STL: if (isset($ip_address)) { goto gln9K; } goto aclM8; jB0KF: sHcMM: goto q94ki; aclM8: $ip_address = $this->input->ip_address(); goto N4KKx; rZ4U3: $this->db->where("\154\157\147\151\x6e", $identity); goto j7jV7; TY_So: DBHJP: goto P02QA; j7jV7: if (!$this->config->item("\x74\162\x61\143\153\137\x6c\x6f\x67\151\x6e\x5f\x69\x70\x5f\x61\x64\x64\x72\x65\x73\x73", "\151\x6f\x6e\x5f\141\x75\164\150")) { goto DBHJP; } goto L3STL; WVgzz: if (!($qres->num_rows() > 0)) { goto sHcMM; } goto HVJpa; T5RyT: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\137\x61\x74\164\x65\155\x70\x74\163"], 1); goto WVgzz; HGFaP: $this->db->select("\x74\x69\x6d\x65"); goto rZ4U3; ye9Vw: if (!$this->config->item("\164\x72\x61\143\153\137\x6c\157\x67\x69\156\137\141\164\164\x65\155\160\164\163", "\x69\157\x6e\x5f\x61\165\x74\150")) { goto f2xEX; } goto HGFaP; P02QA: $this->db->order_by("\x69\x64", "\144\145\x73\x63"); goto T5RyT; HVJpa: return $qres->row()->time; goto jB0KF; N4KKx: gln9K: goto p9C0I; p9C0I: $this->db->where("\x69\x70\x5f\141\144\x64\162\x65\x73\x73", $ip_address); goto TY_So; H99Mf: } public function get_last_attempt_ip($identity) { goto Er2d1; hfmBA: $qres = $this->db->get($this->tables["\154\157\147\x69\x6e\137\141\164\164\x65\155\x70\164\x73"], 1); goto VlNkm; QeD8C: cOV9u: goto h7Z7q; IoeOl: return ''; goto ueKZA; CnMPN: $this->db->select("\151\x70\137\x61\144\x64\x72\x65\163\x73"); goto gL_fO; aa9pv: return $qres->row()->ip_address; goto QeD8C; Er2d1: if (!($this->config->item("\164\x72\x61\x63\x6b\x5f\154\157\x67\x69\x6e\x5f\141\x74\164\145\155\160\x74\x73", "\151\157\x6e\137\141\165\164\x68") && $this->config->item("\164\162\141\143\x6b\137\x6c\157\x67\151\x6e\137\151\x70\137\x61\x64\144\162\x65\x73\x73", "\x69\157\x6e\137\141\x75\x74\x68"))) { goto AP5UB; } goto CnMPN; VlNkm: if (!($qres->num_rows() > 0)) { goto cOV9u; } goto aa9pv; h7Z7q: AP5UB: goto IoeOl; gL_fO: $this->db->where("\154\x6f\x67\151\x6e", $identity); goto PnFdY; PnFdY: $this->db->order_by("\x69\144", "\144\145\x73\143"); goto hfmBA; ueKZA: } public function increase_login_attempts($identity) { goto eupb1; PJogE: if (!$this->config->item("\164\162\141\143\x6b\137\154\157\147\x69\x6e\137\151\x70\137\141\144\x64\162\145\x73\x73", "\151\x6f\156\137\141\x75\x74\x68")) { goto T2jJF; } goto iDPOj; wd9DA: y1jTx: goto tCdWA; tCdWA: return FALSE; goto qLHO7; t3FVI: return $this->db->insert($this->tables["\154\x6f\x67\x69\x6e\x5f\x61\x74\164\145\155\x70\164\163"], $data); goto wd9DA; ajBrr: T2jJF: goto t3FVI; pq98L: $data = ["\151\160\137\141\x64\x64\x72\145\163\163" => '', "\x6c\x6f\147\x69\x6e" => $identity, "\x74\x69\155\145" => time()]; goto PJogE; iDPOj: $data["\151\160\x5f\x61\144\x64\x72\x65\x73\163"] = $this->input->ip_address(); goto ajBrr; eupb1: if (!$this->config->item("\x74\162\x61\x63\153\137\154\x6f\147\151\156\137\141\x74\164\145\x6d\160\164\163", "\151\x6f\x6e\137\141\165\x74\150")) { goto y1jTx; } goto pq98L; qLHO7: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto MY5hJ; oLgZ0: if (isset($ip_address)) { goto V7yTg; } goto XKoqX; MY5hJ: if (!$this->config->item("\164\162\x61\x63\x6b\137\154\x6f\x67\x69\156\x5f\x61\x74\x74\145\155\x70\x74\163", "\x69\x6f\x6e\137\x61\165\164\150")) { goto PSIoa; } goto adyQN; F7wIC: HIV44: goto ngnCn; qDtdi: $this->db->where("\151\160\x5f\141\x64\x64\x72\x65\x73\163", $ip_address); goto F7wIC; O85ow: PSIoa: goto TiG6o; XKoqX: $ip_address = $this->input->ip_address(); goto qS3j1; ngnCn: $this->db->or_where("\x74\151\155\x65\40\74", time() - $old_attempts_expire_period, FALSE); goto OvRa7; fnU1Q: $this->db->where("\x6c\x6f\147\151\156", $identity); goto YcbnV; adyQN: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\x63\153\x6f\165\164\137\x74\151\155\145", "\151\157\156\x5f\141\x75\164\150")); goto fnU1Q; qS3j1: V7yTg: goto qDtdi; YcbnV: if (!$this->config->item("\x74\x72\x61\x63\153\137\x6c\157\x67\151\x6e\x5f\x69\160\137\141\x64\144\162\x65\x73\x73", "\x69\157\156\x5f\141\165\x74\150")) { goto HIV44; } goto oLgZ0; TiG6o: return FALSE; goto Vygwt; OvRa7: return $this->db->delete($this->tables["\x6c\157\147\x69\156\137\x61\164\x74\145\155\x70\x74\x73"]); goto O85ow; Vygwt: } public function limit($limit) { goto kKN9o; pXCbN: return $this; goto Jc4xB; oy2yD: $this->_ion_limit = $limit; goto pXCbN; kKN9o: $this->trigger_events("\x6c\151\x6d\151\x74"); goto oy2yD; Jc4xB: } public function offset($offset) { goto M5t0Q; QU1PF: return $this; goto ZD2mO; MtaqD: $this->_ion_offset = $offset; goto QU1PF; M5t0Q: $this->trigger_events("\x6f\x66\146\163\x65\164"); goto MtaqD; ZD2mO: } public function where($where, $value = NULL) { goto cUKx_; R1s8_: W_RC0: goto BW93k; Oolt7: return $this; goto FIuSb; vb6RL: if (is_array($where)) { goto W_RC0; } goto qg1rZ; BW93k: array_push($this->_ion_where, $where); goto Oolt7; qg1rZ: $where = [$where => $value]; goto R1s8_; cUKx_: $this->trigger_events("\x77\150\x65\162\145"); goto vb6RL; FIuSb: } public function like($like, $value = NULL, $position = "\142\x6f\x74\150") { goto kV0IG; AAFQF: array_push($this->_ion_like, ["\x6c\151\153\145" => $like, "\166\x61\x6c\165\145" => $value, "\160\157\x73\x69\164\x69\x6f\x6e" => $position]); goto tfcAE; kV0IG: $this->trigger_events("\154\x69\x6b\145"); goto AAFQF; tfcAE: return $this; goto kVc_a; kVc_a: } public function select($select) { goto sFDae; VSi0M: $this->_ion_select[] = $select; goto zwtyK; zwtyK: return $this; goto oTwXQ; sFDae: $this->trigger_events("\x73\145\x6c\x65\x63\x74"); goto VSi0M; oTwXQ: } public function order_by($by, $order = "\144\x65\x73\x63") { goto wWqZQ; wWqZQ: $this->trigger_events("\157\162\144\x65\x72\137\142\171"); goto QJi0Q; Jgt5J: $this->_ion_order = $order; goto J9jqV; J9jqV: return $this; goto N_2X_; QJi0Q: $this->_ion_order_by = $by; goto Jgt5J; N_2X_: } public function row() { goto oHsnE; oHsnE: $this->trigger_events("\162\x6f\167"); goto sWbno; s56l6: return $row; goto m7e7W; sWbno: $row = $this->response->row(); goto s56l6; m7e7W: } public function row_array() { goto bzIy9; bzIy9: $this->trigger_events(["\x72\157\x77", "\162\157\x77\x5f\x61\x72\x72\x61\x79"]); goto Z41nr; Bsx7u: return $row; goto YbsGp; Z41nr: $row = $this->response->row_array(); goto Bsx7u; YbsGp: } public function result() { goto PrrjR; PrrjR: $this->trigger_events("\x72\x65\x73\x75\x6c\164"); goto iTw1z; Tc6xS: return $result; goto Zo0O1; iTw1z: $result = $this->response->result(); goto Tc6xS; Zo0O1: } public function result_array() { goto Oc2sa; Oc2sa: $this->trigger_events(["\162\145\163\165\154\x74", "\x72\x65\163\165\x6c\164\x5f\x61\x72\162\x61\x79"]); goto U4sn1; syDHb: return $result; goto FwCka; U4sn1: $result = $this->response->result_array(); goto syDHb; FwCka: } public function num_rows() { goto ncBk6; ifh8Z: return $result; goto QjA6v; ncBk6: $this->trigger_events(["\x6e\x75\x6d\137\x72\157\x77\163"]); goto ov0Fp; ov0Fp: $result = $this->response->num_rows(); goto ifh8Z; QjA6v: } public function users($groups = NULL) { goto Ztd5H; TNW74: $this->_ion_like = []; goto HCl68; v003j: foreach ($this->_ion_where as $where) { $this->db->where($where); BotzP: } goto EA2Yr; VZN4Y: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto ea57p; } goto v003j; VANsK: iXqd_: goto yRrKZ; e9Q2E: if (empty($group_ids)) { goto HFmop; } goto OTnDP; wse19: f4Ls8: goto e9Q2E; Av136: if (!isset($this->_ion_limit)) { goto fnBoh; } goto Vj6v8; wJRX4: HFmop: goto lXsak; PP9YH: $this->db->distinct(); goto X7WWE; oeWcs: $this->db->select([$this->tables["\x75\x73\145\x72\163"] . "\x2e\x2a", $this->tables["\x75\163\x65\162\x73"] . "\56\151\x64\x20\x61\163\40\x69\144", $this->tables["\165\x73\145\162\x73"] . "\56\151\144\x20\141\x73\x20\x75\163\145\162\137\x69\x64"]); goto Tw9_W; v729f: $this->_ion_limit = NULL; goto p3fD1; ijVGx: $this->_ion_order_by = NULL; goto h1TC4; mqEQq: $this->_ion_offset = NULL; goto cle8o; RItDz: BeHJt: goto S21Qe; ymkSg: oq8Hl: goto OyUZl; l4YWt: $this->_ion_where = []; goto Ipomv; q5AVI: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto iXqd_; } goto Av136; OTnDP: $this->db->{$or_where_in}($this->tables["\x75\163\145\162\163\137\147\162\157\x75\x70\x73"] . "\56" . $this->join["\x67\x72\157\x75\160\x73"], $group_ids); goto wJRX4; cgw4O: $this->db->join($this->tables["\147\162\157\x75\x70\163"], $this->tables["\165\163\x65\162\x73\137\x67\x72\157\x75\160\163"] . "\x2e" . $this->join["\x67\x72\x6f\x75\x70\163"] . "\40\x3d\x20" . $this->tables["\147\x72\157\165\160\163"] . "\56\x69\x64", "\x69\x6e\156\x65\x72"); goto pA6bY; fq4Gy: $this->_ion_order = NULL; goto ijVGx; qQ4nh: return $this; goto FRwN3; Tw9_W: goto oq8Hl; goto RItDz; cle8o: dGldE: goto QyRqw; X2zpI: goto dGldE; goto VANsK; Vj6v8: $this->db->limit($this->_ion_limit); goto v729f; p3fD1: fnBoh: goto X2zpI; pDxgV: kn3ZH: goto TNW74; Q66IT: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\x6b\x65"], $like["\x76\x61\154\x75\x65"], $like["\160\x6f\163\151\x74\x69\157\x6e"]); zbdVv: } goto pDxgV; OyUZl: if (!isset($groups)) { goto VyDt6; } goto QcLvW; lLf6b: $group_names = []; goto PM77E; X7WWE: $this->db->join($this->tables["\165\x73\x65\162\163\x5f\x67\x72\x6f\165\x70\163"], $this->tables["\x75\x73\145\x72\x73\137\147\x72\157\165\x70\x73"] . "\56" . $this->join["\x75\x73\x65\162\163"] . "\x3d" . $this->tables["\165\x73\x65\162\163"] . "\56\x69\x64", "\x69\x6e\x6e\145\162"); goto snMc8; snMc8: YoCyr: goto tpCKu; Ipomv: ea57p: goto V6jQY; T69Ac: if (!(isset($groups) && !empty($groups))) { goto YoCyr; } goto PP9YH; PM77E: foreach ($groups as $group) { goto nbV4A; gtmcQ: $group_ids[] = $group; goto LnDA9; reGgl: $group_names[] = $group; goto dXhWl; XKmZi: bQgCB: goto hJQnV; dXhWl: goto UIHWY; goto MziY0; nbV4A: if (is_numeric($group)) { goto KfpeS; } goto reGgl; LnDA9: UIHWY: goto XKmZi; MziY0: KfpeS: goto gtmcQ; hJQnV: } goto JWmUH; QcLvW: if (is_array($groups)) { goto b0wnk; } goto Eczqi; QyRqw: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto AmqZd; } goto LZ4Mg; xT8BP: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\137\x77\150\x65\x72\145\x5f\151\x6e" : "\x77\150\x65\x72\145\137\151\x6e"; goto fwfif; Eczqi: $groups = [$groups]; goto pDqyL; lXsak: VyDt6: goto ElpCj; h1TC4: AmqZd: goto vRcPq; PKBEo: $this->_ion_limit = NULL; goto mqEQq; S21Qe: foreach ($this->_ion_select as $select) { $this->db->select($select); YU2LU: } goto zVN1R; zVN1R: Nf3mb: goto ZmeZ_; fwfif: if (empty($group_names)) { goto f4Ls8; } goto cgw4O; vRcPq: $this->response = $this->db->get($this->tables["\165\x73\145\x72\x73"]); goto qQ4nh; tpCKu: $group_ids = []; goto lLf6b; pDqyL: b0wnk: goto T69Ac; ElpCj: $this->trigger_events("\x65\170\164\162\x61\137\x77\x68\x65\162\x65"); goto VZN4Y; V6jQY: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto fvx9W; } goto Q66IT; Ztd5H: $this->trigger_events("\x75\163\x65\162\x73"); goto Xs2mx; pA6bY: $this->db->where_in($this->tables["\147\x72\x6f\x75\x70\163"] . "\x2e\x6e\141\x6d\x65", $group_names); goto wse19; LZ4Mg: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto fq4Gy; EA2Yr: wrDPb: goto l4YWt; JWmUH: a4EeH: goto xT8BP; ZmeZ_: $this->_ion_select = []; goto ymkSg; yRrKZ: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto PKBEo; Xs2mx: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto BeHJt; } goto oeWcs; HCl68: fvx9W: goto q5AVI; FRwN3: } public function user($id = NULL) { goto twHSK; zOQBy: $this->users(); goto w3_Py; YDpQR: $this->order_by($this->tables["\x75\163\x65\162\x73"] . "\x2e\x69\x64", "\x64\145\163\x63"); goto tk4pO; twHSK: $this->trigger_events("\x75\x73\145\x72"); goto CgC6e; CgC6e: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\x72\137\x69\x64"); goto kcQqv; tk4pO: $this->where($this->tables["\165\163\145\162\163"] . "\56\151\x64", $id); goto zOQBy; w3_Py: return $this; goto ur413; kcQqv: $this->limit(1); goto YDpQR; ur413: } public function get_users_groups($id = FALSE) { goto a5IC1; BGouJ: return $this->db->select($this->tables["\x75\163\145\162\x73\x5f\147\x72\x6f\165\160\x73"] . "\56" . $this->join["\x67\x72\x6f\x75\160\163"] . "\x20\x61\x73\x20\151\x64\54\x20" . $this->tables["\x67\162\x6f\x75\160\163"] . "\56\x6e\141\155\x65\x2c\40" . $this->tables["\x67\162\x6f\x75\160\x73"] . "\x2e\144\x65\x73\143\162\x69\x70\x74\x69\x6f\156")->where($this->tables["\165\163\x65\162\163\x5f\x67\162\157\165\x70\163"] . "\56" . $this->join["\x75\x73\x65\162\x73"], $id)->join($this->tables["\x67\x72\157\165\x70\x73"], $this->tables["\165\163\145\x72\163\x5f\147\162\157\x75\160\163"] . "\56" . $this->join["\147\x72\157\x75\160\x73"] . "\75" . $this->tables["\147\x72\x6f\165\160\163"] . "\56\151\144")->get($this->tables["\165\x73\x65\x72\163\x5f\x67\162\x6f\165\160\163"]); goto Ecjlp; yVsPR: $id || ($id = $this->session->userdata("\x75\163\x65\162\137\x69\144")); goto BGouJ; a5IC1: $this->trigger_events("\147\x65\x74\x5f\x75\x73\145\162\x73\x5f\147\x72\157\x75\160"); goto yVsPR; Ecjlp: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto dt94W; WtL2s: FNHfx: goto DP0FZ; t0bvy: wNHF2: goto has4W; x74p2: NZCTf: goto h9rSj; QX03W: mzNQn: goto kNG_7; nX4yO: goto NZCTf; goto QX03W; M95z0: $check_group = [$check_group]; goto bMQqv; APF1r: if (is_array($check_group)) { goto sGGkq; } goto M95z0; eWcQ7: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; ZpH4Q: } goto t0bvy; rzTmn: $users_groups = $this->get_users_groups($id)->result(); goto yjWvp; yjWvp: $groups_array = []; goto eWcQ7; h9rSj: foreach ($check_group as $key => $value) { goto mHLez; lRVr1: sbc8T: goto zIUQC; mHLez: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto O_5HD; O_5HD: if (!(in_array($value, $groups) xor $check_all)) { goto sbc8T; } goto I6EO1; I6EO1: return !$check_all; goto lRVr1; zIUQC: Hhs01: goto mZNHD; mZNHD: } goto WtL2s; EZDAc: $id || ($id = $this->session->userdata("\x75\x73\145\x72\x5f\x69\144")); goto APF1r; dt94W: $this->trigger_events("\x69\x6e\x5f\x67\x72\157\165\160"); goto EZDAc; has4W: $this->_cache_user_in_group[$id] = $groups_array; goto nX4yO; bMQqv: sGGkq: goto CgdBY; CgdBY: if (isset($this->_cache_user_in_group[$id])) { goto mzNQn; } goto rzTmn; kNG_7: $groups_array = $this->_cache_user_in_group[$id]; goto x74p2; DP0FZ: return $check_all; goto rYuXP; rYuXP: } public function add_to_group($group_ids, $user_id = FALSE) { goto NTHco; aZPeS: return $return; goto bqeZ_; eTDbi: sh00P: goto uLta0; RVCgV: $group_ids = [$group_ids]; goto eTDbi; uLta0: $return = 0; goto gRtgf; AMQ8E: if (is_array($group_ids)) { goto sh00P; } goto RVCgV; tdzr7: ynhGu: goto aZPeS; NTHco: $this->trigger_events("\141\x64\x64\x5f\164\157\137\147\162\x6f\165\160"); goto j4KPp; j4KPp: $user_id || ($user_id = $this->session->userdata("\x75\163\x65\x72\x5f\151\144")); goto AMQ8E; gRtgf: foreach ($group_ids as $group_id) { goto k6rHe; Xfoz2: $this->_cache_groups[$group_id] = $group_name; goto pNNxe; pNNxe: goto wmqLw; goto aRByj; oXfEI: $group = $this->group($group_id)->result(); goto YyojO; kWwY6: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto fMLM9; aRByj: fn9le: goto HJ5JQ; HJ5JQ: $group_name = $this->_cache_groups[$group_id]; goto A5hDt; k6rHe: if (!$this->db->insert($this->tables["\165\163\x65\162\163\x5f\x67\x72\157\x75\160\163"], [$this->join["\147\x72\157\165\160\x73"] => (float) $group_id, $this->join["\165\163\x65\x72\163"] => (float) $user_id])) { goto vu_UQ; } goto BF3Yk; A5hDt: wmqLw: goto kWwY6; oq_L_: vu_UQ: goto SkJxL; fMLM9: $return++; goto oq_L_; BF3Yk: if (isset($this->_cache_groups[$group_id])) { goto fn9le; } goto oXfEI; YyojO: $group_name = $group[0]->name; goto Xfoz2; SkJxL: i8gWP: goto uIUOD; uIUOD: } goto tdzr7; bqeZ_: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto jSlry; TwUor: UQNe_: goto TU4bx; cze42: TEqo8: goto W_qWk; NE6pq: zM1ED: goto tz4Jy; TU5EP: $this->_cache_user_in_group[$user_id] = []; goto W7gsA; aa4Px: he4b3: goto ZZ8b7; DQfy3: goto TEqo8; goto P7Hmn; kMKPd: if (!($return = $this->db->delete($this->tables["\165\163\x65\162\x73\137\x67\162\157\x75\160\x73"], [$this->join["\165\163\145\162\x73"] => (float) $user_id]))) { goto kVI7s; } goto TU5EP; ZZ8b7: foreach ($group_ids as $group_id) { goto wCdow; wCdow: $this->db->delete($this->tables["\165\163\145\162\163\x5f\147\162\157\x75\160\x73"], [$this->join["\x67\162\157\165\x70\163"] => (float) $group_id, $this->join["\x75\163\145\162\x73"] => (float) $user_id]); goto FOCE5; FOCE5: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto FsV_k; } goto RL8hT; tUIU4: FsV_k: goto KVgYM; RL8hT: unset($this->_cache_user_in_group[$user_id][$group_id]); goto tUIU4; KVgYM: A49Lo: goto M2qTS; M2qTS: } goto TwUor; jCgN4: return FALSE; goto NE6pq; TU4bx: $return = TRUE; goto cze42; LzIgY: if (!empty($user_id)) { goto zM1ED; } goto jCgN4; jSlry: $this->trigger_events("\x72\145\155\x6f\166\145\x5f\x66\x72\x6f\155\137\x67\162\x6f\165\160"); goto LzIgY; BHn4f: if (is_array($group_ids)) { goto he4b3; } goto o0b1I; o0b1I: $group_ids = [$group_ids]; goto aa4Px; W_qWk: return $return; goto gGcPP; tz4Jy: if (!empty($group_ids)) { goto CozU1; } goto kMKPd; W7gsA: kVI7s: goto DQfy3; P7Hmn: CozU1: goto BHn4f; gGcPP: } public function groups() { goto oqY2R; Gj_jm: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto GZsm9; jGtwi: t96tj: goto xeWzq; bg8TP: BWEFq: goto rXIM1; rXIM1: goto NY_UM; goto jGtwi; JcGdy: NY_UM: goto Lu66K; vES_7: BSW9h: goto E9AqR; GZsm9: bhkl2: goto tPvnv; oqY2R: $this->trigger_events("\147\x72\x6f\x75\160\163"); goto Tdg66; dEuX1: return $this; goto yWwOV; xeWzq: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto jecQw; Lu66K: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto bhkl2; } goto Gj_jm; tPvnv: $this->response = $this->db->get($this->tables["\x67\162\157\165\x70\x73"]); goto dEuX1; Nek2w: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto t96tj; } goto vdACT; SRGRL: $this->_ion_offset = NULL; goto JcGdy; E9AqR: $this->_ion_where = []; goto OW3Sd; MzB1w: $this->_ion_limit = NULL; goto bg8TP; KycWO: $this->db->limit($this->_ion_limit); goto MzB1w; vdACT: if (!isset($this->_ion_limit)) { goto BWEFq; } goto KycWO; jecQw: $this->_ion_limit = NULL; goto SRGRL; Tdg66: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto a3yWB; } goto eAmvF; OW3Sd: a3yWB: goto Nek2w; eAmvF: foreach ($this->_ion_where as $where) { $this->db->where($where); S63R_: } goto vES_7; yWwOV: } public function group($id = NULL) { goto ealoz; ealoz: $this->trigger_events("\147\x72\157\x75\x70"); goto vNXMC; j5i0n: $this->order_by("\151\x64", "\x64\145\163\143"); goto cHlKc; XLMQ0: $this->where($this->tables["\x67\x72\x6f\165\x70\163"] . "\56\x69\144", $id); goto T8DAm; vNXMC: if (!isset($id)) { goto sN4nT; } goto XLMQ0; T8DAm: sN4nT: goto QxAZ5; QxAZ5: $this->limit(1); goto j5i0n; cHlKc: return $this->groups(); goto V83P6; V83P6: } public function update($id, array $data) { goto PEt_F; F9IwV: return TRUE; goto IEmvi; H9EE_: qB0Eh: goto KUgqK; V_HMk: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto qB0Eh; } goto J2QIC; eZr_S: $this->set_error("\x75\x70\x64\141\164\x65\x5f\x75\156\x73\165\x63\143\x65\163\x73\146\x75\154"); goto Xp63n; odkM2: $this->trigger_events("\x65\170\164\x72\x61\137\x77\x68\145\162\x65"); goto thovz; Xp63n: return FALSE; goto H9EE_; j_wlT: bhZYu: goto Py1tF; lQMqB: $this->set_error("\165\160\144\141\x74\x65\137\x75\x6e\163\165\x63\143\145\163\x73\146\x75\154"); goto EWqD9; rUXbb: $user = $this->user($id)->row(); goto Lc8oL; Lc8oL: $this->db->trans_begin(); goto V_HMk; JePGR: $data["\x70\x61\163\x73\x77\x6f\162\144"] = $this->hash_password($data["\160\x61\x73\x73\167\157\x72\x64"], $user->{$this->identity_column}); goto XHSVW; PEt_F: $this->trigger_events("\160\x72\x65\137\x75\160\144\x61\164\x65\137\165\163\145\162"); goto rUXbb; mhIvJ: $this->trigger_events(["\x70\157\163\164\137\x75\160\x64\x61\x74\145\x5f\165\x73\x65\x72", "\x70\157\x73\x74\x5f\x75\x70\x64\141\164\x65\137\x75\x73\x65\162\137\x75\156\163\x75\143\x63\145\x73\163\x66\165\154"]); goto lQMqB; jwytY: goto R6xBC; goto ZnIZY; D7Dxz: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x75\160\144\x61\164\x65\x5f\x75\x73\145\162", "\x70\157\x73\x74\x5f\x75\x70\144\x61\x74\145\x5f\x75\163\145\162\x5f\x73\165\x63\143\x65\x73\x73\x66\165\154"]); goto Wmb4I; WqLdf: $this->db->trans_rollback(); goto mhIvJ; DvgZK: ybg3p: goto zjkRh; tfPOv: $this->set_error("\141\x63\x63\157\165\x6e\x74\137\143\162\x65\x61\x74\151\157\156\x5f\x64\x75\x70\x6c\151\x63\141\164\x65\137\x69\144\x65\x6e\164\151\164\x79"); goto Sid9s; Sid9s: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\x70\144\141\x74\x65\137\165\163\145\x72", "\160\x6f\163\x74\x5f\x75\160\x64\141\164\145\x5f\165\x73\x65\162\137\165\156\163\x75\143\x63\145\x73\x73\146\165\x6c"]); goto eZr_S; hv7Jb: if (!array_key_exists("\160\x61\x73\163\167\157\162\144", $data)) { goto bhZYu; } goto m5AGP; onliI: $this->db->trans_rollback(); goto OlwyN; N4vHG: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\141\x73\163\x77\157\162\x64", $data) || array_key_exists("\x65\155\141\x69\154", $data))) { goto j20P3; } goto hv7Jb; m5AGP: if (!empty($data["\160\141\x73\163\167\x6f\162\x64"])) { goto nc6vU; } goto VAIrg; Wmb4I: $this->set_message("\165\160\x64\x61\x74\x65\137\163\165\x63\143\x65\163\163\x66\165\154"); goto F9IwV; OlwyN: $this->trigger_events(["\160\x6f\x73\164\x5f\x75\x70\144\x61\164\145\x5f\x75\163\145\x72", "\x70\157\163\164\137\165\x70\144\141\x74\x65\137\x75\163\145\x72\x5f\165\x6e\163\x75\x63\143\x65\x73\163\x66\165\x6c"]); goto b3eRS; ZiVvl: $this->db->trans_commit(); goto D7Dxz; b3eRS: $this->set_error("\165\160\144\141\x74\x65\137\x75\156\x73\165\x63\143\145\163\x73\146\x75\x6c"); goto hQqRN; MhVZe: if (!($this->db->trans_status() === FALSE)) { goto tf3f5; } goto onliI; KUgqK: $data = $this->_filter_data($this->tables["\x75\x73\x65\162\x73"], $data); goto N4vHG; thovz: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, ["\151\x64" => $user->id]); goto MhVZe; J2QIC: $this->db->trans_rollback(); goto tfPOv; Eg_SE: tf3f5: goto ZiVvl; EWqD9: return FALSE; goto DvgZK; VAIrg: unset($data["\x70\141\x73\163\x77\x6f\x72\x64"]); goto jwytY; Py1tF: j20P3: goto odkM2; XHSVW: if (!($data["\160\141\163\163\x77\157\162\144"] === FALSE)) { goto ybg3p; } goto WqLdf; hQqRN: return FALSE; goto Eg_SE; ZnIZY: nc6vU: goto JePGR; zjkRh: R6xBC: goto j_wlT; IEmvi: } public function delete_user($id) { goto kOUIm; scJjk: if (!($this->db->trans_status() === FALSE)) { goto vRccp; } goto QHyD0; MmGtT: $this->trigger_events(["\160\x6f\163\164\137\144\145\x6c\x65\164\145\137\x75\x73\x65\162", "\x70\x6f\163\164\x5f\144\x65\154\x65\164\x65\137\165\163\x65\x72\x5f\163\x75\143\143\x65\163\x73\146\165\154"]); goto yxX0g; lLPZQ: return TRUE; goto Vf0PS; OSkuo: $this->db->delete($this->tables["\x75\163\x65\162\x73"], ["\x69\x64" => $id]); goto scJjk; gY229: return FALSE; goto rOMtd; yxX0g: $this->set_message("\x64\145\x6c\145\x74\145\137\x73\165\x63\143\145\x73\163\146\x75\154"); goto lLPZQ; zAzR9: $this->db->trans_begin(); goto UA6u3; nh9EE: $this->set_error("\x64\145\x6c\145\x74\x65\x5f\165\156\163\165\143\x63\145\x73\163\x66\x75\x6c"); goto gY229; jBLvj: $this->trigger_events(["\x70\x6f\163\164\x5f\144\145\x6c\x65\164\x65\137\165\163\x65\x72", "\x70\157\x73\164\x5f\x64\x65\154\145\164\x65\x5f\x75\163\145\x72\137\165\x6e\163\x75\x63\143\145\163\x73\x66\165\x6c"]); goto nh9EE; QHyD0: $this->db->trans_rollback(); goto jBLvj; kOUIm: $this->trigger_events("\x70\x72\x65\137\x64\145\154\145\164\x65\137\165\x73\x65\x72"); goto zAzR9; xo1tE: $this->db->trans_commit(); goto MmGtT; rOMtd: vRccp: goto xo1tE; UA6u3: $this->remove_from_group(NULL, $id); goto OSkuo; Vf0PS: } public function update_last_login($id) { goto EoTHk; EoTHk: $this->trigger_events("\x75\x70\144\x61\164\145\x5f\154\141\x73\164\137\154\x6f\147\x69\156"); goto XHxbU; qok89: $this->db->update($this->tables["\165\x73\145\162\163"], ["\154\141\x73\164\137\x6c\x6f\147\151\x6e" => time()], ["\151\x64" => $id]); goto VQQ6u; VQQ6u: return $this->db->affected_rows() == 1; goto QtZRl; qdVj8: $this->trigger_events("\145\170\164\162\x61\137\167\x68\x65\162\x65"); goto qok89; XHxbU: $this->load->helper("\x64\141\x74\145"); goto qdVj8; QtZRl: } public function set_lang($lang = "\x65\x6e") { goto zKaxJ; axE9f: return TRUE; goto PaQL2; uelOr: set_cookie(["\156\x61\x6d\145" => "\x6c\x61\x6e\147\137\143\157\144\x65", "\x76\141\154\165\x65" => $lang, "\145\170\160\151\162\145" => $expire]); goto axE9f; GtGt1: Po3sS: goto uelOr; JyckM: $expire = self::MAX_COOKIE_LIFETIME; goto GtGt1; ObMes: G71uo: goto JyckM; zKaxJ: $this->trigger_events("\163\x65\x74\137\x6c\141\156\x67"); goto TZnJw; TZnJw: if ($this->config->item("\x75\163\145\162\x5f\x65\x78\160\151\x72\145", "\151\157\156\137\141\x75\x74\x68") === 0) { goto G71uo; } goto aGtaZ; aGtaZ: $expire = $this->config->item("\165\x73\145\162\137\x65\170\x70\151\162\145", "\151\157\156\x5f\x61\165\x74\150"); goto ePLTB; ePLTB: goto Po3sS; goto ObMes; PaQL2: } public function set_session($user) { goto UMoCe; UMoCe: $this->trigger_events("\x70\x72\x65\137\x73\145\164\x5f\x73\145\x73\163\x69\157\x6e"); goto Z7JJy; gIPh0: $this->session->set_userdata($session_data); goto D3Q_r; xCesO: return TRUE; goto wVqyT; D3Q_r: $this->trigger_events("\160\x6f\163\164\137\x73\x65\x74\137\x73\x65\x73\163\x69\x6f\156"); goto xCesO; Z7JJy: $session_data = ["\151\144\x65\x6e\164\151\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\x6d\x61\151\154" => $user->email, "\x75\x73\145\162\x5f\151\144" => $user->id, "\x6f\154\x64\x5f\x6c\x61\163\164\x5f\x6c\157\147\151\x6e" => $user->last_login, "\154\141\x73\164\x5f\143\x68\x65\143\153" => time()]; goto gIPh0; wVqyT: } public function remember_user($identity) { goto hy1Vd; EECbZ: if ($identity) { goto AK9df; } goto h7zYo; sFkZn: if (!($this->db->affected_rows() > -1)) { goto vpHMA; } goto oNIs1; nSGZw: if (!$token->validator_hashed) { goto DDmjo; } goto I5tVp; EipWm: return TRUE; goto tLXrK; oNIs1: if ($this->config->item("\x75\x73\x65\x72\x5f\145\170\160\151\x72\145", "\151\157\156\x5f\141\165\x74\x68") === 0) { goto OxeTb; } goto vedTi; A3yQy: goto iRFB3; goto irQ8_; tLXrK: vpHMA: goto GkpyS; y8zhs: $token = $this->_generate_selector_validator_couple(); goto nSGZw; hy1Vd: $this->trigger_events("\160\x72\145\137\x72\x65\x6d\145\155\142\145\x72\137\x75\163\145\x72"); goto EECbZ; EjMvv: $expire = self::MAX_COOKIE_LIFETIME; goto r8QtQ; irQ8_: OxeTb: goto EjMvv; ovCFP: set_cookie(["\x6e\x61\x6d\145" => $this->config->item("\x72\145\x6d\x65\155\142\145\x72\137\x63\157\157\153\151\145\x5f\156\x61\x6d\145", "\151\157\x6e\x5f\141\165\164\x68"), "\166\x61\x6c\x75\145" => $token->user_code, "\x65\x78\x70\x69\x72\x65" => $expire]); goto j1jKy; NzQYm: $this->trigger_events(["\x70\x6f\x73\164\137\x72\x65\x6d\145\x6d\x62\145\162\137\165\163\x65\x72", "\162\x65\x6d\145\155\x62\145\x72\137\165\163\x65\162\x5f\165\156\163\165\143\143\x65\x73\163\x66\x75\154"]); goto QIoQQ; h7zYo: return FALSE; goto UrdwB; j1jKy: $this->trigger_events(["\160\157\163\x74\x5f\x72\x65\x6d\x65\155\142\145\x72\x5f\165\163\145\162", "\162\x65\x6d\145\x6d\x62\145\162\x5f\x75\x73\145\162\x5f\x73\x75\x63\143\x65\x73\x73\146\165\154"]); goto EipWm; I5tVp: $this->db->update($this->tables["\165\163\x65\162\163"], ["\162\145\x6d\145\155\142\145\162\137\163\145\x6c\145\x63\164\x6f\x72" => $token->selector, "\x72\x65\x6d\x65\155\x62\145\162\x5f\143\x6f\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto sFkZn; UrdwB: AK9df: goto y8zhs; r8QtQ: iRFB3: goto ovCFP; GkpyS: DDmjo: goto NzQYm; vedTi: $expire = $this->config->item("\165\163\145\x72\137\145\170\160\x69\x72\145", "\151\157\x6e\x5f\x61\165\x74\x68"); goto A3yQy; QIoQQ: return FALSE; goto VXuno; VXuno: } public function login_remembered_user() { goto gHjHu; ro5no: WD_iA: goto BcZDy; tJ3ag: $this->trigger_events(["\x70\x6f\163\x74\137\154\157\x67\151\x6e\x5f\x72\145\155\x65\155\142\x65\162\x65\x64\x5f\x75\163\x65\162", "\160\x6f\x73\164\x5f\154\157\147\151\156\x5f\x72\x65\155\145\155\x62\145\162\145\x64\137\165\163\145\x72\137\163\x75\143\143\145\163\163\x66\165\154"]); goto X6XqW; BcZDy: $this->session->sess_regenerate(FALSE); goto tJ3ag; fP2nV: $this->set_session($user); goto Zn7hp; gHjHu: $this->trigger_events("\160\x72\x65\x5f\x6c\157\147\x69\156\x5f\162\145\155\x65\155\x62\145\162\145\144\137\x75\163\145\x72"); goto cpylS; Sc5qR: YHU9C: goto xDt5e; cpylS: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\145\155\x62\145\162\137\x63\157\x6f\x6b\x69\145\x5f\156\x61\x6d\x65", "\x69\157\x6e\x5f\x61\x75\x74\150")); goto BzfNw; GhKdC: $user = $query->row(); goto SMhFD; lJevL: return FALSE; goto mYxPB; aTmQ_: if (!($query->num_rows() === 1)) { goto YHU9C; } goto GhKdC; oSn9x: $this->trigger_events("\145\x78\164\162\141\x5f\x77\x68\x65\x72\x65"); goto wtJh_; WNZdq: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto WHcmR; } goto yXRXF; wtJh_: $query = $this->db->select($this->identity_column . "\54\40\x69\x64\54\x20\x65\x6d\141\151\x6c\54\x20\162\145\155\x65\155\142\x65\x72\137\143\157\x64\x65\x2c\40\x6c\x61\x73\x74\137\154\157\x67\151\x6e")->where("\162\145\x6d\145\x6d\142\145\162\x5f\163\x65\154\145\x63\x74\157\x72", $token->selector)->where("\141\x63\x74\x69\166\x65", 1)->limit(1)->get($this->tables["\165\163\x65\162\163"]); goto aTmQ_; f3fuj: return FALSE; goto hnuhg; pGe0w: if (!$this->config->item("\165\163\x65\x72\x5f\x65\170\164\145\156\x64\x5f\157\156\x5f\154\157\147\x69\156", "\151\157\x6e\137\x61\165\x74\x68")) { goto WD_iA; } goto uHux0; Zn7hp: $this->clear_forgotten_password_code($identity); goto pGe0w; X6XqW: return TRUE; goto c8vU7; uHux0: $this->remember_user($identity); goto ro5no; xDt5e: delete_cookie($this->config->item("\x72\x65\x6d\x65\x6d\142\x65\162\x5f\x63\x6f\157\153\151\145\x5f\156\141\155\145", "\151\x6f\x6e\x5f\x61\x75\164\150")); goto mmn7l; c8vU7: WHcmR: goto Sc5qR; jSTKK: if (!($token === FALSE)) { goto OFuCT; } goto ud49w; hnuhg: OFuCT: goto oSn9x; yXRXF: $this->update_last_login($user->id); goto fP2nV; SMhFD: $identity = $user->{$this->identity_column}; goto WNZdq; ud49w: $this->trigger_events(["\160\157\x73\x74\x5f\154\157\147\151\156\137\x72\x65\155\x65\x6d\142\x65\162\x65\144\x5f\x75\163\145\162", "\160\157\163\164\137\x6c\x6f\147\151\156\137\x72\145\155\145\x6d\x62\x65\162\x65\x64\x5f\165\163\x65\x72\x5f\x75\156\163\165\143\x63\x65\x73\163\x66\x75\154"]); goto f3fuj; BzfNw: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto jSTKK; mmn7l: $this->trigger_events(["\160\x6f\163\164\x5f\154\x6f\147\151\156\x5f\162\145\x6d\x65\155\x62\145\162\x65\x64\x5f\165\163\x65\162", "\160\x6f\x73\164\x5f\x6c\x6f\147\x69\x6e\x5f\162\145\155\x65\155\142\x65\x72\x65\144\x5f\x75\163\145\162\x5f\165\156\163\x75\143\x63\145\163\163\146\165\x6c"]); goto lJevL; mYxPB: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto wYJEJ; WE5WO: hszgT: goto xOFOG; Vm_1_: $this->db->insert($this->tables["\x67\162\157\x75\x70\163"], $data); goto LWMSc; qsVWP: return FALSE; goto DpqiO; LWMSc: $group_id = $this->db->insert_id($this->tables["\147\162\x6f\x75\160\163"] . "\x5f\x69\x64\137\x73\x65\x71"); goto JpP0J; ujOVA: return FALSE; goto LgQGg; L2njS: if (empty($additional_data)) { goto hszgT; } goto OnJYL; xOFOG: $this->trigger_events("\145\170\x74\162\141\x5f\x67\162\x6f\x75\160\x5f\163\145\x74"); goto Vm_1_; LgQGg: gagMu: goto VLdOB; wYJEJ: if ($group_name) { goto gagMu; } goto lQxSL; DpqiO: pJu0s: goto EyFU7; MJugC: return $group_id; goto RMYnT; L2E4t: $this->set_error("\147\162\157\x75\160\137\141\154\x72\145\141\144\x79\137\145\x78\151\x73\x74\x73"); goto qsVWP; EyFU7: $data = ["\x6e\141\155\145" => $group_name, "\144\x65\x73\x63\162\151\x70\x74\x69\157\x6e" => $group_description]; goto L2njS; lQxSL: $this->set_error("\147\x72\x6f\165\160\x5f\x6e\141\x6d\145\x5f\x72\x65\x71\x75\x69\162\145\x64"); goto ujOVA; VLdOB: $existing_group = $this->db->get_where($this->tables["\x67\162\157\x75\x70\x73"], ["\x6e\x61\155\145" => $group_name])->num_rows(); goto I87tz; OnJYL: $data = array_merge($this->_filter_data($this->tables["\147\x72\157\x75\x70\x73"], $additional_data), $data); goto WE5WO; JpP0J: $this->set_message("\x67\162\x6f\165\x70\137\x63\x72\x65\141\x74\x69\x6f\156\137\163\x75\143\143\145\x73\163\146\165\154"); goto MJugC; I87tz: if (!($existing_group !== 0)) { goto pJu0s; } goto L2E4t; RMYnT: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto U32Rw; L77Bk: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\165\160\163"], ["\156\x61\155\x65" => $group_name])->row(); goto OIjG7; U32Rw: if (!empty($group_id)) { goto ukzSs; } goto IeEi6; jHkwH: return FALSE; goto d0dZT; m_Pbr: return TRUE; goto t301m; OIjG7: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto ExpF9; } goto KxVY8; qV9J3: igOM2: goto asyyO; uWUa0: if (empty($additional_data)) { goto igOM2; } goto hUbmR; mpPrj: $this->set_error("\147\x72\x6f\165\160\137\x6e\x61\155\145\x5f\141\x64\x6d\151\156\137\x6e\x6f\164\137\x61\154\164\145\x72"); goto vyjXV; asyyO: $this->db->update($this->tables["\147\162\x6f\x75\160\x73"], $data, ["\x69\144" => $group_id]); goto eJOzo; wuoFJ: $data = []; goto MTIBr; hUbmR: $data = array_merge($this->_filter_data($this->tables["\147\162\157\x75\x70\163"], $additional_data), $data); goto qV9J3; AzSMy: if (!($this->config->item("\141\144\155\151\x6e\137\x67\162\157\x75\x70", "\x69\157\x6e\137\141\x75\164\150") === $group->name && $group_name !== $group->name)) { goto SbBgi; } goto mpPrj; vyjXV: return FALSE; goto vFGZO; d0dZT: ExpF9: goto QDU03; ZWYx4: ngGLy: goto RNMzS; vFGZO: SbBgi: goto uWUa0; IeEi6: return FALSE; goto QWVq8; QDU03: $data["\x6e\x61\x6d\x65"] = $group_name; goto ZWYx4; KxVY8: $this->set_error("\x67\162\157\165\x70\x5f\141\x6c\x72\x65\x61\144\x79\137\x65\170\x69\163\x74\163"); goto jHkwH; RNMzS: $group = $this->db->get_where($this->tables["\147\162\x6f\x75\160\163"], ["\x69\x64" => $group_id])->row(); goto AzSMy; MTIBr: if (empty($group_name)) { goto ngGLy; } goto L77Bk; eJOzo: $this->set_message("\x67\x72\157\x75\x70\x5f\x75\x70\x64\x61\164\145\137\x73\165\x63\x63\x65\163\163\146\165\154"); goto m_Pbr; QWVq8: ukzSs: goto wuoFJ; t301m: } public function delete_group($group_id = FALSE) { goto vmHNW; slCVd: $this->trigger_events(["\160\x6f\x73\164\x5f\144\145\154\145\164\x65\x5f\147\x72\x6f\165\160", "\160\x6f\x73\164\x5f\144\145\154\x65\x74\145\x5f\147\162\157\165\x70\x5f\165\156\163\x75\x63\143\x65\163\x73\x66\165\154"]); goto NyEnu; ai1UY: return FALSE; goto L1JuC; M5Wv_: $this->db->trans_begin(); goto IPxm2; Vc1fI: if (!($this->db->trans_status() === FALSE)) { goto QA66R; } goto p5PpW; nG8ei: $this->trigger_events("\x70\162\x65\137\144\145\x6c\x65\x74\145\137\147\x72\157\x75\160"); goto M5Wv_; TDisJ: $this->trigger_events(["\x70\157\163\164\137\x64\x65\154\x65\164\x65\x5f\x67\x72\x6f\x75\160", "\x70\157\x73\164\137\x64\145\x6c\145\164\145\x5f\147\x72\x6f\165\x70\x5f\156\157\x74\141\154\x6c\x6f\x77\145\x64"]); goto WwxXk; WwxXk: $this->set_error("\x67\x72\157\165\160\137\x64\x65\x6c\145\x74\x65\x5f\x6e\157\164\x61\154\x6c\x6f\x77\145\144"); goto peTWy; a9gYe: return FALSE; goto bR5gi; IPxm2: $this->db->delete($this->tables["\x75\163\145\162\163\137\147\x72\157\x75\160\163"], [$this->join["\147\x72\157\165\x70\163"] => $group_id]); goto nAX4L; Eu8j7: if (!($group->name == $this->config->item("\141\144\155\151\156\137\x67\x72\x6f\x75\160", "\x69\x6f\156\137\141\165\164\x68"))) { goto yQGra; } goto TDisJ; p5PpW: $this->db->trans_rollback(); goto slCVd; peTWy: return FALSE; goto qHjOm; JxMty: return TRUE; goto LxjP6; WjpGD: $group = $this->group($group_id)->row(); goto Eu8j7; bR5gi: QA66R: goto Kaszk; NyEnu: $this->set_error("\x67\x72\x6f\165\160\137\x64\145\154\145\164\145\137\x75\x6e\163\x75\x63\x63\x65\163\163\146\x75\154"); goto a9gYe; Urs_X: $this->set_message("\147\x72\x6f\x75\160\137\x64\145\x6c\145\x74\x65\x5f\x73\165\143\x63\x65\163\x73\146\165\x6c"); goto JxMty; Kaszk: $this->db->trans_commit(); goto bFBFJ; qHjOm: yQGra: goto nG8ei; L1JuC: g47rT: goto WjpGD; bFBFJ: $this->trigger_events(["\x70\157\163\x74\x5f\144\145\154\x65\x74\145\x5f\x67\x72\x6f\165\x70", "\160\157\x73\x74\x5f\x64\x65\x6c\145\164\x65\137\x67\x72\157\x75\160\x5f\x73\165\x63\143\x65\163\163\146\x75\x6c"]); goto Urs_X; vmHNW: if (!(!$group_id || empty($group_id))) { goto g47rT; } goto ai1UY; nAX4L: $this->db->delete($this->tables["\147\x72\x6f\165\160\163"], ["\151\144" => $group_id]); goto Vc1fI; LxjP6: } public function set_hook($event, $name, $class, $method, $arguments) { goto bJmbV; bJmbV: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto OcvDn; TTjhC: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto wCqg6; hFcRY: $this->_ion_hooks->{$event}[$name]->method = $method; goto TTjhC; OcvDn: $this->_ion_hooks->{$event}[$name]->class = $class; goto hFcRY; wCqg6: } public function remove_hook($event, $name) { goto OP_wj; OP_wj: if (!isset($this->_ion_hooks->{$event}[$name])) { goto MW_Qr; } goto BBzi2; TFJa4: MW_Qr: goto Bv3uY; BBzi2: unset($this->_ion_hooks->{$event}[$name]); goto TFJa4; Bv3uY: } public function remove_hooks($event) { goto O10A0; O10A0: if (!isset($this->_ion_hooks->{$event})) { goto qbS6o; } goto ActFi; ActFi: unset($this->_ion_hooks->{$event}); goto nUZ7m; nUZ7m: qbS6o: goto YuwAg; YuwAg: } protected function _call_hook($event, $name) { goto CUkSm; XDZOb: $hook = $this->_ion_hooks->{$event}[$name]; goto F6JWw; CUkSm: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto GEl_7; } goto XDZOb; F6JWw: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto a458Z; oB6Yg: return FALSE; goto wtfUI; a458Z: GEl_7: goto oB6Yg; wtfUI: } public function trigger_events($events) { goto cMTuT; HcbrD: goto ahQjn; goto aCCDD; n9Weg: WgvAq: goto HcbrD; aCCDD: t3dC6: goto LirrQ; ADFQj: iwXXs: goto h3Ga_; hz0Xr: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); DM8Fu: } goto ylK1Y; LirrQ: foreach ($events as $event) { $this->trigger_events($event); dm952: } goto ADFQj; h3Ga_: ahQjn: goto d6bAY; ylK1Y: BIrLl: goto n9Weg; cMTuT: if (is_array($events) && !empty($events)) { goto t3dC6; } goto Gxu5f; Gxu5f: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto WgvAq; } goto hz0Xr; d6bAY: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto Wtj3X; JxjAv: return TRUE; goto mKr0v; Z3V19: $this->message_end_delimiter = $end_delimiter; goto JxjAv; Wtj3X: $this->message_start_delimiter = $start_delimiter; goto Z3V19; mKr0v: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto yarq8; QgvmL: $this->error_end_delimiter = $end_delimiter; goto KKCmv; yarq8: $this->error_start_delimiter = $start_delimiter; goto QgvmL; KKCmv: return TRUE; goto wzuOK; wzuOK: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto GaNqA; AdvMZ: foreach ($this->messages as $message) { goto ZdXBX; UjTdU: u8FGz: goto tExZa; Hxh08: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto UjTdU; ZdXBX: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\43"; goto Hxh08; tExZa: } goto POlS4; Ir7e1: return $_output; goto b_0gr; POlS4: XGFv9: goto Ir7e1; GaNqA: $_output = ''; goto AdvMZ; b_0gr: } public function messages_array($langify = TRUE) { goto ZGwoT; zMQFx: return $this->messages; goto zqyfU; AAcWV: foreach ($this->messages as $message) { goto LNl6O; qQDxV: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto DExkk; DExkk: eUupU: goto E0ycb; LNl6O: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\43\43"; goto qQDxV; E0ycb: } goto yBMhE; PU90w: return $_output; goto gyrV0; zqyfU: goto Gsp7l; goto DqeKr; DqeKr: lCBF2: goto Rq_du; Rq_du: $_output = []; goto AAcWV; yBMhE: fGZNz: goto PU90w; gyrV0: Gsp7l: goto x_Ton; ZGwoT: if ($langify) { goto lCBF2; } goto zMQFx; x_Ton: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto l1pa4; gj3Sz: return $_output; goto HUn75; xd9Ym: foreach ($this->errors as $error) { goto A3R9Q; A3R9Q: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto aCPBQ; VhQQ9: DH5Dh: goto P4w77; aCPBQ: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto VhQQ9; P4w77: } goto q7Yk0; q7Yk0: qVc_b: goto gj3Sz; l1pa4: $_output = ''; goto xd9Ym; HUn75: } public function errors_array($langify = TRUE) { goto bGm5T; pyazA: foreach ($this->errors as $error) { goto Xd12c; Xd12c: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\43"; goto kGjL9; faKs9: umigF: goto y1hxg; kGjL9: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto faKs9; y1hxg: } goto iMrb5; bGm5T: if ($langify) { goto psxfs; } goto HxXS4; hc4pL: $_output = []; goto pyazA; jAfN0: b_oTN: goto ODxU0; HxXS4: return $this->errors; goto mLRBe; iD2M4: return $_output; goto jAfN0; RYraL: psxfs: goto hc4pL; mLRBe: goto b_oTN; goto RYraL; iMrb5: Yt4E3: goto iD2M4; ODxU0: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto OdDF2; glbdY: $data = ["\160\141\163\163\x77\157\x72\144" => $hash, "\162\x65\x6d\145\155\142\x65\x72\137\x63\x6f\x64\145" => NULL, "\x66\157\x72\x67\x6f\164\x74\x65\156\x5f\160\141\x73\x73\167\x6f\x72\x64\x5f\x63\157\144\x65" => NULL, "\x66\x6f\162\x67\x6f\164\164\x65\x6e\x5f\160\x61\163\163\x77\x6f\162\x64\137\x74\151\x6d\x65" => NULL]; goto vgw7D; Yvm16: return $this->db->affected_rows() == 1; goto NBQP8; OdDF2: $hash = $this->hash_password($password, $identity); goto hdi1G; hdi1G: if (!($hash === FALSE)) { goto h1HC1; } goto YHijX; vgw7D: $this->trigger_events("\x65\x78\x74\162\x61\x5f\x77\x68\x65\162\x65"); goto O6i6j; YHijX: return FALSE; goto g1XFA; O6i6j: $this->db->update($this->tables["\x75\163\145\162\163"], $data, [$this->identity_column => $identity]); goto Yvm16; g1XFA: h1HC1: goto glbdY; NBQP8: } protected function _filter_data($table, $data) { goto camjM; Xhnl1: FFsOE: goto GF9ul; glBkU: foreach ($columns as $column) { goto WbWd3; WbWd3: if (!array_key_exists($column, $data)) { goto EGgSn; } goto EFHj0; yl3LK: EGgSn: goto ni1EF; ni1EF: syTMp: goto Hqn8X; EFHj0: $filtered_data[$column] = $data[$column]; goto yl3LK; Hqn8X: } goto IU8ib; camjM: $filtered_data = []; goto VWeum; RZqPC: if (!is_array($data)) { goto FFsOE; } goto glBkU; GF9ul: return $filtered_data; goto Vh8y2; IU8ib: nuvdB: goto Xhnl1; VWeum: $columns = $this->db->list_fields($table); goto RZqPC; Vh8y2: } protected function _random_token($result_length = 32) { goto JdF_R; JdF_R: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto j5BuW; } goto rIrcm; Uhn7q: j5BuW: goto oqvEv; rIrcm: $result_length = 32; goto Uhn7q; w8cOr: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto Y1Lmu; rkRkn: return bin2hex(random_bytes($result_length / 2)); goto rT2W2; rT2W2: EGmIX: goto tBOcY; tBOcY: if (!function_exists("\155\x63\x72\171\x70\x74\137\143\162\x65\141\164\145\137\x69\x76")) { goto t8Prw; } goto w8cOr; Esff_: return FALSE; goto s1QR1; gtPoD: rezeM: goto Esff_; Y1Lmu: t8Prw: goto RxTAN; RxTAN: if (!function_exists("\x6f\160\x65\x6e\163\163\x6c\137\162\141\x6e\144\157\x6d\137\x70\x73\x65\165\x64\x6f\x5f\x62\x79\x74\x65\163")) { goto rezeM; } goto tdsdX; tdsdX: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto gtPoD; oqvEv: if (!function_exists("\x72\x61\156\144\157\x6d\137\142\171\x74\145\x73")) { goto EGmIX; } goto rkRkn; s1QR1: } protected function _get_hash_parameters($identity = NULL) { goto lzaKu; G1CDs: M5zRU: goto nOKz9; A26wh: if (!$identity) { goto M5zRU; } goto f6S_s; YVnTP: return $params; goto bYgqD; nOKz9: $params = FALSE; goto ScVSL; ScVSL: switch ($this->hash_method) { case "\142\x63\x72\171\x70\x74": $params = ["\x63\157\163\x74" => $is_admin ? $this->config->item("\x62\143\x72\171\160\164\137\141\144\x6d\151\156\x5f\x63\x6f\x73\x74", "\151\x6f\156\x5f\141\x75\164\x68") : $this->config->item("\142\x63\162\171\160\164\137\144\145\146\x61\x75\154\x74\x5f\x63\157\x73\164", "\151\157\156\x5f\x61\165\x74\150")]; goto jN3hH; case "\x61\162\147\157\156\62": $params = $is_admin ? $this->config->item("\x61\x72\x67\157\x6e\62\137\x61\144\155\x69\x6e\x5f\x70\x61\162\141\155\x73", "\x69\157\156\x5f\x61\x75\164\150") : $this->config->item("\x61\162\147\x6f\156\62\x5f\x64\x65\146\141\165\x6c\164\x5f\160\141\162\141\x6d\163", "\x69\157\x6e\137\141\x75\x74\x68"); goto jN3hH; default: } goto FrPs3; czgoI: if (!($user_id && $this->in_group($this->config->item("\141\x64\155\x69\156\137\x67\x72\x6f\x75\160", "\151\x6f\156\x5f\x61\x75\x74\x68"), $user_id))) { goto UxKKL; } goto WcW4M; Y_JRo: jN3hH: goto YVnTP; eIzJe: UxKKL: goto G1CDs; f6S_s: $user_id = $this->get_user_id_from_identity($identity); goto czgoI; FrPs3: AyKQt: goto Y_JRo; WcW4M: $is_admin = TRUE; goto eIzJe; lzaKu: $is_admin = FALSE; goto A26wh; bYgqD: } protected function _get_hash_algo() { goto MxivY; owvsh: O3iGj: goto MAB58; MxivY: $algo = FALSE; goto bcH9Z; XGnGE: return $algo; goto i38aO; MAB58: UQlSp: goto XGnGE; bcH9Z: switch ($this->hash_method) { case "\x62\143\x72\171\160\x74": $algo = PASSWORD_BCRYPT; goto UQlSp; case "\x61\162\147\x6f\156\x32": $algo = PASSWORD_ARGON2I; goto UQlSp; default: } goto owvsh; i38aO: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto qjEpc; tvVmX: $validator_hashed = $this->hash_password($validator); goto cqEYj; cqEYj: $user_code = "{$selector}\56{$validator}"; goto iY3A3; zg3jr: $validator = $this->_random_token($validator_size); goto tvVmX; iY3A3: return (object) ["\163\x65\154\x65\143\164\x6f\162" => $selector, "\x76\141\x6c\151\144\141\x74\x6f\x72\x5f\150\141\163\150\145\144" => $validator_hashed, "\165\163\145\162\137\x63\x6f\x64\x65" => $user_code]; goto qsz7R; qjEpc: $selector = $this->_random_token($selector_size); goto zg3jr; qsz7R: } protected function _retrieve_selector_validator_couple($user_code) { goto sj5Pq; sj5Pq: if (!$user_code) { goto yz4y2; } goto O_P90; O_P90: $tokens = explode("\x2e", $user_code); goto H5xe9; QmQrx: yz4y2: goto b812m; b812m: return FALSE; goto dzI0Z; H5xe9: if (!(count($tokens) === 2)) { goto dVAQj; } goto LSQuO; NMQ8l: dVAQj: goto QmQrx; LSQuO: return (object) ["\163\145\x6c\x65\143\164\x6f\162" => $tokens[0], "\x76\141\154\151\x64\x61\164\x6f\162" => $tokens[1]]; goto NMQ8l; dzI0Z: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto X5TL2; pAp0J: if ($result) { goto xIWfd; } goto maiic; aGsYG: $salt = substr($hashed_password_db, 0, $salt_length); goto pxQoK; s5FLm: goto u1_hz; goto nnbt6; vgzdD: if ($hashed_password === $hashed_password_db) { goto tNn1N; } goto Nu0J7; QOQA7: C2pJ6: goto aGsYG; JLCNq: emDB0: goto vgzdD; XBpGj: d46cn: goto NgiRY; oDvGw: $this->trigger_events(["\160\157\163\164\x5f\x73\150\x61\61\137\x70\x61\163\x73\167\x6f\x72\x64\x5f\x6d\151\147\x72\141\x74\x69\x6f\x6e", "\x70\x6f\x73\164\x5f\x73\x68\141\61\x5f\160\x61\x73\163\x77\157\162\144\137\155\151\x67\162\141\164\151\x6f\x6e\x5f\163\x75\143\143\x65\163\163\x66\x75\154"]); goto XBpGj; BvXpy: goto d46cn; goto SKe8q; vgW5F: u1_hz: goto xdEl4; CsNHB: if ($salt_length) { goto C2pJ6; } goto mO0rl; ZO7U0: $hashed_password = sha1($password . $salt_db->salt); goto JLCNq; HXUSs: goto emDB0; goto w40f5; z65gs: return FALSE; goto s5FLm; yBmW2: return FALSE; goto XpdaF; OQsS5: $result = $this->_set_password_db($identity, $password); goto pAp0J; pxQoK: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto HXUSs; Ib1bV: if (!($query->num_rows() !== 1)) { goto gex_n; } goto hLsSI; maiic: $this->trigger_events(["\160\x6f\x73\x74\137\x73\150\x61\61\x5f\x70\x61\x73\x73\x77\x6f\162\144\x5f\155\151\x67\162\141\x74\x69\157\x6e", "\160\157\163\x74\137\163\x68\x61\61\x5f\160\141\x73\163\167\157\162\x64\137\x6d\151\x67\162\x61\164\x69\157\x6e\137\165\x6e\163\165\x63\143\x65\163\163\x66\165\x6c"]); goto BvXpy; SKe8q: xIWfd: goto oDvGw; w40f5: tRxvv: goto zFZn0; AvQwP: return FALSE; goto QOQA7; X5TL2: $this->trigger_events("\x70\x72\x65\137\x73\x68\141\x31\137\x70\141\163\163\x77\x6f\162\x64\x5f\x6d\151\x67\162\141\x74\151\x6f\156"); goto D6RkM; D6RkM: if ($this->config->item("\163\x74\x6f\162\x65\137\163\x61\154\164", "\151\157\x6e\x5f\x61\x75\164\x68")) { goto tRxvv; } goto oTWhU; zFZn0: $query = $this->db->select("\x73\x61\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\x72\x73"]); goto BgC1o; mO0rl: $this->trigger_events(["\160\x6f\163\164\137\x73\150\141\61\x5f\160\x61\163\x73\x77\x6f\162\x64\x5f\x6d\151\147\x72\141\x74\151\x6f\x6e", "\160\157\163\x74\137\163\x68\141\x31\x5f\160\x61\163\163\167\x6f\x72\144\137\155\151\x67\x72\141\x74\151\x6f\x6e\137\165\156\x73\x75\143\x63\145\163\163\x66\165\x6c"]); goto AvQwP; nnbt6: tNn1N: goto OQsS5; hLsSI: $this->trigger_events(["\160\157\163\164\x5f\163\150\141\61\137\x70\x61\163\163\167\x6f\x72\144\137\155\151\147\x72\141\x74\x69\x6f\x6e", "\x70\x6f\x73\164\x5f\x73\150\141\61\137\160\x61\163\x73\167\157\162\x64\x5f\155\x69\x67\162\141\164\151\x6f\x6e\x5f\x75\x6e\x73\165\143\143\145\163\x73\x66\165\x6c"]); goto yBmW2; BgC1o: $salt_db = $query->row(); goto Ib1bV; XpdaF: gex_n: goto ZO7U0; NgiRY: return $result; goto vgW5F; oTWhU: $salt_length = $this->config->item("\x73\x61\154\x74\137\x6c\145\156\147\x74\x68", "\x69\x6f\156\x5f\141\x75\x74\150"); goto CsNHB; Nu0J7: $this->trigger_events(["\160\157\163\x74\137\x73\150\141\x31\137\x70\x61\x73\163\x77\x6f\x72\144\x5f\155\151\147\162\141\164\x69\x6f\x6e", "\160\x6f\x73\x74\x5f\163\150\141\x31\137\x70\141\163\x73\x77\x6f\x72\144\137\x6d\x69\x67\162\x61\x74\x69\157\x6e\137\165\156\x73\165\x63\143\x65\163\163\146\165\154"]); goto z65gs; xdEl4: } }
