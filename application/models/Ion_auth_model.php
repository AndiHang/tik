<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\x50\x41\x54\x48") or exit("\116\157\40\144\x69\x72\145\x63\x74\x20\x73\143\x72\x69\x70\164\x20\141\143\x63\145\163\163\40\141\x6c\154\157\167\145\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto DtzB9; XD3b0: $this->messages = []; goto ZzlBc; VgdV8: $this->lang->load("\151\157\x6e\137\x61\165\164\150"); goto egkU4; FVC80: $this->db = $this->load->database($group_name, TRUE, TRUE); goto AlnmZ; mUNBE: nWBDx: goto keAoB; DtzB9: $this->config->load("\151\157\156\x5f\x61\165\x74\x68", TRUE); goto sebco; l_GUk: $CI =& get_instance(); goto DGxYl; kECA_: $this->message_end_delimiter = $this->config->item("\x6d\145\x73\x73\x61\147\145\137\x65\156\x64\137\144\x65\154\x69\x6d\x69\164\145\x72", "\151\157\156\x5f\x61\165\x74\x68"); goto xzKf8; egkU4: $group_name = $this->config->item("\x64\x61\x74\141\x62\141\163\145\137\x67\x72\157\x75\x70\x5f\156\141\155\x65", "\x69\x6f\x6e\x5f\141\165\x74\150"); goto lvtp0; wsXTt: d55HB: goto TVZIQ; lvtp0: if (empty($group_name)) { goto IZA5u; } goto FVC80; TVZIQ: $this->_ion_hooks = new stdClass(); goto iMeox; iMeox: $this->trigger_events("\x6d\x6f\144\145\154\x5f\x63\x6f\156\x73\x74\162\165\143\164\157\x72"); goto Iy2Mm; ZLd3k: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto RbFuJ; xzKf8: $this->error_start_delimiter = $this->config->item("\x65\x72\162\157\x72\137\163\x74\141\x72\x74\x5f\x64\x65\154\151\155\151\164\x65\x72", "\x69\157\156\x5f\x61\x75\164\150"); goto LRkP0; aRSk1: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\x72\157\162\x5f\x73\x75\x66\x66\151\170"); goto sVrAR; AlnmZ: goto IhM9h; goto K8Nbe; gdY30: $this->load->helper("\x64\141\164\145"); goto VgdV8; K8Nbe: IZA5u: goto l_GUk; TTpCK: goto d55HB; goto mUNBE; jZR_C: $this->message_start_delimiter = $this->config->item("\155\145\x73\163\x61\x67\145\x5f\163\164\141\x72\164\137\144\x65\154\x69\155\x69\x74\x65\162", "\151\x6f\x6e\137\141\165\x74\150"); goto kECA_; ZzlBc: $this->errors = []; goto dkWbT; dkWbT: $delimiters_source = $this->config->item("\x64\x65\154\151\155\x69\x74\145\x72\163\x5f\163\157\x75\162\143\145", "\x69\157\x6e\x5f\141\x75\164\x68"); goto WMhnv; RbFuJ: $this->message_end_delimiter = $this->error_end_delimiter; goto wsXTt; keAoB: $this->load->library("\x66\x6f\x72\x6d\x5f\166\x61\154\x69\144\x61\x74\x69\x6f\x6e"); goto PKZ2h; nokME: $this->identity_column = $this->config->item("\151\144\x65\x6e\164\151\164\171", "\x69\157\156\x5f\141\x75\164\150"); goto dxRUl; N6_1t: $this->message_start_delimiter = $this->error_start_delimiter; goto aRSk1; YqWTo: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto N6_1t; XvALj: $error_prefix = $form_validation_class->getProperty("\x5f\145\x72\x72\157\x72\137\160\x72\x65\x66\151\170"); goto suCng; WMhnv: if ($delimiters_source === "\146\x6f\162\155\137\x76\x61\x6c\x69\x64\x61\164\151\x6f\x6e") { goto nWBDx; } goto jZR_C; sV7xu: $this->tables = $this->config->item("\x74\x61\142\x6c\145\x73", "\151\157\x6e\x5f\141\x75\164\x68"); goto nokME; LRkP0: $this->error_end_delimiter = $this->config->item("\x65\162\162\157\x72\x5f\145\156\x64\137\144\145\x6c\151\x6d\151\x74\x65\162", "\x69\x6f\156\137\x61\165\164\150"); goto TTpCK; BO0s8: IhM9h: goto sV7xu; suCng: $error_prefix->setAccessible(TRUE); goto YqWTo; DGxYl: $this->db = $CI->db; goto BO0s8; PKZ2h: $form_validation_class = new ReflectionClass("\103\111\x5f\106\157\162\x6d\137\x76\x61\x6c\x69\144\141\x74\x69\157\x6e"); goto XvALj; lpCXl: $this->hash_method = $this->config->item("\x68\x61\163\150\x5f\x6d\145\164\x68\157\144", "\151\x6f\x6e\137\141\165\x74\x68"); goto XD3b0; dxRUl: $this->join = $this->config->item("\x6a\157\151\156", "\x69\157\156\x5f\x61\165\x74\x68"); goto lpCXl; sebco: $this->load->helper("\143\x6f\157\153\x69\x65"); goto gdY30; sVrAR: $error_suffix->setAccessible(TRUE); goto ZLd3k; Iy2Mm: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto esxdr; DlpkB: return password_hash($password, $algo, $params); goto hGcDK; Fa7bS: return FALSE; goto yfuGC; esxdr: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto fr6EL; } goto jvJoo; c0Spk: fr6EL: goto dVfP_; JUByZ: if (!($algo !== FALSE && $params !== FALSE)) { goto VWPKc; } goto DlpkB; hGcDK: VWPKc: goto Fa7bS; wh24V: $params = $this->_get_hash_parameters($identity); goto JUByZ; dVfP_: $algo = $this->_get_hash_algo(); goto wh24V; jvJoo: return FALSE; goto c0Spk; yfuGC: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto dpRcp; dpRcp: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto EsMxq; } goto gEHk1; jxcs1: goto VbLmt; goto ZAE81; dsG37: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto jxcs1; EWhCR: EsMxq: goto n9t8o; G4liP: return password_verify($password, $hash_password_db); goto kIPnG; gEHk1: return FALSE; goto EWhCR; n9t8o: if (strpos($hash_password_db, "\x24") === 0) { goto kK3jH; } goto dsG37; kIPnG: VbLmt: goto HRHZj; ZAE81: kK3jH: goto G4liP; HRHZj: } public function rehash_password_if_needed($hash, $identity, $password) { goto ePXzU; XHBYL: goto mALcR; goto bruH5; bGKt1: $this->trigger_events(["\x72\145\150\x61\x73\150\x5f\160\141\x73\163\x77\157\x72\x64", "\x72\145\150\141\x73\x68\137\160\141\163\163\x77\157\x72\x64\x5f\x73\165\x63\x63\145\163\x73\146\165\x6c"]); goto YwDRE; hC9vJ: $params = $this->_get_hash_parameters($identity); goto DxcIy; Ax7e0: $this->trigger_events(["\x72\145\x68\141\x73\150\x5f\x70\x61\x73\163\167\157\x72\144", "\162\x65\150\141\163\x68\137\x70\141\163\163\167\157\162\144\x5f\165\x6e\x73\165\143\x63\145\163\163\146\x75\154"]); goto XHBYL; ePXzU: $algo = $this->_get_hash_algo(); goto hC9vJ; DxcIy: if (!($algo !== FALSE && $params !== FALSE)) { goto nogZf; } goto dcthY; dcthY: if (!password_needs_rehash($hash, $algo, $params)) { goto xN7HP; } goto ptxbZ; ptxbZ: if ($this->_set_password_db($identity, $password)) { goto s3BuH; } goto Ax7e0; mSNzu: xN7HP: goto RLh4c; bruH5: s3BuH: goto bGKt1; RLh4c: nogZf: goto gi5YN; YwDRE: mALcR: goto mSNzu; gi5YN: } public function get_user_by_activation_code($user_code) { goto Xx2rs; pFYKn: wBovj: goto hwCxQ; aOGLb: $user = $this->where("\x61\143\164\x69\x76\x61\164\x69\x6f\x6e\137\163\x65\154\145\x63\164\x6f\x72", $token->selector)->users()->row(); goto oz7Cy; tWbZb: return $user; goto pFYKn; Xx2rs: $token = $this->_retrieve_selector_validator_couple($user_code); goto aOGLb; oz7Cy: if (!$user) { goto jJzev; } goto NvpZD; hwCxQ: jJzev: goto as2ws; NvpZD: if (!$this->verify_password($token->validator, $user->activation_code)) { goto wBovj; } goto tWbZb; as2ws: return FALSE; goto dtab_; dtab_: } public function activate($id, $code = FALSE) { goto kEMhn; lbBqW: $this->set_error("\141\143\164\x69\x76\141\x74\x65\x5f\x75\x6e\x73\x75\143\143\x65\x73\163\x66\165\x6c"); goto f0kGx; Z4t4J: if (!($code !== FALSE)) { goto O6JjM; } goto PG2Bw; IaN6w: if (!($this->db->affected_rows() === 1)) { goto zDgdT; } goto Mh2rK; Mh2rK: $this->trigger_events(["\x70\157\163\x74\x5f\141\x63\x74\151\166\x61\x74\x65", "\160\x6f\163\x74\x5f\141\143\164\151\x76\x61\164\145\137\x73\165\143\143\x65\163\x73\x66\x75\154"]); goto LUk5V; gykMg: if (!($code === FALSE || $user && $user->id === $id)) { goto pgI3x; } goto LgMtZ; Zjufi: O6JjM: goto gykMg; kEMhn: $this->trigger_events("\x70\162\145\137\141\x63\x74\x69\x76\141\x74\x65"); goto Z4t4J; ACPYY: zDgdT: goto tStZy; tStZy: pgI3x: goto mnjJw; LgMtZ: $data = ["\141\143\x74\151\x76\x61\164\151\x6f\x6e\x5f\x73\x65\x6c\x65\x63\x74\157\x72" => NULL, "\141\x63\x74\x69\x76\141\x74\x69\x6f\156\137\143\x6f\x64\x65" => NULL, "\x61\x63\164\151\166\145" => 1]; goto zkI9L; PG2Bw: $user = $this->get_user_by_activation_code($code); goto Zjufi; oxoFp: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, ["\x69\x64" => $id]); goto IaN6w; f0kGx: return FALSE; goto DT6cT; p2aSF: return TRUE; goto ACPYY; zkI9L: $this->trigger_events("\145\170\164\162\x61\x5f\167\x68\145\x72\145"); goto oxoFp; LUk5V: $this->set_message("\141\143\164\x69\x76\141\x74\x65\137\163\x75\x63\143\x65\x73\x73\x66\x75\154"); goto p2aSF; mnjJw: $this->trigger_events(["\160\x6f\163\164\137\x61\143\164\151\166\141\164\145", "\160\x6f\x73\164\x5f\141\143\x74\151\x76\x61\164\145\137\x75\156\x73\165\x63\x63\145\x73\x73\x66\x75\154"]); goto lbBqW; DT6cT: } public function deactivate($id = NULL) { goto h3tm5; WwXZD: $return = $this->db->affected_rows() == 1; goto jvq64; ytfKw: $token = $this->_generate_selector_validator_couple(20, 40); goto bn41q; h3tm5: $this->trigger_events("\x64\x65\141\143\164\151\166\141\x74\x65"); goto d98jB; eeerK: ztHL1: goto KTkdi; YHxuR: goto RQAKF; goto nbf8V; YzP44: $this->set_error("\x64\x65\x61\x63\164\x69\x76\141\164\145\137\x75\x6e\163\165\143\x63\145\163\163\x66\165\154"); goto CaTKZ; upp1a: goto ztHL1; goto uj6FL; KoR4W: return FALSE; goto RtG0Y; jvq64: if ($return) { goto Rd1cU; } goto UMopr; uj6FL: Rd1cU: goto Z1vFi; G9n0z: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, ["\x69\x64" => $id]); goto WwXZD; Z1vFi: $this->set_message("\x64\x65\x61\143\x74\151\166\x61\x74\145\x5f\x73\x75\143\143\145\x73\x73\146\165\154"); goto eeerK; RtG0Y: DFOyn: goto YHxuR; y2cjy: $this->trigger_events("\145\x78\164\x72\141\137\x77\x68\145\x72\x65"); goto G9n0z; WrCOK: $this->set_error("\x64\145\x61\x63\x74\151\x76\141\x74\x65\137\143\165\162\162\x65\x6e\164\x5f\165\163\x65\x72\137\x75\156\x73\165\143\x63\x65\x73\163\146\x75\154"); goto KoR4W; UMopr: $this->set_error("\x64\145\x61\x63\164\151\x76\141\164\145\137\x75\156\163\165\143\143\145\163\163\146\x75\x6c"); goto upp1a; DmhuP: RQAKF: goto ytfKw; cb7S8: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto DFOyn; } goto WrCOK; X0IMw: $data = ["\141\x63\x74\151\x76\141\164\x69\157\156\x5f\x73\145\154\x65\143\164\x6f\x72" => $token->selector, "\x61\143\164\151\x76\141\x74\x69\x6f\x6e\137\143\x6f\144\x65" => $token->validator_hashed, "\x61\x63\x74\x69\x76\x65" => 0]; goto y2cjy; CaTKZ: return FALSE; goto DmhuP; KTkdi: return $return; goto KPYQE; nbf8V: FjRTM: goto YzP44; bn41q: $this->activation_code = $token->user_code; goto X0IMw; d98jB: if (!isset($id)) { goto FjRTM; } goto cb7S8; KPYQE: } public function clear_forgotten_password_code($identity) { goto s9Ook; qk1oD: $data = ["\x66\x6f\162\147\157\164\x74\145\x6e\137\160\x61\163\x73\167\x6f\162\144\x5f\163\145\x6c\145\143\164\x6f\162" => NULL, "\146\157\162\147\157\164\x74\x65\156\x5f\160\x61\163\x73\167\x6f\162\x64\x5f\x63\x6f\x64\145" => NULL, "\146\157\162\147\157\164\164\145\156\137\x70\x61\163\x73\167\x6f\x72\144\137\164\151\155\145" => NULL]; goto aWfqS; s9Ook: if (!empty($identity)) { goto oDJua; } goto GTtSC; pt_T7: return TRUE; goto BjE5d; pmfEX: oDJua: goto qk1oD; aWfqS: $this->db->update($this->tables["\165\x73\x65\x72\163"], $data, [$this->identity_column => $identity]); goto pt_T7; GTtSC: return FALSE; goto pmfEX; BjE5d: } public function clear_remember_code($identity) { goto trSLE; DQMnz: return FALSE; goto IVfR6; uzcrs: $data = ["\x72\145\155\x65\155\142\x65\162\137\163\145\154\145\x63\164\157\162" => NULL, "\162\x65\x6d\145\x6d\x62\x65\162\137\x63\x6f\x64\145" => NULL]; goto pG0_m; trSLE: if (!empty($identity)) { goto zlXE1; } goto DQMnz; GpYr6: return TRUE; goto xbl23; IVfR6: zlXE1: goto uzcrs; pG0_m: $this->db->update($this->tables["\165\163\145\x72\163"], $data, [$this->identity_column => $identity]); goto GpYr6; xbl23: } public function reset_password($identity, $new) { goto n3LJG; vbOde: if ($return) { goto r83fm; } goto nSbuM; hb0jJ: t6o4V: goto LQVEb; M6aTF: if ($this->identity_check($identity)) { goto t6o4V; } goto EcgIz; x66dL: goto sFEBl; goto Wjasb; WWPio: $this->set_message("\x70\141\163\163\167\157\x72\x64\137\143\x68\x61\x6e\147\145\x5f\163\x75\143\x63\x65\163\x73\146\165\154"); goto IEMq2; EcgIz: $this->trigger_events(["\x70\157\x73\x74\x5f\x63\x68\141\156\x67\x65\137\x70\141\163\163\x77\157\x72\144", "\160\157\163\x74\x5f\143\x68\141\x6e\147\x65\x5f\x70\141\x73\163\167\157\162\x64\137\x75\x6e\x73\165\x63\143\145\163\163\x66\165\154"]); goto Ia0un; nSbuM: $this->trigger_events(["\x70\x6f\163\164\137\x63\150\x61\156\147\x65\x5f\x70\141\163\163\167\x6f\x72\144", "\x70\x6f\x73\164\x5f\143\150\141\156\147\145\137\x70\141\x73\x73\x77\x6f\162\144\137\x75\x6e\x73\165\x63\143\145\x73\x73\146\165\x6c"]); goto IHoGv; YzRiE: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x63\x68\x61\x6e\x67\145\137\160\x61\163\x73\167\157\x72\144", "\160\x6f\163\164\x5f\143\150\141\x6e\147\x65\x5f\x70\x61\163\x73\167\157\162\144\137\163\165\x63\143\145\163\x73\146\x75\x6c"]); goto WWPio; LQVEb: $return = $this->_set_password_db($identity, $new); goto vbOde; IEMq2: sFEBl: goto XLop8; XLop8: return $return; goto ngRBS; Wjasb: r83fm: goto YzRiE; Ia0un: return FALSE; goto hb0jJ; IHoGv: $this->set_error("\160\141\x73\163\x77\157\162\x64\x5f\x63\x68\141\x6e\x67\x65\137\165\156\163\x75\x63\143\145\x73\163\146\x75\x6c"); goto x66dL; n3LJG: $this->trigger_events("\160\162\x65\137\x63\150\x61\x6e\x67\145\x5f\160\x61\x73\163\167\157\162\x64"); goto M6aTF; ngRBS: } public function change_password($identity, $old, $new) { goto CZXeO; i_phq: $this->trigger_events(["\160\x6f\x73\164\x5f\143\x68\x61\156\147\x65\137\x70\141\163\x73\x77\x6f\x72\x64", "\160\x6f\x73\x74\137\143\150\141\x6e\147\145\x5f\x70\141\163\x73\x77\x6f\x72\144\x5f\165\x6e\163\165\x63\143\145\163\x73\x66\x75\154"]); goto VLeNU; YMtlD: $query = $this->db->select("\151\x64\x2c\40\160\141\x73\x73\167\x6f\x72\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\145\x73\x63")->get($this->tables["\165\x73\x65\x72\x73"]); goto bT_Sh; GzG9y: return FALSE; goto Etes0; Fojsy: tx9uC: goto XRnpA; aHZ1a: return FALSE; goto y20I8; CZXeO: $this->trigger_events("\160\x72\145\137\x63\x68\x61\156\x67\145\x5f\160\x61\163\x73\x77\157\162\x64"); goto jg21L; F4ZdV: gMynQ: goto ou0vJ; VOrhz: $this->set_message("\x70\141\163\x73\167\157\x72\x64\137\x63\150\x61\x6e\x67\145\x5f\163\165\143\143\x65\163\163\x66\x75\154"); goto OjCDz; YJ6jM: goto L0Ldu; goto Fojsy; y20I8: WDijg: goto xQe0w; Gg76h: $this->trigger_events(["\160\x6f\x73\x74\x5f\143\x68\141\x6e\147\145\137\160\x61\163\163\167\157\x72\144", "\x70\x6f\x73\x74\x5f\x63\x68\x61\156\147\x65\137\x70\x61\x73\163\x77\157\162\x64\x5f\165\156\x73\x75\x63\x63\145\163\x73\x66\x75\154"]); goto bkFP6; bkFP6: $this->set_error("\x70\x61\163\x73\x77\x6f\x72\x64\137\143\150\x61\156\147\x65\x5f\165\156\163\165\x63\x63\x65\x73\163\146\165\154"); goto aHZ1a; Yco98: if ($result) { goto tx9uC; } goto i_phq; qcu_F: return $result; goto F4ZdV; xQe0w: $user = $query->row(); goto spOAS; ou0vJ: $this->set_error("\x70\x61\x73\163\x77\157\162\144\137\x63\150\141\x6e\x67\145\x5f\x75\x6e\163\x75\143\x63\145\x73\163\146\165\x6c"); goto GzG9y; jg21L: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\150\x65\x72\145"); goto YMtlD; bT_Sh: if (!($query->num_rows() !== 1)) { goto WDijg; } goto Gg76h; JvWR2: $result = $this->_set_password_db($identity, $new); goto Yco98; VLeNU: $this->set_error("\160\141\163\x73\x77\x6f\162\144\x5f\143\150\x61\156\x67\x65\137\165\156\163\x75\x63\x63\x65\x73\x73\x66\x75\x6c"); goto YJ6jM; OjCDz: L0Ldu: goto qcu_F; spOAS: if (!$this->verify_password($old, $user->password, $identity)) { goto gMynQ; } goto JvWR2; XRnpA: $this->trigger_events(["\x70\157\163\x74\137\143\150\x61\156\147\145\137\160\141\x73\163\167\157\162\144", "\160\157\163\x74\x5f\143\x68\141\156\147\145\137\x70\141\163\x73\167\157\x72\x64\137\163\165\143\x63\x65\x73\163\146\x75\x6c"]); goto VOrhz; Etes0: } public function username_check($username = '') { goto T8i_H; XsE9n: return FALSE; goto ejKuA; LxO0O: if (!empty($username)) { goto adRnR; } goto XsE9n; Uzmq0: $this->trigger_events("\x65\x78\164\162\x61\137\167\150\145\x72\x65"); goto MYxhX; T8i_H: $this->trigger_events("\x75\163\145\x72\x6e\141\155\x65\137\x63\150\145\x63\x6b"); goto LxO0O; MYxhX: return $this->db->where("\x75\x73\x65\x72\x6e\141\155\x65", $username)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\x73"]) > 0; goto KuPgQ; ejKuA: adRnR: goto Uzmq0; KuPgQ: } public function email_check($email = '') { goto JCr7X; dsq53: return FALSE; goto KTRyf; CfQ6i: $this->trigger_events("\x65\x78\x74\162\141\137\x77\x68\145\x72\145"); goto qjAvW; JCr7X: $this->trigger_events("\145\x6d\x61\151\154\137\143\x68\145\143\153"); goto Io9HC; qjAvW: return $this->db->where("\x65\155\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\x75\x73\x65\162\x73"]) > 0; goto d3JTD; Io9HC: if (!empty($email)) { goto VZ3d_; } goto dsq53; KTRyf: VZ3d_: goto CfQ6i; d3JTD: } public function identity_check($identity = '') { goto xv7i8; XJkU6: ftrY1: goto bLcuT; rKCu1: if (!empty($identity)) { goto ftrY1; } goto ZZp3N; ZZp3N: return FALSE; goto XJkU6; bLcuT: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\145\x72\163"]) > 0; goto zTB18; xv7i8: $this->trigger_events("\151\x64\145\x6e\x74\151\164\x79\137\x63\150\x65\143\153"); goto rKCu1; zTB18: } public function get_user_id_from_identity($identity = '') { goto G2ho7; KwNqr: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\162\163"]); goto hfK2n; Rrg1u: TwwtX: goto D2dtK; hfK2n: if (!($query->num_rows() !== 1)) { goto TwwtX; } goto H_Wom; D2dtK: $user = $query->row(); goto xssxS; xssxS: return $user->id; goto WEhQ2; H_Wom: return FALSE; goto Rrg1u; K8Etr: return FALSE; goto luwS1; luwS1: hMax2: goto KwNqr; G2ho7: if (!empty($identity)) { goto hMax2; } goto K8Etr; WEhQ2: } public function forgotten_password($identity) { goto OX9W2; z6WhV: return FALSE; goto GbmWb; GbmWb: LSHLZ: goto UD5Ca; MW2cE: goto sKfoC; goto bLabK; bLabK: JeyDP: goto FQidR; HuBtI: $this->trigger_events(["\x70\x6f\163\x74\137\146\157\x72\x67\x6f\x74\164\x65\156\x5f\160\x61\x73\163\167\x6f\162\144", "\160\157\163\x74\x5f\146\x6f\162\x67\157\164\164\145\x6e\x5f\x70\141\163\x73\167\x6f\x72\x64\x5f\165\x6e\163\165\143\143\145\163\x73\x66\165\154"]); goto Ce7x7; UD5Ca: $token = $this->_generate_selector_validator_couple(20, 80); goto JiYBG; nQGof: $this->db->update($this->tables["\165\x73\x65\162\163"], $update, [$this->identity_column => $identity]); goto KJFsn; KJFsn: if ($this->db->affected_rows() === 1) { goto JeyDP; } goto HuBtI; OX9W2: if (!empty($identity)) { goto LSHLZ; } goto VXfuB; r09l8: sKfoC: goto x7zff; b6sNM: return $token->user_code; goto r09l8; G6GII: $this->trigger_events("\145\x78\x74\x72\141\x5f\x77\150\145\162\x65"); goto nQGof; FQidR: $this->trigger_events(["\x70\157\163\x74\x5f\146\x6f\x72\147\x6f\x74\x74\x65\x6e\137\160\x61\x73\163\167\x6f\162\144", "\160\x6f\163\x74\x5f\x66\x6f\x72\147\157\164\164\x65\156\137\160\141\x73\x73\167\157\x72\x64\x5f\163\165\x63\x63\145\163\163\146\165\154"]); goto b6sNM; Ce7x7: return FALSE; goto MW2cE; JiYBG: $update = ["\x66\157\162\x67\x6f\164\x74\x65\x6e\137\x70\141\163\x73\x77\x6f\162\144\x5f\163\x65\x6c\x65\x63\x74\157\x72" => $token->selector, "\x66\157\162\147\157\164\x74\145\156\x5f\x70\141\163\163\167\157\162\x64\137\x63\157\144\x65" => $token->validator_hashed, "\146\157\x72\147\x6f\x74\164\145\x6e\137\160\x61\x73\163\167\157\162\x64\137\164\151\155\145" => time()]; goto G6GII; VXfuB: $this->trigger_events(["\160\157\163\x74\x5f\146\x6f\x72\147\x6f\164\164\145\156\137\x70\x61\163\163\167\x6f\x72\144", "\x70\x6f\163\x74\137\x66\x6f\x72\147\x6f\x74\x74\x65\156\137\x70\141\163\163\x77\157\162\x64\137\165\156\163\165\x63\x63\x65\x73\x73\146\x75\x6c"]); goto z6WhV; x7zff: } public function get_user_by_forgotten_password_code($user_code) { goto T9NDH; T9NDH: $token = $this->_retrieve_selector_validator_couple($user_code); goto z8YcO; oZSjb: return $user; goto ONOdR; ONOdR: r7frA: goto Q3wR_; z8YcO: $user = $this->where("\146\x6f\162\x67\x6f\164\x74\x65\x6e\x5f\160\x61\x73\x73\167\x6f\162\x64\137\163\x65\154\x65\x63\x74\157\x72", $token->selector)->users()->row(); goto GOMAx; GOMAx: if (!$user) { goto a00b3; } goto WZ_Ag; OWHgl: return FALSE; goto lzqCN; WZ_Ag: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto r7frA; } goto oZSjb; Q3wR_: a00b3: goto OWHgl; lzqCN: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto kvIPU; sWPYI: $this->set_error("\x61\143\143\x6f\165\156\x74\x5f\143\162\145\x61\164\151\157\x6e\x5f\x64\165\x70\x6c\x69\x63\x61\x74\x65\x5f\x69\144\145\156\164\x69\164\x79"); goto khnA1; IDEdU: goto fEnX7; goto yqHDV; Yg1D3: return FALSE; goto TTHL_; KxBkx: Yxr2R: goto Kdenj; AUoJm: if ($this->identity_check($identity)) { goto jWDxr; } goto kE6jE; ycn3a: $this->db->insert($this->tables["\x75\x73\145\162\163"], $user_data); goto orUtk; iSGpg: $data = [$this->identity_column => $identity, "\x75\163\x65\162\x6e\x61\155\145" => $identity, "\160\x61\x73\163\x77\x6f\x72\144" => $password, "\x65\155\141\151\x6c" => $email, "\151\160\x5f\x61\x64\144\162\145\x73\163" => $ip_address, "\143\x72\145\141\164\x65\144\137\x6f\x6e" => time(), "\141\143\x74\x69\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto FzfBD; av19_: dsLYU: goto tey6y; FzfBD: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\145\162\x73"], $additional_data), $data); goto jfdtO; tey6y: gAQBI: goto EVGE4; khnA1: return FALSE; goto qAyCN; jfdtO: $this->trigger_events("\x65\x78\164\x72\x61\137\x73\145\164"); goto ycn3a; Kdenj: $default_group = $query; goto NMcA6; Wx8D6: return FALSE; goto CFCeC; MmHEe: $this->set_error("\x61\143\143\157\x75\156\x74\137\143\x72\x65\141\x74\151\x6f\x6e\137\155\151\163\x73\151\x6e\147\137\144\145\x66\x61\x75\154\164\137\x67\x72\x6f\x75\x70"); goto Wx8D6; d6jkF: if (!(isset($default_group->id) && empty($groups))) { goto VS7Kq; } goto QiZqD; RUb7u: VS7Kq: goto wAnBu; uab43: $query = $this->db->get_where($this->tables["\147\x72\157\165\160\x73"], ["\x6e\141\x6d\x65" => $this->config->item("\x64\145\146\x61\165\x6c\164\x5f\147\162\x6f\x75\160", "\151\157\x6e\x5f\141\x75\164\x68")], 1)->row(); goto Epj4K; Epj4K: if (!(!isset($query->id) && empty($groups))) { goto Yxr2R; } goto Pu5xB; E9SO2: return isset($id) ? $id : FALSE; goto oExIQ; qAyCN: fEnX7: goto uab43; yqHDV: jWDxr: goto sWPYI; kE6jE: if (!(!$this->config->item("\x64\x65\x66\141\165\x6c\x74\x5f\x67\162\157\x75\160", "\x69\157\156\x5f\x61\x75\x74\x68") && empty($groups))) { goto ger31; } goto MmHEe; orUtk: $id = $this->db->insert_id($this->tables["\165\x73\145\162\x73"] . "\137\x69\144\137\x73\145\x71"); goto d6jkF; TTHL_: Fiucr: goto iSGpg; MxVEm: foreach ($groups as $group) { $this->add_to_group($group, $id); wWfVM: } goto av19_; CFCeC: ger31: goto IDEdU; ZYwwY: if (!($password === FALSE)) { goto Fiucr; } goto suawO; EVGE4: $this->trigger_events("\160\157\x73\x74\x5f\162\145\147\151\163\x74\145\162"); goto E9SO2; kvIPU: $this->trigger_events("\160\x72\145\137\162\145\x67\x69\x73\164\x65\x72"); goto EQPGb; wAnBu: if (empty($groups)) { goto gAQBI; } goto MxVEm; fG4Oi: return FALSE; goto KxBkx; EQPGb: $manual_activation = $this->config->item("\x6d\x61\x6e\x75\x61\x6c\137\x61\143\164\151\x76\x61\164\151\x6f\156", "\151\157\x6e\137\141\165\164\x68"); goto AUoJm; fDiLQ: $password = $this->hash_password($password); goto ZYwwY; QiZqD: $groups[] = $default_group->id; goto RUb7u; Pu5xB: $this->set_error("\x61\x63\143\157\165\x6e\164\x5f\x63\162\x65\141\x74\151\x6f\x6e\137\151\x6e\x76\x61\x6c\x69\144\137\144\145\x66\141\165\x6c\164\x5f\147\162\157\x75\160"); goto fG4Oi; NMcA6: $ip_address = $this->input->ip_address(); goto fDiLQ; suawO: $this->set_error("\x61\x63\143\157\x75\x6e\x74\x5f\x63\162\145\x61\x74\151\x6f\156\137\165\x6e\x73\x75\143\x63\145\x73\x73\x66\165\x6c"); goto Yg1D3; oExIQ: } public function login($identity, $password, $remember = FALSE) { goto PMUas; J8iuY: $this->rehash_password_if_needed($user->password, $identity, $password); goto UYljm; tq4dv: zJ7_k: goto pyQKE; pK69M: $this->trigger_events(["\x70\157\163\x74\x5f\x6c\157\147\151\156", "\x70\x6f\x73\x74\x5f\x6c\157\x67\x69\156\x5f\163\x75\x63\143\x65\163\163\146\165\154"]); goto IISKF; EPwjy: $this->clear_login_attempts($identity); goto HgTUL; Llf2O: $this->set_error("\x6c\x6f\147\x69\156\x5f\x75\x6e\163\x75\143\143\145\163\x73\x66\x75\154"); goto E8mKE; AWaLg: return FALSE; goto y0Xhb; GPIO3: $this->set_error("\154\x6f\147\151\x6e\137\165\x6e\163\165\143\143\x65\163\163\146\x75\154"); goto AWaLg; gJJj6: if (!$this->is_max_login_attempts_exceeded($identity)) { goto JFPw4; } goto gG6wd; E8mKE: return FALSE; goto tq4dv; jPAxN: if (!(empty($identity) || empty($password))) { goto zJ7_k; } goto Llf2O; HBPAz: JFPw4: goto TUdHG; IISKF: $this->set_message("\154\157\x67\151\156\x5f\163\x75\143\x63\x65\x73\x73\146\165\x6c"); goto NrJW1; lsiiS: fEsdM: goto a_vTZ; fgI0r: $this->set_error("\x6c\157\147\151\156\x5f\x75\156\163\x75\143\143\x65\x73\163\146\165\154\137\x6e\x6f\x74\x5f\x61\x63\x74\151\166\145"); goto jvizF; s4RzK: if (!$this->config->item("\162\145\155\145\x6d\142\x65\162\137\x75\163\x65\x72\x73", "\151\157\x6e\137\x61\165\x74\x68")) { goto JpmWU; } goto eDZRh; qjF11: $this->trigger_events("\x70\157\163\x74\x5f\154\157\147\151\156\x5f\x75\x6e\x73\165\x63\143\x65\163\163\x66\x75\154"); goto GPIO3; ugbxq: $this->increase_login_attempts($identity); goto qjF11; qQk_O: $this->remember_user($identity); goto hYC8K; gG6wd: $this->hash_password($password); goto NFjo6; UYljm: $this->session->sess_regenerate(FALSE); goto pK69M; pyQKE: $this->trigger_events("\145\x78\x74\162\x61\x5f\x77\150\x65\x72\145"); goto atiGQ; eDZRh: if ($remember) { goto cK6QQ; } goto KkORs; URkP3: if (!($user->active == 0)) { goto fEsdM; } goto uR3Zu; a_vTZ: $this->set_session($user); goto uUFXX; vzVpy: if (!$this->verify_password($password, $user->password, $identity)) { goto xB0bR; } goto URkP3; KkORs: $this->clear_remember_code($identity); goto iP1cf; mpI_7: xB0bR: goto Vdovf; Fl8hc: $user = $query->row(); goto vzVpy; atiGQ: $query = $this->db->select($this->identity_column . "\54\40\145\x6d\141\151\154\54\x20\x69\144\54\40\160\141\163\x73\x77\157\x72\144\54\40\141\x63\x74\x69\166\x65\54\40\154\141\163\164\137\154\x6f\147\x69\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\x73\143")->get($this->tables["\165\x73\x65\162\163"]); goto gJJj6; D8EhO: $this->hash_password($password); goto ugbxq; PMUas: $this->trigger_events("\x70\x72\x65\137\154\x6f\x67\151\x6e"); goto jPAxN; Vdovf: JlJ4w: goto D8EhO; hYC8K: rQsMn: goto Z6wBy; NrJW1: return TRUE; goto mpI_7; HgTUL: $this->clear_forgotten_password_code($identity); goto s4RzK; uUFXX: $this->update_last_login($user->id); goto EPwjy; iP1cf: goto rQsMn; goto Ta9hc; TUdHG: if (!($query->num_rows() === 1)) { goto JlJ4w; } goto Fl8hc; NFjo6: $this->trigger_events("\160\157\163\164\137\154\157\147\151\156\x5f\x75\x6e\x73\x75\143\x63\x65\163\163\x66\165\154"); goto fBFlf; Ta9hc: cK6QQ: goto qQk_O; jvizF: return FALSE; goto lsiiS; fBFlf: $this->set_error("\154\157\147\x69\x6e\137\x74\151\x6d\x65\x6f\x75\164"); goto LHjzG; uR3Zu: $this->trigger_events("\160\x6f\x73\x74\x5f\x6c\x6f\147\151\x6e\x5f\165\156\163\x75\143\x63\145\163\x73\146\165\x6c"); goto fgI0r; LHjzG: return FALSE; goto HBPAz; Z6wBy: JpmWU: goto J8iuY; y0Xhb: } public function recheck_session() { goto HjyeQ; dENwY: S1PJi: goto kYxmX; BhpQr: if ($query->num_rows() === 1) { goto S1PJi; } goto PVY73; MEG33: VcZ7v: goto S125S; mjbLx: return FALSE; goto i4pZZ; x17bk: if (!($recheck !== 0)) { goto KUpey; } goto vIg39; bunHp: return (bool) $this->session->userdata("\151\144\145\156\x74\151\x74\x79"); goto au017; i4pZZ: goto VcZ7v; goto dENwY; EZR3z: $identity = $this->config->item("\151\x64\x65\156\x74\151\164\171", "\x69\x6f\x6e\137\x61\165\164\150"); goto LKENr; sSsnX: if (!($last_login + $recheck < time())) { goto zbI8U; } goto tPSsY; vIg39: $last_login = $this->session->userdata("\x6c\x61\163\164\x5f\143\x68\x65\143\x6b"); goto sSsnX; HjyeQ: $recheck = NULL !== $this->config->item("\162\145\143\x68\x65\143\153\x5f\x74\151\155\x65\x72", "\x69\157\156\x5f\x61\x75\x74\150") ? $this->config->item("\x72\x65\143\150\x65\x63\153\137\164\x69\x6d\145\162", "\151\x6f\156\137\141\x75\x74\150") : 0; goto x17bk; LKENr: $this->session->unset_userdata([$identity, "\x69\x64", "\165\163\x65\162\x5f\151\144"]); goto mjbLx; S125S: zbI8U: goto yDeW9; PVY73: $this->trigger_events("\154\157\x67\157\x75\x74"); goto EZR3z; tPSsY: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\x64\x65\x6e\164\151\x74\x79"), "\141\x63\x74\151\x76\x65" => "\61"])->limit(1)->order_by("\x69\x64", "\144\x65\x73\x63")->get($this->tables["\x75\x73\x65\162\x73"]); goto BhpQr; kYxmX: $this->session->set_userdata("\x6c\141\163\x74\137\143\x68\x65\143\x6b", time()); goto MEG33; yDeW9: KUpey: goto bunHp; au017: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto Xe5C4; MpfSO: $attempts = $this->get_attempts_num($identity, $ip_address); goto TAzIz; b11Ok: $max_attempts = $this->config->item("\155\141\170\151\x6d\165\155\x5f\154\x6f\x67\x69\156\x5f\x61\x74\164\145\x6d\160\164\163", "\x69\x6f\156\137\x61\x75\164\150"); goto GLBbN; gvvSB: rVFRq: goto FVoy_; Xe5C4: if (!$this->config->item("\164\162\141\143\153\x5f\154\157\147\151\x6e\x5f\x61\164\x74\145\155\x70\x74\x73", "\151\157\156\x5f\141\165\x74\150")) { goto rVFRq; } goto b11Ok; GLBbN: if (!($max_attempts > 0)) { goto ZwRy0; } goto MpfSO; blnoR: ZwRy0: goto gvvSB; FVoy_: return FALSE; goto nHwl5; TAzIz: return $attempts >= $max_attempts; goto blnoR; nHwl5: } public function get_attempts_num($identity, $ip_address = NULL) { goto l8F4F; INYtj: $ip_address = $this->input->ip_address(); goto pqCEl; pqCEl: Mb4X8: goto qdH8z; xXTiM: $qres = $this->db->get($this->tables["\x6c\x6f\x67\151\156\137\141\164\164\x65\155\160\164\163"]); goto oIiX6; yoQS2: return 0; goto nYkQx; rgdQQ: $this->db->where("\164\151\x6d\145\40\76", time() - $this->config->item("\x6c\x6f\143\x6b\157\165\164\x5f\164\151\x6d\x65", "\x69\157\x6e\x5f\x61\165\164\x68"), FALSE); goto xXTiM; umYqh: $this->db->select("\x31", FALSE); goto GHniH; qdH8z: $this->db->where("\x69\x70\137\x61\x64\x64\162\x65\x73\x73", $ip_address); goto pbZOq; xqv9j: if (!$this->config->item("\164\x72\141\x63\153\x5f\154\157\147\151\x6e\x5f\x69\x70\x5f\141\144\x64\x72\x65\163\x73", "\x69\157\x6e\x5f\x61\x75\x74\x68")) { goto TTaAJ; } goto LMvHr; LMvHr: if (isset($ip_address)) { goto Mb4X8; } goto INYtj; pbZOq: TTaAJ: goto rgdQQ; l8F4F: if (!$this->config->item("\x74\162\141\x63\153\137\x6c\157\147\151\x6e\x5f\141\x74\164\145\x6d\160\x74\163", "\x69\x6f\156\137\x61\x75\x74\x68")) { goto jkhIr; } goto umYqh; GHniH: $this->db->where("\x6c\x6f\x67\x69\x6e", $identity); goto xqv9j; oIiX6: return $qres->num_rows(); goto bqecs; bqecs: jkhIr: goto yoQS2; nYkQx: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto VzowX; TRtc9: a875H: goto c1YV3; XGzLx: $ip_address = $this->input->ip_address(); goto QzhuC; c1YV3: kALVe: goto t1hA3; me5jS: Bq89Y: goto wjMR_; o5kk2: $this->db->where("\154\157\147\x69\156", $identity); goto LGW4U; SceDU: $this->db->select("\x74\x69\x6d\x65"); goto o5kk2; WHZTU: if (isset($ip_address)) { goto MVomA; } goto XGzLx; THAg7: $qres = $this->db->get($this->tables["\154\157\147\151\156\x5f\141\164\x74\x65\155\x70\x74\163"], 1); goto l11EC; oJycK: return $qres->row()->time; goto TRtc9; QzhuC: MVomA: goto IFTlr; VzowX: if (!$this->config->item("\x74\x72\x61\143\153\x5f\154\x6f\x67\x69\156\137\x61\164\164\x65\155\x70\164\163", "\x69\x6f\x6e\137\x61\x75\x74\150")) { goto kALVe; } goto SceDU; wjMR_: $this->db->order_by("\151\x64", "\x64\x65\x73\143"); goto THAg7; t1hA3: return 0; goto zN4Mv; l11EC: if (!($qres->num_rows() > 0)) { goto a875H; } goto oJycK; IFTlr: $this->db->where("\x69\160\137\141\x64\x64\x72\x65\x73\163", $ip_address); goto me5jS; LGW4U: if (!$this->config->item("\x74\162\x61\x63\153\x5f\x6c\157\x67\151\x6e\x5f\151\160\137\141\144\144\x72\145\163\163", "\x69\x6f\x6e\x5f\141\x75\164\x68")) { goto Bq89Y; } goto WHZTU; zN4Mv: } public function get_last_attempt_ip($identity) { goto BND0y; stT6R: $this->db->select("\151\160\137\141\x64\x64\x72\x65\x73\163"); goto IDWEC; BND0y: if (!($this->config->item("\x74\162\x61\x63\x6b\x5f\x6c\x6f\147\x69\x6e\137\141\164\164\145\x6d\160\x74\163", "\x69\157\156\x5f\141\x75\x74\x68") && $this->config->item("\164\x72\141\143\x6b\x5f\x6c\x6f\x67\x69\156\137\151\x70\x5f\141\144\x64\x72\x65\x73\163", "\151\157\x6e\137\x61\165\164\150"))) { goto RJvxy; } goto stT6R; IDWEC: $this->db->where("\154\157\147\x69\156", $identity); goto q_VE8; aPXj5: if (!($qres->num_rows() > 0)) { goto xiLb3; } goto RPHzS; Ae1nJ: $qres = $this->db->get($this->tables["\154\x6f\147\151\x6e\137\141\x74\x74\x65\x6d\160\x74\x73"], 1); goto aPXj5; RPHzS: return $qres->row()->ip_address; goto ADW5q; ADW5q: xiLb3: goto t0wkf; q_VE8: $this->db->order_by("\151\x64", "\x64\x65\163\x63"); goto Ae1nJ; t0wkf: RJvxy: goto ZnOoe; ZnOoe: return ''; goto PGGMJ; PGGMJ: } public function increase_login_attempts($identity) { goto yTLT3; ZMb6u: bUiOm: goto NBBac; yTLT3: if (!$this->config->item("\164\x72\x61\143\153\x5f\154\x6f\147\x69\x6e\137\x61\164\164\x65\155\160\164\x73", "\151\x6f\156\137\x61\165\164\150")) { goto e_Ft3; } goto XPa8o; Uxrs2: return FALSE; goto jbZLa; NBBac: return $this->db->insert($this->tables["\154\x6f\x67\x69\156\137\141\x74\164\x65\155\160\164\x73"], $data); goto mR5YQ; if2Im: if (!$this->config->item("\164\162\141\143\153\x5f\154\x6f\x67\x69\x6e\x5f\151\160\137\x61\144\144\162\x65\163\x73", "\x69\x6f\x6e\x5f\x61\165\x74\150")) { goto bUiOm; } goto Bxb3x; mR5YQ: e_Ft3: goto Uxrs2; Bxb3x: $data["\151\x70\137\x61\x64\144\x72\x65\163\163"] = $this->input->ip_address(); goto ZMb6u; XPa8o: $data = ["\x69\x70\137\141\144\x64\x72\x65\x73\x73" => '', "\x6c\157\147\151\x6e" => $identity, "\164\151\155\145" => time()]; goto if2Im; jbZLa: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto kEyqY; eQcLq: return FALSE; goto WxhNY; w54i2: $this->db->or_where("\x74\x69\x6d\145\x20\x3c", time() - $old_attempts_expire_period, FALSE); goto pIrn8; TCORW: $ip_address = $this->input->ip_address(); goto WPPsc; dAMqq: if (isset($ip_address)) { goto xV2Qc; } goto TCORW; pIrn8: return $this->db->delete($this->tables["\154\x6f\147\x69\156\137\x61\x74\164\145\155\160\x74\x73"]); goto LtlPS; nUtfb: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\157\147\151\156\137\x69\160\x5f\x61\144\x64\x72\145\163\x73", "\x69\157\x6e\137\x61\165\x74\x68")) { goto UVT0u; } goto dAMqq; LtlPS: OQ4jo: goto eQcLq; uQKRS: $this->db->where("\x6c\x6f\147\x69\x6e", $identity); goto nUtfb; WPPsc: xV2Qc: goto M4s9z; UBKog: UVT0u: goto w54i2; kEyqY: if (!$this->config->item("\x74\162\x61\143\153\x5f\154\x6f\x67\151\156\x5f\x61\164\164\x65\155\x70\164\163", "\151\x6f\x6e\137\141\165\x74\150")) { goto OQ4jo; } goto zqyFJ; zqyFJ: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\x63\153\157\165\164\x5f\164\x69\x6d\145", "\x69\157\x6e\137\x61\165\x74\x68")); goto uQKRS; M4s9z: $this->db->where("\151\160\x5f\141\144\144\x72\145\x73\x73", $ip_address); goto UBKog; WxhNY: } public function limit($limit) { goto UUfs3; PYEGm: $this->_ion_limit = $limit; goto kX2Yb; kX2Yb: return $this; goto rkYqX; UUfs3: $this->trigger_events("\154\x69\155\x69\x74"); goto PYEGm; rkYqX: } public function offset($offset) { goto Om4_D; gJXhk: $this->_ion_offset = $offset; goto V0CK6; Om4_D: $this->trigger_events("\x6f\x66\146\163\x65\164"); goto gJXhk; V0CK6: return $this; goto U7XL4; U7XL4: } public function where($where, $value = NULL) { goto mBfkV; nL188: array_push($this->_ion_where, $where); goto MzRKO; BWeXP: if (is_array($where)) { goto kPsAj; } goto xhlW4; Bc4Zt: kPsAj: goto nL188; mBfkV: $this->trigger_events("\x77\x68\145\162\x65"); goto BWeXP; MzRKO: return $this; goto wvuHA; xhlW4: $where = [$where => $value]; goto Bc4Zt; wvuHA: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\150") { goto L440E; L440E: $this->trigger_events("\x6c\151\153\145"); goto JmpGw; JmpGw: array_push($this->_ion_like, ["\154\x69\153\145" => $like, "\166\141\154\x75\x65" => $value, "\160\x6f\x73\x69\x74\151\157\x6e" => $position]); goto o1C9a; o1C9a: return $this; goto ddXyq; ddXyq: } public function select($select) { goto Owbc5; Owbc5: $this->trigger_events("\163\145\154\145\x63\x74"); goto IGAVH; gjSm8: return $this; goto PjJTv; IGAVH: $this->_ion_select[] = $select; goto gjSm8; PjJTv: } public function order_by($by, $order = "\144\x65\x73\x63") { goto x7pT3; x7pT3: $this->trigger_events("\x6f\x72\x64\145\162\x5f\142\x79"); goto TIB3O; kddHM: $this->_ion_order = $order; goto Zny5A; Zny5A: return $this; goto eaL6F; TIB3O: $this->_ion_order_by = $by; goto kddHM; eaL6F: } public function row() { goto VV3Qw; Jo6Wy: return $row; goto XE2gb; suE1_: $row = $this->response->row(); goto Jo6Wy; VV3Qw: $this->trigger_events("\162\x6f\167"); goto suE1_; XE2gb: } public function row_array() { goto L78U3; dn22n: return $row; goto xTuoU; GyP9u: $row = $this->response->row_array(); goto dn22n; L78U3: $this->trigger_events(["\x72\157\167", "\x72\x6f\167\x5f\x61\162\162\x61\171"]); goto GyP9u; xTuoU: } public function result() { goto Sx2xT; U3yWI: $result = $this->response->result(); goto A9hdx; Sx2xT: $this->trigger_events("\x72\145\163\165\x6c\164"); goto U3yWI; A9hdx: return $result; goto pW5U9; pW5U9: } public function result_array() { goto tlM77; tlM77: $this->trigger_events(["\x72\145\163\x75\x6c\x74", "\162\x65\x73\x75\154\164\137\141\x72\162\141\x79"]); goto ngeoF; ngeoF: $result = $this->response->result_array(); goto dlimu; dlimu: return $result; goto JQR9r; JQR9r: } public function num_rows() { goto U798s; U798s: $this->trigger_events(["\156\165\x6d\137\x72\157\x77\x73"]); goto OBSEk; xAhS_: return $result; goto RSAnm; OBSEk: $result = $this->response->num_rows(); goto xAhS_; RSAnm: } public function users($groups = NULL) { goto P8Lov; IZHEe: $this->db->join($this->tables["\165\x73\x65\x72\163\137\147\162\x6f\x75\x70\x73"], $this->tables["\x75\x73\x65\162\x73\x5f\x67\162\x6f\x75\x70\x73"] . "\56" . $this->join["\x75\x73\x65\162\163"] . "\x3d" . $this->tables["\x75\x73\145\162\x73"] . "\x2e\x69\144", "\x69\x6e\x6e\x65\162"); goto B286c; qCszj: $this->_ion_select = []; goto bMVRI; gWQLp: $groups = [$groups]; goto NpBaf; dhAxG: $this->response = $this->db->get($this->tables["\165\163\145\x72\x73"]); goto KgWdq; saiUb: foreach ($this->_ion_select as $select) { $this->db->select($select); K7kB1: } goto SkPNf; KgWdq: return $this; goto sOo6I; B286c: bcntf: goto UXQHx; Ou0Ki: $this->_ion_limit = NULL; goto FAP7m; RHN01: xTj9y: goto aSYeB; EbTbT: $this->db->distinct(); goto IZHEe; pORfR: Ncbge: goto NXstx; NXstx: goto xXW43; goto PAboF; pbcVv: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto Hkahh; nf9GX: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\137\x77\150\145\x72\145\x5f\151\x6e" : "\167\x68\x65\x72\x65\137\x69\156"; goto UVhPZ; Q413z: qKmkU: goto FN_sc; UVhPZ: if (empty($group_names)) { goto qwhz8; } goto JZ6di; oKOr3: xXW43: goto Q5FFD; CGq3V: foreach ($this->_ion_where as $where) { $this->db->where($where); b8Uhd: } goto RHN01; daxB1: if (!isset($this->_ion_limit)) { goto Ncbge; } goto Im84D; SONWD: Fpkjy: goto nf9GX; uxh02: if (empty($group_ids)) { goto qKmkU; } goto CuFkq; Q5FFD: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto o7XWK; } goto pbcVv; aSYeB: $this->_ion_where = []; goto touq4; D4p4R: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto HbV2Z; } goto daxB1; mIf33: foreach ($groups as $group) { goto uQ3pg; nh9mC: goto hv2Zp; goto fw7Af; IW9Gi: hv2Zp: goto xAZlg; bH0xy: $group_ids[] = $group; goto IW9Gi; uQ3pg: if (is_numeric($group)) { goto zea5l; } goto WMfWv; WMfWv: $group_names[] = $group; goto nh9mC; fw7Af: zea5l: goto bH0xy; xAZlg: ffj_p: goto AwJ4Y; AwJ4Y: } goto SONWD; Gwf4A: $this->db->where_in($this->tables["\147\162\157\x75\160\163"] . "\56\156\x61\x6d\145", $group_names); goto I4Vge; gvTZX: $group_names = []; goto mIf33; CuRJc: if (!isset($groups)) { goto BP1m_; } goto W_Lb6; AJsN1: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto SO5IT; } goto CGq3V; mYT3Q: $this->trigger_events("\x65\x78\164\x72\141\137\167\150\145\162\x65"); goto AJsN1; DUDTf: $this->_ion_like = []; goto xvjyU; Im84D: $this->db->limit($this->_ion_limit); goto dGyY0; TGIMV: goto hbL38; goto e1Obf; reXdF: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto Ou0Ki; bMVRI: hbL38: goto CuRJc; Hkahh: $this->_ion_order = NULL; goto avwUP; xvjyU: j12tG: goto D4p4R; JyvkJ: ccj6N: goto DUDTf; touq4: SO5IT: goto qzFxx; e1Obf: N4Udi: goto saiUb; zu1Vm: if (!(isset($groups) && !empty($groups))) { goto bcntf; } goto EbTbT; avwUP: $this->_ion_order_by = NULL; goto LtZKZ; SrMtX: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\x69\x6b\x65"], $like["\166\141\154\165\145"], $like["\160\x6f\x73\151\x74\151\x6f\x6e"]); upoau: } goto JyvkJ; CuFkq: $this->db->{$or_where_in}($this->tables["\165\x73\145\x72\163\137\147\162\x6f\x75\160\163"] . "\56" . $this->join["\147\162\x6f\165\160\163"], $group_ids); goto Q413z; NpBaf: rjWbE: goto zu1Vm; SkPNf: fbx6m: goto qCszj; PAboF: HbV2Z: goto reXdF; dGyY0: $this->_ion_limit = NULL; goto pORfR; W_Lb6: if (is_array($groups)) { goto rjWbE; } goto gWQLp; FN_sc: BP1m_: goto mYT3Q; JZ6di: $this->db->join($this->tables["\x67\x72\157\x75\160\x73"], $this->tables["\x75\x73\x65\162\163\137\147\162\x6f\x75\160\163"] . "\56" . $this->join["\x67\162\157\165\x70\163"] . "\x20\x3d\x20" . $this->tables["\x67\162\157\x75\x70\163"] . "\56\x69\x64", "\x69\x6e\x6e\145\162"); goto Gwf4A; LtZKZ: o7XWK: goto dhAxG; IIVq7: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto N4Udi; } goto vA4wv; UXQHx: $group_ids = []; goto gvTZX; I4Vge: qwhz8: goto uxh02; P8Lov: $this->trigger_events("\165\x73\x65\162\x73"); goto IIVq7; qzFxx: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto j12tG; } goto SrMtX; vA4wv: $this->db->select([$this->tables["\x75\163\145\x72\x73"] . "\56\x2a", $this->tables["\x75\x73\145\x72\x73"] . "\56\151\144\40\x61\x73\40\x69\144", $this->tables["\165\163\145\x72\x73"] . "\x2e\x69\144\x20\x61\163\x20\x75\163\145\x72\137\x69\144"]); goto TGIMV; FAP7m: $this->_ion_offset = NULL; goto oKOr3; sOo6I: } public function user($id = NULL) { goto fwyax; mAcF6: $this->users(); goto AVMrY; fwyax: $this->trigger_events("\x75\163\145\162"); goto air_6; AVMrY: return $this; goto k3Dr8; cWch1: $this->order_by($this->tables["\x75\x73\x65\162\163"] . "\x2e\x69\x64", "\x64\145\163\x63"); goto tmjRi; tmjRi: $this->where($this->tables["\x75\x73\145\x72\163"] . "\x2e\x69\144", $id); goto mAcF6; X6ejH: $this->limit(1); goto cWch1; air_6: $id = isset($id) ? $id : $this->session->userdata("\165\x73\x65\162\x5f\151\x64"); goto X6ejH; k3Dr8: } public function get_users_groups($id = FALSE) { goto yhYbm; jNqHn: return $this->db->select($this->tables["\165\x73\145\162\x73\137\x67\162\157\x75\x70\163"] . "\56" . $this->join["\x67\162\157\165\x70\x73"] . "\x20\x61\x73\x20\x69\144\54\x20" . $this->tables["\147\x72\x6f\165\x70\163"] . "\56\156\141\x6d\x65\x2c\x20" . $this->tables["\147\162\157\x75\x70\163"] . "\56\x64\145\x73\x63\x72\151\x70\x74\151\157\156")->where($this->tables["\x75\163\x65\x72\x73\x5f\147\x72\x6f\165\160\163"] . "\x2e" . $this->join["\x75\163\x65\162\163"], $id)->join($this->tables["\x67\x72\157\x75\160\163"], $this->tables["\x75\163\x65\162\x73\x5f\x67\x72\x6f\165\x70\x73"] . "\56" . $this->join["\x67\x72\157\165\160\163"] . "\75" . $this->tables["\x67\x72\157\165\x70\x73"] . "\56\151\x64")->get($this->tables["\165\163\x65\162\163\x5f\147\x72\157\165\160\x73"]); goto oTikt; yhYbm: $this->trigger_events("\147\x65\x74\x5f\x75\x73\x65\x72\x73\x5f\147\x72\x6f\165\x70"); goto I0qNW; I0qNW: $id || ($id = $this->session->userdata("\x75\163\145\x72\x5f\151\x64")); goto jNqHn; oTikt: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto pxYy5; q5qu2: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; vuMIT: } goto wGAnn; jggW5: uT1km: goto CiIas; OaBjA: $users_groups = $this->get_users_groups($id)->result(); goto INDT1; spZUA: uQo0P: goto HJrwH; CiIas: $groups_array = $this->_cache_user_in_group[$id]; goto spZUA; L4jl6: return $check_all; goto kQNFC; hQg3j: $this->_cache_user_in_group[$id] = $groups_array; goto lUZCo; pxYy5: $this->trigger_events("\x69\156\x5f\147\162\x6f\165\160"); goto LkjPm; AjRqZ: Leova: goto Ti3Kg; uGNFf: $check_group = [$check_group]; goto AjRqZ; Ti3Kg: if (isset($this->_cache_user_in_group[$id])) { goto uT1km; } goto OaBjA; ybTco: if (is_array($check_group)) { goto Leova; } goto uGNFf; INDT1: $groups_array = []; goto q5qu2; lUZCo: goto uQo0P; goto jggW5; ayzx1: YpVqI: goto L4jl6; LkjPm: $id || ($id = $this->session->userdata("\x75\163\x65\x72\x5f\x69\x64")); goto ybTco; HJrwH: foreach ($check_group as $key => $value) { goto j82PL; j82PL: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto zZEaN; zZEaN: if (!(in_array($value, $groups) xor $check_all)) { goto se0mB; } goto tvj9a; tvj9a: return !$check_all; goto Ua0NF; nI2HA: bsvPQ: goto xn2eo; Ua0NF: se0mB: goto nI2HA; xn2eo: } goto ayzx1; wGAnn: ePlg5: goto hQg3j; kQNFC: } public function add_to_group($group_ids, $user_id = FALSE) { goto mi4Bo; v69dw: Abqn5: goto OTx2L; QW5cc: $user_id || ($user_id = $this->session->userdata("\x75\x73\145\x72\137\x69\x64")); goto nUhaS; nUhaS: if (is_array($group_ids)) { goto vQbPM; } goto QiPfw; mi4Bo: $this->trigger_events("\x61\x64\144\x5f\x74\x6f\137\x67\162\157\x75\x70"); goto QW5cc; TXsFp: $return = 0; goto VOs3Q; OTx2L: return $return; goto e8ZPf; QiPfw: $group_ids = [$group_ids]; goto mnwjx; VOs3Q: foreach ($group_ids as $group_id) { goto cxb2D; cxb2D: if (!$this->db->insert($this->tables["\165\x73\x65\162\x73\137\147\x72\x6f\x75\160\163"], [$this->join["\147\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\165\x73\145\x72\163"] => (float) $user_id])) { goto jW9OI; } goto hJKBR; dPUu6: j6Bxx: goto WDQAH; LRYQK: VSC1w: goto PJjHy; VyeZ3: gY88L: goto MsLVj; yJoV8: $group = $this->group($group_id)->result(); goto GFJRo; MsLVj: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto Z14Cg; hJKBR: if (isset($this->_cache_groups[$group_id])) { goto VSC1w; } goto yJoV8; qOlqv: $this->_cache_groups[$group_id] = $group_name; goto pQ1Na; PJjHy: $group_name = $this->_cache_groups[$group_id]; goto VyeZ3; Z14Cg: $return++; goto f9CGw; f9CGw: jW9OI: goto dPUu6; pQ1Na: goto gY88L; goto LRYQK; GFJRo: $group_name = $group[0]->name; goto qOlqv; WDQAH: } goto v69dw; mnwjx: vQbPM: goto TXsFp; e8ZPf: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto ojUCf; Ep15q: foreach ($group_ids as $group_id) { goto N8pdr; N8pdr: $this->db->delete($this->tables["\165\163\145\x72\x73\137\x67\x72\157\x75\160\163"], [$this->join["\x67\x72\157\x75\x70\x73"] => (float) $group_id, $this->join["\165\x73\x65\x72\x73"] => (float) $user_id]); goto NrMVO; p6L9S: wE8fy: goto jyLYk; eGPKF: unset($this->_cache_user_in_group[$user_id][$group_id]); goto p6L9S; jyLYk: XcTXn: goto bHsjI; NrMVO: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto wE8fy; } goto eGPKF; bHsjI: } goto fqtFp; GwgN5: Q0FSZ: goto rKD6U; xi6Vm: return FALSE; goto GwgN5; qQdOk: p2RS5: goto FPKBY; rKD6U: if (!empty($group_ids)) { goto p2RS5; } goto vIFQy; dZ5x8: UNYyh: goto G4ja3; sjYtV: $this->_cache_user_in_group[$user_id] = []; goto dZ5x8; f5hpw: $return = TRUE; goto mXPCA; fqtFp: ZVbuz: goto f5hpw; FPKBY: if (is_array($group_ids)) { goto v55dK; } goto plB70; mXPCA: qtmQY: goto GYLQE; GYLQE: return $return; goto k5llt; G4ja3: goto qtmQY; goto qQdOk; JDOHM: if (!empty($user_id)) { goto Q0FSZ; } goto xi6Vm; ojUCf: $this->trigger_events("\162\145\155\157\x76\145\137\146\x72\x6f\155\x5f\x67\162\157\165\x70"); goto JDOHM; vIFQy: if (!($return = $this->db->delete($this->tables["\x75\163\x65\x72\x73\x5f\147\162\x6f\165\160\163"], [$this->join["\165\x73\x65\162\163"] => (float) $user_id]))) { goto UNYyh; } goto sjYtV; u7qbv: v55dK: goto Ep15q; plB70: $group_ids = [$group_ids]; goto u7qbv; k5llt: } public function groups() { goto amEvC; AedEz: return $this; goto sa9dV; kuiox: $this->_ion_limit = NULL; goto z6e_x; m_jVq: $this->_ion_where = []; goto vXizl; mDwQd: $this->_ion_limit = NULL; goto mUzAD; opA1O: zvpfD: goto TBImo; mUzAD: h6ApU: goto Ycfa8; m68TJ: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto v4PA2; } goto rE9YM; amEvC: $this->trigger_events("\x67\162\x6f\165\x70\163"); goto m68TJ; vYha7: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto opA1O; UfZ0o: IWOtV: goto Bfn6n; XqjV0: $this->db->limit($this->_ion_limit); goto mDwQd; TBImo: $this->response = $this->db->get($this->tables["\147\x72\x6f\165\x70\163"]); goto AedEz; Bfn6n: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto kuiox; d6jWj: iBWd6: goto m_jVq; Ycfa8: goto h5fSW; goto UfZ0o; z6e_x: $this->_ion_offset = NULL; goto hXn3a; hXn3a: h5fSW: goto l8aRW; rE9YM: foreach ($this->_ion_where as $where) { $this->db->where($where); fCZCs: } goto d6jWj; eBqZk: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto IWOtV; } goto ZwKac; l8aRW: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto zvpfD; } goto vYha7; ZwKac: if (!isset($this->_ion_limit)) { goto h6ApU; } goto XqjV0; vXizl: v4PA2: goto eBqZk; sa9dV: } public function group($id = NULL) { goto RLDBb; Z30EY: $this->limit(1); goto xLOeU; hoP8N: if (!isset($id)) { goto bgSM8; } goto x30vl; x30vl: $this->where($this->tables["\x67\162\x6f\x75\x70\x73"] . "\56\151\144", $id); goto CJyIQ; uOi4M: return $this->groups(); goto NdEOw; xLOeU: $this->order_by("\151\144", "\x64\145\163\x63"); goto uOi4M; RLDBb: $this->trigger_events("\147\162\157\x75\160"); goto hoP8N; CJyIQ: bgSM8: goto Z30EY; NdEOw: } public function update($id, array $data) { goto UaLZ1; hUqiA: $this->trigger_events(["\160\157\x73\164\137\x75\160\144\x61\164\145\x5f\x75\x73\x65\162", "\x70\157\x73\164\137\165\160\144\x61\x74\x65\137\165\x73\145\x72\137\x75\156\163\165\143\x63\x65\163\x73\x66\165\154"]); goto iOKnH; yFL4X: $data = $this->_filter_data($this->tables["\x75\163\x65\x72\x73"], $data); goto Pa798; hgupv: $this->db->trans_rollback(); goto hUqiA; syzsA: return FALSE; goto mskeK; bdL1d: $this->set_error("\x61\143\143\x6f\165\156\164\x5f\143\162\145\141\164\x69\157\x6e\137\144\x75\160\x6c\x69\x63\141\x74\x65\x5f\151\x64\145\x6e\x74\151\164\171"); goto sEHKM; rfd76: $this->db->trans_rollback(); goto G_jRS; iOKnH: $this->set_error("\165\x70\x64\x61\x74\145\137\165\156\163\x75\x63\x63\145\163\163\x66\x75\x6c"); goto HSbFL; R022p: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, ["\x69\x64" => $user->id]); goto w9zyA; vJf6P: $data["\x70\x61\x73\163\x77\157\x72\144"] = $this->hash_password($data["\x70\141\x73\x73\x77\x6f\162\x64"], $user->{$this->identity_column}); goto i54wQ; jMjoM: dPlwX: goto lS9V0; gJ4eM: $this->db->trans_commit(); goto fKoPS; uqk1i: $this->set_error("\165\x70\144\141\164\145\x5f\165\156\163\x75\143\143\x65\163\163\x66\165\x6c"); goto syzsA; UaLZ1: $this->trigger_events("\x70\162\x65\x5f\x75\x70\x64\141\164\145\x5f\165\x73\x65\x72"); goto C974_; aqgEX: $this->set_error("\x75\x70\x64\x61\x74\145\x5f\165\x6e\163\x75\143\143\x65\x73\163\146\x75\154"); goto nLfls; BvW87: $this->set_message("\165\160\x64\x61\164\x65\137\x73\165\143\143\145\163\x73\146\165\x6c"); goto jclpP; bAdcy: if (!empty($data["\x70\x61\x73\163\167\157\162\x64"])) { goto HsadE; } goto qODq8; G_jRS: $this->trigger_events(["\x70\157\163\x74\x5f\x75\x70\144\x61\164\145\137\x75\x73\x65\162", "\x70\157\163\164\137\165\160\144\x61\x74\x65\137\165\x73\145\162\137\x75\156\x73\x75\x63\x63\x65\163\163\x66\165\x6c"]); goto uqk1i; qODq8: unset($data["\160\x61\x73\163\x77\157\162\144"]); goto nC0Mn; Pa798: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\x73\x73\x77\157\162\x64", $data) || array_key_exists("\x65\x6d\141\151\154", $data))) { goto RjA6w; } goto QtWTT; HSbFL: return FALSE; goto jMjoM; M2g1g: $this->trigger_events("\x65\x78\x74\x72\141\x5f\x77\x68\145\162\145"); goto R022p; i54wQ: if (!($data["\160\141\163\x73\x77\x6f\x72\144"] === FALSE)) { goto dPlwX; } goto hgupv; fuW4S: RjA6w: goto M2g1g; bj83H: p4jd9: goto yFL4X; tNs31: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto p4jd9; } goto diTSq; nLfls: return FALSE; goto bj83H; w9zyA: if (!($this->db->trans_status() === FALSE)) { goto nFTdi; } goto rfd76; diTSq: $this->db->trans_rollback(); goto bdL1d; sJqPl: Ob5I1: goto fuW4S; dtTXu: $this->db->trans_begin(); goto tNs31; icbyz: HsadE: goto vJf6P; mskeK: nFTdi: goto gJ4eM; lS9V0: g6dn2: goto sJqPl; C974_: $user = $this->user($id)->row(); goto dtTXu; QtWTT: if (!array_key_exists("\x70\x61\x73\163\167\157\162\144", $data)) { goto Ob5I1; } goto bAdcy; nC0Mn: goto g6dn2; goto icbyz; jclpP: return TRUE; goto T_mew; sEHKM: $this->trigger_events(["\160\x6f\x73\x74\137\165\x70\x64\141\164\145\x5f\x75\x73\x65\x72", "\160\157\x73\x74\137\165\160\x64\141\x74\x65\137\x75\x73\145\x72\x5f\x75\156\163\x75\143\x63\145\163\163\146\165\154"]); goto aqgEX; fKoPS: $this->trigger_events(["\160\x6f\x73\164\x5f\x75\160\144\x61\x74\145\x5f\165\x73\145\162", "\160\x6f\x73\164\137\x75\x70\144\141\164\x65\137\165\x73\145\x72\137\x73\165\143\143\145\163\x73\x66\165\x6c"]); goto BvW87; T_mew: } public function delete_user($id) { goto oE8wg; Ongbz: $this->trigger_events(["\160\x6f\x73\164\137\x64\x65\x6c\145\164\x65\x5f\165\x73\145\162", "\160\157\x73\x74\x5f\x64\x65\154\x65\164\x65\137\165\163\145\162\x5f\x73\x75\x63\x63\145\163\x73\146\165\x6c"]); goto EDZBP; oU7TC: $this->trigger_events(["\160\157\163\x74\137\x64\145\x6c\145\164\145\x5f\x75\x73\145\x72", "\160\157\x73\164\137\x64\145\x6c\145\164\x65\x5f\165\x73\x65\x72\137\x75\156\163\165\143\x63\145\x73\x73\x66\165\x6c"]); goto BRPcw; bGWk2: $this->db->delete($this->tables["\165\x73\145\162\x73"], ["\151\144" => $id]); goto dIdPI; BRPcw: $this->set_error("\x64\145\x6c\x65\x74\x65\137\x75\x6e\x73\x75\143\143\145\x73\x73\x66\x75\x6c"); goto LY2x5; TdsbJ: o_A0p: goto zte17; zte17: $this->db->trans_commit(); goto Ongbz; mYbC3: $this->db->trans_rollback(); goto oU7TC; bCRcb: return TRUE; goto Ri6DZ; EDZBP: $this->set_message("\144\145\x6c\145\164\145\137\x73\x75\x63\x63\145\163\x73\x66\x75\154"); goto bCRcb; LY2x5: return FALSE; goto TdsbJ; CYv02: $this->remove_from_group(NULL, $id); goto bGWk2; oE8wg: $this->trigger_events("\160\162\x65\137\144\x65\154\x65\x74\x65\x5f\x75\163\145\162"); goto rn2UV; rn2UV: $this->db->trans_begin(); goto CYv02; dIdPI: if (!($this->db->trans_status() === FALSE)) { goto o_A0p; } goto mYbC3; Ri6DZ: } public function update_last_login($id) { goto M2Wyb; c5EPb: return $this->db->affected_rows() == 1; goto Ow6W8; YIR4I: $this->db->update($this->tables["\165\x73\145\162\163"], ["\154\141\x73\164\137\x6c\157\147\151\x6e" => time()], ["\151\x64" => $id]); goto c5EPb; M2Wyb: $this->trigger_events("\165\x70\144\x61\164\x65\137\x6c\141\x73\164\x5f\x6c\x6f\147\151\x6e"); goto y2Wea; p5ZRH: $this->trigger_events("\145\x78\164\162\141\x5f\x77\150\145\162\145"); goto YIR4I; y2Wea: $this->load->helper("\x64\x61\164\x65"); goto p5ZRH; Ow6W8: } public function set_lang($lang = "\145\x6e") { goto bLTf2; kdN25: set_cookie(["\156\x61\x6d\145" => "\x6c\141\x6e\147\137\143\157\144\145", "\x76\141\154\x75\145" => $lang, "\145\x78\160\x69\162\x65" => $expire]); goto Au1Iv; eM5xC: goto uHZ9B; goto r2Q3l; r2Q3l: JIJkO: goto Sdo72; utpam: $expire = $this->config->item("\x75\x73\145\x72\x5f\x65\170\x70\x69\x72\145", "\151\x6f\x6e\137\141\165\164\x68"); goto eM5xC; bLTf2: $this->trigger_events("\x73\x65\164\x5f\154\x61\156\147"); goto KaSax; Au1Iv: return TRUE; goto qbpnU; j6yAy: uHZ9B: goto kdN25; Sdo72: $expire = self::MAX_COOKIE_LIFETIME; goto j6yAy; KaSax: if ($this->config->item("\165\163\x65\x72\137\145\170\160\x69\162\145", "\151\157\156\x5f\141\x75\164\x68") === 0) { goto JIJkO; } goto utpam; qbpnU: } public function set_session($user) { goto JZl0S; Mjvoe: return TRUE; goto MAx8P; JZl0S: $this->trigger_events("\160\162\145\x5f\x73\145\x74\x5f\x73\x65\x73\x73\151\157\x6e"); goto GuM3H; zTfjY: $this->session->set_userdata($session_data); goto pYClH; GuM3H: $session_data = ["\x69\144\x65\156\x74\151\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\151\x6c" => $user->email, "\x75\x73\x65\x72\x5f\151\144" => $user->id, "\x6f\x6c\144\137\154\141\163\x74\137\x6c\157\x67\151\156" => $user->last_login, "\x6c\x61\x73\164\137\x63\150\x65\143\153" => time()]; goto zTfjY; pYClH: $this->trigger_events("\160\x6f\163\164\x5f\163\145\164\137\163\145\163\163\x69\x6f\156"); goto Mjvoe; MAx8P: } public function remember_user($identity) { goto wEVCU; QbAkv: $this->db->update($this->tables["\165\163\145\162\x73"], ["\162\145\x6d\145\x6d\142\x65\162\x5f\x73\x65\154\145\x63\164\x6f\x72" => $token->selector, "\162\145\x6d\x65\x6d\142\145\x72\137\x63\x6f\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto Z09JS; jsdOA: xQNP_: goto aWz53; AKNDB: set_cookie(["\156\141\155\x65" => $this->config->item("\162\x65\x6d\x65\155\x62\145\162\137\x63\157\x6f\153\151\145\137\156\x61\155\145", "\151\157\x6e\137\x61\x75\164\x68"), "\x76\x61\x6c\165\145" => $token->user_code, "\145\170\x70\x69\162\145" => $expire]); goto uw4u2; Z09JS: if (!($this->db->affected_rows() > -1)) { goto fe02p; } goto dnoW5; NOng9: if (!$token->validator_hashed) { goto r0hW1; } goto QbAkv; r119I: fe02p: goto Rk1P2; HX3nX: return FALSE; goto jsdOA; LnLFm: BfZSr: goto Gg6Qf; uw4u2: $this->trigger_events(["\160\x6f\163\164\x5f\x72\145\x6d\145\155\142\145\x72\137\165\163\x65\162", "\x72\145\155\x65\x6d\142\145\162\137\165\163\145\162\x5f\x73\x75\143\x63\x65\163\163\x66\x75\x6c"]); goto KDuqW; KDuqW: return TRUE; goto r119I; lAkp4: $this->trigger_events(["\160\157\x73\164\137\x72\x65\x6d\x65\155\142\x65\x72\x5f\165\163\x65\162", "\x72\145\x6d\x65\x6d\142\145\x72\137\x75\163\x65\x72\x5f\165\156\x73\165\143\143\x65\x73\163\146\165\154"]); goto yjjFw; P4U5R: CxkXB: goto AKNDB; wEVCU: $this->trigger_events("\160\x72\145\137\162\x65\155\x65\x6d\142\x65\x72\137\x75\163\145\x72"); goto pL7ys; dnoW5: if ($this->config->item("\x75\x73\x65\x72\x5f\145\x78\160\151\x72\x65", "\x69\157\x6e\x5f\141\165\164\150") === 0) { goto BfZSr; } goto muUpL; aWz53: $token = $this->_generate_selector_validator_couple(); goto NOng9; pL7ys: if ($identity) { goto xQNP_; } goto HX3nX; yjjFw: return FALSE; goto AajB1; q8l6q: goto CxkXB; goto LnLFm; muUpL: $expire = $this->config->item("\165\x73\145\x72\137\145\x78\160\x69\x72\x65", "\151\x6f\x6e\137\x61\x75\164\150"); goto q8l6q; Gg6Qf: $expire = self::MAX_COOKIE_LIFETIME; goto P4U5R; Rk1P2: r0hW1: goto lAkp4; AajB1: } public function login_remembered_user() { goto awFGD; RPePJ: S8bRq: goto swHhv; x0clv: if (!($token === FALSE)) { goto REoaD; } goto t9iyG; B6UMH: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto S8bRq; } goto OxW9t; awFGD: $this->trigger_events("\160\x72\x65\x5f\154\x6f\147\x69\156\137\162\x65\155\145\155\x62\145\162\145\x64\137\165\x73\145\162"); goto I6NqD; DWqXO: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto x0clv; TwlCS: $this->trigger_events(["\x70\x6f\x73\164\137\154\157\147\151\156\137\x72\x65\155\x65\x6d\x62\145\x72\x65\x64\x5f\x75\163\145\162", "\160\x6f\163\164\137\154\x6f\147\151\x6e\x5f\x72\145\x6d\x65\x6d\142\x65\x72\x65\144\x5f\165\x73\145\162\x5f\x75\x6e\x73\165\x63\x63\145\x73\163\x66\x75\154"]); goto XKFrM; j2NI2: REoaD: goto bzmaT; PeoUQ: $this->trigger_events(["\160\157\163\x74\x5f\154\x6f\x67\x69\x6e\x5f\162\145\x6d\x65\155\142\145\162\x65\x64\x5f\165\x73\145\162", "\160\157\x73\164\137\x6c\x6f\147\151\x6e\137\x72\x65\x6d\145\x6d\142\x65\x72\145\144\x5f\x75\x73\x65\x72\x5f\163\x75\143\143\145\163\163\146\x75\x6c"]); goto oPMpB; J962j: if (!$this->config->item("\165\x73\x65\162\x5f\x65\170\164\x65\x6e\x64\x5f\157\156\x5f\x6c\x6f\147\x69\156", "\151\x6f\x6e\x5f\141\x75\x74\x68")) { goto pe7ob; } goto VimAX; EdPCU: $user = $query->row(); goto YJjTk; MD07K: $this->set_session($user); goto fA8fZ; YJjTk: $identity = $user->{$this->identity_column}; goto B6UMH; eC3Dt: $this->session->sess_regenerate(FALSE); goto PeoUQ; oPMpB: return TRUE; goto RPePJ; nlYwX: pe7ob: goto eC3Dt; fA8fZ: $this->clear_forgotten_password_code($identity); goto J962j; jwmhB: return FALSE; goto j2NI2; t9iyG: $this->trigger_events(["\160\x6f\x73\x74\137\x6c\x6f\147\x69\x6e\x5f\x72\145\x6d\x65\x6d\142\145\162\x65\144\x5f\165\x73\145\x72", "\x70\157\163\x74\x5f\154\157\147\x69\156\137\x72\145\x6d\145\x6d\x62\145\162\145\144\x5f\x75\x73\145\162\x5f\x75\x6e\163\x75\x63\143\145\x73\x73\146\x75\154"]); goto jwmhB; bzmaT: $this->trigger_events("\145\170\164\x72\x61\x5f\x77\x68\145\x72\x65"); goto wxuCJ; VimAX: $this->remember_user($identity); goto nlYwX; OxW9t: $this->update_last_login($user->id); goto MD07K; XKFrM: return FALSE; goto Ih2Hs; wxuCJ: $query = $this->db->select($this->identity_column . "\x2c\x20\151\144\54\x20\145\155\x61\x69\x6c\x2c\x20\x72\x65\x6d\145\155\142\145\162\137\143\x6f\x64\145\x2c\40\154\x61\x73\164\x5f\x6c\x6f\147\x69\156")->where("\162\x65\x6d\145\155\142\145\162\x5f\163\145\154\x65\x63\164\x6f\x72", $token->selector)->where("\x61\143\164\151\x76\145", 1)->limit(1)->get($this->tables["\x75\x73\x65\162\163"]); goto M9Dcm; I6NqD: $remember_cookie = get_cookie($this->config->item("\x72\145\155\x65\x6d\142\145\x72\x5f\143\157\157\x6b\151\145\x5f\156\141\155\145", "\151\157\x6e\137\141\165\164\150")); goto DWqXO; swHhv: SQYKy: goto Tu7l7; Tu7l7: delete_cookie($this->config->item("\162\x65\155\x65\x6d\142\145\x72\137\x63\157\x6f\153\x69\145\x5f\x6e\141\155\145", "\x69\157\x6e\x5f\141\165\x74\x68")); goto TwlCS; M9Dcm: if (!($query->num_rows() === 1)) { goto SQYKy; } goto EdPCU; Ih2Hs: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto pWGDK; pyNoD: $data = ["\x6e\x61\155\x65" => $group_name, "\144\145\x73\143\x72\x69\160\164\x69\157\156" => $group_description]; goto oMdHt; bgYd8: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\x75\160\x73"], ["\156\141\155\145" => $group_name])->num_rows(); goto HoTGT; toqwp: return FALSE; goto mxun0; CGSdk: TG_nh: goto XDWms; cuzZS: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\x70\x73"], $additional_data), $data); goto CGSdk; iMMjT: $group_id = $this->db->insert_id($this->tables["\147\x72\157\165\160\x73"] . "\137\x69\x64\x5f\163\145\x71"); goto hgTqQ; HoTGT: if (!($existing_group !== 0)) { goto ERSgj; } goto s6MxE; lLEh5: $this->set_error("\147\162\x6f\x75\160\137\x6e\x61\155\145\137\162\145\161\165\x69\x72\145\144"); goto QVvEf; oMdHt: if (empty($additional_data)) { goto TG_nh; } goto cuzZS; gpVRP: $this->db->insert($this->tables["\147\162\157\165\160\x73"], $data); goto iMMjT; vTk1F: mfdTG: goto bgYd8; Duv8z: return $group_id; goto YH_mz; QVvEf: return FALSE; goto vTk1F; XDWms: $this->trigger_events("\145\170\164\x72\x61\x5f\x67\162\x6f\x75\160\x5f\x73\x65\x74"); goto gpVRP; mxun0: ERSgj: goto pyNoD; hgTqQ: $this->set_message("\x67\162\157\165\160\137\x63\x72\145\x61\164\x69\x6f\x6e\137\x73\x75\143\x63\x65\163\163\146\x75\x6c"); goto Duv8z; pWGDK: if ($group_name) { goto mfdTG; } goto lLEh5; s6MxE: $this->set_error("\x67\162\157\165\160\x5f\141\154\162\145\x61\144\171\x5f\x65\x78\x69\x73\x74\x73"); goto toqwp; YH_mz: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto jy_rq; x9E3Z: IidJz: goto mcNN7; Wg3Wu: if (empty($group_name)) { goto sJNU5; } goto MmEO0; pCvBc: sJNU5: goto D5dAh; aHKn4: $data["\x6e\x61\155\145"] = $group_name; goto pCvBc; Yk9xn: $this->set_error("\x67\x72\157\165\160\137\141\154\162\x65\x61\144\x79\x5f\145\170\151\x73\164\163"); goto g3s6U; mcNN7: $data = []; goto Wg3Wu; mXnGd: HHHHb: goto t3fEh; wsPCC: return TRUE; goto L95CB; g3s6U: return FALSE; goto nlfw7; A7WcZ: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto DuYRh; } goto Yk9xn; t3fEh: if (empty($additional_data)) { goto cnoTO; } goto CpOXD; U2YKF: cnoTO: goto LQjbr; CpOXD: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\x75\x70\x73"], $additional_data), $data); goto U2YKF; OPTPX: return FALSE; goto mXnGd; LQjbr: $this->db->update($this->tables["\147\162\x6f\165\x70\x73"], $data, ["\x69\x64" => $group_id]); goto HCHQB; nlfw7: DuYRh: goto aHKn4; v0Oi9: return FALSE; goto x9E3Z; jy_rq: if (!empty($group_id)) { goto IidJz; } goto v0Oi9; D5dAh: $group = $this->db->get_where($this->tables["\x67\162\157\x75\160\x73"], ["\151\144" => $group_id])->row(); goto yI72u; MmEO0: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\156\x61\x6d\145" => $group_name])->row(); goto A7WcZ; yI72u: if (!($this->config->item("\x61\x64\155\151\156\x5f\x67\x72\157\x75\160", "\151\x6f\156\x5f\141\x75\164\150") === $group->name && $group_name !== $group->name)) { goto HHHHb; } goto cqUzp; HCHQB: $this->set_message("\x67\162\157\165\x70\137\x75\x70\x64\141\164\145\x5f\163\165\143\x63\x65\x73\x73\x66\x75\x6c"); goto wsPCC; cqUzp: $this->set_error("\x67\x72\157\165\x70\137\x6e\x61\155\145\137\141\x64\155\151\x6e\x5f\156\157\x74\137\141\x6c\164\x65\162"); goto OPTPX; L95CB: } public function delete_group($group_id = FALSE) { goto fhaZh; zDaAt: TkxCZ: goto UfWCy; fhaZh: if (!(!$group_id || empty($group_id))) { goto uR7N3; } goto aPvCM; jxcGZ: $this->db->trans_rollback(); goto TF7KC; vuyG_: $this->db->delete($this->tables["\165\163\x65\162\x73\x5f\147\162\157\165\x70\x73"], [$this->join["\147\x72\x6f\x75\160\163"] => $group_id]); goto FrD6n; lSEC2: if (!($this->db->trans_status() === FALSE)) { goto wFP2A; } goto jxcGZ; ayl96: return FALSE; goto ECbnJ; ECbnJ: wFP2A: goto aFxHb; WVTuh: $this->db->trans_begin(); goto vuyG_; TF7KC: $this->trigger_events(["\160\x6f\163\x74\x5f\144\x65\154\x65\164\145\x5f\147\x72\x6f\165\x70", "\x70\157\x73\x74\137\144\145\154\x65\x74\x65\137\x67\162\x6f\x75\x70\x5f\x75\156\163\165\x63\x63\145\x73\x73\146\x75\x6c"]); goto ettiO; yJ420: return FALSE; goto zDaAt; aPvCM: return FALSE; goto qyRCb; XjJkt: $group = $this->group($group_id)->row(); goto haJGO; haJGO: if (!($group->name == $this->config->item("\141\144\155\x69\156\x5f\147\162\x6f\x75\x70", "\x69\157\x6e\137\x61\x75\164\150"))) { goto TkxCZ; } goto X7_nH; tscnO: $this->trigger_events(["\x70\157\163\164\x5f\x64\x65\154\x65\x74\x65\x5f\147\162\157\165\x70", "\160\x6f\163\164\137\144\x65\154\x65\164\145\x5f\147\162\x6f\x75\160\x5f\x73\x75\x63\x63\145\x73\163\x66\x75\x6c"]); goto dxXzR; qyRCb: uR7N3: goto XjJkt; Aab6D: $this->set_error("\x67\162\157\165\x70\137\x64\x65\x6c\145\x74\x65\x5f\x6e\x6f\x74\141\x6c\154\x6f\x77\x65\x64"); goto yJ420; X7_nH: $this->trigger_events(["\x70\157\163\x74\137\x64\x65\x6c\145\164\145\x5f\x67\x72\x6f\165\160", "\160\157\x73\x74\x5f\x64\145\x6c\x65\x74\x65\137\147\162\157\165\160\137\156\157\164\141\154\x6c\157\x77\145\x64"]); goto Aab6D; dxXzR: $this->set_message("\147\x72\157\x75\x70\x5f\144\x65\154\x65\x74\145\137\163\165\143\143\145\x73\163\x66\165\154"); goto MTG01; FrD6n: $this->db->delete($this->tables["\147\162\157\x75\160\163"], ["\151\x64" => $group_id]); goto lSEC2; UfWCy: $this->trigger_events("\x70\x72\145\137\144\145\x6c\x65\164\145\137\x67\x72\157\165\x70"); goto WVTuh; ettiO: $this->set_error("\x67\162\157\165\160\x5f\x64\x65\x6c\x65\x74\x65\x5f\x75\x6e\163\165\x63\143\145\163\x73\x66\x75\x6c"); goto ayl96; aFxHb: $this->db->trans_commit(); goto tscnO; MTG01: return TRUE; goto rlg4W; rlg4W: } public function set_hook($event, $name, $class, $method, $arguments) { goto U0JvF; U0JvF: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto PSDKq; ASTNi: $this->_ion_hooks->{$event}[$name]->method = $method; goto Jed3H; PSDKq: $this->_ion_hooks->{$event}[$name]->class = $class; goto ASTNi; Jed3H: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto yHb5r; yHb5r: } public function remove_hook($event, $name) { goto RKWFk; ab5pO: KvIWe: goto NuF6P; RKWFk: if (!isset($this->_ion_hooks->{$event}[$name])) { goto KvIWe; } goto Mpi12; Mpi12: unset($this->_ion_hooks->{$event}[$name]); goto ab5pO; NuF6P: } public function remove_hooks($event) { goto hP2cD; coTiY: W4Z_6: goto Mi8dh; rMGYl: unset($this->_ion_hooks->{$event}); goto coTiY; hP2cD: if (!isset($this->_ion_hooks->{$event})) { goto W4Z_6; } goto rMGYl; Mi8dh: } protected function _call_hook($event, $name) { goto fhDIW; e8XRL: QmLsP: goto iwfuI; iniT6: $hook = $this->_ion_hooks->{$event}[$name]; goto U0wsE; iwfuI: return FALSE; goto s_ndA; U0wsE: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto e8XRL; fhDIW: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto QmLsP; } goto iniT6; s_ndA: } public function trigger_events($events) { goto vtP7X; BO59r: foreach ($events as $event) { $this->trigger_events($event); XOgaW: } goto FKMET; CtdRt: OFiIE: goto OQixB; eKcvo: af20d: goto BO59r; vtP7X: if (is_array($events) && !empty($events)) { goto af20d; } goto JIDey; FKMET: cyTeN: goto KzMNV; KzMNV: T_1nt: goto ZbvOG; JIDey: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto qfDOD; } goto vO6sW; OQixB: qfDOD: goto sLrCj; vO6sW: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); qhPht: } goto CtdRt; sLrCj: goto T_1nt; goto eKcvo; ZbvOG: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto oznl5; oznl5: $this->message_start_delimiter = $start_delimiter; goto T_0zL; T_0zL: $this->message_end_delimiter = $end_delimiter; goto cks7k; cks7k: return TRUE; goto YCeYJ; YCeYJ: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto D4pLb; i7AZe: return TRUE; goto hreMB; P6XFC: $this->error_end_delimiter = $end_delimiter; goto i7AZe; D4pLb: $this->error_start_delimiter = $start_delimiter; goto P6XFC; hreMB: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto HeaSx; HeaSx: $_output = ''; goto pb55O; eLbDQ: JbPvY: goto GPmze; pb55O: foreach ($this->messages as $message) { goto EAqFt; MnvWU: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto YRTp_; YRTp_: QVVuD: goto pE_ef; EAqFt: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\43"; goto MnvWU; pE_ef: } goto eLbDQ; GPmze: return $_output; goto hF3gE; hF3gE: } public function messages_array($langify = TRUE) { goto Z6c1v; hLnTm: $_output = []; goto PFG3K; Jm5Po: goto tbKk4; goto yHsiK; PFG3K: foreach ($this->messages as $message) { goto vyHdw; vyHdw: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\43"; goto vFRqj; sZ0PP: ritZX: goto qnP1c; vFRqj: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto sZ0PP; qnP1c: } goto crgEm; MJpkt: return $this->messages; goto Jm5Po; crgEm: ewbod: goto iErvR; yHsiK: mYBly: goto hLnTm; V40bZ: tbKk4: goto R0880; Z6c1v: if ($langify) { goto mYBly; } goto MJpkt; iErvR: return $_output; goto V40bZ; R0880: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto xsFmh; xsFmh: $_output = ''; goto ngEqh; ngEqh: foreach ($this->errors as $error) { goto LdXT1; xUf3o: IhyzM: goto VY9EJ; LdXT1: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\43"; goto DRnO3; DRnO3: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto xUf3o; VY9EJ: } goto Qdmhx; otoDp: return $_output; goto o151u; Qdmhx: dQAdK: goto otoDp; o151u: } public function errors_array($langify = TRUE) { goto oDCqP; Jf4KV: return $this->errors; goto DSanT; nfPVz: chU5O: goto rVxtl; yuyFw: aNIKU: goto GSWHJ; DSanT: goto chU5O; goto yuyFw; tRvHO: foreach ($this->errors as $error) { goto sk8c4; UoM5Y: cQpoM: goto KGhuL; CHuL4: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto UoM5Y; sk8c4: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto CHuL4; KGhuL: } goto mcHq0; oDCqP: if ($langify) { goto aNIKU; } goto Jf4KV; GNT5i: return $_output; goto nfPVz; GSWHJ: $_output = []; goto tRvHO; mcHq0: E2Flu: goto GNT5i; rVxtl: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto d0rVj; QVh3l: $this->trigger_events("\x65\170\164\162\141\137\x77\x68\145\162\x65"); goto MCfN0; MCfN0: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto mv9zQ; RJv2_: $data = ["\x70\141\163\x73\167\x6f\162\x64" => $hash, "\x72\145\x6d\x65\x6d\x62\145\162\137\x63\157\x64\145" => NULL, "\146\x6f\x72\147\x6f\x74\x74\x65\156\x5f\160\141\163\x73\x77\157\x72\144\137\x63\x6f\144\145" => NULL, "\146\x6f\x72\x67\x6f\164\x74\x65\x6e\137\160\x61\x73\x73\x77\157\162\x64\x5f\164\x69\x6d\x65" => NULL]; goto QVh3l; z4viR: jbaS2: goto RJv2_; TnwVQ: if (!($hash === FALSE)) { goto jbaS2; } goto hFDX2; hFDX2: return FALSE; goto z4viR; mv9zQ: return $this->db->affected_rows() == 1; goto II8Ou; d0rVj: $hash = $this->hash_password($password, $identity); goto TnwVQ; II8Ou: } protected function _filter_data($table, $data) { goto NYxGp; PMHQN: TjZrB: goto ToUB1; NYxGp: $filtered_data = []; goto wkWhu; zm4Ov: foreach ($columns as $column) { goto TEaSc; O91bI: VQq1H: goto XZua9; r7iQ1: $filtered_data[$column] = $data[$column]; goto O91bI; TEaSc: if (!array_key_exists($column, $data)) { goto VQq1H; } goto r7iQ1; XZua9: mOhwZ: goto UseJ2; UseJ2: } goto ANiTn; N554p: if (!is_array($data)) { goto TjZrB; } goto zm4Ov; ANiTn: p5Zpw: goto PMHQN; ToUB1: return $filtered_data; goto kiIpK; wkWhu: $columns = $this->db->list_fields($table); goto N554p; kiIpK: } protected function _random_token($result_length = 32) { goto lYYFB; rm_V0: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto XCnor; uVZhR: return bin2hex(random_bytes($result_length / 2)); goto Fg8Z5; XCnor: z3dr6: goto eN3x6; waFDr: if (!function_exists("\x6d\143\x72\171\x70\x74\x5f\x63\162\145\141\x74\x65\x5f\151\x76")) { goto z3dr6; } goto rm_V0; LktTs: return FALSE; goto NoJg4; JphJ1: $result_length = 32; goto cmbYH; eN3x6: if (!function_exists("\157\x70\x65\x6e\163\x73\x6c\x5f\162\141\156\144\157\155\x5f\x70\163\145\x75\x64\157\137\142\171\x74\x65\163")) { goto R5Ysx; } goto tPwxQ; tPwxQ: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto EC9pP; OK9Fn: if (!function_exists("\162\x61\156\x64\157\155\137\142\x79\164\145\x73")) { goto XGaZ_; } goto uVZhR; cmbYH: iPi_R: goto OK9Fn; EC9pP: R5Ysx: goto LktTs; Fg8Z5: XGaZ_: goto waFDr; lYYFB: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto iPi_R; } goto JphJ1; NoJg4: } protected function _get_hash_parameters($identity = NULL) { goto p6K7l; her32: return $params; goto vfmzr; RTplO: $params = FALSE; goto vuiYa; FWulG: txrKu: goto RTplO; p6K7l: $is_admin = FALSE; goto QlPEt; vuiYa: switch ($this->hash_method) { case "\x62\143\x72\171\160\164": $params = ["\143\157\x73\x74" => $is_admin ? $this->config->item("\x62\x63\162\171\x70\x74\137\141\x64\x6d\x69\156\x5f\x63\x6f\163\164", "\151\157\156\137\141\x75\x74\x68") : $this->config->item("\142\x63\x72\x79\160\164\137\144\x65\146\141\x75\154\164\x5f\x63\x6f\163\x74", "\x69\157\x6e\x5f\x61\x75\x74\150")]; goto jJ9a5; case "\141\x72\147\x6f\156\x32": $params = $is_admin ? $this->config->item("\141\x72\147\157\x6e\62\137\x61\144\x6d\151\156\x5f\160\x61\x72\x61\155\163", "\151\x6f\x6e\137\x61\165\x74\x68") : $this->config->item("\141\x72\x67\x6f\156\62\x5f\144\x65\146\x61\165\154\x74\x5f\160\x61\x72\141\155\x73", "\x69\157\156\x5f\141\165\x74\150"); goto jJ9a5; default: } goto QOUlr; EWMnR: eoCW5: goto FWulG; lf6BJ: $is_admin = TRUE; goto EWMnR; QlPEt: if (!$identity) { goto txrKu; } goto URfGd; URfGd: $user_id = $this->get_user_id_from_identity($identity); goto eymr4; QOUlr: wrijv: goto ZLT2y; ZLT2y: jJ9a5: goto her32; eymr4: if (!($user_id && $this->in_group($this->config->item("\x61\x64\x6d\151\x6e\x5f\147\162\157\x75\160", "\x69\157\156\137\141\165\x74\150"), $user_id))) { goto eoCW5; } goto lf6BJ; vfmzr: } protected function _get_hash_algo() { goto hd3Hx; hd3Hx: $algo = FALSE; goto W6Wls; VCIKO: lAX4m: goto CpFKo; C3TPG: return $algo; goto votzV; W6Wls: switch ($this->hash_method) { case "\x62\143\x72\x79\160\x74": $algo = PASSWORD_BCRYPT; goto Om9Hp; case "\141\162\x67\x6f\156\62": $algo = PASSWORD_ARGON2I; goto Om9Hp; default: } goto VCIKO; CpFKo: Om9Hp: goto C3TPG; votzV: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto ouTEa; T0Glb: $validator_hashed = $this->hash_password($validator); goto d0ila; q51Se: $validator = $this->_random_token($validator_size); goto T0Glb; ouTEa: $selector = $this->_random_token($selector_size); goto q51Se; d0ila: $user_code = "{$selector}\56{$validator}"; goto Ev8T9; Ev8T9: return (object) ["\163\x65\x6c\x65\x63\164\x6f\162" => $selector, "\166\141\154\x69\x64\141\x74\157\x72\137\x68\141\163\150\x65\144" => $validator_hashed, "\165\x73\145\162\137\143\157\x64\145" => $user_code]; goto MwblL; MwblL: } protected function _retrieve_selector_validator_couple($user_code) { goto V_J39; Uzgqp: Cyckm: goto TQsnP; TQsnP: YUms1: goto eItD_; mWRoF: if (!(count($tokens) === 2)) { goto Cyckm; } goto cIVhb; RFome: $tokens = explode("\x2e", $user_code); goto mWRoF; eItD_: return FALSE; goto MxVa7; cIVhb: return (object) ["\x73\145\x6c\145\143\x74\x6f\x72" => $tokens[0], "\x76\141\154\x69\x64\x61\x74\x6f\162" => $tokens[1]]; goto Uzgqp; V_J39: if (!$user_code) { goto YUms1; } goto RFome; MxVa7: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto vR300; S0txd: $this->trigger_events(["\160\157\x73\x74\x5f\163\x68\141\x31\x5f\x70\141\163\x73\167\157\162\144\137\155\151\x67\x72\141\x74\151\157\156", "\160\157\163\164\x5f\x73\150\x61\61\x5f\160\141\x73\x73\167\157\x72\x64\137\155\x69\147\x72\141\164\x69\x6f\156\x5f\x75\156\x73\165\x63\143\x65\x73\x73\x66\165\x6c"]); goto hT1U2; t_bj5: if (!($query->num_rows() !== 1)) { goto b9L9t; } goto InPD9; Daxzd: $this->trigger_events(["\160\157\163\164\x5f\x73\150\141\61\x5f\160\x61\163\163\x77\x6f\162\x64\137\155\x69\x67\x72\141\x74\x69\157\x6e", "\160\157\x73\x74\x5f\163\150\x61\61\137\x70\x61\x73\x73\x77\157\162\144\137\155\151\147\x72\141\164\x69\x6f\156\137\165\156\x73\x75\143\x63\145\x73\163\146\165\154"]); goto yS3xC; c59rn: $result = $this->_set_password_db($identity, $password); goto PJ2XN; F1QhB: $this->trigger_events(["\x70\157\163\x74\x5f\x73\x68\x61\x31\137\x70\x61\x73\163\167\x6f\162\x64\x5f\x6d\x69\x67\x72\141\164\151\x6f\156", "\x70\157\x73\164\137\163\150\141\x31\137\x70\x61\x73\x73\x77\x6f\x72\144\137\155\x69\x67\162\141\164\x69\x6f\156\137\x73\x75\x63\143\x65\163\163\x66\x75\x6c"]); goto aP_Bb; Y7uSd: return FALSE; goto PDp_A; dKacu: $this->trigger_events(["\x70\x6f\163\x74\x5f\163\x68\141\x31\x5f\160\x61\163\163\167\x6f\162\144\x5f\155\151\147\162\141\x74\x69\157\156", "\160\x6f\x73\x74\137\x73\150\x61\61\137\x70\141\x73\x73\167\157\x72\x64\137\155\151\x67\162\141\164\x69\157\x6e\137\x75\156\x73\165\143\x63\x65\x73\163\x66\165\x6c"]); goto cfijf; vR300: $this->trigger_events("\160\x72\145\x5f\163\x68\x61\61\x5f\x70\x61\163\163\x77\157\162\x64\137\155\x69\147\x72\141\164\x69\x6f\156"); goto ZTRd6; vvGjH: Xmsrs: goto F1QhB; PJ2XN: if ($result) { goto Xmsrs; } goto Daxzd; aP_Bb: w4M1a: goto isGiJ; fCG13: $salt = substr($hashed_password_db, 0, $salt_length); goto s6Pj2; mnKen: $hashed_password = sha1($password . $salt_db->salt); goto l_1r8; s6Pj2: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto LyUlj; Scm9p: if ($hashed_password === $hashed_password_db) { goto PzAvc; } goto dKacu; lMVZ2: if ($salt_length) { goto P3Zon; } goto S0txd; isGiJ: return $result; goto B61jB; XWTnF: $salt_db = $query->row(); goto t_bj5; hT1U2: return FALSE; goto gG2yr; NNkdN: $salt_length = $this->config->item("\x73\x61\x6c\164\x5f\154\145\x6e\147\x74\150", "\x69\x6f\156\x5f\141\x75\164\150"); goto lMVZ2; AVJtv: goto ndU2J; goto No6E3; B61jB: ndU2J: goto GfDgk; yS3xC: goto w4M1a; goto vvGjH; InPD9: $this->trigger_events(["\x70\x6f\163\x74\x5f\x73\150\x61\61\137\160\x61\163\163\x77\157\x72\x64\137\155\151\147\162\141\x74\x69\157\x6e", "\x70\x6f\x73\164\x5f\163\150\141\x31\x5f\160\x61\163\163\167\x6f\162\144\x5f\155\x69\147\x72\x61\164\151\157\x6e\137\165\156\163\165\x63\x63\145\x73\163\x66\x75\x6c"]); goto Y7uSd; cfijf: return FALSE; goto AVJtv; ZTRd6: if ($this->config->item("\x73\164\x6f\162\x65\137\163\x61\154\164", "\151\157\x6e\x5f\141\165\x74\150")) { goto G0qCS; } goto NNkdN; No6E3: PzAvc: goto c59rn; l_1r8: bSzvs: goto Scm9p; PDp_A: b9L9t: goto mnKen; LyUlj: goto bSzvs; goto Ag4EF; VJ09H: $query = $this->db->select("\x73\x61\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\145\162\x73"]); goto XWTnF; gG2yr: P3Zon: goto fCG13; Ag4EF: G0qCS: goto VJ09H; GfDgk: } }
