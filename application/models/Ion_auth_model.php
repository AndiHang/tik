<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\105\x50\x41\124\x48") or exit("\x4e\x6f\x20\x64\151\162\x65\x63\x74\40\163\143\162\x69\160\x74\40\x61\143\143\145\163\163\x20\141\x6c\154\x6f\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto XVnnD; tA0q1: goto dI0m8; goto hL4va; WE0f6: $this->identity_column = $this->config->item("\151\144\x65\156\164\151\164\x79", "\151\x6f\x6e\137\x61\x75\164\150"); goto LLa9J; mAJVG: $this->message_start_delimiter = $this->error_start_delimiter; goto bCqxQ; UpIn2: $this->lang->load("\151\157\156\137\x61\165\164\150"); goto XyMpx; ydpd1: $this->messages = []; goto cnG9I; Pqg1V: $this->db = $CI->db; goto g0TwO; PQT49: dI0m8: goto lJo6W; lzd_H: $this->error_start_delimiter = $this->config->item("\145\162\x72\x6f\162\x5f\x73\164\x61\x72\x74\137\144\145\x6c\x69\x6d\151\x74\x65\x72", "\x69\x6f\x6e\x5f\141\165\164\x68"); goto hEFYn; Tt4M1: $this->tables = $this->config->item("\164\141\142\154\145\x73", "\151\x6f\156\137\141\165\164\x68"); goto WE0f6; j2ApS: $error_prefix = $form_validation_class->getProperty("\137\x65\162\162\157\x72\137\x70\162\x65\146\151\170"); goto HZnIl; lcFmQ: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto mAJVG; hL4va: FSNis: goto b2U2q; rMtr9: WWTwS: goto j5hjj; LLa9J: $this->join = $this->config->item("\x6a\157\151\156", "\151\157\x6e\x5f\141\165\164\150"); goto KG7K6; cnG9I: $this->errors = []; goto jNUH2; lJo6W: $this->_ion_hooks = new stdClass(); goto g_eHt; F1iMw: $this->message_start_delimiter = $this->config->item("\x6d\145\x73\163\x61\x67\x65\x5f\x73\164\141\162\164\137\x64\145\x6c\x69\155\x69\x74\x65\162", "\151\157\156\137\x61\x75\x74\150"); goto T_ztH; T_ztH: $this->message_end_delimiter = $this->config->item("\155\145\163\x73\x61\147\145\x5f\x65\x6e\x64\x5f\x64\x65\154\151\155\151\x74\145\162", "\151\157\156\137\141\165\x74\150"); goto lzd_H; UrHIN: if (empty($group_name)) { goto WWTwS; } goto umUo6; j5hjj: $CI =& get_instance(); goto Pqg1V; Noq1N: $error_suffix->setAccessible(TRUE); goto Vy1Fe; jNUH2: $delimiters_source = $this->config->item("\144\145\154\x69\x6d\x69\x74\145\162\163\x5f\x73\x6f\x75\162\143\145", "\x69\x6f\156\137\x61\165\x74\x68"); goto Y8i0_; hEFYn: $this->error_end_delimiter = $this->config->item("\x65\x72\x72\x6f\162\x5f\x65\x6e\144\137\x64\x65\154\x69\x6d\x69\x74\145\162", "\151\x6f\156\137\141\x75\x74\150"); goto tA0q1; KG7K6: $this->hash_method = $this->config->item("\150\x61\x73\x68\x5f\x6d\x65\x74\x68\157\x64", "\x69\157\156\137\x61\x75\164\x68"); goto ydpd1; Y8i0_: if ($delimiters_source === "\x66\x6f\x72\x6d\x5f\166\141\x6c\151\x64\x61\164\151\157\x6e") { goto FSNis; } goto F1iMw; umUo6: $this->db = $this->load->database($group_name, TRUE, TRUE); goto MlvUs; WZ0Rm: $this->message_end_delimiter = $this->error_end_delimiter; goto PQT49; Vy1Fe: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto WZ0Rm; b2U2q: $this->load->library("\146\x6f\162\x6d\x5f\166\x61\154\151\x64\x61\164\151\x6f\x6e"); goto DY9Nv; MlvUs: goto ajO71; goto rMtr9; g_eHt: $this->trigger_events("\x6d\157\144\x65\x6c\x5f\x63\x6f\156\x73\x74\162\165\x63\164\157\162"); goto XCS7U; HZnIl: $error_prefix->setAccessible(TRUE); goto lcFmQ; OX09t: $this->load->helper("\144\x61\164\x65"); goto UpIn2; XVnnD: $this->config->load("\x69\157\x6e\137\141\x75\x74\x68", TRUE); goto w1YH0; XyMpx: $group_name = $this->config->item("\x64\x61\164\x61\142\x61\163\x65\137\147\162\157\165\x70\137\156\x61\155\x65", "\x69\157\x6e\137\x61\x75\164\x68"); goto UrHIN; g0TwO: ajO71: goto Tt4M1; bCqxQ: $error_suffix = $form_validation_class->getProperty("\137\145\162\x72\x6f\162\137\x73\x75\146\146\x69\170"); goto Noq1N; w1YH0: $this->load->helper("\143\x6f\x6f\153\151\x65"); goto OX09t; DY9Nv: $form_validation_class = new ReflectionClass("\x43\111\137\x46\157\162\155\x5f\166\x61\x6c\x69\x64\141\x74\x69\157\156"); goto j2ApS; XCS7U: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto gOxcj; NHJmu: $algo = $this->_get_hash_algo(); goto ADFnY; c0ySv: return password_hash($password, $algo, $params); goto oOPhx; ADFnY: $params = $this->_get_hash_parameters($identity); goto cPxC5; gOxcj: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto dNOOY; } goto yrDbA; yrDbA: return FALSE; goto J6b0x; zcDOn: return FALSE; goto rv13N; J6b0x: dNOOY: goto NHJmu; oOPhx: JJTsj: goto zcDOn; cPxC5: if (!($algo !== FALSE && $params !== FALSE)) { goto JJTsj; } goto c0ySv; rv13N: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto h2ksN; KVPkB: HFOzF: goto oxfQr; Wz1rg: Bfm96: goto i5it1; PyB6S: return FALSE; goto Wz1rg; y6dIX: goto GjZE2; goto KVPkB; i5it1: if (strpos($hash_password_db, "\x24") === 0) { goto HFOzF; } goto yiAvI; oxfQr: return password_verify($password, $hash_password_db); goto QsXyS; yiAvI: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto y6dIX; QsXyS: GjZE2: goto Ns6Mb; h2ksN: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto Bfm96; } goto PyB6S; Ns6Mb: } public function rehash_password_if_needed($hash, $identity, $password) { goto Y3yuP; ghYmu: KBCRm: goto km2Ch; jq6Vp: $params = $this->_get_hash_parameters($identity); goto ZTC53; ZTC53: if (!($algo !== FALSE && $params !== FALSE)) { goto f4AWq; } goto r1Y4h; ZujxG: UzxPF: goto tPjEf; Y3yuP: $algo = $this->_get_hash_algo(); goto jq6Vp; eta4x: $this->trigger_events(["\162\x65\150\x61\163\150\137\160\141\x73\x73\x77\x6f\x72\144", "\x72\x65\x68\141\163\x68\x5f\x70\141\163\x73\x77\x6f\x72\x64\137\165\156\163\x75\143\x63\145\163\x73\146\x75\154"]); goto bncZg; qW7LD: if ($this->_set_password_db($identity, $password)) { goto UzxPF; } goto eta4x; km2Ch: TXc1D: goto A80aY; bncZg: goto KBCRm; goto ZujxG; A80aY: f4AWq: goto eMhEA; r1Y4h: if (!password_needs_rehash($hash, $algo, $params)) { goto TXc1D; } goto qW7LD; tPjEf: $this->trigger_events(["\162\145\150\x61\163\x68\x5f\x70\x61\x73\x73\167\157\x72\x64", "\x72\x65\150\141\x73\x68\137\x70\141\163\x73\167\x6f\x72\x64\x5f\163\x75\x63\x63\145\x73\163\x66\x75\x6c"]); goto ghYmu; eMhEA: } public function get_user_by_activation_code($user_code) { goto ImN4A; bYTzn: if (!$this->verify_password($token->validator, $user->activation_code)) { goto MF1yi; } goto DgVA4; GYkZk: return FALSE; goto hN0r9; ImN4A: $token = $this->_retrieve_selector_validator_couple($user_code); goto CD4_4; VKB0h: if (!$user) { goto io89J; } goto bYTzn; QrW04: MF1yi: goto WgeFA; DgVA4: return $user; goto QrW04; CD4_4: $user = $this->where("\141\x63\164\x69\166\x61\x74\151\157\x6e\x5f\163\145\154\x65\143\164\x6f\162", $token->selector)->users()->row(); goto VKB0h; WgeFA: io89J: goto GYkZk; hN0r9: } public function activate($id, $code = FALSE) { goto b0Yus; s1dbn: $this->trigger_events(["\x70\x6f\x73\164\137\x61\143\x74\x69\166\x61\164\x65", "\160\x6f\x73\x74\x5f\x61\143\x74\x69\166\x61\x74\x65\137\x75\156\x73\165\143\x63\145\163\163\146\165\154"]); goto x1Mgz; b0Yus: $this->trigger_events("\160\x72\x65\x5f\141\143\164\x69\166\141\164\145"); goto Bkj0v; sCkYj: $this->db->update($this->tables["\x75\163\145\x72\163"], $data, ["\x69\144" => $id]); goto Xcx3F; ghuVO: return TRUE; goto aCY2N; e7Ptw: $this->trigger_events("\x65\x78\164\162\x61\x5f\167\150\x65\162\x65"); goto sCkYj; dlKeL: $this->trigger_events(["\x70\157\x73\x74\x5f\141\x63\x74\x69\x76\141\164\x65", "\x70\157\x73\x74\137\x61\143\x74\x69\166\141\164\x65\137\x73\x75\x63\x63\x65\163\163\x66\x75\154"]); goto mrCoJ; x1Mgz: $this->set_error("\141\x63\164\151\x76\141\x74\145\x5f\165\156\x73\x75\143\x63\145\163\x73\x66\165\x6c"); goto kvYJJ; WQ6m7: caPmp: goto s1dbn; aCY2N: jLxxP: goto WQ6m7; Bkj0v: if (!($code !== FALSE)) { goto ToEx8; } goto k_e9A; k_e9A: $user = $this->get_user_by_activation_code($code); goto YAzoy; kvYJJ: return FALSE; goto anry9; SSx49: if (!($code === FALSE || $user && $user->id === $id)) { goto caPmp; } goto fhxy5; fhxy5: $data = ["\x61\143\164\151\x76\x61\164\x69\157\156\137\x73\145\x6c\145\143\x74\x6f\162" => NULL, "\141\x63\x74\151\166\x61\164\x69\x6f\156\x5f\x63\157\144\145" => NULL, "\x61\143\x74\151\166\x65" => 1]; goto e7Ptw; Xcx3F: if (!($this->db->affected_rows() === 1)) { goto jLxxP; } goto dlKeL; YAzoy: ToEx8: goto SSx49; mrCoJ: $this->set_message("\x61\x63\164\151\x76\x61\164\145\137\x73\x75\143\143\x65\163\163\146\165\154"); goto ghuVO; anry9: } public function deactivate($id = NULL) { goto j09iL; WwXyw: $this->activation_code = $token->user_code; goto Mpsjn; Qo5nA: goto PIFXS; goto xt6W8; s0hU9: goto xQvW0; goto YNbWr; svJH_: xQvW0: goto Xyw50; Dq4P6: $this->set_message("\144\x65\141\143\164\151\166\x61\x74\x65\137\x73\x75\143\x63\145\163\x73\x66\165\154"); goto svJH_; YNbWr: bgHUz: goto Dq4P6; s9wMU: PIFXS: goto w_2Lf; Bp04T: J3oQ1: goto Qo5nA; Xyw50: return $return; goto Zyjz_; rs0S3: if ($return) { goto bgHUz; } goto x5DLs; Mpsjn: $data = ["\x61\x63\164\151\166\x61\x74\151\157\156\x5f\x73\145\x6c\x65\143\x74\x6f\x72" => $token->selector, "\141\143\164\x69\x76\141\x74\151\x6f\156\137\x63\157\144\x65" => $token->validator_hashed, "\x61\x63\164\151\x76\145" => 0]; goto y09XC; glMtA: if (!isset($id)) { goto VfB_Y; } goto I24qx; j09iL: $this->trigger_events("\144\x65\141\143\x74\x69\x76\141\x74\x65"); goto glMtA; xt6W8: VfB_Y: goto YAi7d; YAi7d: $this->set_error("\144\x65\141\x63\x74\x69\166\141\164\x65\x5f\x75\156\x73\165\x63\x63\x65\x73\163\x66\x75\154"); goto J1f_j; J1f_j: return FALSE; goto s9wMU; w_2Lf: $token = $this->_generate_selector_validator_couple(20, 40); goto WwXyw; VHYNE: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, ["\x69\144" => $id]); goto K3Bge; y09XC: $this->trigger_events("\145\x78\164\162\141\137\167\x68\145\x72\x65"); goto VHYNE; jeMT0: $this->set_error("\x64\145\x61\143\164\151\x76\x61\x74\x65\137\143\165\x72\x72\145\x6e\x74\x5f\x75\x73\145\x72\x5f\165\x6e\x73\x75\x63\143\145\163\163\x66\x75\x6c"); goto lB2XM; I24qx: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto J3oQ1; } goto jeMT0; x5DLs: $this->set_error("\x64\x65\x61\x63\x74\x69\166\x61\x74\x65\x5f\165\x6e\163\165\143\x63\x65\163\163\146\165\x6c"); goto s0hU9; K3Bge: $return = $this->db->affected_rows() == 1; goto rs0S3; lB2XM: return FALSE; goto Bp04T; Zyjz_: } public function clear_forgotten_password_code($identity) { goto EoUIP; lfE0v: tovsq: goto RVnzR; knF1s: return TRUE; goto vXTvw; UCsqV: $this->db->update($this->tables["\165\163\145\x72\163"], $data, [$this->identity_column => $identity]); goto knF1s; RVnzR: $data = ["\x66\157\x72\147\x6f\164\x74\145\156\137\x70\141\x73\x73\x77\157\x72\144\137\163\x65\154\x65\143\164\157\162" => NULL, "\146\x6f\162\147\157\x74\x74\145\156\x5f\160\141\x73\x73\167\x6f\x72\144\x5f\x63\157\x64\145" => NULL, "\146\157\162\147\157\164\164\x65\x6e\x5f\x70\x61\163\x73\x77\157\x72\x64\137\x74\x69\x6d\145" => NULL]; goto UCsqV; EoUIP: if (!empty($identity)) { goto tovsq; } goto XO3EH; XO3EH: return FALSE; goto lfE0v; vXTvw: } public function clear_remember_code($identity) { goto JrJB7; MkpOF: return TRUE; goto wTdg5; v5R1T: $this->db->update($this->tables["\165\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto MkpOF; JrJB7: if (!empty($identity)) { goto sBc5P; } goto hCkih; hCkih: return FALSE; goto XeZEO; ggRwx: $data = ["\162\145\155\145\155\x62\145\162\x5f\163\x65\154\x65\x63\x74\x6f\162" => NULL, "\x72\x65\155\x65\155\x62\145\162\137\143\x6f\x64\145" => NULL]; goto v5R1T; XeZEO: sBc5P: goto ggRwx; wTdg5: } public function reset_password($identity, $new) { goto DoSlt; HN_Ng: mxNwf: goto LprB8; U_8R9: fo6Cr: goto zTcvK; HAfVM: if ($this->identity_check($identity)) { goto fo6Cr; } goto HsVtc; DoSlt: $this->trigger_events("\160\162\145\x5f\143\150\x61\156\x67\145\x5f\160\x61\163\x73\167\x6f\162\x64"); goto HAfVM; LprB8: $this->trigger_events(["\x70\x6f\163\164\x5f\x63\150\x61\156\147\x65\137\160\x61\x73\x73\x77\157\x72\x64", "\x70\x6f\163\164\x5f\x63\x68\x61\x6e\x67\x65\x5f\x70\x61\163\163\167\x6f\162\x64\x5f\x73\165\x63\143\x65\163\x73\146\165\154"]); goto G5XqP; qoxPP: return FALSE; goto U_8R9; xaBDK: $this->trigger_events(["\160\x6f\163\164\137\143\x68\141\156\147\x65\x5f\x70\x61\163\x73\167\x6f\162\x64", "\160\x6f\163\164\x5f\x63\x68\x61\156\147\x65\137\160\141\x73\163\167\x6f\x72\x64\x5f\165\156\x73\x75\143\x63\145\x73\163\146\x75\154"]); goto FM21z; VDFFT: return $return; goto ogkwY; G5XqP: $this->set_message("\x70\x61\163\x73\x77\157\x72\x64\x5f\143\150\x61\156\x67\145\137\x73\x75\x63\143\145\x73\163\x66\165\x6c"); goto wkAgA; wkAgA: swROs: goto VDFFT; zTcvK: $return = $this->_set_password_db($identity, $new); goto cU8iS; HsVtc: $this->trigger_events(["\160\157\x73\164\x5f\143\x68\141\x6e\x67\145\137\160\x61\163\x73\167\157\162\144", "\160\157\x73\x74\137\143\x68\141\156\147\145\137\160\x61\163\x73\x77\x6f\162\x64\137\165\x6e\x73\x75\x63\x63\x65\163\163\x66\165\x6c"]); goto qoxPP; FM21z: $this->set_error("\x70\x61\x73\x73\x77\x6f\162\x64\137\x63\x68\141\156\147\145\x5f\165\156\x73\x75\143\143\145\163\x73\146\165\154"); goto upSzp; cU8iS: if ($return) { goto mxNwf; } goto xaBDK; upSzp: goto swROs; goto HN_Ng; ogkwY: } public function change_password($identity, $old, $new) { goto N_fZQ; hWB7V: $this->set_message("\160\x61\x73\x73\167\x6f\162\x64\137\143\x68\141\156\x67\145\x5f\163\x75\143\143\x65\x73\x73\x66\x75\154"); goto zyp5V; upxua: $this->trigger_events(["\x70\157\163\x74\137\x63\150\141\x6e\x67\145\x5f\160\141\163\x73\x77\x6f\x72\x64", "\x70\157\163\x74\x5f\143\150\x61\156\x67\145\137\160\141\163\x73\x77\x6f\162\x64\x5f\x75\156\163\x75\143\x63\x65\163\163\146\165\154"]); goto yuVI3; yAXRr: $result = $this->_set_password_db($identity, $new); goto CyelM; QSTyx: if (!($query->num_rows() !== 1)) { goto w5nHW; } goto VBUYZ; N_fZQ: $this->trigger_events("\160\162\x65\137\x63\x68\141\x6e\x67\145\x5f\160\141\x73\x73\167\157\x72\144"); goto XCwAp; Dl7wT: if (!$this->verify_password($old, $user->password, $identity)) { goto viVKr; } goto yAXRr; b39NG: goto dTUMy; goto C2_GZ; zyp5V: dTUMy: goto lIED1; D9i7C: $user = $query->row(); goto Dl7wT; yuVI3: $this->set_error("\x70\141\x73\163\x77\x6f\162\x64\x5f\143\x68\x61\156\147\x65\137\165\156\x73\165\143\143\x65\163\163\x66\165\154"); goto b39NG; RrdWF: $this->set_error("\160\x61\x73\x73\167\157\162\144\x5f\x63\150\141\156\147\x65\x5f\165\156\x73\165\143\x63\145\163\163\146\165\154"); goto LF7aA; ABWG2: w5nHW: goto D9i7C; XCwAp: $this->trigger_events("\x65\x78\x74\x72\141\137\167\150\145\x72\145"); goto u0Co9; CyelM: if ($result) { goto f0R96; } goto upxua; cjYih: return FALSE; goto xhTeW; VBUYZ: $this->trigger_events(["\x70\x6f\x73\x74\137\143\150\x61\x6e\x67\x65\x5f\x70\141\163\x73\x77\x6f\x72\x64", "\x70\157\x73\164\137\x63\x68\x61\156\147\145\137\160\141\163\x73\x77\x6f\162\x64\x5f\x75\x6e\163\x75\x63\143\145\163\163\x66\x75\x6c"]); goto RrdWF; oA2_l: $this->trigger_events(["\160\x6f\163\164\137\x63\x68\x61\156\x67\x65\137\x70\141\163\x73\x77\157\x72\144", "\x70\157\163\164\137\143\150\141\156\x67\x65\137\x70\141\163\163\x77\157\162\x64\x5f\163\x75\x63\143\x65\x73\x73\x66\165\x6c"]); goto hWB7V; C2_GZ: f0R96: goto oA2_l; lIED1: return $result; goto fQX0V; fQX0V: viVKr: goto aG2Jy; u0Co9: $query = $this->db->select("\151\x64\54\x20\x70\141\x73\163\167\157\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\x64\145\x73\143")->get($this->tables["\165\163\x65\162\163"]); goto QSTyx; aG2Jy: $this->set_error("\160\x61\x73\x73\167\157\x72\x64\137\143\x68\141\x6e\147\145\x5f\x75\x6e\x73\x75\x63\143\x65\x73\163\146\x75\x6c"); goto cjYih; LF7aA: return FALSE; goto ABWG2; xhTeW: } public function username_check($username = '') { goto Pw5bG; tfdNe: return $this->db->where("\165\x73\x65\162\x6e\x61\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\165\163\x65\162\163"]) > 0; goto XGSbF; mHUor: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\x68\x65\162\x65"); goto tfdNe; cKVIN: wr6dI: goto mHUor; SBLzn: return FALSE; goto cKVIN; rSN6A: if (!empty($username)) { goto wr6dI; } goto SBLzn; Pw5bG: $this->trigger_events("\x75\x73\145\162\156\x61\x6d\145\x5f\x63\x68\x65\x63\153"); goto rSN6A; XGSbF: } public function email_check($email = '') { goto ZRcor; SIE8d: return $this->db->where("\145\155\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\145\x72\163"]) > 0; goto M0JKy; ZRcor: $this->trigger_events("\x65\155\x61\x69\x6c\137\x63\150\145\x63\153"); goto U9jHJ; U9jHJ: if (!empty($email)) { goto kYeeb; } goto LzMde; LzMde: return FALSE; goto nq2E8; nq2E8: kYeeb: goto plTb0; plTb0: $this->trigger_events("\x65\x78\164\162\141\x5f\x77\150\x65\x72\x65"); goto SIE8d; M0JKy: } public function identity_check($identity = '') { goto QoT9d; mQOIr: return FALSE; goto H9HBi; KMGbt: if (!empty($identity)) { goto Q6qze; } goto mQOIr; QoT9d: $this->trigger_events("\x69\144\145\x6e\x74\151\164\171\137\143\150\x65\143\153"); goto KMGbt; H9HBi: Q6qze: goto Wk_qB; Wk_qB: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\145\162\163"]) > 0; goto W_Zbk; W_Zbk: } public function get_user_id_from_identity($identity = '') { goto LyaRC; LyaRC: if (!empty($identity)) { goto ilZIv; } goto kHh8F; fCYot: return $user->id; goto jS8bD; S7IUN: if (!($query->num_rows() !== 1)) { goto jgMOb; } goto qvBo2; Q8Y92: ilZIv: goto BcgJz; hpW1J: $user = $query->row(); goto fCYot; BcgJz: $query = $this->db->select("\x69\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\163"]); goto S7IUN; qvBo2: return FALSE; goto CR0eW; kHh8F: return FALSE; goto Q8Y92; CR0eW: jgMOb: goto hpW1J; jS8bD: } public function forgotten_password($identity) { goto J32Jk; mG9BB: if ($this->db->affected_rows() === 1) { goto wLi7d; } goto cPs4E; UBcfq: $this->trigger_events("\x65\170\164\x72\x61\x5f\167\150\x65\162\x65"); goto QLpw4; C3tmj: WQRfL: goto eSWl9; WvZey: $this->trigger_events(["\x70\157\x73\164\137\146\157\162\147\x6f\164\164\145\x6e\x5f\160\141\163\163\167\157\x72\144", "\x70\157\163\x74\x5f\x66\x6f\x72\147\x6f\x74\164\x65\x6e\x5f\160\x61\x73\163\167\x6f\162\144\x5f\x75\x6e\x73\165\143\x63\x65\163\163\146\165\x6c"]); goto m5q32; cPs4E: $this->trigger_events(["\x70\x6f\163\164\137\146\x6f\162\147\157\x74\164\x65\156\x5f\160\141\163\x73\x77\x6f\162\x64", "\160\x6f\163\164\x5f\x66\x6f\162\147\x6f\164\x74\x65\x6e\x5f\160\x61\163\163\167\x6f\162\x64\137\x75\156\x73\x75\x63\x63\145\163\163\146\x75\x6c"]); goto c0jWA; c0jWA: return FALSE; goto N6WOT; J32Jk: if (!empty($identity)) { goto WQRfL; } goto WvZey; q1rxq: $this->trigger_events(["\x70\157\x73\164\x5f\146\x6f\x72\147\157\x74\164\x65\x6e\x5f\x70\141\163\x73\x77\x6f\x72\x64", "\160\x6f\163\164\137\146\x6f\162\147\157\x74\164\145\x6e\137\160\x61\x73\x73\x77\157\x72\x64\x5f\163\x75\143\143\145\x73\163\146\x75\154"]); goto gbY1I; fN_Gb: $update = ["\146\157\162\x67\157\x74\x74\145\x6e\137\160\141\163\163\167\157\x72\144\137\163\x65\x6c\x65\143\x74\157\x72" => $token->selector, "\146\157\x72\x67\157\164\164\145\156\137\x70\141\163\163\167\x6f\x72\x64\x5f\x63\157\144\x65" => $token->validator_hashed, "\x66\x6f\x72\x67\x6f\x74\x74\x65\x6e\137\160\x61\x73\x73\x77\x6f\x72\144\137\x74\x69\x6d\x65" => time()]; goto UBcfq; qwozy: wLi7d: goto q1rxq; QLpw4: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $update, [$this->identity_column => $identity]); goto mG9BB; gbY1I: return $token->user_code; goto NwlYG; m5q32: return FALSE; goto C3tmj; N6WOT: goto eFc64; goto qwozy; NwlYG: eFc64: goto Tsw9P; eSWl9: $token = $this->_generate_selector_validator_couple(20, 80); goto fN_Gb; Tsw9P: } public function get_user_by_forgotten_password_code($user_code) { goto ZU0Ev; p9g1q: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto UnQmO; } goto wiqHj; QvAbK: $user = $this->where("\x66\157\162\147\x6f\164\164\145\156\137\x70\141\163\x73\x77\x6f\162\x64\x5f\163\x65\x6c\145\143\164\157\162", $token->selector)->users()->row(); goto ggtbb; wiqHj: return $user; goto MROYC; ggtbb: if (!$user) { goto w2M0H; } goto p9g1q; ZU0Ev: $token = $this->_retrieve_selector_validator_couple($user_code); goto QvAbK; MROYC: UnQmO: goto W3mIo; W3mIo: w2M0H: goto xt4Mu; xt4Mu: return FALSE; goto EEljO; EEljO: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto WB5Tl; n9Bri: $this->db->insert($this->tables["\165\163\x65\162\x73"], $user_data); goto nK3rz; rNf3s: $user_data = array_merge($this->_filter_data($this->tables["\165\163\x65\x72\163"], $additional_data), $data); goto S782c; qT0Pk: $password = $this->hash_password($password); goto Gju0L; WB5Tl: $this->trigger_events("\x70\162\x65\137\162\145\x67\x69\163\x74\145\162"); goto n3EQJ; LcJkb: return FALSE; goto W1Xw7; QhiAk: goto ab07e; goto vXjX1; X936v: return isset($id) ? $id : FALSE; goto B8Krx; w4F8e: return FALSE; goto tD8fM; sRcmY: foreach ($groups as $group) { $this->add_to_group($group, $id); KpPsI: } goto dHrMN; dHrMN: R23sr: goto XoLAr; a5aRs: if (!(!isset($query->id) && empty($groups))) { goto PG6nX; } goto gf1VA; gf1VA: $this->set_error("\141\143\x63\157\165\x6e\x74\137\x63\x72\x65\x61\164\x69\157\156\x5f\x69\x6e\166\141\x6c\151\x64\x5f\144\145\146\141\165\x6c\x74\137\147\162\157\165\160"); goto c16wn; gogjB: $default_group = $query; goto z5doC; mMhRY: WbIex: goto q0CEn; tD8fM: ab07e: goto sjzzn; q0CEn: $data = [$this->identity_column => $identity, "\x75\163\145\x72\x6e\x61\155\145" => $identity, "\160\x61\163\x73\167\157\162\144" => $password, "\145\x6d\x61\x69\x6c" => $email, "\151\x70\x5f\141\x64\x64\162\145\163\x73" => $ip_address, "\143\162\145\x61\164\x65\144\x5f\x6f\x6e" => time(), "\x61\143\x74\x69\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto rNf3s; z5doC: $ip_address = $this->input->ip_address(); goto qT0Pk; Mksmc: $this->set_error("\141\x63\x63\157\x75\x6e\x74\x5f\143\162\145\x61\164\x69\157\156\137\x6d\x69\163\x73\x69\x6e\147\x5f\x64\x65\x66\x61\x75\x6c\164\x5f\147\162\x6f\x75\x70"); goto LcJkb; ds6EQ: $groups[] = $default_group->id; goto jcl2H; n3EQJ: $manual_activation = $this->config->item("\x6d\141\x6e\165\141\154\x5f\141\143\x74\x69\166\x61\x74\x69\x6f\156", "\151\157\156\x5f\x61\x75\x74\150"); goto utZLC; utZLC: if ($this->identity_check($identity)) { goto dBU4r; } goto FCx_J; FCx_J: if (!(!$this->config->item("\x64\x65\x66\141\x75\x6c\164\137\147\x72\x6f\x75\160", "\x69\x6f\156\137\141\165\x74\x68") && empty($groups))) { goto O7DD6; } goto Mksmc; UU5OF: PG6nX: goto gogjB; ePiC4: if (!(isset($default_group->id) && empty($groups))) { goto Oxz0M; } goto ds6EQ; pb24h: $this->set_error("\141\143\x63\x6f\165\156\x74\x5f\143\162\x65\x61\164\x69\157\156\137\x64\x75\x70\x6c\x69\x63\141\164\x65\x5f\151\144\x65\x6e\x74\151\164\x79"); goto w4F8e; S782c: $this->trigger_events("\x65\x78\x74\x72\x61\137\x73\145\x74"); goto n9Bri; YYeji: $this->set_error("\141\143\143\157\165\x6e\x74\x5f\143\162\x65\x61\164\151\x6f\156\x5f\165\156\x73\165\x63\143\145\x73\163\x66\x75\154"); goto veqp9; jcl2H: Oxz0M: goto sXl2o; sjzzn: $query = $this->db->get_where($this->tables["\147\x72\157\x75\160\x73"], ["\x6e\x61\x6d\145" => $this->config->item("\x64\x65\146\141\x75\154\x74\137\147\x72\157\x75\x70", "\151\x6f\156\137\141\x75\164\x68")], 1)->row(); goto a5aRs; vXjX1: dBU4r: goto pb24h; veqp9: return FALSE; goto mMhRY; c16wn: return FALSE; goto UU5OF; o5Y6d: $this->trigger_events("\160\x6f\x73\164\x5f\162\x65\x67\151\x73\164\145\x72"); goto X936v; sXl2o: if (empty($groups)) { goto pFvCU; } goto sRcmY; nK3rz: $id = $this->db->insert_id($this->tables["\x75\x73\145\162\163"] . "\137\x69\144\137\x73\x65\161"); goto ePiC4; W1Xw7: O7DD6: goto QhiAk; Gju0L: if (!($password === FALSE)) { goto WbIex; } goto YYeji; XoLAr: pFvCU: goto o5Y6d; B8Krx: } public function login($identity, $password, $remember = FALSE) { goto zFiNT; IUF0w: NRY9r: goto tpzcx; AEjWa: $this->set_session($user); goto UnOzm; uMHdf: mZWiG: goto pZ4ku; N5aoC: if ($remember) { goto mZWiG; } goto fxfcS; FP727: $this->set_error("\x6c\x6f\x67\151\x6e\x5f\165\156\x73\165\x63\x63\145\163\163\146\x75\x6c"); goto RHhkX; Id0EB: $this->session->sess_regenerate(FALSE); goto aWvf0; Iq6y5: if (!($user->active == 0)) { goto LtBff; } goto ddTKz; y8jOQ: D6SXx: goto cxqA4; PPW2C: $this->clear_login_attempts($identity); goto G2Ep5; s_D91: return TRUE; goto RFnxr; ZdhTG: goto yuNPG; goto uMHdf; RHhkX: return FALSE; goto IUF0w; Ys_Lb: $this->hash_password($password); goto Yu3bn; Xn6xC: $this->rehash_password_if_needed($user->password, $identity, $password); goto Id0EB; gNe7I: $this->set_error("\154\x6f\147\151\156\137\165\x6e\163\165\143\x63\x65\163\163\146\165\154"); goto nK6TM; CLCEt: if (!$this->verify_password($password, $user->password, $identity)) { goto KAZgI; } goto Iq6y5; mvtAi: if (!($query->num_rows() === 1)) { goto D6SXx; } goto Stq0K; yzy4O: return FALSE; goto iKmqK; cxqA4: $this->hash_password($password); goto Hdl46; pZ4ku: $this->remember_user($identity); goto XbSgA; MiUQ8: $query = $this->db->select($this->identity_column . "\54\x20\145\x6d\141\x69\154\x2c\40\151\x64\54\40\x70\141\163\x73\167\157\x72\x64\x2c\x20\x61\143\x74\x69\166\x65\x2c\40\154\x61\x73\164\x5f\154\x6f\x67\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\145\163\143")->get($this->tables["\x75\x73\x65\162\x73"]); goto Za191; SzWkr: if (!(empty($identity) || empty($password))) { goto NRY9r; } goto FP727; uFOeH: $this->set_error("\154\x6f\147\151\x6e\137\165\156\163\x75\x63\143\145\163\163\x66\165\154\137\156\x6f\x74\137\x61\143\x74\151\x76\145"); goto JNZLV; Stq0K: $user = $query->row(); goto CLCEt; Za191: if (!$this->is_max_login_attempts_exceeded($identity)) { goto PVSel; } goto Ys_Lb; aWvf0: $this->trigger_events(["\x70\x6f\x73\x74\137\x6c\x6f\147\x69\x6e", "\x70\x6f\163\164\137\154\157\147\x69\x6e\x5f\x73\x75\143\x63\x65\x73\x73\x66\x75\x6c"]); goto OqDMT; fxfcS: $this->clear_remember_code($identity); goto ZdhTG; Yu3bn: $this->trigger_events("\x70\157\163\164\137\x6c\x6f\x67\151\x6e\x5f\165\x6e\x73\x75\143\143\x65\163\163\x66\x75\154"); goto zrwBL; zFiNT: $this->trigger_events("\160\162\x65\x5f\154\157\147\151\x6e"); goto SzWkr; Hdl46: $this->increase_login_attempts($identity); goto QiaMd; JNZLV: return FALSE; goto fASBl; OqDMT: $this->set_message("\154\157\147\x69\156\137\x73\x75\143\143\145\163\x73\x66\x75\x6c"); goto s_D91; ddTKz: $this->trigger_events("\160\x6f\163\x74\137\154\157\x67\x69\x6e\x5f\165\156\x73\x75\143\x63\x65\x73\163\x66\165\x6c"); goto uFOeH; fASBl: LtBff: goto AEjWa; tpzcx: $this->trigger_events("\x65\170\x74\x72\x61\137\167\x68\x65\162\x65"); goto MiUQ8; QiaMd: $this->trigger_events("\160\x6f\163\164\137\x6c\157\147\x69\156\x5f\165\156\163\165\143\143\145\x73\163\146\x75\154"); goto gNe7I; iKmqK: PVSel: goto mvtAi; XbSgA: yuNPG: goto sRteS; G2Ep5: $this->clear_forgotten_password_code($identity); goto tUhzV; nK6TM: return FALSE; goto cYbbz; RFnxr: KAZgI: goto y8jOQ; UnOzm: $this->update_last_login($user->id); goto PPW2C; tUhzV: if (!$this->config->item("\x72\145\155\x65\x6d\x62\145\162\x5f\165\163\x65\162\x73", "\x69\157\156\137\x61\x75\x74\x68")) { goto WoNgL; } goto N5aoC; sRteS: WoNgL: goto Xn6xC; zrwBL: $this->set_error("\x6c\157\147\x69\156\x5f\x74\151\155\145\x6f\165\164"); goto yzy4O; cYbbz: } public function recheck_session() { goto B99j0; AESES: return (bool) $this->session->userdata("\x69\144\x65\x6e\164\151\x74\x79"); goto pNgsV; zdIgC: $identity = $this->config->item("\x69\144\145\x6e\x74\x69\164\171", "\x69\x6f\156\137\x61\165\x74\150"); goto wO2ez; syHLC: $this->session->set_userdata("\154\141\163\x74\x5f\x63\x68\x65\143\153", time()); goto oq258; QxI7N: if (!($last_login + $recheck < time())) { goto WT1Ss; } goto O05gP; JYPRA: $this->trigger_events("\154\x6f\147\x6f\165\x74"); goto zdIgC; tleNs: $last_login = $this->session->userdata("\x6c\x61\x73\x74\137\143\150\145\x63\153"); goto QxI7N; oq258: Asf4r: goto y53KN; O05gP: $query = $this->db->select("\151\144")->where([$this->identity_column => $this->session->userdata("\151\144\145\x6e\164\151\x74\171"), "\x61\x63\164\151\x76\145" => "\61"])->limit(1)->order_by("\x69\144", "\x64\x65\163\x63")->get($this->tables["\x75\163\x65\x72\x73"]); goto NpO26; B99j0: $recheck = NULL !== $this->config->item("\162\145\x63\x68\x65\x63\x6b\137\x74\x69\x6d\145\162", "\151\x6f\x6e\137\x61\165\164\150") ? $this->config->item("\x72\x65\x63\x68\x65\x63\x6b\137\x74\x69\x6d\x65\162", "\151\157\x6e\x5f\141\165\x74\x68") : 0; goto oqWLY; NpO26: if ($query->num_rows() === 1) { goto U8Ktz; } goto JYPRA; ptq91: U8Ktz: goto syHLC; oEcm1: HPRm8: goto AESES; wKOtb: return FALSE; goto h1yFn; oqWLY: if (!($recheck !== 0)) { goto HPRm8; } goto tleNs; y53KN: WT1Ss: goto oEcm1; h1yFn: goto Asf4r; goto ptq91; wO2ez: $this->session->unset_userdata([$identity, "\x69\144", "\165\163\x65\162\137\151\x64"]); goto wKOtb; pNgsV: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto upjMC; PfIA1: tcLdV: goto s68wD; upjMC: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\x6f\x67\151\156\x5f\x61\x74\x74\145\x6d\160\164\x73", "\151\x6f\156\x5f\141\x75\x74\x68")) { goto d1Jkl; } goto pyANO; pyANO: $max_attempts = $this->config->item("\155\x61\x78\x69\x6d\165\155\x5f\x6c\x6f\x67\151\x6e\x5f\x61\x74\164\145\x6d\x70\x74\163", "\x69\157\156\137\141\165\x74\150"); goto oqpez; oqpez: if (!($max_attempts > 0)) { goto tcLdV; } goto jjWMS; s68wD: d1Jkl: goto PPXJH; PPXJH: return FALSE; goto jRzGO; jjWMS: $attempts = $this->get_attempts_num($identity, $ip_address); goto Fk8s3; Fk8s3: return $attempts >= $max_attempts; goto PfIA1; jRzGO: } public function get_attempts_num($identity, $ip_address = NULL) { goto xo2pq; vVu04: FFvUC: goto oH75H; fmere: if (isset($ip_address)) { goto FFvUC; } goto Klkg7; U_9xJ: WW515: goto wAZt9; pNUqh: $this->db->where("\x74\151\x6d\x65\40\x3e", time() - $this->config->item("\154\157\x63\x6b\x6f\165\164\137\x74\151\155\145", "\151\x6f\x6e\137\x61\x75\164\150"), FALSE); goto hcl11; aAGT_: n9UxJ: goto pNUqh; wAZt9: return 0; goto T7z4G; mbxx7: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\157\147\151\156\x5f\151\160\x5f\141\x64\144\x72\x65\163\163", "\x69\157\x6e\137\x61\165\x74\150")) { goto n9UxJ; } goto fmere; xo2pq: if (!$this->config->item("\x74\x72\141\x63\153\137\x6c\157\x67\x69\x6e\137\x61\164\164\145\x6d\160\x74\x73", "\x69\157\x6e\x5f\x61\165\164\150")) { goto WW515; } goto RlGAH; RlGAH: $this->db->select("\x31", FALSE); goto rL5pv; OnRUy: return $qres->num_rows(); goto U_9xJ; Klkg7: $ip_address = $this->input->ip_address(); goto vVu04; oH75H: $this->db->where("\151\160\137\x61\144\x64\x72\x65\x73\x73", $ip_address); goto aAGT_; rL5pv: $this->db->where("\154\x6f\x67\151\x6e", $identity); goto mbxx7; hcl11: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\156\x5f\141\x74\x74\145\x6d\x70\164\163"]); goto OnRUy; T7z4G: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto aYY8F; UW75P: if (!($qres->num_rows() > 0)) { goto hrvtZ; } goto FMbeh; aYY8F: if (!$this->config->item("\164\162\x61\x63\153\137\154\x6f\x67\151\156\137\x61\x74\164\145\155\160\x74\163", "\151\x6f\x6e\x5f\x61\x75\x74\150")) { goto V1q9x; } goto DeuwK; Gd5My: V1q9x: goto bIEl1; NzOdF: vs4xB: goto VtXAg; Y7qJb: $this->db->where("\151\x70\137\141\144\144\162\145\163\163", $ip_address); goto NzOdF; NxVbq: if (isset($ip_address)) { goto AWQaw; } goto aOmLl; x9U47: $qres = $this->db->get($this->tables["\154\x6f\x67\151\x6e\x5f\141\164\164\145\x6d\160\x74\x73"], 1); goto UW75P; aOmLl: $ip_address = $this->input->ip_address(); goto xFp1o; DeuwK: $this->db->select("\164\151\155\x65"); goto Quvwb; tDTlb: hrvtZ: goto Gd5My; Quvwb: $this->db->where("\154\x6f\147\x69\156", $identity); goto QbYU3; xFp1o: AWQaw: goto Y7qJb; VtXAg: $this->db->order_by("\151\x64", "\144\145\x73\143"); goto x9U47; bIEl1: return 0; goto mdD68; QbYU3: if (!$this->config->item("\164\x72\141\x63\x6b\137\154\157\147\x69\x6e\137\x69\x70\137\x61\x64\144\162\x65\x73\163", "\x69\x6f\156\137\141\x75\x74\x68")) { goto vs4xB; } goto NxVbq; FMbeh: return $qres->row()->time; goto tDTlb; mdD68: } public function get_last_attempt_ip($identity) { goto bNnV5; h9AhC: zUZBa: goto WKNFh; DemhH: if (!($qres->num_rows() > 0)) { goto zUZBa; } goto bp0KF; bNnV5: if (!($this->config->item("\x74\x72\x61\x63\x6b\x5f\154\x6f\x67\151\156\x5f\x61\164\x74\145\x6d\160\x74\163", "\151\x6f\156\x5f\141\165\164\150") && $this->config->item("\x74\x72\x61\143\x6b\x5f\x6c\157\x67\x69\156\x5f\x69\x70\137\x61\144\144\162\145\163\x73", "\151\157\x6e\137\x61\x75\164\x68"))) { goto vx9iU; } goto KTAt6; XFhfn: $this->db->order_by("\x69\x64", "\144\x65\163\143"); goto VSCRV; lHMGV: $this->db->where("\154\x6f\147\x69\156", $identity); goto XFhfn; KTAt6: $this->db->select("\151\x70\x5f\x61\144\x64\x72\x65\x73\163"); goto lHMGV; HbSDC: return ''; goto NmEaE; VSCRV: $qres = $this->db->get($this->tables["\154\157\147\151\156\x5f\x61\x74\164\145\155\160\x74\x73"], 1); goto DemhH; bp0KF: return $qres->row()->ip_address; goto h9AhC; WKNFh: vx9iU: goto HbSDC; NmEaE: } public function increase_login_attempts($identity) { goto NQHNC; RWvBN: return FALSE; goto YsHC0; H8XCx: $data["\x69\160\137\x61\x64\x64\162\x65\x73\163"] = $this->input->ip_address(); goto p9VJ3; p9VJ3: q3aqm: goto f84J2; d6EVX: lE39O: goto RWvBN; yJprb: $data = ["\x69\160\137\x61\144\144\x72\145\163\163" => '', "\154\x6f\x67\151\x6e" => $identity, "\164\151\155\145" => time()]; goto NFzx2; NFzx2: if (!$this->config->item("\x74\162\x61\143\153\137\154\x6f\147\151\x6e\137\151\x70\137\x61\144\x64\162\145\163\163", "\x69\157\156\x5f\141\165\x74\x68")) { goto q3aqm; } goto H8XCx; NQHNC: if (!$this->config->item("\164\162\141\143\153\137\154\157\x67\x69\156\137\x61\x74\x74\145\x6d\160\x74\163", "\151\x6f\156\x5f\x61\165\164\x68")) { goto lE39O; } goto yJprb; f84J2: return $this->db->insert($this->tables["\154\x6f\147\x69\156\137\x61\164\x74\x65\155\x70\164\163"], $data); goto d6EVX; YsHC0: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto FsD33; ZslxA: UfFBy: goto uO2wM; y02Ha: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto tBJjg; FsD33: if (!$this->config->item("\164\162\141\x63\x6b\137\x6c\157\x67\151\x6e\x5f\141\x74\164\145\x6d\160\164\163", "\x69\x6f\x6e\137\x61\165\x74\150")) { goto UfFBy; } goto fzC70; BluQa: Rm106: goto mAwmu; mAwmu: $this->db->where("\x69\160\137\x61\x64\144\x72\x65\163\163", $ip_address); goto qw_qg; fzC70: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\x6f\143\153\x6f\x75\164\137\x74\151\155\145", "\151\157\156\x5f\x61\x75\x74\x68")); goto y02Ha; nn1F2: $ip_address = $this->input->ip_address(); goto BluQa; WQ34p: if (isset($ip_address)) { goto Rm106; } goto nn1F2; O69g4: $this->db->or_where("\x74\x69\x6d\x65\40\x3c", time() - $old_attempts_expire_period, FALSE); goto l1VbI; qw_qg: QVsMM: goto O69g4; l1VbI: return $this->db->delete($this->tables["\x6c\157\x67\151\x6e\x5f\141\x74\x74\145\x6d\x70\x74\163"]); goto ZslxA; uO2wM: return FALSE; goto c2HJW; tBJjg: if (!$this->config->item("\164\x72\141\143\x6b\x5f\154\x6f\x67\151\156\137\151\x70\x5f\141\144\x64\162\x65\x73\163", "\151\157\156\x5f\141\165\164\x68")) { goto QVsMM; } goto WQ34p; c2HJW: } public function limit($limit) { goto BE2Jg; BE2Jg: $this->trigger_events("\x6c\x69\155\151\x74"); goto ETnAx; ETnAx: $this->_ion_limit = $limit; goto baRAh; baRAh: return $this; goto h292S; h292S: } public function offset($offset) { goto X5jkA; X5jkA: $this->trigger_events("\x6f\x66\146\x73\145\164"); goto UzSB2; AwNoE: return $this; goto UpnDv; UzSB2: $this->_ion_offset = $offset; goto AwNoE; UpnDv: } public function where($where, $value = NULL) { goto sVSvK; sVSvK: $this->trigger_events("\167\150\145\x72\x65"); goto jDV3Q; fe9lA: array_push($this->_ion_where, $where); goto Ga2Mt; Ga2Mt: return $this; goto RzzO3; jDV3Q: if (is_array($where)) { goto M4_ie; } goto Y4fhM; Y4fhM: $where = [$where => $value]; goto W2B8V; W2B8V: M4_ie: goto fe9lA; RzzO3: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\150") { goto yjhhz; yjhhz: $this->trigger_events("\154\x69\x6b\x65"); goto JYq7B; JYq7B: array_push($this->_ion_like, ["\x6c\151\153\145" => $like, "\x76\141\x6c\x75\145" => $value, "\160\x6f\x73\x69\164\151\157\156" => $position]); goto qSwc0; qSwc0: return $this; goto gLF0p; gLF0p: } public function select($select) { goto cd_fU; cd_fU: $this->trigger_events("\x73\x65\x6c\x65\143\164"); goto xkfSK; OSM3J: return $this; goto NTWda; xkfSK: $this->_ion_select[] = $select; goto OSM3J; NTWda: } public function order_by($by, $order = "\144\x65\x73\143") { goto SxH4N; SxH4N: $this->trigger_events("\x6f\x72\144\145\162\137\142\x79"); goto hXMyX; bQ5TY: return $this; goto rSHHM; hXMyX: $this->_ion_order_by = $by; goto tStAv; tStAv: $this->_ion_order = $order; goto bQ5TY; rSHHM: } public function row() { goto l3Ps0; un1R7: return $row; goto qRVro; GMbMz: $row = $this->response->row(); goto un1R7; l3Ps0: $this->trigger_events("\x72\157\167"); goto GMbMz; qRVro: } public function row_array() { goto gh9zo; rABwW: $row = $this->response->row_array(); goto xJlO6; gh9zo: $this->trigger_events(["\x72\x6f\x77", "\x72\157\167\137\x61\162\162\x61\171"]); goto rABwW; xJlO6: return $row; goto LzmwY; LzmwY: } public function result() { goto gMJ1C; gMJ1C: $this->trigger_events("\x72\145\163\x75\154\164"); goto QLNJu; QLNJu: $result = $this->response->result(); goto uBcFZ; uBcFZ: return $result; goto p6LBx; p6LBx: } public function result_array() { goto i_3Rp; Iujsu: $result = $this->response->result_array(); goto Mk3AU; i_3Rp: $this->trigger_events(["\162\145\163\165\x6c\164", "\x72\x65\x73\165\154\164\137\141\x72\162\x61\171"]); goto Iujsu; Mk3AU: return $result; goto TWogT; TWogT: } public function num_rows() { goto AxgSV; AxgSV: $this->trigger_events(["\x6e\165\155\x5f\x72\157\167\x73"]); goto jGekU; jGekU: $result = $this->response->num_rows(); goto xWcnM; xWcnM: return $result; goto nZ7M3; nZ7M3: } public function users($groups = NULL) { goto h0YJf; RdfG2: mVsnQ: goto Ywd19; yOzDf: foreach ($this->_ion_where as $where) { $this->db->where($where); NvKVV: } goto WNqp9; V4P6L: $this->_ion_order_by = NULL; goto ypkut; IBxyf: $this->db->join($this->tables["\147\x72\x6f\165\x70\x73"], $this->tables["\x75\163\x65\x72\163\x5f\x67\162\x6f\165\160\x73"] . "\56" . $this->join["\x67\162\157\165\160\163"] . "\40\75\x20" . $this->tables["\x67\x72\x6f\x75\x70\x73"] . "\x2e\x69\x64", "\151\x6e\x6e\x65\162"); goto vO8F8; Huj3j: VNXfC: goto f7mq9; riu0T: if (!(isset($groups) && !empty($groups))) { goto j5AXA; } goto aMyB3; If2G5: if (empty($group_ids)) { goto bUA2L; } goto IdzRr; iR_x9: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto Gr3ii; } goto s9j05; fRlx7: $this->db->join($this->tables["\x75\x73\145\x72\163\137\x67\162\x6f\x75\160\163"], $this->tables["\x75\x73\x65\162\163\x5f\x67\162\x6f\x75\160\163"] . "\x2e" . $this->join["\x75\x73\145\x72\x73"] . "\75" . $this->tables["\165\163\x65\162\x73"] . "\x2e\x69\144", "\151\156\x6e\x65\x72"); goto EVHuQ; frhUQ: wZNsF: goto iR_x9; xYpbZ: sE2PW: goto VZgoK; VZgoK: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\x5f\167\x68\x65\162\x65\137\x69\156" : "\x77\x68\x65\162\145\x5f\151\156"; goto UG1rN; gt5yF: EXx4v: goto If2G5; h0YJf: $this->trigger_events("\165\163\x65\x72\163"); goto Scbxf; EVHuQ: j5AXA: goto hfwaW; Ywd19: if (!isset($groups)) { goto VNXfC; } goto c2mgy; aMyB3: $this->db->distinct(); goto fRlx7; Kk4B5: bUA2L: goto Huj3j; ypkut: tqcxX: goto egugm; p3zSN: $this->_ion_select = []; goto RdfG2; NgesX: $this->_ion_where = []; goto frhUQ; WcNtG: $this->db->limit($this->_ion_limit); goto oKscX; vj27K: YV_W0: goto m2E9Q; WNqp9: YPg3X: goto NgesX; B2D5a: dFtih: goto riu0T; iVcy4: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto gUiia; } goto RhQfp; EjGdO: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto tqcxX; } goto i0xSX; s9j05: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\x6b\x65"], $like["\x76\141\154\165\x65"], $like["\160\157\x73\151\164\x69\157\x6e"]); HQqrA: } goto DgWGR; JpCJy: foreach ($groups as $group) { goto cBePl; sAhan: goto DLNef; goto DRCo0; MC509: $group_names[] = $group; goto sAhan; cBePl: if (is_numeric($group)) { goto yH34n; } goto MC509; eX2il: bIeeu: goto MvPBv; m1u1J: DLNef: goto eX2il; fIkKR: $group_ids[] = $group; goto m1u1J; DRCo0: yH34n: goto fIkKR; MvPBv: } goto xYpbZ; m2E9Q: goto sCtkY; goto gZH_F; PMVyM: $group_names = []; goto JpCJy; Scbxf: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto Ul1jv; } goto RQO7V; jEfjh: Gr3ii: goto iVcy4; ZILnb: $this->_ion_offset = NULL; goto E7DDl; RhQfp: if (!isset($this->_ion_limit)) { goto YV_W0; } goto WcNtG; vO8F8: $this->db->where_in($this->tables["\147\162\x6f\165\x70\x73"] . "\x2e\x6e\141\155\x65", $group_names); goto gt5yF; XxSHU: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto wZNsF; } goto yOzDf; oKscX: $this->_ion_limit = NULL; goto vj27K; i0xSX: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto cIz6r; HC2dU: return $this; goto O6Mo9; CPRcB: foreach ($this->_ion_select as $select) { $this->db->select($select); y9tgS: } goto DMrix; dhlM5: goto mVsnQ; goto Sr06Z; egugm: $this->response = $this->db->get($this->tables["\165\163\145\162\163"]); goto HC2dU; IdzRr: $this->db->{$or_where_in}($this->tables["\x75\x73\x65\162\x73\137\147\162\157\x75\x70\163"] . "\56" . $this->join["\x67\x72\157\165\x70\x73"], $group_ids); goto Kk4B5; kMl56: $groups = [$groups]; goto B2D5a; Sr06Z: Ul1jv: goto CPRcB; LW8PD: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto HFbmp; f7mq9: $this->trigger_events("\145\x78\164\x72\141\x5f\x77\150\145\x72\145"); goto XxSHU; DgWGR: HOymQ: goto C2IVP; UG1rN: if (empty($group_names)) { goto EXx4v; } goto IBxyf; cIz6r: $this->_ion_order = NULL; goto V4P6L; C2IVP: $this->_ion_like = []; goto jEfjh; E7DDl: sCtkY: goto EjGdO; hfwaW: $group_ids = []; goto PMVyM; gZH_F: gUiia: goto LW8PD; c2mgy: if (is_array($groups)) { goto dFtih; } goto kMl56; DMrix: vRWOi: goto p3zSN; RQO7V: $this->db->select([$this->tables["\x75\163\145\162\163"] . "\x2e\52", $this->tables["\165\163\145\x72\163"] . "\x2e\x69\x64\40\141\x73\40\151\144", $this->tables["\x75\163\x65\x72\163"] . "\56\x69\x64\40\x61\x73\40\x75\163\x65\x72\137\x69\x64"]); goto dhlM5; HFbmp: $this->_ion_limit = NULL; goto ZILnb; O6Mo9: } public function user($id = NULL) { goto QqABc; QqABc: $this->trigger_events("\165\163\x65\x72"); goto Sm4vi; Sm4vi: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\x65\x72\137\151\144"); goto Dqb9n; tdxZm: $this->where($this->tables["\x75\163\145\162\163"] . "\56\x69\144", $id); goto zI6iM; d9PEy: $this->order_by($this->tables["\165\x73\x65\162\x73"] . "\56\151\x64", "\x64\145\x73\143"); goto tdxZm; Dqb9n: $this->limit(1); goto d9PEy; OpgKG: return $this; goto RHXYj; zI6iM: $this->users(); goto OpgKG; RHXYj: } public function get_users_groups($id = FALSE) { goto jfu8F; QFUG9: $id || ($id = $this->session->userdata("\165\163\x65\x72\x5f\151\x64")); goto XaJc0; jfu8F: $this->trigger_events("\147\145\x74\x5f\165\x73\145\162\x73\137\147\x72\x6f\165\x70"); goto QFUG9; XaJc0: return $this->db->select($this->tables["\165\x73\145\x72\x73\137\x67\162\x6f\165\x70\163"] . "\56" . $this->join["\147\162\157\x75\x70\x73"] . "\x20\141\163\40\151\144\54\x20" . $this->tables["\x67\x72\x6f\165\x70\163"] . "\x2e\156\141\155\x65\54\x20" . $this->tables["\147\x72\157\x75\160\163"] . "\x2e\144\x65\x73\143\x72\x69\x70\x74\x69\x6f\156")->where($this->tables["\x75\x73\145\162\163\137\x67\162\157\x75\160\163"] . "\56" . $this->join["\165\163\x65\x72\163"], $id)->join($this->tables["\x67\x72\157\x75\160\x73"], $this->tables["\165\x73\145\x72\163\x5f\x67\162\x6f\165\x70\x73"] . "\56" . $this->join["\147\x72\157\165\160\x73"] . "\x3d" . $this->tables["\147\162\157\x75\x70\x73"] . "\56\151\x64")->get($this->tables["\165\163\x65\162\163\137\147\162\157\x75\x70\163"]); goto rLsCW; rLsCW: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto wN4wJ; KLS3l: foreach ($check_group as $key => $value) { goto iOm33; Br6Yo: Hq_Ot: goto d35Wf; d35Wf: UfttM: goto KsBob; iOm33: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto WdXWH; WdXWH: if (!(in_array($value, $groups) xor $check_all)) { goto Hq_Ot; } goto S_Bdb; S_Bdb: return !$check_all; goto Br6Yo; KsBob: } goto XrAnu; RkY3H: return $check_all; goto q54Ny; ZKg_B: ucKLF: goto QU4YT; lH2EJ: BK0tU: goto d05iz; ivlpQ: if (is_array($check_group)) { goto BK0tU; } goto QbvVg; wN4wJ: $this->trigger_events("\x69\x6e\137\147\x72\157\x75\160"); goto PtFLM; OYVvz: Xe3cF: goto KLS3l; QU4YT: $groups_array = $this->_cache_user_in_group[$id]; goto OYVvz; FBkIQ: lZ_on: goto tveS2; XrAnu: qZywt: goto RkY3H; PtFLM: $id || ($id = $this->session->userdata("\x75\163\145\162\x5f\x69\144")); goto ivlpQ; ZXc_r: goto Xe3cF; goto ZKg_B; z8TrN: $groups_array = []; goto nnJht; tveS2: $this->_cache_user_in_group[$id] = $groups_array; goto ZXc_r; d05iz: if (isset($this->_cache_user_in_group[$id])) { goto ucKLF; } goto LmQ2s; LmQ2s: $users_groups = $this->get_users_groups($id)->result(); goto z8TrN; nnJht: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; vu0n5: } goto FBkIQ; QbvVg: $check_group = [$check_group]; goto lH2EJ; q54Ny: } public function add_to_group($group_ids, $user_id = FALSE) { goto EENnn; JY3_J: $return = 0; goto oME1w; fDQdu: if (is_array($group_ids)) { goto IyFPl; } goto ErPVs; yV4Jp: Sju8P: goto XIRn1; XN0Oq: $user_id || ($user_id = $this->session->userdata("\165\163\145\162\137\151\x64")); goto fDQdu; MutpT: IyFPl: goto JY3_J; ErPVs: $group_ids = [$group_ids]; goto MutpT; EENnn: $this->trigger_events("\141\144\x64\137\x74\157\x5f\147\162\157\x75\160"); goto XN0Oq; oME1w: foreach ($group_ids as $group_id) { goto Qf5vA; ydIHJ: $group_name = $this->_cache_groups[$group_id]; goto aGw05; dk7wZ: $return++; goto b1SWY; aGw05: DkUwI: goto pwOk0; VGaQ3: $group = $this->group($group_id)->result(); goto XY0a7; PM_BI: MoeFd: goto ydIHJ; pwOk0: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto dk7wZ; Qf5vA: if (!$this->db->insert($this->tables["\x75\x73\145\x72\163\137\x67\162\157\x75\160\163"], [$this->join["\x67\x72\x6f\165\x70\163"] => (float) $group_id, $this->join["\x75\x73\145\162\163"] => (float) $user_id])) { goto yjVTy; } goto VigPa; Ex3o0: goto DkUwI; goto PM_BI; DGrVG: $this->_cache_groups[$group_id] = $group_name; goto Ex3o0; XY0a7: $group_name = $group[0]->name; goto DGrVG; VigPa: if (isset($this->_cache_groups[$group_id])) { goto MoeFd; } goto VGaQ3; xc5i1: e4AIb: goto oHUsY; b1SWY: yjVTy: goto xc5i1; oHUsY: } goto yV4Jp; XIRn1: return $return; goto J6IW9; J6IW9: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto amZ4s; ZHe8o: Q2GL8: goto pvra3; hQnus: if (is_array($group_ids)) { goto oIGOF; } goto D62D5; amZ4s: $this->trigger_events("\162\145\155\157\166\x65\137\x66\162\x6f\155\137\x67\x72\x6f\165\x70"); goto zCCBL; b9pxt: goto jvElo; goto EVN8z; RiKus: $this->_cache_user_in_group[$user_id] = []; goto F4xJd; VNVgl: foreach ($group_ids as $group_id) { goto bsih2; yhI4_: bW4aL: goto O87h8; x6nRh: g8M6M: goto yhI4_; eP1aE: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto g8M6M; } goto BflHt; bsih2: $this->db->delete($this->tables["\x75\163\145\162\163\137\x67\x72\157\x75\x70\163"], [$this->join["\147\162\x6f\x75\160\163"] => (float) $group_id, $this->join["\165\x73\145\162\x73"] => (float) $user_id]); goto eP1aE; BflHt: unset($this->_cache_user_in_group[$user_id][$group_id]); goto x6nRh; O87h8: } goto CeoxO; VdDdo: $return = TRUE; goto zWdto; zCCBL: if (!empty($user_id)) { goto Q2GL8; } goto UqBkf; pvra3: if (!empty($group_ids)) { goto NQuqq; } goto AlT7h; F4xJd: JUiyT: goto b9pxt; hcSax: oIGOF: goto VNVgl; CeoxO: nKDsx: goto VdDdo; FnDCZ: return $return; goto qU_eP; UqBkf: return FALSE; goto ZHe8o; zWdto: jvElo: goto FnDCZ; D62D5: $group_ids = [$group_ids]; goto hcSax; EVN8z: NQuqq: goto hQnus; AlT7h: if (!($return = $this->db->delete($this->tables["\x75\x73\145\x72\163\x5f\147\162\157\165\x70\x73"], [$this->join["\165\x73\145\162\163"] => (float) $user_id]))) { goto JUiyT; } goto RiKus; qU_eP: } public function groups() { goto B0kCD; f9d5J: goto npgGn; goto Z3KSZ; ISlmY: $this->_ion_limit = NULL; goto QzgYg; vRyKB: npgGn: goto BvIRY; BvIRY: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto SYOgn; } goto iLomX; c8WeB: $this->_ion_offset = NULL; goto vRyKB; B0kCD: $this->trigger_events("\x67\162\157\x75\160\x73"); goto L6zNb; L6zNb: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto fxW7N; } goto tpjuL; FQ_lp: fxW7N: goto dD1Uu; QzgYg: d28sh: goto f9d5J; a5vmM: $this->_ion_where = []; goto FQ_lp; LX6yM: $this->db->limit($this->_ion_limit); goto ISlmY; CLw52: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto IIB9E; HTpFB: SYOgn: goto gT2Ld; tpjuL: foreach ($this->_ion_where as $where) { $this->db->where($where); ne2VT: } goto Y3l_4; Y3l_4: lEp15: goto a5vmM; IA0Um: return $this; goto gpDv3; Z3KSZ: FSO9C: goto CLw52; iLomX: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto HTpFB; dD1Uu: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto FSO9C; } goto i7yXO; gT2Ld: $this->response = $this->db->get($this->tables["\x67\x72\157\x75\x70\x73"]); goto IA0Um; i7yXO: if (!isset($this->_ion_limit)) { goto d28sh; } goto LX6yM; IIB9E: $this->_ion_limit = NULL; goto c8WeB; gpDv3: } public function group($id = NULL) { goto KARBn; vAxNN: if (!isset($id)) { goto U0FNA; } goto hmlNP; hmlNP: $this->where($this->tables["\147\162\x6f\x75\x70\x73"] . "\x2e\x69\x64", $id); goto ZHDBM; E2WCK: return $this->groups(); goto GYI6o; ZHDBM: U0FNA: goto a1aSN; y0WK2: $this->order_by("\151\x64", "\x64\145\163\143"); goto E2WCK; KARBn: $this->trigger_events("\x67\x72\x6f\x75\x70"); goto vAxNN; a1aSN: $this->limit(1); goto y0WK2; GYI6o: } public function update($id, array $data) { goto x2b5o; atgrR: $this->db->trans_commit(); goto SYzDL; ekPIp: $this->db->trans_rollback(); goto HgEit; HVggS: $this->db->trans_rollback(); goto YbwXl; zK1fM: $this->db->trans_rollback(); goto eXooI; DFLhd: if (!($this->db->trans_status() === FALSE)) { goto IM2zC; } goto ekPIp; nk2DX: $this->set_error("\x75\x70\144\141\x74\x65\x5f\x75\x6e\x73\x75\143\x63\145\163\163\146\165\x6c"); goto z_ooQ; MtR2W: w2UBZ: goto tjTUU; oDsi5: IM2zC: goto atgrR; nO9Bq: $this->set_message("\165\160\144\141\164\145\137\x73\x75\143\143\145\163\163\146\165\154"); goto DVnLc; BRcDN: $this->set_error("\165\x70\144\141\164\145\x5f\165\x6e\163\x75\143\x63\145\x73\x73\x66\x75\x6c"); goto Xxtvw; MrMPc: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto qGp6i; } goto zK1fM; SYzDL: $this->trigger_events(["\x70\157\163\164\x5f\x75\x70\144\x61\164\x65\137\165\163\x65\x72", "\x70\x6f\163\x74\x5f\165\160\x64\x61\164\145\x5f\165\x73\x65\x72\137\163\165\143\x63\x65\163\163\146\165\154"]); goto nO9Bq; YY9mn: unset($data["\160\141\x73\163\x77\157\162\x64"]); goto Vh56p; BOIw6: $this->trigger_events("\x65\170\164\162\141\137\167\x68\145\162\145"); goto Gx5G0; NM_EC: return FALSE; goto z4Cb0; fSApx: $this->set_error("\x75\160\144\141\x74\x65\x5f\165\156\x73\165\143\143\145\163\x73\x66\165\x6c"); goto NM_EC; x2b5o: $this->trigger_events("\x70\162\x65\x5f\x75\160\x64\141\164\x65\137\165\163\145\x72"); goto R5Sjb; HgEit: $this->trigger_events(["\x70\x6f\163\164\x5f\x75\160\144\141\164\x65\137\x75\163\x65\162", "\160\157\x73\x74\x5f\x75\160\x64\141\164\145\137\x75\x73\x65\162\137\165\156\163\165\x63\x63\145\163\x73\146\165\154"]); goto nk2DX; Vh56p: goto jBND6; goto OkJYx; eXooI: $this->set_error("\141\x63\x63\x6f\x75\x6e\164\x5f\x63\162\x65\141\164\x69\x6f\156\137\x64\165\x70\x6c\151\143\x61\x74\145\x5f\x69\x64\145\156\164\x69\x74\171"); goto eTD2x; z4Cb0: qGp6i: goto gvlLY; YbwXl: $this->trigger_events(["\160\157\x73\164\x5f\165\x70\x64\x61\x74\145\x5f\165\x73\145\x72", "\160\157\x73\164\x5f\x75\x70\144\x61\x74\x65\x5f\165\x73\x65\162\x5f\165\156\x73\x75\143\143\145\x73\163\x66\165\154"]); goto BRcDN; VPPz6: if (!array_key_exists("\x70\x61\163\163\x77\157\x72\x64", $data)) { goto GWt32; } goto Xc88K; q8R9P: EIS5y: goto BOIw6; R5Sjb: $user = $this->user($id)->row(); goto hfa92; GCz6G: $data["\160\x61\x73\163\x77\157\162\144"] = $this->hash_password($data["\160\141\163\163\167\x6f\162\144"], $user->{$this->identity_column}); goto C8lSg; Xc88K: if (!empty($data["\160\141\163\163\167\x6f\162\x64"])) { goto s19DU; } goto YY9mn; DVnLc: return TRUE; goto EwIiZ; z_ooQ: return FALSE; goto oDsi5; OkJYx: s19DU: goto GCz6G; tjTUU: jBND6: goto rWsMy; Xxtvw: return FALSE; goto MtR2W; Yusp_: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\x73\x77\157\x72\x64", $data) || array_key_exists("\x65\155\x61\x69\x6c", $data))) { goto EIS5y; } goto VPPz6; gvlLY: $data = $this->_filter_data($this->tables["\165\163\145\x72\163"], $data); goto Yusp_; rWsMy: GWt32: goto q8R9P; Gx5G0: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, ["\151\x64" => $user->id]); goto DFLhd; eTD2x: $this->trigger_events(["\160\157\x73\x74\137\165\x70\x64\141\164\x65\137\165\x73\x65\x72", "\x70\157\x73\x74\x5f\x75\x70\x64\x61\164\145\x5f\165\x73\x65\162\x5f\x75\156\163\165\143\143\x65\163\163\146\165\154"]); goto fSApx; C8lSg: if (!($data["\160\141\x73\x73\167\x6f\162\144"] === FALSE)) { goto w2UBZ; } goto HVggS; hfa92: $this->db->trans_begin(); goto MrMPc; EwIiZ: } public function delete_user($id) { goto ZvKbP; ZvKbP: $this->trigger_events("\160\162\145\x5f\x64\x65\154\x65\164\x65\137\165\163\x65\x72"); goto BcQ6A; bd6FG: $this->set_message("\x64\145\154\145\x74\x65\137\x73\165\x63\143\x65\x73\163\146\165\154"); goto GlADD; XjGDO: return FALSE; goto CUQ4A; CUQ4A: vFvXk: goto k06RM; tdGPe: $this->set_error("\x64\145\x6c\145\x74\x65\x5f\165\x6e\163\x75\x63\x63\145\163\x73\146\165\154"); goto XjGDO; mp2D2: $this->trigger_events(["\x70\x6f\x73\x74\x5f\144\x65\154\x65\164\x65\x5f\x75\163\x65\162", "\160\x6f\x73\164\137\x64\145\x6c\x65\x74\x65\x5f\x75\x73\145\x72\x5f\x75\156\x73\165\143\x63\x65\163\x73\x66\165\x6c"]); goto tdGPe; GlADD: return TRUE; goto B7bBN; o1aLH: if (!($this->db->trans_status() === FALSE)) { goto vFvXk; } goto M3B_6; k06RM: $this->db->trans_commit(); goto vzz7B; M3B_6: $this->db->trans_rollback(); goto mp2D2; vzz7B: $this->trigger_events(["\x70\157\x73\x74\x5f\144\145\x6c\145\x74\x65\x5f\165\x73\x65\162", "\160\157\163\x74\137\144\x65\x6c\x65\164\145\137\x75\163\145\162\x5f\163\165\143\x63\x65\x73\163\146\165\x6c"]); goto bd6FG; D3FIu: $this->remove_from_group(NULL, $id); goto XHGQh; XHGQh: $this->db->delete($this->tables["\165\x73\145\162\x73"], ["\x69\144" => $id]); goto o1aLH; BcQ6A: $this->db->trans_begin(); goto D3FIu; B7bBN: } public function update_last_login($id) { goto heda1; vtdkd: $this->load->helper("\144\x61\x74\145"); goto pUTXo; M58pz: $this->db->update($this->tables["\x75\163\145\x72\x73"], ["\154\x61\163\164\x5f\x6c\x6f\147\x69\156" => time()], ["\x69\144" => $id]); goto Le6ji; Le6ji: return $this->db->affected_rows() == 1; goto DlkjJ; pUTXo: $this->trigger_events("\x65\170\164\x72\x61\x5f\167\150\x65\162\x65"); goto M58pz; heda1: $this->trigger_events("\165\x70\144\141\x74\145\137\x6c\141\x73\x74\x5f\154\157\x67\x69\156"); goto vtdkd; DlkjJ: } public function set_lang($lang = "\145\156") { goto Z8xBH; azBQZ: goto Kk8Rz; goto QhnVk; bMyeP: if ($this->config->item("\x75\163\x65\x72\137\x65\x78\x70\x69\162\x65", "\x69\x6f\156\137\141\165\164\150") === 0) { goto aelJg; } goto rnTgz; EcRGw: $expire = self::MAX_COOKIE_LIFETIME; goto F34d8; JFzne: set_cookie(["\x6e\141\155\145" => "\154\141\156\147\137\143\157\x64\145", "\x76\x61\x6c\165\x65" => $lang, "\145\x78\x70\x69\x72\x65" => $expire]); goto J9zvd; Z8xBH: $this->trigger_events("\x73\145\164\x5f\x6c\141\156\x67"); goto bMyeP; F34d8: Kk8Rz: goto JFzne; QhnVk: aelJg: goto EcRGw; rnTgz: $expire = $this->config->item("\x75\x73\x65\x72\x5f\x65\170\x70\151\162\x65", "\x69\157\x6e\137\x61\x75\164\150"); goto azBQZ; J9zvd: return TRUE; goto z9aP9; z9aP9: } public function set_session($user) { goto FyS9T; FyS9T: $this->trigger_events("\160\x72\x65\137\x73\x65\164\x5f\163\x65\x73\x73\151\157\x6e"); goto XfKFN; XfKFN: $session_data = ["\x69\x64\x65\x6e\x74\x69\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\151\154" => $user->email, "\165\x73\145\x72\137\x69\144" => $user->id, "\x6f\x6c\x64\137\154\141\x73\x74\137\154\x6f\x67\x69\x6e" => $user->last_login, "\x6c\x61\163\164\x5f\x63\x68\x65\143\153" => time()]; goto sjdnD; sjdnD: $this->session->set_userdata($session_data); goto p8OXq; Vs0Iv: return TRUE; goto Pp5U0; p8OXq: $this->trigger_events("\160\157\163\x74\x5f\x73\145\x74\137\x73\x65\163\163\151\x6f\x6e"); goto Vs0Iv; Pp5U0: } public function remember_user($identity) { goto EqHMs; jkum9: pDhaJ: goto eLmGO; d6RXj: if ($this->config->item("\165\163\x65\162\x5f\145\x78\x70\x69\x72\145", "\151\157\x6e\137\x61\165\164\150") === 0) { goto exKq7; } goto Zu1Uf; eLmGO: $token = $this->_generate_selector_validator_couple(); goto j1YY9; TshZp: set_cookie(["\156\141\x6d\145" => $this->config->item("\162\x65\x6d\x65\x6d\x62\x65\x72\137\143\157\x6f\x6b\151\x65\x5f\x6e\x61\x6d\x65", "\x69\x6f\156\x5f\141\165\x74\150"), "\166\x61\154\x75\145" => $token->user_code, "\x65\x78\x70\x69\x72\145" => $expire]); goto U2ziB; zMldP: EdYiA: goto TshZp; RQmxG: ThpA9: goto VQzPW; gkKOS: exKq7: goto qUhEP; RYsKB: if (!($this->db->affected_rows() > -1)) { goto ThpA9; } goto d6RXj; VQzPW: XBDB0: goto ppZz5; QunAF: $this->db->update($this->tables["\165\163\145\162\x73"], ["\162\x65\155\x65\x6d\x62\x65\162\137\x73\x65\154\145\143\x74\x6f\x72" => $token->selector, "\x72\x65\x6d\145\x6d\142\x65\x72\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto RYsKB; qHFkZ: return TRUE; goto RQmxG; Zu1Uf: $expire = $this->config->item("\165\163\x65\x72\137\145\x78\x70\x69\162\145", "\x69\x6f\x6e\137\x61\x75\x74\x68"); goto GdzF9; j1YY9: if (!$token->validator_hashed) { goto XBDB0; } goto QunAF; JUA1v: if ($identity) { goto pDhaJ; } goto gNQx_; EqHMs: $this->trigger_events("\160\162\145\x5f\x72\145\x6d\145\x6d\x62\x65\162\137\165\163\145\x72"); goto JUA1v; GdzF9: goto EdYiA; goto gkKOS; gNQx_: return FALSE; goto jkum9; MKeWx: return FALSE; goto gd2Wd; U2ziB: $this->trigger_events(["\x70\x6f\x73\x74\137\x72\x65\155\145\x6d\x62\x65\x72\137\165\163\x65\162", "\162\x65\155\145\x6d\x62\145\162\137\165\163\145\162\x5f\x73\165\143\143\x65\x73\163\x66\x75\154"]); goto qHFkZ; qUhEP: $expire = self::MAX_COOKIE_LIFETIME; goto zMldP; ppZz5: $this->trigger_events(["\x70\157\163\x74\137\x72\145\155\x65\155\x62\x65\x72\137\165\163\145\x72", "\162\x65\155\x65\155\x62\145\162\x5f\x75\x73\x65\x72\137\x75\x6e\x73\x75\143\x63\x65\163\163\x66\x75\154"]); goto MKeWx; gd2Wd: } public function login_remembered_user() { goto Z_soP; ZjKL0: iK3Dv: goto ILPCy; Jgt8_: $identity = $user->{$this->identity_column}; goto DqIW3; nyJhO: return TRUE; goto DCbrO; Z_soP: $this->trigger_events("\x70\x72\145\x5f\x6c\x6f\x67\151\x6e\x5f\x72\145\x6d\145\155\142\145\x72\x65\144\137\x75\x73\145\x72"); goto BA6au; bOIfU: $user = $query->row(); goto Jgt8_; NtWYM: $this->trigger_events("\x65\x78\x74\162\x61\x5f\167\150\145\x72\x65"); goto SK2ge; HtDtr: $this->update_last_login($user->id); goto RuSnU; PfrTi: return FALSE; goto khuMF; z8NX0: return FALSE; goto ADGc9; xXnJb: if (!($token === FALSE)) { goto y6NeA; } goto RylTo; ApUpa: $this->trigger_events(["\x70\157\163\164\x5f\x6c\x6f\147\151\156\x5f\x72\145\155\x65\155\142\145\162\x65\x64\x5f\165\163\x65\x72", "\160\x6f\163\164\137\154\157\147\151\x6e\137\x72\x65\155\145\x6d\x62\145\x72\x65\144\137\165\163\145\x72\x5f\x75\156\163\165\x63\x63\x65\x73\163\x66\165\x6c"]); goto PfrTi; TXdcH: S36V5: goto FocdF; RuSnU: $this->set_session($user); goto jLylJ; BXiFD: if (!$this->config->item("\165\163\x65\162\x5f\x65\170\164\x65\156\144\137\x6f\156\137\x6c\x6f\147\x69\x6e", "\151\x6f\156\137\141\x75\x74\150")) { goto iK3Dv; } goto UJvYv; BA6au: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\145\155\x62\145\x72\137\143\157\x6f\x6b\151\x65\x5f\x6e\x61\x6d\x65", "\x69\x6f\x6e\x5f\x61\x75\x74\x68")); goto yIjYB; ILPCy: $this->session->sess_regenerate(FALSE); goto qw9ho; DqIW3: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto LqDBh; } goto HtDtr; yIjYB: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto xXnJb; YKQWQ: if (!($query->num_rows() === 1)) { goto S36V5; } goto bOIfU; qw9ho: $this->trigger_events(["\x70\x6f\163\x74\x5f\x6c\x6f\x67\x69\156\x5f\162\x65\155\145\x6d\142\145\x72\145\x64\137\165\x73\x65\162", "\160\157\x73\x74\137\154\157\x67\151\156\137\x72\x65\x6d\145\155\x62\x65\x72\x65\x64\x5f\x75\x73\145\x72\x5f\x73\165\143\x63\145\163\163\146\x75\x6c"]); goto nyJhO; FocdF: delete_cookie($this->config->item("\162\x65\155\145\155\x62\145\162\x5f\x63\x6f\x6f\153\151\145\x5f\x6e\x61\x6d\x65", "\151\x6f\x6e\x5f\x61\x75\164\150")); goto ApUpa; RylTo: $this->trigger_events(["\x70\x6f\163\164\137\x6c\x6f\147\151\156\137\x72\145\x6d\x65\x6d\142\145\162\145\x64\x5f\x75\x73\145\x72", "\x70\157\163\x74\x5f\x6c\157\x67\x69\x6e\x5f\162\145\155\145\x6d\142\x65\x72\145\144\x5f\165\163\x65\x72\x5f\165\x6e\163\165\143\143\x65\x73\x73\x66\x75\154"]); goto z8NX0; UJvYv: $this->remember_user($identity); goto ZjKL0; SK2ge: $query = $this->db->select($this->identity_column . "\54\40\151\144\x2c\40\145\155\x61\151\x6c\x2c\40\x72\x65\x6d\x65\x6d\x62\x65\x72\x5f\143\157\x64\145\54\x20\x6c\x61\163\x74\x5f\x6c\157\147\151\x6e")->where("\162\x65\x6d\145\x6d\142\145\162\x5f\163\145\154\145\x63\x74\157\162", $token->selector)->where("\141\143\164\x69\166\145", 1)->limit(1)->get($this->tables["\165\x73\x65\x72\163"]); goto YKQWQ; DCbrO: LqDBh: goto TXdcH; jLylJ: $this->clear_forgotten_password_code($identity); goto BXiFD; ADGc9: y6NeA: goto NtWYM; khuMF: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto JnHBy; hrw9z: if (!($existing_group !== 0)) { goto nTtni; } goto px5Oy; nGD3p: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\x75\160\x73"], ["\x6e\141\155\145" => $group_name])->num_rows(); goto hrw9z; pjg4F: $this->trigger_events("\145\170\x74\x72\141\137\x67\162\157\165\x70\x5f\x73\x65\164"); goto ILreV; fHSp4: DRw7m: goto nGD3p; h6Q7I: Z9aIK: goto pjg4F; px5Oy: $this->set_error("\147\x72\x6f\x75\x70\x5f\141\x6c\x72\x65\x61\144\x79\x5f\x65\170\151\x73\164\163"); goto yEvR3; G90lu: nTtni: goto PIy21; haZV4: if (empty($additional_data)) { goto Z9aIK; } goto IqSSW; yEvR3: return FALSE; goto G90lu; JnHBy: if ($group_name) { goto DRw7m; } goto m0ORU; PIy21: $data = ["\156\x61\x6d\145" => $group_name, "\x64\145\x73\x63\162\x69\x70\x74\151\157\x6e" => $group_description]; goto haZV4; gNnsj: return $group_id; goto oLjl_; MtPMN: $group_id = $this->db->insert_id($this->tables["\x67\162\157\165\x70\163"] . "\x5f\151\x64\x5f\x73\x65\x71"); goto U0Q_q; ILreV: $this->db->insert($this->tables["\x67\162\157\x75\160\x73"], $data); goto MtPMN; U0Q_q: $this->set_message("\x67\x72\x6f\x75\160\x5f\143\162\x65\x61\164\x69\x6f\156\137\x73\x75\x63\143\145\163\x73\146\165\x6c"); goto gNnsj; m0ORU: $this->set_error("\x67\162\157\x75\x70\x5f\x6e\x61\x6d\145\x5f\x72\145\x71\165\x69\162\x65\x64"); goto EgrBq; IqSSW: $data = array_merge($this->_filter_data($this->tables["\147\162\157\x75\160\x73"], $additional_data), $data); goto h6Q7I; EgrBq: return FALSE; goto fHSp4; oLjl_: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto A5Wwq; trblU: if (empty($group_name)) { goto tdFux; } goto LdxUN; dXTbh: if (empty($additional_data)) { goto LxKKZ; } goto cWHob; vF7cN: $this->set_error("\147\162\x6f\x75\160\137\156\141\155\x65\137\x61\x64\x6d\x69\x6e\x5f\156\157\x74\x5f\141\x6c\164\x65\x72"); goto UrATj; Bm_Nf: ZiQHR: goto H_3v9; N8iBE: return FALSE; goto xJ_0_; SNtBw: $this->db->update($this->tables["\147\x72\157\165\160\163"], $data, ["\x69\x64" => $group_id]); goto xsWpu; Awcxk: $data["\156\141\x6d\145"] = $group_name; goto CLL7Z; CLL7Z: tdFux: goto pflvE; THsWD: LxKKZ: goto SNtBw; LdxUN: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\x75\x70\163"], ["\x6e\x61\155\145" => $group_name])->row(); goto C5uGO; xsWpu: $this->set_message("\147\162\157\165\x70\x5f\165\160\144\141\164\145\137\x73\165\x63\x63\145\163\163\146\x75\x6c"); goto RSfvQ; UrATj: return FALSE; goto GpCOQ; pflvE: $group = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\163"], ["\151\x64" => $group_id])->row(); goto M5I2E; xJ_0_: jWg1s: goto Awcxk; cWHob: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\x75\160\163"], $additional_data), $data); goto THsWD; T_kgC: $this->set_error("\x67\162\157\165\160\x5f\141\154\162\145\x61\x64\171\137\x65\x78\x69\x73\164\163"); goto N8iBE; C5uGO: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto jWg1s; } goto T_kgC; GpCOQ: piUXW: goto dXTbh; RSfvQ: return TRUE; goto CzFsB; M5I2E: if (!($this->config->item("\141\144\155\151\156\137\147\x72\x6f\x75\160", "\151\157\156\x5f\x61\x75\164\x68") === $group->name && $group_name !== $group->name)) { goto piUXW; } goto vF7cN; A5Wwq: if (!empty($group_id)) { goto ZiQHR; } goto VPW5x; VPW5x: return FALSE; goto Bm_Nf; H_3v9: $data = []; goto trblU; CzFsB: } public function delete_group($group_id = FALSE) { goto zhd86; WNFUK: $group = $this->group($group_id)->row(); goto lIJwY; aPtbH: V8MbR: goto PPNjk; xgNor: $this->db->trans_begin(); goto rauS6; o2N4Z: $this->db->trans_commit(); goto TBsfm; nK4ld: $this->db->trans_rollback(); goto uF0OF; tKjQR: return FALSE; goto ZYw58; lIJwY: if (!($group->name == $this->config->item("\141\144\155\151\156\137\147\x72\x6f\x75\160", "\151\157\x6e\x5f\x61\165\164\x68"))) { goto V8MbR; } goto Lieye; rauS6: $this->db->delete($this->tables["\x75\163\145\x72\x73\x5f\147\162\x6f\165\160\x73"], [$this->join["\x67\x72\157\x75\x70\163"] => $group_id]); goto aQ7Iz; BxhIH: if (!($this->db->trans_status() === FALSE)) { goto LeEpB; } goto nK4ld; iP73W: return FALSE; goto mxUGJ; Lieye: $this->trigger_events(["\x70\x6f\x73\164\137\x64\145\x6c\145\x74\145\x5f\x67\x72\x6f\x75\x70", "\160\157\x73\164\137\x64\x65\x6c\x65\x74\145\137\147\x72\157\165\x70\x5f\156\157\164\x61\154\154\x6f\167\x65\x64"]); goto W0Gmy; mxUGJ: bSoDH: goto WNFUK; ZYw58: LeEpB: goto o2N4Z; TBsfm: $this->trigger_events(["\x70\x6f\163\164\137\144\145\154\x65\164\145\137\147\162\x6f\165\160", "\x70\x6f\x73\x74\137\x64\145\154\145\164\145\x5f\x67\162\157\x75\x70\x5f\x73\165\143\x63\x65\x73\x73\146\165\x6c"]); goto WBG86; WBG86: $this->set_message("\147\162\x6f\x75\x70\x5f\144\145\x6c\x65\164\x65\x5f\163\x75\143\143\145\163\163\x66\x75\x6c"); goto B54l0; zhd86: if (!(!$group_id || empty($group_id))) { goto bSoDH; } goto iP73W; SjqAG: return FALSE; goto aPtbH; FsDnF: $this->set_error("\147\x72\157\165\x70\137\144\145\154\x65\x74\x65\x5f\165\156\x73\x75\143\143\x65\163\163\x66\x75\x6c"); goto tKjQR; aQ7Iz: $this->db->delete($this->tables["\x67\x72\x6f\165\x70\163"], ["\x69\144" => $group_id]); goto BxhIH; B54l0: return TRUE; goto tb_TX; PPNjk: $this->trigger_events("\160\162\145\x5f\144\145\x6c\x65\x74\x65\137\x67\x72\157\x75\160"); goto xgNor; W0Gmy: $this->set_error("\147\162\x6f\165\160\137\144\x65\154\145\x74\145\x5f\156\157\x74\141\154\154\x6f\167\145\x64"); goto SjqAG; uF0OF: $this->trigger_events(["\160\157\163\x74\x5f\144\x65\154\145\x74\x65\x5f\x67\162\x6f\x75\160", "\160\x6f\163\164\x5f\x64\x65\x6c\145\164\x65\x5f\x67\162\157\165\160\x5f\x75\156\163\x75\143\x63\x65\x73\163\146\165\x6c"]); goto FsDnF; tb_TX: } public function set_hook($event, $name, $class, $method, $arguments) { goto p0EJY; p0EJY: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto AB0Ge; OySsR: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto SdzHF; AB0Ge: $this->_ion_hooks->{$event}[$name]->class = $class; goto FFKFl; FFKFl: $this->_ion_hooks->{$event}[$name]->method = $method; goto OySsR; SdzHF: } public function remove_hook($event, $name) { goto wCyVH; mIF_f: GvHv3: goto n_k3E; ixxO9: unset($this->_ion_hooks->{$event}[$name]); goto mIF_f; wCyVH: if (!isset($this->_ion_hooks->{$event}[$name])) { goto GvHv3; } goto ixxO9; n_k3E: } public function remove_hooks($event) { goto XjWdc; rdiV0: unset($this->_ion_hooks->{$event}); goto czImx; czImx: ciQ2Z: goto EeLKa; XjWdc: if (!isset($this->_ion_hooks->{$event})) { goto ciQ2Z; } goto rdiV0; EeLKa: } protected function _call_hook($event, $name) { goto DRJG6; TC4pV: zV2FL: goto rxzU_; rxzU_: return FALSE; goto Z4ek1; CN4RA: $hook = $this->_ion_hooks->{$event}[$name]; goto W2avB; W2avB: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto TC4pV; DRJG6: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto zV2FL; } goto CN4RA; Z4ek1: } public function trigger_events($events) { goto YnVZv; vAl1Y: foreach ($events as $event) { $this->trigger_events($event); Q3MeE: } goto yOM26; lH4K5: anMJj: goto vAl1Y; yOM26: aDcZK: goto o7oIk; Tos6i: goto exrv3; goto lH4K5; YnVZv: if (is_array($events) && !empty($events)) { goto anMJj; } goto qkWog; o7oIk: exrv3: goto HTJAi; qkWog: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto LQC7B; } goto qe_f2; HnoTT: LQC7B: goto Tos6i; abzo7: OOpoP: goto HnoTT; qe_f2: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); kUDlZ: } goto abzo7; HTJAi: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto GIyY6; yv2iE: return TRUE; goto R61eW; uyvY1: $this->message_end_delimiter = $end_delimiter; goto yv2iE; GIyY6: $this->message_start_delimiter = $start_delimiter; goto uyvY1; R61eW: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto XnaSF; MdsdW: return TRUE; goto DKIXo; ouBg9: $this->error_end_delimiter = $end_delimiter; goto MdsdW; XnaSF: $this->error_start_delimiter = $start_delimiter; goto ouBg9; DKIXo: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto ttADc; AuKbJ: foreach ($this->messages as $message) { goto jNYmg; KoYIx: N9k2H: goto nF5BL; jNYmg: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto xDFOj; xDFOj: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto KoYIx; nF5BL: } goto mZqj0; mZqj0: YzF9c: goto TYZQu; TYZQu: return $_output; goto YmesQ; ttADc: $_output = ''; goto AuKbJ; YmesQ: } public function messages_array($langify = TRUE) { goto zm01w; Q2MeU: goto uKdwk; goto gAI_H; ImDwW: return $this->messages; goto Q2MeU; zm01w: if ($langify) { goto aPKXa; } goto ImDwW; XZq4d: return $_output; goto Qg4PX; SfQw5: foreach ($this->messages as $message) { goto K_sy2; IL9Wt: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto Nkqd2; Nkqd2: OUC2E: goto xfwrj; K_sy2: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto IL9Wt; xfwrj: } goto DxIhc; gAI_H: aPKXa: goto PB7e6; PB7e6: $_output = []; goto SfQw5; DxIhc: LEnoG: goto XZq4d; Qg4PX: uKdwk: goto FCPak; FCPak: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto IlGh1; IlGh1: $_output = ''; goto iZWe7; SKc7l: return $_output; goto iCl8h; b6aUZ: FRjga: goto SKc7l; iZWe7: foreach ($this->errors as $error) { goto TvMg1; LF1Ix: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto R9ViN; R9ViN: pit37: goto ElRH0; TvMg1: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\43"; goto LF1Ix; ElRH0: } goto b6aUZ; iCl8h: } public function errors_array($langify = TRUE) { goto HjSZl; uaYgC: foreach ($this->errors as $error) { goto I35uO; ZJvpy: CR1Or: goto mB6DA; I35uO: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\x23"; goto LyOaV; LyOaV: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto ZJvpy; mB6DA: } goto dBPWn; wdpA7: mlhEp: goto mLjGm; REwr_: return $this->errors; goto TI5t4; HjSZl: if ($langify) { goto g6hW5; } goto REwr_; TI5t4: goto mlhEp; goto Ynz0P; dBPWn: viBLE: goto HQwqb; HQwqb: return $_output; goto wdpA7; Ynz0P: g6hW5: goto Ln8tp; Ln8tp: $_output = []; goto uaYgC; mLjGm: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto bd2aN; XXiiT: return FALSE; goto AVaOk; TZZCB: $data = ["\x70\141\163\163\167\157\162\x64" => $hash, "\162\x65\155\x65\155\142\x65\162\137\143\157\x64\145" => NULL, "\x66\157\162\147\x6f\x74\x74\145\x6e\x5f\160\141\x73\x73\x77\x6f\162\x64\137\x63\157\x64\145" => NULL, "\146\x6f\x72\x67\x6f\x74\164\145\156\137\160\141\163\163\x77\x6f\162\x64\137\164\151\x6d\x65" => NULL]; goto pGZI7; bd2aN: $hash = $this->hash_password($password, $identity); goto xxlCW; xxlCW: if (!($hash === FALSE)) { goto Tsvsm; } goto XXiiT; AVaOk: Tsvsm: goto TZZCB; fa6if: $this->db->update($this->tables["\x75\x73\145\x72\x73"], $data, [$this->identity_column => $identity]); goto TNHA4; pGZI7: $this->trigger_events("\145\170\164\x72\141\137\x77\x68\145\x72\x65"); goto fa6if; TNHA4: return $this->db->affected_rows() == 1; goto rKNUz; rKNUz: } protected function _filter_data($table, $data) { goto wjNVR; M9ziP: return $filtered_data; goto ec2po; nWGux: rHiLZ: goto M9ziP; VM8g6: foreach ($columns as $column) { goto z9lao; MOSpp: U4wl_: goto XUQUV; KSC4d: $filtered_data[$column] = $data[$column]; goto nMjDb; nMjDb: ealnw: goto MOSpp; z9lao: if (!array_key_exists($column, $data)) { goto ealnw; } goto KSC4d; XUQUV: } goto X2XLO; wjNVR: $filtered_data = []; goto WYycQ; j1e47: if (!is_array($data)) { goto rHiLZ; } goto VM8g6; X2XLO: m4JKn: goto nWGux; WYycQ: $columns = $this->db->list_fields($table); goto j1e47; ec2po: } protected function _random_token($result_length = 32) { goto UW5p4; s3ka0: return FALSE; goto u5nSI; zCwQm: MKqfs: goto jOC91; ME7Ae: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto izh8P; g1q23: $result_length = 32; goto zCwQm; w0lRk: if (!function_exists("\x6d\143\x72\171\x70\164\137\x63\x72\x65\141\x74\145\137\x69\166")) { goto eQnsP; } goto ME7Ae; izh8P: eQnsP: goto w2uMG; UW5p4: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto MKqfs; } goto g1q23; S_mCn: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto OXMFh; OXMFh: dtUAg: goto s3ka0; OISqy: return bin2hex(random_bytes($result_length / 2)); goto gr7zI; w2uMG: if (!function_exists("\x6f\160\x65\156\x73\x73\154\137\x72\x61\x6e\x64\157\155\x5f\160\163\145\165\144\157\x5f\x62\171\164\145\163")) { goto dtUAg; } goto S_mCn; gr7zI: fVOa7: goto w0lRk; jOC91: if (!function_exists("\x72\x61\x6e\x64\157\155\137\142\171\164\x65\163")) { goto fVOa7; } goto OISqy; u5nSI: } protected function _get_hash_parameters($identity = NULL) { goto q33ta; prNlp: i9odu: goto nlzPA; q33ta: $is_admin = FALSE; goto ogob1; iaxyp: switch ($this->hash_method) { case "\x62\143\x72\x79\160\x74": $params = ["\x63\x6f\163\x74" => $is_admin ? $this->config->item("\142\143\x72\171\160\164\137\x61\144\x6d\x69\156\137\x63\x6f\163\164", "\x69\157\156\137\x61\165\164\x68") : $this->config->item("\x62\x63\x72\171\160\164\x5f\x64\x65\x66\x61\165\154\x74\x5f\x63\x6f\x73\164", "\x69\x6f\x6e\x5f\x61\165\164\150")]; goto MjxUS; case "\x61\162\147\157\x6e\x32": $params = $is_admin ? $this->config->item("\141\x72\x67\x6f\x6e\62\137\141\x64\x6d\151\x6e\137\x70\141\162\x61\x6d\163", "\151\x6f\x6e\137\x61\165\164\x68") : $this->config->item("\141\x72\x67\x6f\156\62\x5f\144\x65\146\141\x75\x6c\x74\137\160\141\x72\141\155\x73", "\151\157\x6e\x5f\141\x75\x74\150"); goto MjxUS; default: } goto sDVs7; T1Qfg: MjxUS: goto pmLe7; sDVs7: FKCCA: goto T1Qfg; HAw5u: if (!($user_id && $this->in_group($this->config->item("\141\144\155\151\x6e\x5f\147\162\157\165\x70", "\x69\157\x6e\x5f\x61\165\x74\x68"), $user_id))) { goto i9odu; } goto QlCq4; pmLe7: return $params; goto rHG_w; QlCq4: $is_admin = TRUE; goto prNlp; nlzPA: Omy8i: goto Gc03o; ogob1: if (!$identity) { goto Omy8i; } goto BUkeJ; BUkeJ: $user_id = $this->get_user_id_from_identity($identity); goto HAw5u; Gc03o: $params = FALSE; goto iaxyp; rHG_w: } protected function _get_hash_algo() { goto qZiyS; iLejD: Tuy2t: goto w6FXK; enGpB: return $algo; goto xqjQE; FeoWw: switch ($this->hash_method) { case "\142\x63\162\x79\x70\x74": $algo = PASSWORD_BCRYPT; goto l_ZfK; case "\x61\x72\147\x6f\x6e\x32": $algo = PASSWORD_ARGON2I; goto l_ZfK; default: } goto iLejD; w6FXK: l_ZfK: goto enGpB; qZiyS: $algo = FALSE; goto FeoWw; xqjQE: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto VHqXF; eVeIK: $validator_hashed = $this->hash_password($validator); goto Llz8m; Ro3FX: $validator = $this->_random_token($validator_size); goto eVeIK; ycC5b: return (object) ["\x73\145\x6c\x65\143\x74\x6f\x72" => $selector, "\x76\x61\x6c\x69\x64\x61\x74\157\162\137\x68\141\x73\150\x65\144" => $validator_hashed, "\x75\163\x65\162\x5f\143\x6f\x64\x65" => $user_code]; goto pgIVc; VHqXF: $selector = $this->_random_token($selector_size); goto Ro3FX; Llz8m: $user_code = "{$selector}\x2e{$validator}"; goto ycC5b; pgIVc: } protected function _retrieve_selector_validator_couple($user_code) { goto Jb8cU; OEvmT: return (object) ["\x73\x65\x6c\x65\143\x74\157\x72" => $tokens[0], "\x76\141\154\x69\144\x61\164\157\162" => $tokens[1]]; goto SN6an; ybozy: $tokens = explode("\x2e", $user_code); goto Y9kSE; l4vNa: return FALSE; goto tbXs6; SN6an: et3Y4: goto Z6xFi; Z6xFi: wcplF: goto l4vNa; Jb8cU: if (!$user_code) { goto wcplF; } goto ybozy; Y9kSE: if (!(count($tokens) === 2)) { goto et3Y4; } goto OEvmT; tbXs6: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto kjPL9; WF0wd: hmtE5: goto SZ1CQ; ClnRZ: HViBo: goto gZk0J; LLYMc: $salt_db = $query->row(); goto zfE12; Z0LC0: MRzmk: goto H7gLP; buCZe: goto HViBo; goto WF0wd; dGRA8: $this->trigger_events(["\x70\157\163\164\137\163\x68\141\x31\x5f\x70\x61\x73\x73\167\x6f\x72\x64\137\x6d\151\x67\162\141\164\x69\x6f\x6e", "\x70\x6f\x73\x74\x5f\163\x68\x61\x31\137\x70\x61\163\x73\x77\157\162\144\x5f\x6d\x69\x67\162\141\x74\151\x6f\x6e\x5f\x75\156\163\x75\143\x63\145\163\x73\x66\x75\x6c"]); goto p6dZa; SsaPh: if ($hashed_password === $hashed_password_db) { goto hmtE5; } goto dGRA8; ap78X: return FALSE; goto vz1UE; XTcO1: B4cmP: goto SsaPh; vz1UE: ZULF3: goto GY47Y; MM3OR: $salt_length = $this->config->item("\x73\141\154\164\x5f\154\145\156\147\164\150", "\x69\157\x6e\137\x61\x75\164\150"); goto lXiyv; cQNsv: $this->trigger_events(["\x70\157\163\164\x5f\x73\150\x61\x31\137\x70\141\x73\163\x77\x6f\x72\x64\x5f\x6d\x69\147\162\x61\164\x69\157\x6e", "\160\x6f\x73\x74\137\x73\150\x61\x31\x5f\160\x61\163\163\x77\157\x72\x64\137\155\151\147\162\141\164\x69\157\x6e\x5f\163\x75\x63\143\x65\163\x73\x66\165\x6c"]); goto gJnYJ; tq1uC: return FALSE; goto Z0LC0; SZ1CQ: $result = $this->_set_password_db($identity, $password); goto WSMOQ; lXiyv: if ($salt_length) { goto ZULF3; } goto MwB2U; atsad: $this->trigger_events(["\x70\157\163\164\137\163\150\x61\x31\x5f\x70\x61\x73\163\167\x6f\162\x64\x5f\155\x69\x67\162\x61\x74\x69\157\x6e", "\x70\157\163\164\137\x73\150\x61\61\137\160\x61\x73\x73\167\x6f\x72\144\x5f\155\151\147\x72\x61\x74\x69\157\156\x5f\165\156\x73\x75\x63\x63\x65\163\x73\x66\x75\154"]); goto Ezjd7; m2Kqi: $query = $this->db->select("\163\141\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\145\162\163"]); goto LLYMc; nQvgd: goto B4cmP; goto aI1Tr; H7gLP: $hashed_password = sha1($password . $salt_db->salt); goto XTcO1; jAKPi: return $result; goto ClnRZ; WSMOQ: if ($result) { goto kJdTS; } goto atsad; gJnYJ: ItGMG: goto jAKPi; zfE12: if (!($query->num_rows() !== 1)) { goto MRzmk; } goto Hm_Oq; MwB2U: $this->trigger_events(["\x70\x6f\163\164\x5f\163\150\141\61\137\160\x61\163\163\167\x6f\x72\144\137\155\151\x67\162\x61\164\151\157\156", "\160\x6f\x73\164\137\x73\150\141\x31\x5f\160\x61\163\163\x77\157\x72\x64\x5f\x6d\x69\x67\162\x61\164\x69\157\156\137\165\156\x73\165\x63\143\145\x73\x73\x66\x75\x6c"]); goto ap78X; Mdvrm: kJdTS: goto cQNsv; X3bSQ: if ($this->config->item("\x73\x74\x6f\x72\x65\x5f\163\141\154\164", "\x69\157\x6e\137\x61\x75\x74\150")) { goto hfGxT; } goto MM3OR; KPbvS: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto nQvgd; aI1Tr: hfGxT: goto m2Kqi; GY47Y: $salt = substr($hashed_password_db, 0, $salt_length); goto KPbvS; Ezjd7: goto ItGMG; goto Mdvrm; p6dZa: return FALSE; goto buCZe; Hm_Oq: $this->trigger_events(["\x70\x6f\x73\x74\137\x73\150\141\x31\x5f\x70\141\x73\x73\x77\x6f\x72\144\137\x6d\151\x67\x72\141\x74\x69\157\x6e", "\x70\157\163\x74\137\163\x68\x61\61\137\160\141\163\x73\167\157\x72\144\137\x6d\x69\x67\x72\141\164\151\157\156\x5f\x75\156\x73\x75\x63\143\145\163\x73\x66\165\154"]); goto tq1uC; kjPL9: $this->trigger_events("\x70\162\x65\x5f\163\x68\x61\x31\x5f\x70\141\x73\163\167\157\x72\144\137\155\151\147\162\141\164\x69\157\156"); goto X3bSQ; gZk0J: } }
