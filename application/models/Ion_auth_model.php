<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\x45\x50\x41\x54\x48") or exit("\x4e\157\40\x64\x69\162\145\143\x74\40\x73\143\x72\151\x70\x74\40\141\x63\x63\145\163\163\40\141\154\x6c\157\167\x65\x64"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto xMFhr; SaWBw: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\162\x6f\162\x5f\163\x75\x66\x66\151\170"); goto hY1_t; f2fMV: $group_name = $this->config->item("\x64\x61\x74\x61\x62\x61\x73\145\137\x67\162\x6f\165\x70\137\156\x61\155\x65", "\151\x6f\x6e\137\x61\x75\x74\150"); goto ZVb_0; MgRh1: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto brPz5; USmnH: $form_validation_class = new ReflectionClass("\x43\111\x5f\106\157\162\155\137\x76\141\x6c\151\x64\x61\164\151\x6f\x6e"); goto s_SsM; Uc4U1: $this->hash_method = $this->config->item("\x68\x61\x73\150\137\155\x65\x74\x68\x6f\144", "\151\157\156\x5f\x61\x75\164\x68"); goto zRVQ4; SN57_: $this->identity_column = $this->config->item("\151\x64\x65\156\x74\x69\x74\171", "\151\x6f\156\137\x61\x75\164\150"); goto jusCD; tS3k3: $this->load->helper("\144\x61\x74\x65"); goto iwdE1; brPz5: $this->message_start_delimiter = $this->error_start_delimiter; goto SaWBw; mTlek: $CI =& get_instance(); goto b4EFH; j_5Ci: QmozJ: goto mTlek; FdSU6: goto c5CQw; goto j_5Ci; F2bUX: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto r4nD9; r4nD9: $this->message_end_delimiter = $this->error_end_delimiter; goto tVDNC; cmLE4: $delimiters_source = $this->config->item("\x64\145\154\151\x6d\151\x74\145\162\x73\137\163\x6f\165\162\143\145", "\151\x6f\156\x5f\x61\x75\164\150"); goto GkgVZ; HY341: $this->tables = $this->config->item("\164\x61\142\154\x65\163", "\x69\157\156\137\x61\165\164\150"); goto SN57_; KWXY5: goto d0c6n; goto iz13V; iz13V: SABLY: goto VIrwT; yBn7U: $this->errors = []; goto cmLE4; Y6g1g: $this->error_end_delimiter = $this->config->item("\145\162\162\x6f\x72\137\x65\156\x64\x5f\144\145\x6c\x69\155\x69\x74\145\162", "\151\157\x6e\137\141\x75\x74\x68"); goto KWXY5; jusCD: $this->join = $this->config->item("\x6a\157\151\x6e", "\x69\x6f\156\137\x61\165\164\150"); goto Uc4U1; b4EFH: $this->db = $CI->db; goto VBT4S; GkgVZ: if ($delimiters_source === "\146\x6f\x72\x6d\x5f\166\141\154\x69\x64\x61\164\151\157\x6e") { goto SABLY; } goto CbhvR; Sz8yZ: $this->load->helper("\x63\157\157\153\151\x65"); goto tS3k3; iwdE1: $this->lang->load("\x69\157\156\137\x61\165\x74\x68"); goto f2fMV; VBT4S: c5CQw: goto HY341; DIW4k: $this->db = $this->load->database($group_name, TRUE, TRUE); goto FdSU6; xMFhr: $this->config->load("\151\x6f\156\137\141\x75\x74\x68", TRUE); goto Sz8yZ; s_SsM: $error_prefix = $form_validation_class->getProperty("\137\145\162\x72\157\x72\137\160\162\145\146\x69\x78"); goto YliBu; zRVQ4: $this->messages = []; goto yBn7U; QxdMB: $this->message_end_delimiter = $this->config->item("\155\x65\x73\163\x61\147\x65\x5f\x65\x6e\x64\137\144\x65\154\151\x6d\151\164\145\162", "\151\157\156\x5f\141\x75\164\150"); goto z70uu; YliBu: $error_prefix->setAccessible(TRUE); goto MgRh1; tVDNC: d0c6n: goto tt7_0; CbhvR: $this->message_start_delimiter = $this->config->item("\x6d\145\163\x73\141\x67\x65\x5f\163\x74\x61\x72\164\137\144\145\154\151\155\151\164\x65\162", "\151\x6f\156\137\141\x75\x74\150"); goto QxdMB; tt7_0: $this->_ion_hooks = new stdClass(); goto VQtHt; VQtHt: $this->trigger_events("\x6d\157\x64\x65\x6c\137\143\157\156\x73\164\x72\x75\143\164\x6f\x72"); goto bH89P; ZVb_0: if (empty($group_name)) { goto QmozJ; } goto DIW4k; z70uu: $this->error_start_delimiter = $this->config->item("\x65\162\162\x6f\x72\x5f\163\x74\x61\162\164\137\144\145\154\x69\x6d\151\x74\145\162", "\x69\157\156\137\x61\x75\164\150"); goto Y6g1g; VIrwT: $this->load->library("\146\157\x72\155\137\x76\141\154\151\x64\x61\164\x69\x6f\156"); goto USmnH; hY1_t: $error_suffix->setAccessible(TRUE); goto F2bUX; bH89P: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto OyxyU; CiIzF: return FALSE; goto WaiEd; aLQMY: if (!($algo !== FALSE && $params !== FALSE)) { goto ars6U; } goto exnd8; TYBNe: $params = $this->_get_hash_parameters($identity); goto aLQMY; evxLO: $algo = $this->_get_hash_algo(); goto TYBNe; iiqt2: yMdTk: goto evxLO; OyxyU: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto yMdTk; } goto kIgyB; vMITn: ars6U: goto CiIzF; exnd8: return password_hash($password, $algo, $params); goto vMITn; kIgyB: return FALSE; goto iiqt2; WaiEd: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto UipQT; jk305: return password_verify($password, $hash_password_db); goto mYrOL; mYrOL: O8ytk: goto dNM24; UfzgY: sRNZM: goto cIjn9; cIjn9: if (strpos($hash_password_db, "\44") === 0) { goto EVsLk; } goto k0sWM; lvFBV: goto O8ytk; goto uCzWd; UipQT: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto sRNZM; } goto ph01i; k0sWM: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto lvFBV; ph01i: return FALSE; goto UfzgY; uCzWd: EVsLk: goto jk305; dNM24: } public function rehash_password_if_needed($hash, $identity, $password) { goto zMDJm; pREm4: $this->trigger_events(["\x72\x65\x68\141\163\150\137\x70\x61\163\x73\x77\x6f\x72\x64", "\x72\x65\150\141\163\x68\137\160\x61\x73\163\x77\x6f\x72\144\x5f\165\x6e\163\165\x63\143\x65\163\x73\146\x75\154"]); goto noz2v; noz2v: goto Y3gHG; goto b0DVX; qqXb2: if (!($algo !== FALSE && $params !== FALSE)) { goto xFump; } goto cVdQb; b0DVX: h3Mmu: goto ulkJe; QJa5z: xFump: goto cs685; IY3P9: iDwAu: goto QJa5z; Wb1w1: if ($this->_set_password_db($identity, $password)) { goto h3Mmu; } goto pREm4; zMDJm: $algo = $this->_get_hash_algo(); goto idsA7; cVdQb: if (!password_needs_rehash($hash, $algo, $params)) { goto iDwAu; } goto Wb1w1; idsA7: $params = $this->_get_hash_parameters($identity); goto qqXb2; I6Stw: Y3gHG: goto IY3P9; ulkJe: $this->trigger_events(["\x72\x65\150\141\x73\150\x5f\x70\141\163\x73\x77\157\162\144", "\x72\x65\150\x61\x73\x68\x5f\x70\x61\x73\163\x77\x6f\162\x64\x5f\x73\165\x63\x63\145\163\x73\146\165\154"]); goto I6Stw; cs685: } public function get_user_by_activation_code($user_code) { goto djWrL; Eosn5: return $user; goto V5Yor; sAbQN: T5aYz: goto DSm9l; ASQXT: if (!$user) { goto T5aYz; } goto olv6q; V5Yor: AEr1x: goto sAbQN; DSm9l: return FALSE; goto xdlOL; KZFHv: $user = $this->where("\141\x63\x74\151\166\141\164\151\157\x6e\137\163\x65\154\145\143\164\157\x72", $token->selector)->users()->row(); goto ASQXT; djWrL: $token = $this->_retrieve_selector_validator_couple($user_code); goto KZFHv; olv6q: if (!$this->verify_password($token->validator, $user->activation_code)) { goto AEr1x; } goto Eosn5; xdlOL: } public function activate($id, $code = FALSE) { goto fBnbS; aHeLC: $data = ["\141\143\164\151\x76\x61\164\x69\157\156\x5f\x73\145\x6c\145\x63\164\x6f\x72" => NULL, "\x61\x63\x74\x69\166\x61\x74\x69\157\x6e\137\x63\x6f\x64\x65" => NULL, "\141\143\x74\151\x76\145" => 1]; goto ApvuO; GtvcL: if (!($code !== FALSE)) { goto UNN2J; } goto vG4kP; wzUW4: PKvHN: goto pUUA7; PhqLR: return TRUE; goto wzUW4; ApvuO: $this->trigger_events("\145\x78\x74\x72\141\137\x77\150\145\x72\x65"); goto biIpM; biIpM: $this->db->update($this->tables["\165\163\145\162\163"], $data, ["\x69\144" => $id]); goto OlTdC; chwYt: $this->set_error("\x61\x63\x74\x69\166\x61\x74\145\137\x75\156\x73\x75\x63\x63\145\x73\x73\x66\165\154"); goto G6uDk; vG4kP: $user = $this->get_user_by_activation_code($code); goto fjVbE; pUUA7: Y23wW: goto kzXlb; iKNCF: $this->trigger_events(["\160\157\x73\164\137\141\x63\x74\x69\166\141\164\145", "\x70\157\163\x74\137\141\143\164\x69\166\x61\164\x65\137\x73\165\x63\x63\x65\x73\x73\x66\x75\154"]); goto s7eJe; OlTdC: if (!($this->db->affected_rows() === 1)) { goto PKvHN; } goto iKNCF; s7eJe: $this->set_message("\141\x63\x74\x69\166\x61\x74\145\137\x73\165\x63\143\145\163\x73\146\165\154"); goto PhqLR; fjVbE: UNN2J: goto fjled; fjled: if (!($code === FALSE || $user && $user->id === $id)) { goto Y23wW; } goto aHeLC; kzXlb: $this->trigger_events(["\160\157\163\164\137\x61\x63\164\151\166\x61\x74\x65", "\x70\157\163\164\137\141\143\x74\151\166\141\164\145\x5f\x75\156\163\x75\143\143\145\x73\163\x66\165\x6c"]); goto chwYt; G6uDk: return FALSE; goto UYnG7; fBnbS: $this->trigger_events("\160\162\x65\137\x61\143\164\x69\166\x61\x74\x65"); goto GtvcL; UYnG7: } public function deactivate($id = NULL) { goto KDKgn; K_APV: jrnx9: goto Zquw5; MFc4K: $this->activation_code = $token->user_code; goto curSb; S0grL: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto kcVn4; } goto NeI36; P1uSP: $return = $this->db->affected_rows() == 1; goto Z_Xts; curSb: $data = ["\x61\143\164\x69\166\x61\x74\x69\x6f\x6e\x5f\163\x65\x6c\145\143\164\157\162" => $token->selector, "\x61\143\164\x69\x76\141\x74\x69\157\x6e\x5f\x63\157\x64\x65" => $token->validator_hashed, "\141\x63\x74\151\x76\x65" => 0]; goto Mcybj; h2r0x: goto V3JQj; goto YHymi; m3y1u: kcVn4: goto wtkcU; DUliW: return $return; goto MoOIh; Um2TW: return FALSE; goto pMYMv; Zquw5: $this->set_error("\x64\x65\141\143\164\151\x76\x61\x74\x65\137\x75\156\x73\165\x63\143\145\x73\x73\146\x75\x6c"); goto Um2TW; ftbrP: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, ["\151\x64" => $id]); goto P1uSP; wtkcU: goto zCNHw; goto K_APV; Vc50C: if (!isset($id)) { goto jrnx9; } goto S0grL; Mcybj: $this->trigger_events("\x65\x78\x74\162\x61\x5f\x77\150\x65\162\145"); goto ftbrP; Z_Xts: if ($return) { goto h8JSF; } goto xS4Wr; KDKgn: $this->trigger_events("\x64\145\141\143\164\x69\x76\141\x74\x65"); goto Vc50C; xNgUL: V3JQj: goto DUliW; pjKU6: return FALSE; goto m3y1u; QKqLM: $token = $this->_generate_selector_validator_couple(20, 40); goto MFc4K; xS4Wr: $this->set_error("\144\x65\141\143\164\151\x76\x61\x74\145\x5f\165\x6e\x73\x75\143\143\x65\x73\163\146\165\x6c"); goto h2r0x; pMYMv: zCNHw: goto QKqLM; NeI36: $this->set_error("\x64\x65\x61\x63\164\151\x76\141\164\x65\x5f\x63\x75\x72\x72\145\156\x74\x5f\x75\163\145\x72\137\165\x6e\x73\165\143\x63\145\x73\163\x66\165\154"); goto pjKU6; pvxzc: $this->set_message("\144\145\x61\x63\164\151\166\x61\x74\x65\x5f\163\165\x63\x63\x65\x73\x73\146\x75\154"); goto xNgUL; YHymi: h8JSF: goto pvxzc; MoOIh: } public function clear_forgotten_password_code($identity) { goto Sal2M; BaWjc: OerCT: goto wyM3Z; wyM3Z: $data = ["\146\x6f\x72\147\x6f\164\164\145\156\x5f\x70\x61\163\x73\x77\157\162\x64\x5f\x73\x65\154\145\x63\164\157\162" => NULL, "\146\x6f\162\147\157\164\164\x65\x6e\x5f\x70\141\163\163\167\157\x72\x64\x5f\x63\157\144\x65" => NULL, "\146\x6f\162\147\157\x74\x74\x65\156\x5f\x70\x61\163\163\167\x6f\x72\x64\137\x74\151\155\145" => NULL]; goto lmRC7; lmRC7: $this->db->update($this->tables["\x75\163\145\x72\x73"], $data, [$this->identity_column => $identity]); goto crMTu; Sal2M: if (!empty($identity)) { goto OerCT; } goto jfGE3; jfGE3: return FALSE; goto BaWjc; crMTu: return TRUE; goto cLrOd; cLrOd: } public function clear_remember_code($identity) { goto Lqgfy; XQ3R9: $data = ["\162\x65\155\145\x6d\x62\145\162\x5f\x73\x65\154\x65\x63\164\x6f\x72" => NULL, "\x72\145\155\145\155\142\145\162\137\x63\157\144\145" => NULL]; goto DlEuj; DlEuj: $this->db->update($this->tables["\165\x73\x65\x72\163"], $data, [$this->identity_column => $identity]); goto G1uUV; Lqgfy: if (!empty($identity)) { goto eS1Cy; } goto Gw7iu; G1uUV: return TRUE; goto nXvyo; YQ7qf: eS1Cy: goto XQ3R9; Gw7iu: return FALSE; goto YQ7qf; nXvyo: } public function reset_password($identity, $new) { goto JDpO_; jcm3u: tru59: goto QxGzE; aIdnu: jrAmV: goto zMRPG; qv65d: $this->trigger_events(["\160\x6f\x73\164\137\x63\150\141\x6e\147\145\137\x70\x61\163\x73\167\157\162\x64", "\160\157\163\164\137\x63\150\141\x6e\x67\x65\137\x70\141\163\x73\x77\157\x72\x64\137\x75\156\163\165\143\143\145\x73\163\146\165\x6c"]); goto VJh4g; iuxlB: if ($return) { goto nwpWr; } goto R6g_M; kqTUh: goto tru59; goto zUUOj; R6g_M: $this->trigger_events(["\x70\157\x73\x74\x5f\x63\x68\141\156\x67\145\x5f\x70\x61\163\163\167\157\162\x64", "\160\157\x73\x74\x5f\x63\150\141\156\x67\145\137\160\x61\x73\x73\x77\x6f\x72\x64\x5f\x75\156\163\165\143\x63\145\x73\x73\x66\x75\x6c"]); goto lwoXW; VJh4g: return FALSE; goto aIdnu; vHZbv: if ($this->identity_check($identity)) { goto jrAmV; } goto qv65d; lwoXW: $this->set_error("\x70\x61\x73\163\167\x6f\x72\144\137\x63\x68\141\x6e\147\x65\137\165\156\x73\165\x63\143\145\x73\x73\x66\x75\154"); goto kqTUh; QxGzE: return $return; goto IdgRr; MFzfF: $this->set_message("\160\x61\163\x73\167\x6f\162\x64\x5f\x63\x68\141\156\x67\x65\137\163\165\143\143\145\x73\x73\146\x75\154"); goto jcm3u; zUUOj: nwpWr: goto BQGt2; zMRPG: $return = $this->_set_password_db($identity, $new); goto iuxlB; BQGt2: $this->trigger_events(["\x70\157\x73\164\x5f\143\x68\141\156\x67\x65\x5f\x70\141\163\x73\167\x6f\162\x64", "\x70\x6f\x73\x74\x5f\143\150\x61\156\x67\x65\x5f\160\x61\x73\163\167\x6f\162\144\137\163\x75\143\x63\145\x73\163\x66\165\154"]); goto MFzfF; JDpO_: $this->trigger_events("\x70\162\x65\137\143\x68\x61\156\x67\145\x5f\160\141\163\x73\167\x6f\x72\x64"); goto vHZbv; IdgRr: } public function change_password($identity, $old, $new) { goto pQwMj; HXeKN: return FALSE; goto syGJN; IW9Yu: eMRST: goto dWyDq; gmCP4: $this->trigger_events("\x65\x78\x74\162\141\137\167\x68\x65\162\145"); goto G2H1U; H3TL2: $this->trigger_events(["\x70\x6f\x73\x74\137\143\x68\x61\156\x67\145\x5f\x70\141\x73\x73\x77\157\x72\x64", "\160\157\x73\x74\137\x63\x68\141\156\x67\x65\137\160\141\163\x73\167\x6f\162\x64\x5f\163\165\143\143\145\x73\x73\146\165\x6c"]); goto Nc4jD; M4M2s: uplc8: goto H3TL2; MsiMx: goto eMRST; goto M4M2s; kyBaX: return FALSE; goto tjl9e; tjl9e: cBrOH: goto pybUP; lGIKE: $this->set_error("\160\141\163\163\x77\157\x72\144\137\x63\150\141\x6e\x67\x65\137\165\156\163\x75\x63\x63\145\x73\x73\x66\x75\154"); goto HXeKN; xfRE_: if ($result) { goto uplc8; } goto jGJqf; Fd__y: if (!$this->verify_password($old, $user->password, $identity)) { goto L50RU; } goto eWaTU; pybUP: $user = $query->row(); goto Fd__y; YeLqH: if (!($query->num_rows() !== 1)) { goto cBrOH; } goto U8qu6; fdP1S: L50RU: goto lGIKE; U8qu6: $this->trigger_events(["\x70\x6f\x73\x74\137\x63\150\141\156\x67\145\137\160\141\x73\x73\x77\157\162\x64", "\x70\157\163\x74\x5f\x63\150\x61\156\147\x65\x5f\160\141\163\x73\x77\157\162\x64\x5f\165\x6e\x73\165\x63\x63\x65\163\163\146\165\154"]); goto ztTEy; Nc4jD: $this->set_message("\x70\x61\163\163\167\x6f\x72\144\137\143\x68\x61\x6e\x67\145\137\x73\x75\x63\143\x65\163\x73\146\165\x6c"); goto IW9Yu; jGJqf: $this->trigger_events(["\160\157\163\x74\137\143\x68\141\156\147\145\x5f\160\x61\x73\x73\167\x6f\162\144", "\x70\x6f\163\x74\x5f\143\x68\141\156\147\145\137\x70\141\x73\x73\x77\x6f\x72\x64\x5f\x75\156\163\x75\x63\143\145\163\163\146\165\154"]); goto bIsfE; ztTEy: $this->set_error("\160\141\163\163\167\157\162\x64\137\x63\150\x61\156\147\145\x5f\165\x6e\x73\165\x63\x63\x65\x73\163\x66\165\x6c"); goto kyBaX; bIsfE: $this->set_error("\x70\141\x73\163\167\x6f\162\144\x5f\x63\x68\x61\x6e\x67\x65\x5f\165\156\163\x75\143\143\145\x73\x73\146\x75\x6c"); goto MsiMx; G2H1U: $query = $this->db->select("\151\144\54\40\x70\x61\163\x73\x77\157\x72\x64")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\x73\143")->get($this->tables["\x75\163\145\162\x73"]); goto YeLqH; pQwMj: $this->trigger_events("\x70\x72\x65\x5f\x63\x68\x61\156\x67\x65\x5f\x70\141\x73\x73\x77\x6f\x72\x64"); goto gmCP4; dWyDq: return $result; goto fdP1S; eWaTU: $result = $this->_set_password_db($identity, $new); goto xfRE_; syGJN: } public function username_check($username = '') { goto aMI6O; wQSHm: return FALSE; goto n13Hy; n13Hy: MECme: goto H5pB0; aMI6O: $this->trigger_events("\165\163\145\162\156\141\x6d\x65\137\143\150\x65\x63\153"); goto tXvJg; H5pB0: $this->trigger_events("\x65\x78\x74\x72\x61\x5f\167\x68\x65\x72\x65"); goto PCIWN; PCIWN: return $this->db->where("\x75\163\145\162\156\141\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\x73"]) > 0; goto bUxqG; tXvJg: if (!empty($username)) { goto MECme; } goto wQSHm; bUxqG: } public function email_check($email = '') { goto CeeGV; kOM0p: KLps8: goto FV4zo; ODY60: if (!empty($email)) { goto KLps8; } goto xTR4L; xTR4L: return FALSE; goto kOM0p; LVAPJ: return $this->db->where("\145\x6d\x61\x69\154", $email)->limit(1)->count_all_results($this->tables["\165\163\145\x72\x73"]) > 0; goto QG4t3; CeeGV: $this->trigger_events("\x65\x6d\x61\151\x6c\x5f\x63\x68\x65\x63\x6b"); goto ODY60; FV4zo: $this->trigger_events("\145\x78\x74\162\x61\x5f\x77\150\x65\x72\x65"); goto LVAPJ; QG4t3: } public function identity_check($identity = '') { goto JHxv7; nTXgL: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\x73"]) > 0; goto ruXtE; GJpiu: return FALSE; goto AYV3X; j2nN6: if (!empty($identity)) { goto vqTot; } goto GJpiu; AYV3X: vqTot: goto nTXgL; JHxv7: $this->trigger_events("\151\144\x65\x6e\x74\x69\164\171\137\143\150\x65\143\x6b"); goto j2nN6; ruXtE: } public function get_user_id_from_identity($identity = '') { goto HKnUZ; xFlG9: return FALSE; goto RPgeK; x8XvZ: return FALSE; goto XvYVh; RPgeK: p_hXb: goto ahWQ7; mCiuv: $query = $this->db->select("\151\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\x65\162\x73"]); goto FDERe; HI9VM: return $user->id; goto KyZCP; ahWQ7: $user = $query->row(); goto HI9VM; HKnUZ: if (!empty($identity)) { goto y2GNs; } goto x8XvZ; FDERe: if (!($query->num_rows() !== 1)) { goto p_hXb; } goto xFlG9; XvYVh: y2GNs: goto mCiuv; KyZCP: } public function forgotten_password($identity) { goto cPMUn; pJeJ2: $this->trigger_events(["\x70\x6f\163\x74\x5f\146\x6f\162\x67\157\x74\164\x65\x6e\137\160\141\163\x73\x77\157\x72\x64", "\160\157\x73\164\x5f\146\x6f\162\x67\157\164\x74\145\x6e\x5f\x70\141\x73\163\x77\157\162\x64\137\165\x6e\x73\x75\143\143\145\x73\163\x66\x75\x6c"]); goto rD79M; kpjBT: goto me5dx; goto hRsAl; rD79M: return FALSE; goto kpjBT; zuqI9: me5dx: goto qTZGh; Ptel5: if ($this->db->affected_rows() === 1) { goto KU3ta; } goto pJeJ2; ybUsS: return FALSE; goto PQ0dl; PQ0dl: jGIlI: goto GqWEB; cPMUn: if (!empty($identity)) { goto jGIlI; } goto RTT1j; q73nH: $this->trigger_events("\145\x78\164\x72\141\x5f\167\150\x65\162\145"); goto Nl2if; RTT1j: $this->trigger_events(["\160\x6f\x73\164\x5f\x66\157\162\x67\157\164\164\145\156\x5f\160\x61\x73\x73\167\x6f\162\x64", "\160\x6f\163\x74\x5f\x66\x6f\162\x67\157\x74\164\x65\156\x5f\x70\x61\163\x73\x77\x6f\162\144\137\165\x6e\x73\x75\143\x63\145\163\x73\146\x75\x6c"]); goto ybUsS; Nl2if: $this->db->update($this->tables["\165\163\x65\162\x73"], $update, [$this->identity_column => $identity]); goto Ptel5; GqWEB: $token = $this->_generate_selector_validator_couple(20, 80); goto BHUOL; MKoBI: return $token->user_code; goto zuqI9; nRGC_: $this->trigger_events(["\x70\x6f\163\x74\137\x66\x6f\162\x67\157\164\164\145\156\x5f\160\141\163\x73\167\157\x72\144", "\160\157\163\x74\137\146\157\x72\x67\157\x74\164\x65\156\137\160\141\163\163\167\x6f\x72\144\137\163\165\143\143\x65\163\163\x66\165\x6c"]); goto MKoBI; hRsAl: KU3ta: goto nRGC_; BHUOL: $update = ["\x66\157\162\x67\x6f\x74\x74\x65\156\137\x70\x61\163\163\x77\157\162\144\x5f\163\x65\x6c\145\x63\164\157\162" => $token->selector, "\x66\157\162\147\x6f\164\x74\x65\156\x5f\x70\x61\x73\x73\167\157\162\x64\x5f\x63\157\x64\x65" => $token->validator_hashed, "\x66\x6f\x72\x67\157\x74\164\x65\156\x5f\160\x61\163\x73\x77\157\x72\144\x5f\x74\x69\155\x65" => time()]; goto q73nH; qTZGh: } public function get_user_by_forgotten_password_code($user_code) { goto dkk8w; na0xK: $user = $this->where("\x66\x6f\162\x67\157\x74\164\x65\x6e\137\160\141\x73\x73\x77\157\x72\144\x5f\163\x65\154\145\143\x74\157\162", $token->selector)->users()->row(); goto mPLzJ; iFe0w: return FALSE; goto hr8zI; gZddT: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto NJtM7; } goto tq8Ja; tq8Ja: return $user; goto aJMFS; dkk8w: $token = $this->_retrieve_selector_validator_couple($user_code); goto na0xK; aJMFS: NJtM7: goto Bb43_; Bb43_: Nc4Od: goto iFe0w; mPLzJ: if (!$user) { goto Nc4Od; } goto gZddT; hr8zI: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto DRylO; TBtRx: $query = $this->db->get_where($this->tables["\x67\x72\x6f\165\160\x73"], ["\156\141\155\x65" => $this->config->item("\144\x65\146\141\165\x6c\x74\137\147\x72\x6f\165\160", "\151\157\x6e\137\x61\165\164\x68")], 1)->row(); goto jmfQ_; jjST4: return FALSE; goto RD36A; zB01s: $password = $this->hash_password($password); goto sOq0F; KgF60: $manual_activation = $this->config->item("\155\x61\x6e\165\x61\x6c\137\141\x63\x74\x69\x76\141\164\x69\157\x6e", "\151\x6f\x6e\137\x61\x75\x74\x68"); goto kpywr; sOq0F: if (!($password === FALSE)) { goto yn5qL; } goto D0YJv; jwIkA: $this->db->insert($this->tables["\165\x73\145\162\163"], $user_data); goto tUNUB; K3OV0: if (!(isset($default_group->id) && empty($groups))) { goto ILeFj; } goto C1xut; vuY3a: $data = [$this->identity_column => $identity, "\x75\163\145\162\156\141\155\145" => $identity, "\x70\x61\x73\163\167\157\162\144" => $password, "\145\155\141\x69\154" => $email, "\151\160\x5f\141\144\144\162\145\163\163" => $ip_address, "\143\162\145\x61\x74\x65\x64\137\157\156" => time(), "\141\x63\x74\x69\166\145" => $manual_activation === FALSE ? 1 : 0]; goto wyFec; Gg6Hw: if (empty($groups)) { goto pCWWF; } goto jQsnB; C4v9c: if (!(!$this->config->item("\x64\145\146\x61\165\154\164\x5f\147\x72\157\165\160", "\151\157\156\137\x61\x75\x74\x68") && empty($groups))) { goto TAeML; } goto oRBkw; ulB27: wBPqY: goto dCgZM; Y1kXQ: $default_group = $query; goto bU_R8; PjtnF: $this->set_error("\141\143\x63\x6f\x75\156\164\137\x63\x72\x65\x61\x74\x69\157\156\x5f\151\156\166\141\x6c\x69\x64\x5f\144\145\x66\141\x75\x6c\x74\137\147\162\157\x75\x70"); goto MJlVD; PwKcT: yn5qL: goto vuY3a; oRBkw: $this->set_error("\141\x63\143\157\x75\156\164\137\143\x72\145\x61\x74\x69\157\156\137\x6d\x69\x73\x73\x69\156\x67\137\x64\x65\x66\x61\165\x6c\164\x5f\147\x72\157\165\160"); goto wJdTe; p8Oh8: goto iD8Qk; goto ulB27; ygIev: return isset($id) ? $id : FALSE; goto jAe1d; kpywr: if ($this->identity_check($identity)) { goto wBPqY; } goto C4v9c; dCgZM: $this->set_error("\x61\x63\143\157\x75\156\164\x5f\143\x72\x65\141\x74\x69\x6f\x6e\137\144\x75\160\x6c\151\x63\x61\164\x65\x5f\x69\x64\x65\x6e\164\x69\x74\171"); goto jjST4; MJlVD: return FALSE; goto UPYoy; UPYoy: SELl_: goto Y1kXQ; DRylO: $this->trigger_events("\160\162\x65\x5f\162\x65\x67\151\163\164\145\x72"); goto KgF60; jQsnB: foreach ($groups as $group) { $this->add_to_group($group, $id); icr8v: } goto CsYSU; bU_R8: $ip_address = $this->input->ip_address(); goto zB01s; BcgYx: TAeML: goto p8Oh8; RD36A: iD8Qk: goto TBtRx; D0YJv: $this->set_error("\141\x63\143\x6f\x75\x6e\x74\x5f\x63\162\x65\141\x74\151\157\156\x5f\x75\156\x73\x75\x63\x63\145\163\x73\146\165\x6c"); goto zajOV; wJdTe: return FALSE; goto BcgYx; wyFec: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\x65\162\163"], $additional_data), $data); goto Afgpw; tUNUB: $id = $this->db->insert_id($this->tables["\x75\x73\x65\x72\163"] . "\137\151\144\137\163\145\161"); goto K3OV0; Afgpw: $this->trigger_events("\145\170\x74\x72\141\x5f\x73\x65\x74"); goto jwIkA; XLEwU: ILeFj: goto Gg6Hw; jmfQ_: if (!(!isset($query->id) && empty($groups))) { goto SELl_; } goto PjtnF; C1xut: $groups[] = $default_group->id; goto XLEwU; VsCaq: $this->trigger_events("\160\157\163\x74\x5f\x72\x65\x67\151\163\164\x65\162"); goto ygIev; Y4bYj: pCWWF: goto VsCaq; CsYSU: gdHzK: goto Y4bYj; zajOV: return FALSE; goto PwKcT; jAe1d: } public function login($identity, $password, $remember = FALSE) { goto WUlRO; WpIx9: $this->set_error("\154\x6f\147\x69\156\x5f\x75\156\163\165\x63\x63\145\x73\163\146\x75\x6c\x5f\156\157\x74\137\141\143\164\x69\166\x65"); goto EystX; u_PTa: if (!$this->config->item("\162\145\155\145\x6d\x62\145\162\137\x75\163\145\162\163", "\x69\157\x6e\137\141\165\x74\x68")) { goto qCWAQ; } goto BhXje; WUlRO: $this->trigger_events("\160\x72\x65\x5f\154\x6f\x67\x69\x6e"); goto d9Iq6; i3IzJ: DPM2U: goto mkgSt; xSmhl: $this->trigger_events("\x70\x6f\x73\x74\137\x6c\x6f\x67\151\x6e\x5f\165\x6e\x73\165\143\143\145\163\x73\146\165\x6c"); goto WpIx9; LJTSM: $this->clear_login_attempts($identity); goto PxRrH; d9Iq6: if (!(empty($identity) || empty($password))) { goto PrdfQ; } goto xnwM7; EFRbL: PrdfQ: goto CICuV; MG2_r: CoKap: goto opp9M; JCywf: $this->set_message("\x6c\x6f\147\151\x6e\137\163\165\143\143\x65\x73\x73\146\165\x6c"); goto t2y6a; jcKj6: $this->hash_password($password); goto MHuVs; EystX: return FALSE; goto MG2_r; BhXje: if ($remember) { goto epWUk; } goto HpDKe; OyngN: if (!($query->num_rows() === 1)) { goto pWkvH; } goto Izgn4; PxRrH: $this->clear_forgotten_password_code($identity); goto u_PTa; QLZ0m: if (!$this->verify_password($password, $user->password, $identity)) { goto DPM2U; } goto BcXyW; BpRL0: return FALSE; goto MQaQH; BcXyW: if (!($user->active == 0)) { goto CoKap; } goto xSmhl; T0l1T: $this->remember_user($identity); goto LpQB3; HpDKe: $this->clear_remember_code($identity); goto cJy5F; dwMOh: $this->set_error("\x6c\157\147\x69\x6e\137\165\x6e\163\165\x63\143\x65\x73\x73\x66\165\154"); goto T0Tz_; opp9M: $this->set_session($user); goto CgkhJ; CICuV: $this->trigger_events("\x65\x78\x74\162\141\137\x77\150\145\x72\145"); goto eQErz; cJy5F: goto clZLw; goto MwRt0; T0Tz_: return FALSE; goto gY3st; NrINz: $this->hash_password($password); goto IuTVs; CgkhJ: $this->update_last_login($user->id); goto LJTSM; t2y6a: return TRUE; goto i3IzJ; IuTVs: $this->trigger_events("\x70\x6f\163\164\137\154\157\x67\151\x6e\137\x75\156\163\x75\143\143\145\x73\163\x66\165\x6c"); goto cY02X; xnwM7: $this->set_error("\x6c\x6f\147\x69\x6e\137\165\156\163\165\143\x63\x65\163\x73\146\165\x6c"); goto b_mK1; MQaQH: o36Sf: goto OyngN; LpQB3: clZLw: goto YDbdw; wsKXT: $this->trigger_events(["\x70\x6f\163\x74\137\154\x6f\147\x69\x6e", "\160\157\163\x74\137\154\x6f\147\x69\156\137\x73\165\143\x63\145\x73\x73\x66\x75\x6c"]); goto JCywf; MHuVs: $this->increase_login_attempts($identity); goto gKgN2; q1901: $this->rehash_password_if_needed($user->password, $identity, $password); goto yz_k1; MwRt0: epWUk: goto T0l1T; eQErz: $query = $this->db->select($this->identity_column . "\x2c\40\145\155\x61\x69\154\x2c\x20\151\144\54\40\x70\141\163\163\167\157\x72\x64\54\40\141\143\164\151\x76\145\x2c\x20\154\x61\163\x74\137\x6c\x6f\147\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\x73\x63")->get($this->tables["\165\163\x65\x72\163"]); goto CgX6q; mkgSt: pWkvH: goto jcKj6; gKgN2: $this->trigger_events("\x70\157\163\x74\137\154\157\x67\151\156\x5f\165\156\x73\165\x63\x63\145\163\x73\x66\165\x6c"); goto dwMOh; YDbdw: qCWAQ: goto q1901; cY02X: $this->set_error("\x6c\x6f\x67\x69\x6e\x5f\164\151\x6d\145\157\x75\x74"); goto BpRL0; CgX6q: if (!$this->is_max_login_attempts_exceeded($identity)) { goto o36Sf; } goto NrINz; Izgn4: $user = $query->row(); goto QLZ0m; yz_k1: $this->session->sess_regenerate(FALSE); goto wsKXT; b_mK1: return FALSE; goto EFRbL; gY3st: } public function recheck_session() { goto UKj4q; rAmMd: Dwv_C: goto kAazv; kAazv: CBq1L: goto WEzgW; I0m4_: goto jd8qQ; goto csidy; W_x15: jd8qQ: goto rAmMd; csidy: Ef3nc: goto m1QAl; x6VRF: if (!($last_login + $recheck < time())) { goto Dwv_C; } goto qODem; orq2b: if ($query->num_rows() === 1) { goto Ef3nc; } goto l4jCi; qODem: $query = $this->db->select("\151\144")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\156\164\x69\164\171"), "\141\x63\164\151\x76\145" => "\x31"])->limit(1)->order_by("\x69\144", "\144\x65\x73\x63")->get($this->tables["\x75\x73\145\162\163"]); goto orq2b; m1QAl: $this->session->set_userdata("\x6c\141\163\x74\137\143\150\x65\143\153", time()); goto W_x15; O6R2j: $identity = $this->config->item("\151\144\x65\x6e\x74\151\x74\x79", "\151\157\x6e\137\x61\165\x74\x68"); goto JZ0IH; fwHs4: $last_login = $this->session->userdata("\x6c\141\163\164\137\x63\150\x65\143\153"); goto x6VRF; plhOm: return FALSE; goto I0m4_; WEzgW: return (bool) $this->session->userdata("\x69\x64\145\x6e\164\x69\164\x79"); goto MO2KF; UKj4q: $recheck = NULL !== $this->config->item("\162\145\143\150\x65\143\153\x5f\164\151\x6d\145\x72", "\151\157\x6e\137\141\165\x74\150") ? $this->config->item("\162\145\x63\x68\145\x63\x6b\137\164\151\x6d\145\162", "\151\157\x6e\137\x61\x75\164\150") : 0; goto YKkpl; JZ0IH: $this->session->unset_userdata([$identity, "\151\144", "\x75\163\x65\162\137\x69\x64"]); goto plhOm; l4jCi: $this->trigger_events("\154\x6f\147\x6f\x75\164"); goto O6R2j; YKkpl: if (!($recheck !== 0)) { goto CBq1L; } goto fwHs4; MO2KF: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto KFfmF; P9NeP: BfaxG: goto voJxH; KFfmF: if (!$this->config->item("\164\162\x61\x63\x6b\x5f\x6c\x6f\x67\151\x6e\x5f\141\164\x74\145\155\x70\x74\163", "\x69\157\156\x5f\x61\x75\x74\x68")) { goto BfaxG; } goto NIRR5; bMf8Y: $attempts = $this->get_attempts_num($identity, $ip_address); goto P1QKN; NIRR5: $max_attempts = $this->config->item("\x6d\141\x78\x69\155\165\x6d\137\154\157\147\151\x6e\x5f\141\x74\164\145\x6d\160\x74\x73", "\x69\x6f\156\x5f\x61\165\x74\x68"); goto VWlE0; voJxH: return FALSE; goto fsz2a; P1QKN: return $attempts >= $max_attempts; goto Ynezz; Ynezz: RYLSg: goto P9NeP; VWlE0: if (!($max_attempts > 0)) { goto RYLSg; } goto bMf8Y; fsz2a: } public function get_attempts_num($identity, $ip_address = NULL) { goto YIw06; wF93S: $ip_address = $this->input->ip_address(); goto fux33; p2_id: bKwim: goto zYmcT; scLNZ: if (isset($ip_address)) { goto LUODr; } goto wF93S; qzsMA: return $qres->num_rows(); goto p2_id; C6kel: $this->db->where("\154\157\x67\x69\x6e", $identity); goto gflfU; jTjZW: iin_u: goto vNaOT; fux33: LUODr: goto HM2kg; vNaOT: $this->db->where("\x74\151\x6d\145\x20\x3e", time() - $this->config->item("\154\x6f\x63\153\157\x75\164\x5f\x74\x69\155\145", "\x69\157\156\x5f\141\x75\x74\x68"), FALSE); goto jkAk5; jkAk5: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\x6e\137\141\164\x74\x65\155\x70\164\x73"]); goto qzsMA; gflfU: if (!$this->config->item("\164\162\x61\x63\x6b\137\154\x6f\x67\151\x6e\137\151\x70\137\141\x64\144\162\x65\163\x73", "\x69\x6f\x6e\x5f\x61\x75\164\x68")) { goto iin_u; } goto scLNZ; YIw06: if (!$this->config->item("\x74\x72\x61\x63\153\x5f\x6c\x6f\x67\151\156\x5f\141\164\164\x65\155\x70\x74\x73", "\x69\x6f\156\x5f\x61\x75\x74\150")) { goto bKwim; } goto Lz32g; Lz32g: $this->db->select("\x31", FALSE); goto C6kel; HM2kg: $this->db->where("\151\160\x5f\141\x64\x64\162\x65\163\x73", $ip_address); goto jTjZW; zYmcT: return 0; goto bPpK4; bPpK4: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto w896w; SdJPo: soES6: goto pUAPX; eY5Zj: return $qres->row()->time; goto Y13mN; LDd0E: if (isset($ip_address)) { goto W13Bw; } goto Y2Wrq; ZAGqu: if (!$this->config->item("\x74\162\141\x63\x6b\137\154\x6f\x67\x69\x6e\x5f\x69\160\137\141\144\144\x72\145\x73\x73", "\151\x6f\x6e\137\x61\x75\164\x68")) { goto soES6; } goto LDd0E; w896w: if (!$this->config->item("\164\162\141\x63\x6b\137\154\x6f\x67\151\x6e\x5f\x61\164\164\x65\x6d\x70\164\163", "\151\x6f\156\x5f\141\165\x74\150")) { goto CwJnG; } goto dWdXl; ZF4rl: CwJnG: goto a03vZ; xFcy5: $this->db->where("\154\157\147\x69\x6e", $identity); goto ZAGqu; a03vZ: return 0; goto q0zpQ; JpM0r: $qres = $this->db->get($this->tables["\154\x6f\x67\x69\156\137\141\164\164\x65\x6d\x70\x74\163"], 1); goto g3IOw; Y13mN: NmXnx: goto ZF4rl; lF9MR: W13Bw: goto r5qAB; r5qAB: $this->db->where("\151\160\x5f\x61\144\x64\x72\x65\163\x73", $ip_address); goto SdJPo; pUAPX: $this->db->order_by("\x69\x64", "\x64\145\163\x63"); goto JpM0r; dWdXl: $this->db->select("\x74\151\x6d\145"); goto xFcy5; g3IOw: if (!($qres->num_rows() > 0)) { goto NmXnx; } goto eY5Zj; Y2Wrq: $ip_address = $this->input->ip_address(); goto lF9MR; q0zpQ: } public function get_last_attempt_ip($identity) { goto ANjWU; rSG9V: if (!($qres->num_rows() > 0)) { goto eczPz; } goto I7sAq; C6Pli: eczPz: goto ETtUE; xcxEW: $this->db->select("\x69\x70\137\141\144\144\162\145\x73\163"); goto ORm2Y; ANjWU: if (!($this->config->item("\x74\x72\141\143\153\x5f\x6c\x6f\x67\151\x6e\x5f\x61\x74\x74\145\x6d\x70\164\x73", "\151\157\156\137\x61\165\164\x68") && $this->config->item("\164\x72\x61\143\153\x5f\154\x6f\147\x69\156\x5f\x69\160\137\x61\144\144\x72\145\163\x73", "\x69\157\x6e\x5f\141\165\x74\x68"))) { goto mjU0N; } goto xcxEW; MWaim: $this->db->order_by("\x69\x64", "\x64\x65\x73\143"); goto udMAw; TBMEi: return ''; goto e07AH; I7sAq: return $qres->row()->ip_address; goto C6Pli; ETtUE: mjU0N: goto TBMEi; ORm2Y: $this->db->where("\154\157\x67\151\x6e", $identity); goto MWaim; udMAw: $qres = $this->db->get($this->tables["\154\157\147\151\x6e\x5f\141\x74\164\145\x6d\160\164\x73"], 1); goto rSG9V; e07AH: } public function increase_login_attempts($identity) { goto MoEdb; j7AdN: $data["\x69\160\x5f\x61\x64\144\162\x65\x73\x73"] = $this->input->ip_address(); goto t9SRZ; J1I_F: return FALSE; goto ahbTJ; wRkOS: return $this->db->insert($this->tables["\x6c\157\147\151\156\x5f\141\x74\x74\145\155\160\x74\x73"], $data); goto JOaT0; JOaT0: Ksb8f: goto J1I_F; h2_go: $data = ["\x69\160\137\x61\144\144\162\x65\163\163" => '', "\x6c\x6f\147\151\156" => $identity, "\164\x69\x6d\x65" => time()]; goto jGMW8; jGMW8: if (!$this->config->item("\164\x72\x61\143\x6b\x5f\154\157\x67\x69\156\x5f\x69\x70\137\141\x64\x64\x72\x65\x73\163", "\151\157\156\x5f\141\x75\164\x68")) { goto rSO39; } goto j7AdN; MoEdb: if (!$this->config->item("\x74\162\141\143\x6b\137\x6c\x6f\x67\151\x6e\137\141\x74\x74\x65\155\x70\164\163", "\151\x6f\x6e\x5f\x61\x75\x74\x68")) { goto Ksb8f; } goto h2_go; t9SRZ: rSO39: goto wRkOS; ahbTJ: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto jkXia; O9SN0: return FALSE; goto RgfJs; Rj38E: if (isset($ip_address)) { goto CBgPy; } goto tlD2p; l3mC7: cWo3H: goto j7xnL; j7xnL: $this->db->or_where("\x74\x69\155\x65\40\74", time() - $old_attempts_expire_period, FALSE); goto HGGGu; tlD2p: $ip_address = $this->input->ip_address(); goto o4EBx; Gucoa: $this->db->where("\154\x6f\x67\x69\x6e", $identity); goto VKv8a; htM0e: T4EWy: goto O9SN0; oz8xG: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\143\x6b\157\x75\164\x5f\164\151\x6d\145", "\x69\x6f\156\x5f\141\165\x74\x68")); goto Gucoa; G_e3k: $this->db->where("\x69\160\x5f\141\x64\144\162\145\163\x73", $ip_address); goto l3mC7; o4EBx: CBgPy: goto G_e3k; jkXia: if (!$this->config->item("\164\x72\x61\x63\153\137\x6c\x6f\147\151\x6e\137\x61\164\x74\145\x6d\x70\164\x73", "\151\x6f\156\137\x61\x75\x74\150")) { goto T4EWy; } goto oz8xG; VKv8a: if (!$this->config->item("\164\x72\141\143\153\137\x6c\x6f\x67\151\x6e\137\151\160\x5f\141\144\x64\x72\145\x73\x73", "\151\157\x6e\137\x61\x75\x74\150")) { goto cWo3H; } goto Rj38E; HGGGu: return $this->db->delete($this->tables["\x6c\x6f\147\x69\x6e\137\141\x74\164\145\x6d\160\x74\x73"]); goto htM0e; RgfJs: } public function limit($limit) { goto KOxMu; zmana: return $this; goto INJCA; KOxMu: $this->trigger_events("\x6c\x69\155\151\164"); goto bFXHg; bFXHg: $this->_ion_limit = $limit; goto zmana; INJCA: } public function offset($offset) { goto hcLKR; hcLKR: $this->trigger_events("\x6f\146\x66\x73\x65\164"); goto qf2VP; qf2VP: $this->_ion_offset = $offset; goto Yv3iJ; Yv3iJ: return $this; goto Wr95z; Wr95z: } public function where($where, $value = NULL) { goto lwOoG; Ugx2J: return $this; goto xk80n; e4tf8: $where = [$where => $value]; goto nNq3G; lwOoG: $this->trigger_events("\x77\150\x65\162\145"); goto ML44h; ML44h: if (is_array($where)) { goto z7_06; } goto e4tf8; nNq3G: z7_06: goto xvUuQ; xvUuQ: array_push($this->_ion_where, $where); goto Ugx2J; xk80n: } public function like($like, $value = NULL, $position = "\x62\157\x74\150") { goto qv1Z2; iMhXb: array_push($this->_ion_like, ["\154\151\153\145" => $like, "\166\141\x6c\x75\145" => $value, "\x70\x6f\x73\151\x74\151\x6f\x6e" => $position]); goto tXDqp; tXDqp: return $this; goto a4Gk6; qv1Z2: $this->trigger_events("\154\151\x6b\x65"); goto iMhXb; a4Gk6: } public function select($select) { goto cAdrM; cAdrM: $this->trigger_events("\x73\x65\154\145\x63\x74"); goto L5H9h; L5H9h: $this->_ion_select[] = $select; goto uwdwJ; uwdwJ: return $this; goto ylem6; ylem6: } public function order_by($by, $order = "\144\145\163\143") { goto U9_hR; bERxU: $this->_ion_order = $order; goto KjoYW; U9_hR: $this->trigger_events("\x6f\x72\144\145\x72\x5f\x62\171"); goto Ji8m2; KjoYW: return $this; goto m0p4k; Ji8m2: $this->_ion_order_by = $by; goto bERxU; m0p4k: } public function row() { goto ouSt7; ouSt7: $this->trigger_events("\162\x6f\x77"); goto PcGjG; PcGjG: $row = $this->response->row(); goto DnlED; DnlED: return $row; goto mD736; mD736: } public function row_array() { goto EzQ8E; QeRLY: $row = $this->response->row_array(); goto XlLz5; EzQ8E: $this->trigger_events(["\162\x6f\167", "\x72\157\x77\x5f\141\162\162\141\x79"]); goto QeRLY; XlLz5: return $row; goto FNb4L; FNb4L: } public function result() { goto hamzU; Il_Rb: $result = $this->response->result(); goto FcyaE; FcyaE: return $result; goto xwpxe; hamzU: $this->trigger_events("\162\x65\163\x75\x6c\x74"); goto Il_Rb; xwpxe: } public function result_array() { goto Cyav9; OugEW: $result = $this->response->result_array(); goto bZOQX; Cyav9: $this->trigger_events(["\162\x65\163\165\154\164", "\162\x65\x73\165\x6c\x74\x5f\141\162\x72\141\171"]); goto OugEW; bZOQX: return $result; goto BA0gS; BA0gS: } public function num_rows() { goto ePw2V; ePw2V: $this->trigger_events(["\x6e\165\155\x5f\162\x6f\x77\x73"]); goto j5YEW; j5YEW: $result = $this->response->num_rows(); goto zlGky; zlGky: return $result; goto cFTjI; cFTjI: } public function users($groups = NULL) { goto uT0Ic; WFSvm: $groups = [$groups]; goto z9Ojq; HG6he: $group_ids = []; goto mWffS; tA3Q1: foreach ($this->_ion_where as $where) { $this->db->where($where); KWV_2: } goto Yzaa0; BFXfo: $this->db->select([$this->tables["\x75\x73\145\162\163"] . "\x2e\x2a", $this->tables["\x75\163\145\x72\163"] . "\x2e\151\144\x20\x61\163\40\151\144", $this->tables["\x75\x73\145\162\163"] . "\x2e\151\144\x20\141\163\40\x75\x73\145\x72\137\151\x64"]); goto ZOaD3; SPuP2: if (!isset($this->_ion_limit)) { goto B51xG; } goto DYbAg; nLS_a: return $this; goto B_5nl; Yzaa0: Uig3_: goto O_OVW; mWffS: $group_names = []; goto d_QTb; MPNGh: if (!isset($groups)) { goto EMqEA; } goto z6ZHj; Vve3O: $this->response = $this->db->get($this->tables["\x75\163\145\162\x73"]); goto nLS_a; bpx1d: G6CYu: goto aLURZ; UrP44: B51xG: goto HwC8K; ZDE12: KVwDB: goto WaiLW; wjSfJ: $this->_ion_limit = NULL; goto K0dAK; WwTP4: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\153\x65"], $like["\166\x61\154\x75\x65"], $like["\160\157\x73\151\164\x69\x6f\x6e"]); XJj3l: } goto L0vW8; DYbAg: $this->db->limit($this->_ion_limit); goto tQj6R; O_OVW: $this->_ion_where = []; goto vmRjD; R9_hV: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\x5f\x77\150\x65\162\145\137\x69\x6e" : "\167\x68\145\162\x65\137\151\156"; goto CqPBP; tQj6R: $this->_ion_limit = NULL; goto UrP44; rc_Dm: xAkHb: goto R9_hV; HwC8K: goto G6CYu; goto ZDE12; tTE3j: $this->db->where_in($this->tables["\x67\x72\x6f\165\x70\x73"] . "\56\x6e\x61\x6d\145", $group_names); goto W1Z33; f538S: DA04e: goto Nu0ht; ZOaD3: goto J9bWK; goto auERJ; W1Z33: mSK2K: goto vkswz; YMVeX: HnTmc: goto HG6he; as01l: $this->_ion_order = NULL; goto YZdyU; bsVS7: $this->db->{$or_where_in}($this->tables["\x75\x73\145\x72\163\x5f\147\162\x6f\x75\x70\x73"] . "\56" . $this->join["\x67\x72\x6f\165\160\x73"], $group_ids); goto f538S; gjF1W: if (!(isset($groups) && !empty($groups))) { goto HnTmc; } goto v67N9; auERJ: d_SG5: goto TFR8R; Nu0ht: EMqEA: goto fVWb1; KJLDh: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto KVwDB; } goto SPuP2; K0dAK: $this->_ion_offset = NULL; goto bpx1d; fVWb1: $this->trigger_events("\145\x78\164\162\141\137\167\x68\145\162\x65"); goto Ko5Mc; r0f2b: $this->_ion_like = []; goto dstQU; z6ZHj: if (is_array($groups)) { goto o8Hki; } goto WFSvm; WaiLW: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto wjSfJ; eiXrB: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto Cf9sC; } goto WwTP4; aLURZ: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto JZnKH; } goto tsXlb; yLwkU: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto d_SG5; } goto BFXfo; AKxar: $this->_ion_select = []; goto p0spi; v67N9: $this->db->distinct(); goto TrxfQ; YZdyU: $this->_ion_order_by = NULL; goto CzvlI; vkswz: if (empty($group_ids)) { goto DA04e; } goto bsVS7; uT0Ic: $this->trigger_events("\165\163\145\162\x73"); goto yLwkU; d_QTb: foreach ($groups as $group) { goto FvynE; mC7Wv: GW8gT: goto IFY6X; aQLRm: $group_ids[] = $group; goto blepy; FvynE: if (is_numeric($group)) { goto j038n; } goto o2kMd; oT8fc: goto YpfVn; goto qFoAV; qFoAV: j038n: goto aQLRm; blepy: YpfVn: goto mC7Wv; o2kMd: $group_names[] = $group; goto oT8fc; IFY6X: } goto rc_Dm; TFR8R: foreach ($this->_ion_select as $select) { $this->db->select($select); JFBFY: } goto qqvVp; z9Ojq: o8Hki: goto gjF1W; Ko5Mc: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto JsITG; } goto tA3Q1; p0spi: J9bWK: goto MPNGh; CqPBP: if (empty($group_names)) { goto mSK2K; } goto zJ5eP; zJ5eP: $this->db->join($this->tables["\x67\162\157\165\x70\163"], $this->tables["\x75\x73\x65\162\x73\137\x67\162\157\x75\x70\x73"] . "\x2e" . $this->join["\x67\162\x6f\165\160\x73"] . "\40\x3d\40" . $this->tables["\147\162\157\165\160\x73"] . "\x2e\151\x64", "\151\x6e\x6e\x65\162"); goto tTE3j; CzvlI: JZnKH: goto Vve3O; qqvVp: R0Hfq: goto AKxar; L0vW8: BIeEk: goto r0f2b; tsXlb: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto as01l; TrxfQ: $this->db->join($this->tables["\x75\163\x65\x72\163\x5f\147\x72\x6f\165\x70\163"], $this->tables["\165\163\145\x72\x73\137\x67\162\157\165\160\163"] . "\x2e" . $this->join["\x75\163\x65\162\163"] . "\x3d" . $this->tables["\165\x73\145\x72\x73"] . "\56\151\144", "\x69\x6e\156\145\162"); goto YMVeX; dstQU: Cf9sC: goto KJLDh; vmRjD: JsITG: goto eiXrB; B_5nl: } public function user($id = NULL) { goto jSyXb; jSyXb: $this->trigger_events("\x75\x73\145\162"); goto gWc5w; QR7av: $this->users(); goto Ckk1w; gWc5w: $id = isset($id) ? $id : $this->session->userdata("\165\x73\145\162\137\151\144"); goto ChwpU; ChwpU: $this->limit(1); goto yMAFE; Ckk1w: return $this; goto AYiEk; yMAFE: $this->order_by($this->tables["\x75\x73\145\x72\163"] . "\56\x69\144", "\144\145\x73\x63"); goto UkwAE; UkwAE: $this->where($this->tables["\x75\163\x65\x72\163"] . "\x2e\x69\144", $id); goto QR7av; AYiEk: } public function get_users_groups($id = FALSE) { goto Ui7YT; wLeB6: $id || ($id = $this->session->userdata("\165\163\x65\162\137\151\144")); goto xcnYj; Ui7YT: $this->trigger_events("\147\145\164\x5f\165\x73\x65\x72\163\x5f\x67\x72\157\x75\160"); goto wLeB6; xcnYj: return $this->db->select($this->tables["\x75\x73\145\x72\163\x5f\x67\x72\157\x75\160\163"] . "\56" . $this->join["\x67\162\157\165\x70\163"] . "\40\x61\x73\x20\151\144\x2c\x20" . $this->tables["\147\x72\x6f\165\x70\x73"] . "\x2e\x6e\141\155\145\54\40" . $this->tables["\147\162\x6f\x75\160\163"] . "\x2e\144\x65\x73\x63\x72\151\160\x74\x69\x6f\x6e")->where($this->tables["\165\x73\145\x72\x73\137\147\162\157\165\160\x73"] . "\x2e" . $this->join["\x75\163\x65\162\x73"], $id)->join($this->tables["\147\162\157\x75\160\163"], $this->tables["\165\x73\x65\x72\x73\137\x67\x72\157\x75\x70\163"] . "\x2e" . $this->join["\x67\162\x6f\165\160\x73"] . "\75" . $this->tables["\x67\162\157\165\x70\x73"] . "\x2e\151\x64")->get($this->tables["\x75\x73\x65\162\x73\137\x67\162\x6f\x75\x70\163"]); goto JnDbd; JnDbd: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto L2GNc; hxIeg: $users_groups = $this->get_users_groups($id)->result(); goto AFtr0; OE69M: $check_group = [$check_group]; goto uJ48v; Jlv36: goto HO416; goto A_2kD; E9YCG: foreach ($check_group as $key => $value) { goto e8n81; Qg_cl: BQ1Iv: goto kDzi4; e8n81: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto R8HuX; etaGG: return !$check_all; goto TcC5N; R8HuX: if (!(in_array($value, $groups) xor $check_all)) { goto IZWKY; } goto etaGG; TcC5N: IZWKY: goto Qg_cl; kDzi4: } goto tLFZp; rf302: $this->_cache_user_in_group[$id] = $groups_array; goto Jlv36; uJ48v: JzdAs: goto X_E1w; A_2kD: eMvsX: goto B5dEi; jW4pz: Pi0AR: goto rf302; tVSZh: if (is_array($check_group)) { goto JzdAs; } goto OE69M; B5dEi: $groups_array = $this->_cache_user_in_group[$id]; goto l8w5b; L2GNc: $this->trigger_events("\x69\156\137\147\x72\157\165\160"); goto Cmj0Z; WJ7gO: return $check_all; goto UYtyU; l8w5b: HO416: goto E9YCG; L7RKI: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; x8U0Z: } goto jW4pz; tLFZp: WI401: goto WJ7gO; X_E1w: if (isset($this->_cache_user_in_group[$id])) { goto eMvsX; } goto hxIeg; AFtr0: $groups_array = []; goto L7RKI; Cmj0Z: $id || ($id = $this->session->userdata("\165\163\x65\162\x5f\x69\144")); goto tVSZh; UYtyU: } public function add_to_group($group_ids, $user_id = FALSE) { goto gL5PL; Ve9kB: if (is_array($group_ids)) { goto miVt5; } goto y7Ww0; hlls5: miVt5: goto MLXjp; d0zHm: bhKNZ: goto w40Fr; w40Fr: return $return; goto L3vGy; Y2Ma7: foreach ($group_ids as $group_id) { goto aDG0w; mt4lV: goto t4W2i; goto JDiAF; gs8fs: tjtYk: goto Ey6rX; af2uJ: $group_name = $this->_cache_groups[$group_id]; goto mbGTG; mbGTG: t4W2i: goto t5sn6; JDiAF: Wkh5C: goto af2uJ; t5sn6: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto Ff8GB; E1KvB: $group = $this->group($group_id)->result(); goto lEoSD; aDG0w: if (!$this->db->insert($this->tables["\165\163\145\162\x73\137\147\162\157\x75\160\x73"], [$this->join["\x67\x72\x6f\165\160\163"] => (float) $group_id, $this->join["\x75\163\x65\x72\163"] => (float) $user_id])) { goto Q6pEG; } goto bVNu3; sFR2k: $this->_cache_groups[$group_id] = $group_name; goto mt4lV; GMSbe: Q6pEG: goto gs8fs; lEoSD: $group_name = $group[0]->name; goto sFR2k; bVNu3: if (isset($this->_cache_groups[$group_id])) { goto Wkh5C; } goto E1KvB; Ff8GB: $return++; goto GMSbe; Ey6rX: } goto d0zHm; MLXjp: $return = 0; goto Y2Ma7; y7Ww0: $group_ids = [$group_ids]; goto hlls5; gL5PL: $this->trigger_events("\141\x64\x64\137\164\x6f\137\147\162\x6f\x75\x70"); goto c0A_h; c0A_h: $user_id || ($user_id = $this->session->userdata("\165\163\x65\162\137\x69\144")); goto Ve9kB; L3vGy: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto K0Qfw; Q757J: return $return; goto Cd5lu; MeGRt: $this->_cache_user_in_group[$user_id] = []; goto dHDVM; K0Qfw: $this->trigger_events("\162\145\155\x6f\x76\x65\137\146\162\157\155\137\x67\162\x6f\x75\160"); goto yI0AT; k0ezh: PALod: goto Iqopc; fp2us: if (is_array($group_ids)) { goto PALod; } goto Cuvls; ha1Yz: $return = TRUE; goto zwJcG; sdZ9y: if (!($return = $this->db->delete($this->tables["\165\163\x65\162\x73\x5f\147\162\x6f\x75\160\163"], [$this->join["\x75\163\x65\162\163"] => (float) $user_id]))) { goto tXzC8; } goto MeGRt; Cuvls: $group_ids = [$group_ids]; goto k0ezh; vOEcx: if (!empty($group_ids)) { goto UsAEE; } goto sdZ9y; Iqopc: foreach ($group_ids as $group_id) { goto k2GmZ; ujGnC: xqhlb: goto s4gQ9; j1yKZ: DyZbH: goto ujGnC; k2GmZ: $this->db->delete($this->tables["\x75\163\145\x72\163\137\147\x72\157\x75\x70\x73"], [$this->join["\x67\162\157\x75\160\x73"] => (float) $group_id, $this->join["\165\x73\145\x72\163"] => (float) $user_id]); goto kpS7M; kpS7M: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto DyZbH; } goto snAEu; snAEu: unset($this->_cache_user_in_group[$user_id][$group_id]); goto j1yKZ; s4gQ9: } goto LiZJ1; uEwMm: UsAEE: goto fp2us; yI0AT: if (!empty($user_id)) { goto t7fuL; } goto lOlfh; ARn1U: goto LFgrE; goto uEwMm; lOlfh: return FALSE; goto l46Cg; dHDVM: tXzC8: goto ARn1U; LiZJ1: EpWEG: goto ha1Yz; l46Cg: t7fuL: goto vOEcx; zwJcG: LFgrE: goto Q757J; Cd5lu: } public function groups() { goto tJPdi; jIXU0: $this->db->limit($this->_ion_limit); goto qwTR3; lhx3i: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto r6eru; aphZu: C5wBu: goto vs6fe; Knkhg: if (!isset($this->_ion_limit)) { goto XV2t3; } goto jIXU0; yYqPu: r760O: goto lhx3i; r6eru: $this->_ion_limit = NULL; goto wFmDN; LeRJV: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto gBROa; } goto uInig; wFmDN: $this->_ion_offset = NULL; goto aphZu; MhDSY: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto r760O; } goto Knkhg; vs6fe: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto oSx2_; } goto RNMzQ; ZzdqQ: AqaFm: goto a2m9G; SkBSV: oSx2_: goto TStiy; tJPdi: $this->trigger_events("\147\162\x6f\165\x70\x73"); goto LeRJV; TStiy: $this->response = $this->db->get($this->tables["\147\x72\x6f\165\160\163"]); goto utK7p; a2m9G: $this->_ion_where = []; goto r6WgY; T9viL: XV2t3: goto T9UBM; uInig: foreach ($this->_ion_where as $where) { $this->db->where($where); ZKjQQ: } goto ZzdqQ; T9UBM: goto C5wBu; goto yYqPu; RNMzQ: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto SkBSV; qwTR3: $this->_ion_limit = NULL; goto T9viL; utK7p: return $this; goto d7qPw; r6WgY: gBROa: goto MhDSY; d7qPw: } public function group($id = NULL) { goto vYseD; UH_n0: $this->limit(1); goto fdNva; FugRc: eIZZL: goto UH_n0; YeOwU: $this->where($this->tables["\147\162\x6f\165\x70\163"] . "\x2e\x69\x64", $id); goto FugRc; yRvro: return $this->groups(); goto GtlyH; fdNva: $this->order_by("\x69\144", "\144\x65\163\x63"); goto yRvro; eAYuN: if (!isset($id)) { goto eIZZL; } goto YeOwU; vYseD: $this->trigger_events("\147\162\x6f\x75\x70"); goto eAYuN; GtlyH: } public function update($id, array $data) { goto BCGFU; xm2Bo: $this->db->trans_rollback(); goto RtgiI; GLJXD: if (!array_key_exists("\x70\x61\x73\x73\167\157\162\144", $data)) { goto iVCVy; } goto T5aUy; T5aUy: if (!empty($data["\160\x61\163\x73\167\157\x72\x64"])) { goto Q9LSX; } goto Lj2kD; CELHq: K7hce: goto XvUWA; NjPBH: $user = $this->user($id)->row(); goto Hrrh_; urHo5: $this->trigger_events("\145\170\x74\162\141\137\167\150\145\x72\145"); goto lUaKu; ZM2LO: M_1JR: goto urHo5; CfVNH: iVCVy: goto ZM2LO; keCwp: return TRUE; goto Jpnrw; Dt45W: QMiNS: goto CfVNH; HYsWi: $this->set_error("\165\x70\144\141\164\x65\x5f\x75\156\x73\165\x63\143\145\163\163\146\x75\154"); goto EhkFs; qPKAn: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto K7hce; } goto SMUNp; qKVxB: $this->set_message("\165\160\x64\141\164\145\137\x73\165\143\x63\145\163\x73\x66\x75\154"); goto keCwp; y8YAW: dFr7U: goto Dt45W; BCGFU: $this->trigger_events("\x70\162\x65\137\x75\x70\144\x61\164\x65\137\165\163\145\162"); goto NjPBH; XvUWA: $data = $this->_filter_data($this->tables["\x75\x73\x65\x72\163"], $data); goto EszrE; KNjLO: return FALSE; goto HdrtQ; fJLde: if (!($this->db->trans_status() === FALSE)) { goto XTRXV; } goto ncomV; EhkFs: return FALSE; goto y8YAW; Wptlv: $this->set_error("\165\160\x64\x61\164\145\137\165\156\x73\x75\143\x63\x65\x73\x73\x66\x75\154"); goto Tl2ev; EszrE: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\x73\163\x77\x6f\x72\144", $data) || array_key_exists("\145\x6d\x61\151\154", $data))) { goto M_1JR; } goto GLJXD; AoMkz: $this->trigger_events(["\x70\x6f\x73\164\x5f\x75\160\x64\141\164\x65\137\165\x73\x65\x72", "\x70\157\x73\x74\137\x75\160\144\x61\164\145\137\x75\x73\x65\162\137\x75\156\x73\x75\143\143\x65\163\x73\146\165\x6c"]); goto gMo4s; Hrrh_: $this->db->trans_begin(); goto qPKAn; ncomV: $this->db->trans_rollback(); goto AoMkz; lUaKu: $this->db->update($this->tables["\x75\x73\x65\162\163"], $data, ["\x69\x64" => $user->id]); goto fJLde; ASkh2: $data["\160\141\x73\x73\x77\x6f\162\x64"] = $this->hash_password($data["\x70\x61\163\x73\167\157\x72\x64"], $user->{$this->identity_column}); goto rLA_3; rLA_3: if (!($data["\160\141\163\x73\x77\x6f\162\144"] === FALSE)) { goto dFr7U; } goto xm2Bo; Opti6: Q9LSX: goto ASkh2; gMo4s: $this->set_error("\165\x70\x64\141\x74\x65\137\x75\x6e\x73\x75\143\143\x65\x73\163\x66\x75\x6c"); goto KNjLO; Lj2kD: unset($data["\160\x61\163\x73\167\x6f\x72\x64"]); goto pN6k2; MnE63: $this->db->trans_commit(); goto t2g0r; t2g0r: $this->trigger_events(["\x70\157\163\164\x5f\165\x70\x64\141\164\145\x5f\165\163\x65\162", "\160\x6f\163\x74\137\165\160\144\141\164\x65\137\x75\x73\x65\x72\137\163\165\x63\x63\145\x73\x73\x66\x75\154"]); goto qKVxB; Tl2ev: return FALSE; goto CELHq; RtgiI: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\x70\144\141\x74\x65\137\x75\163\x65\x72", "\x70\x6f\163\x74\137\x75\160\x64\141\164\x65\x5f\165\163\145\162\x5f\165\156\x73\x75\x63\x63\x65\x73\163\146\x75\154"]); goto HYsWi; SMUNp: $this->db->trans_rollback(); goto pOQS7; pOQS7: $this->set_error("\141\x63\x63\x6f\x75\x6e\x74\x5f\143\162\x65\141\x74\x69\x6f\156\x5f\144\x75\x70\x6c\151\143\141\164\145\137\x69\x64\145\156\x74\x69\x74\x79"); goto gyTG3; HdrtQ: XTRXV: goto MnE63; pN6k2: goto QMiNS; goto Opti6; gyTG3: $this->trigger_events(["\x70\x6f\x73\164\137\165\x70\x64\x61\x74\145\137\x75\x73\x65\x72", "\x70\157\163\164\x5f\x75\x70\x64\x61\x74\x65\137\165\x73\x65\162\137\165\156\163\165\x63\x63\x65\163\x73\x66\x75\x6c"]); goto Wptlv; Jpnrw: } public function delete_user($id) { goto vjMZg; iB4f_: $this->set_error("\x64\145\x6c\145\x74\x65\x5f\165\x6e\163\x75\x63\x63\x65\163\x73\x66\165\x6c"); goto xY9a7; yyBLM: $this->trigger_events(["\160\x6f\163\164\137\144\145\x6c\145\164\x65\137\165\x73\x65\162", "\160\157\163\x74\137\x64\x65\x6c\x65\x74\145\x5f\165\163\x65\162\x5f\165\156\163\x75\x63\x63\145\x73\163\x66\165\154"]); goto iB4f_; XfaIq: $this->db->trans_rollback(); goto yyBLM; RyXnf: $this->set_message("\144\x65\154\x65\164\145\x5f\x73\165\143\x63\145\163\x73\x66\x75\154"); goto QFqqx; xzKlP: $this->db->trans_begin(); goto D4U13; vjMZg: $this->trigger_events("\x70\x72\x65\137\x64\x65\x6c\145\x74\145\x5f\x75\x73\x65\162"); goto xzKlP; hiYah: $this->db->delete($this->tables["\x75\x73\x65\162\x73"], ["\151\x64" => $id]); goto ChBHa; ChBHa: if (!($this->db->trans_status() === FALSE)) { goto l81ez; } goto XfaIq; M6sRu: $this->db->trans_commit(); goto CQMCK; QFqqx: return TRUE; goto fWkn4; xY9a7: return FALSE; goto XbAMQ; XbAMQ: l81ez: goto M6sRu; D4U13: $this->remove_from_group(NULL, $id); goto hiYah; CQMCK: $this->trigger_events(["\160\157\163\x74\137\144\x65\154\145\x74\x65\137\x75\x73\x65\162", "\160\x6f\163\164\137\144\x65\x6c\145\164\145\137\165\163\145\162\x5f\163\x75\x63\x63\145\x73\x73\146\x75\154"]); goto RyXnf; fWkn4: } public function update_last_login($id) { goto Qro65; Qro65: $this->trigger_events("\165\160\144\141\164\x65\137\154\141\x73\x74\137\x6c\157\x67\x69\156"); goto xkcN6; X9DHn: $this->db->update($this->tables["\x75\163\x65\162\163"], ["\x6c\141\163\x74\x5f\x6c\x6f\147\151\x6e" => time()], ["\151\144" => $id]); goto WkV_2; xkcN6: $this->load->helper("\144\x61\x74\145"); goto Z2MNw; Z2MNw: $this->trigger_events("\x65\x78\164\162\141\137\x77\150\x65\162\x65"); goto X9DHn; WkV_2: return $this->db->affected_rows() == 1; goto xr8HN; xr8HN: } public function set_lang($lang = "\145\156") { goto DIhcA; DIhcA: $this->trigger_events("\x73\145\x74\137\x6c\x61\x6e\x67"); goto Nmb_p; QjJmp: $expire = $this->config->item("\x75\x73\145\x72\x5f\145\170\x70\x69\x72\x65", "\151\157\156\x5f\x61\165\164\x68"); goto JpCrV; JpCrV: goto NqUpR; goto ysDYG; Nmb_p: if ($this->config->item("\165\163\x65\x72\x5f\x65\170\x70\x69\x72\145", "\151\x6f\156\137\141\x75\x74\x68") === 0) { goto gzjoA; } goto QjJmp; bxx9P: NqUpR: goto Cc6hV; Cc6hV: set_cookie(["\x6e\141\155\x65" => "\x6c\x61\156\x67\137\143\x6f\x64\145", "\166\x61\x6c\165\145" => $lang, "\145\170\160\x69\162\145" => $expire]); goto md3aB; ysDYG: gzjoA: goto hXdJ4; hXdJ4: $expire = self::MAX_COOKIE_LIFETIME; goto bxx9P; md3aB: return TRUE; goto ChuNN; ChuNN: } public function set_session($user) { goto jG9ha; jG9ha: $this->trigger_events("\160\x72\x65\x5f\x73\145\x74\137\163\x65\x73\x73\x69\x6f\x6e"); goto TQRil; jDNYp: return TRUE; goto pG9yv; Ronpi: $this->session->set_userdata($session_data); goto DYIC3; DYIC3: $this->trigger_events("\160\157\x73\x74\x5f\x73\x65\164\137\x73\x65\163\x73\151\157\x6e"); goto jDNYp; TQRil: $session_data = ["\x69\x64\145\156\164\151\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\151\154" => $user->email, "\165\163\x65\162\137\151\144" => $user->id, "\157\x6c\144\137\154\x61\163\164\x5f\154\157\x67\x69\156" => $user->last_login, "\154\x61\x73\164\x5f\x63\x68\x65\143\x6b" => time()]; goto Ronpi; pG9yv: } public function remember_user($identity) { goto p6G1q; Kw2Nx: return FALSE; goto KGGpM; pWDve: if (!($this->db->affected_rows() > -1)) { goto UVpsb; } goto y0bVX; ovMwG: k7phF: goto uaGxC; UmNrZ: $token = $this->_generate_selector_validator_couple(); goto OFVhL; y0bVX: if ($this->config->item("\x75\x73\x65\x72\137\x65\x78\x70\x69\x72\145", "\x69\x6f\156\x5f\x61\165\x74\x68") === 0) { goto k3nON; } goto tDjcB; Cmvw3: return FALSE; goto XC0WZ; NDeqF: k3nON: goto upSge; uaGxC: $this->trigger_events(["\160\157\163\164\137\162\145\x6d\x65\x6d\142\x65\162\x5f\x75\163\145\162", "\162\145\x6d\x65\155\142\145\x72\137\x75\x73\x65\162\137\x75\x6e\x73\x75\x63\143\145\163\x73\146\165\154"]); goto Cmvw3; GV0Da: goto vfvIG; goto NDeqF; OFVhL: if (!$token->validator_hashed) { goto k7phF; } goto zpf07; upSge: $expire = self::MAX_COOKIE_LIFETIME; goto RNNrC; YS3In: set_cookie(["\x6e\x61\155\145" => $this->config->item("\162\145\x6d\x65\155\142\x65\162\x5f\143\157\x6f\153\x69\x65\x5f\x6e\141\155\145", "\151\157\156\137\x61\x75\164\150"), "\166\x61\x6c\165\x65" => $token->user_code, "\x65\170\160\151\x72\x65" => $expire]); goto peGSh; hG2PJ: UVpsb: goto ovMwG; dVJq5: return TRUE; goto hG2PJ; peGSh: $this->trigger_events(["\160\x6f\163\x74\137\x72\x65\155\145\155\142\x65\x72\137\x75\163\145\x72", "\162\145\x6d\145\155\x62\x65\x72\x5f\165\163\145\x72\x5f\x73\165\143\x63\145\163\x73\146\165\x6c"]); goto dVJq5; zpf07: $this->db->update($this->tables["\x75\163\x65\x72\x73"], ["\162\145\x6d\145\155\142\145\x72\137\x73\145\154\145\x63\164\157\x72" => $token->selector, "\162\x65\x6d\x65\155\142\145\x72\x5f\143\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto pWDve; p6G1q: $this->trigger_events("\x70\x72\x65\137\x72\145\155\145\155\x62\x65\162\x5f\x75\163\x65\x72"); goto AOn_A; AOn_A: if ($identity) { goto iN9Lx; } goto Kw2Nx; tDjcB: $expire = $this->config->item("\165\x73\x65\162\x5f\x65\x78\160\x69\162\x65", "\x69\157\156\x5f\x61\165\x74\150"); goto GV0Da; KGGpM: iN9Lx: goto UmNrZ; RNNrC: vfvIG: goto YS3In; XC0WZ: } public function login_remembered_user() { goto APgG8; dPH74: $user = $query->row(); goto YkH0N; pCfeh: jxj1o: goto GGpLt; cFDi4: $this->remember_user($identity); goto ks2be; OReGc: return FALSE; goto JMvaC; pexAm: $this->trigger_events(["\160\157\163\164\x5f\154\157\x67\x69\x6e\x5f\162\x65\155\145\155\x62\145\x72\x65\144\x5f\165\x73\145\x72", "\x70\x6f\163\x74\137\154\x6f\147\x69\x6e\137\162\145\155\145\155\x62\145\162\145\144\x5f\x75\163\x65\162\137\165\x6e\x73\165\x63\143\145\163\x73\x66\165\x6c"]); goto OReGc; ZKmHT: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto Ir6c2; wGtJk: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto jxj1o; } goto IH41i; H3NcY: $this->set_session($user); goto qCkz5; qCkz5: $this->clear_forgotten_password_code($identity); goto fRu8I; YkH0N: $identity = $user->{$this->identity_column}; goto wGtJk; djpsG: return TRUE; goto pCfeh; AdSEU: $this->trigger_events(["\160\157\x73\x74\x5f\154\157\147\151\156\x5f\x72\145\155\x65\x6d\x62\x65\x72\x65\144\137\x75\163\x65\162", "\160\x6f\163\164\x5f\154\157\147\x69\x6e\137\x72\x65\155\145\x6d\142\145\x72\x65\x64\x5f\165\x73\145\162\137\x75\156\163\x75\x63\143\145\163\163\x66\165\154"]); goto qiZkg; PF5Ab: $this->trigger_events(["\160\157\x73\x74\x5f\x6c\157\147\x69\156\x5f\x72\145\x6d\145\155\142\x65\162\145\x64\x5f\165\163\145\162", "\x70\x6f\x73\164\137\x6c\x6f\147\x69\x6e\137\x72\x65\155\x65\x6d\142\x65\x72\x65\x64\x5f\x75\163\x65\162\x5f\x73\165\143\x63\145\x73\163\146\x75\x6c"]); goto djpsG; DbfhC: delete_cookie($this->config->item("\162\x65\155\145\155\142\145\162\137\143\x6f\157\x6b\x69\x65\x5f\156\141\x6d\145", "\151\157\x6e\x5f\141\x75\164\x68")); goto AdSEU; APgG8: $this->trigger_events("\x70\x72\145\x5f\154\157\147\151\156\137\x72\x65\155\145\155\142\145\x72\145\144\x5f\x75\x73\145\x72"); goto oZoWf; pZCHf: $this->session->sess_regenerate(FALSE); goto PF5Ab; ks2be: oUtaf: goto pZCHf; zjO5y: $this->trigger_events("\x65\170\x74\162\x61\x5f\x77\150\x65\x72\145"); goto f2HLE; IH41i: $this->update_last_login($user->id); goto H3NcY; fRu8I: if (!$this->config->item("\165\163\145\162\137\x65\x78\x74\145\x6e\x64\x5f\157\156\x5f\154\157\x67\151\156", "\x69\x6f\156\137\141\x75\x74\x68")) { goto oUtaf; } goto cFDi4; oZoWf: $remember_cookie = get_cookie($this->config->item("\x72\145\155\145\155\x62\x65\162\137\x63\x6f\x6f\153\151\x65\137\x6e\141\155\x65", "\x69\157\x6e\137\x61\165\x74\150")); goto ZKmHT; JMvaC: sCSVj: goto zjO5y; Ir6c2: if (!($token === FALSE)) { goto sCSVj; } goto pexAm; f2HLE: $query = $this->db->select($this->identity_column . "\x2c\x20\x69\x64\54\40\145\155\x61\151\154\x2c\x20\162\145\155\145\155\142\x65\162\x5f\143\157\144\145\x2c\40\154\x61\x73\x74\x5f\x6c\x6f\147\151\x6e")->where("\x72\x65\155\x65\155\x62\145\162\x5f\163\145\154\x65\143\164\x6f\162", $token->selector)->where("\x61\143\x74\151\166\145", 1)->limit(1)->get($this->tables["\165\163\x65\x72\x73"]); goto DEczD; GGpLt: bCFHF: goto DbfhC; qiZkg: return FALSE; goto yVALP; DEczD: if (!($query->num_rows() === 1)) { goto bCFHF; } goto dPH74; yVALP: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto zkSAc; n8Ntc: if (!($existing_group !== 0)) { goto wyzYw; } goto Tpszq; GYI8B: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\160\x73"], $additional_data), $data); goto RjnBc; jgf22: $group_id = $this->db->insert_id($this->tables["\147\x72\157\x75\x70\163"] . "\x5f\x69\144\x5f\x73\145\161"); goto IZ4N_; zkSAc: if ($group_name) { goto qi6hk; } goto YKtbq; qTQ5o: $this->trigger_events("\x65\170\164\162\141\x5f\x67\162\157\165\x70\137\163\145\x74"); goto G1GlY; zNrlI: if (empty($additional_data)) { goto d_RoZ; } goto GYI8B; Tpszq: $this->set_error("\147\x72\157\x75\x70\x5f\x61\154\162\145\x61\144\171\x5f\x65\x78\x69\163\x74\x73"); goto zZ4X1; EVfvh: qi6hk: goto sbATF; IZ4N_: $this->set_message("\x67\x72\157\165\160\x5f\x63\x72\x65\x61\164\151\x6f\x6e\x5f\x73\165\x63\143\x65\163\163\x66\165\x6c"); goto zXLFj; YKtbq: $this->set_error("\147\162\157\x75\x70\137\x6e\x61\155\x65\x5f\x72\145\161\165\x69\x72\x65\x64"); goto ua7Ht; zXLFj: return $group_id; goto DwSxV; V0M3x: $data = ["\156\141\155\x65" => $group_name, "\144\x65\163\143\162\151\160\x74\x69\x6f\x6e" => $group_description]; goto zNrlI; ua7Ht: return FALSE; goto EVfvh; zZ4X1: return FALSE; goto UvccZ; UvccZ: wyzYw: goto V0M3x; G1GlY: $this->db->insert($this->tables["\147\x72\x6f\165\x70\x73"], $data); goto jgf22; sbATF: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\165\160\x73"], ["\x6e\x61\x6d\145" => $group_name])->num_rows(); goto n8Ntc; RjnBc: d_RoZ: goto qTQ5o; DwSxV: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto ks9MI; nq6vP: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto gHHFx; } goto qLKqV; I94k8: return TRUE; goto CNXyR; Zb6IB: return FALSE; goto fbb0u; L6zpK: $this->db->update($this->tables["\147\162\157\165\x70\163"], $data, ["\x69\x64" => $group_id]); goto ZOlgT; CW5uE: return FALSE; goto aoLSw; tDsqu: $this->set_error("\147\x72\x6f\x75\160\137\156\141\155\x65\x5f\x61\x64\x6d\151\156\x5f\x6e\x6f\164\x5f\x61\x6c\x74\x65\x72"); goto Zb6IB; LYyM4: Pq0Gg: goto L6zpK; x4v6F: if (!($this->config->item("\141\x64\x6d\x69\156\x5f\x67\x72\157\x75\160", "\151\157\156\x5f\x61\165\x74\150") === $group->name && $group_name !== $group->name)) { goto rAjJr; } goto tDsqu; FfNmV: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\160\163"], $additional_data), $data); goto LYyM4; uNOg7: $data = []; goto bog_S; fbb0u: rAjJr: goto PGXsU; bog_S: if (empty($group_name)) { goto gnJdW; } goto soiGI; aoLSw: PxRC8: goto uNOg7; ks9MI: if (!empty($group_id)) { goto PxRC8; } goto CW5uE; soiGI: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\165\x70\163"], ["\156\x61\155\x65" => $group_name])->row(); goto nq6vP; LZ2H2: gHHFx: goto MPeVJ; ZOlgT: $this->set_message("\x67\162\157\165\160\137\x75\160\x64\x61\x74\x65\137\163\x75\143\143\145\x73\x73\x66\x75\x6c"); goto I94k8; r4N1y: return FALSE; goto LZ2H2; PGXsU: if (empty($additional_data)) { goto Pq0Gg; } goto FfNmV; BqJs0: gnJdW: goto zQXoP; zQXoP: $group = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\163"], ["\151\x64" => $group_id])->row(); goto x4v6F; qLKqV: $this->set_error("\147\162\157\165\x70\137\141\154\x72\145\141\x64\171\x5f\x65\x78\151\x73\164\163"); goto r4N1y; MPeVJ: $data["\x6e\x61\x6d\x65"] = $group_name; goto BqJs0; CNXyR: } public function delete_group($group_id = FALSE) { goto kUZMr; u7_jJ: return FALSE; goto slgSE; AvrlB: $group = $this->group($group_id)->row(); goto vn1do; D17NZ: shjpu: goto AvrlB; ZGjXn: $this->trigger_events(["\160\157\163\164\x5f\x64\145\x6c\145\x74\x65\x5f\147\162\157\165\160", "\160\x6f\x73\164\x5f\144\x65\x6c\x65\164\x65\x5f\147\162\x6f\x75\160\137\x6e\x6f\x74\141\154\x6c\157\167\145\144"]); goto al9Du; E9RnE: $this->trigger_events(["\x70\x6f\163\164\x5f\x64\x65\154\145\x74\x65\x5f\147\162\x6f\165\x70", "\x70\157\163\164\137\144\x65\154\x65\x74\145\x5f\x67\x72\157\165\x70\x5f\x73\x75\143\x63\x65\163\163\146\x75\x6c"]); goto JiUKo; ftS_Q: mzNfE: goto x2w5F; x2w5F: $this->db->trans_commit(); goto E9RnE; EyF5H: return FALSE; goto ftS_Q; Ib82B: return TRUE; goto FFALn; kSYxu: $this->trigger_events(["\160\x6f\x73\x74\x5f\144\x65\x6c\x65\x74\145\137\x67\162\157\x75\x70", "\x70\157\163\164\x5f\144\145\154\x65\x74\145\137\x67\162\x6f\165\x70\137\165\156\163\x75\143\143\x65\163\x73\146\165\154"]); goto a6kaj; a6kaj: $this->set_error("\x67\162\x6f\165\160\137\x64\x65\154\145\x74\145\x5f\165\156\x73\165\143\x63\145\x73\163\146\x75\154"); goto EyF5H; Pw0ys: $this->trigger_events("\x70\x72\x65\x5f\144\x65\x6c\x65\x74\x65\x5f\147\162\157\165\160"); goto egKeW; XMgDk: $this->db->trans_rollback(); goto kSYxu; Q1Vog: if (!($this->db->trans_status() === FALSE)) { goto mzNfE; } goto XMgDk; mPFzC: return FALSE; goto D17NZ; JiUKo: $this->set_message("\x67\162\157\165\160\x5f\x64\x65\x6c\x65\x74\x65\137\x73\x75\x63\143\x65\163\163\x66\x75\x6c"); goto Ib82B; kUZMr: if (!(!$group_id || empty($group_id))) { goto shjpu; } goto mPFzC; slgSE: tRiW6: goto Pw0ys; al9Du: $this->set_error("\147\162\x6f\x75\160\x5f\x64\145\x6c\x65\164\x65\137\156\x6f\164\141\154\154\157\167\x65\x64"); goto u7_jJ; Id2Pl: $this->db->delete($this->tables["\x67\x72\x6f\165\160\x73"], ["\151\144" => $group_id]); goto Q1Vog; egKeW: $this->db->trans_begin(); goto CJq2I; vn1do: if (!($group->name == $this->config->item("\x61\x64\155\151\156\137\147\x72\x6f\x75\x70", "\151\157\x6e\137\141\x75\x74\150"))) { goto tRiW6; } goto ZGjXn; CJq2I: $this->db->delete($this->tables["\x75\x73\x65\162\163\x5f\147\x72\157\x75\160\x73"], [$this->join["\147\x72\157\165\160\x73"] => $group_id]); goto Id2Pl; FFALn: } public function set_hook($event, $name, $class, $method, $arguments) { goto G0QIa; JMQB8: $this->_ion_hooks->{$event}[$name]->method = $method; goto LECsg; G0QIa: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto FdcqS; FdcqS: $this->_ion_hooks->{$event}[$name]->class = $class; goto JMQB8; LECsg: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto wIh4z; wIh4z: } public function remove_hook($event, $name) { goto O12Zd; gkNgM: unset($this->_ion_hooks->{$event}[$name]); goto uNnMA; uNnMA: do3yg: goto mXmoe; O12Zd: if (!isset($this->_ion_hooks->{$event}[$name])) { goto do3yg; } goto gkNgM; mXmoe: } public function remove_hooks($event) { goto nQr25; nQr25: if (!isset($this->_ion_hooks->{$event})) { goto gqFX4; } goto zDmeu; zDmeu: unset($this->_ion_hooks->{$event}); goto tWgXI; tWgXI: gqFX4: goto TpVMM; TpVMM: } protected function _call_hook($event, $name) { goto FTtS7; FTtS7: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto vhua4; } goto FoXIs; FoXIs: $hook = $this->_ion_hooks->{$event}[$name]; goto mLVgz; nybCa: vhua4: goto gk09p; gk09p: return FALSE; goto TQB2A; mLVgz: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto nybCa; TQB2A: } public function trigger_events($events) { goto ubVXN; IKHz5: AdGD1: goto CWjNE; i3I5D: foreach ($events as $event) { $this->trigger_events($event); yZSaL: } goto ZDwDp; ZDwDp: Gftm1: goto R5hlf; VK3Bt: axqzW: goto i3I5D; R5hlf: SzL90: goto ifZhl; CWjNE: j2AjD: goto c2Wul; dfrKb: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); d2ctp: } goto IKHz5; ubVXN: if (is_array($events) && !empty($events)) { goto axqzW; } goto UK650; c2Wul: goto SzL90; goto VK3Bt; UK650: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto j2AjD; } goto dfrKb; ifZhl: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto cO5ef; TSQIX: $this->message_end_delimiter = $end_delimiter; goto br0Qi; cO5ef: $this->message_start_delimiter = $start_delimiter; goto TSQIX; br0Qi: return TRUE; goto QDFzS; QDFzS: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto f0zgK; obaVL: return TRUE; goto Ox7zR; jyrOF: $this->error_end_delimiter = $end_delimiter; goto obaVL; f0zgK: $this->error_start_delimiter = $start_delimiter; goto jyrOF; Ox7zR: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto MCShW; MCShW: $_output = ''; goto HTVyA; AGx0P: smDIk: goto uIzWN; HTVyA: foreach ($this->messages as $message) { goto llUmM; VcIvn: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto aEYWx; aEYWx: Nm01C: goto J9rRt; llUmM: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\43\x23"; goto VcIvn; J9rRt: } goto AGx0P; uIzWN: return $_output; goto XOBVh; XOBVh: } public function messages_array($langify = TRUE) { goto nTc_9; btlFW: jT7RX: goto D50El; tOwlU: JtOIA: goto rKAlP; qSjUj: BaH2m: goto YV0vb; fCBqk: goto JtOIA; goto qSjUj; MeMs1: return $this->messages; goto fCBqk; D50El: return $_output; goto tOwlU; nTc_9: if ($langify) { goto BaH2m; } goto MeMs1; YV0vb: $_output = []; goto fZO60; fZO60: foreach ($this->messages as $message) { goto t0aRL; t0aRL: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\x23"; goto wGLat; s35o7: JBmHh: goto FcCnn; wGLat: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto s35o7; FcCnn: } goto btlFW; rKAlP: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto S0ga_; drXWI: return $_output; goto eJtuE; p3zOl: hYJiH: goto drXWI; S0ga_: $_output = ''; goto nw7g2; nw7g2: foreach ($this->errors as $error) { goto B5CrY; DjTRV: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto myNpj; myNpj: bPVyW: goto qSa00; B5CrY: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto DjTRV; qSa00: } goto p3zOl; eJtuE: } public function errors_array($langify = TRUE) { goto vVPsh; T8Cjo: goto A9uiM; goto kPGus; vVPsh: if ($langify) { goto MAlWU; } goto SrIu2; Ol4eZ: A9uiM: goto nw1lm; H5ox7: foreach ($this->errors as $error) { goto p7SPi; lDeii: kAed3: goto Smib3; Yblkc: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto lDeii; p7SPi: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\x23"; goto Yblkc; Smib3: } goto lJhtf; SrIu2: return $this->errors; goto T8Cjo; lJhtf: h1tO2: goto Ph9PP; zlpth: $_output = []; goto H5ox7; kPGus: MAlWU: goto zlpth; Ph9PP: return $_output; goto Ol4eZ; nw1lm: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto STuUg; STuUg: $hash = $this->hash_password($password, $identity); goto wEtk0; eURWo: return FALSE; goto seNHG; MFpbb: $this->db->update($this->tables["\165\x73\145\162\x73"], $data, [$this->identity_column => $identity]); goto jB3cE; seNHG: MbAZU: goto fCPmT; jB3cE: return $this->db->affected_rows() == 1; goto jDs3M; kUoRd: $this->trigger_events("\145\x78\x74\162\x61\x5f\x77\150\x65\162\145"); goto MFpbb; fCPmT: $data = ["\x70\x61\163\163\167\x6f\x72\x64" => $hash, "\x72\145\x6d\145\x6d\142\x65\x72\x5f\x63\157\144\x65" => NULL, "\x66\157\162\147\157\x74\164\145\156\137\160\141\163\163\167\x6f\162\x64\137\x63\x6f\144\x65" => NULL, "\x66\157\162\x67\157\164\x74\x65\156\137\160\x61\163\163\167\157\x72\x64\x5f\164\x69\155\x65" => NULL]; goto kUoRd; wEtk0: if (!($hash === FALSE)) { goto MbAZU; } goto eURWo; jDs3M: } protected function _filter_data($table, $data) { goto B7Fri; hvZI2: HJNnO: goto sitsS; WLMea: rmmrv: goto hvZI2; oyruG: $columns = $this->db->list_fields($table); goto QK3wZ; B7Fri: $filtered_data = []; goto oyruG; NLRwC: foreach ($columns as $column) { goto XgtqE; XgtqE: if (!array_key_exists($column, $data)) { goto J_Epl; } goto LIH2r; XBmfO: J_Epl: goto BPAKh; BPAKh: kjsnF: goto I7BQd; LIH2r: $filtered_data[$column] = $data[$column]; goto XBmfO; I7BQd: } goto WLMea; QK3wZ: if (!is_array($data)) { goto HJNnO; } goto NLRwC; sitsS: return $filtered_data; goto ka0bW; ka0bW: } protected function _random_token($result_length = 32) { goto JmhNI; WRb5h: return bin2hex(random_bytes($result_length / 2)); goto r3jXu; Kst2Q: bM21H: goto JsYPO; NjZtJ: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto Kst2Q; XOpYT: $result_length = 32; goto FstK3; JsYPO: return FALSE; goto nwWVC; JmhNI: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto X2nsK; } goto XOpYT; LRSu3: if (!function_exists("\155\x63\x72\x79\160\x74\137\143\162\145\141\164\x65\x5f\151\x76")) { goto oqdbx; } goto Xm9_g; Xm9_g: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto h89e3; tJ81p: if (!function_exists("\x6f\160\145\x6e\x73\x73\154\137\x72\x61\156\144\x6f\x6d\137\160\x73\145\x75\x64\x6f\x5f\142\x79\x74\145\163")) { goto bM21H; } goto NjZtJ; r3jXu: sNH91: goto LRSu3; h89e3: oqdbx: goto tJ81p; FstK3: X2nsK: goto BPMge; BPMge: if (!function_exists("\x72\x61\x6e\x64\x6f\155\x5f\x62\x79\164\145\x73")) { goto sNH91; } goto WRb5h; nwWVC: } protected function _get_hash_parameters($identity = NULL) { goto BenTs; bMjS_: switch ($this->hash_method) { case "\142\143\x72\x79\x70\x74": $params = ["\143\x6f\163\164" => $is_admin ? $this->config->item("\142\x63\162\171\x70\x74\x5f\x61\144\x6d\x69\156\137\143\x6f\x73\164", "\151\157\x6e\x5f\x61\165\x74\x68") : $this->config->item("\x62\x63\x72\x79\160\x74\x5f\144\145\x66\x61\x75\154\x74\x5f\x63\x6f\x73\x74", "\x69\157\x6e\x5f\x61\165\164\150")]; goto KLE8W; case "\141\x72\147\157\156\x32": $params = $is_admin ? $this->config->item("\141\x72\x67\157\x6e\x32\x5f\x61\x64\155\151\x6e\x5f\x70\x61\x72\x61\x6d\x73", "\x69\x6f\156\137\x61\x75\x74\150") : $this->config->item("\141\162\x67\157\156\x32\137\x64\145\146\x61\165\154\x74\137\x70\141\x72\x61\155\163", "\151\157\156\137\141\x75\x74\150"); goto KLE8W; default: } goto zUcSW; BMDlF: tCb9e: goto w0Phm; gCgq6: QNFvg: goto BMDlF; MEsvs: if (!($user_id && $this->in_group($this->config->item("\x61\144\155\151\156\x5f\147\162\157\x75\x70", "\151\157\156\137\141\x75\x74\x68"), $user_id))) { goto QNFvg; } goto mm5BD; mm5BD: $is_admin = TRUE; goto gCgq6; BenTs: $is_admin = FALSE; goto LX9g3; TT28M: return $params; goto GFco3; zUcSW: aUa5e: goto s7hdY; s7hdY: KLE8W: goto TT28M; NLJUp: $user_id = $this->get_user_id_from_identity($identity); goto MEsvs; LX9g3: if (!$identity) { goto tCb9e; } goto NLJUp; w0Phm: $params = FALSE; goto bMjS_; GFco3: } protected function _get_hash_algo() { goto WzvPN; VcYCx: switch ($this->hash_method) { case "\x62\x63\x72\x79\x70\164": $algo = PASSWORD_BCRYPT; goto jBBRG; case "\141\x72\147\157\156\62": $algo = PASSWORD_ARGON2I; goto jBBRG; default: } goto Gdej1; KwIvr: jBBRG: goto RtjQd; Gdej1: r5rI3: goto KwIvr; RtjQd: return $algo; goto PJiHr; WzvPN: $algo = FALSE; goto VcYCx; PJiHr: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto D089Y; tVjYk: $user_code = "{$selector}\x2e{$validator}"; goto ctSgQ; ctSgQ: return (object) ["\163\145\x6c\145\x63\x74\157\162" => $selector, "\x76\x61\154\x69\x64\141\164\x6f\162\137\x68\141\x73\150\145\144" => $validator_hashed, "\165\163\145\162\x5f\x63\x6f\x64\145" => $user_code]; goto vsVD_; S4Ute: $validator_hashed = $this->hash_password($validator); goto tVjYk; npWsU: $validator = $this->_random_token($validator_size); goto S4Ute; D089Y: $selector = $this->_random_token($selector_size); goto npWsU; vsVD_: } protected function _retrieve_selector_validator_couple($user_code) { goto Iv2Ec; t0dSY: return (object) ["\163\145\x6c\145\143\164\x6f\x72" => $tokens[0], "\166\141\x6c\x69\x64\141\164\157\162" => $tokens[1]]; goto dGH4w; GDnUG: Ge9Rd: goto MiUo2; Iv2Ec: if (!$user_code) { goto Ge9Rd; } goto JtrCy; dGH4w: rKztV: goto GDnUG; JtrCy: $tokens = explode("\x2e", $user_code); goto VrHzg; VrHzg: if (!(count($tokens) === 2)) { goto rKztV; } goto t0dSY; MiUo2: return FALSE; goto M1DH4; M1DH4: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto lYFTJ; Yo4VB: $this->trigger_events(["\x70\x6f\x73\164\x5f\x73\150\141\x31\137\x70\141\163\x73\x77\157\162\144\x5f\x6d\151\x67\162\x61\x74\x69\x6f\156", "\160\157\x73\x74\x5f\163\150\141\61\x5f\x70\141\x73\x73\167\157\x72\144\137\x6d\x69\x67\162\141\164\x69\x6f\x6e\137\x75\x6e\163\x75\x63\x63\x65\x73\x73\x66\x75\154"]); goto SGMCq; uwCZI: MU4PH: goto Tad7e; bmdRy: goto rPFfs; goto o7mFW; J4X07: $this->trigger_events(["\160\x6f\163\x74\137\x73\150\x61\61\137\x70\141\163\x73\167\157\x72\144\137\x6d\151\147\162\141\x74\151\x6f\x6e", "\160\x6f\x73\164\x5f\163\150\x61\61\137\160\141\163\x73\167\157\x72\x64\137\155\x69\x67\162\141\x74\x69\x6f\x6e\137\165\x6e\x73\165\x63\x63\145\x73\x73\x66\165\x6c"]); goto bmdRy; Y6rue: KYRLu: goto DfnoK; KWjWd: rPFfs: goto vTgsc; Tad7e: $query = $this->db->select("\163\x61\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\145\162\x73"]); goto KkOTQ; lYFTJ: $this->trigger_events("\x70\162\145\x5f\163\150\x61\x31\137\x70\141\x73\x73\167\157\x72\144\137\x6d\x69\147\162\141\164\x69\x6f\x6e"); goto dm0E3; uDrQc: return FALSE; goto HsZPt; o7mFW: PFHqB: goto yfwmV; uBmbS: return FALSE; goto Y6rue; vIsNz: if ($hashed_password === $hashed_password_db) { goto CXqks; } goto Rp1lM; l3IiP: if ($result) { goto PFHqB; } goto J4X07; o1WL7: $salt_length = $this->config->item("\163\141\x6c\164\x5f\154\145\x6e\147\x74\150", "\151\157\x6e\x5f\x61\x75\x74\x68"); goto n72p9; QQpOz: if (!($query->num_rows() !== 1)) { goto m34Y9; } goto Yo4VB; Rp1lM: $this->trigger_events(["\160\x6f\x73\x74\137\x73\150\x61\61\137\160\141\x73\163\x77\157\162\x64\137\155\x69\147\162\x61\164\151\x6f\156", "\160\157\x73\x74\x5f\x73\150\141\x31\x5f\x70\x61\163\163\x77\157\x72\144\x5f\155\151\x67\x72\x61\164\151\157\156\137\x75\x6e\163\x75\143\x63\x65\163\163\x66\165\154"]); goto uDrQc; yfwmV: $this->trigger_events(["\160\157\163\x74\137\x73\x68\141\61\x5f\x70\141\163\x73\x77\x6f\162\x64\137\155\151\147\162\x61\164\x69\x6f\156", "\x70\157\x73\x74\x5f\163\x68\x61\61\137\160\x61\163\163\x77\x6f\x72\x64\x5f\x6d\x69\x67\162\141\164\x69\157\x6e\x5f\163\165\143\x63\145\163\163\146\165\x6c"]); goto KWjWd; V3ORI: DFOA4: goto ijDtf; n72p9: if ($salt_length) { goto KYRLu; } goto ToQov; SGMCq: return FALSE; goto wrUex; KkOTQ: $salt_db = $query->row(); goto QQpOz; JsGHc: goto IGayB; goto uwCZI; B07wK: IGayB: goto vIsNz; GoAWW: CXqks: goto O1xyF; DfnoK: $salt = substr($hashed_password_db, 0, $salt_length); goto qjh8p; O1xyF: $result = $this->_set_password_db($identity, $password); goto l3IiP; ToQov: $this->trigger_events(["\160\x6f\x73\164\x5f\163\150\141\61\x5f\x70\x61\x73\163\x77\157\x72\x64\137\x6d\x69\147\162\141\164\151\157\156", "\160\157\163\164\137\x73\150\x61\x31\137\x70\x61\163\163\x77\x6f\162\144\137\x6d\151\x67\x72\x61\x74\151\157\x6e\x5f\165\x6e\x73\165\143\x63\145\x73\163\146\165\x6c"]); goto uBmbS; qjh8p: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto JsGHc; wrUex: m34Y9: goto ejmES; HsZPt: goto DFOA4; goto GoAWW; vTgsc: return $result; goto V3ORI; ejmES: $hashed_password = sha1($password . $salt_db->salt); goto B07wK; dm0E3: if ($this->config->item("\163\x74\x6f\162\145\137\163\141\x6c\164", "\x69\x6f\156\137\x61\x75\x74\x68")) { goto MU4PH; } goto o1WL7; ijDtf: } }
