<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\105\x50\101\x54\110") or exit("\116\157\40\x64\151\162\x65\x63\164\40\x73\143\x72\x69\160\164\x20\x61\143\x63\145\x73\163\x20\141\x6c\154\x6f\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; private $identity_column; private $join; private $hash_method; private $message_start_delimiter; private $message_end_delimiter; public function __construct() { goto WCe43; lSgaQ: $this->message_end_delimiter = $this->error_end_delimiter; goto ITkde; NnccJ: $this->hash_method = $this->config->item("\150\141\x73\150\x5f\x6d\145\164\150\157\144", "\x69\x6f\x6e\x5f\141\x75\x74\x68"); goto bfpX5; KeVku: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto Noou1; Noou1: $this->message_start_delimiter = $this->error_start_delimiter; goto N4xqJ; kh4j1: $error_prefix = $form_validation_class->getProperty("\137\x65\x72\x72\x6f\x72\137\x70\162\x65\146\x69\170"); goto EAox1; sGvUU: if (empty($group_name)) { goto fQDVN; } goto Top6N; N4xqJ: $error_suffix = $form_validation_class->getProperty("\137\145\x72\x72\157\x72\137\163\165\146\x66\x69\x78"); goto i6ZPL; gx7CV: $CI =& get_instance(); goto hAwok; hAwok: $this->db = $CI->db; goto b_jPv; T0Na7: $this->trigger_events("\x6d\x6f\144\145\x6c\137\143\157\x6e\163\x74\x72\x75\143\x74\157\x72"); goto Cua1a; W6YHa: $this->identity_column = $this->config->item("\151\144\x65\x6e\164\x69\164\171", "\151\x6f\156\x5f\x61\x75\164\x68"); goto J3DZs; EAox1: $error_prefix->setAccessible(TRUE); goto KeVku; zbCjc: lrW4d: goto SX76h; bX6mq: $this->lang->load("\x69\157\156\x5f\x61\165\x74\150"); goto RO6BC; b_jPv: vS2dp: goto tTc_x; k7Vt6: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto lSgaQ; J3DZs: $this->join = $this->config->item("\152\157\151\x6e", "\x69\157\156\137\x61\x75\x74\x68"); goto NnccJ; cwzHT: $this->error_start_delimiter = $this->config->item("\x65\162\x72\157\162\137\x73\164\141\x72\164\x5f\144\145\154\x69\155\x69\x74\145\162", "\x69\x6f\156\x5f\141\165\x74\150"); goto qZ65V; Tssc2: $this->errors = []; goto kmuFz; kmuFz: $delimiters_source = $this->config->item("\x64\x65\x6c\x69\155\x69\164\145\x72\163\137\163\x6f\165\162\143\x65", "\x69\x6f\156\x5f\x61\165\x74\x68"); goto ofx14; qZ65V: $this->error_end_delimiter = $this->config->item("\x65\162\162\x6f\162\x5f\x65\156\144\x5f\x64\x65\154\151\155\x69\x74\145\x72", "\x69\x6f\156\137\x61\x75\x74\150"); goto FctAj; cNnb2: $this->load->helper("\x63\x6f\x6f\153\151\x65"); goto ua873; ua873: $this->load->helper("\144\x61\164\x65"); goto bX6mq; vfwHe: $this->message_end_delimiter = $this->config->item("\x6d\145\x73\x73\x61\x67\x65\x5f\x65\x6e\144\137\x64\145\x6c\151\155\151\164\x65\162", "\151\157\x6e\x5f\x61\165\x74\x68"); goto cwzHT; UR5Vi: $form_validation_class = new ReflectionClass("\x43\111\137\106\x6f\162\155\x5f\x76\x61\x6c\x69\144\141\164\151\x6f\156"); goto kh4j1; tTc_x: $this->tables = $this->config->item("\x74\x61\142\154\145\x73", "\x69\x6f\x6e\137\141\165\x74\150"); goto W6YHa; WCe43: $this->config->load("\x69\157\156\137\x61\165\x74\x68", TRUE); goto cNnb2; s0X6R: fQDVN: goto gx7CV; bfpX5: $this->messages = []; goto Tssc2; oPE2z: goto vS2dp; goto s0X6R; SX76h: $this->load->library("\x66\x6f\162\x6d\x5f\166\x61\x6c\151\144\x61\164\x69\x6f\156"); goto UR5Vi; i6ZPL: $error_suffix->setAccessible(TRUE); goto k7Vt6; Top6N: $this->db = $this->load->database($group_name, TRUE, TRUE); goto oPE2z; ITkde: vOz4b: goto xMZmf; GdlEH: $this->message_start_delimiter = $this->config->item("\x6d\x65\x73\163\x61\147\145\x5f\163\164\x61\162\164\x5f\144\145\154\x69\155\x69\164\145\x72", "\151\x6f\156\x5f\141\x75\164\150"); goto vfwHe; RO6BC: $group_name = $this->config->item("\x64\141\164\141\x62\141\163\145\x5f\x67\x72\x6f\165\160\137\156\141\x6d\145", "\x69\x6f\156\137\x61\165\x74\150"); goto sGvUU; FctAj: goto vOz4b; goto zbCjc; xMZmf: $this->_ion_hooks = new stdClass(); goto T0Na7; ofx14: if ($delimiters_source === "\x66\157\162\155\x5f\166\141\154\x69\144\x61\x74\151\157\x6e") { goto lrW4d; } goto GdlEH; Cua1a: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto vMcm5; A1gjB: VwjTg: goto qSRuz; vMcm5: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto kXIyg; } goto qX0n2; qX0n2: return FALSE; goto ZXjsX; YtA0i: $params = $this->_get_hash_parameters($identity); goto eMmKD; ZXjsX: kXIyg: goto qLxru; eMmKD: if (!($algo !== FALSE && $params !== FALSE)) { goto VwjTg; } goto Gf_t1; qSRuz: return FALSE; goto vx7eD; Gf_t1: return password_hash($password, $algo, $params); goto A1gjB; qLxru: $algo = $this->_get_hash_algo(); goto YtA0i; vx7eD: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto xvuI3; uFzrc: XeEdI: goto A8nkr; gdxyz: goto tznBy; goto uFzrc; qlNX3: tznBy: goto nvCmZ; A8nkr: return password_verify($password, $hash_password_db); goto qlNX3; khBkA: if (strpos($hash_password_db, "\x24") === 0) { goto XeEdI; } goto iXJxd; c9BpW: afBRF: goto khBkA; Wpu0l: return FALSE; goto c9BpW; iXJxd: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto gdxyz; xvuI3: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto afBRF; } goto Wpu0l; nvCmZ: } public function rehash_password_if_needed($hash, $identity, $password) { goto QRskr; uXPoa: goto T7wQZ; goto LLN9z; LLN9z: dEbKj: goto VEJp6; mP6FZ: if (!password_needs_rehash($hash, $algo, $params)) { goto RMMck; } goto PCwlj; VEJp6: $this->trigger_events(["\x72\x65\150\x61\x73\150\137\x70\x61\163\x73\x77\157\x72\x64", "\162\145\150\x61\163\x68\x5f\160\x61\x73\x73\x77\157\162\x64\137\x73\165\x63\143\145\163\x73\x66\x75\x6c"]); goto n0fOm; QRskr: $algo = $this->_get_hash_algo(); goto bgspj; hheSe: RMMck: goto r4HJ9; r4HJ9: nv7LO: goto NIftZ; bgspj: $params = $this->_get_hash_parameters($identity); goto VI3xk; PCwlj: if ($this->_set_password_db($identity, $password)) { goto dEbKj; } goto RPEa1; n0fOm: T7wQZ: goto hheSe; VI3xk: if (!($algo !== FALSE && $params !== FALSE)) { goto nv7LO; } goto mP6FZ; RPEa1: $this->trigger_events(["\x72\x65\150\x61\163\150\137\x70\141\x73\163\167\x6f\x72\144", "\x72\145\x68\141\163\x68\137\160\141\163\163\167\x6f\x72\x64\137\165\156\x73\x75\x63\x63\x65\x73\163\146\x75\154"]); goto uXPoa; NIftZ: } public function get_user_by_activation_code($user_code) { goto LLTxM; LLTxM: $token = $this->_retrieve_selector_validator_couple($user_code); goto MuxjA; fbroX: return FALSE; goto wqZ_s; IcjRi: BZ2Ab: goto fbroX; DCIT0: return $user; goto ruiGW; MuxjA: $user = $this->where("\x61\x63\x74\x69\x76\141\164\151\x6f\x6e\137\x73\x65\154\x65\143\x74\157\x72", $token->selector)->users()->row(); goto SxYZn; roSqV: if (!$this->verify_password($token->validator, $user->activation_code)) { goto cZ6O0; } goto DCIT0; SxYZn: if (!$user) { goto BZ2Ab; } goto roSqV; ruiGW: cZ6O0: goto IcjRi; wqZ_s: } public function activate($id, $code = FALSE) { goto l1IdD; l1IdD: $this->trigger_events("\160\x72\145\137\x61\x63\164\x69\166\x61\x74\145"); goto xalzv; jHR3n: $this->set_message("\x61\143\x74\x69\166\141\x74\x65\x5f\163\x75\x63\143\145\163\163\146\165\154"); goto Wl6hz; ROAwC: if (!($this->db->affected_rows() === 1)) { goto xIjrb; } goto xpbP2; xalzv: if (!($code !== FALSE)) { goto VaAVB; } goto o97bB; QqwXT: $this->trigger_events("\145\x78\164\162\x61\137\167\150\145\x72\x65"); goto ehDKq; xpbP2: $this->trigger_events(["\160\157\163\x74\x5f\x61\x63\x74\151\x76\141\x74\145", "\x70\x6f\x73\x74\137\141\143\164\151\166\x61\164\145\x5f\x73\165\x63\143\x65\163\x73\146\x75\154"]); goto jHR3n; H_i0j: if (!($code === FALSE || $user && $user->id === $id)) { goto Z5hWn; } goto Gh148; YC_VD: $this->set_error("\141\143\164\151\166\x61\164\145\137\165\x6e\163\165\x63\143\145\163\x73\x66\x75\154"); goto TwHqD; nfIJY: VaAVB: goto H_i0j; Gt8VB: Z5hWn: goto OS0Rt; Wl6hz: return TRUE; goto axb0f; o97bB: $user = $this->get_user_by_activation_code($code); goto nfIJY; Gh148: $data = ["\141\143\164\151\x76\141\164\151\x6f\x6e\x5f\x73\x65\x6c\145\x63\164\157\x72" => NULL, "\141\143\164\151\x76\x61\x74\x69\157\156\137\143\x6f\x64\145" => NULL, "\x61\x63\164\x69\x76\x65" => 1]; goto QqwXT; OS0Rt: $this->trigger_events(["\160\157\163\164\137\141\143\164\x69\166\141\x74\x65", "\x70\x6f\163\x74\137\x61\143\164\x69\x76\x61\x74\145\137\165\x6e\x73\165\x63\x63\145\x73\163\x66\x75\154"]); goto YC_VD; ehDKq: $this->db->update($this->tables["\x75\163\x65\x72\163"], $data, ["\x69\144" => $id]); goto ROAwC; axb0f: xIjrb: goto Gt8VB; TwHqD: return FALSE; goto FQ50d; FQ50d: } public function deactivate($id = NULL) { goto wy0mG; kOR02: $data = ["\x61\x63\164\x69\x76\x61\x74\151\x6f\156\x5f\x73\x65\154\x65\143\164\x6f\x72" => $token->selector, "\x61\143\x74\x69\166\x61\x74\x69\x6f\156\x5f\x63\157\x64\x65" => $token->validator_hashed, "\x61\x63\x74\x69\x76\145" => 0]; goto R9rac; wy0mG: $this->trigger_events("\x64\145\141\x63\164\151\x76\x61\x74\x65"); goto CuFEJ; Zk_dU: $this->activation_code = $token->user_code; goto kOR02; w8Vep: $this->set_error("\x64\145\141\x63\x74\x69\x76\141\x74\145\137\165\x6e\163\165\143\143\x65\163\x73\x66\x75\154"); goto bbMDI; zvkE2: uoQQ_: goto L2ADx; zUzFb: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto Pzn_I; } goto cmOnK; RKTAv: fxhpW: goto SldXP; rjRuK: AOaqQ: goto WGkD6; ySM3A: $return = $this->db->affected_rows() == 1; goto K6JTl; cmOnK: $this->set_error("\x64\x65\x61\143\x74\151\x76\141\164\x65\137\x63\165\162\162\x65\x6e\x74\x5f\165\x73\145\x72\137\x75\x6e\x73\165\x63\143\x65\163\x73\x66\x75\154"); goto Rodos; POoxO: goto EmeeQ; goto rjRuK; XK_Yp: Pzn_I: goto POoxO; HjQxD: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, ["\x69\144" => $id]); goto ySM3A; SldXP: $this->set_message("\144\145\141\143\164\151\166\141\164\x65\137\x73\x75\x63\x63\x65\163\x73\146\165\x6c"); goto zvkE2; Rodos: return FALSE; goto XK_Yp; K6JTl: if ($return) { goto fxhpW; } goto w8Vep; CuFEJ: if (!isset($id)) { goto AOaqQ; } goto zUzFb; UMQ4u: return FALSE; goto yI29s; FZZpI: $token = $this->_generate_selector_validator_couple(20, 40); goto Zk_dU; yI29s: EmeeQ: goto FZZpI; L2ADx: return $return; goto O2F4v; R9rac: $this->trigger_events("\x65\170\164\162\141\x5f\x77\150\145\x72\x65"); goto HjQxD; WGkD6: $this->set_error("\x64\x65\141\x63\x74\x69\166\x61\x74\145\137\x75\x6e\163\165\x63\143\x65\x73\163\x66\165\x6c"); goto UMQ4u; bbMDI: goto uoQQ_; goto RKTAv; O2F4v: } public function clear_forgotten_password_code($identity) { goto c9_yA; lFCYs: return TRUE; goto cdzO_; gMswV: $data = ["\x66\157\162\147\157\164\x74\145\156\x5f\160\141\163\163\167\157\x72\x64\137\x73\145\154\145\143\x74\157\162" => NULL, "\x66\x6f\162\147\157\x74\164\145\x6e\137\160\x61\x73\163\x77\157\162\144\137\143\157\x64\145" => NULL, "\x66\x6f\162\147\157\x74\x74\x65\156\x5f\x70\x61\163\163\167\x6f\x72\144\137\x74\151\155\x65" => NULL]; goto whz2E; c9_yA: if (!empty($identity)) { goto e4scs; } goto FxtMs; X7aHE: e4scs: goto gMswV; FxtMs: return FALSE; goto X7aHE; whz2E: $this->db->update($this->tables["\165\x73\x65\x72\163"], $data, [$this->identity_column => $identity]); goto lFCYs; cdzO_: } public function clear_remember_code($identity) { goto fyUYd; qPl4B: $this->db->update($this->tables["\165\163\x65\162\163"], $data, [$this->identity_column => $identity]); goto oLkyL; oLkyL: return TRUE; goto kd5Qh; oCCwI: return FALSE; goto JQO3G; eNvpN: $data = ["\x72\145\x6d\x65\155\142\x65\162\137\163\145\154\145\143\x74\157\162" => NULL, "\162\145\155\x65\155\142\x65\162\x5f\x63\157\144\145" => NULL]; goto qPl4B; JQO3G: WkND1: goto eNvpN; fyUYd: if (!empty($identity)) { goto WkND1; } goto oCCwI; kd5Qh: } public function reset_password($identity, $new) { goto B4mJ5; QhuBQ: Xh3Ya: goto Qw01Z; YVIS2: return FALSE; goto Y2PqB; WruvK: $this->trigger_events(["\160\157\x73\x74\x5f\x63\150\141\156\x67\x65\x5f\160\141\163\163\x77\x6f\x72\144", "\x70\157\163\164\137\143\x68\141\x6e\147\x65\x5f\160\141\163\163\x77\x6f\x72\x64\137\x75\x6e\x73\165\x63\143\145\163\163\146\165\154"]); goto YVIS2; pNEVe: MeNug: goto nP24g; B4mJ5: $this->trigger_events("\160\x72\x65\137\x63\150\x61\x6e\x67\x65\137\160\x61\163\163\x77\157\x72\x64"); goto EpiV6; oAq6y: $this->set_error("\160\141\x73\x73\x77\x6f\x72\144\x5f\x63\150\141\156\x67\145\137\x75\x6e\x73\x75\x63\143\145\163\163\146\x75\x6c"); goto X7IHR; nP24g: return $return; goto KeJqk; vCog_: $return = $this->_set_password_db($identity, $new); goto UwSdr; Qw01Z: $this->trigger_events(["\160\x6f\x73\x74\x5f\x63\150\141\156\x67\x65\x5f\x70\x61\x73\x73\x77\x6f\162\144", "\x70\x6f\x73\164\137\143\150\141\156\x67\145\x5f\x70\x61\163\163\167\x6f\x72\144\137\163\165\143\x63\x65\x73\163\x66\165\154"]); goto g7ZcU; g7ZcU: $this->set_message("\x70\x61\163\x73\x77\x6f\x72\144\x5f\x63\x68\x61\156\147\x65\137\163\165\143\143\145\x73\x73\146\x75\x6c"); goto pNEVe; EpiV6: if ($this->identity_check($identity)) { goto MA7VH; } goto WruvK; BC6hb: $this->trigger_events(["\160\x6f\x73\x74\137\143\x68\x61\x6e\147\x65\x5f\x70\141\x73\163\167\x6f\162\x64", "\x70\157\163\x74\137\143\x68\x61\156\147\145\x5f\160\x61\x73\163\167\157\x72\x64\137\x75\156\163\x75\143\143\x65\163\163\x66\x75\x6c"]); goto oAq6y; UwSdr: if ($return) { goto Xh3Ya; } goto BC6hb; X7IHR: goto MeNug; goto QhuBQ; Y2PqB: MA7VH: goto vCog_; KeJqk: } public function change_password($identity, $old, $new) { goto ZbRk_; AtrwU: $this->trigger_events(["\x70\157\x73\164\x5f\x63\x68\141\x6e\147\145\x5f\x70\141\163\163\x77\157\162\x64", "\x70\157\163\x74\x5f\143\150\x61\156\147\145\137\160\x61\x73\x73\x77\157\162\x64\x5f\x75\x6e\x73\165\143\143\145\x73\x73\x66\x75\x6c"]); goto mIXeq; kt0wW: pJnP4: goto IL2MN; mIXeq: $this->set_error("\160\141\x73\163\x77\157\x72\144\137\x63\150\141\x6e\x67\x65\137\165\x6e\x73\x75\x63\x63\x65\163\163\146\165\154"); goto jJbqO; CQ1w_: if (!($query->num_rows() !== 1)) { goto ID149; } goto AtrwU; PlnDK: $this->set_message("\x70\141\163\x73\x77\157\x72\x64\x5f\x63\150\141\156\x67\x65\137\163\165\x63\143\145\x73\x73\x66\x75\154"); goto ZNaVA; VSpW7: ID149: goto FJoZ2; THCob: $this->trigger_events(["\160\157\x73\164\137\x63\150\x61\x6e\147\145\137\x70\141\163\x73\167\x6f\162\x64", "\160\157\x73\164\x5f\143\x68\x61\156\x67\x65\137\x70\x61\x73\163\167\x6f\162\x64\137\x75\x6e\163\165\143\143\145\163\x73\x66\165\x6c"]); goto wnp4m; sgmBz: fnHaF: goto fFT0K; RJiNL: $query = $this->db->select("\x69\144\54\x20\160\141\x73\x73\x77\x6f\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\144\x65\163\143")->get($this->tables["\x75\x73\x65\162\x73"]); goto CQ1w_; XBEHH: $result = $this->_set_password_db($identity, $new); goto D9SJw; wnp4m: $this->set_error("\160\x61\163\163\167\x6f\x72\x64\137\x63\150\141\x6e\147\x65\x5f\x75\x6e\163\x75\x63\143\x65\x73\x73\x66\x75\154"); goto wRW43; ZNaVA: uSKjl: goto id4Qb; jJbqO: return FALSE; goto VSpW7; FJoZ2: $user = $query->row(); goto VGrDJ; VGrDJ: if (!$this->verify_password($old, $user->password, $identity)) { goto pJnP4; } goto XBEHH; jRFwy: return FALSE; goto q5hln; wRW43: goto uSKjl; goto sgmBz; ZbRk_: $this->trigger_events("\160\162\145\x5f\x63\x68\141\x6e\147\145\137\x70\x61\x73\x73\x77\x6f\x72\x64"); goto l8mon; IL2MN: $this->set_error("\160\141\x73\x73\x77\x6f\x72\x64\137\143\x68\141\x6e\x67\145\137\x75\x6e\163\x75\143\x63\x65\x73\163\x66\165\154"); goto jRFwy; l8mon: $this->trigger_events("\x65\170\164\x72\141\x5f\167\x68\x65\x72\x65"); goto RJiNL; fFT0K: $this->trigger_events(["\160\157\x73\164\137\143\x68\141\156\147\145\x5f\x70\141\163\x73\x77\x6f\162\x64", "\160\x6f\163\x74\137\x63\150\x61\156\147\x65\137\x70\x61\x73\x73\x77\157\x72\144\x5f\x73\x75\143\143\x65\163\163\x66\165\154"]); goto PlnDK; id4Qb: return $result; goto kt0wW; D9SJw: if ($result) { goto fnHaF; } goto THCob; q5hln: } public function username_check($username = '') { goto fPuiW; fPuiW: $this->trigger_events("\165\163\145\x72\156\x61\155\x65\x5f\143\x68\x65\x63\153"); goto O1WL3; pn7SB: return $this->db->where("\x75\x73\145\x72\x6e\x61\x6d\145", $username)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\163"]) > 0; goto Manmf; O1WL3: if (!empty($username)) { goto bnzHx; } goto n7bsJ; I8_co: bnzHx: goto ytb_u; n7bsJ: return FALSE; goto I8_co; ytb_u: $this->trigger_events("\145\170\x74\x72\141\x5f\167\150\145\162\x65"); goto pn7SB; Manmf: } public function email_check($email = '') { goto rLQ1m; rLQ1m: $this->trigger_events("\145\155\141\x69\154\x5f\143\150\145\143\x6b"); goto PQ4F9; MmJDt: ckgux: goto BWRdP; PQ4F9: if (!empty($email)) { goto ckgux; } goto ISiYk; MGtPL: return $this->db->where("\145\x6d\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\x75\x73\x65\162\163"]) > 0; goto nwMfL; BWRdP: $this->trigger_events("\x65\170\x74\x72\141\x5f\167\x68\x65\162\x65"); goto MGtPL; ISiYk: return FALSE; goto MmJDt; nwMfL: } public function identity_check($identity = '') { goto aQEZM; aQEZM: $this->trigger_events("\x69\x64\145\156\164\151\x74\x79\137\x63\150\145\x63\153"); goto Bxsz7; jJ5S1: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\145\x72\x73"]) > 0; goto wURbL; lzCRT: BWLRm: goto jJ5S1; QwxEG: return FALSE; goto lzCRT; Bxsz7: if (!empty($identity)) { goto BWLRm; } goto QwxEG; wURbL: } public function get_user_id_from_identity($identity = '') { goto BSV1y; MWhJ6: $user = $query->row(); goto pP7ur; TjKlG: return FALSE; goto yiPjI; RJTpn: kW9v1: goto MWhJ6; BSV1y: if (!empty($identity)) { goto ELnNN; } goto TjKlG; siI47: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\x65\162\163"]); goto R3Xs7; yiPjI: ELnNN: goto siI47; mOrza: return FALSE; goto RJTpn; pP7ur: return $user->id; goto Sv5zC; R3Xs7: if (!($query->num_rows() !== 1)) { goto kW9v1; } goto mOrza; Sv5zC: } public function forgotten_password($identity) { goto ubMot; kJ_Po: $token = $this->_generate_selector_validator_couple(20, 80); goto iM25M; fFO5a: $this->trigger_events("\x65\x78\x74\x72\x61\137\x77\150\145\162\145"); goto LdAtC; khyeo: if ($this->db->affected_rows() === 1) { goto m4pSd; } goto wausV; WBi1C: return $token->user_code; goto zPwiz; MD7AQ: return FALSE; goto uPW10; zX1ia: $this->trigger_events(["\160\x6f\x73\164\137\146\157\x72\x67\157\164\164\x65\x6e\x5f\160\x61\163\163\167\x6f\162\x64", "\x70\x6f\163\164\137\146\x6f\x72\x67\157\164\x74\x65\156\137\x70\141\x73\x73\x77\x6f\x72\x64\x5f\163\x75\x63\143\145\163\163\146\165\x6c"]); goto WBi1C; BLZHU: return FALSE; goto nERL6; nERL6: goto kCzuf; goto L3lhF; uPW10: jCLss: goto kJ_Po; L3lhF: m4pSd: goto zX1ia; wausV: $this->trigger_events(["\160\157\x73\x74\x5f\146\157\x72\147\x6f\164\164\145\x6e\x5f\x70\x61\163\x73\x77\157\162\144", "\x70\157\x73\x74\x5f\x66\x6f\162\x67\x6f\164\x74\x65\156\x5f\160\141\163\163\167\x6f\162\144\137\x75\156\163\x75\143\x63\145\163\x73\x66\x75\154"]); goto BLZHU; zPwiz: kCzuf: goto Nng27; iM25M: $update = ["\x66\157\x72\x67\x6f\x74\x74\145\156\137\160\x61\163\x73\167\x6f\162\144\137\163\145\154\145\143\164\157\162" => $token->selector, "\146\x6f\162\x67\x6f\164\164\x65\x6e\137\x70\141\x73\x73\x77\157\x72\144\137\143\x6f\144\145" => $token->validator_hashed, "\146\x6f\162\x67\x6f\x74\x74\x65\x6e\137\x70\x61\163\x73\x77\157\x72\x64\137\x74\x69\x6d\145" => time()]; goto fFO5a; LdAtC: $this->db->update($this->tables["\x75\x73\145\162\x73"], $update, [$this->identity_column => $identity]); goto khyeo; H_RFP: $this->trigger_events(["\160\x6f\x73\164\x5f\x66\x6f\x72\147\x6f\164\164\145\x6e\x5f\160\x61\x73\163\167\157\162\x64", "\x70\x6f\163\x74\137\x66\x6f\x72\147\x6f\164\x74\145\x6e\x5f\160\141\x73\x73\x77\x6f\x72\144\x5f\165\156\163\x75\x63\x63\x65\163\x73\146\165\x6c"]); goto MD7AQ; ubMot: if (!empty($identity)) { goto jCLss; } goto H_RFP; Nng27: } public function get_user_by_forgotten_password_code($user_code) { goto aJCGk; RXBI8: $user = $this->where("\146\157\x72\x67\157\164\164\x65\156\137\160\141\163\163\167\157\x72\x64\137\x73\x65\154\145\143\x74\x6f\162", $token->selector)->users()->row(); goto Hdxge; Hdxge: if (!$user) { goto iRfPi; } goto hs842; RcUVA: return $user; goto Od1au; jhVP4: iRfPi: goto MxlFx; hs842: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto a375s; } goto RcUVA; Od1au: a375s: goto jhVP4; MxlFx: return FALSE; goto Loh0o; aJCGk: $token = $this->_retrieve_selector_validator_couple($user_code); goto RXBI8; Loh0o: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto l9vnv; bVWGx: return FALSE; goto rwRLo; d0RxP: if (!(!isset($query->id) && empty($groups))) { goto w70Vn; } goto mHRqM; alZ6e: return isset($id) ? $id : FALSE; goto qfCih; QLSBO: $this->set_error("\x61\x63\143\x6f\165\156\164\x5f\143\x72\145\x61\164\151\x6f\x6e\x5f\155\x69\163\163\151\156\147\137\x64\x65\146\x61\x75\x6c\x74\x5f\147\x72\157\165\160"); goto BGdsU; BGdsU: return FALSE; goto ZksfN; ZksfN: o5jzw: goto uKLCu; YuLwj: $this->db->insert($this->tables["\x75\163\145\x72\x73"], $user_data); goto EFMJE; gxL6y: hYkYz: goto c_zCx; uKLCu: goto GO73d; goto DKPYX; AFAty: GO73d: goto cM8FQ; fZiIx: $this->trigger_events("\160\157\x73\164\x5f\x72\145\147\151\x73\164\x65\162"); goto alZ6e; DKPYX: dkePr: goto zifSY; Ic3pE: $default_group = $query; goto a3zXw; SvJ_u: OwwTj: goto fZiIx; z7L9J: if ($this->identity_check($identity)) { goto dkePr; } goto iGWjk; l9vnv: $this->trigger_events("\x70\x72\145\137\x72\x65\147\151\x73\x74\x65\x72"); goto j2uNe; rwRLo: w70Vn: goto Ic3pE; cM8FQ: $query = $this->db->get_where($this->tables["\147\162\x6f\x75\160\x73"], ["\156\x61\155\x65" => $this->config->item("\x64\145\x66\141\165\154\164\x5f\x67\x72\157\165\160", "\151\x6f\x6e\x5f\x61\165\164\150")], 1)->row(); goto d0RxP; mHRqM: $this->set_error("\141\x63\143\157\x75\156\x74\137\143\x72\145\141\x74\x69\x6f\x6e\137\151\x6e\x76\141\x6c\151\144\x5f\x64\x65\146\141\165\154\x74\x5f\x67\x72\157\x75\x70"); goto bVWGx; c_zCx: if (empty($groups)) { goto OwwTj; } goto WF6LO; wTVdZ: $data = [$this->identity_column => $identity, "\165\163\x65\x72\x6e\x61\155\145" => $identity, "\160\141\163\x73\x77\157\x72\144" => $password, "\x65\155\141\151\x6c" => $email, "\151\x70\x5f\x61\144\144\x72\145\x73\163" => $ip_address, "\143\x72\x65\141\x74\145\x64\137\157\156" => time(), "\x61\x63\164\x69\166\145" => $manual_activation === FALSE ? 1 : 0]; goto tRM24; puNcC: return FALSE; goto BlSmJ; PhApM: $this->trigger_events("\145\170\x74\x72\x61\137\x73\x65\164"); goto YuLwj; jMxvh: if (!($password === FALSE)) { goto oekiv; } goto O2wt3; O2wt3: $this->set_error("\141\143\143\157\165\156\164\137\x63\x72\x65\141\164\x69\x6f\156\137\x75\x6e\163\x75\143\143\x65\x73\x73\x66\x75\x6c"); goto puNcC; iGWjk: if (!(!$this->config->item("\x64\x65\146\x61\165\154\x74\x5f\x67\x72\x6f\165\160", "\151\157\x6e\137\141\165\164\x68") && empty($groups))) { goto o5jzw; } goto QLSBO; zifSY: $this->set_error("\141\x63\x63\157\165\x6e\164\137\x63\162\x65\x61\x74\x69\x6f\x6e\137\x64\165\x70\154\x69\143\x61\164\145\137\x69\x64\145\x6e\164\x69\164\x79"); goto hOivc; WF6LO: foreach ($groups as $group) { $this->add_to_group($group, $id); U07tI: } goto MIxUE; MIxUE: JdchR: goto SvJ_u; a3zXw: $ip_address = $this->input->ip_address(); goto i7Jyg; BlSmJ: oekiv: goto wTVdZ; ll5KO: $groups[] = $default_group->id; goto gxL6y; j8TOx: if (!(isset($default_group->id) && empty($groups))) { goto hYkYz; } goto ll5KO; i7Jyg: $password = $this->hash_password($password); goto jMxvh; j2uNe: $manual_activation = $this->config->item("\155\x61\x6e\165\141\154\137\141\x63\164\x69\166\x61\x74\x69\x6f\x6e", "\x69\x6f\156\137\x61\x75\164\x68"); goto z7L9J; tRM24: $user_data = array_merge($this->_filter_data($this->tables["\x75\x73\145\x72\x73"], $additional_data), $data); goto PhApM; hOivc: return FALSE; goto AFAty; EFMJE: $id = $this->db->insert_id($this->tables["\165\x73\145\x72\163"] . "\137\x69\144\x5f\x73\x65\161"); goto j8TOx; qfCih: } public function login($identity, $password, $remember = FALSE) { goto x2ueD; Py7A7: $this->set_error("\154\x6f\147\x69\156\137\x75\x6e\x73\x75\x63\x63\x65\x73\163\146\x75\x6c\x5f\x6e\x6f\x74\137\141\143\164\x69\166\145"); goto KbW5F; CqzEz: QLp5P: goto Htu_1; Htu_1: $this->hash_password($password); goto o75qs; avbv0: $this->rehash_password_if_needed($user->password, $identity, $password); goto lOY8p; Xd7hH: if (!($query->num_rows() === 1)) { goto QLp5P; } goto ReGXg; jiWwF: WIphm: goto CqzEz; MJkAv: $this->trigger_events("\160\x6f\163\164\137\154\157\x67\x69\156\x5f\x75\x6e\x73\165\x63\143\145\x73\x73\146\165\154"); goto Py7A7; WOaoT: return FALSE; goto mcjqx; KLIE1: $this->trigger_events("\145\170\x74\x72\x61\137\x77\x68\x65\162\x65"); goto jqTe3; i_FG3: $this->set_error("\x6c\157\147\151\156\x5f\x75\156\163\x75\x63\143\x65\163\x73\146\x75\154"); goto IBV7u; ofViw: saika: goto uWBSL; sc_Rv: $this->update_last_login($user->id); goto psnWG; TW3Jb: if (!$this->verify_password($password, $user->password, $identity)) { goto WIphm; } goto lFay6; tqJs5: sbv64: goto aXkfg; KHRwG: $this->trigger_events("\x70\157\163\x74\x5f\x6c\157\x67\x69\x6e\x5f\165\x6e\x73\x75\143\x63\x65\163\163\x66\165\154"); goto ENlsG; Z2_0s: goto saika; goto tqJs5; nEV85: if (!$this->config->item("\x72\145\x6d\x65\x6d\x62\145\x72\x5f\x75\163\145\x72\163", "\151\x6f\x6e\137\141\165\164\150")) { goto tNq3L; } goto IpkxP; ENlsG: $this->set_error("\154\157\x67\151\x6e\x5f\165\156\163\x75\x63\x63\x65\x73\x73\146\x75\154"); goto maCPW; ReGXg: $user = $query->row(); goto TW3Jb; x2ueD: $this->trigger_events("\160\162\x65\x5f\x6c\157\147\x69\156"); goto s0QSr; UKYJo: if (!$this->is_max_login_attempts_exceeded($identity)) { goto OH0Z1; } goto fHK43; KbW5F: return FALSE; goto TavcJ; G6H9A: $this->set_error("\x6c\157\x67\x69\x6e\x5f\x74\151\x6d\145\x6f\165\x74"); goto WOaoT; IpkxP: if ($remember) { goto sbv64; } goto cQtWk; uWBSL: tNq3L: goto avbv0; lFay6: if (!($user->active == 0)) { goto vJb9w; } goto MJkAv; o75qs: $this->increase_login_attempts($identity); goto KHRwG; vROlg: HjuG4: goto KLIE1; HeR0R: return TRUE; goto jiWwF; IBV7u: return FALSE; goto vROlg; N5uxZ: $this->trigger_events("\160\157\163\x74\137\154\157\147\x69\156\137\x75\156\163\165\x63\x63\x65\x73\163\x66\165\x6c"); goto G6H9A; s0QSr: if (!(empty($identity) || empty($password))) { goto HjuG4; } goto i_FG3; cQtWk: $this->clear_remember_code($identity); goto Z2_0s; maCPW: return FALSE; goto mQtiv; gz6KN: $this->set_message("\154\157\147\151\x6e\x5f\x73\x75\x63\143\x65\x73\x73\x66\x75\154"); goto HeR0R; TavcJ: vJb9w: goto l42PY; lOY8p: $this->session->sess_regenerate(FALSE); goto uTCwq; jqTe3: $query = $this->db->select($this->identity_column . "\x2c\40\145\x6d\x61\151\154\54\x20\x69\x64\x2c\40\160\x61\163\163\167\x6f\x72\144\54\40\x61\143\x74\x69\166\145\x2c\40\154\x61\163\x74\137\x6c\157\x67\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\x64\x65\163\x63")->get($this->tables["\x75\x73\145\162\163"]); goto UKYJo; l42PY: $this->set_session($user); goto sc_Rv; fHK43: $this->hash_password($password); goto N5uxZ; mcjqx: OH0Z1: goto Xd7hH; aXkfg: $this->remember_user($identity); goto ofViw; psnWG: $this->clear_login_attempts($identity); goto LP8cD; uTCwq: $this->trigger_events(["\160\157\163\x74\137\154\x6f\x67\x69\156", "\160\x6f\x73\164\x5f\154\x6f\x67\x69\156\137\163\165\143\x63\x65\x73\x73\x66\165\154"]); goto gz6KN; LP8cD: $this->clear_forgotten_password_code($identity); goto nEV85; mQtiv: } public function recheck_session() { goto HLphd; DkLfu: $this->session->unset_userdata([$identity, "\x69\144", "\165\x73\145\x72\137\x69\144"]); goto u3E0n; aFKVy: $this->trigger_events("\154\x6f\x67\x6f\x75\164"); goto OJ0JW; OJ0JW: $identity = $this->config->item("\x69\144\145\x6e\x74\151\x74\171", "\x69\157\x6e\x5f\141\x75\x74\150"); goto DkLfu; pv_3J: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\x69\x64\x65\x6e\x74\151\164\171"), "\x61\x63\x74\151\166\145" => "\x31"])->limit(1)->order_by("\151\144", "\144\x65\163\143")->get($this->tables["\x75\x73\x65\x72\163"]); goto xUlDi; u3E0n: return FALSE; goto UOus5; HgZw8: $this->session->set_userdata("\x6c\x61\x73\x74\137\x63\150\x65\143\153", time()); goto R_84q; gFXww: UbGDm: goto ZGrrH; U3cDM: return (bool) $this->session->userdata("\x69\x64\x65\156\x74\151\x74\171"); goto fmj7B; ZGrrH: nH8qE: goto U3cDM; VmfP3: if (!($last_login + $recheck < time())) { goto UbGDm; } goto pv_3J; HLphd: $recheck = NULL !== $this->config->item("\x72\x65\143\150\x65\143\x6b\137\x74\151\x6d\145\162", "\x69\157\156\137\x61\x75\164\150") ? $this->config->item("\162\145\143\150\x65\143\153\x5f\x74\151\x6d\145\x72", "\x69\157\156\x5f\141\165\x74\150") : 0; goto d9jcm; R_84q: t6LI7: goto gFXww; UOus5: goto t6LI7; goto rLTuJ; FLZy5: $last_login = $this->session->userdata("\154\x61\163\x74\137\143\x68\145\x63\153"); goto VmfP3; d9jcm: if (!($recheck !== 0)) { goto nH8qE; } goto FLZy5; rLTuJ: OutAW: goto HgZw8; xUlDi: if ($query->num_rows() === 1) { goto OutAW; } goto aFKVy; fmj7B: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto Fr1TG; GwU0W: if (!($max_attempts > 0)) { goto xqyN4; } goto pShPA; mB02q: OsIYa: goto SxtTY; t9IWr: return $attempts >= $max_attempts; goto ttf63; pShPA: $attempts = $this->get_attempts_num($identity, $ip_address); goto t9IWr; Fr1TG: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\154\x6f\x67\x69\x6e\137\141\164\x74\x65\155\160\x74\163", "\x69\x6f\156\137\141\x75\164\x68")) { goto OsIYa; } goto CHwEi; SxtTY: return FALSE; goto UNrG5; CHwEi: $max_attempts = $this->config->item("\155\x61\170\151\155\x75\155\137\154\x6f\147\x69\x6e\x5f\141\164\164\x65\155\160\164\x73", "\x69\157\x6e\137\x61\165\x74\150"); goto GwU0W; ttf63: xqyN4: goto mB02q; UNrG5: } public function get_attempts_num($identity, $ip_address = NULL) { goto imiIq; LryQv: $this->db->where("\x69\160\137\141\x64\x64\x72\145\163\163", $ip_address); goto UYOpV; zqHQO: $ip_address = $this->input->ip_address(); goto ie1Hf; AYZvm: $qres = $this->db->get($this->tables["\154\157\147\151\156\x5f\141\x74\x74\145\155\x70\164\x73"]); goto I4JN6; XH4HU: $this->db->select("\61", FALSE); goto U18TF; Exy2p: H2_gy: goto H42i6; ie1Hf: PmDts: goto LryQv; U18TF: $this->db->where("\154\157\x67\x69\156", $identity); goto DZHzn; UYOpV: z0GWD: goto tUvRl; I4JN6: return $qres->num_rows(); goto Exy2p; DZHzn: if (!$this->config->item("\x74\162\x61\x63\153\x5f\154\x6f\x67\x69\156\x5f\x69\160\137\141\x64\144\162\145\163\163", "\x69\157\156\137\x61\x75\x74\150")) { goto z0GWD; } goto YbC57; YbC57: if (isset($ip_address)) { goto PmDts; } goto zqHQO; tUvRl: $this->db->where("\x74\151\155\145\40\76", time() - $this->config->item("\x6c\x6f\143\153\157\x75\164\137\164\151\155\145", "\x69\157\156\x5f\141\165\x74\150"), FALSE); goto AYZvm; imiIq: if (!$this->config->item("\164\x72\x61\143\x6b\x5f\154\157\x67\x69\x6e\137\x61\164\164\x65\155\x70\x74\x73", "\x69\x6f\x6e\137\x61\x75\x74\x68")) { goto H2_gy; } goto XH4HU; H42i6: return 0; goto pSGRS; pSGRS: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto KK6su; NPlpS: Agzhz: goto af7od; tgMMH: $qres = $this->db->get($this->tables["\x6c\157\147\x69\156\x5f\141\164\164\x65\155\x70\x74\x73"], 1); goto vb0s3; puiEn: n3ATH: goto LMmYR; RKGQ1: $this->db->select("\x74\151\155\145"); goto Mb2Nw; rEhIs: return $qres->row()->time; goto yy0fV; Mb2Nw: $this->db->where("\154\157\x67\151\156", $identity); goto jzLlo; yy0fV: x3Ed3: goto NPlpS; Z8jPL: $this->db->order_by("\151\144", "\144\145\163\143"); goto tgMMH; hIwOd: if (isset($ip_address)) { goto n3ATH; } goto uuR7b; vb0s3: if (!($qres->num_rows() > 0)) { goto x3Ed3; } goto rEhIs; E06sC: zE8n1: goto Z8jPL; uuR7b: $ip_address = $this->input->ip_address(); goto puiEn; af7od: return 0; goto A44Lr; jzLlo: if (!$this->config->item("\164\x72\141\x63\x6b\x5f\154\157\x67\151\156\137\151\160\x5f\141\x64\x64\162\x65\x73\163", "\x69\157\x6e\137\141\x75\164\x68")) { goto zE8n1; } goto hIwOd; KK6su: if (!$this->config->item("\x74\x72\141\143\153\137\154\x6f\147\151\156\x5f\x61\x74\x74\x65\155\160\164\163", "\x69\x6f\156\137\141\x75\164\150")) { goto Agzhz; } goto RKGQ1; LMmYR: $this->db->where("\x69\x70\137\x61\144\x64\162\145\163\x73", $ip_address); goto E06sC; A44Lr: } public function get_last_attempt_ip($identity) { goto W666P; nLUJC: return $qres->row()->ip_address; goto Tzf_i; kcQDS: if (!($qres->num_rows() > 0)) { goto FqCNg; } goto nLUJC; XRBRq: $this->db->where("\x6c\x6f\147\x69\156", $identity); goto JQp05; JP3Qr: $this->db->select("\x69\x70\x5f\141\x64\144\162\x65\163\163"); goto XRBRq; Oqlu6: $qres = $this->db->get($this->tables["\x6c\157\147\x69\x6e\x5f\x61\x74\x74\x65\x6d\160\164\163"], 1); goto kcQDS; s7_ur: return ''; goto QV3rM; W666P: if (!($this->config->item("\x74\162\x61\143\x6b\x5f\x6c\x6f\147\x69\x6e\x5f\x61\x74\164\145\155\x70\x74\x73", "\151\157\156\137\x61\165\x74\x68") && $this->config->item("\x74\x72\141\143\x6b\137\154\x6f\147\x69\156\137\x69\160\137\x61\144\x64\x72\145\163\163", "\x69\x6f\156\x5f\x61\165\164\150"))) { goto myz4A; } goto JP3Qr; a2QTx: myz4A: goto s7_ur; Tzf_i: FqCNg: goto a2QTx; JQp05: $this->db->order_by("\x69\144", "\144\145\x73\x63"); goto Oqlu6; QV3rM: } public function increase_login_attempts($identity) { goto TMrfk; Vcx5o: return $this->db->insert($this->tables["\154\157\147\x69\156\137\141\x74\164\x65\x6d\x70\164\163"], $data); goto gXPLW; TzTkY: $data = ["\151\160\137\x61\144\144\162\x65\x73\163" => '', "\154\x6f\147\151\156" => $identity, "\164\151\155\x65" => time()]; goto nqACx; ECqea: return FALSE; goto D9xdv; N3o1B: $data["\151\x70\x5f\141\144\x64\x72\145\x73\x73"] = $this->input->ip_address(); goto PRXSR; PRXSR: x55EH: goto Vcx5o; TMrfk: if (!$this->config->item("\164\162\x61\143\x6b\x5f\x6c\157\x67\151\x6e\137\141\x74\164\x65\155\x70\164\163", "\151\x6f\156\x5f\x61\x75\164\x68")) { goto Kg3fK; } goto TzTkY; nqACx: if (!$this->config->item("\x74\x72\141\143\153\x5f\154\157\x67\151\x6e\x5f\151\x70\137\141\x64\144\x72\145\163\x73", "\151\157\156\137\x61\x75\164\150")) { goto x55EH; } goto N3o1B; gXPLW: Kg3fK: goto ECqea; D9xdv: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto iufjf; vrycw: return FALSE; goto BPQww; XL4Qv: return $this->db->delete($this->tables["\x6c\157\147\x69\x6e\x5f\x61\x74\164\x65\155\160\x74\163"]); goto J6oKc; kFUj_: if (isset($ip_address)) { goto YhN99; } goto TfGIz; klFkP: $this->db->where("\154\x6f\x67\151\156", $identity); goto aq0EM; my2sc: $this->db->or_where("\x74\x69\x6d\145\x20\74", time() - $old_attempts_expire_period, FALSE); goto XL4Qv; xJzu0: $this->db->where("\151\x70\137\x61\x64\144\x72\x65\163\x73", $ip_address); goto mVsk7; TfGIz: $ip_address = $this->input->ip_address(); goto HSEZN; J6oKc: VEdF7: goto vrycw; NuHRv: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\x63\x6b\157\x75\164\x5f\164\x69\155\x65", "\151\x6f\x6e\137\141\x75\x74\150")); goto klFkP; mVsk7: nR27n: goto my2sc; iufjf: if (!$this->config->item("\164\162\x61\143\x6b\137\x6c\x6f\x67\151\156\x5f\x61\164\164\x65\155\160\164\163", "\x69\157\156\x5f\141\x75\164\x68")) { goto VEdF7; } goto NuHRv; HSEZN: YhN99: goto xJzu0; aq0EM: if (!$this->config->item("\x74\162\x61\x63\153\x5f\x6c\157\147\x69\x6e\137\x69\160\x5f\x61\x64\x64\162\145\163\x73", "\x69\157\x6e\137\x61\165\x74\x68")) { goto nR27n; } goto kFUj_; BPQww: } public function limit($limit) { goto eJ5IF; xUWIW: return $this; goto qaaQK; SPRLF: $this->_ion_limit = $limit; goto xUWIW; eJ5IF: $this->trigger_events("\x6c\151\x6d\151\164"); goto SPRLF; qaaQK: } public function offset($offset) { goto G7gHt; G7gHt: $this->trigger_events("\x6f\146\146\163\145\x74"); goto m_Ohk; QTcja: return $this; goto Cix5t; m_Ohk: $this->_ion_offset = $offset; goto QTcja; Cix5t: } public function where($where, $value = NULL) { goto i3fWy; qndYU: if (is_array($where)) { goto OftxT; } goto o74Tq; QO9n8: return $this; goto iYW8U; i3fWy: $this->trigger_events("\167\150\x65\162\145"); goto qndYU; o74Tq: $where = [$where => $value]; goto DygrH; eRyQz: array_push($this->_ion_where, $where); goto QO9n8; DygrH: OftxT: goto eRyQz; iYW8U: } public function like($like, $value = NULL, $position = "\142\x6f\164\x68") { goto IFSbZ; xzRy2: array_push($this->_ion_like, ["\154\151\153\x65" => $like, "\x76\x61\154\x75\x65" => $value, "\160\157\163\x69\x74\x69\157\156" => $position]); goto LJKbF; LJKbF: return $this; goto dPKW8; IFSbZ: $this->trigger_events("\x6c\x69\153\x65"); goto xzRy2; dPKW8: } public function select($select) { goto oAbk9; yaihZ: return $this; goto acExR; bXwhA: $this->_ion_select[] = $select; goto yaihZ; oAbk9: $this->trigger_events("\x73\x65\154\x65\143\164"); goto bXwhA; acExR: } public function order_by($by, $order = "\144\x65\x73\143") { goto GnlfR; o1VmI: $this->_ion_order_by = $by; goto xTYse; rX8mX: return $this; goto rv7Rb; xTYse: $this->_ion_order = $order; goto rX8mX; GnlfR: $this->trigger_events("\157\x72\144\x65\x72\137\142\171"); goto o1VmI; rv7Rb: } public function row() { goto Rvcub; kvDDR: return $row; goto VYF9A; Y49aP: $row = $this->response->row(); goto kvDDR; Rvcub: $this->trigger_events("\162\157\x77"); goto Y49aP; VYF9A: } public function row_array() { goto Jujos; MbPNX: return $row; goto zBtPM; Jujos: $this->trigger_events(["\x72\x6f\167", "\x72\x6f\167\x5f\x61\x72\x72\141\171"]); goto tNtgE; tNtgE: $row = $this->response->row_array(); goto MbPNX; zBtPM: } public function result() { goto A_Ovh; l3tkP: $result = $this->response->result(); goto y8Xvj; A_Ovh: $this->trigger_events("\x72\x65\163\x75\x6c\x74"); goto l3tkP; y8Xvj: return $result; goto H2puN; H2puN: } public function result_array() { goto EDYgV; VbuwQ: return $result; goto SYtAM; rg4P1: $result = $this->response->result_array(); goto VbuwQ; EDYgV: $this->trigger_events(["\x72\145\163\x75\x6c\x74", "\162\x65\x73\x75\154\x74\137\x61\x72\162\141\x79"]); goto rg4P1; SYtAM: } public function num_rows() { goto bwwIt; XJXSN: $result = $this->response->num_rows(); goto D0YXj; D0YXj: return $result; goto vez40; bwwIt: $this->trigger_events(["\156\165\x6d\137\162\157\x77\163"]); goto XJXSN; vez40: } public function users($groups = NULL) { goto UFI0f; MDvRq: C_RHQ: goto qfH0O; nsXMW: goto Qfx78; goto lR51s; IvV5w: if (is_array($groups)) { goto SXEsw; } goto E7vlB; T94TG: yB0Xl: goto Zu_2w; wwg2W: $this->_ion_select = []; goto ZpIJi; Z49AJ: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto VaqzE; H2yWD: $this->db->{$or_where_in}($this->tables["\x75\163\x65\x72\x73\x5f\147\x72\x6f\x75\x70\163"] . "\x2e" . $this->join["\147\162\157\x75\160\x73"], $group_ids); goto kXLja; i6Dq5: $this->db->where_in($this->tables["\147\162\x6f\x75\x70\x73"] . "\56\x6e\141\x6d\145", $group_names); goto awwgp; wtzXs: $this->_ion_order_by = NULL; goto DPVLX; bHuxC: goto ia4So; goto VVPA_; VVPA_: zOz13: goto Z49AJ; kKTa0: $this->_ion_order = NULL; goto wtzXs; KWpE0: $this->_ion_limit = NULL; goto NK7yX; b9pNi: $this->_ion_offset = NULL; goto ky63S; a_I29: if (!isset($groups)) { goto Kc_QH; } goto IvV5w; Rt9O0: $group_names = []; goto JGI5C; N1ikI: $this->db->join($this->tables["\165\x73\x65\x72\x73\137\x67\x72\157\x75\160\163"], $this->tables["\x75\163\x65\x72\x73\x5f\147\162\x6f\165\160\163"] . "\56" . $this->join["\x75\x73\x65\162\163"] . "\75" . $this->tables["\x75\163\x65\162\x73"] . "\x2e\151\144", "\x69\156\156\145\162"); goto VzOAD; DqD3G: foreach ($this->_ion_where as $where) { $this->db->where($where); EOMbj: } goto T94TG; i0txu: meqX1: goto rd72i; oVAnp: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\153\145"], $like["\x76\141\x6c\165\x65"], $like["\160\x6f\163\151\x74\x69\157\156"]); qtE5y: } goto i0txu; asM6P: T1zTi: goto BvdMT; zC3wA: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto T1zTi; } goto DqD3G; T1KOO: return $this; goto khw1C; WXYvt: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto kKTa0; lR51s: B87YS: goto Ix3RL; B_AHL: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto m7W73; } goto WXYvt; VaqzE: $this->_ion_limit = NULL; goto b9pNi; rd72i: $this->_ion_like = []; goto QZv13; a4ybA: $this->db->limit($this->_ion_limit); goto KWpE0; qfH0O: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\162\x5f\x77\x68\x65\x72\145\x5f\151\x6e" : "\167\150\x65\162\145\x5f\151\156"; goto wZQQ_; ZpIJi: Qfx78: goto a_I29; C67Lj: $this->db->select([$this->tables["\165\163\145\x72\163"] . "\x2e\x2a", $this->tables["\x75\x73\x65\x72\163"] . "\56\151\x64\x20\141\x73\x20\x69\x64", $this->tables["\165\163\145\x72\163"] . "\56\151\144\40\x61\163\40\165\x73\145\162\x5f\x69\x64"]); goto nsXMW; wZQQ_: if (empty($group_names)) { goto JNVSa; } goto pVOqQ; DPVLX: m7W73: goto ntwCh; whdSD: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto B87YS; } goto C67Lj; awwgp: JNVSa: goto YkInI; VzOAD: hFQY3: goto rm2bm; UFI0f: $this->trigger_events("\x75\163\145\162\x73"); goto whdSD; BvdMT: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto sigFz; } goto oVAnp; NgrW0: Kc_QH: goto A9Y_G; QZv13: sigFz: goto SdpYO; rm2bm: $group_ids = []; goto Rt9O0; pVOqQ: $this->db->join($this->tables["\147\162\157\x75\x70\163"], $this->tables["\x75\163\145\162\163\137\x67\162\157\x75\x70\163"] . "\56" . $this->join["\x67\x72\157\165\x70\163"] . "\x20\x3d\x20" . $this->tables["\x67\162\157\165\160\x73"] . "\56\151\x64", "\151\x6e\x6e\145\162"); goto i6Dq5; Ix3RL: foreach ($this->_ion_select as $select) { $this->db->select($select); S2YNu: } goto GZILm; E7vlB: $groups = [$groups]; goto hHKjB; GZILm: QGs8H: goto wwg2W; kViUZ: if (!isset($this->_ion_limit)) { goto N3jYK; } goto a4ybA; kXLja: iCd35: goto NgrW0; YkInI: if (empty($group_ids)) { goto iCd35; } goto H2yWD; JGI5C: foreach ($groups as $group) { goto NI_TI; z1rG2: goto C5qgI; goto k_Pyc; nGT_d: $group_names[] = $group; goto z1rG2; k_Pyc: ANXTV: goto TX6uy; H56qJ: C5qgI: goto Xhire; TX6uy: $group_ids[] = $group; goto H56qJ; Xhire: Cdwe2: goto yTYcz; NI_TI: if (is_numeric($group)) { goto ANXTV; } goto nGT_d; yTYcz: } goto MDvRq; HLCZ_: if (!(isset($groups) && !empty($groups))) { goto hFQY3; } goto zJ04g; NK7yX: N3jYK: goto bHuxC; ntwCh: $this->response = $this->db->get($this->tables["\165\x73\145\x72\x73"]); goto T1KOO; hHKjB: SXEsw: goto HLCZ_; SdpYO: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto zOz13; } goto kViUZ; ky63S: ia4So: goto B_AHL; zJ04g: $this->db->distinct(); goto N1ikI; A9Y_G: $this->trigger_events("\145\x78\x74\162\141\137\167\x68\x65\162\x65"); goto zC3wA; Zu_2w: $this->_ion_where = []; goto asM6P; khw1C: } public function user($id = NULL) { goto cAHjP; s6IQO: $this->order_by($this->tables["\165\x73\x65\162\163"] . "\56\x69\x64", "\x64\145\x73\143"); goto sbu2x; t1Tg1: $this->limit(1); goto s6IQO; Kd786: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\x65\162\x5f\151\x64"); goto t1Tg1; WZFWo: return $this; goto KLfBN; cAHjP: $this->trigger_events("\165\x73\145\162"); goto Kd786; sbu2x: $this->where($this->tables["\x75\x73\145\162\163"] . "\x2e\151\x64", $id); goto Ee7sx; Ee7sx: $this->users(); goto WZFWo; KLfBN: } public function get_users_groups($id = FALSE) { goto K2HOI; dpx5A: return $this->db->select($this->tables["\165\163\145\x72\x73\137\x67\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\147\x72\x6f\x75\x70\163"] . "\40\141\163\x20\x69\144\x2c\40" . $this->tables["\147\162\157\x75\160\x73"] . "\x2e\x6e\x61\155\145\x2c\40" . $this->tables["\147\162\157\165\x70\x73"] . "\56\144\145\163\143\x72\151\160\x74\x69\x6f\156")->where($this->tables["\x75\x73\145\162\x73\137\x67\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\x75\x73\145\162\163"], $id)->join($this->tables["\147\162\157\165\160\163"], $this->tables["\x75\x73\x65\162\x73\x5f\147\162\157\x75\x70\x73"] . "\56" . $this->join["\x67\x72\157\x75\160\163"] . "\75" . $this->tables["\x67\x72\x6f\x75\x70\163"] . "\56\151\144")->get($this->tables["\165\x73\145\x72\x73\137\147\x72\157\x75\x70\163"]); goto x3UU9; K2HOI: $this->trigger_events("\x67\145\164\x5f\x75\x73\x65\x72\163\137\x67\x72\x6f\x75\x70"); goto Eqcvf; Eqcvf: $id || ($id = $this->session->userdata("\x75\x73\145\162\x5f\151\144")); goto dpx5A; x3UU9: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto zrERW; zZa_O: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; ItcGx: } goto KSmCr; vnclI: $this->_cache_user_in_group[$id] = $groups_array; goto QErwM; cVxkx: foreach ($check_group as $key => $value) { goto oOSKC; L70yb: return !$check_all; goto mGmF1; sYIIh: l_PyW: goto zfO3J; oOSKC: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto LJ2zS; LJ2zS: if (!(in_array($value, $groups) xor $check_all)) { goto jACff; } goto L70yb; mGmF1: jACff: goto sYIIh; zfO3J: } goto IzxMb; zn4na: $users_groups = $this->get_users_groups($id)->result(); goto FjOsL; IzxMb: BbMaU: goto Qlgtm; jHtQ0: $id || ($id = $this->session->userdata("\165\163\x65\x72\x5f\151\144")); goto B424l; B424l: if (is_array($check_group)) { goto NJSqF; } goto CG8v3; KSmCr: O5KCu: goto vnclI; zrERW: $this->trigger_events("\x69\x6e\x5f\147\x72\157\x75\160"); goto jHtQ0; HBlfA: $groups_array = $this->_cache_user_in_group[$id]; goto wqRXU; FkOiS: I0wtl: goto HBlfA; E80Ot: if (isset($this->_cache_user_in_group[$id])) { goto I0wtl; } goto zn4na; w2BU6: NJSqF: goto E80Ot; FjOsL: $groups_array = []; goto zZa_O; Qlgtm: return $check_all; goto IR49S; CG8v3: $check_group = [$check_group]; goto w2BU6; wqRXU: D_gwG: goto cVxkx; QErwM: goto D_gwG; goto FkOiS; IR49S: } public function add_to_group($group_ids, $user_id = FALSE) { goto b7a5l; jHrbC: if (is_array($group_ids)) { goto gLCHP; } goto RhkTz; jvu5C: gLCHP: goto R_QeK; rYY3P: y1hDp: goto ZDY0a; R_QeK: $return = 0; goto EhSKs; ZDY0a: return $return; goto dmgGu; EhSKs: foreach ($group_ids as $group_id) { goto rsqLj; LfsZs: $group_name = $this->_cache_groups[$group_id]; goto sH0Ae; hX887: goto I75jK; goto rGo7v; hZF5H: $group = $this->group($group_id)->result(); goto Fn1z0; rsqLj: if (!$this->db->insert($this->tables["\x75\x73\x65\162\163\137\x67\162\157\x75\160\163"], [$this->join["\147\162\157\165\160\163"] => (float) $group_id, $this->join["\x75\x73\x65\162\163"] => (float) $user_id])) { goto albEs; } goto U48zK; Fn1z0: $group_name = $group[0]->name; goto FRA5C; FRA5C: $this->_cache_groups[$group_id] = $group_name; goto hX887; U48zK: if (isset($this->_cache_groups[$group_id])) { goto uhIu5; } goto hZF5H; rGo7v: uhIu5: goto LfsZs; J1lMv: albEs: goto nnfm2; sH0Ae: I75jK: goto eWWQY; eWWQY: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto bWOSz; nnfm2: Csl7E: goto vN6v8; bWOSz: $return++; goto J1lMv; vN6v8: } goto rYY3P; RhkTz: $group_ids = [$group_ids]; goto jvu5C; Vs9uw: $user_id || ($user_id = $this->session->userdata("\x75\x73\x65\x72\x5f\x69\x64")); goto jHrbC; b7a5l: $this->trigger_events("\141\144\x64\x5f\x74\x6f\x5f\147\162\157\165\160"); goto Vs9uw; dmgGu: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto TGF6y; oSdZz: foreach ($group_ids as $group_id) { goto VrWH9; ADM7i: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto RNYfq; } goto pklDR; pklDR: unset($this->_cache_user_in_group[$user_id][$group_id]); goto MVszZ; VrWH9: $this->db->delete($this->tables["\165\x73\145\162\163\137\147\162\157\x75\x70\163"], [$this->join["\x67\x72\157\165\160\163"] => (float) $group_id, $this->join["\x75\163\145\x72\163"] => (float) $user_id]); goto ADM7i; L6uNj: KGlKs: goto N08qb; MVszZ: RNYfq: goto L6uNj; N08qb: } goto SXkiU; FLyfG: return FALSE; goto wr9D8; bFjyY: if (is_array($group_ids)) { goto qHUHQ; } goto Usuyv; wr9D8: Xf_6p: goto F6Gz6; F6Gz6: if (!empty($group_ids)) { goto zLd7j; } goto OPoUR; Usuyv: $group_ids = [$group_ids]; goto sFY_R; SXkiU: wwPyq: goto v5mhy; SSU7A: return $return; goto xP50Y; eEjuD: lqhDR: goto f_QO7; fMpEX: if (!empty($user_id)) { goto Xf_6p; } goto FLyfG; sFY_R: qHUHQ: goto oSdZz; v5mhy: $return = TRUE; goto Svbm2; OPoUR: if (!($return = $this->db->delete($this->tables["\x75\x73\145\x72\x73\137\x67\162\157\x75\x70\163"], [$this->join["\165\163\145\x72\163"] => (float) $user_id]))) { goto lqhDR; } goto roitw; TGF6y: $this->trigger_events("\x72\145\x6d\157\166\x65\x5f\146\x72\x6f\155\x5f\x67\x72\x6f\165\x70"); goto fMpEX; roitw: $this->_cache_user_in_group[$user_id] = []; goto eEjuD; ILNCX: zLd7j: goto bFjyY; f_QO7: goto Jnl0W; goto ILNCX; Svbm2: Jnl0W: goto SSU7A; xP50Y: } public function groups() { goto TU8ao; W1KEG: RbOXz: goto gphmh; vkOTT: $this->db->limit($this->_ion_limit); goto V1ery; k9YGN: return $this; goto cEY8c; ZVvAa: RAMhI: goto jV5Y9; bJy_P: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto akWR6; o03jv: foreach ($this->_ion_where as $where) { $this->db->where($where); Mli3C: } goto QyNcI; Islud: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto CRL9q; } goto o03jv; gphmh: $this->response = $this->db->get($this->tables["\147\162\x6f\x75\x70\x73"]); goto k9YGN; QGtae: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto W1KEG; aE0O9: $this->_ion_where = []; goto win8L; QyNcI: fqQRP: goto aE0O9; c9m7w: qJw9W: goto R8HFB; EcZS6: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto CYRzZ; } goto LCuQv; V1ery: $this->_ion_limit = NULL; goto ZVvAa; TU8ao: $this->trigger_events("\x67\162\157\165\x70\x73"); goto Islud; akWR6: $this->_ion_limit = NULL; goto xn4vX; win8L: CRL9q: goto EcZS6; xn4vX: $this->_ion_offset = NULL; goto c9m7w; jV5Y9: goto qJw9W; goto RO9Hh; R8HFB: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto RbOXz; } goto QGtae; LCuQv: if (!isset($this->_ion_limit)) { goto RAMhI; } goto vkOTT; RO9Hh: CYRzZ: goto bJy_P; cEY8c: } public function group($id = NULL) { goto WOWdY; N754d: $this->where($this->tables["\147\162\x6f\x75\x70\x73"] . "\56\151\144", $id); goto Z47_0; DZbq9: $this->limit(1); goto Gtn3f; WOWdY: $this->trigger_events("\x67\x72\x6f\x75\x70"); goto Oi9A_; G_fBB: return $this->groups(); goto dszuW; Oi9A_: if (!isset($id)) { goto N3j8U; } goto N754d; Z47_0: N3j8U: goto DZbq9; Gtn3f: $this->order_by("\x69\144", "\144\x65\x73\143"); goto G_fBB; dszuW: } public function update($id, array $data) { goto s8Qe4; V1krL: goto D34ME; goto c6Y93; SaSMK: $data["\x70\x61\163\163\167\157\162\x64"] = $this->hash_password($data["\x70\141\163\163\167\x6f\162\x64"], $user->{$this->identity_column}); goto jh282; gwO1G: if (!empty($data["\160\x61\163\x73\x77\x6f\x72\144"])) { goto aMTac; } goto klrNB; Lkh9k: $this->set_error("\x61\143\x63\157\x75\x6e\164\137\x63\x72\x65\141\x74\151\157\x6e\x5f\144\165\160\154\x69\143\141\164\x65\x5f\151\x64\x65\156\x74\x69\x74\171"); goto PdSxN; ydS2l: $this->set_error("\165\160\x64\x61\x74\x65\137\165\x6e\x73\x75\x63\143\145\163\x73\x66\165\154"); goto EX81q; jTEZ6: bUMBU: goto VAv21; ZVAEH: $this->db->trans_begin(); goto y12lW; GGN1_: $this->trigger_events(["\x70\x6f\163\x74\137\165\160\144\141\164\x65\137\x75\163\145\162", "\x70\x6f\163\164\x5f\165\x70\x64\x61\164\145\x5f\165\x73\145\162\x5f\163\165\143\143\x65\x73\163\146\x75\154"]); goto T9Mp9; f50wE: if (!($this->db->trans_status() === FALSE)) { goto pDnpE; } goto UDAcp; I_TQU: $this->set_error("\165\160\144\141\x74\145\x5f\165\x6e\163\165\143\143\x65\x73\163\x66\165\x6c"); goto CVmt7; u80vb: pDnpE: goto ygRYe; c703O: scxxA: goto pzqcU; EhaB8: $this->set_error("\165\x70\144\x61\x74\x65\137\165\x6e\163\x75\x63\x63\x65\x73\x73\146\x75\x6c"); goto vkHfN; c6Y93: aMTac: goto SaSMK; tYnj9: sicM3: goto jTEZ6; PdSxN: $this->trigger_events(["\x70\x6f\x73\x74\137\165\160\x64\141\x74\145\137\165\163\x65\162", "\160\x6f\x73\x74\x5f\x75\160\x64\141\164\x65\137\x75\163\145\x72\x5f\x75\156\163\x75\143\143\145\x73\163\146\x75\x6c"]); goto I_TQU; CVmt7: return FALSE; goto l3xMi; T9Mp9: $this->set_message("\165\x70\144\x61\x74\x65\x5f\163\165\x63\143\145\163\x73\146\x75\x6c"); goto FwrNh; klrNB: unset($data["\160\x61\163\163\x77\157\x72\144"]); goto V1krL; wYiCd: $this->trigger_events(["\x70\157\x73\x74\x5f\165\x70\x64\x61\x74\145\x5f\165\163\145\x72", "\160\x6f\x73\x74\x5f\x75\160\x64\141\164\x65\x5f\x75\163\145\162\137\x75\x6e\163\165\143\x63\145\163\x73\146\x75\x6c"]); goto ydS2l; GnIDK: $this->db->trans_rollback(); goto Lkh9k; UDAcp: $this->db->trans_rollback(); goto Res25; FwrNh: return TRUE; goto W7_ab; Hnj_t: $data = $this->_filter_data($this->tables["\x75\163\x65\x72\163"], $data); goto AUNpf; vkHfN: return FALSE; goto u80vb; s8Qe4: $this->trigger_events("\x70\x72\x65\x5f\165\160\x64\x61\164\145\x5f\x75\x73\x65\x72"); goto FzA2Q; l3xMi: IebA8: goto Hnj_t; pzqcU: D34ME: goto tYnj9; jh282: if (!($data["\x70\141\x73\163\167\x6f\x72\144"] === FALSE)) { goto scxxA; } goto HAW7w; VAv21: $this->trigger_events("\145\x78\164\162\141\137\167\x68\x65\162\145"); goto y2nqA; AUNpf: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\x73\163\167\x6f\x72\x64", $data) || array_key_exists("\x65\x6d\141\x69\154", $data))) { goto bUMBU; } goto vX4rw; y2nqA: $this->db->update($this->tables["\x75\163\x65\x72\x73"], $data, ["\151\144" => $user->id]); goto f50wE; ygRYe: $this->db->trans_commit(); goto GGN1_; EX81q: return FALSE; goto c703O; Res25: $this->trigger_events(["\160\x6f\x73\x74\137\x75\160\x64\x61\x74\145\137\x75\163\145\x72", "\160\157\x73\164\137\165\x70\144\x61\164\145\x5f\x75\163\x65\x72\x5f\x75\x6e\x73\x75\143\143\x65\x73\163\x66\x75\154"]); goto EhaB8; HAW7w: $this->db->trans_rollback(); goto wYiCd; y12lW: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto IebA8; } goto GnIDK; FzA2Q: $user = $this->user($id)->row(); goto ZVAEH; vX4rw: if (!array_key_exists("\160\141\163\163\x77\157\x72\x64", $data)) { goto sicM3; } goto gwO1G; W7_ab: } public function delete_user($id) { goto cw0CN; xzzVN: $this->remove_from_group(NULL, $id); goto w8fom; w8fom: $this->db->delete($this->tables["\165\163\x65\162\163"], ["\x69\144" => $id]); goto HS6sU; vEA2Q: $this->set_error("\x64\145\x6c\x65\164\145\137\165\156\163\165\x63\x63\145\163\163\x66\x75\x6c"); goto j7yJT; Oycu5: ouhwM: goto eWcjj; EyZiT: $this->set_message("\x64\x65\x6c\x65\164\x65\137\163\x75\x63\x63\x65\163\163\146\x75\154"); goto Vnai_; SRinT: $this->db->trans_rollback(); goto iV1Dt; eWcjj: $this->db->trans_commit(); goto JKzzc; j7yJT: return FALSE; goto Oycu5; EYj9_: $this->db->trans_begin(); goto xzzVN; JKzzc: $this->trigger_events(["\160\x6f\x73\x74\x5f\x64\x65\154\145\164\x65\137\x75\163\145\x72", "\x70\157\x73\x74\x5f\144\145\x6c\145\164\x65\137\x75\x73\x65\162\x5f\x73\x75\143\143\x65\163\x73\146\x75\x6c"]); goto EyZiT; Vnai_: return TRUE; goto AItki; iV1Dt: $this->trigger_events(["\x70\157\163\164\x5f\144\145\x6c\145\x74\145\137\x75\x73\x65\162", "\160\157\x73\164\137\x64\x65\154\145\x74\x65\x5f\165\163\145\162\137\165\x6e\x73\165\x63\x63\x65\x73\x73\x66\165\x6c"]); goto vEA2Q; HS6sU: if (!($this->db->trans_status() === FALSE)) { goto ouhwM; } goto SRinT; cw0CN: $this->trigger_events("\160\x72\x65\x5f\144\x65\154\x65\164\145\137\165\x73\x65\x72"); goto EYj9_; AItki: } public function update_last_login($id) { goto Ktlcw; q360l: $this->trigger_events("\145\x78\164\162\x61\x5f\x77\x68\145\x72\x65"); goto veLKt; veLKt: $this->db->update($this->tables["\x75\163\145\162\163"], ["\x6c\x61\x73\x74\137\154\x6f\x67\x69\x6e" => time()], ["\151\x64" => $id]); goto e3Wwm; e3Wwm: return $this->db->affected_rows() == 1; goto O56uU; iTCdK: $this->load->helper("\x64\141\164\145"); goto q360l; Ktlcw: $this->trigger_events("\165\x70\x64\141\164\x65\137\x6c\141\163\x74\137\154\157\x67\151\156"); goto iTCdK; O56uU: } public function set_lang($lang = "\x65\x6e") { goto Bw4r0; S0zcx: set_cookie(["\x6e\x61\x6d\145" => "\x6c\x61\x6e\147\x5f\x63\157\x64\x65", "\x76\x61\x6c\165\145" => $lang, "\x65\x78\x70\x69\162\145" => $expire]); goto R1xL2; G0Q_5: gkw46: goto wF3Sb; Y3UYH: if ($this->config->item("\165\163\145\162\137\x65\170\160\151\x72\x65", "\151\157\156\x5f\141\x75\x74\x68") === 0) { goto gkw46; } goto rqWdq; R1xL2: return TRUE; goto dcI9s; tdKkI: NllU9: goto S0zcx; rqWdq: $expire = $this->config->item("\x75\163\x65\x72\x5f\x65\x78\160\151\162\145", "\151\157\x6e\x5f\141\165\x74\x68"); goto ulFvx; Bw4r0: $this->trigger_events("\163\145\x74\x5f\154\141\x6e\147"); goto Y3UYH; ulFvx: goto NllU9; goto G0Q_5; wF3Sb: $expire = self::MAX_COOKIE_LIFETIME; goto tdKkI; dcI9s: } public function set_session($user) { goto gTHL_; gTHL_: $this->trigger_events("\x70\x72\x65\137\x73\145\164\137\163\145\x73\x73\151\157\156"); goto XZzTI; XXY6R: $this->trigger_events("\x70\x6f\163\164\137\x73\x65\x74\137\x73\x65\x73\x73\151\x6f\156"); goto Jgmhx; XZzTI: $session_data = ["\151\x64\145\x6e\164\x69\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\x61\x69\154" => $user->email, "\165\163\145\162\137\151\x64" => $user->id, "\x6f\x6c\144\137\x6c\141\163\164\x5f\154\157\147\x69\156" => $user->last_login, "\x6c\141\x73\164\137\143\150\x65\143\x6b" => time()]; goto sys_G; Jgmhx: return TRUE; goto Pim0z; sys_G: $this->session->set_userdata($session_data); goto XXY6R; Pim0z: } public function remember_user($identity) { goto ppUmA; ppUmA: $this->trigger_events("\160\162\145\x5f\x72\145\155\145\155\142\x65\x72\137\165\x73\145\x72"); goto XomUf; xswY0: UVHoi: goto PDyBU; XomUf: if ($identity) { goto UVHoi; } goto PpD5N; nw07p: $this->trigger_events(["\x70\157\163\x74\137\x72\145\155\145\155\x62\145\162\x5f\165\163\x65\x72", "\x72\145\x6d\145\x6d\142\x65\162\137\x75\x73\x65\162\137\x73\165\x63\143\x65\163\x73\146\165\154"]); goto aXZ8s; g1_Vj: $this->db->update($this->tables["\x75\163\x65\162\x73"], ["\x72\x65\x6d\x65\155\x62\x65\x72\137\163\145\154\145\143\164\157\162" => $token->selector, "\162\145\155\145\x6d\142\x65\x72\x5f\x63\157\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto tJHE3; i3DdP: SH0vO: goto DfMTl; XcSF1: tLBEi: goto bPnOb; DfMTl: $expire = self::MAX_COOKIE_LIFETIME; goto XcSF1; bPnOb: set_cookie(["\x6e\x61\155\x65" => $this->config->item("\x72\x65\x6d\x65\155\142\x65\162\x5f\143\x6f\x6f\x6b\x69\145\x5f\156\x61\x6d\x65", "\151\x6f\156\137\x61\x75\164\x68"), "\166\141\154\165\x65" => $token->user_code, "\145\x78\160\151\162\x65" => $expire]); goto nw07p; NoSDZ: return FALSE; goto crWhY; PDyBU: $token = $this->_generate_selector_validator_couple(); goto s4Mb8; s4Mb8: if (!$token->validator_hashed) { goto IDpGm; } goto g1_Vj; pHA3C: $this->trigger_events(["\x70\x6f\x73\x74\137\x72\145\x6d\x65\155\142\x65\x72\137\165\163\x65\162", "\x72\145\x6d\145\155\x62\x65\162\x5f\x75\163\145\x72\x5f\165\156\x73\165\x63\143\x65\163\x73\x66\165\x6c"]); goto NoSDZ; BYJSO: goto tLBEi; goto i3DdP; qY9Y6: IDpGm: goto pHA3C; aXZ8s: return TRUE; goto OsXfb; gj5dX: $expire = $this->config->item("\165\163\145\x72\137\145\170\160\x69\x72\x65", "\x69\x6f\x6e\137\x61\x75\164\x68"); goto BYJSO; tJHE3: if (!($this->db->affected_rows() > -1)) { goto rgHUp; } goto pvzyY; pvzyY: if ($this->config->item("\165\163\145\x72\137\145\170\x70\x69\162\145", "\151\x6f\156\137\x61\x75\x74\150") === 0) { goto SH0vO; } goto gj5dX; OsXfb: rgHUp: goto qY9Y6; PpD5N: return FALSE; goto xswY0; crWhY: } public function login_remembered_user() { goto vvVDv; H2O0b: $remember_cookie = get_cookie($this->config->item("\162\145\x6d\145\155\x62\145\162\137\x63\157\x6f\153\151\145\137\156\x61\x6d\145", "\151\157\x6e\137\x61\x75\x74\150")); goto U84CQ; wpblk: Gw23k: goto oLVyE; dTsb0: $query = $this->db->select($this->identity_column . "\54\40\151\x64\x2c\40\145\x6d\141\x69\x6c\54\40\162\x65\155\x65\x6d\142\x65\x72\137\143\x6f\x64\145\54\x20\x6c\141\x73\x74\137\154\157\147\x69\156")->where("\162\x65\x6d\145\x6d\142\145\x72\137\163\145\154\145\143\164\157\162", $token->selector)->where("\x61\143\164\x69\x76\145", 1)->limit(1)->get($this->tables["\x75\x73\145\162\163"]); goto IPI2z; IPI2z: if (!($query->num_rows() === 1)) { goto v2bxU; } goto jqO8f; dB0aI: hAJUr: goto aw5hu; Qw6gv: gHASr: goto ugrOg; hNdWP: $this->set_session($user); goto wltuE; oLVyE: v2bxU: goto w2gBL; xQVb0: return FALSE; goto Hrytm; jqO8f: $user = $query->row(); goto TiAaX; AKHfG: $this->trigger_events(["\160\157\x73\164\137\154\157\147\x69\x6e\x5f\162\145\155\145\155\x62\145\x72\x65\144\137\165\x73\x65\162", "\160\157\x73\164\137\154\157\147\x69\156\x5f\x72\145\x6d\145\155\142\145\x72\145\144\137\x75\x73\145\162\137\165\156\x73\x75\143\x63\145\x73\163\146\165\x6c"]); goto xQVb0; gcpkb: if (!$this->config->item("\165\163\145\x72\137\x65\170\164\x65\x6e\x64\x5f\x6f\x6e\x5f\154\x6f\x67\x69\x6e", "\151\157\x6e\137\141\x75\164\x68")) { goto hAJUr; } goto S3FgI; aw5hu: $this->session->sess_regenerate(FALSE); goto ACaCr; U84CQ: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto ctLhL; wltuE: $this->clear_forgotten_password_code($identity); goto gcpkb; uY4v4: return FALSE; goto Qw6gv; ugrOg: $this->trigger_events("\x65\170\164\162\141\137\167\150\145\162\145"); goto dTsb0; tcTB1: $this->update_last_login($user->id); goto hNdWP; w2gBL: delete_cookie($this->config->item("\162\145\155\x65\x6d\142\x65\x72\x5f\143\157\157\153\151\x65\137\156\141\155\145", "\x69\x6f\x6e\x5f\x61\x75\164\150")); goto AKHfG; ACaCr: $this->trigger_events(["\x70\157\163\164\137\x6c\x6f\x67\151\156\x5f\162\145\155\x65\x6d\142\145\162\145\144\137\165\x73\145\x72", "\160\157\x73\164\137\x6c\157\x67\x69\156\137\162\x65\155\145\x6d\142\x65\162\x65\x64\137\x75\163\x65\x72\137\163\x75\x63\x63\145\x73\163\x66\x75\154"]); goto JTP47; z1Odq: $this->trigger_events(["\160\x6f\163\164\137\x6c\x6f\147\151\x6e\137\162\x65\155\x65\155\142\x65\162\145\x64\x5f\x75\x73\x65\x72", "\x70\157\x73\x74\x5f\x6c\157\x67\x69\x6e\137\162\145\x6d\x65\155\142\145\x72\145\144\137\x75\163\x65\x72\137\x75\156\163\x75\x63\x63\x65\163\163\x66\x75\154"]); goto uY4v4; iXEwB: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto Gw23k; } goto tcTB1; TiAaX: $identity = $user->{$this->identity_column}; goto iXEwB; vvVDv: $this->trigger_events("\160\x72\145\137\x6c\x6f\147\151\x6e\137\x72\x65\x6d\145\x6d\142\145\x72\145\144\x5f\x75\163\x65\162"); goto H2O0b; JTP47: return TRUE; goto wpblk; ctLhL: if (!($token === FALSE)) { goto gHASr; } goto z1Odq; S3FgI: $this->remember_user($identity); goto dB0aI; Hrytm: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto WPJct; vvQEt: $this->db->insert($this->tables["\x67\x72\x6f\x75\x70\163"], $data); goto cVMe_; cVMe_: $group_id = $this->db->insert_id($this->tables["\x67\x72\x6f\x75\160\163"] . "\137\x69\x64\x5f\x73\145\x71"); goto ULLJ9; qUFIM: if (!($existing_group !== 0)) { goto Kia0K; } goto YSveI; eJHYv: Kia0K: goto juWzi; bvR85: $this->set_error("\147\x72\157\x75\x70\137\x6e\x61\x6d\x65\137\162\x65\x71\x75\x69\x72\145\144"); goto r9KLK; tCC4V: if (empty($additional_data)) { goto iNRfK; } goto pGYV2; CqtMs: NTUpb: goto MpcFE; r9KLK: return FALSE; goto CqtMs; R5kFR: return $group_id; goto m3fiS; Ae7wz: $this->trigger_events("\x65\170\x74\162\141\x5f\147\162\x6f\165\160\137\x73\x65\x74"); goto vvQEt; juWzi: $data = ["\x6e\x61\155\x65" => $group_name, "\x64\145\163\143\162\x69\160\164\x69\157\156" => $group_description]; goto tCC4V; FCwF_: iNRfK: goto Ae7wz; igUsI: return FALSE; goto eJHYv; pGYV2: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\165\160\x73"], $additional_data), $data); goto FCwF_; WPJct: if ($group_name) { goto NTUpb; } goto bvR85; ULLJ9: $this->set_message("\x67\x72\x6f\165\160\x5f\143\162\x65\x61\164\151\157\156\x5f\163\165\x63\x63\x65\163\163\x66\165\154"); goto R5kFR; YSveI: $this->set_error("\147\162\157\x75\x70\x5f\x61\154\x72\x65\x61\x64\x79\x5f\x65\x78\151\163\x74\163"); goto igUsI; MpcFE: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\x75\x70\x73"], ["\x6e\x61\x6d\145" => $group_name])->num_rows(); goto qUFIM; m3fiS: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto WFNdj; q_QpG: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto V8r3X; } goto VBnMf; baiD_: $data["\x6e\x61\155\145"] = $group_name; goto ZReeI; n_czV: $group = $this->db->get_where($this->tables["\147\x72\x6f\165\160\x73"], ["\x69\144" => $group_id])->row(); goto Gek4O; kRDMq: $data = []; goto eFChL; drFZ9: $existing_group = $this->db->get_where($this->tables["\x67\162\157\165\x70\163"], ["\156\x61\x6d\x65" => $group_name])->row(); goto q_QpG; HNG5x: return FALSE; goto IP2Pb; WFNdj: if (!empty($group_id)) { goto gbgF4; } goto Ip3N0; Ip3N0: return FALSE; goto cei8G; cei8G: gbgF4: goto kRDMq; OJlQ2: $this->set_message("\x67\162\157\165\160\137\x75\x70\x64\141\164\x65\x5f\x73\x75\x63\x63\x65\163\x73\146\165\x6c"); goto DIb1U; retp6: if (empty($additional_data)) { goto X_UQS; } goto dvWkn; yzBfI: $this->set_error("\x67\x72\x6f\165\160\x5f\156\141\x6d\145\137\141\144\155\x69\x6e\x5f\x6e\x6f\x74\137\x61\x6c\x74\x65\x72"); goto HNG5x; Ymp5m: X_UQS: goto ZfnZq; ZReeI: kgsam: goto n_czV; dvWkn: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\165\160\x73"], $additional_data), $data); goto Ymp5m; IP2Pb: yerFl: goto retp6; eFChL: if (empty($group_name)) { goto kgsam; } goto drFZ9; iCo6U: V8r3X: goto baiD_; VBnMf: $this->set_error("\x67\x72\157\x75\x70\x5f\x61\x6c\x72\x65\x61\144\x79\x5f\145\170\151\x73\164\163"); goto HPl0q; Gek4O: if (!($this->config->item("\141\144\x6d\x69\x6e\x5f\147\x72\x6f\165\160", "\151\157\x6e\x5f\x61\165\x74\x68") === $group->name && $group_name !== $group->name)) { goto yerFl; } goto yzBfI; HPl0q: return FALSE; goto iCo6U; DIb1U: return TRUE; goto cNX3F; ZfnZq: $this->db->update($this->tables["\147\x72\x6f\165\160\163"], $data, ["\x69\144" => $group_id]); goto OJlQ2; cNX3F: } public function delete_group($group_id = FALSE) { goto a3YxV; cRX9A: $this->db->trans_begin(); goto an55e; v2rZB: $this->trigger_events(["\x70\x6f\163\164\x5f\144\x65\154\x65\x74\145\137\147\162\x6f\165\x70", "\x70\157\x73\x74\137\144\145\154\x65\164\x65\137\147\162\x6f\x75\160\137\x75\156\163\165\x63\x63\x65\x73\x73\146\x75\154"]); goto YbdKZ; Mzady: $this->db->trans_rollback(); goto v2rZB; vYlBX: $this->db->trans_commit(); goto cPrI0; an55e: $this->db->delete($this->tables["\165\163\145\x72\163\x5f\x67\162\x6f\165\x70\163"], [$this->join["\147\x72\157\165\x70\x73"] => $group_id]); goto EcsaS; EcsaS: $this->db->delete($this->tables["\147\x72\157\165\x70\x73"], ["\151\x64" => $group_id]); goto GmHx9; GmHx9: if (!($this->db->trans_status() === FALSE)) { goto ISsrJ; } goto Mzady; ER02U: oEpYf: goto xt6b_; YbdKZ: $this->set_error("\147\x72\157\x75\160\x5f\x64\x65\154\x65\164\145\x5f\165\156\x73\165\x63\x63\145\163\163\146\x75\154"); goto bwFn1; U65oV: return FALSE; goto wzp9e; lj6BE: $this->set_error("\147\x72\157\x75\x70\x5f\x64\145\x6c\145\164\145\x5f\156\x6f\x74\x61\154\x6c\x6f\167\145\x64"); goto mwOVZ; a3YxV: if (!(!$group_id || empty($group_id))) { goto ptk7s; } goto U65oV; NYTYH: $this->trigger_events(["\x70\x6f\x73\164\137\144\145\154\145\x74\x65\137\147\162\x6f\165\x70", "\x70\x6f\163\164\137\x64\x65\x6c\x65\x74\x65\x5f\147\x72\x6f\x75\160\x5f\x6e\x6f\x74\141\x6c\x6c\157\x77\x65\x64"]); goto lj6BE; cPrI0: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x64\145\154\x65\x74\145\137\x67\162\157\165\x70", "\160\x6f\x73\164\x5f\144\x65\x6c\x65\164\x65\x5f\147\x72\x6f\x75\160\137\163\x75\143\143\145\163\163\x66\x75\154"]); goto i121_; rXLNE: if (!($group->name == $this->config->item("\x61\x64\155\151\156\x5f\147\x72\x6f\165\160", "\x69\157\x6e\x5f\x61\x75\x74\x68"))) { goto oEpYf; } goto NYTYH; wgHKp: $group = $this->group($group_id)->row(); goto rXLNE; i121_: $this->set_message("\x67\x72\x6f\x75\160\137\x64\x65\154\145\164\145\x5f\x73\x75\143\x63\x65\163\x73\x66\x75\154"); goto oj31j; mwOVZ: return FALSE; goto ER02U; xt6b_: $this->trigger_events("\x70\162\x65\137\144\x65\154\x65\x74\145\137\147\x72\157\x75\160"); goto cRX9A; gGULQ: ISsrJ: goto vYlBX; wzp9e: ptk7s: goto wgHKp; oj31j: return TRUE; goto JrFd0; bwFn1: return FALSE; goto gGULQ; JrFd0: } public function set_hook($event, $name, $class, $method, $arguments) { goto UvmFA; nEhtt: $this->_ion_hooks->{$event}[$name]->class = $class; goto T1kqR; UvmFA: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto nEhtt; CnhgO: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto si23y; T1kqR: $this->_ion_hooks->{$event}[$name]->method = $method; goto CnhgO; si23y: } public function remove_hook($event, $name) { goto WZptO; AvgYT: XcsHH: goto xgEex; mjDvd: unset($this->_ion_hooks->{$event}[$name]); goto AvgYT; WZptO: if (!isset($this->_ion_hooks->{$event}[$name])) { goto XcsHH; } goto mjDvd; xgEex: } public function remove_hooks($event) { goto z2cWy; tDozx: y2tHD: goto yVqT6; jidee: unset($this->_ion_hooks->{$event}); goto tDozx; z2cWy: if (!isset($this->_ion_hooks->{$event})) { goto y2tHD; } goto jidee; yVqT6: } protected function _call_hook($event, $name) { goto Riq0E; MAYyU: axJpz: goto Pf4rX; Riq0E: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto axJpz; } goto COaEc; Pf4rX: return FALSE; goto WswNU; QD8cV: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto MAYyU; COaEc: $hook = $this->_ion_hooks->{$event}[$name]; goto QD8cV; WswNU: } public function trigger_events($events) { goto PS40A; QyyP4: EQjWG: goto IZMqA; I_MUR: TcX0i: goto kOAql; PS40A: if (is_array($events) && !empty($events)) { goto EQjWG; } goto bzxar; s3Vaj: N1G94: goto jJqLd; IZMqA: foreach ($events as $event) { $this->trigger_events($event); ihJEY: } goto I_MUR; kOAql: dHEIK: goto NvCDC; XC3hF: goto dHEIK; goto QyyP4; jJqLd: owluF: goto XC3hF; aWvr_: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); CtytR: } goto s3Vaj; bzxar: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto owluF; } goto aWvr_; NvCDC: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto eObLk; naEQA: $this->message_end_delimiter = $end_delimiter; goto q9lIg; q9lIg: return TRUE; goto Si7Mb; eObLk: $this->message_start_delimiter = $start_delimiter; goto naEQA; Si7Mb: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto iL5WM; Vhnln: $this->error_end_delimiter = $end_delimiter; goto Dy4Pw; iL5WM: $this->error_start_delimiter = $start_delimiter; goto Vhnln; Dy4Pw: return TRUE; goto bcuWv; bcuWv: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto dnfj5; R0hRl: RatY8: goto H2to3; dnfj5: $_output = ''; goto DvUcK; H2to3: return $_output; goto hy1Px; DvUcK: foreach ($this->messages as $message) { goto HiXHy; a8v_6: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto Ocwnm; HiXHy: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\x23\x23"; goto a8v_6; Ocwnm: StGRh: goto LClOV; LClOV: } goto R0hRl; hy1Px: } public function messages_array($langify = TRUE) { goto UbJ7b; UbJ7b: if ($langify) { goto ut80l; } goto fs2SO; mB7eo: ut80l: goto iPVGt; fs2SO: return $this->messages; goto b6796; zx2c2: n0IbT: goto y8q8W; GCFLw: foreach ($this->messages as $message) { goto drudZ; drudZ: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\x23"; goto yiYkc; jIWz4: h7Rlv: goto jOqBF; yiYkc: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto jIWz4; jOqBF: } goto UPEcn; b6796: goto n0IbT; goto mB7eo; iPVGt: $_output = []; goto GCFLw; UPEcn: D5egx: goto a22_1; a22_1: return $_output; goto zx2c2; y8q8W: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto k7o5i; Bn8lr: YD5F_: goto r8Hv9; k7o5i: $_output = ''; goto jq4vh; jq4vh: foreach ($this->errors as $error) { goto I_DlH; I_DlH: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\43\43"; goto tbReo; tbReo: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto d0kYS; d0kYS: HrgMl: goto XzMXN; XzMXN: } goto Bn8lr; r8Hv9: return $_output; goto pP31k; pP31k: } public function errors_array($langify = TRUE) { goto cckpB; cckpB: if ($langify) { goto zPE11; } goto Bxvv_; Fefl1: return $_output; goto Z5qRO; Hj6q3: goto klR3V; goto SCy32; OT0v8: $_output = []; goto FlNI3; SCy32: zPE11: goto OT0v8; Bxvv_: return $this->errors; goto Hj6q3; FlNI3: foreach ($this->errors as $error) { goto BDGkg; rj3Wy: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto rDLoN; rDLoN: bKfRW: goto Fbb52; BDGkg: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\43" . $error . "\43\x23"; goto rj3Wy; Fbb52: } goto k5vws; k5vws: riY_R: goto Fefl1; Z5qRO: klR3V: goto L_i9y; L_i9y: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto O6NHY; ZrPxg: return $this->db->affected_rows() == 1; goto rhw3s; hSMH6: $this->trigger_events("\145\x78\x74\x72\141\137\167\x68\145\x72\x65"); goto AOx3q; AOx3q: $this->db->update($this->tables["\165\x73\x65\162\x73"], $data, [$this->identity_column => $identity]); goto ZrPxg; AQjrw: wHl2w: goto kN1kt; tKs4z: return FALSE; goto AQjrw; kN1kt: $data = ["\160\141\163\163\x77\x6f\162\144" => $hash, "\162\x65\x6d\145\155\x62\x65\162\137\x63\157\144\x65" => NULL, "\146\157\x72\147\x6f\x74\x74\145\x6e\x5f\x70\141\163\163\x77\x6f\x72\144\x5f\143\157\144\x65" => NULL, "\x66\x6f\x72\x67\157\164\164\145\156\x5f\x70\x61\163\163\167\x6f\x72\x64\137\164\151\x6d\145" => NULL]; goto hSMH6; O6NHY: $hash = $this->hash_password($password, $identity); goto ALbva; ALbva: if (!($hash === FALSE)) { goto wHl2w; } goto tKs4z; rhw3s: } protected function _filter_data($table, $data) { goto lnpJz; IVUaN: AO_Wg: goto RxLHI; ZKTdY: FX1c3: goto IVUaN; RxLHI: return $filtered_data; goto EvjXS; HU6Fu: if (!is_array($data)) { goto AO_Wg; } goto UrpC4; eJ0FL: $columns = $this->db->list_fields($table); goto HU6Fu; lnpJz: $filtered_data = []; goto eJ0FL; UrpC4: foreach ($columns as $column) { goto gzOfe; iHJ6e: $filtered_data[$column] = $data[$column]; goto Inatm; Inatm: KRkLg: goto HBG3h; gzOfe: if (!array_key_exists($column, $data)) { goto KRkLg; } goto iHJ6e; HBG3h: VLlDf: goto aNM0B; aNM0B: } goto ZKTdY; EvjXS: } protected function _random_token($result_length = 32) { goto vXjEO; IUZ3y: return FALSE; goto HjUyU; LZ_51: nG40e: goto IUZ3y; x7jZy: if (!function_exists("\x72\x61\156\x64\x6f\x6d\x5f\142\171\x74\145\163")) { goto dnELo; } goto fmTJ2; gOyqT: dnELo: goto zWZmd; NC3Va: if (!function_exists("\x6f\x70\145\156\x73\163\x6c\x5f\x72\141\x6e\144\x6f\155\x5f\x70\x73\145\x75\x64\157\137\142\171\x74\145\x73")) { goto nG40e; } goto YqeAi; vXjEO: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto hL2DW; } goto fBQeC; fmTJ2: return bin2hex(random_bytes($result_length / 2)); goto gOyqT; UXLzZ: mrN3O: goto NC3Va; zWZmd: if (!function_exists("\x6d\x63\162\171\x70\164\x5f\143\x72\x65\x61\164\145\137\151\166")) { goto mrN3O; } goto iajJD; SM3UY: hL2DW: goto x7jZy; YqeAi: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto LZ_51; iajJD: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto UXLzZ; fBQeC: $result_length = 32; goto SM3UY; HjUyU: } protected function _get_hash_parameters($identity = NULL) { goto yr9QD; udo1d: $params = FALSE; goto s5JJA; oOHcP: return $params; goto s6hVm; fFWTP: $user_id = $this->get_user_id_from_identity($identity); goto dsWaD; hsHXF: dssPu: goto udo1d; vqk9I: miHY5: goto oOHcP; wW2j_: Vyl3X: goto vqk9I; yr9QD: $is_admin = FALSE; goto pZGIv; ez1XV: $is_admin = TRUE; goto sWD8G; s5JJA: switch ($this->hash_method) { case "\x62\x63\x72\171\x70\x74": $params = ["\x63\157\x73\164" => $is_admin ? $this->config->item("\142\143\x72\x79\160\164\x5f\141\144\155\x69\156\x5f\143\157\x73\164", "\x69\157\156\x5f\141\165\x74\x68") : $this->config->item("\142\143\x72\171\x70\164\137\144\145\x66\x61\x75\154\164\137\143\x6f\x73\x74", "\151\x6f\156\137\141\x75\164\x68")]; goto miHY5; case "\x61\x72\147\x6f\156\x32": $params = $is_admin ? $this->config->item("\141\162\x67\157\x6e\x32\137\x61\144\x6d\151\x6e\137\160\x61\x72\141\x6d\x73", "\151\157\x6e\x5f\x61\x75\164\x68") : $this->config->item("\x61\x72\147\x6f\156\x32\137\144\x65\x66\x61\x75\x6c\164\137\x70\141\x72\x61\x6d\x73", "\151\x6f\156\x5f\x61\165\x74\x68"); goto miHY5; default: } goto wW2j_; sWD8G: DchBa: goto hsHXF; dsWaD: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\151\156\x5f\147\x72\157\165\x70", "\x69\x6f\156\x5f\141\165\164\x68"), $user_id))) { goto DchBa; } goto ez1XV; pZGIv: if (!$identity) { goto dssPu; } goto fFWTP; s6hVm: } protected function _get_hash_algo() { goto LLFZb; LLFZb: $algo = FALSE; goto xCpo7; Q7Ozm: GDCaA: goto M6m3W; xCpo7: switch ($this->hash_method) { case "\x62\143\x72\x79\160\x74": $algo = PASSWORD_BCRYPT; goto l9KBw; case "\141\162\x67\157\156\62": $algo = PASSWORD_ARGON2I; goto l9KBw; default: } goto Q7Ozm; Re9pG: return $algo; goto s0o79; M6m3W: l9KBw: goto Re9pG; s0o79: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto tmyaw; jwzCA: return (object) ["\x73\145\154\145\x63\x74\157\x72" => $selector, "\166\x61\154\151\144\x61\164\157\x72\137\x68\x61\163\150\145\144" => $validator_hashed, "\165\x73\x65\x72\137\143\157\144\145" => $user_code]; goto HKscY; tmyaw: $selector = $this->_random_token($selector_size); goto e7PD1; e7PD1: $validator = $this->_random_token($validator_size); goto yL0nl; yL0nl: $validator_hashed = $this->hash_password($validator); goto purrm; purrm: $user_code = "{$selector}\x2e{$validator}"; goto jwzCA; HKscY: } protected function _retrieve_selector_validator_couple($user_code) { goto Mt3ye; Mt3ye: if (!$user_code) { goto dbV9Q; } goto Ydp3c; Ydp3c: $tokens = explode("\x2e", $user_code); goto DghV7; eEHJA: return (object) ["\x73\x65\154\x65\x63\164\x6f\162" => $tokens[0], "\x76\141\x6c\x69\144\141\164\157\x72" => $tokens[1]]; goto JaA0f; JaA0f: eHRTb: goto mE6f2; hpp8Y: return FALSE; goto ElUhk; DghV7: if (!(count($tokens) === 2)) { goto eHRTb; } goto eEHJA; mE6f2: dbV9Q: goto hpp8Y; ElUhk: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto YoxB7; LyZKR: if (!($query->num_rows() !== 1)) { goto cODBJ; } goto o917k; htBa7: $salt = substr($hashed_password_db, 0, $salt_length); goto Je10r; qlHl1: $this->trigger_events(["\x70\157\163\x74\137\163\150\x61\61\137\x70\141\163\163\x77\x6f\x72\144\137\x6d\x69\147\162\x61\x74\151\x6f\x6e", "\160\157\x73\164\x5f\x73\x68\141\61\x5f\160\141\x73\x73\x77\157\162\144\137\x6d\151\147\x72\x61\164\x69\157\156\x5f\165\x6e\x73\x75\x63\x63\145\163\163\x66\x75\154"]); goto fdRky; NeQP2: $result = $this->_set_password_db($identity, $password); goto ffk8k; fZfiA: if ($salt_length) { goto EQLnh; } goto xokid; JaUaU: ApuuK: goto mTKwD; uW5E9: c8Um8: goto PYZEB; d4JZ8: $hashed_password = sha1($password . $salt_db->salt); goto hSTK6; rOpjd: kaSpX: goto G66R8; Wuu4_: if ($this->config->item("\163\164\157\x72\145\x5f\x73\141\154\164", "\151\x6f\156\x5f\x61\165\x74\150")) { goto ApuuK; } goto KdpvP; fEclX: VCYEM: goto lmLWR; XC7oq: jyg3b: goto NeQP2; fdRky: goto kaSpX; goto uW5E9; YoxB7: $this->trigger_events("\x70\x72\145\137\x73\150\141\x31\137\160\141\163\163\167\x6f\162\x64\137\155\151\x67\162\141\x74\x69\x6f\x6e"); goto Wuu4_; wfIAQ: return FALSE; goto G6Qt5; pPVm1: goto O30Xq; goto JaUaU; xokid: $this->trigger_events(["\160\x6f\163\x74\x5f\163\x68\141\61\x5f\x70\x61\163\163\x77\157\162\144\137\155\x69\x67\x72\x61\164\151\157\156", "\x70\x6f\163\164\x5f\163\150\141\61\x5f\160\141\x73\163\x77\157\162\144\137\x6d\x69\x67\162\141\x74\151\x6f\x6e\x5f\165\x6e\x73\x75\143\143\145\163\163\x66\x75\154"]); goto wfIAQ; yz1V_: cODBJ: goto d4JZ8; HDIgX: goto VCYEM; goto XC7oq; gkZ1f: $this->trigger_events(["\160\x6f\163\x74\137\x73\x68\141\61\x5f\160\141\163\x73\167\157\162\144\137\155\151\x67\162\x61\164\151\157\156", "\x70\157\163\x74\137\x73\x68\141\61\137\x70\x61\x73\x73\167\x6f\x72\x64\137\x6d\151\x67\162\141\164\x69\157\156\137\x75\156\163\165\x63\143\x65\x73\x73\146\x75\x6c"]); goto HbEu8; G66R8: return $result; goto fEclX; Oqbl0: if ($hashed_password === $hashed_password_db) { goto jyg3b; } goto gkZ1f; igHSo: return FALSE; goto yz1V_; hSTK6: O30Xq: goto Oqbl0; ffk8k: if ($result) { goto c8Um8; } goto qlHl1; uuOAe: $salt_db = $query->row(); goto LyZKR; Je10r: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto pPVm1; o917k: $this->trigger_events(["\160\x6f\x73\x74\137\163\150\141\61\x5f\x70\x61\163\163\167\x6f\x72\x64\x5f\x6d\x69\147\x72\x61\x74\151\x6f\156", "\160\x6f\163\164\137\163\x68\x61\61\137\160\x61\163\163\x77\x6f\162\144\x5f\x6d\x69\147\162\x61\x74\151\x6f\156\x5f\x75\x6e\x73\x75\x63\143\145\163\163\146\x75\154"]); goto igHSo; mTKwD: $query = $this->db->select("\163\x61\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\145\162\x73"]); goto uuOAe; PYZEB: $this->trigger_events(["\x70\x6f\x73\x74\137\x73\x68\141\x31\137\160\141\163\163\x77\x6f\x72\144\137\x6d\151\x67\x72\x61\x74\x69\157\x6e", "\x70\x6f\x73\164\x5f\163\x68\x61\61\137\x70\x61\x73\163\167\x6f\x72\x64\137\155\x69\x67\162\x61\164\151\x6f\156\137\163\x75\x63\143\145\x73\x73\146\x75\x6c"]); goto rOpjd; HbEu8: return FALSE; goto HDIgX; KdpvP: $salt_length = $this->config->item("\163\141\x6c\164\x5f\x6c\x65\x6e\x67\164\x68", "\151\157\156\137\x61\x75\x74\x68"); goto fZfiA; G6Qt5: EQLnh: goto htBa7; lmLWR: } }
