<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\x50\x41\x54\110") or exit("\116\157\x20\x64\151\x72\145\143\x74\40\x73\x63\x72\x69\160\164\x20\141\143\143\145\163\x73\40\141\154\154\157\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto MCFoH; zmxf0: $error_prefix = $form_validation_class->getProperty("\x5f\x65\162\x72\x6f\x72\x5f\160\x72\145\146\x69\170"); goto ToEMT; Tm5Xu: if ($delimiters_source === "\x66\157\162\155\137\x76\x61\x6c\151\x64\141\164\151\157\156") { goto UjIwO; } goto ih2em; gtjTS: $this->join = $this->config->item("\152\x6f\x69\x6e", "\x69\157\x6e\137\141\165\164\150"); goto Hr5Bx; JtFKF: $this->db = $CI->db; goto HtXkv; GKeyK: $this->message_start_delimiter = $this->error_start_delimiter; goto x227d; KM__8: $this->load->helper("\x63\x6f\x6f\153\x69\x65"); goto m_u8A; JNxxz: $form_validation_class = new ReflectionClass("\x43\x49\x5f\x46\157\x72\155\x5f\x76\141\154\151\x64\141\x74\x69\x6f\x6e"); goto zmxf0; ToEMT: $error_prefix->setAccessible(TRUE); goto Kod2U; bhieH: UjIwO: goto pmFfK; CXZTE: $delimiters_source = $this->config->item("\144\x65\x6c\x69\155\151\164\x65\x72\x73\x5f\163\x6f\x75\162\143\x65", "\151\x6f\156\x5f\141\x75\x74\150"); goto Tm5Xu; FYuM4: $this->errors = []; goto CXZTE; BdySD: $this->trigger_events("\155\157\144\145\x6c\137\143\x6f\x6e\163\x74\x72\165\143\164\x6f\x72"); goto xTKe5; xShIc: $this->message_end_delimiter = $this->error_end_delimiter; goto hmTI5; j9o2P: $this->lang->load("\151\157\156\x5f\141\x75\164\150"); goto p5S8W; c8q0o: $this->identity_column = $this->config->item("\x69\x64\x65\156\164\x69\x74\171", "\x69\x6f\156\137\x61\x75\164\150"); goto gtjTS; OFV42: if (empty($group_name)) { goto wjpKM; } goto hLJzb; Dhb_h: $CI =& get_instance(); goto JtFKF; zy1vQ: $this->_ion_hooks = new stdClass(); goto BdySD; hLJzb: $this->db = $this->load->database($group_name, TRUE, TRUE); goto HeThy; hmTI5: mmE24: goto zy1vQ; U8Vsx: $this->messages = []; goto FYuM4; N5_Li: $error_suffix->setAccessible(TRUE); goto uSTYF; Kod2U: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto GKeyK; hnRo1: $this->tables = $this->config->item("\x74\x61\142\154\145\163", "\151\157\156\137\x61\x75\x74\x68"); goto c8q0o; MCFoH: $this->config->load("\151\x6f\156\x5f\x61\x75\x74\150", TRUE); goto KM__8; HtgxX: $this->error_end_delimiter = $this->config->item("\145\162\x72\157\162\x5f\x65\x6e\144\x5f\144\x65\x6c\151\155\151\x74\145\162", "\151\x6f\156\x5f\141\x75\x74\150"); goto SPgQr; Iqfyi: $this->message_end_delimiter = $this->config->item("\x6d\145\x73\x73\141\x67\x65\137\145\x6e\x64\x5f\x64\145\154\x69\x6d\151\164\x65\162", "\151\157\x6e\x5f\141\165\x74\150"); goto Dsr1K; pTSar: wjpKM: goto Dhb_h; HeThy: goto zLW8I; goto pTSar; SPgQr: goto mmE24; goto bhieH; pmFfK: $this->load->library("\x66\x6f\162\155\x5f\166\141\x6c\151\x64\x61\x74\x69\x6f\156"); goto JNxxz; m_u8A: $this->load->helper("\144\141\164\145"); goto j9o2P; ih2em: $this->message_start_delimiter = $this->config->item("\x6d\x65\163\163\x61\147\145\x5f\x73\164\x61\x72\x74\x5f\144\145\154\x69\x6d\151\x74\145\x72", "\151\157\x6e\x5f\x61\x75\164\x68"); goto Iqfyi; Hr5Bx: $this->hash_method = $this->config->item("\150\141\x73\x68\x5f\155\145\164\x68\x6f\x64", "\151\x6f\x6e\x5f\x61\165\164\150"); goto U8Vsx; x227d: $error_suffix = $form_validation_class->getProperty("\x5f\145\162\x72\157\x72\x5f\x73\x75\146\146\151\x78"); goto N5_Li; HtXkv: zLW8I: goto hnRo1; Dsr1K: $this->error_start_delimiter = $this->config->item("\145\162\162\x6f\x72\137\163\x74\141\x72\164\x5f\x64\145\154\x69\x6d\x69\164\x65\x72", "\x69\x6f\156\x5f\x61\165\x74\x68"); goto HtgxX; p5S8W: $group_name = $this->config->item("\144\141\x74\x61\142\141\163\x65\x5f\147\162\x6f\165\160\137\x6e\141\155\x65", "\x69\x6f\x6e\137\141\x75\x74\x68"); goto OFV42; uSTYF: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto xShIc; xTKe5: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto vqYaf; eQNGt: Kr2SQ: goto Oen9M; nDsjS: if (!($algo !== FALSE && $params !== FALSE)) { goto Kr2SQ; } goto o_cnw; Mrcie: $params = $this->_get_hash_parameters($identity); goto nDsjS; vqYaf: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto pbPGg; } goto zdneX; i4ag5: pbPGg: goto rgHCm; o_cnw: return password_hash($password, $algo, $params); goto eQNGt; zdneX: return FALSE; goto i4ag5; Oen9M: return FALSE; goto qI2ca; rgHCm: $algo = $this->_get_hash_algo(); goto Mrcie; qI2ca: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto L_x25; YgQPs: if (strpos($hash_password_db, "\x24") === 0) { goto zL0cb; } goto n7QkD; fS3KI: goto NU2pQ; goto Ubm6i; ua7vL: return FALSE; goto V_GxY; GBPHA: return password_verify($password, $hash_password_db); goto TSeEw; V_GxY: AMHkI: goto YgQPs; Ubm6i: zL0cb: goto GBPHA; n7QkD: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto fS3KI; TSeEw: NU2pQ: goto fPolL; L_x25: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto AMHkI; } goto ua7vL; fPolL: } public function rehash_password_if_needed($hash, $identity, $password) { goto MCdKV; EL9uR: if ($this->_set_password_db($identity, $password)) { goto cTsjg; } goto AkKx5; Jyrqz: if (!password_needs_rehash($hash, $algo, $params)) { goto uOL0z; } goto EL9uR; fJ57S: cTsjg: goto SvZkH; SvZkH: $this->trigger_events(["\162\145\x68\x61\163\x68\137\160\141\x73\x73\x77\157\162\144", "\162\x65\150\x61\163\150\x5f\160\141\x73\x73\167\157\x72\x64\x5f\x73\x75\143\x63\x65\x73\163\146\165\x6c"]); goto wM7b1; AkKx5: $this->trigger_events(["\x72\145\150\141\163\x68\x5f\x70\141\x73\x73\167\157\x72\x64", "\x72\x65\150\141\163\x68\137\160\x61\x73\163\167\157\x72\x64\137\x75\156\x73\165\143\143\x65\163\x73\146\165\x6c"]); goto FwSpf; wM7b1: tckXP: goto oBW7b; D_f75: if (!($algo !== FALSE && $params !== FALSE)) { goto gp6pV; } goto Jyrqz; M5uO4: $params = $this->_get_hash_parameters($identity); goto D_f75; MCdKV: $algo = $this->_get_hash_algo(); goto M5uO4; JclNT: gp6pV: goto hJpNA; FwSpf: goto tckXP; goto fJ57S; oBW7b: uOL0z: goto JclNT; hJpNA: } public function get_user_by_activation_code($user_code) { goto WMApd; oS3ZG: return FALSE; goto sF7Nz; s3eIi: $user = $this->where("\141\143\164\x69\x76\141\164\151\x6f\x6e\x5f\163\x65\154\x65\143\164\157\162", $token->selector)->users()->row(); goto uOZ02; nOcit: jjxDb: goto zSj2Q; fcJ6S: return $user; goto nOcit; zSj2Q: cIIlm: goto oS3ZG; uOZ02: if (!$user) { goto cIIlm; } goto IRJvF; IRJvF: if (!$this->verify_password($token->validator, $user->activation_code)) { goto jjxDb; } goto fcJ6S; WMApd: $token = $this->_retrieve_selector_validator_couple($user_code); goto s3eIi; sF7Nz: } public function activate($id, $code = FALSE) { goto AqtO0; kgv02: YuWZ9: goto bE20j; gKgb7: $this->db->update($this->tables["\x75\163\x65\162\163"], $data, ["\x69\144" => $id]); goto C_voY; qJq9E: if (!($code === FALSE || $user && $user->id === $id)) { goto YuWZ9; } goto obeh3; WmV23: $this->trigger_events(["\x70\x6f\163\164\137\x61\x63\x74\x69\166\x61\164\145", "\160\157\163\x74\x5f\141\143\164\x69\x76\x61\x74\x65\137\x73\x75\143\x63\x65\x73\163\146\x75\x6c"]); goto V_d7o; obeh3: $data = ["\x61\x63\x74\151\x76\141\x74\x69\x6f\156\x5f\163\145\154\x65\143\x74\157\x72" => NULL, "\141\143\x74\x69\x76\x61\x74\151\157\x6e\137\x63\157\x64\145" => NULL, "\141\x63\x74\x69\166\145" => 1]; goto s_XZa; UIlIv: n2BJq: goto kgv02; WAnKx: return FALSE; goto Gv8D5; V_d7o: $this->set_message("\141\143\164\x69\x76\x61\x74\145\x5f\163\165\x63\143\x65\163\163\x66\165\154"); goto ktjOg; bE20j: $this->trigger_events(["\x70\x6f\163\x74\x5f\141\x63\x74\x69\x76\141\x74\145", "\160\x6f\x73\x74\x5f\x61\x63\164\x69\166\141\x74\145\137\x75\156\x73\x75\143\x63\145\x73\x73\x66\x75\x6c"]); goto KQaV2; q1Xyv: $user = $this->get_user_by_activation_code($code); goto grbpH; KQaV2: $this->set_error("\x61\143\164\x69\x76\141\164\x65\137\165\x6e\x73\165\143\143\x65\163\x73\x66\x75\154"); goto WAnKx; Zm4AQ: if (!($code !== FALSE)) { goto wq1wO; } goto q1Xyv; C_voY: if (!($this->db->affected_rows() === 1)) { goto n2BJq; } goto WmV23; grbpH: wq1wO: goto qJq9E; AqtO0: $this->trigger_events("\x70\x72\x65\x5f\x61\143\x74\151\166\141\x74\145"); goto Zm4AQ; s_XZa: $this->trigger_events("\x65\x78\x74\162\141\x5f\167\150\145\162\x65"); goto gKgb7; ktjOg: return TRUE; goto UIlIv; Gv8D5: } public function deactivate($id = NULL) { goto KUapJ; aA8_3: $this->set_message("\x64\x65\141\143\x74\x69\166\x61\x74\x65\x5f\x73\165\x63\143\145\163\163\x66\165\154"); goto OP2P2; jajjZ: $this->set_error("\x64\x65\x61\x63\x74\151\x76\141\164\x65\x5f\143\x75\x72\162\145\x6e\164\x5f\x75\163\x65\162\x5f\x75\x6e\x73\x75\143\x63\x65\163\163\146\165\154"); goto NMSfa; duxGK: return $return; goto k_EGE; oI6jW: qpjHn: goto aA8_3; lLaFe: vnZTw: goto ctYOO; KUapJ: $this->trigger_events("\144\145\141\x63\x74\151\x76\x61\x74\x65"); goto i9Bs0; i9Bs0: if (!isset($id)) { goto vnZTw; } goto NuMFR; WSmxv: $this->db->update($this->tables["\165\163\145\x72\x73"], $data, ["\151\x64" => $id]); goto hEO7A; vFMMZ: goto p42Bn; goto oI6jW; fBKCA: $this->trigger_events("\145\170\164\x72\141\x5f\x77\150\145\162\x65"); goto WSmxv; NMSfa: return FALSE; goto a2doJ; ToWF_: $token = $this->_generate_selector_validator_couple(20, 40); goto thuyg; ctYOO: $this->set_error("\144\145\x61\143\x74\x69\x76\141\x74\x65\x5f\x75\156\x73\x75\x63\143\x65\163\163\146\x75\x6c"); goto oZKYs; i0b_N: MucFe: goto ToWF_; NuMFR: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto FbVUy; } goto jajjZ; ihyai: if ($return) { goto qpjHn; } goto IxQyZ; a2doJ: FbVUy: goto RgE3k; wFpo_: $data = ["\141\143\164\x69\x76\x61\x74\151\157\156\x5f\163\x65\154\145\x63\x74\157\x72" => $token->selector, "\141\x63\x74\151\x76\141\164\x69\x6f\x6e\x5f\143\157\x64\145" => $token->validator_hashed, "\x61\143\164\x69\166\145" => 0]; goto fBKCA; RgE3k: goto MucFe; goto lLaFe; thuyg: $this->activation_code = $token->user_code; goto wFpo_; oZKYs: return FALSE; goto i0b_N; IxQyZ: $this->set_error("\144\x65\141\143\164\151\x76\141\164\145\137\x75\x6e\163\x75\143\x63\x65\163\163\x66\165\154"); goto vFMMZ; hEO7A: $return = $this->db->affected_rows() == 1; goto ihyai; OP2P2: p42Bn: goto duxGK; k_EGE: } public function clear_forgotten_password_code($identity) { goto jxina; KbaoN: $this->db->update($this->tables["\x75\163\145\162\163"], $data, [$this->identity_column => $identity]); goto rMBrR; eZd01: return FALSE; goto g53tG; rMBrR: return TRUE; goto n2ray; g53tG: B8mNj: goto RT1KK; RT1KK: $data = ["\146\157\162\147\157\x74\164\x65\156\x5f\x70\141\x73\x73\x77\157\162\x64\137\x73\x65\154\x65\143\x74\157\x72" => NULL, "\146\157\x72\x67\x6f\x74\x74\145\156\x5f\160\x61\163\x73\167\x6f\x72\x64\137\x63\x6f\x64\x65" => NULL, "\x66\x6f\x72\147\x6f\x74\164\x65\x6e\137\x70\141\163\x73\167\157\x72\x64\x5f\164\151\x6d\x65" => NULL]; goto KbaoN; jxina: if (!empty($identity)) { goto B8mNj; } goto eZd01; n2ray: } public function clear_remember_code($identity) { goto IQEIM; IQEIM: if (!empty($identity)) { goto u1nLQ; } goto sM0yj; OmOPC: return TRUE; goto CR3Lj; kZ3fC: u1nLQ: goto f3k1s; f3k1s: $data = ["\162\145\x6d\145\x6d\142\x65\162\x5f\x73\x65\x6c\145\143\164\157\162" => NULL, "\162\145\x6d\x65\155\x62\x65\x72\x5f\x63\157\x64\145" => NULL]; goto MgqYB; MgqYB: $this->db->update($this->tables["\x75\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto OmOPC; sM0yj: return FALSE; goto kZ3fC; CR3Lj: } public function reset_password($identity, $new) { goto V3Zu9; Bta1Z: $this->trigger_events(["\x70\x6f\x73\164\x5f\x63\150\141\156\x67\145\137\x70\141\x73\x73\x77\x6f\x72\144", "\x70\157\163\164\137\x63\150\x61\x6e\x67\x65\x5f\x70\141\163\x73\167\x6f\x72\144\137\163\x75\x63\x63\145\x73\163\x66\x75\154"]); goto b7eVV; Ycd86: xssTp: goto wXDQ4; Rf8VR: K7hkk: goto xToOP; VldIR: return FALSE; goto Rf8VR; HJk_2: if ($return) { goto hUqa8; } goto bjzes; MmaoV: hUqa8: goto Bta1Z; q9aav: $this->trigger_events(["\160\157\x73\x74\137\x63\x68\141\x6e\x67\x65\x5f\x70\x61\163\x73\x77\x6f\162\x64", "\x70\157\x73\x74\x5f\x63\x68\141\x6e\x67\x65\137\x70\x61\163\163\167\x6f\x72\144\137\x75\x6e\163\165\x63\143\145\x73\x73\x66\165\x6c"]); goto VldIR; bjzes: $this->trigger_events(["\160\157\x73\x74\137\143\150\141\156\x67\145\137\x70\141\x73\163\167\x6f\x72\x64", "\160\x6f\163\x74\x5f\143\150\141\x6e\147\145\137\160\x61\x73\163\x77\x6f\162\x64\x5f\165\x6e\163\165\x63\143\145\163\163\x66\165\x6c"]); goto SB53w; V3Zu9: $this->trigger_events("\160\162\x65\137\143\150\x61\x6e\147\x65\x5f\x70\x61\163\x73\x77\157\x72\144"); goto dMgmF; i69e0: goto xssTp; goto MmaoV; b7eVV: $this->set_message("\160\141\x73\x73\x77\157\162\144\137\x63\150\141\156\147\145\x5f\x73\x75\143\x63\145\163\163\146\165\154"); goto Ycd86; xToOP: $return = $this->_set_password_db($identity, $new); goto HJk_2; SB53w: $this->set_error("\x70\x61\x73\x73\167\x6f\162\144\x5f\143\x68\141\x6e\x67\145\137\165\156\x73\165\x63\x63\145\x73\163\x66\x75\x6c"); goto i69e0; wXDQ4: return $return; goto bGvdc; dMgmF: if ($this->identity_check($identity)) { goto K7hkk; } goto q9aav; bGvdc: } public function change_password($identity, $old, $new) { goto lRwcT; xvVGk: return FALSE; goto kxPrg; DAlnG: aJZcu: goto JxtVE; i7BcO: $this->set_error("\160\x61\x73\x73\x77\x6f\x72\144\137\x63\x68\x61\x6e\x67\x65\x5f\x75\x6e\163\165\143\x63\x65\x73\x73\x66\x75\x6c"); goto vY3sY; L0p9p: return FALSE; goto MWcbC; vY3sY: goto l8dm8; goto DAlnG; l_let: $result = $this->_set_password_db($identity, $new); goto lOtmI; W5YjP: if (!($query->num_rows() !== 1)) { goto ABVzE; } goto R5glE; shXFs: $this->trigger_events("\x65\x78\164\x72\141\137\167\x68\x65\x72\x65"); goto bmc2f; I3tdV: return $result; goto Wpr2O; MWcbC: ABVzE: goto eMrV2; Qyj4z: $this->set_message("\x70\x61\163\163\167\157\x72\144\x5f\x63\150\141\156\x67\x65\137\x73\x75\x63\143\x65\163\163\x66\165\x6c"); goto vrj7z; lRwcT: $this->trigger_events("\160\x72\145\137\143\150\141\x6e\147\x65\x5f\x70\141\163\x73\167\x6f\162\x64"); goto shXFs; bmc2f: $query = $this->db->select("\x69\x64\54\x20\x70\141\x73\163\167\x6f\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\144\x65\x73\143")->get($this->tables["\165\x73\x65\x72\x73"]); goto W5YjP; eMrV2: $user = $query->row(); goto kBQzX; kBQzX: if (!$this->verify_password($old, $user->password, $identity)) { goto ZyDAN; } goto l_let; lOtmI: if ($result) { goto aJZcu; } goto g2Onp; JkSBv: $this->set_error("\160\141\163\x73\x77\x6f\162\144\x5f\x63\150\x61\156\147\145\x5f\165\156\163\x75\143\x63\x65\163\x73\146\x75\x6c"); goto xvVGk; JxtVE: $this->trigger_events(["\160\x6f\x73\164\x5f\143\150\141\156\x67\x65\x5f\160\141\x73\163\x77\x6f\162\144", "\x70\x6f\x73\164\x5f\x63\150\x61\156\x67\145\x5f\x70\x61\x73\x73\x77\x6f\162\x64\137\163\x75\143\143\145\x73\x73\146\x75\154"]); goto Qyj4z; Wpr2O: ZyDAN: goto JkSBv; R5glE: $this->trigger_events(["\160\x6f\x73\164\137\143\x68\141\156\147\145\137\x70\x61\x73\x73\167\157\x72\x64", "\x70\x6f\x73\164\x5f\x63\x68\141\156\x67\145\137\160\141\x73\163\167\157\162\x64\x5f\165\x6e\163\165\x63\x63\145\163\x73\x66\x75\154"]); goto SqnzV; vrj7z: l8dm8: goto I3tdV; SqnzV: $this->set_error("\x70\141\163\x73\x77\x6f\x72\x64\137\x63\x68\141\x6e\147\x65\x5f\x75\156\x73\x75\143\143\x65\163\x73\x66\x75\154"); goto L0p9p; g2Onp: $this->trigger_events(["\160\157\163\x74\137\x63\150\141\156\x67\x65\137\160\x61\163\163\x77\x6f\x72\x64", "\160\x6f\163\164\x5f\143\x68\x61\156\147\145\137\x70\x61\163\x73\167\157\x72\144\x5f\x75\x6e\163\x75\x63\143\145\x73\163\x66\x75\x6c"]); goto i7BcO; kxPrg: } public function username_check($username = '') { goto OmlT7; vw0SO: return FALSE; goto sBoOd; OmlT7: $this->trigger_events("\x75\163\145\x72\x6e\x61\x6d\x65\137\x63\x68\145\x63\x6b"); goto pm_02; l6VgD: return $this->db->where("\165\163\x65\x72\156\141\155\x65", $username)->limit(1)->count_all_results($this->tables["\x75\163\145\162\163"]) > 0; goto z8YIg; pm_02: if (!empty($username)) { goto oxKf0; } goto vw0SO; zieod: $this->trigger_events("\145\x78\164\x72\x61\x5f\x77\150\145\162\145"); goto l6VgD; sBoOd: oxKf0: goto zieod; z8YIg: } public function email_check($email = '') { goto q9VKo; wJBcW: qfbXX: goto po3fc; au_QD: if (!empty($email)) { goto qfbXX; } goto nSPpx; po3fc: $this->trigger_events("\x65\170\x74\162\x61\x5f\167\150\x65\x72\145"); goto u5jU6; u5jU6: return $this->db->where("\x65\155\x61\x69\154", $email)->limit(1)->count_all_results($this->tables["\x75\x73\x65\162\163"]) > 0; goto DyJ6b; q9VKo: $this->trigger_events("\x65\x6d\x61\x69\154\x5f\143\x68\145\x63\x6b"); goto au_QD; nSPpx: return FALSE; goto wJBcW; DyJ6b: } public function identity_check($identity = '') { goto Tq5tW; rLqks: if (!empty($identity)) { goto AWtj2; } goto fkEco; fkEco: return FALSE; goto tKvoB; tKvoB: AWtj2: goto zdCOW; Tq5tW: $this->trigger_events("\151\144\x65\x6e\x74\x69\164\x79\x5f\x63\x68\x65\x63\x6b"); goto rLqks; zdCOW: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\x65\x72\x73"]) > 0; goto LDdkE; LDdkE: } public function get_user_id_from_identity($identity = '') { goto qzckH; QJhx_: z0jYg: goto M3eIO; OhPyU: return FALSE; goto FDzj7; M3eIO: $user = $query->row(); goto uytzi; qzckH: if (!empty($identity)) { goto jqQGv; } goto OhPyU; FDzj7: jqQGv: goto epE3i; epE3i: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\162\163"]); goto bgK7J; TzzET: return FALSE; goto QJhx_; uytzi: return $user->id; goto FsQIU; bgK7J: if (!($query->num_rows() !== 1)) { goto z0jYg; } goto TzzET; FsQIU: } public function forgotten_password($identity) { goto mgFji; WUJyH: return FALSE; goto AsOFE; AsOFE: goto Bmkod; goto gYKvV; BN21Y: $this->db->update($this->tables["\x75\163\x65\162\x73"], $update, [$this->identity_column => $identity]); goto zzzVw; hlaKR: $this->trigger_events(["\160\x6f\x73\x74\x5f\x66\x6f\x72\x67\x6f\164\x74\145\156\137\160\x61\x73\163\167\x6f\162\144", "\x70\x6f\x73\164\137\146\157\x72\147\x6f\164\x74\x65\x6e\x5f\160\x61\163\x73\167\x6f\x72\144\137\165\x6e\x73\x75\x63\143\x65\163\163\x66\165\154"]); goto Rp9rc; mgFji: if (!empty($identity)) { goto joex4; } goto hlaKR; G61tS: $this->trigger_events(["\160\157\x73\164\x5f\x66\157\162\x67\x6f\164\164\x65\x6e\x5f\160\x61\163\163\167\x6f\162\x64", "\160\157\x73\164\137\146\x6f\x72\x67\x6f\x74\164\x65\x6e\137\160\141\x73\x73\167\157\x72\144\x5f\x73\x75\x63\143\145\163\163\146\x75\154"]); goto FHwJs; zi1g3: joex4: goto iRduB; FHwJs: return $token->user_code; goto LTqkQ; gYKvV: Ta2u5: goto G61tS; XLhCd: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\x68\145\162\x65"); goto BN21Y; jE17n: $this->trigger_events(["\160\x6f\x73\164\x5f\x66\x6f\162\147\157\164\164\145\x6e\137\160\141\163\163\167\x6f\162\144", "\x70\157\x73\164\137\x66\x6f\162\147\x6f\164\164\x65\x6e\x5f\x70\x61\x73\x73\167\x6f\162\144\x5f\x75\x6e\x73\165\x63\x63\145\x73\x73\146\165\x6c"]); goto WUJyH; Rp9rc: return FALSE; goto zi1g3; iRduB: $token = $this->_generate_selector_validator_couple(20, 80); goto Lt3lI; LTqkQ: Bmkod: goto JFPt3; Lt3lI: $update = ["\x66\157\x72\147\x6f\164\164\x65\x6e\137\160\x61\163\163\x77\157\162\144\137\163\x65\x6c\145\x63\164\157\x72" => $token->selector, "\146\157\x72\x67\x6f\x74\164\145\156\x5f\x70\141\163\163\x77\x6f\x72\x64\x5f\x63\157\144\145" => $token->validator_hashed, "\x66\157\162\x67\157\164\164\x65\x6e\137\x70\141\x73\x73\167\x6f\162\x64\137\x74\x69\155\145" => time()]; goto XLhCd; zzzVw: if ($this->db->affected_rows() === 1) { goto Ta2u5; } goto jE17n; JFPt3: } public function get_user_by_forgotten_password_code($user_code) { goto mambW; Lrfu9: if (!$user) { goto GHmRy; } goto zmDZ_; jw9IV: $user = $this->where("\146\x6f\x72\x67\x6f\x74\x74\x65\156\137\160\141\x73\x73\167\x6f\162\x64\137\163\145\154\x65\143\x74\157\x72", $token->selector)->users()->row(); goto Lrfu9; lYTxN: return $user; goto cp7aW; zmDZ_: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto DRKpM; } goto lYTxN; mgmU4: GHmRy: goto V2k1O; cp7aW: DRKpM: goto mgmU4; V2k1O: return FALSE; goto kr1xI; mambW: $token = $this->_retrieve_selector_validator_couple($user_code); goto jw9IV; kr1xI: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto Ag4eT; GUjNe: $this->set_error("\x61\143\143\x6f\165\156\x74\x5f\143\162\x65\141\x74\151\x6f\x6e\137\144\165\x70\x6c\151\143\141\x74\145\137\151\x64\145\x6e\164\151\x74\x79"); goto XuWme; x3Lfx: goto QxwZN; goto T4aou; YxSL1: Stw_S: goto Ao2DI; zxq7M: $this->trigger_events("\145\x78\164\162\x61\137\163\145\x74"); goto n0sVW; yn9hA: oXqxX: goto x3Lfx; DOGi_: $default_group = $query; goto cDbJt; rMMum: if (!(!$this->config->item("\144\145\x66\141\x75\154\x74\137\x67\x72\157\x75\160", "\x69\157\156\137\141\165\164\x68") && empty($groups))) { goto oXqxX; } goto dKz4M; XuWme: return FALSE; goto Thu9u; JmshJ: return FALSE; goto bCI7N; sDSfd: return FALSE; goto Figtc; RnP7O: foreach ($groups as $group) { $this->add_to_group($group, $id); Jcncv: } goto YxSL1; zDdJw: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\x65\x72\x73"], $additional_data), $data); goto zxq7M; xuMED: if ($this->identity_check($identity)) { goto Hzo4v; } goto rMMum; cDbJt: $ip_address = $this->input->ip_address(); goto RpRkG; tVf5y: $this->trigger_events("\x70\x6f\163\x74\137\x72\145\147\151\163\x74\x65\162"); goto YAmpn; EG31B: $this->set_error("\x61\143\143\157\165\156\x74\x5f\143\162\145\141\164\151\157\x6e\x5f\x69\156\x76\x61\154\x69\144\137\144\x65\146\141\165\154\x74\137\x67\162\157\x75\160"); goto JmshJ; sjV3c: return FALSE; goto yn9hA; C6di5: if (empty($groups)) { goto O8VJS; } goto RnP7O; YAmpn: return isset($id) ? $id : FALSE; goto TWCaP; SCHdH: $data = [$this->identity_column => $identity, "\x75\x73\x65\x72\x6e\141\155\x65" => $identity, "\x70\141\x73\163\x77\x6f\162\144" => $password, "\x65\x6d\141\x69\x6c" => $email, "\151\x70\137\141\x64\144\162\x65\x73\x73" => $ip_address, "\143\162\145\x61\x74\x65\144\137\157\156" => time(), "\x61\143\x74\x69\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto zDdJw; n0sVW: $this->db->insert($this->tables["\x75\x73\145\x72\x73"], $user_data); goto FUBac; bCI7N: Y0BGV: goto DOGi_; RpRkG: $password = $this->hash_password($password); goto OnOXF; SWrFY: $query = $this->db->get_where($this->tables["\x67\162\x6f\165\160\x73"], ["\156\141\155\x65" => $this->config->item("\144\145\x66\141\165\154\164\137\147\x72\x6f\165\x70", "\151\x6f\156\x5f\x61\x75\x74\x68")], 1)->row(); goto twwMU; aXFdp: bsRfb: goto C6di5; Ag4eT: $this->trigger_events("\x70\162\145\x5f\162\x65\x67\x69\163\164\x65\162"); goto Z6QLa; dKz4M: $this->set_error("\x61\x63\143\157\165\156\x74\x5f\143\162\x65\x61\x74\151\x6f\156\x5f\x6d\x69\163\x73\151\x6e\147\x5f\x64\x65\x66\x61\165\x6c\x74\x5f\147\162\x6f\x75\x70"); goto sjV3c; FUBac: $id = $this->db->insert_id($this->tables["\x75\163\x65\162\163"] . "\x5f\x69\x64\137\x73\145\x71"); goto wOviS; Ao2DI: O8VJS: goto tVf5y; twwMU: if (!(!isset($query->id) && empty($groups))) { goto Y0BGV; } goto EG31B; T4aou: Hzo4v: goto GUjNe; wOviS: if (!(isset($default_group->id) && empty($groups))) { goto bsRfb; } goto KL2zp; Figtc: k0zUE: goto SCHdH; Thu9u: QxwZN: goto SWrFY; HvouY: $this->set_error("\x61\x63\143\x6f\165\156\164\137\143\162\x65\x61\x74\x69\157\x6e\137\165\156\x73\x75\x63\143\x65\x73\x73\x66\165\154"); goto sDSfd; OnOXF: if (!($password === FALSE)) { goto k0zUE; } goto HvouY; KL2zp: $groups[] = $default_group->id; goto aXFdp; Z6QLa: $manual_activation = $this->config->item("\x6d\141\x6e\x75\141\154\137\x61\143\164\x69\166\x61\164\151\157\x6e", "\151\157\x6e\x5f\x61\x75\x74\x68"); goto xuMED; TWCaP: } public function login($identity, $password, $remember = FALSE) { goto wg4ly; jDZ3K: $this->set_message("\x6c\x6f\x67\x69\156\137\163\165\x63\x63\x65\163\x73\x66\x75\x6c"); goto Ri7Jt; SVVMd: epozI: goto mMro0; wg4ly: $this->trigger_events("\160\x72\145\x5f\x6c\x6f\x67\x69\156"); goto x1Ct6; tohuv: if (!$this->config->item("\x72\145\x6d\x65\x6d\x62\x65\162\x5f\165\163\145\x72\163", "\151\157\x6e\x5f\x61\165\x74\150")) { goto epozI; } goto LlWhD; LlWhD: if ($remember) { goto geeaJ; } goto e27kx; epf1c: onXBA: goto Kxa9v; vILr3: $this->trigger_events(["\160\x6f\x73\164\137\x6c\157\147\x69\x6e", "\160\x6f\x73\164\137\x6c\x6f\x67\151\156\137\x73\x75\x63\143\145\x73\x73\x66\165\154"]); goto jDZ3K; igvrT: $this->clear_login_attempts($identity); goto yPVpT; oOD_l: zzE0X: goto GqPQ7; x1Ct6: if (!(empty($identity) || empty($password))) { goto zzE0X; } goto utP6b; sQVlU: $query = $this->db->select($this->identity_column . "\x2c\40\145\x6d\x61\x69\x6c\x2c\40\151\x64\x2c\40\160\141\x73\x73\167\157\x72\144\x2c\40\141\x63\x74\x69\166\145\54\x20\x6c\x61\x73\164\137\x6c\157\147\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\163\143")->get($this->tables["\165\x73\x65\x72\163"]); goto vYuL6; ULCgK: $this->hash_password($password); goto rpXvV; mMro0: $this->rehash_password_if_needed($user->password, $identity, $password); goto fhVGq; GqPQ7: $this->trigger_events("\145\x78\x74\x72\x61\137\167\150\145\162\145"); goto sQVlU; Ul1se: $this->set_error("\x6c\157\x67\x69\x6e\137\x75\x6e\163\x75\143\143\x65\x73\x73\x66\x75\154\x5f\156\x6f\164\x5f\141\143\164\151\x76\x65"); goto s7vWr; e27kx: $this->clear_remember_code($identity); goto yWsoC; K1cER: CRf8O: goto SVVMd; UmHeR: $this->trigger_events("\x70\x6f\x73\164\x5f\x6c\157\147\151\156\x5f\165\156\x73\x75\x63\x63\145\163\163\x66\x75\x6c"); goto Cogab; Kxa9v: $this->set_session($user); goto aI1bA; aI1bA: $this->update_last_login($user->id); goto igvrT; wTcCx: N2txX: goto J_9Nz; dzgLC: if (!($query->num_rows() === 1)) { goto B70Wx; } goto bJOV8; utP6b: $this->set_error("\154\157\x67\x69\156\137\165\156\x73\x75\143\143\x65\x73\x73\x66\165\x6c"); goto wG4TG; O7_xe: return FALSE; goto ndAE5; dE6Gj: $this->trigger_events("\x70\x6f\x73\x74\137\x6c\x6f\147\x69\x6e\x5f\x75\x6e\163\165\143\x63\145\163\x73\x66\165\x6c"); goto uGRiN; Cogab: $this->set_error("\154\157\147\x69\x6e\137\164\x69\155\x65\157\x75\164"); goto O7_xe; rpXvV: $this->increase_login_attempts($identity); goto dE6Gj; J_9Nz: B70Wx: goto ULCgK; Ri7Jt: return TRUE; goto wTcCx; Q1QbH: return FALSE; goto YBqgq; ndAE5: Nmoc0: goto dzgLC; Q9QQf: $this->hash_password($password); goto UmHeR; xGS6B: $this->trigger_events("\160\157\163\164\x5f\x6c\x6f\147\151\x6e\137\x75\x6e\x73\x75\x63\143\145\x73\x73\146\x75\x6c"); goto Ul1se; yWsoC: goto CRf8O; goto aowru; aowru: geeaJ: goto jlfQY; yPVpT: $this->clear_forgotten_password_code($identity); goto tohuv; fhVGq: $this->session->sess_regenerate(FALSE); goto vILr3; bJOV8: $user = $query->row(); goto b4hq0; wG4TG: return FALSE; goto oOD_l; vYuL6: if (!$this->is_max_login_attempts_exceeded($identity)) { goto Nmoc0; } goto Q9QQf; jlfQY: $this->remember_user($identity); goto K1cER; b4hq0: if (!$this->verify_password($password, $user->password, $identity)) { goto N2txX; } goto lHh6o; uGRiN: $this->set_error("\154\157\147\x69\156\x5f\x75\x6e\x73\x75\143\143\145\x73\163\146\165\154"); goto Q1QbH; s7vWr: return FALSE; goto epf1c; lHh6o: if (!($user->active == 0)) { goto onXBA; } goto xGS6B; YBqgq: } public function recheck_session() { goto inmR4; Wxtor: Bbjtl: goto C0vOG; gEciF: $query = $this->db->select("\151\144")->where([$this->identity_column => $this->session->userdata("\151\144\145\156\164\x69\164\x79"), "\141\143\164\x69\x76\x65" => "\x31"])->limit(1)->order_by("\151\x64", "\144\x65\163\x63")->get($this->tables["\165\x73\x65\x72\x73"]); goto n3oVg; GNz6x: if (!($recheck !== 0)) { goto Bbjtl; } goto QykuX; XZbz5: CErKW: goto Wxtor; Pkp1R: pqIOp: goto XZbz5; QykuX: $last_login = $this->session->userdata("\x6c\x61\x73\x74\x5f\143\x68\145\x63\x6b"); goto DSipX; C9OPJ: $this->trigger_events("\x6c\x6f\x67\x6f\x75\x74"); goto nTyxz; C0vOG: return (bool) $this->session->userdata("\151\144\x65\156\164\x69\x74\171"); goto nyjSc; DSipX: if (!($last_login + $recheck < time())) { goto CErKW; } goto gEciF; z2_O7: $this->session->set_userdata("\x6c\141\163\x74\x5f\143\x68\x65\143\x6b", time()); goto Pkp1R; kRSeQ: Ip_B2: goto z2_O7; inmR4: $recheck = NULL !== $this->config->item("\x72\x65\x63\150\145\143\153\x5f\x74\151\x6d\145\x72", "\151\157\x6e\x5f\x61\165\164\150") ? $this->config->item("\x72\x65\x63\x68\x65\143\153\137\x74\x69\x6d\145\162", "\x69\157\156\137\141\x75\x74\x68") : 0; goto GNz6x; uLS5X: $this->session->unset_userdata([$identity, "\x69\x64", "\165\163\145\162\137\151\144"]); goto GC_gC; n3oVg: if ($query->num_rows() === 1) { goto Ip_B2; } goto C9OPJ; GC_gC: return FALSE; goto JgxSS; nTyxz: $identity = $this->config->item("\x69\144\145\x6e\x74\x69\164\x79", "\x69\x6f\x6e\x5f\141\165\x74\150"); goto uLS5X; JgxSS: goto pqIOp; goto kRSeQ; nyjSc: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto Bq0RN; BzA72: return FALSE; goto Fzwzj; ZzB1R: SgJwj: goto VIwYL; cF3fS: return $attempts >= $max_attempts; goto ZzB1R; pIdDJ: if (!($max_attempts > 0)) { goto SgJwj; } goto GUDDU; VIwYL: rjuzL: goto BzA72; t6C94: $max_attempts = $this->config->item("\155\x61\x78\x69\155\x75\x6d\x5f\x6c\157\147\151\156\137\141\x74\x74\145\x6d\160\164\x73", "\x69\x6f\156\x5f\x61\165\x74\150"); goto pIdDJ; GUDDU: $attempts = $this->get_attempts_num($identity, $ip_address); goto cF3fS; Bq0RN: if (!$this->config->item("\x74\x72\x61\143\153\x5f\154\x6f\147\151\x6e\x5f\x61\x74\x74\x65\155\160\x74\163", "\x69\157\x6e\x5f\141\165\x74\150")) { goto rjuzL; } goto t6C94; Fzwzj: } public function get_attempts_num($identity, $ip_address = NULL) { goto a7itI; QQ0DB: if (isset($ip_address)) { goto o6osc; } goto LrClD; asEKK: return 0; goto GHG7b; jTES9: return $qres->num_rows(); goto DW_YW; UdzDn: $this->db->where("\x69\x70\137\141\x64\144\x72\145\163\x73", $ip_address); goto aHBbT; pszT0: if (!$this->config->item("\164\x72\x61\x63\x6b\x5f\154\x6f\x67\151\x6e\x5f\x69\160\x5f\x61\x64\144\162\x65\x73\163", "\151\x6f\156\x5f\x61\x75\x74\x68")) { goto Tc6dk; } goto QQ0DB; aHBbT: Tc6dk: goto Em5QW; a7itI: if (!$this->config->item("\164\162\141\x63\153\137\154\x6f\x67\x69\156\137\141\164\x74\x65\x6d\160\x74\163", "\151\157\x6e\137\141\x75\164\150")) { goto G0pwS; } goto Avmay; yC5v7: o6osc: goto UdzDn; LrClD: $ip_address = $this->input->ip_address(); goto yC5v7; Em5QW: $this->db->where("\164\151\x6d\x65\40\76", time() - $this->config->item("\x6c\157\143\153\x6f\x75\164\137\x74\x69\155\x65", "\x69\x6f\156\137\141\165\164\150"), FALSE); goto x1a91; DW_YW: G0pwS: goto asEKK; x1a91: $qres = $this->db->get($this->tables["\154\157\147\x69\156\x5f\x61\x74\x74\x65\x6d\x70\164\163"]); goto jTES9; Avmay: $this->db->select("\x31", FALSE); goto Oiht4; Oiht4: $this->db->where("\x6c\157\x67\151\156", $identity); goto pszT0; GHG7b: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto sfBxV; q5BP6: G0_9E: goto exDkM; IUpcJ: zt4sx: goto IX5ip; diieX: if (isset($ip_address)) { goto XheKe; } goto wxmLJ; Ky9vZ: $qres = $this->db->get($this->tables["\x6c\157\147\151\x6e\137\141\164\164\x65\155\x70\x74\163"], 1); goto rpcrS; wxmLJ: $ip_address = $this->input->ip_address(); goto iw7X2; rpcrS: if (!($qres->num_rows() > 0)) { goto zt4sx; } goto QxQEi; iw7X2: XheKe: goto ivISy; sfBxV: if (!$this->config->item("\x74\162\x61\x63\153\x5f\x6c\x6f\x67\151\x6e\137\141\x74\164\145\x6d\x70\x74\163", "\x69\x6f\156\x5f\x61\165\x74\x68")) { goto c_IvV; } goto dErGK; dErGK: $this->db->select("\x74\x69\x6d\x65"); goto VHJ_7; IX5ip: c_IvV: goto LRu5e; VHJ_7: $this->db->where("\154\157\x67\151\x6e", $identity); goto Q5cyK; Q5cyK: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\154\157\x67\x69\x6e\x5f\x69\160\x5f\x61\144\x64\x72\x65\163\163", "\151\157\x6e\x5f\141\165\164\150")) { goto G0_9E; } goto diieX; QxQEi: return $qres->row()->time; goto IUpcJ; exDkM: $this->db->order_by("\x69\x64", "\144\x65\x73\x63"); goto Ky9vZ; LRu5e: return 0; goto KVpUU; ivISy: $this->db->where("\151\160\x5f\141\144\144\x72\x65\x73\163", $ip_address); goto q5BP6; KVpUU: } public function get_last_attempt_ip($identity) { goto e9vqC; Wa2OA: $this->db->order_by("\151\144", "\x64\x65\x73\x63"); goto zkgTB; W52yX: $this->db->select("\151\160\x5f\141\144\x64\x72\145\x73\163"); goto cwAbK; cwAbK: $this->db->where("\154\157\x67\x69\156", $identity); goto Wa2OA; LAiBl: hneXC: goto P5C2g; jnBrC: return $qres->row()->ip_address; goto LAiBl; P5C2g: JjWJ9: goto jo3lP; F4hIX: if (!($qres->num_rows() > 0)) { goto hneXC; } goto jnBrC; zkgTB: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\156\x5f\141\164\x74\145\x6d\160\x74\x73"], 1); goto F4hIX; e9vqC: if (!($this->config->item("\x74\x72\141\143\x6b\137\x6c\157\147\x69\x6e\x5f\x61\x74\164\145\x6d\x70\x74\163", "\151\x6f\x6e\x5f\x61\x75\x74\x68") && $this->config->item("\164\162\141\143\x6b\137\154\157\x67\x69\156\137\x69\x70\x5f\x61\144\144\x72\x65\x73\163", "\x69\x6f\x6e\x5f\x61\x75\164\x68"))) { goto JjWJ9; } goto W52yX; jo3lP: return ''; goto uuETZ; uuETZ: } public function increase_login_attempts($identity) { goto KFMib; ZLofV: return FALSE; goto Q9QLf; sntZ2: $data = ["\x69\160\137\141\x64\144\162\x65\x73\163" => '', "\x6c\x6f\147\151\156" => $identity, "\x74\151\x6d\145" => time()]; goto J2x6n; H8txG: f9HJe: goto ZLofV; jfjAU: return $this->db->insert($this->tables["\x6c\157\147\151\x6e\137\141\164\164\x65\x6d\160\164\x73"], $data); goto H8txG; UdeIR: $data["\x69\160\137\141\x64\x64\162\x65\163\x73"] = $this->input->ip_address(); goto kCMyZ; kCMyZ: NL0i1: goto jfjAU; KFMib: if (!$this->config->item("\164\162\141\x63\x6b\137\154\157\x67\x69\156\137\x61\x74\164\x65\155\x70\164\163", "\x69\157\x6e\137\141\165\x74\x68")) { goto f9HJe; } goto sntZ2; J2x6n: if (!$this->config->item("\x74\x72\141\143\153\x5f\154\157\147\151\156\137\x69\x70\137\141\144\144\162\x65\x73\163", "\151\157\x6e\x5f\141\x75\164\150")) { goto NL0i1; } goto UdeIR; Q9QLf: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto zDSyl; lyszE: kdmU3: goto XSETP; XSETP: return FALSE; goto YRjOx; UMeTU: $this->db->where("\151\160\x5f\141\144\x64\x72\x65\x73\x73", $ip_address); goto JbejO; OgmGb: $this->db->where("\154\x6f\x67\151\156", $identity); goto Vu2EK; FuUPI: $ip_address = $this->input->ip_address(); goto VHwTy; zDSyl: if (!$this->config->item("\x74\x72\x61\143\153\x5f\x6c\157\147\151\156\137\141\164\x74\145\x6d\x70\x74\163", "\151\157\156\137\x61\165\164\x68")) { goto kdmU3; } goto GG0YP; JbejO: MU8eL: goto YXIxm; YXIxm: $this->db->or_where("\x74\x69\155\145\40\x3c", time() - $old_attempts_expire_period, FALSE); goto Lnfx9; GG0YP: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\x63\153\157\165\x74\x5f\164\151\x6d\x65", "\x69\157\156\x5f\141\x75\164\150")); goto OgmGb; Lnfx9: return $this->db->delete($this->tables["\x6c\x6f\147\x69\156\137\141\x74\164\145\155\160\164\163"]); goto lyszE; Zd0XY: if (isset($ip_address)) { goto EIHZ8; } goto FuUPI; Vu2EK: if (!$this->config->item("\x74\x72\141\143\153\137\154\x6f\x67\151\156\x5f\151\160\x5f\x61\x64\x64\x72\x65\x73\163", "\151\157\x6e\137\141\165\x74\x68")) { goto MU8eL; } goto Zd0XY; VHwTy: EIHZ8: goto UMeTU; YRjOx: } public function limit($limit) { goto uc_J4; uc_J4: $this->trigger_events("\154\x69\155\151\164"); goto LhT_0; LhT_0: $this->_ion_limit = $limit; goto UK2FP; UK2FP: return $this; goto mkkrC; mkkrC: } public function offset($offset) { goto WZqv4; WZqv4: $this->trigger_events("\x6f\146\146\163\x65\164"); goto QW0K3; VQHcx: return $this; goto PbqXl; QW0K3: $this->_ion_offset = $offset; goto VQHcx; PbqXl: } public function where($where, $value = NULL) { goto o47HB; w75WD: return $this; goto vkldb; hsR5R: array_push($this->_ion_where, $where); goto w75WD; IvaON: qQUG4: goto hsR5R; c7WCS: $where = [$where => $value]; goto IvaON; o47HB: $this->trigger_events("\x77\x68\x65\x72\145"); goto UYo26; UYo26: if (is_array($where)) { goto qQUG4; } goto c7WCS; vkldb: } public function like($like, $value = NULL, $position = "\142\157\x74\150") { goto QpzsI; QpzsI: $this->trigger_events("\x6c\x69\153\x65"); goto k6QE0; k6QE0: array_push($this->_ion_like, ["\154\151\153\145" => $like, "\x76\141\154\x75\145" => $value, "\160\157\163\151\x74\x69\x6f\156" => $position]); goto n7pM0; n7pM0: return $this; goto B0I4N; B0I4N: } public function select($select) { goto kTcbG; kTcbG: $this->trigger_events("\x73\145\x6c\x65\x63\164"); goto qjD53; N5015: return $this; goto iH6x3; qjD53: $this->_ion_select[] = $select; goto N5015; iH6x3: } public function order_by($by, $order = "\x64\x65\163\143") { goto EnMgR; JswQd: $this->_ion_order_by = $by; goto MUrAo; EnMgR: $this->trigger_events("\x6f\x72\x64\x65\162\x5f\x62\x79"); goto JswQd; MUrAo: $this->_ion_order = $order; goto d1p72; d1p72: return $this; goto R_rGf; R_rGf: } public function row() { goto uRSuI; uRSuI: $this->trigger_events("\x72\x6f\x77"); goto pg6HK; yGrLh: return $row; goto ex80p; pg6HK: $row = $this->response->row(); goto yGrLh; ex80p: } public function row_array() { goto GWZim; GWZim: $this->trigger_events(["\x72\157\167", "\162\157\x77\x5f\x61\x72\x72\x61\171"]); goto CkSRI; CkSRI: $row = $this->response->row_array(); goto M_W0f; M_W0f: return $row; goto hgZL7; hgZL7: } public function result() { goto l9W2T; iuJv_: $result = $this->response->result(); goto cJZdw; cJZdw: return $result; goto p9DsZ; l9W2T: $this->trigger_events("\x72\x65\x73\x75\154\164"); goto iuJv_; p9DsZ: } public function result_array() { goto wr6UX; q4alC: return $result; goto KBqNr; wr6UX: $this->trigger_events(["\162\x65\x73\x75\154\164", "\162\145\163\165\x6c\164\x5f\x61\x72\162\x61\171"]); goto Pph75; Pph75: $result = $this->response->result_array(); goto q4alC; KBqNr: } public function num_rows() { goto yxOTG; Wg_PF: return $result; goto NDY4C; yxOTG: $this->trigger_events(["\156\165\155\137\162\157\167\163"]); goto nyt3d; nyt3d: $result = $this->response->num_rows(); goto Wg_PF; NDY4C: } public function users($groups = NULL) { goto KLhdU; DU17L: foreach ($this->_ion_where as $where) { $this->db->where($where); Xa4FH: } goto PoiYx; iaxDz: $group_ids = []; goto n1Wzr; gJMxo: if (empty($group_ids)) { goto K3_X9; } goto SylE7; oIm03: WfqsV: goto gHeos; HbLZe: $this->_ion_select = []; goto RKCdv; hoIvM: $this->_ion_order = NULL; goto A1SlX; P2sNF: $this->db->join($this->tables["\165\163\x65\x72\163\x5f\x67\x72\x6f\165\x70\163"], $this->tables["\165\163\145\162\x73\x5f\147\162\x6f\x75\x70\163"] . "\56" . $this->join["\x75\x73\x65\x72\x73"] . "\x3d" . $this->tables["\165\x73\145\162\163"] . "\56\x69\x64", "\151\156\156\145\x72"); goto pbLK7; ADhEf: $this->db->select([$this->tables["\165\x73\x65\162\x73"] . "\56\x2a", $this->tables["\x75\x73\145\162\x73"] . "\x2e\151\144\x20\141\x73\40\151\x64", $this->tables["\x75\163\x65\162\163"] . "\x2e\151\144\40\x61\x73\x20\x75\163\145\x72\x5f\x69\x64"]); goto lpVw0; SylE7: $this->db->{$or_where_in}($this->tables["\x75\163\x65\x72\x73\x5f\147\162\x6f\165\x70\x73"] . "\x2e" . $this->join["\147\x72\x6f\x75\160\163"], $group_ids); goto Cb96z; TgtSI: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto hoIvM; ryjNN: INArh: goto gJMxo; A1mkv: X95ML: goto HbLZe; C3c9B: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto gbblb; } goto ebimQ; i4h1M: $this->db->join($this->tables["\147\x72\x6f\x75\x70\x73"], $this->tables["\x75\163\x65\x72\163\137\x67\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\162\157\165\x70\163"] . "\x20\x3d\40" . $this->tables["\x67\x72\x6f\165\x70\163"] . "\x2e\151\x64", "\x69\x6e\156\145\162"); goto bjkgC; mzzon: $this->response = $this->db->get($this->tables["\165\163\145\162\x73"]); goto p_E3A; vJN9d: $this->_ion_offset = NULL; goto YefQZ; MrTWl: ZHM9Q: goto tGyhV; XJ_KA: if (empty($group_names)) { goto INArh; } goto i4h1M; ifr80: AJmJJ: goto C3c9B; l4hck: foreach ($groups as $group) { goto Sx8S_; zfFTQ: FECwf: goto SkvD4; rlNiC: fFj6g: goto czTux; iB2J_: NMVc3: goto rlNiC; SkvD4: $group_ids[] = $group; goto iB2J_; HIsRB: $group_names[] = $group; goto Fc9bw; Fc9bw: goto NMVc3; goto zfFTQ; Sx8S_: if (is_numeric($group)) { goto FECwf; } goto HIsRB; czTux: } goto oIm03; YefQZ: iko47: goto X5ZBm; cK0a1: JoCQk: goto mpOPi; PoiYx: A5vJj: goto sMoE1; Iff7h: hKAEj: goto c3AzI; cSCuw: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto ZHM9Q; } goto DU17L; p_E3A: return $this; goto yOXmK; r98Y0: if (is_array($groups)) { goto hKAEj; } goto FSAix; b3mZs: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto JoCQk; } goto ADhEf; pbLK7: jkm7E: goto iaxDz; tGyhV: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto AJmJJ; } goto mddSn; QFUYx: Xabdv: goto xN1c3; lpVw0: goto B8T89; goto cK0a1; A1SlX: $this->_ion_order_by = NULL; goto a3hJx; FMKTV: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto ktBJ6; c3AzI: if (!(isset($groups) && !empty($groups))) { goto jkm7E; } goto BoPo0; IgPY_: $this->_ion_limit = NULL; goto QFUYx; ebimQ: if (!isset($this->_ion_limit)) { goto Xabdv; } goto wFlB_; We6VH: $this->_ion_like = []; goto ifr80; a3hJx: PZQSz: goto mzzon; TxS3l: if (!isset($groups)) { goto Hte5M; } goto r98Y0; n1Wzr: $group_names = []; goto l4hck; BoPo0: $this->db->distinct(); goto P2sNF; mpOPi: foreach ($this->_ion_select as $select) { $this->db->select($select); bHQTc: } goto A1mkv; X5ZBm: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto PZQSz; } goto TgtSI; Cb96z: K3_X9: goto WP5Kj; RKCdv: B8T89: goto TxS3l; WP5Kj: Hte5M: goto psQ53; DV21p: OqL3v: goto We6VH; xN1c3: goto iko47; goto p6Toi; gHeos: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\x72\x5f\167\150\145\162\145\x5f\x69\x6e" : "\x77\150\145\162\x65\x5f\151\156"; goto XJ_KA; FSAix: $groups = [$groups]; goto Iff7h; bjkgC: $this->db->where_in($this->tables["\x67\x72\157\x75\x70\x73"] . "\56\156\x61\x6d\145", $group_names); goto ryjNN; psQ53: $this->trigger_events("\x65\170\x74\x72\x61\x5f\167\150\145\162\x65"); goto cSCuw; KLhdU: $this->trigger_events("\x75\x73\x65\x72\x73"); goto b3mZs; p6Toi: gbblb: goto FMKTV; sMoE1: $this->_ion_where = []; goto MrTWl; ktBJ6: $this->_ion_limit = NULL; goto vJN9d; mddSn: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\154\151\153\x65"], $like["\166\x61\x6c\x75\x65"], $like["\x70\x6f\x73\x69\164\x69\157\156"]); y_62W: } goto DV21p; wFlB_: $this->db->limit($this->_ion_limit); goto IgPY_; yOXmK: } public function user($id = NULL) { goto rs3J3; TQVE0: $this->users(); goto EVAaa; Z10F3: $this->where($this->tables["\x75\x73\x65\162\x73"] . "\x2e\151\x64", $id); goto TQVE0; RYkO_: $this->order_by($this->tables["\165\163\145\162\x73"] . "\x2e\151\144", "\144\x65\163\143"); goto Z10F3; EVAaa: return $this; goto dVOxj; rs3J3: $this->trigger_events("\165\x73\x65\162"); goto Y0yXN; RoYQQ: $this->limit(1); goto RYkO_; Y0yXN: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\162\x5f\151\144"); goto RoYQQ; dVOxj: } public function get_users_groups($id = FALSE) { goto KZBQM; peg0D: $id || ($id = $this->session->userdata("\x75\x73\145\162\137\x69\x64")); goto cpKE_; cpKE_: return $this->db->select($this->tables["\x75\x73\x65\162\x73\x5f\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\147\162\157\165\x70\x73"] . "\40\141\163\x20\x69\144\54\x20" . $this->tables["\147\x72\x6f\x75\x70\x73"] . "\x2e\156\141\155\x65\54\x20" . $this->tables["\147\162\157\x75\160\x73"] . "\56\144\145\x73\143\x72\x69\x70\x74\151\x6f\156")->where($this->tables["\x75\163\145\x72\163\x5f\147\x72\157\x75\x70\163"] . "\x2e" . $this->join["\x75\163\x65\x72\163"], $id)->join($this->tables["\147\162\x6f\165\x70\x73"], $this->tables["\x75\x73\x65\x72\x73\x5f\x67\x72\157\165\x70\163"] . "\56" . $this->join["\147\162\x6f\x75\x70\x73"] . "\75" . $this->tables["\147\x72\x6f\165\x70\163"] . "\56\x69\x64")->get($this->tables["\x75\x73\x65\x72\x73\137\x67\x72\x6f\165\x70\x73"]); goto mS84b; KZBQM: $this->trigger_events("\x67\x65\x74\x5f\x75\163\145\x72\163\x5f\147\162\x6f\165\160"); goto peg0D; mS84b: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto TclM5; Tn37M: $this->_cache_user_in_group[$id] = $groups_array; goto FSSYY; OjvCU: $check_group = [$check_group]; goto HKx65; Nmmb_: k6KEJ: goto RDfZz; moRLx: OBqEU: goto Tn37M; oVKiJ: HWeri: goto xmJHd; J68N7: $users_groups = $this->get_users_groups($id)->result(); goto z8q85; NPhzN: if (is_array($check_group)) { goto espbh; } goto OjvCU; emH19: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; yPtau: } goto moRLx; TclM5: $this->trigger_events("\x69\x6e\137\147\162\157\165\160"); goto vnYx8; HKx65: espbh: goto dXXEt; dXXEt: if (isset($this->_cache_user_in_group[$id])) { goto HWeri; } goto J68N7; ad3zb: dZr6f: goto r7i9Y; FSSYY: goto k6KEJ; goto oVKiJ; RDfZz: foreach ($check_group as $key => $value) { goto IQcLO; Bk8ci: Cg_40: goto myPnq; PutEt: return !$check_all; goto WoOLh; WoOLh: g00LJ: goto Bk8ci; IQcLO: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto jpmUJ; jpmUJ: if (!(in_array($value, $groups) xor $check_all)) { goto g00LJ; } goto PutEt; myPnq: } goto ad3zb; vnYx8: $id || ($id = $this->session->userdata("\165\x73\145\162\x5f\151\144")); goto NPhzN; z8q85: $groups_array = []; goto emH19; xmJHd: $groups_array = $this->_cache_user_in_group[$id]; goto Nmmb_; r7i9Y: return $check_all; goto Dtovt; Dtovt: } public function add_to_group($group_ids, $user_id = FALSE) { goto qjT3g; zmLBR: if (is_array($group_ids)) { goto EqIGW; } goto Bd9fv; kMM9x: $return = 0; goto j8YEI; ALCS5: return $return; goto cqUe0; qjT3g: $this->trigger_events("\x61\x64\x64\137\164\x6f\x5f\x67\x72\x6f\165\x70"); goto xqY_m; Bd9fv: $group_ids = [$group_ids]; goto FKEW8; j8YEI: foreach ($group_ids as $group_id) { goto H8ADw; vof0O: $this->_cache_groups[$group_id] = $group_name; goto kxDfz; e_0ir: $group = $this->group($group_id)->result(); goto WASRr; H8ADw: if (!$this->db->insert($this->tables["\x75\163\x65\162\163\x5f\x67\162\157\165\160\163"], [$this->join["\x67\162\x6f\165\160\163"] => (float) $group_id, $this->join["\165\163\145\x72\163"] => (float) $user_id])) { goto FNiac; } goto NDxoR; WASRr: $group_name = $group[0]->name; goto vof0O; o657V: j7ohe: goto Hvf4t; ybOru: $return++; goto LGJ89; EQ1ys: oRfa3: goto T9jx3; qw5_h: $group_name = $this->_cache_groups[$group_id]; goto EQ1ys; LGJ89: FNiac: goto o657V; T9jx3: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto ybOru; M0kGf: u2U6u: goto qw5_h; kxDfz: goto oRfa3; goto M0kGf; NDxoR: if (isset($this->_cache_groups[$group_id])) { goto u2U6u; } goto e_0ir; Hvf4t: } goto RIFGD; RIFGD: a2ZEs: goto ALCS5; xqY_m: $user_id || ($user_id = $this->session->userdata("\x75\x73\145\162\x5f\151\144")); goto zmLBR; FKEW8: EqIGW: goto kMM9x; cqUe0: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto LhC4n; g1ieY: $return = TRUE; goto DqTWP; eLs9q: uSdE4: goto g1ieY; DqTWP: fUzth: goto d9WLi; vprhu: if (!empty($group_ids)) { goto U_Eid; } goto QAEHq; MICSH: $this->_cache_user_in_group[$user_id] = []; goto OqYE1; jhDWO: goto fUzth; goto Lgq9O; K_wGv: return FALSE; goto BEOF5; M9XNa: KifeM: goto wEqRj; O7h4i: if (!empty($user_id)) { goto lrd8K; } goto K_wGv; EPiak: if (is_array($group_ids)) { goto KifeM; } goto yVv8a; BEOF5: lrd8K: goto vprhu; d9WLi: return $return; goto Z7GcL; OqYE1: rruuA: goto jhDWO; Lgq9O: U_Eid: goto EPiak; LhC4n: $this->trigger_events("\x72\x65\x6d\157\166\145\x5f\146\x72\157\x6d\x5f\147\162\x6f\165\x70"); goto O7h4i; yVv8a: $group_ids = [$group_ids]; goto M9XNa; wEqRj: foreach ($group_ids as $group_id) { goto iUd1b; TsEMA: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto CBomr; } goto EEZdo; WBByE: CBomr: goto h7Vr6; h7Vr6: wh3aU: goto czkdX; iUd1b: $this->db->delete($this->tables["\x75\163\145\162\x73\137\x67\x72\157\x75\x70\x73"], [$this->join["\147\162\x6f\x75\160\163"] => (float) $group_id, $this->join["\165\x73\x65\x72\x73"] => (float) $user_id]); goto TsEMA; EEZdo: unset($this->_cache_user_in_group[$user_id][$group_id]); goto WBByE; czkdX: } goto eLs9q; QAEHq: if (!($return = $this->db->delete($this->tables["\165\163\145\162\163\x5f\x67\162\x6f\165\160\163"], [$this->join["\165\163\145\x72\x73"] => (float) $user_id]))) { goto rruuA; } goto MICSH; Z7GcL: } public function groups() { goto x3QCA; dUqoy: $this->_ion_limit = NULL; goto sF5cv; jVcVN: goto gPC2P; goto i9oNw; hpP3E: if (!isset($this->_ion_limit)) { goto ob97t; } goto TPSiR; TPSiR: $this->db->limit($this->_ion_limit); goto cUtAA; RyXt1: ob97t: goto jVcVN; rYPso: return $this; goto fWuLW; x3QCA: $this->trigger_events("\147\162\x6f\x75\160\x73"); goto v7OLz; MC3OQ: UAbw4: goto UL1Px; q9epX: $this->response = $this->db->get($this->tables["\x67\x72\x6f\x75\x70\x73"]); goto rYPso; WAda7: c_95q: goto q9epX; hLgvd: gPC2P: goto k9TDi; i9oNw: L4MTz: goto pg0gn; v7OLz: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto UAbw4; } goto gvg8Z; gvg8Z: foreach ($this->_ion_where as $where) { $this->db->where($where); vRPmV: } goto xuM0N; Jt0am: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto WAda7; sF5cv: $this->_ion_offset = NULL; goto hLgvd; UL1Px: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto L4MTz; } goto hpP3E; cUtAA: $this->_ion_limit = NULL; goto RyXt1; pg0gn: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto dUqoy; R07Yd: $this->_ion_where = []; goto MC3OQ; xuM0N: LFn_V: goto R07Yd; k9TDi: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto c_95q; } goto Jt0am; fWuLW: } public function group($id = NULL) { goto XoGhr; wuhD6: $this->order_by("\151\x64", "\144\145\x73\143"); goto l8BeM; dppww: du5wa: goto FyG1C; sZLD7: if (!isset($id)) { goto du5wa; } goto vMsQ1; vMsQ1: $this->where($this->tables["\x67\162\x6f\165\x70\163"] . "\56\151\x64", $id); goto dppww; l8BeM: return $this->groups(); goto ICh9W; FyG1C: $this->limit(1); goto wuhD6; XoGhr: $this->trigger_events("\x67\162\x6f\165\160"); goto sZLD7; ICh9W: } public function update($id, array $data) { goto BtGEu; ZwaBb: $user = $this->user($id)->row(); goto aCWW1; VsLFe: $data = $this->_filter_data($this->tables["\x75\x73\x65\162\163"], $data); goto LlNE1; LlNE1: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\x61\x73\163\167\157\162\144", $data) || array_key_exists("\x65\x6d\x61\x69\154", $data))) { goto O1mro; } goto wQUc5; h3gor: $data["\160\141\x73\163\x77\157\x72\x64"] = $this->hash_password($data["\x70\x61\163\x73\167\x6f\162\144"], $user->{$this->identity_column}); goto a_JNp; Y0mKn: $this->set_error("\165\x70\x64\141\x74\145\137\x75\156\163\165\x63\143\145\x73\x73\146\165\x6c"); goto tko18; gH6I8: $this->db->trans_rollback(); goto n4Ri7; lqUYn: $this->set_error("\141\143\143\157\x75\x6e\x74\137\143\x72\145\x61\x74\151\x6f\x6e\137\x64\x75\160\x6c\151\143\x61\x74\145\137\x69\144\145\x6e\164\x69\x74\171"); goto Gdche; K0kDT: O1mro: goto enZ7D; P3cTM: return TRUE; goto HTTTh; YGNVQ: $this->db->trans_commit(); goto NOqTd; wQUc5: if (!array_key_exists("\x70\x61\x73\x73\167\x6f\x72\144", $data)) { goto CWuLM; } goto WivJc; CR1AP: return FALSE; goto Fllvd; U88R5: OHaGI: goto h3gor; ql0NQ: unset($data["\160\x61\163\163\x77\157\x72\144"]); goto vft9D; i6aKg: CJj17: goto VsLFe; aCWW1: $this->db->trans_begin(); goto v9Kba; vft9D: goto b_zwx; goto U88R5; AaDcg: q0ApU: goto Bj2pp; NOqTd: $this->trigger_events(["\x70\x6f\163\x74\137\165\160\x64\141\164\145\137\165\x73\145\x72", "\160\157\163\164\137\165\160\x64\x61\x74\145\x5f\165\163\x65\x72\x5f\x73\165\143\143\x65\x73\x73\146\165\154"]); goto TbjBR; WivJc: if (!empty($data["\160\x61\x73\163\167\157\162\x64"])) { goto OHaGI; } goto ql0NQ; LUdA7: if (!($this->db->trans_status() === FALSE)) { goto xuzHH; } goto gH6I8; enZ7D: $this->trigger_events("\145\x78\164\x72\141\x5f\167\x68\x65\x72\x65"); goto PrwVM; Bj2pp: b_zwx: goto t1nHu; PrwVM: $this->db->update($this->tables["\x75\163\145\x72\x73"], $data, ["\x69\144" => $user->id]); goto LUdA7; Gdche: $this->trigger_events(["\x70\x6f\x73\164\x5f\165\x70\x64\x61\x74\x65\137\165\x73\145\x72", "\160\157\163\x74\137\x75\x70\x64\x61\164\x65\137\x75\163\x65\x72\x5f\x75\156\x73\x75\x63\x63\145\x73\x73\x66\x75\x6c"]); goto oilcm; oilcm: $this->set_error("\x75\160\x64\x61\x74\145\x5f\x75\x6e\x73\x75\x63\x63\x65\x73\x73\x66\165\154"); goto G2ku_; G2ku_: return FALSE; goto i6aKg; n4Ri7: $this->trigger_events(["\x70\x6f\163\x74\137\x75\x70\144\x61\x74\145\x5f\165\163\145\162", "\160\157\x73\x74\x5f\x75\160\144\x61\164\x65\x5f\x75\x73\x65\162\x5f\x75\x6e\x73\165\x63\143\x65\x73\163\x66\x75\154"]); goto HvfvK; TbjBR: $this->set_message("\x75\x70\144\141\164\x65\137\163\165\143\143\145\x73\163\146\x75\154"); goto P3cTM; uoGbL: $this->trigger_events(["\x70\x6f\163\x74\137\165\160\144\141\x74\145\x5f\165\x73\145\162", "\160\x6f\163\x74\x5f\165\160\144\141\164\145\137\165\163\x65\162\137\x75\x6e\x73\165\x63\143\x65\163\x73\x66\x75\154"]); goto Y0mKn; uEKVi: $this->db->trans_rollback(); goto lqUYn; a_JNp: if (!($data["\x70\141\163\x73\x77\157\x72\x64"] === FALSE)) { goto q0ApU; } goto OEXWa; Fllvd: xuzHH: goto YGNVQ; tko18: return FALSE; goto AaDcg; BtGEu: $this->trigger_events("\160\162\145\x5f\x75\160\x64\141\x74\145\137\x75\163\145\162"); goto ZwaBb; v9Kba: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto CJj17; } goto uEKVi; OEXWa: $this->db->trans_rollback(); goto uoGbL; t1nHu: CWuLM: goto K0kDT; HvfvK: $this->set_error("\165\x70\144\x61\164\145\x5f\x75\x6e\163\x75\x63\x63\x65\x73\163\x66\x75\154"); goto CR1AP; HTTTh: } public function delete_user($id) { goto HVYsS; L7d8M: $this->db->trans_rollback(); goto i8Ys0; RmjVD: $this->trigger_events(["\160\x6f\163\164\137\x64\145\x6c\145\164\x65\137\x75\163\145\x72", "\x70\157\163\x74\137\144\x65\x6c\145\164\145\137\x75\x73\145\x72\x5f\163\165\143\143\x65\x73\163\x66\x75\154"]); goto L9g_8; osmNO: cP3Fm: goto QxzYj; CGKO7: $this->db->delete($this->tables["\165\x73\x65\162\x73"], ["\x69\144" => $id]); goto XhzZD; foeto: $this->db->trans_begin(); goto fTGh9; fTGh9: $this->remove_from_group(NULL, $id); goto CGKO7; HVYsS: $this->trigger_events("\x70\x72\145\137\144\x65\x6c\x65\x74\145\x5f\x75\163\x65\162"); goto foeto; QxzYj: $this->db->trans_commit(); goto RmjVD; akEFm: $this->set_error("\x64\x65\154\x65\164\145\137\x75\156\163\x75\x63\x63\145\x73\x73\x66\165\x6c"); goto VosWx; VosWx: return FALSE; goto osmNO; L9g_8: $this->set_message("\144\145\154\x65\164\x65\137\163\x75\x63\x63\145\163\163\146\165\154"); goto qMT8o; i8Ys0: $this->trigger_events(["\x70\x6f\163\x74\x5f\144\x65\154\145\164\145\x5f\165\x73\x65\162", "\x70\157\163\x74\137\144\145\x6c\145\x74\145\137\165\163\x65\162\137\x75\x6e\x73\165\143\x63\x65\163\x73\x66\165\x6c"]); goto akEFm; qMT8o: return TRUE; goto s35xD; XhzZD: if (!($this->db->trans_status() === FALSE)) { goto cP3Fm; } goto L7d8M; s35xD: } public function update_last_login($id) { goto ymgIz; TnClx: return $this->db->affected_rows() == 1; goto lzRiC; rlvf5: $this->db->update($this->tables["\x75\x73\145\x72\163"], ["\154\141\x73\x74\137\154\157\x67\151\156" => time()], ["\151\x64" => $id]); goto TnClx; bvDHc: $this->load->helper("\x64\x61\164\145"); goto urPqt; urPqt: $this->trigger_events("\145\170\164\x72\141\137\167\150\145\x72\x65"); goto rlvf5; ymgIz: $this->trigger_events("\165\160\144\141\164\145\137\x6c\x61\163\164\x5f\154\157\147\151\156"); goto bvDHc; lzRiC: } public function set_lang($lang = "\145\156") { goto INLyl; r0gFh: set_cookie(["\156\x61\x6d\145" => "\154\x61\156\x67\137\143\x6f\x64\x65", "\x76\141\154\x75\x65" => $lang, "\145\170\160\151\x72\145" => $expire]); goto asZgJ; poB7a: $expire = $this->config->item("\x75\x73\x65\x72\137\145\170\x70\151\x72\145", "\x69\157\x6e\137\x61\165\164\150"); goto ocGrZ; WZcOb: $expire = self::MAX_COOKIE_LIFETIME; goto ofKQS; asZgJ: return TRUE; goto KA1Is; OzHvw: u7SCx: goto WZcOb; ocGrZ: goto gx5R6; goto OzHvw; ofKQS: gx5R6: goto r0gFh; INLyl: $this->trigger_events("\x73\145\x74\137\x6c\x61\x6e\147"); goto n9esa; n9esa: if ($this->config->item("\165\163\x65\x72\x5f\145\170\160\x69\x72\x65", "\151\157\156\x5f\141\x75\164\150") === 0) { goto u7SCx; } goto poB7a; KA1Is: } public function set_session($user) { goto iuiYQ; Ic7GE: $this->session->set_userdata($session_data); goto w6IcI; Knfnp: return TRUE; goto dYigd; PlOcq: $session_data = ["\151\x64\x65\156\x74\x69\164\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\141\151\154" => $user->email, "\165\163\145\162\137\151\144" => $user->id, "\157\154\x64\x5f\x6c\x61\x73\x74\x5f\x6c\157\147\x69\x6e" => $user->last_login, "\154\x61\x73\164\x5f\143\150\145\x63\153" => time()]; goto Ic7GE; w6IcI: $this->trigger_events("\160\157\163\x74\x5f\x73\145\164\137\x73\x65\x73\x73\151\157\156"); goto Knfnp; iuiYQ: $this->trigger_events("\160\x72\145\137\x73\x65\164\x5f\x73\x65\163\163\151\x6f\156"); goto PlOcq; dYigd: } public function remember_user($identity) { goto KnelO; Kip3n: if (!$token->validator_hashed) { goto o1nZQ; } goto rDdXw; WxV3B: if ($this->config->item("\165\x73\x65\x72\137\x65\x78\x70\x69\162\x65", "\x69\157\x6e\x5f\141\x75\164\150") === 0) { goto GegwK; } goto EgB2u; v0kS0: $this->trigger_events(["\160\157\163\164\137\162\x65\155\145\x6d\142\145\x72\137\165\163\x65\162", "\x72\145\x6d\x65\155\x62\x65\x72\x5f\x75\x73\145\162\137\x75\156\x73\x75\x63\143\145\163\x73\146\x75\x6c"]); goto tuV3J; TFG17: z3yVv: goto Ny8Cl; geLow: GegwK: goto zEWQr; Ny8Cl: o1nZQ: goto v0kS0; xuzZ0: $token = $this->_generate_selector_validator_couple(); goto Kip3n; bGhT8: $this->trigger_events(["\x70\157\x73\164\x5f\162\x65\x6d\x65\155\142\145\x72\137\165\x73\x65\162", "\x72\x65\155\x65\155\x62\145\x72\137\165\x73\x65\162\x5f\163\x75\143\x63\145\x73\163\x66\165\154"]); goto vhxoL; zEWQr: $expire = self::MAX_COOKIE_LIFETIME; goto LBeQW; LBeQW: N0_Td: goto qVR2u; vhxoL: return TRUE; goto TFG17; ZBeBe: goto N0_Td; goto geLow; KnelO: $this->trigger_events("\x70\x72\x65\x5f\162\145\x6d\145\155\x62\145\x72\137\165\163\x65\162"); goto MYFRR; rDdXw: $this->db->update($this->tables["\x75\x73\145\x72\163"], ["\x72\145\x6d\x65\x6d\x62\145\162\137\x73\x65\x6c\x65\x63\164\157\x72" => $token->selector, "\x72\x65\x6d\x65\x6d\142\145\162\137\x63\157\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto XJdoz; qVR2u: set_cookie(["\x6e\x61\x6d\x65" => $this->config->item("\162\145\155\x65\155\x62\x65\162\x5f\x63\157\x6f\153\x69\x65\x5f\x6e\x61\x6d\145", "\151\157\x6e\137\141\x75\x74\x68"), "\x76\x61\154\165\145" => $token->user_code, "\145\x78\x70\151\x72\x65" => $expire]); goto bGhT8; tuV3J: return FALSE; goto m2dIH; EgB2u: $expire = $this->config->item("\165\163\145\x72\137\x65\x78\x70\151\162\x65", "\x69\x6f\156\137\141\165\164\x68"); goto ZBeBe; XJdoz: if (!($this->db->affected_rows() > -1)) { goto z3yVv; } goto WxV3B; gTjMV: iH6GT: goto xuzZ0; vH2Ly: return FALSE; goto gTjMV; MYFRR: if ($identity) { goto iH6GT; } goto vH2Ly; m2dIH: } public function login_remembered_user() { goto NtNRx; UxINK: if (!$this->config->item("\165\x73\x65\162\137\x65\170\x74\145\x6e\144\137\157\x6e\x5f\154\x6f\x67\151\156", "\151\157\156\x5f\x61\x75\164\150")) { goto metB0; } goto EnRtv; zcet7: delete_cookie($this->config->item("\x72\145\x6d\145\x6d\x62\145\162\137\143\157\157\x6b\151\145\137\156\141\x6d\x65", "\151\x6f\156\137\141\x75\164\150")); goto kB2Sw; ASMLw: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto tWB8H; Q0hNd: $remember_cookie = get_cookie($this->config->item("\x72\145\x6d\145\x6d\142\x65\x72\137\143\x6f\x6f\x6b\151\x65\x5f\156\x61\155\x65", "\151\157\156\x5f\x61\x75\x74\150")); goto ASMLw; IG4NN: $this->trigger_events(["\x70\x6f\163\x74\x5f\154\x6f\147\x69\x6e\x5f\162\145\x6d\145\155\x62\x65\x72\145\x64\x5f\165\x73\145\162", "\160\157\x73\164\x5f\154\157\147\151\156\x5f\x72\x65\x6d\145\x6d\x62\x65\162\145\144\137\x75\163\145\162\x5f\x75\156\163\x75\x63\143\145\163\x73\x66\x75\154"]); goto TLiDs; aAk08: $query = $this->db->select($this->identity_column . "\x2c\x20\x69\x64\x2c\40\145\x6d\x61\151\154\54\40\162\x65\x6d\145\155\x62\x65\162\137\143\157\x64\x65\54\x20\x6c\141\163\164\x5f\154\157\x67\x69\x6e")->where("\x72\x65\x6d\145\155\x62\145\x72\137\163\x65\x6c\x65\143\164\157\x72", $token->selector)->where("\x61\143\164\x69\x76\x65", 1)->limit(1)->get($this->tables["\165\x73\x65\x72\163"]); goto RktaQ; XqfOX: $user = $query->row(); goto ye6a7; kB2Sw: $this->trigger_events(["\160\157\163\164\x5f\x6c\157\147\x69\156\x5f\x72\145\155\x65\x6d\x62\x65\x72\145\x64\x5f\x75\x73\145\x72", "\160\157\163\x74\137\x6c\x6f\x67\x69\x6e\137\x72\145\x6d\x65\155\x62\x65\162\x65\144\137\x75\x73\x65\162\137\x75\x6e\163\165\143\143\x65\x73\x73\x66\x75\154"]); goto bMOqL; TTbty: $this->set_session($user); goto PrHIT; XgJCK: t07uN: goto z4whb; RktaQ: if (!($query->num_rows() === 1)) { goto NIMQg; } goto XqfOX; NtNRx: $this->trigger_events("\160\x72\145\x5f\154\x6f\147\151\156\x5f\x72\145\155\x65\x6d\142\145\162\x65\144\137\165\x73\x65\x72"); goto Q0hNd; PrHIT: $this->clear_forgotten_password_code($identity); goto UxINK; zG5WG: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto pLLJ0; } goto Ra4VE; EnRtv: $this->remember_user($identity); goto rXIqx; ye6a7: $identity = $user->{$this->identity_column}; goto zG5WG; Ra4VE: $this->update_last_login($user->id); goto TTbty; z4whb: $this->trigger_events("\145\x78\x74\162\x61\x5f\167\150\x65\x72\145"); goto aAk08; lH9l2: $this->trigger_events(["\160\x6f\163\x74\x5f\154\x6f\x67\151\156\x5f\162\145\155\x65\155\142\145\x72\145\x64\137\165\163\145\x72", "\x70\157\x73\x74\x5f\x6c\157\147\x69\156\137\162\145\x6d\145\x6d\x62\x65\162\145\144\137\165\163\145\162\x5f\x73\x75\x63\x63\x65\163\x73\146\x75\154"]); goto td7X2; rXIqx: metB0: goto QXlFT; tWB8H: if (!($token === FALSE)) { goto t07uN; } goto IG4NN; td7X2: return TRUE; goto lWbmC; QXlFT: $this->session->sess_regenerate(FALSE); goto lH9l2; bMOqL: return FALSE; goto Q7qi4; TLiDs: return FALSE; goto XgJCK; pZOhG: NIMQg: goto zcet7; lWbmC: pLLJ0: goto pZOhG; Q7qi4: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto aXj0W; WrB3N: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\165\x70\x73"], ["\156\141\155\x65" => $group_name])->num_rows(); goto lkh_D; hnuS_: if (empty($additional_data)) { goto WVhO9; } goto t0Dxi; gc5Jf: WVhO9: goto VpUg3; LHaSM: $group_id = $this->db->insert_id($this->tables["\x67\x72\x6f\x75\160\163"] . "\x5f\x69\144\137\163\145\x71"); goto Zoeqp; RawQJ: $this->db->insert($this->tables["\147\162\x6f\165\160\163"], $data); goto LHaSM; DhsMI: $this->set_error("\x67\162\157\165\160\137\x61\154\x72\145\141\x64\171\137\145\x78\x69\163\164\163"); goto ieQVW; VpUg3: $this->trigger_events("\145\170\164\162\141\137\x67\x72\157\x75\x70\x5f\163\x65\x74"); goto RawQJ; ieQVW: return FALSE; goto vuU2r; IDw1R: $data = ["\156\141\x6d\145" => $group_name, "\144\x65\x73\143\162\x69\160\164\151\157\x6e" => $group_description]; goto hnuS_; lkh_D: if (!($existing_group !== 0)) { goto JSfvL; } goto DhsMI; t0Dxi: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\x75\x70\163"], $additional_data), $data); goto gc5Jf; vuU2r: JSfvL: goto IDw1R; aXj0W: if ($group_name) { goto epo_6; } goto oPT3N; UZfh3: return $group_id; goto j9XYi; Zoeqp: $this->set_message("\147\162\157\x75\x70\137\143\x72\x65\x61\x74\x69\x6f\x6e\137\x73\x75\x63\143\145\163\163\x66\x75\154"); goto UZfh3; umo12: epo_6: goto WrB3N; b61ly: return FALSE; goto umo12; oPT3N: $this->set_error("\x67\x72\x6f\165\x70\137\156\x61\155\145\137\162\x65\161\165\151\x72\x65\x64"); goto b61ly; j9XYi: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto ckfDE; Ywz4i: return FALSE; goto oVA8V; FrInE: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto RFVik; } goto H8v1d; wkeav: return TRUE; goto bhvyi; VWhM6: return FALSE; goto h_OkL; Fy7NN: uIk0H: goto y3NZc; h_OkL: N8FE_: goto OqgL1; FCYB1: dVhBA: goto h1v1J; h1v1J: $this->db->update($this->tables["\147\162\x6f\165\x70\x73"], $data, ["\x69\x64" => $group_id]); goto uyTRP; OqgL1: if (empty($additional_data)) { goto dVhBA; } goto ab_os; hzA1q: if (!($this->config->item("\x61\x64\x6d\151\156\x5f\x67\162\x6f\x75\x70", "\x69\157\156\137\141\165\164\x68") === $group->name && $group_name !== $group->name)) { goto N8FE_; } goto ulSb2; eSgoT: $data["\156\x61\155\145"] = $group_name; goto ASdzU; Gm8Nw: return FALSE; goto Fy7NN; uyTRP: $this->set_message("\147\162\x6f\x75\160\x5f\165\160\x64\141\x74\145\137\x73\x75\143\x63\145\163\163\146\165\x6c"); goto wkeav; ab_os: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\165\160\163"], $additional_data), $data); goto FCYB1; ASdzU: TVYgv: goto IkOlq; J8IFF: $existing_group = $this->db->get_where($this->tables["\147\x72\157\165\160\x73"], ["\156\x61\x6d\x65" => $group_name])->row(); goto FrInE; oVA8V: RFVik: goto eSgoT; zth1x: if (empty($group_name)) { goto TVYgv; } goto J8IFF; y3NZc: $data = []; goto zth1x; ulSb2: $this->set_error("\147\162\x6f\x75\160\137\x6e\141\155\145\x5f\141\144\155\151\x6e\137\x6e\157\x74\x5f\141\x6c\164\145\x72"); goto VWhM6; IkOlq: $group = $this->db->get_where($this->tables["\147\162\x6f\165\x70\163"], ["\151\144" => $group_id])->row(); goto hzA1q; H8v1d: $this->set_error("\x67\x72\x6f\x75\160\137\141\154\162\145\141\144\171\x5f\145\x78\151\163\164\x73"); goto Ywz4i; ckfDE: if (!empty($group_id)) { goto uIk0H; } goto Gm8Nw; bhvyi: } public function delete_group($group_id = FALSE) { goto fT1lL; arrbH: $this->db->trans_rollback(); goto e6GsU; MnYwO: if (!($this->db->trans_status() === FALSE)) { goto ZG_dF; } goto arrbH; fT1lL: if (!(!$group_id || empty($group_id))) { goto RFPrw; } goto g_p4s; qZRmN: $this->db->trans_commit(); goto G8p4b; JY89B: clXQk: goto FdvyO; ZYNi_: return TRUE; goto Uxnh1; cFk2W: $this->trigger_events(["\160\x6f\163\x74\137\x64\145\154\x65\164\145\x5f\x67\162\157\x75\160", "\160\x6f\163\164\137\x64\145\154\145\x74\x65\x5f\x67\x72\157\165\x70\x5f\x6e\x6f\164\x61\154\x6c\x6f\167\145\144"]); goto Xc7b4; e6GsU: $this->trigger_events(["\160\x6f\163\x74\137\144\x65\x6c\x65\164\x65\137\147\x72\157\x75\160", "\x70\157\x73\164\x5f\x64\x65\x6c\145\x74\x65\137\x67\x72\x6f\165\160\137\x75\156\x73\165\143\x63\145\x73\163\146\x75\154"]); goto PdzVu; UAdVY: $this->db->trans_begin(); goto ZkA1K; ZlJfX: $group = $this->group($group_id)->row(); goto o9FWq; hZZIq: RFPrw: goto ZlJfX; o9FWq: if (!($group->name == $this->config->item("\141\144\155\151\x6e\x5f\147\x72\x6f\x75\160", "\x69\x6f\156\137\141\165\164\x68"))) { goto clXQk; } goto cFk2W; Xc7b4: $this->set_error("\x67\x72\157\x75\x70\137\144\x65\154\145\164\145\x5f\x6e\x6f\164\141\154\x6c\x6f\167\x65\144"); goto EeEIS; FdvyO: $this->trigger_events("\x70\162\145\x5f\144\x65\x6c\x65\164\x65\137\147\162\x6f\165\x70"); goto UAdVY; kk2Cj: $this->set_message("\x67\162\157\165\160\x5f\144\x65\154\x65\164\145\137\x73\165\143\143\x65\x73\x73\146\x75\x6c"); goto ZYNi_; G8p4b: $this->trigger_events(["\160\157\x73\164\x5f\144\145\154\x65\x74\x65\137\147\x72\157\x75\x70", "\160\x6f\x73\x74\137\144\x65\x6c\x65\x74\145\137\x67\162\x6f\165\x70\x5f\x73\x75\143\x63\145\x73\163\146\165\x6c"]); goto kk2Cj; yX0lu: return FALSE; goto GErQG; g_p4s: return FALSE; goto hZZIq; ZkA1K: $this->db->delete($this->tables["\165\163\x65\x72\163\137\147\162\x6f\x75\x70\163"], [$this->join["\147\162\157\x75\160\x73"] => $group_id]); goto XJuic; GErQG: ZG_dF: goto qZRmN; XJuic: $this->db->delete($this->tables["\x67\162\x6f\165\x70\163"], ["\151\x64" => $group_id]); goto MnYwO; EeEIS: return FALSE; goto JY89B; PdzVu: $this->set_error("\x67\162\x6f\x75\160\x5f\x64\x65\x6c\145\164\145\x5f\x75\x6e\x73\165\143\143\x65\x73\163\x66\165\x6c"); goto yX0lu; Uxnh1: } public function set_hook($event, $name, $class, $method, $arguments) { goto MgEAx; vZ5Uh: $this->_ion_hooks->{$event}[$name]->method = $method; goto YKZ1P; YKZ1P: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto InNvm; bgbq0: $this->_ion_hooks->{$event}[$name]->class = $class; goto vZ5Uh; MgEAx: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto bgbq0; InNvm: } public function remove_hook($event, $name) { goto Nc4x4; Nc4x4: if (!isset($this->_ion_hooks->{$event}[$name])) { goto vAIpf; } goto cyKF3; cyKF3: unset($this->_ion_hooks->{$event}[$name]); goto G_v7d; G_v7d: vAIpf: goto UdukN; UdukN: } public function remove_hooks($event) { goto s3H2L; cIYkq: v1ZnJ: goto c6APF; s3H2L: if (!isset($this->_ion_hooks->{$event})) { goto v1ZnJ; } goto mlyFt; mlyFt: unset($this->_ion_hooks->{$event}); goto cIYkq; c6APF: } protected function _call_hook($event, $name) { goto j_g98; Q0TsT: cv3Ro: goto IWDzO; IWDzO: return FALSE; goto GTKfS; G3v2g: $hook = $this->_ion_hooks->{$event}[$name]; goto jSfV5; jSfV5: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto Q0TsT; j_g98: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto cv3Ro; } goto G3v2g; GTKfS: } public function trigger_events($events) { goto e3muK; O4HHa: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); S2TXP: } goto CGYaO; ewep8: UQJSv: goto m3Ix0; CGYaO: m9WTe: goto k2lXH; wRGlV: goto knA_Z; goto ewep8; v63XZ: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto FFd0T; } goto O4HHa; m3Ix0: foreach ($events as $event) { $this->trigger_events($event); p9lmg: } goto AeRSn; k2lXH: FFd0T: goto wRGlV; AeRSn: CjwPm: goto pwauE; pwauE: knA_Z: goto YFLMo; e3muK: if (is_array($events) && !empty($events)) { goto UQJSv; } goto v63XZ; YFLMo: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto hCNLN; owvrC: return TRUE; goto WilNM; iZbal: $this->message_end_delimiter = $end_delimiter; goto owvrC; hCNLN: $this->message_start_delimiter = $start_delimiter; goto iZbal; WilNM: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto x4xDq; x4xDq: $this->error_start_delimiter = $start_delimiter; goto oHEy1; uyJiW: return TRUE; goto goThC; oHEy1: $this->error_end_delimiter = $end_delimiter; goto uyJiW; goThC: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto PID18; tW80L: SPiv7: goto kh3pt; PID18: $_output = ''; goto jRWEh; kh3pt: return $_output; goto FwU3z; jRWEh: foreach ($this->messages as $message) { goto dDgW4; PupSI: HSmo5: goto S7z7A; dDgW4: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\43\43"; goto PhiHb; PhiHb: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto PupSI; S7z7A: } goto tW80L; FwU3z: } public function messages_array($langify = TRUE) { goto oN0Mj; U_zEX: $_output = []; goto OoSFX; KfpTQ: GrHW0: goto Zr9oX; OoSFX: foreach ($this->messages as $message) { goto EQX63; RAABq: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto fLo7W; fLo7W: A_DDT: goto koz8a; EQX63: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\43" . $message . "\x23\x23"; goto RAABq; koz8a: } goto P54vB; E60xH: return $this->messages; goto W5nGd; W5nGd: goto GrHW0; goto JBKQc; P54vB: x74N7: goto s1CEp; s1CEp: return $_output; goto KfpTQ; oN0Mj: if ($langify) { goto B_An_; } goto E60xH; JBKQc: B_An_: goto U_zEX; Zr9oX: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto HnZqL; HnZqL: $_output = ''; goto Ji5uS; VCxN0: Ei3e3: goto hEeCE; Ji5uS: foreach ($this->errors as $error) { goto StML4; NxyMg: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto ZslpC; ZslpC: rKf5Y: goto U_NCq; StML4: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\x23\x23"; goto NxyMg; U_NCq: } goto VCxN0; hEeCE: return $_output; goto BM5Nx; BM5Nx: } public function errors_array($langify = TRUE) { goto aizde; fsHWT: E0oMv: goto lvJ9n; BE9sv: goto nFRUW; goto l3oZR; lvJ9n: return $_output; goto Y7iDx; BAGmJ: foreach ($this->errors as $error) { goto Qg0pX; Zv16Z: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto NMW_N; Qg0pX: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\x23\43"; goto Zv16Z; NMW_N: IzFQT: goto LtNI7; LtNI7: } goto fsHWT; hwZVB: return $this->errors; goto BE9sv; l3oZR: d9tE3: goto QYd_P; QYd_P: $_output = []; goto BAGmJ; aizde: if ($langify) { goto d9tE3; } goto hwZVB; Y7iDx: nFRUW: goto swovj; swovj: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto vqgVL; ylUl4: $this->trigger_events("\x65\170\164\162\141\x5f\x77\x68\145\162\x65"); goto lCjWr; lCjWr: $this->db->update($this->tables["\165\163\145\162\163"], $data, [$this->identity_column => $identity]); goto ZooMA; LCfof: $data = ["\160\x61\x73\163\x77\157\162\144" => $hash, "\x72\x65\155\145\155\x62\x65\x72\137\x63\x6f\x64\145" => NULL, "\146\157\x72\147\x6f\164\x74\145\x6e\137\160\141\163\x73\167\x6f\x72\144\137\x63\157\144\x65" => NULL, "\x66\157\x72\147\x6f\164\164\x65\156\x5f\x70\141\163\x73\167\x6f\x72\x64\137\x74\151\x6d\x65" => NULL]; goto ylUl4; ZooMA: return $this->db->affected_rows() == 1; goto BS0Pp; jgF0I: D8H35: goto LCfof; vqgVL: $hash = $this->hash_password($password, $identity); goto i2y5I; r9bkB: return FALSE; goto jgF0I; i2y5I: if (!($hash === FALSE)) { goto D8H35; } goto r9bkB; BS0Pp: } protected function _filter_data($table, $data) { goto y36yW; WI8yX: CnNO5: goto j_8er; y36yW: $filtered_data = []; goto LphNK; fHZAQ: FdUaa: goto WI8yX; j_8er: return $filtered_data; goto Cs06Q; jhsi4: foreach ($columns as $column) { goto b3zdI; iugAC: $filtered_data[$column] = $data[$column]; goto iRlIr; iRlIr: AfcQK: goto gm1U1; gm1U1: iO2zO: goto Yit3k; b3zdI: if (!array_key_exists($column, $data)) { goto AfcQK; } goto iugAC; Yit3k: } goto fHZAQ; gkIFF: if (!is_array($data)) { goto CnNO5; } goto jhsi4; LphNK: $columns = $this->db->list_fields($table); goto gkIFF; Cs06Q: } protected function _random_token($result_length = 32) { goto Gnq9w; SwBE2: return bin2hex(random_bytes($result_length / 2)); goto OL1FV; sqixJ: if (!function_exists("\x72\141\156\144\157\x6d\137\142\171\164\145\163")) { goto yDSCa; } goto SwBE2; nlKg7: return FALSE; goto l3tUT; LfJc3: if (!function_exists("\x6f\x70\145\156\163\x73\154\137\x72\x61\x6e\144\157\155\x5f\160\163\145\x75\144\x6f\137\x62\171\164\x65\163")) { goto ukRJb; } goto W5XvW; Gnq9w: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto ytVzm; } goto p9caU; p9caU: $result_length = 32; goto Eupfn; W5XvW: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto TEMu6; TEMu6: ukRJb: goto nlKg7; tAD7a: if (!function_exists("\155\143\162\x79\x70\x74\x5f\x63\x72\x65\x61\164\x65\x5f\x69\166")) { goto tmF8J; } goto YxtbD; YxtbD: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto iSri4; Eupfn: ytVzm: goto sqixJ; OL1FV: yDSCa: goto tAD7a; iSri4: tmF8J: goto LfJc3; l3tUT: } protected function _get_hash_parameters($identity = NULL) { goto bMSgx; eCNY4: q062R: goto ylxyE; sd43H: $params = FALSE; goto jj1u1; osHNF: return $params; goto YyaBa; NfHdm: $user_id = $this->get_user_id_from_identity($identity); goto zA5G1; ajj07: rminH: goto osHNF; ylxyE: fUcLB: goto sd43H; zA5G1: if (!($user_id && $this->in_group($this->config->item("\x61\144\155\151\156\x5f\147\x72\157\x75\x70", "\x69\157\156\x5f\x61\165\x74\150"), $user_id))) { goto q062R; } goto y7EaD; M2BYo: if (!$identity) { goto fUcLB; } goto NfHdm; y7EaD: $is_admin = TRUE; goto eCNY4; jj1u1: switch ($this->hash_method) { case "\142\x63\162\171\160\164": $params = ["\x63\157\163\164" => $is_admin ? $this->config->item("\x62\x63\x72\171\160\164\137\x61\144\x6d\151\x6e\x5f\143\157\163\164", "\151\157\156\x5f\141\x75\164\x68") : $this->config->item("\x62\143\162\171\x70\164\137\x64\145\146\x61\165\x6c\x74\137\x63\x6f\163\x74", "\x69\157\x6e\x5f\141\165\x74\150")]; goto rminH; case "\x61\x72\x67\x6f\156\62": $params = $is_admin ? $this->config->item("\141\x72\147\x6f\156\x32\137\141\144\x6d\151\x6e\137\x70\x61\x72\x61\x6d\163", "\x69\157\156\x5f\x61\x75\x74\x68") : $this->config->item("\x61\x72\x67\x6f\156\62\137\x64\145\146\141\x75\x6c\x74\x5f\x70\141\162\141\155\x73", "\x69\x6f\x6e\137\141\165\x74\x68"); goto rminH; default: } goto NXZzp; NXZzp: guPT0: goto ajj07; bMSgx: $is_admin = FALSE; goto M2BYo; YyaBa: } protected function _get_hash_algo() { goto WeSgK; d6opE: return $algo; goto zwNCn; yJC9r: dgrc5: goto eMMfM; fYK6K: switch ($this->hash_method) { case "\x62\x63\162\171\x70\164": $algo = PASSWORD_BCRYPT; goto nUSo0; case "\x61\x72\147\x6f\156\x32": $algo = PASSWORD_ARGON2I; goto nUSo0; default: } goto yJC9r; eMMfM: nUSo0: goto d6opE; WeSgK: $algo = FALSE; goto fYK6K; zwNCn: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto rqkbg; eWGib: $validator = $this->_random_token($validator_size); goto TfQbW; PXXrp: return (object) ["\x73\145\154\145\143\164\157\x72" => $selector, "\x76\141\x6c\x69\x64\x61\164\x6f\162\x5f\150\141\x73\x68\145\144" => $validator_hashed, "\x75\163\145\162\137\143\157\144\x65" => $user_code]; goto BFxnn; r57cb: $user_code = "{$selector}\56{$validator}"; goto PXXrp; TfQbW: $validator_hashed = $this->hash_password($validator); goto r57cb; rqkbg: $selector = $this->_random_token($selector_size); goto eWGib; BFxnn: } protected function _retrieve_selector_validator_couple($user_code) { goto JDroH; B4Zbs: nKwD3: goto Evyg_; s3dT9: return FALSE; goto nP_UB; BuemF: if (!(count($tokens) === 2)) { goto nKwD3; } goto cX7lx; pYuC4: $tokens = explode("\56", $user_code); goto BuemF; Evyg_: Zcs3b: goto s3dT9; JDroH: if (!$user_code) { goto Zcs3b; } goto pYuC4; cX7lx: return (object) ["\163\x65\154\145\x63\x74\157\x72" => $tokens[0], "\x76\141\154\151\144\x61\x74\x6f\x72" => $tokens[1]]; goto B4Zbs; nP_UB: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto grFMV; d2wwC: WgYlh: goto LG_F4; Nje0K: goto oz5NX; goto Nk4R5; CKv0J: $hashed_password = sha1($password . $salt_db->salt); goto leMRh; J9Ak9: return $result; goto hPb8U; VtBT5: return FALSE; goto HPRzi; AZUB4: goto i0yYF; goto Qm5n4; leMRh: yTr9l: goto ZhCSZ; v5xGm: if (!($query->num_rows() !== 1)) { goto KRVSQ; } goto gdlGF; wSG8R: $salt_db = $query->row(); goto v5xGm; Ug2Gk: return FALSE; goto Nje0K; ncKyV: $this->trigger_events(["\x70\157\163\164\x5f\163\x68\x61\x31\x5f\160\141\x73\163\167\x6f\162\144\x5f\155\x69\147\x72\x61\164\151\x6f\156", "\160\x6f\163\164\137\x73\x68\141\61\x5f\x70\141\x73\163\x77\x6f\x72\x64\137\155\x69\x67\162\x61\x74\151\x6f\x6e\137\x75\156\x73\x75\143\x63\x65\x73\x73\146\165\154"]); goto VtBT5; nXYgc: if ($this->config->item("\163\x74\157\x72\145\137\163\x61\154\164", "\151\x6f\x6e\x5f\x61\165\x74\x68")) { goto WgYlh; } goto e5Cpu; hPb8U: oz5NX: goto p3H8e; DXUQ0: $this->trigger_events(["\160\157\x73\x74\137\163\x68\x61\61\137\x70\141\x73\x73\x77\157\x72\x64\137\x6d\x69\147\x72\141\164\151\x6f\x6e", "\x70\x6f\x73\x74\137\x73\150\x61\x31\137\x70\141\x73\163\167\157\x72\144\x5f\x6d\151\147\162\x61\164\151\157\x6e\x5f\163\x75\143\143\x65\x73\x73\x66\165\x6c"]); goto MtRGs; Nk4R5: T0qdU: goto EQgBu; DCaGM: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto EeZSJ; ZhCSZ: if ($hashed_password === $hashed_password_db) { goto T0qdU; } goto dszQK; HPRzi: f0T1N: goto i2JSM; EeZSJ: goto yTr9l; goto d2wwC; biAE1: if ($salt_length) { goto f0T1N; } goto ncKyV; LG_F4: $query = $this->db->select("\163\x61\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\145\x72\163"]); goto wSG8R; dszQK: $this->trigger_events(["\160\157\163\x74\x5f\x73\150\x61\61\x5f\160\141\x73\163\x77\x6f\x72\x64\137\155\151\x67\x72\x61\164\151\x6f\156", "\160\157\x73\164\x5f\163\150\141\61\137\160\x61\x73\x73\x77\157\162\x64\137\155\x69\147\162\141\164\151\x6f\x6e\x5f\165\156\163\x75\x63\x63\x65\x73\x73\146\x75\154"]); goto Ug2Gk; zb3Cd: $this->trigger_events(["\160\x6f\163\164\137\163\x68\x61\61\x5f\160\141\163\x73\x77\157\x72\x64\137\155\151\x67\162\x61\x74\x69\x6f\x6e", "\x70\157\163\164\x5f\x73\x68\141\61\137\160\x61\163\163\x77\157\162\144\137\155\151\x67\162\141\x74\151\x6f\156\x5f\165\x6e\x73\x75\143\143\145\163\x73\146\165\154"]); goto AZUB4; EQgBu: $result = $this->_set_password_db($identity, $password); goto lZvBe; i2JSM: $salt = substr($hashed_password_db, 0, $salt_length); goto DCaGM; grFMV: $this->trigger_events("\160\x72\145\x5f\x73\x68\x61\61\137\160\x61\x73\x73\x77\157\x72\x64\137\155\151\147\162\x61\164\x69\157\x6e"); goto nXYgc; lZvBe: if ($result) { goto xlbRR; } goto zb3Cd; MtRGs: i0yYF: goto J9Ak9; JDlrQ: return FALSE; goto vAJeg; vAJeg: KRVSQ: goto CKv0J; e5Cpu: $salt_length = $this->config->item("\163\x61\154\164\x5f\154\145\156\147\164\x68", "\151\157\156\137\x61\165\x74\x68"); goto biAE1; Qm5n4: xlbRR: goto DXUQ0; gdlGF: $this->trigger_events(["\160\x6f\x73\164\137\163\150\x61\x31\x5f\160\x61\163\163\x77\x6f\x72\x64\137\155\151\x67\x72\x61\164\x69\157\156", "\160\157\x73\x74\x5f\163\150\x61\61\x5f\x70\141\163\163\167\157\162\x64\x5f\x6d\151\147\x72\x61\164\x69\x6f\156\137\165\156\x73\x75\143\x63\x65\x73\163\146\165\x6c"]); goto JDlrQ; p3H8e: } }
