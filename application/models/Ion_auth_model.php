<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\x45\120\101\124\110") or exit("\116\157\x20\x64\x69\162\145\x63\164\40\163\x63\x72\x69\160\x74\x20\x61\143\143\x65\163\x73\x20\141\154\x6c\x6f\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto ZeIg4; V5QwQ: $this->message_end_delimiter = $this->error_end_delimiter; goto wXpHG; U6Is6: $error_prefix = $form_validation_class->getProperty("\137\145\x72\x72\x6f\162\x5f\x70\x72\x65\x66\x69\x78"); goto DAQ8Q; M1h4i: goto q2woA; goto vkW6g; tH2vr: if (empty($group_name)) { goto j5Emk; } goto tmhxo; k0dKG: $this->_ion_hooks = new stdClass(); goto vInGf; QUlZT: $error_suffix = $form_validation_class->getProperty("\x5f\145\x72\162\157\162\137\163\165\x66\146\x69\x78"); goto KH4el; KwE__: $this->load->library("\146\x6f\162\x6d\x5f\166\141\154\151\x64\x61\164\x69\157\156"); goto PayNr; z2UIn: $this->errors = []; goto XWEnQ; h1jNd: j5Emk: goto OJ7rG; w9hpz: $this->error_start_delimiter = $this->config->item("\x65\162\x72\x6f\162\137\x73\x74\141\162\x74\x5f\144\x65\x6c\151\x6d\x69\x74\x65\x72", "\151\x6f\156\x5f\141\165\x74\x68"); goto zcc6c; pMiHk: $this->message_end_delimiter = $this->config->item("\155\x65\163\x73\141\x67\145\137\145\x6e\x64\137\144\x65\x6c\x69\x6d\151\x74\x65\162", "\151\157\x6e\x5f\x61\x75\x74\x68"); goto w9hpz; oFRCy: goto S4YAr; goto h1jNd; DMRwT: $this->identity_column = $this->config->item("\151\144\145\x6e\164\x69\164\x79", "\x69\157\x6e\x5f\141\x75\164\150"); goto q_USH; tmhxo: $this->db = $this->load->database($group_name, TRUE, TRUE); goto oFRCy; KH4el: $error_suffix->setAccessible(TRUE); goto IZHdl; PayNr: $form_validation_class = new ReflectionClass("\103\x49\137\106\157\x72\155\x5f\166\141\154\x69\144\141\164\x69\x6f\x6e"); goto U6Is6; XWEnQ: $delimiters_source = $this->config->item("\x64\145\154\x69\x6d\x69\164\145\162\x73\x5f\x73\x6f\x75\x72\143\145", "\x69\157\x6e\x5f\x61\x75\x74\150"); goto ju7en; EPmPL: $this->load->helper("\x63\x6f\157\x6b\x69\145"); goto GkotD; IZHdl: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto V5QwQ; cEo_b: S4YAr: goto thU_w; vkW6g: CEO40: goto KwE__; OJ7rG: $CI =& get_instance(); goto TqzP2; EOki6: $this->hash_method = $this->config->item("\x68\x61\163\150\x5f\x6d\145\x74\x68\157\144", "\151\x6f\x6e\x5f\141\165\x74\150"); goto u5IWc; vInGf: $this->trigger_events("\x6d\x6f\x64\x65\x6c\137\143\157\156\x73\164\162\x75\x63\164\157\x72"); goto wfkSD; u5IWc: $this->messages = []; goto z2UIn; L15eN: $this->message_start_delimiter = $this->config->item("\155\145\x73\163\141\x67\145\137\x73\164\x61\162\x74\x5f\144\x65\154\x69\155\x69\164\x65\x72", "\151\157\x6e\137\x61\x75\x74\150"); goto pMiHk; FCx1H: $this->message_start_delimiter = $this->error_start_delimiter; goto QUlZT; GkotD: $this->load->helper("\x64\141\x74\145"); goto Lauxe; Lauxe: $this->lang->load("\x69\x6f\x6e\137\141\165\x74\x68"); goto FSiPu; ju7en: if ($delimiters_source === "\x66\157\x72\x6d\137\x76\x61\x6c\151\144\141\164\151\157\156") { goto CEO40; } goto L15eN; FSiPu: $group_name = $this->config->item("\144\141\x74\141\142\x61\x73\145\137\x67\162\x6f\x75\160\137\x6e\x61\155\x65", "\151\x6f\156\137\x61\x75\x74\x68"); goto tH2vr; thU_w: $this->tables = $this->config->item("\x74\141\x62\154\145\x73", "\151\x6f\156\137\141\165\164\x68"); goto DMRwT; wXpHG: q2woA: goto k0dKG; q_USH: $this->join = $this->config->item("\152\157\151\156", "\x69\x6f\x6e\137\x61\x75\164\x68"); goto EOki6; ZeIg4: $this->config->load("\x69\157\x6e\137\141\x75\x74\150", TRUE); goto EPmPL; zcc6c: $this->error_end_delimiter = $this->config->item("\145\162\x72\157\162\x5f\x65\156\x64\x5f\144\x65\154\151\x6d\151\164\x65\162", "\151\157\156\x5f\x61\x75\164\x68"); goto M1h4i; TqzP2: $this->db = $CI->db; goto cEo_b; Gjc0j: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto FCx1H; DAQ8Q: $error_prefix->setAccessible(TRUE); goto Gjc0j; wfkSD: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto hS3k8; x6apB: $params = $this->_get_hash_parameters($identity); goto VX2tu; COtsS: return FALSE; goto Bf2Yh; vGKmH: $algo = $this->_get_hash_algo(); goto x6apB; uGmbW: K2Vsp: goto JZSkX; Bf2Yh: Lx1rI: goto vGKmH; p9fpq: return password_hash($password, $algo, $params); goto uGmbW; hS3k8: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto Lx1rI; } goto COtsS; JZSkX: return FALSE; goto KK0mv; VX2tu: if (!($algo !== FALSE && $params !== FALSE)) { goto K2Vsp; } goto p9fpq; KK0mv: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto fLiqr; oJOHP: Zj6iV: goto Nwpm2; ggRyc: wZzkJ: goto MkU1h; YJply: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto NiHNP; fLiqr: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto wZzkJ; } goto wjXC6; MkU1h: if (strpos($hash_password_db, "\44") === 0) { goto Zj6iV; } goto YJply; NiHNP: goto b4NlR; goto oJOHP; wjXC6: return FALSE; goto ggRyc; sDRQr: b4NlR: goto baoM5; Nwpm2: return password_verify($password, $hash_password_db); goto sDRQr; baoM5: } public function rehash_password_if_needed($hash, $identity, $password) { goto jYbcF; rhSeX: if ($this->_set_password_db($identity, $password)) { goto VS7YJ; } goto Ogvif; PeEO2: goto megAT; goto xHN_E; DIIog: if (!password_needs_rehash($hash, $algo, $params)) { goto xtzYy; } goto rhSeX; Ogvif: $this->trigger_events(["\162\145\150\141\x73\x68\137\160\141\163\x73\x77\157\x72\144", "\162\x65\150\x61\163\x68\x5f\x70\x61\163\163\167\x6f\162\x64\137\x75\x6e\163\165\143\x63\x65\163\x73\146\165\154"]); goto PeEO2; iTYBp: xtzYy: goto H7W4J; iISb5: $params = $this->_get_hash_parameters($identity); goto PfNLf; vSrXF: megAT: goto iTYBp; H7W4J: BlMrI: goto zIbBv; xHN_E: VS7YJ: goto KjuIk; KjuIk: $this->trigger_events(["\x72\145\150\x61\163\150\137\x70\141\163\x73\x77\157\x72\144", "\162\x65\x68\x61\x73\150\x5f\x70\x61\x73\x73\x77\x6f\162\x64\137\163\165\x63\x63\x65\163\163\146\x75\154"]); goto vSrXF; jYbcF: $algo = $this->_get_hash_algo(); goto iISb5; PfNLf: if (!($algo !== FALSE && $params !== FALSE)) { goto BlMrI; } goto DIIog; zIbBv: } public function get_user_by_activation_code($user_code) { goto oh9DH; sbJ8O: return $user; goto mRb5U; UyHsi: UBpix: goto n39Ap; mRb5U: gxa48: goto UyHsi; Yuwew: if (!$user) { goto UBpix; } goto yMmrC; oh9DH: $token = $this->_retrieve_selector_validator_couple($user_code); goto qYDWC; yMmrC: if (!$this->verify_password($token->validator, $user->activation_code)) { goto gxa48; } goto sbJ8O; n39Ap: return FALSE; goto h7sXf; qYDWC: $user = $this->where("\141\143\164\151\166\141\164\151\157\156\137\163\145\x6c\145\x63\164\x6f\162", $token->selector)->users()->row(); goto Yuwew; h7sXf: } public function activate($id, $code = FALSE) { goto XQ2GM; a51MR: $this->db->update($this->tables["\x75\163\145\x72\x73"], $data, ["\151\x64" => $id]); goto lyfPo; UmUjZ: if (!($code === FALSE || $user && $user->id === $id)) { goto jJsD7; } goto SfovE; OMGB9: $this->set_error("\141\143\x74\x69\x76\x61\x74\145\x5f\165\156\x73\165\x63\x63\x65\x73\163\x66\165\154"); goto bxYuA; XQ2GM: $this->trigger_events("\160\162\145\x5f\x61\x63\164\151\166\141\164\x65"); goto SLEcG; r3glW: $this->trigger_events("\x65\170\x74\x72\141\x5f\167\150\145\x72\x65"); goto a51MR; A0utb: $this->trigger_events(["\160\x6f\x73\x74\137\141\143\x74\151\166\x61\164\145", "\x70\157\163\164\x5f\x61\143\164\151\x76\141\x74\145\x5f\165\156\x73\165\x63\x63\145\163\163\x66\x75\154"]); goto OMGB9; bxYuA: return FALSE; goto x7gWu; LGzPb: jJsD7: goto A0utb; SLEcG: if (!($code !== FALSE)) { goto gOPFT; } goto hzjzR; ZfBD4: return TRUE; goto X1uYU; FJqO8: $this->trigger_events(["\x70\x6f\x73\x74\137\141\143\164\x69\166\x61\164\x65", "\x70\157\x73\164\137\x61\x63\x74\x69\166\x61\164\x65\137\163\165\143\143\145\163\163\x66\x75\154"]); goto h_Jnp; h_Jnp: $this->set_message("\x61\143\164\151\x76\x61\x74\x65\x5f\x73\x75\x63\143\145\x73\163\x66\165\154"); goto ZfBD4; J1ltu: gOPFT: goto UmUjZ; lyfPo: if (!($this->db->affected_rows() === 1)) { goto y3FCF; } goto FJqO8; X1uYU: y3FCF: goto LGzPb; SfovE: $data = ["\x61\143\164\151\166\141\164\151\x6f\156\137\163\145\154\x65\x63\x74\157\x72" => NULL, "\141\x63\164\151\x76\x61\164\151\157\156\137\x63\x6f\144\x65" => NULL, "\141\x63\164\151\x76\145" => 1]; goto r3glW; hzjzR: $user = $this->get_user_by_activation_code($code); goto J1ltu; x7gWu: } public function deactivate($id = NULL) { goto uQzgb; bBv9b: $token = $this->_generate_selector_validator_couple(20, 40); goto MTArR; mmm7W: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto yO_AE; } goto z2KbS; gnEO7: yO_AE: goto X04rO; uFAia: if ($return) { goto fLyaH; } goto e1c9j; MTArR: $this->activation_code = $token->user_code; goto BRdf2; asNKB: goto ssQuZ; goto NtaNN; l2AwT: qMH24: goto G8iLJ; NtaNN: fLyaH: goto QnDGq; afZPy: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, ["\151\144" => $id]); goto ABKCa; ABKCa: $return = $this->db->affected_rows() == 1; goto uFAia; L_vk0: dkIq1: goto bBv9b; uQzgb: $this->trigger_events("\144\145\x61\x63\x74\x69\166\x61\164\x65"); goto cZdBR; uqcGd: ssQuZ: goto doRoq; H_kaG: $this->trigger_events("\x65\170\164\x72\141\137\x77\x68\x65\162\145"); goto afZPy; e1c9j: $this->set_error("\144\x65\141\143\164\x69\x76\141\164\x65\137\165\156\163\x75\143\x63\x65\163\163\x66\x75\154"); goto asNKB; G8iLJ: $this->set_error("\x64\145\141\x63\164\151\166\x61\164\x65\x5f\165\x6e\163\x75\x63\x63\145\x73\x73\x66\165\154"); goto INXBF; INXBF: return FALSE; goto L_vk0; doRoq: return $return; goto AKhai; BRdf2: $data = ["\141\143\x74\151\166\x61\x74\x69\157\x6e\x5f\x73\145\x6c\x65\143\164\157\x72" => $token->selector, "\141\143\164\151\166\x61\x74\151\x6f\x6e\x5f\x63\x6f\144\x65" => $token->validator_hashed, "\x61\x63\x74\151\x76\x65" => 0]; goto H_kaG; z2KbS: $this->set_error("\x64\145\141\143\x74\151\x76\141\x74\x65\x5f\143\x75\x72\x72\x65\x6e\164\x5f\165\163\x65\162\137\x75\x6e\x73\165\143\143\145\163\x73\146\x75\154"); goto EyqnG; EyqnG: return FALSE; goto gnEO7; QnDGq: $this->set_message("\144\x65\141\143\x74\x69\x76\141\164\x65\x5f\163\x75\x63\x63\145\163\x73\x66\x75\154"); goto uqcGd; cZdBR: if (!isset($id)) { goto qMH24; } goto mmm7W; X04rO: goto dkIq1; goto l2AwT; AKhai: } public function clear_forgotten_password_code($identity) { goto bGJzT; jwNkU: $this->db->update($this->tables["\x75\x73\x65\x72\163"], $data, [$this->identity_column => $identity]); goto TDI9Y; bGJzT: if (!empty($identity)) { goto FV2ry; } goto AqB_u; juHUv: $data = ["\x66\x6f\162\147\x6f\x74\164\x65\x6e\137\160\x61\x73\163\167\x6f\x72\144\x5f\163\x65\x6c\145\x63\x74\x6f\x72" => NULL, "\146\157\162\147\157\164\164\x65\x6e\x5f\x70\141\x73\163\167\157\x72\144\137\143\157\144\x65" => NULL, "\146\x6f\x72\147\157\164\164\x65\x6e\x5f\160\141\x73\163\167\157\162\144\x5f\x74\x69\155\145" => NULL]; goto jwNkU; TDI9Y: return TRUE; goto zejt9; A5JlY: FV2ry: goto juHUv; AqB_u: return FALSE; goto A5JlY; zejt9: } public function clear_remember_code($identity) { goto Zdu5e; vTMWL: Hv6Oi: goto L000A; Zdu5e: if (!empty($identity)) { goto Hv6Oi; } goto Wb1vt; Wb1vt: return FALSE; goto vTMWL; L000A: $data = ["\x72\145\x6d\x65\155\142\x65\x72\137\163\x65\x6c\145\x63\x74\157\x72" => NULL, "\x72\x65\x6d\x65\155\x62\x65\162\x5f\143\x6f\144\x65" => NULL]; goto XidVg; WKcvC: return TRUE; goto eKB7H; XidVg: $this->db->update($this->tables["\165\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto WKcvC; eKB7H: } public function reset_password($identity, $new) { goto xXzJz; k9j41: return FALSE; goto xoXiD; E2TOP: $return = $this->_set_password_db($identity, $new); goto fTjhQ; Wx6Ot: $this->trigger_events(["\160\x6f\163\164\x5f\x63\150\x61\156\147\x65\137\x70\x61\163\x73\x77\157\162\144", "\160\157\163\x74\x5f\143\x68\x61\156\x67\x65\137\x70\141\x73\163\167\157\x72\x64\137\x75\x6e\x73\165\143\x63\145\x73\x73\x66\x75\x6c"]); goto k9j41; Way_g: $this->set_message("\x70\x61\163\x73\167\157\x72\x64\x5f\x63\150\141\x6e\147\x65\x5f\163\165\143\143\x65\163\163\x66\165\x6c"); goto n5Xdp; p5c0g: return $return; goto k1tqj; OqPaG: lvvd7: goto uSPo1; xXzJz: $this->trigger_events("\x70\162\145\x5f\143\x68\141\156\x67\145\137\x70\141\x73\x73\167\x6f\162\x64"); goto DZIqh; pLwT7: $this->trigger_events(["\160\x6f\x73\164\137\143\150\x61\x6e\x67\x65\x5f\x70\141\163\163\x77\157\162\144", "\x70\x6f\x73\x74\x5f\x63\x68\141\x6e\147\145\x5f\160\x61\163\x73\167\157\162\x64\137\165\156\x73\x75\x63\143\145\163\163\146\165\154"]); goto lzlR1; lzlR1: $this->set_error("\x70\141\x73\x73\167\157\162\144\137\x63\x68\x61\x6e\x67\x65\137\165\x6e\x73\x75\143\x63\x65\x73\163\146\165\154"); goto rsPXo; rsPXo: goto XLJbl; goto OqPaG; uSPo1: $this->trigger_events(["\x70\157\163\x74\x5f\x63\x68\141\156\147\145\x5f\160\x61\163\163\x77\x6f\162\144", "\x70\157\163\164\137\143\150\141\x6e\x67\145\x5f\160\141\x73\163\167\157\162\144\137\x73\x75\143\x63\x65\x73\163\x66\x75\154"]); goto Way_g; DZIqh: if ($this->identity_check($identity)) { goto w9Uyg; } goto Wx6Ot; xoXiD: w9Uyg: goto E2TOP; fTjhQ: if ($return) { goto lvvd7; } goto pLwT7; n5Xdp: XLJbl: goto p5c0g; k1tqj: } public function change_password($identity, $old, $new) { goto lJtBS; E1uU1: $this->set_error("\x70\x61\163\x73\x77\x6f\x72\144\137\143\x68\141\x6e\147\x65\x5f\x75\x6e\163\165\143\143\145\163\163\x66\165\154"); goto OamKX; OkMH0: goto oxwKd; goto tUIyr; aG2Pc: W9MJD: goto pl8Jb; aGyU6: $this->set_message("\160\x61\x73\163\167\x6f\162\144\137\x63\150\x61\x6e\147\x65\137\x73\165\x63\143\x65\x73\x73\146\x75\154"); goto c3Kbs; OamKX: return FALSE; goto CY5ZV; pl8Jb: $this->set_error("\160\141\163\x73\x77\157\162\144\x5f\x63\x68\141\156\147\145\137\165\156\163\x75\x63\143\145\163\x73\146\165\x6c"); goto ZJn79; CY5ZV: wzgWZ: goto SnEp5; lJtBS: $this->trigger_events("\160\x72\145\137\x63\150\141\x6e\147\x65\137\x70\x61\163\163\167\x6f\x72\x64"); goto I7E3q; ZJn79: return FALSE; goto oZdgK; mqDpq: if (!($query->num_rows() !== 1)) { goto wzgWZ; } goto sE1GI; brSli: $this->trigger_events(["\x70\x6f\163\x74\137\x63\150\x61\156\x67\145\137\x70\x61\x73\163\167\x6f\162\144", "\160\157\163\164\x5f\143\x68\141\x6e\147\145\x5f\160\x61\x73\x73\x77\157\x72\x64\137\x73\x75\x63\143\x65\x73\163\x66\165\154"]); goto aGyU6; I7E3q: $this->trigger_events("\x65\x78\x74\x72\x61\137\167\150\x65\162\145"); goto TJSGj; lVbby: if ($result) { goto y1m5y; } goto uzfTt; uzfTt: $this->trigger_events(["\x70\157\x73\164\137\143\150\x61\x6e\x67\x65\x5f\160\141\163\163\167\x6f\x72\x64", "\160\x6f\163\164\137\143\x68\141\156\147\x65\x5f\160\141\163\163\x77\x6f\162\144\137\x75\x6e\x73\x75\143\143\145\x73\163\146\165\x6c"]); goto qodZV; jHqPh: return $result; goto aG2Pc; c3Kbs: oxwKd: goto jHqPh; qodZV: $this->set_error("\160\x61\x73\x73\167\x6f\x72\x64\x5f\143\x68\141\x6e\x67\x65\137\165\x6e\x73\x75\143\143\145\163\163\146\x75\154"); goto OkMH0; R2p7b: if (!$this->verify_password($old, $user->password, $identity)) { goto W9MJD; } goto Vxvcl; SnEp5: $user = $query->row(); goto R2p7b; sE1GI: $this->trigger_events(["\160\157\x73\x74\x5f\143\x68\141\x6e\147\145\x5f\x70\141\x73\x73\x77\x6f\162\144", "\160\157\x73\x74\137\x63\150\141\x6e\147\x65\x5f\160\x61\x73\x73\167\157\162\144\137\165\x6e\163\165\143\143\x65\163\163\x66\x75\x6c"]); goto E1uU1; Vxvcl: $result = $this->_set_password_db($identity, $new); goto lVbby; TJSGj: $query = $this->db->select("\151\144\x2c\x20\x70\141\x73\163\167\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\144\x65\x73\143")->get($this->tables["\165\x73\145\162\163"]); goto mqDpq; tUIyr: y1m5y: goto brSli; oZdgK: } public function username_check($username = '') { goto fir8x; YpuNG: $this->trigger_events("\x65\x78\164\x72\141\137\167\x68\145\162\x65"); goto x1UUC; fir8x: $this->trigger_events("\165\x73\x65\x72\x6e\141\155\145\137\143\x68\145\x63\153"); goto SgNOB; SgNOB: if (!empty($username)) { goto wvPCx; } goto dGJK_; e5dKi: wvPCx: goto YpuNG; x1UUC: return $this->db->where("\165\x73\145\x72\156\141\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\165\163\145\162\x73"]) > 0; goto CXOvg; dGJK_: return FALSE; goto e5dKi; CXOvg: } public function email_check($email = '') { goto ND5mB; hKfIB: return FALSE; goto NUs0J; NUs0J: GKuSK: goto EAHnW; ND5mB: $this->trigger_events("\145\x6d\x61\151\x6c\x5f\x63\150\145\x63\153"); goto Zz5wL; EAHnW: $this->trigger_events("\x65\x78\x74\x72\141\x5f\x77\150\145\x72\x65"); goto MBQ45; Zz5wL: if (!empty($email)) { goto GKuSK; } goto hKfIB; MBQ45: return $this->db->where("\x65\155\141\151\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\162\163"]) > 0; goto kc2cw; kc2cw: } public function identity_check($identity = '') { goto d9apD; XxuiN: uGfOd: goto LWhk8; d9apD: $this->trigger_events("\x69\144\x65\156\164\x69\x74\171\x5f\x63\150\145\x63\153"); goto HnlYJ; LWhk8: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\163\x65\x72\x73"]) > 0; goto ZSqRf; nSnGh: return FALSE; goto XxuiN; HnlYJ: if (!empty($identity)) { goto uGfOd; } goto nSnGh; ZSqRf: } public function get_user_id_from_identity($identity = '') { goto wnMyI; jWZtM: return FALSE; goto tlZCF; wnMyI: if (!empty($identity)) { goto FxCQP; } goto VJKys; VJKys: return FALSE; goto QnBwr; tlZCF: cYOHe: goto rjiy4; moTnr: if (!($query->num_rows() !== 1)) { goto cYOHe; } goto jWZtM; QnBwr: FxCQP: goto FS2eA; rjiy4: $user = $query->row(); goto a86We; FS2eA: $query = $this->db->select("\x69\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\163"]); goto moTnr; a86We: return $user->id; goto HtRA9; HtRA9: } public function forgotten_password($identity) { goto FUkh0; MXBFR: imoll: goto fFiuY; hEoyg: $this->trigger_events(["\160\x6f\163\164\137\x66\x6f\x72\147\157\164\x74\145\156\137\160\141\x73\x73\x77\x6f\x72\x64", "\160\157\x73\x74\x5f\x66\157\162\x67\157\164\164\145\156\137\x70\141\x73\163\167\x6f\x72\144\137\x75\x6e\163\x75\x63\x63\145\x73\x73\146\165\x6c"]); goto RDv9F; VfujB: $this->trigger_events("\x65\x78\x74\x72\141\137\x77\150\x65\162\x65"); goto k1Btg; gLGT3: y_0If: goto de6dx; nLQ8p: $update = ["\146\157\x72\x67\x6f\164\x74\x65\156\x5f\160\x61\x73\x73\167\157\x72\x64\x5f\163\x65\x6c\145\143\164\x6f\x72" => $token->selector, "\x66\157\162\x67\157\x74\x74\x65\156\137\x70\141\163\163\167\x6f\162\x64\x5f\x63\157\x64\x65" => $token->validator_hashed, "\146\x6f\x72\x67\157\x74\164\x65\x6e\137\160\x61\163\x73\x77\157\x72\x64\137\164\151\x6d\x65" => time()]; goto VfujB; RDv9F: return FALSE; goto XzX4L; qSce0: return FALSE; goto vsE5Y; k1Btg: $this->db->update($this->tables["\x75\163\x65\162\163"], $update, [$this->identity_column => $identity]); goto yX414; vsE5Y: goto imoll; goto gLGT3; tt01H: $token = $this->_generate_selector_validator_couple(20, 80); goto nLQ8p; de6dx: $this->trigger_events(["\x70\x6f\163\164\x5f\x66\157\x72\x67\157\164\164\x65\156\x5f\160\141\163\163\167\x6f\x72\x64", "\x70\157\163\x74\137\146\x6f\162\x67\157\164\164\x65\x6e\137\x70\141\163\163\167\157\x72\x64\x5f\163\165\143\x63\145\163\x73\x66\165\154"]); goto t5iQt; XzX4L: xqCVc: goto tt01H; yX414: if ($this->db->affected_rows() === 1) { goto y_0If; } goto nNXkj; t5iQt: return $token->user_code; goto MXBFR; nNXkj: $this->trigger_events(["\160\x6f\x73\164\137\x66\157\x72\147\x6f\164\164\x65\156\137\x70\141\163\163\167\157\162\x64", "\160\x6f\x73\164\137\x66\157\162\147\157\164\x74\x65\x6e\137\160\x61\163\x73\167\157\162\144\x5f\165\156\x73\x75\x63\x63\145\x73\163\x66\165\154"]); goto qSce0; FUkh0: if (!empty($identity)) { goto xqCVc; } goto hEoyg; fFiuY: } public function get_user_by_forgotten_password_code($user_code) { goto aZ63T; CgU3x: if (!$user) { goto gwUZs; } goto ynBnj; t_Kde: tO9Xj: goto Soslz; aZ63T: $token = $this->_retrieve_selector_validator_couple($user_code); goto c82Y5; LJFo9: return FALSE; goto zi5mC; c82Y5: $user = $this->where("\146\x6f\162\147\157\x74\x74\x65\156\137\x70\141\163\x73\167\157\x72\144\137\163\145\x6c\145\143\x74\x6f\162", $token->selector)->users()->row(); goto CgU3x; ynBnj: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto tO9Xj; } goto RqA2O; RqA2O: return $user; goto t_Kde; Soslz: gwUZs: goto LJFo9; zi5mC: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto FhpO2; w34FS: return FALSE; goto zKjGJ; viglP: $this->db->insert($this->tables["\x75\163\x65\162\163"], $user_data); goto cTvwo; pk8Ud: $this->set_error("\141\x63\143\x6f\165\x6e\164\x5f\143\x72\145\141\x74\151\157\x6e\x5f\144\165\x70\154\151\143\141\x74\145\x5f\151\x64\x65\x6e\164\151\164\x79"); goto kE8yT; ODYVD: Ntc31: goto DoiS0; WhvOF: $user_data = array_merge($this->_filter_data($this->tables["\165\x73\145\162\x73"], $additional_data), $data); goto veoK_; zKjGJ: n_gji: goto jehJR; jDrQi: ugpUJ: goto scrvk; cTSxy: return isset($id) ? $id : FALSE; goto zqXsH; P9zay: $groups[] = $default_group->id; goto oLfBN; oLfBN: mgZJ2: goto dsKE3; dsKE3: if (empty($groups)) { goto rxcy6; } goto KGK_n; oCM9Y: $this->set_error("\141\143\143\x6f\x75\x6e\x74\137\143\x72\x65\x61\164\151\157\156\x5f\155\x69\x73\x73\151\156\147\137\144\x65\146\x61\x75\154\x74\137\147\x72\157\165\x70"); goto jviVS; Vtt0n: $this->set_error("\141\x63\143\x6f\x75\x6e\164\137\x63\x72\x65\x61\x74\x69\x6f\156\137\165\x6e\163\165\143\x63\145\x73\x73\146\165\x6c"); goto w34FS; PYCG4: $manual_activation = $this->config->item("\x6d\141\x6e\x75\141\x6c\137\x61\143\x74\x69\166\x61\x74\151\x6f\156", "\x69\157\156\x5f\x61\x75\164\x68"); goto RMISs; lUAQY: if (!(isset($default_group->id) && empty($groups))) { goto mgZJ2; } goto P9zay; GlVZn: Ve9Ce: goto pk8Ud; wkRw1: $this->trigger_events("\x70\157\163\164\x5f\162\x65\147\x69\x73\x74\145\x72"); goto cTSxy; veoK_: $this->trigger_events("\x65\x78\x74\x72\x61\137\163\x65\x74"); goto viglP; DoiS0: goto MkU9A; goto GlVZn; cTvwo: $id = $this->db->insert_id($this->tables["\165\163\145\162\x73"] . "\137\151\144\x5f\163\145\x71"); goto lUAQY; cj2WA: $default_group = $query; goto Ja7aj; FhpO2: $this->trigger_events("\x70\162\145\137\x72\x65\147\151\163\164\145\x72"); goto PYCG4; f0xna: iDvJ4: goto cj2WA; RMISs: if ($this->identity_check($identity)) { goto Ve9Ce; } goto vB1uq; jviVS: return FALSE; goto ODYVD; KGK_n: foreach ($groups as $group) { $this->add_to_group($group, $id); p1vpz: } goto jDrQi; kE8yT: return FALSE; goto zeE2o; mpixs: $this->set_error("\x61\143\143\x6f\165\x6e\x74\x5f\143\162\x65\141\164\x69\x6f\156\x5f\x69\x6e\166\141\x6c\x69\x64\137\x64\x65\x66\x61\x75\154\x74\137\147\x72\x6f\x75\x70"); goto BgCWH; oYFSt: $query = $this->db->get_where($this->tables["\x67\x72\x6f\165\160\x73"], ["\156\x61\155\x65" => $this->config->item("\x64\145\146\141\x75\154\x74\x5f\147\x72\157\x75\x70", "\x69\157\x6e\137\x61\x75\x74\x68")], 1)->row(); goto iA4VD; Ja7aj: $ip_address = $this->input->ip_address(); goto uwoFG; vB1uq: if (!(!$this->config->item("\144\145\x66\x61\165\154\x74\137\147\x72\157\165\160", "\151\x6f\x6e\137\x61\x75\164\150") && empty($groups))) { goto Ntc31; } goto oCM9Y; scrvk: rxcy6: goto wkRw1; jehJR: $data = [$this->identity_column => $identity, "\165\163\145\162\156\x61\155\x65" => $identity, "\x70\x61\163\163\x77\x6f\x72\x64" => $password, "\x65\x6d\141\x69\x6c" => $email, "\151\x70\137\x61\x64\x64\x72\145\163\163" => $ip_address, "\143\162\145\x61\x74\145\144\x5f\x6f\x6e" => time(), "\x61\143\164\x69\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto WhvOF; BgCWH: return FALSE; goto f0xna; IVIXe: if (!($password === FALSE)) { goto n_gji; } goto Vtt0n; zeE2o: MkU9A: goto oYFSt; uwoFG: $password = $this->hash_password($password); goto IVIXe; iA4VD: if (!(!isset($query->id) && empty($groups))) { goto iDvJ4; } goto mpixs; zqXsH: } public function login($identity, $password, $remember = FALSE) { goto sGmZ0; JLDpr: return FALSE; goto yK3dF; x8W1v: HkiOC: goto yzgie; s5_bK: $this->set_message("\x6c\x6f\147\151\x6e\137\163\x75\x63\x63\145\x73\x73\146\x75\154"); goto EyiVW; l_JZ8: $this->hash_password($password); goto VvnXu; EyiVW: return TRUE; goto Qo2hR; pAVJY: $this->rehash_password_if_needed($user->password, $identity, $password); goto hfu5e; LkXQ4: TFA8k: goto pAVJY; yzgie: $this->trigger_events("\145\x78\164\x72\x61\x5f\167\150\145\x72\145"); goto C4BNx; DqgQ2: $this->update_last_login($user->id); goto PVzAZ; Ewaf9: return FALSE; goto Tm03D; FemBK: if (!$this->verify_password($password, $user->password, $identity)) { goto p0vM1; } goto oyfIx; fVQ9M: if (!$this->config->item("\162\145\x6d\145\x6d\x62\x65\162\137\165\163\x65\162\163", "\151\x6f\x6e\x5f\x61\165\x74\x68")) { goto TFA8k; } goto M_m0N; MYvlH: Q9fP1: goto LkXQ4; gu22t: return FALSE; goto LOrZW; PVzAZ: $this->clear_login_attempts($identity); goto O6_Uv; oyfIx: if (!($user->active == 0)) { goto LWgFH; } goto zCu0Y; LD5XQ: $this->set_error("\154\x6f\x67\151\x6e\x5f\x75\x6e\163\x75\x63\x63\145\x73\x73\x66\165\154"); goto uhfR8; VvnXu: $this->trigger_events("\160\157\x73\x74\x5f\x6c\x6f\x67\x69\156\137\x75\x6e\x73\165\143\x63\x65\x73\x73\146\165\154"); goto q6p25; kd4h3: czTDS: goto p8Wsp; M_m0N: if ($remember) { goto czTDS; } goto V1_b8; hfu5e: $this->session->sess_regenerate(FALSE); goto DRdaz; uhfR8: return FALSE; goto x8W1v; DRdaz: $this->trigger_events(["\160\157\163\x74\x5f\154\x6f\147\x69\x6e", "\160\157\163\164\137\154\157\147\x69\x6e\137\163\x75\143\143\x65\x73\x73\146\x75\x6c"]); goto s5_bK; C4BNx: $query = $this->db->select($this->identity_column . "\54\x20\145\155\x61\x69\154\54\40\x69\x64\54\x20\x70\141\163\x73\x77\157\162\x64\54\x20\141\x63\164\151\x76\x65\54\x20\x6c\x61\163\164\137\154\157\147\151\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\145\x73\x63")->get($this->tables["\165\163\145\162\163"]); goto g6QAU; p8Wsp: $this->remember_user($identity); goto MYvlH; Tm03D: ZiqPK: goto wkUCp; V1_b8: $this->clear_remember_code($identity); goto imOQc; O6_Uv: $this->clear_forgotten_password_code($identity); goto fVQ9M; kv1R5: $this->hash_password($password); goto F3iuo; imOQc: goto Q9fP1; goto kd4h3; SCw5M: $this->trigger_events("\x70\x6f\x73\164\137\x6c\x6f\x67\x69\x6e\x5f\165\x6e\x73\x75\143\x63\145\163\163\146\165\x6c"); goto JnwYU; YKnmF: $this->set_session($user); goto DqgQ2; F3iuo: $this->increase_login_attempts($identity); goto SCw5M; wkUCp: if (!($query->num_rows() === 1)) { goto lQZeW; } goto R1lvO; g6QAU: if (!$this->is_max_login_attempts_exceeded($identity)) { goto ZiqPK; } goto l_JZ8; ftKai: $this->set_error("\x6c\157\147\151\156\x5f\x75\156\163\165\143\143\x65\x73\163\x66\x75\x6c\x5f\x6e\157\x74\x5f\x61\x63\164\151\166\x65"); goto JLDpr; bdeKK: lQZeW: goto kv1R5; sGmZ0: $this->trigger_events("\x70\162\x65\x5f\154\157\x67\151\x6e"); goto A59zK; yK3dF: LWgFH: goto YKnmF; R1lvO: $user = $query->row(); goto FemBK; A59zK: if (!(empty($identity) || empty($password))) { goto HkiOC; } goto LD5XQ; Qo2hR: p0vM1: goto bdeKK; JnwYU: $this->set_error("\x6c\157\147\151\156\137\165\156\x73\165\143\x63\x65\x73\x73\146\165\154"); goto gu22t; q6p25: $this->set_error("\154\x6f\147\151\156\137\x74\151\x6d\145\157\165\x74"); goto Ewaf9; zCu0Y: $this->trigger_events("\x70\x6f\x73\164\137\x6c\x6f\147\x69\156\137\x75\x6e\163\165\x63\143\145\163\x73\x66\x75\154"); goto ftKai; LOrZW: } public function recheck_session() { goto yyJ_V; DiOXp: FHf29: goto yypFo; upZEI: A2Qd7: goto pLYiA; JMdFD: jUYpA: goto llHPi; JF0ty: if (!($recheck !== 0)) { goto jUYpA; } goto gBQY0; pLYiA: $this->session->set_userdata("\154\x61\x73\x74\x5f\143\x68\145\143\153", time()); goto DiOXp; aq7yi: if ($query->num_rows() === 1) { goto A2Qd7; } goto sOtWK; VlrZ1: return FALSE; goto Io2GR; x8wqb: $this->session->unset_userdata([$identity, "\x69\144", "\165\163\x65\x72\x5f\x69\144"]); goto VlrZ1; sOtWK: $this->trigger_events("\x6c\x6f\x67\157\165\x74"); goto uktPN; gBQY0: $last_login = $this->session->userdata("\154\141\x73\x74\x5f\143\x68\x65\143\153"); goto ntXuH; ntXuH: if (!($last_login + $recheck < time())) { goto tOlsP; } goto QsIFW; yyJ_V: $recheck = NULL !== $this->config->item("\162\x65\143\x68\x65\x63\x6b\x5f\x74\151\x6d\x65\162", "\151\157\x6e\x5f\x61\165\164\x68") ? $this->config->item("\162\x65\x63\x68\x65\x63\153\x5f\164\x69\x6d\145\162", "\151\x6f\x6e\x5f\141\165\164\x68") : 0; goto JF0ty; yypFo: tOlsP: goto JMdFD; Io2GR: goto FHf29; goto upZEI; llHPi: return (bool) $this->session->userdata("\x69\x64\x65\x6e\x74\x69\164\x79"); goto BT9Ue; QsIFW: $query = $this->db->select("\x69\144")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\x6e\x74\x69\x74\171"), "\x61\x63\x74\x69\166\x65" => "\x31"])->limit(1)->order_by("\151\x64", "\x64\x65\163\x63")->get($this->tables["\165\x73\145\x72\x73"]); goto aq7yi; uktPN: $identity = $this->config->item("\151\144\x65\156\164\x69\164\x79", "\151\157\x6e\x5f\141\165\164\150"); goto x8wqb; BT9Ue: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto HEJBM; cUUKK: return $attempts >= $max_attempts; goto ph7Uf; ph7Uf: eZ1Ej: goto hd7pp; GQ_Xp: if (!($max_attempts > 0)) { goto eZ1Ej; } goto I5l4k; HEJBM: if (!$this->config->item("\164\162\141\143\x6b\x5f\x6c\157\x67\151\x6e\137\141\x74\164\145\x6d\x70\164\x73", "\x69\157\x6e\137\x61\x75\164\x68")) { goto DJZ22; } goto uqKIo; dHuMH: return FALSE; goto HZoPP; uqKIo: $max_attempts = $this->config->item("\x6d\141\170\x69\155\x75\x6d\137\x6c\x6f\147\151\x6e\x5f\141\x74\164\145\x6d\160\164\x73", "\x69\157\156\137\x61\165\164\x68"); goto GQ_Xp; hd7pp: DJZ22: goto dHuMH; I5l4k: $attempts = $this->get_attempts_num($identity, $ip_address); goto cUUKK; HZoPP: } public function get_attempts_num($identity, $ip_address = NULL) { goto HuJ5Q; Munn9: TGfo1: goto SzzDW; HuJ5Q: if (!$this->config->item("\x74\162\x61\x63\153\x5f\154\x6f\x67\151\x6e\137\x61\164\164\x65\155\x70\164\163", "\151\x6f\x6e\137\x61\x75\x74\150")) { goto xSAbc; } goto VYvF_; VYvF_: $this->db->select("\61", FALSE); goto ykxSQ; SzzDW: $this->db->where("\164\x69\155\x65\x20\x3e", time() - $this->config->item("\x6c\157\143\x6b\157\x75\x74\137\164\151\155\x65", "\x69\157\156\137\x61\165\164\150"), FALSE); goto wOdPN; wOdPN: $qres = $this->db->get($this->tables["\154\157\147\151\x6e\x5f\x61\x74\x74\145\155\x70\x74\163"]); goto mW2kg; wRzS9: $this->db->where("\x69\160\137\141\144\144\162\x65\163\163", $ip_address); goto Munn9; mW2kg: return $qres->num_rows(); goto HfBJV; ykxSQ: $this->db->where("\x6c\x6f\x67\151\156", $identity); goto Yqa1W; UpNKS: $ip_address = $this->input->ip_address(); goto P8BCc; IND13: return 0; goto ExfLv; P8BCc: kfxAS: goto wRzS9; Yqa1W: if (!$this->config->item("\x74\162\141\143\x6b\137\154\157\x67\151\156\x5f\x69\160\x5f\141\144\144\162\145\163\163", "\151\157\156\137\x61\x75\164\150")) { goto TGfo1; } goto oqa6i; oqa6i: if (isset($ip_address)) { goto kfxAS; } goto UpNKS; HfBJV: xSAbc: goto IND13; ExfLv: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto gk9rl; Rm7Fh: $qres = $this->db->get($this->tables["\x6c\x6f\x67\151\x6e\x5f\x61\164\164\145\x6d\160\164\x73"], 1); goto K25zW; TAsUa: jaP3L: goto SU24O; qXV41: eTbcP: goto TAsUa; SU24O: return 0; goto aRZqO; Q4aES: $this->db->order_by("\151\144", "\144\x65\x73\x63"); goto Rm7Fh; gk9rl: if (!$this->config->item("\x74\162\141\x63\153\137\154\157\147\x69\x6e\137\x61\164\164\x65\x6d\160\164\x73", "\151\157\x6e\x5f\x61\165\164\150")) { goto jaP3L; } goto t4AKy; FfGo7: return $qres->row()->time; goto qXV41; bv509: $this->db->where("\154\157\147\x69\x6e", $identity); goto kri0G; LMg_e: qrWpD: goto Q4aES; t4AKy: $this->db->select("\x74\151\x6d\x65"); goto bv509; mi7ci: if (isset($ip_address)) { goto sTx_0; } goto O1dnU; O1dnU: $ip_address = $this->input->ip_address(); goto YG0HR; K25zW: if (!($qres->num_rows() > 0)) { goto eTbcP; } goto FfGo7; kri0G: if (!$this->config->item("\164\x72\x61\x63\153\x5f\154\157\147\x69\156\x5f\151\x70\x5f\141\144\144\x72\145\163\x73", "\x69\157\156\x5f\141\x75\x74\x68")) { goto qrWpD; } goto mi7ci; HualK: $this->db->where("\x69\x70\137\x61\144\x64\162\x65\x73\163", $ip_address); goto LMg_e; YG0HR: sTx_0: goto HualK; aRZqO: } public function get_last_attempt_ip($identity) { goto fo1yx; KWF6v: $qres = $this->db->get($this->tables["\x6c\157\x67\x69\x6e\x5f\141\164\x74\145\155\160\x74\163"], 1); goto d7Hmz; aq03V: $this->db->where("\x6c\157\147\x69\x6e", $identity); goto N1P8d; pcvWd: return ''; goto rzUo0; d7Hmz: if (!($qres->num_rows() > 0)) { goto HNGj7; } goto xUzsb; xUzsb: return $qres->row()->ip_address; goto c2jHk; Wd2Ho: diNp0: goto pcvWd; fo1yx: if (!($this->config->item("\164\x72\141\x63\153\137\x6c\x6f\147\151\156\137\141\x74\164\x65\x6d\x70\x74\163", "\x69\157\x6e\137\x61\x75\164\x68") && $this->config->item("\x74\x72\141\x63\153\137\154\x6f\x67\x69\x6e\x5f\x69\x70\x5f\141\144\144\162\x65\163\x73", "\151\x6f\156\137\x61\165\164\150"))) { goto diNp0; } goto MupyO; N1P8d: $this->db->order_by("\x69\x64", "\144\145\163\143"); goto KWF6v; c2jHk: HNGj7: goto Wd2Ho; MupyO: $this->db->select("\151\x70\x5f\x61\x64\144\162\145\x73\163"); goto aq03V; rzUo0: } public function increase_login_attempts($identity) { goto fTZh1; cj0hc: dWc_V: goto Klh63; fTZh1: if (!$this->config->item("\164\x72\141\x63\153\x5f\154\x6f\x67\x69\x6e\137\x61\164\164\145\155\160\164\x73", "\x69\x6f\x6e\x5f\x61\165\x74\x68")) { goto dWc_V; } goto QULMP; QULMP: $data = ["\151\160\137\141\144\x64\162\x65\x73\163" => '', "\154\157\x67\x69\x6e" => $identity, "\164\x69\x6d\145" => time()]; goto sdedB; Klh63: return FALSE; goto alJFR; AueL9: $data["\151\160\137\141\x64\x64\x72\145\163\163"] = $this->input->ip_address(); goto Ep0DR; sdedB: if (!$this->config->item("\x74\162\141\x63\x6b\137\154\157\x67\151\x6e\x5f\x69\160\x5f\x61\x64\144\x72\x65\x73\163", "\151\157\156\x5f\x61\x75\164\x68")) { goto KKt2g; } goto AueL9; x9b4r: return $this->db->insert($this->tables["\x6c\x6f\147\151\156\x5f\141\x74\x74\145\x6d\x70\164\x73"], $data); goto cj0hc; Ep0DR: KKt2g: goto x9b4r; alJFR: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto Vkng3; j29tf: OF0JS: goto xBqOX; xBqOX: $this->db->where("\x69\x70\x5f\x61\x64\144\162\145\163\x73", $ip_address); goto DA6MV; cXnHQ: if (!$this->config->item("\164\162\x61\x63\x6b\x5f\154\x6f\147\151\x6e\x5f\151\x70\x5f\141\x64\144\162\145\x73\163", "\x69\157\x6e\x5f\141\x75\164\x68")) { goto wtt7f; } goto DJ5vU; yqJwt: return FALSE; goto Lo_p5; DA6MV: wtt7f: goto liJMa; wearf: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\143\153\157\165\164\137\164\151\x6d\x65", "\x69\157\x6e\137\x61\x75\x74\150")); goto l7W0e; l7W0e: $this->db->where("\x6c\x6f\x67\x69\x6e", $identity); goto cXnHQ; r0Uk7: $ip_address = $this->input->ip_address(); goto j29tf; h7IP3: return $this->db->delete($this->tables["\x6c\x6f\x67\x69\x6e\137\x61\x74\x74\x65\x6d\160\164\163"]); goto ILSLO; ILSLO: FPj1n: goto yqJwt; DJ5vU: if (isset($ip_address)) { goto OF0JS; } goto r0Uk7; Vkng3: if (!$this->config->item("\x74\162\141\143\x6b\x5f\154\157\x67\x69\x6e\x5f\x61\x74\x74\145\155\160\164\x73", "\x69\157\156\x5f\x61\x75\x74\150")) { goto FPj1n; } goto wearf; liJMa: $this->db->or_where("\164\151\155\x65\x20\74", time() - $old_attempts_expire_period, FALSE); goto h7IP3; Lo_p5: } public function limit($limit) { goto UQVki; UQVki: $this->trigger_events("\154\x69\155\151\x74"); goto Z1NXF; LwaTI: return $this; goto VaIL3; Z1NXF: $this->_ion_limit = $limit; goto LwaTI; VaIL3: } public function offset($offset) { goto C1Nba; yPoQl: return $this; goto VqsVy; C1Nba: $this->trigger_events("\x6f\x66\x66\163\145\164"); goto vGYQj; vGYQj: $this->_ion_offset = $offset; goto yPoQl; VqsVy: } public function where($where, $value = NULL) { goto gHLRY; FljvR: $where = [$where => $value]; goto jTdvi; PxDuJ: return $this; goto BiJPE; yKiK4: array_push($this->_ion_where, $where); goto PxDuJ; jTdvi: cFn3e: goto yKiK4; AJ1ii: if (is_array($where)) { goto cFn3e; } goto FljvR; gHLRY: $this->trigger_events("\167\x68\145\162\145"); goto AJ1ii; BiJPE: } public function like($like, $value = NULL, $position = "\x62\x6f\164\150") { goto WA7C8; gOFgh: array_push($this->_ion_like, ["\154\x69\153\145" => $like, "\166\141\154\165\145" => $value, "\x70\x6f\x73\151\164\151\157\156" => $position]); goto tkDpp; tkDpp: return $this; goto b42Z5; WA7C8: $this->trigger_events("\x6c\x69\153\x65"); goto gOFgh; b42Z5: } public function select($select) { goto E22fm; LTaph: $this->_ion_select[] = $select; goto qbeJt; qbeJt: return $this; goto Gyzgl; E22fm: $this->trigger_events("\x73\x65\x6c\145\x63\x74"); goto LTaph; Gyzgl: } public function order_by($by, $order = "\144\x65\163\x63") { goto Fwv5M; Fwv5M: $this->trigger_events("\x6f\x72\x64\x65\162\137\x62\x79"); goto NZiWV; qE8Xl: return $this; goto lwLao; NZiWV: $this->_ion_order_by = $by; goto GxQmT; GxQmT: $this->_ion_order = $order; goto qE8Xl; lwLao: } public function row() { goto z2B1M; I3jRi: $row = $this->response->row(); goto GfnLK; GfnLK: return $row; goto x1VAB; z2B1M: $this->trigger_events("\162\157\x77"); goto I3jRi; x1VAB: } public function row_array() { goto WoLg2; yjKyO: $row = $this->response->row_array(); goto PDOZe; PDOZe: return $row; goto fDHk6; WoLg2: $this->trigger_events(["\x72\157\167", "\162\157\167\137\141\x72\x72\x61\x79"]); goto yjKyO; fDHk6: } public function result() { goto Y3NLK; Y3NLK: $this->trigger_events("\x72\145\x73\165\x6c\164"); goto Wezec; viIjn: return $result; goto AU5yO; Wezec: $result = $this->response->result(); goto viIjn; AU5yO: } public function result_array() { goto mxycO; dqkqz: return $result; goto FYquA; mxycO: $this->trigger_events(["\162\x65\163\165\x6c\164", "\x72\x65\163\x75\x6c\164\x5f\x61\x72\x72\x61\x79"]); goto Sxi5n; Sxi5n: $result = $this->response->result_array(); goto dqkqz; FYquA: } public function num_rows() { goto zmcqv; g5i7R: return $result; goto wfhEj; TVUTA: $result = $this->response->num_rows(); goto g5i7R; zmcqv: $this->trigger_events(["\x6e\165\155\137\x72\x6f\x77\163"]); goto TVUTA; wfhEj: } public function users($groups = NULL) { goto qAAJJ; aBitX: $group_ids = []; goto rtjq0; OQ5BD: Bs2QD: goto t9YvL; Gd5Cn: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto uqTxe; } goto ghv0Y; K53tS: $this->response = $this->db->get($this->tables["\x75\x73\x65\162\163"]); goto TLHOM; Uc3yI: uqTxe: goto QU9ju; h3T98: $this->_ion_limit = NULL; goto lCsCR; bZtIV: ktAjk: goto aBitX; QU9ju: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto KDYgk; o_wgl: if (empty($group_ids)) { goto L2EXe; } goto vuQO5; WULqh: $this->db->where_in($this->tables["\147\162\x6f\x75\x70\x73"] . "\56\156\x61\x6d\145", $group_names); goto SaVZ0; KDYgk: $this->_ion_limit = NULL; goto VOxg8; DeYAV: ixJ_C: goto aPk9h; pDzXc: $this->db->limit($this->_ion_limit); goto h3T98; si516: goto XbKvT; goto Uc3yI; R09_0: $this->db->select([$this->tables["\x75\163\x65\x72\x73"] . "\56\x2a", $this->tables["\x75\163\145\162\163"] . "\x2e\151\144\x20\141\x73\40\151\144", $this->tables["\165\x73\145\x72\163"] . "\56\x69\x64\x20\x61\x73\x20\165\163\145\x72\x5f\151\x64"]); goto BKUIc; Xcbww: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto Bf01k; } goto R09_0; ozt6f: K8V9G: goto Xzt0s; jK183: $this->db->join($this->tables["\165\x73\x65\x72\x73\137\147\162\x6f\x75\160\x73"], $this->tables["\165\x73\x65\162\x73\x5f\147\x72\x6f\x75\160\163"] . "\56" . $this->join["\165\x73\145\162\x73"] . "\75" . $this->tables["\x75\163\x65\x72\x73"] . "\x2e\x69\x64", "\x69\x6e\x6e\145\x72"); goto bZtIV; LCeFU: abP2i: goto w6oVW; Xt3gh: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\137\167\150\x65\x72\x65\137\151\x6e" : "\x77\x68\x65\x72\145\137\151\x6e"; goto B7zlR; LWR1t: XbKvT: goto WKoJE; rtjq0: $group_names = []; goto JEVhD; BKUIc: goto RA83v; goto aKB4W; G4tae: foreach ($this->_ion_where as $where) { $this->db->where($where); bXviO: } goto DeYAV; CqT5C: foreach ($this->_ion_select as $select) { $this->db->select($select); XYmZq: } goto OQ5BD; v1Xi6: $groups = [$groups]; goto tBbnV; ghv0Y: if (!isset($this->_ion_limit)) { goto oBv4i; } goto pDzXc; LI8VC: Ns_eW: goto K53tS; SaVZ0: Wjfw0: goto o_wgl; VPGDm: $this->_ion_order = NULL; goto NxhBp; t9YvL: $this->_ion_select = []; goto P0tsJ; JEVhD: foreach ($groups as $group) { goto Ab1fL; c5nvn: goto Rwone; goto aq6OV; IjKz9: VczxY: goto fJLZA; Ab1fL: if (is_numeric($group)) { goto BHEt1; } goto gZJ2k; gZJ2k: $group_names[] = $group; goto c5nvn; aNQri: $group_ids[] = $group; goto ByVeW; ByVeW: Rwone: goto IjKz9; aq6OV: BHEt1: goto aNQri; fJLZA: } goto Fhqwd; q6fpS: L2EXe: goto yObO1; yObO1: l4Ip4: goto zRy7o; Xzt0s: $this->_ion_like = []; goto PEU_K; YBeC0: $this->db->distinct(); goto jK183; f60nI: if (!(isset($groups) && !empty($groups))) { goto ktAjk; } goto YBeC0; P0tsJ: RA83v: goto Y_zxv; TLHOM: return $this; goto UkkJF; PEU_K: VBDZk: goto Gd5Cn; dz18t: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto abP2i; } goto G4tae; zRy7o: $this->trigger_events("\x65\170\164\x72\x61\137\167\150\x65\x72\145"); goto dz18t; w6oVW: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto VBDZk; } goto rMkVE; Fhqwd: bj9i6: goto Xt3gh; NxhBp: $this->_ion_order_by = NULL; goto LI8VC; B7zlR: if (empty($group_names)) { goto Wjfw0; } goto zrkef; aKB4W: Bf01k: goto CqT5C; tBbnV: nbeSA: goto f60nI; lCsCR: oBv4i: goto si516; vuQO5: $this->db->{$or_where_in}($this->tables["\165\163\145\x72\x73\137\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\147\x72\157\165\160\x73"], $group_ids); goto q6fpS; rMkVE: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\x6b\145"], $like["\x76\x61\154\x75\145"], $like["\160\157\163\x69\164\x69\157\156"]); lJulq: } goto ozt6f; qAAJJ: $this->trigger_events("\165\163\145\162\163"); goto Xcbww; aPk9h: $this->_ion_where = []; goto LCeFU; WKoJE: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto Ns_eW; } goto frYe2; zrkef: $this->db->join($this->tables["\147\x72\x6f\x75\160\163"], $this->tables["\165\x73\x65\x72\163\x5f\x67\x72\157\x75\160\163"] . "\x2e" . $this->join["\147\162\157\165\x70\x73"] . "\x20\x3d\40" . $this->tables["\147\x72\x6f\x75\x70\163"] . "\x2e\151\144", "\x69\x6e\156\x65\162"); goto WULqh; frYe2: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto VPGDm; VOxg8: $this->_ion_offset = NULL; goto LWR1t; sTiHo: if (is_array($groups)) { goto nbeSA; } goto v1Xi6; Y_zxv: if (!isset($groups)) { goto l4Ip4; } goto sTiHo; UkkJF: } public function user($id = NULL) { goto uCoRW; Yce1Y: return $this; goto r3iyL; HR98z: $this->limit(1); goto bfksz; ysLsm: $this->users(); goto Yce1Y; uCoRW: $this->trigger_events("\165\163\145\162"); goto GEHcA; bfksz: $this->order_by($this->tables["\165\163\145\x72\163"] . "\56\x69\x64", "\144\145\163\x63"); goto DhTYm; GEHcA: $id = isset($id) ? $id : $this->session->userdata("\165\163\145\x72\x5f\x69\144"); goto HR98z; DhTYm: $this->where($this->tables["\x75\163\145\162\x73"] . "\56\151\x64", $id); goto ysLsm; r3iyL: } public function get_users_groups($id = FALSE) { goto AviUw; HvpMT: return $this->db->select($this->tables["\x75\x73\145\x72\163\x5f\x67\x72\157\x75\x70\x73"] . "\56" . $this->join["\x67\162\157\165\160\x73"] . "\x20\141\163\40\x69\x64\x2c\x20" . $this->tables["\x67\162\157\165\160\163"] . "\56\x6e\141\155\x65\x2c\x20" . $this->tables["\x67\162\x6f\x75\x70\x73"] . "\56\x64\x65\163\143\x72\151\160\x74\151\157\x6e")->where($this->tables["\x75\163\145\162\163\137\x67\x72\157\165\x70\163"] . "\x2e" . $this->join["\x75\x73\145\x72\x73"], $id)->join($this->tables["\147\x72\157\x75\160\163"], $this->tables["\x75\x73\x65\162\x73\137\147\x72\x6f\x75\160\163"] . "\x2e" . $this->join["\147\x72\x6f\165\x70\163"] . "\x3d" . $this->tables["\147\162\x6f\165\x70\x73"] . "\56\x69\x64")->get($this->tables["\165\x73\x65\x72\x73\137\x67\162\157\165\160\163"]); goto Z8UMR; AviUw: $this->trigger_events("\x67\x65\x74\137\165\x73\x65\x72\163\x5f\147\162\x6f\165\160"); goto CABaZ; CABaZ: $id || ($id = $this->session->userdata("\x75\x73\145\162\137\x69\144")); goto HvpMT; Z8UMR: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto oLDLY; t2fJ5: if (is_array($check_group)) { goto cAZGr; } goto PKfWP; JTKLN: $this->_cache_user_in_group[$id] = $groups_array; goto fcpZR; U751n: $groups_array = []; goto CTeYc; MLZWd: $users_groups = $this->get_users_groups($id)->result(); goto U751n; Wkrvr: cAZGr: goto bRwuc; T30bi: V5sPh: goto ECd0S; VjAZK: foreach ($check_group as $key => $value) { goto xJCxf; ukwic: Xsi1V: goto UCvLn; xJCxf: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto tp6fj; q2Vp2: TXYf_: goto ukwic; tp6fj: if (!(in_array($value, $groups) xor $check_all)) { goto TXYf_; } goto VOnmD; VOnmD: return !$check_all; goto q2Vp2; UCvLn: } goto T30bi; jfDy3: $groups_array = $this->_cache_user_in_group[$id]; goto db_Qu; oLDLY: $this->trigger_events("\x69\156\137\147\x72\157\165\x70"); goto DBBGZ; HI0dU: aY4gb: goto JTKLN; fcpZR: goto Cor1w; goto cNb3f; DBBGZ: $id || ($id = $this->session->userdata("\x75\x73\145\x72\137\151\144")); goto t2fJ5; bRwuc: if (isset($this->_cache_user_in_group[$id])) { goto HZ5gK; } goto MLZWd; ECd0S: return $check_all; goto SOVcH; PKfWP: $check_group = [$check_group]; goto Wkrvr; CTeYc: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; uvrJg: } goto HI0dU; cNb3f: HZ5gK: goto jfDy3; db_Qu: Cor1w: goto VjAZK; SOVcH: } public function add_to_group($group_ids, $user_id = FALSE) { goto ZLAyN; YvpcN: $user_id || ($user_id = $this->session->userdata("\x75\x73\x65\x72\x5f\x69\144")); goto h2Xkt; UDjW3: foreach ($group_ids as $group_id) { goto bAGKN; Tm2Jb: so6_g: goto lk8bE; LogeY: h6uCq: goto UHK8b; l2Ye5: $group = $this->group($group_id)->result(); goto yncRJ; IZLCR: goto c1uRX; goto Tm2Jb; bAGKN: if (!$this->db->insert($this->tables["\x75\163\x65\x72\163\137\147\x72\157\x75\x70\163"], [$this->join["\147\162\x6f\x75\160\x73"] => (float) $group_id, $this->join["\x75\x73\145\x72\163"] => (float) $user_id])) { goto bPxuG; } goto LRqMk; yncRJ: $group_name = $group[0]->name; goto IZ4Jo; lk8bE: $group_name = $this->_cache_groups[$group_id]; goto FFIVs; IZ4Jo: $this->_cache_groups[$group_id] = $group_name; goto IZLCR; dDVYV: bPxuG: goto LogeY; LRqMk: if (isset($this->_cache_groups[$group_id])) { goto so6_g; } goto l2Ye5; FFIVs: c1uRX: goto O735Q; O735Q: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto aY23e; aY23e: $return++; goto dDVYV; UHK8b: } goto skKT7; skKT7: Tip3A: goto QisGj; QisGj: return $return; goto J5sbi; FO3Tn: rKdiz: goto Pik3g; knDCW: $group_ids = [$group_ids]; goto FO3Tn; ZLAyN: $this->trigger_events("\141\144\144\x5f\164\157\137\x67\162\157\x75\160"); goto YvpcN; h2Xkt: if (is_array($group_ids)) { goto rKdiz; } goto knDCW; Pik3g: $return = 0; goto UDjW3; J5sbi: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto jjyH8; go_kM: return FALSE; goto rWXIE; HZzFb: return $return; goto jSlxU; UHPPc: if (!empty($group_ids)) { goto zaUrO; } goto s0bdV; l91wU: XRKEc: goto rUiAz; EeUaV: $return = TRUE; goto vje7m; s0bdV: if (!($return = $this->db->delete($this->tables["\x75\x73\145\x72\x73\x5f\x67\x72\x6f\165\x70\163"], [$this->join["\x75\x73\x65\162\163"] => (float) $user_id]))) { goto UGj8D; } goto xEDAS; xEDAS: $this->_cache_user_in_group[$user_id] = []; goto zIlhf; rWXIE: SN9aj: goto UHPPc; jjyH8: $this->trigger_events("\162\145\x6d\x6f\x76\145\x5f\x66\162\157\x6d\x5f\147\162\x6f\165\x70"); goto PZRnz; zIlhf: UGj8D: goto QBEiv; QBEiv: goto oUAoT; goto Df53K; Df53K: zaUrO: goto Hvd6R; kBoJo: RnGF7: goto EeUaV; vje7m: oUAoT: goto HZzFb; Hvd6R: if (is_array($group_ids)) { goto XRKEc; } goto SVcKb; PZRnz: if (!empty($user_id)) { goto SN9aj; } goto go_kM; SVcKb: $group_ids = [$group_ids]; goto l91wU; rUiAz: foreach ($group_ids as $group_id) { goto HMGDg; nTuAq: f0eIp: goto lOYTz; vNX45: unset($this->_cache_user_in_group[$user_id][$group_id]); goto nTuAq; lOYTz: xSItw: goto Qxi2a; QabiL: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto f0eIp; } goto vNX45; HMGDg: $this->db->delete($this->tables["\165\163\145\x72\163\137\147\162\x6f\165\160\163"], [$this->join["\x67\x72\157\165\x70\x73"] => (float) $group_id, $this->join["\165\163\145\162\163"] => (float) $user_id]); goto QabiL; Qxi2a: } goto kBoJo; jSlxU: } public function groups() { goto pWpM1; NI8DM: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto afVog; } goto HPDXK; Scmwp: goto Fx5Oc; goto ZvJ0I; ESpoC: $this->db->limit($this->_ion_limit); goto Lm13O; ZvJ0I: afVog: goto Hrre3; yE9sn: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto S0YtI; Jn9Uk: return $this; goto FgJgK; wBH95: PCZkg: goto Scmwp; x6Hmg: $this->_ion_where = []; goto YIivW; A7yg_: $this->response = $this->db->get($this->tables["\x67\x72\x6f\165\160\163"]); goto Jn9Uk; ArcNx: $this->_ion_limit = NULL; goto sYG7J; Lm13O: $this->_ion_limit = NULL; goto wBH95; o41XW: O9aVg: goto x6Hmg; qr9WM: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto LkrTb; } goto WCjaZ; Hrre3: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto ArcNx; PiTh8: Fx5Oc: goto N4kvi; S0YtI: dBbvj: goto A7yg_; YIivW: LkrTb: goto NI8DM; pWpM1: $this->trigger_events("\x67\162\157\x75\x70\163"); goto qr9WM; N4kvi: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto dBbvj; } goto yE9sn; WCjaZ: foreach ($this->_ion_where as $where) { $this->db->where($where); HVAhH: } goto o41XW; sYG7J: $this->_ion_offset = NULL; goto PiTh8; HPDXK: if (!isset($this->_ion_limit)) { goto PCZkg; } goto ESpoC; FgJgK: } public function group($id = NULL) { goto aHaGg; OCb6x: $this->limit(1); goto pdXFa; anoIP: if (!isset($id)) { goto hrcYl; } goto e1wfI; m6Pfp: hrcYl: goto OCb6x; aHaGg: $this->trigger_events("\147\x72\157\x75\160"); goto anoIP; e1wfI: $this->where($this->tables["\x67\162\157\x75\x70\163"] . "\x2e\x69\x64", $id); goto m6Pfp; pwTeb: return $this->groups(); goto eRYd7; pdXFa: $this->order_by("\151\144", "\144\x65\163\x63"); goto pwTeb; eRYd7: } public function update($id, array $data) { goto GTNFW; JQ7xB: $this->trigger_events(["\x70\x6f\x73\x74\137\x75\160\x64\x61\x74\145\x5f\165\x73\145\162", "\160\157\163\x74\137\165\x70\x64\141\164\x65\137\x75\x73\145\x72\137\165\x6e\163\x75\143\x63\x65\x73\x73\146\165\154"]); goto J2kHl; J2kHl: $this->set_error("\165\160\144\x61\164\x65\x5f\x75\156\163\x75\143\x63\x65\x73\x73\x66\x75\x6c"); goto fNQNt; LS8FO: $data = $this->_filter_data($this->tables["\165\x73\145\162\x73"], $data); goto bcBA9; bcBA9: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\x73\163\x77\157\162\x64", $data) || array_key_exists("\x65\155\x61\151\x6c", $data))) { goto jQZEv; } goto WF4vo; zdj5u: $data["\160\x61\163\x73\x77\x6f\x72\144"] = $this->hash_password($data["\x70\x61\x73\x73\167\x6f\x72\x64"], $user->{$this->identity_column}); goto vSBoP; bVYTV: $this->set_message("\165\x70\144\x61\164\145\137\x73\165\x63\143\145\163\163\x66\x75\154"); goto nje4M; VtLR_: $this->trigger_events(["\x70\157\x73\164\137\165\160\x64\141\x74\x65\x5f\165\x73\145\x72", "\160\x6f\163\x74\x5f\165\x70\x64\141\x74\145\x5f\x75\163\x65\162\137\163\165\x63\x63\x65\163\x73\146\x75\154"]); goto bVYTV; nFTeh: GtXXE: goto zdj5u; GTNFW: $this->trigger_events("\160\162\145\x5f\x75\x70\144\x61\164\x65\137\x75\x73\x65\x72"); goto rV9Lv; K3vaA: $this->db->trans_rollback(); goto JQ7xB; T3lrs: $this->set_error("\141\143\x63\157\165\156\x74\x5f\x63\162\x65\x61\x74\151\x6f\156\137\x64\165\x70\x6c\x69\x63\x61\x74\x65\137\x69\x64\x65\x6e\164\151\164\x79"); goto cOokq; aaRIM: unset($data["\160\x61\x73\x73\x77\157\x72\x64"]); goto ZdwSu; O_YzG: return FALSE; goto ztz_c; Ft3BV: $this->db->trans_begin(); goto OrPbE; Z0bXY: if (!empty($data["\x70\x61\x73\x73\167\157\x72\144"])) { goto GtXXE; } goto aaRIM; cOokq: $this->trigger_events(["\160\x6f\x73\x74\x5f\165\160\144\141\164\x65\x5f\165\x73\145\x72", "\160\157\163\x74\x5f\165\x70\x64\141\164\145\x5f\x75\163\x65\162\137\x75\156\163\x75\x63\143\145\163\x73\146\165\154"]); goto T6RrR; vSBoP: if (!($data["\160\x61\163\163\x77\x6f\x72\144"] === FALSE)) { goto oOmNu; } goto K3vaA; OrPbE: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto hzTol; } goto K9cpq; DBedN: return FALSE; goto LX838; rV9Lv: $user = $this->user($id)->row(); goto Ft3BV; ZdwSu: goto cTlIy; goto nFTeh; Vn6nV: $this->set_error("\x75\x70\x64\141\x74\x65\137\x75\x6e\163\x75\143\x63\x65\163\x73\x66\165\154"); goto DBedN; ztz_c: hzTol: goto LS8FO; CDvfQ: $this->db->update($this->tables["\165\x73\145\162\163"], $data, ["\x69\x64" => $user->id]); goto ns5NV; K9cpq: $this->db->trans_rollback(); goto T3lrs; WF4vo: if (!array_key_exists("\160\141\x73\x73\167\157\162\144", $data)) { goto RGW4s; } goto Z0bXY; LX838: s9uKR: goto zEBnd; fNQNt: return FALSE; goto u5pgR; uV7YX: cTlIy: goto qNm65; ns5NV: if (!($this->db->trans_status() === FALSE)) { goto s9uKR; } goto zDzJg; zDzJg: $this->db->trans_rollback(); goto alGOU; M1MqF: $this->trigger_events("\145\170\x74\x72\141\x5f\x77\x68\x65\x72\x65"); goto CDvfQ; nje4M: return TRUE; goto Invct; alGOU: $this->trigger_events(["\x70\x6f\x73\164\137\x75\x70\144\141\x74\x65\137\x75\x73\x65\162", "\x70\157\163\x74\x5f\x75\x70\144\141\164\x65\x5f\x75\x73\145\x72\x5f\x75\156\x73\x75\143\x63\x65\163\x73\x66\x75\154"]); goto Vn6nV; u5pgR: oOmNu: goto uV7YX; zEBnd: $this->db->trans_commit(); goto VtLR_; qNm65: RGW4s: goto BaiwT; BaiwT: jQZEv: goto M1MqF; T6RrR: $this->set_error("\165\x70\x64\141\x74\x65\137\165\x6e\x73\x75\143\143\x65\x73\163\x66\165\x6c"); goto O_YzG; Invct: } public function delete_user($id) { goto J2nvm; NJITl: if (!($this->db->trans_status() === FALSE)) { goto IndwD; } goto GJ0FJ; J2nvm: $this->trigger_events("\160\x72\x65\137\x64\145\x6c\x65\164\145\137\165\x73\145\162"); goto HBdBe; JqbYX: $this->db->trans_commit(); goto vIXAQ; vIXAQ: $this->trigger_events(["\160\x6f\x73\164\x5f\x64\x65\154\145\164\145\137\x75\163\145\162", "\x70\157\x73\164\x5f\x64\145\x6c\x65\164\145\137\165\x73\x65\x72\137\x73\165\143\x63\x65\x73\163\x66\x75\154"]); goto a9G4w; nPeQp: return TRUE; goto TJ82M; Idvxx: return FALSE; goto yq0oH; kNmWn: $this->remove_from_group(NULL, $id); goto GWWCu; f7VMY: $this->set_error("\x64\145\154\145\164\x65\137\x75\156\x73\165\x63\143\145\x73\163\146\x75\154"); goto Idvxx; GWWCu: $this->db->delete($this->tables["\x75\x73\145\x72\x73"], ["\x69\144" => $id]); goto NJITl; a9G4w: $this->set_message("\x64\145\x6c\x65\164\x65\x5f\163\165\143\x63\x65\163\x73\146\x75\154"); goto nPeQp; wpHA3: $this->trigger_events(["\160\157\x73\164\x5f\x64\x65\154\x65\x74\x65\x5f\x75\163\145\x72", "\160\157\x73\164\x5f\x64\145\x6c\x65\164\x65\137\165\x73\x65\x72\x5f\165\156\x73\x75\x63\143\x65\163\x73\x66\165\154"]); goto f7VMY; yq0oH: IndwD: goto JqbYX; GJ0FJ: $this->db->trans_rollback(); goto wpHA3; HBdBe: $this->db->trans_begin(); goto kNmWn; TJ82M: } public function update_last_login($id) { goto x8i1V; SEirr: $this->load->helper("\x64\x61\164\145"); goto GbfFq; x8i1V: $this->trigger_events("\165\160\x64\x61\x74\145\137\154\141\163\x74\137\x6c\157\147\151\x6e"); goto SEirr; GbfFq: $this->trigger_events("\145\x78\164\x72\141\137\x77\150\145\162\x65"); goto kzoR1; lepkH: return $this->db->affected_rows() == 1; goto wKHZj; kzoR1: $this->db->update($this->tables["\x75\x73\145\x72\x73"], ["\x6c\141\x73\x74\x5f\x6c\157\x67\x69\x6e" => time()], ["\151\144" => $id]); goto lepkH; wKHZj: } public function set_lang($lang = "\x65\x6e") { goto ayDFE; V7xSh: ucgg9: goto IgIpU; ow3qr: $expire = $this->config->item("\165\163\x65\x72\137\145\170\160\151\162\145", "\x69\x6f\x6e\137\x61\x75\164\150"); goto fTF37; eEJdp: if ($this->config->item("\x75\163\145\x72\x5f\145\170\160\151\x72\x65", "\151\157\156\137\x61\x75\164\x68") === 0) { goto ucgg9; } goto ow3qr; IgIpU: $expire = self::MAX_COOKIE_LIFETIME; goto qAGSg; qAGSg: FJSuI: goto amiPl; fTF37: goto FJSuI; goto V7xSh; ayDFE: $this->trigger_events("\163\x65\x74\x5f\154\x61\156\147"); goto eEJdp; amiPl: set_cookie(["\156\141\x6d\145" => "\x6c\141\x6e\147\x5f\143\x6f\x64\145", "\166\x61\154\165\145" => $lang, "\145\x78\x70\x69\162\145" => $expire]); goto Jmj4f; Jmj4f: return TRUE; goto ablOm; ablOm: } public function set_session($user) { goto cuYmq; wi06h: $this->trigger_events("\160\x6f\x73\164\x5f\163\x65\164\137\163\145\163\x73\151\157\156"); goto KiNX0; ry1Z4: $session_data = ["\x69\144\145\x6e\164\151\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\x6d\141\151\x6c" => $user->email, "\x75\163\145\x72\137\151\144" => $user->id, "\x6f\154\144\x5f\x6c\141\163\164\137\x6c\157\x67\151\156" => $user->last_login, "\x6c\x61\163\x74\x5f\143\150\x65\143\153" => time()]; goto AN7aW; cuYmq: $this->trigger_events("\x70\x72\x65\137\163\x65\x74\137\163\x65\163\163\x69\x6f\156"); goto ry1Z4; KiNX0: return TRUE; goto H8I_n; AN7aW: $this->session->set_userdata($session_data); goto wi06h; H8I_n: } public function remember_user($identity) { goto P4dBv; fO2lP: return FALSE; goto mrpr9; SWUfV: if ($identity) { goto P0kQZ; } goto lPiFV; QZcXn: if (!$token->validator_hashed) { goto VeqyM; } goto PQ20i; m6pfN: set_cookie(["\156\x61\155\x65" => $this->config->item("\x72\145\155\x65\x6d\x62\145\162\137\143\157\157\153\x69\x65\137\x6e\x61\155\x65", "\x69\x6f\156\x5f\x61\165\164\150"), "\x76\x61\154\x75\x65" => $token->user_code, "\x65\170\x70\x69\162\x65" => $expire]); goto vB5UN; fHE7l: return TRUE; goto ORdzy; GBu1O: VeqyM: goto ROrzi; ORdzy: zXD7e: goto GBu1O; rmS0Q: goto OK3T8; goto HgWwx; kMAZ6: OK3T8: goto m6pfN; PQ20i: $this->db->update($this->tables["\x75\163\x65\162\163"], ["\162\x65\x6d\145\155\x62\x65\162\x5f\163\145\154\x65\143\x74\157\x72" => $token->selector, "\162\145\x6d\x65\x6d\x62\x65\x72\137\x63\x6f\x64\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto oZnM8; P1mmd: if ($this->config->item("\x75\163\x65\162\137\x65\170\160\x69\x72\x65", "\151\x6f\156\x5f\x61\x75\164\150") === 0) { goto qTnR2; } goto ofMrM; ofMrM: $expire = $this->config->item("\x75\x73\x65\162\137\x65\x78\160\151\162\145", "\151\x6f\156\x5f\141\165\x74\x68"); goto rmS0Q; lPiFV: return FALSE; goto EsHJe; HgWwx: qTnR2: goto mCygk; crLc9: $token = $this->_generate_selector_validator_couple(); goto QZcXn; mCygk: $expire = self::MAX_COOKIE_LIFETIME; goto kMAZ6; EsHJe: P0kQZ: goto crLc9; vB5UN: $this->trigger_events(["\x70\x6f\x73\x74\137\162\145\x6d\x65\x6d\142\145\x72\137\x75\163\x65\x72", "\162\x65\155\x65\155\x62\145\x72\x5f\x75\x73\145\162\137\x73\165\x63\143\x65\163\163\146\165\x6c"]); goto fHE7l; ROrzi: $this->trigger_events(["\x70\x6f\163\164\137\x72\145\155\x65\x6d\142\x65\162\x5f\165\163\x65\x72", "\162\145\155\145\155\142\x65\x72\137\x75\x73\x65\x72\x5f\165\156\x73\165\143\x63\145\163\x73\146\165\154"]); goto fO2lP; P4dBv: $this->trigger_events("\160\162\x65\137\162\145\x6d\x65\x6d\142\x65\x72\137\x75\163\145\162"); goto SWUfV; oZnM8: if (!($this->db->affected_rows() > -1)) { goto zXD7e; } goto P1mmd; mrpr9: } public function login_remembered_user() { goto PmubD; ys183: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto xWUoe; Rt3tg: return TRUE; goto fgoEp; CFl3Y: $this->trigger_events(["\x70\157\x73\164\x5f\154\x6f\147\151\156\x5f\162\145\x6d\x65\155\142\x65\162\x65\144\x5f\x75\x73\x65\x72", "\160\x6f\163\x74\x5f\154\x6f\x67\151\x6e\x5f\162\145\x6d\x65\155\142\x65\162\145\144\x5f\x75\x73\145\x72\137\165\x6e\x73\x75\x63\143\x65\163\x73\146\165\x6c"]); goto Bkl5z; oa0xE: $this->trigger_events(["\x70\157\163\164\137\x6c\x6f\147\x69\156\137\162\x65\155\x65\155\x62\x65\162\x65\144\x5f\165\163\x65\162", "\x70\x6f\x73\164\137\154\157\x67\x69\156\137\162\145\155\145\x6d\x62\145\162\145\144\137\165\x73\145\162\x5f\163\x75\143\x63\145\x73\163\x66\x75\x6c"]); goto Rt3tg; KXbIv: $query = $this->db->select($this->identity_column . "\x2c\40\x69\x64\x2c\40\145\x6d\141\151\154\x2c\x20\162\x65\x6d\145\x6d\x62\x65\162\137\143\x6f\144\x65\x2c\40\x6c\141\x73\x74\x5f\x6c\157\x67\x69\156")->where("\162\145\x6d\x65\155\x62\145\x72\x5f\163\145\154\x65\143\x74\157\x72", $token->selector)->where("\141\143\x74\x69\166\145", 1)->limit(1)->get($this->tables["\165\x73\145\162\x73"]); goto FZ8j0; FIuGn: $this->update_last_login($user->id); goto Fs7Mg; OsGzh: $this->session->sess_regenerate(FALSE); goto oa0xE; p97dL: return FALSE; goto nFe0I; Fs7Mg: $this->set_session($user); goto On1W8; h0YwR: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto oJ0h9; } goto FIuGn; fwPIE: $identity = $user->{$this->identity_column}; goto h0YwR; q0lh4: $this->remember_user($identity); goto zgFCm; fgoEp: oJ0h9: goto Qjk0g; xWUoe: if (!($token === FALSE)) { goto kwHdP; } goto VsOxX; On1W8: $this->clear_forgotten_password_code($identity); goto UP4wT; Bkl5z: return FALSE; goto ktf89; PmubD: $this->trigger_events("\160\162\145\x5f\x6c\157\147\151\x6e\137\162\145\155\x65\155\x62\145\162\x65\x64\x5f\x75\163\145\162"); goto l0zyk; zgFCm: UwJ7u: goto OsGzh; VsOxX: $this->trigger_events(["\160\157\x73\164\137\154\x6f\x67\x69\x6e\x5f\x72\145\155\x65\155\x62\x65\x72\x65\x64\137\x75\163\x65\x72", "\x70\x6f\x73\x74\137\154\157\147\x69\x6e\137\x72\x65\155\x65\x6d\142\x65\x72\x65\144\137\165\163\x65\162\137\165\156\163\165\143\x63\x65\163\163\146\x75\154"]); goto p97dL; FZ8j0: if (!($query->num_rows() === 1)) { goto J37m8; } goto INtJB; Qjk0g: J37m8: goto chy2w; ABf0a: $this->trigger_events("\145\170\164\162\141\x5f\167\150\145\162\x65"); goto KXbIv; nFe0I: kwHdP: goto ABf0a; chy2w: delete_cookie($this->config->item("\162\x65\155\145\155\142\145\162\137\x63\157\157\x6b\151\x65\137\x6e\141\155\145", "\x69\x6f\156\x5f\x61\165\x74\150")); goto CFl3Y; UP4wT: if (!$this->config->item("\165\163\145\162\137\x65\x78\x74\x65\156\x64\x5f\157\156\137\154\x6f\147\151\156", "\151\157\x6e\137\141\165\x74\150")) { goto UwJ7u; } goto q0lh4; INtJB: $user = $query->row(); goto fwPIE; l0zyk: $remember_cookie = get_cookie($this->config->item("\x72\x65\x6d\x65\155\142\x65\x72\137\143\x6f\157\x6b\x69\x65\x5f\156\x61\155\x65", "\x69\157\156\137\141\165\x74\x68")); goto ys183; ktf89: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto W2ALo; i4qBr: $data = array_merge($this->_filter_data($this->tables["\147\x72\x6f\165\x70\163"], $additional_data), $data); goto JOo2E; tTvSP: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\x75\x70\x73"], ["\x6e\x61\155\145" => $group_name])->num_rows(); goto x6bm2; JOo2E: IeaTn: goto ddIq8; SjhfL: return FALSE; goto NSJCz; dAOgW: return $group_id; goto kKnlQ; jX1BJ: $this->set_error("\x67\162\x6f\165\x70\x5f\x6e\x61\x6d\145\x5f\x72\145\161\165\x69\x72\x65\x64"); goto Pr21D; x6bm2: if (!($existing_group !== 0)) { goto mW_ES; } goto RA1Tg; C_YXF: bUKU6: goto tTvSP; PHxfb: $data = ["\156\x61\x6d\145" => $group_name, "\144\145\x73\143\162\x69\160\164\151\157\156" => $group_description]; goto S2Oyn; S2Oyn: if (empty($additional_data)) { goto IeaTn; } goto i4qBr; Pr21D: return FALSE; goto C_YXF; JiG11: $this->set_message("\x67\x72\157\x75\x70\x5f\x63\x72\145\141\164\x69\157\156\x5f\x73\165\x63\x63\x65\x73\x73\x66\x75\x6c"); goto dAOgW; rfzdL: $this->db->insert($this->tables["\147\162\157\x75\160\x73"], $data); goto nnvGF; ddIq8: $this->trigger_events("\145\170\x74\162\x61\137\x67\x72\157\165\160\137\163\x65\x74"); goto rfzdL; nnvGF: $group_id = $this->db->insert_id($this->tables["\x67\x72\157\x75\160\163"] . "\x5f\x69\144\137\x73\145\161"); goto JiG11; W2ALo: if ($group_name) { goto bUKU6; } goto jX1BJ; NSJCz: mW_ES: goto PHxfb; RA1Tg: $this->set_error("\x67\x72\157\165\160\137\x61\154\162\145\x61\144\x79\137\145\170\x69\x73\164\x73"); goto SjhfL; kKnlQ: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto kb93X; n9E48: $data = []; goto Qy7_7; pCmu_: return TRUE; goto eQNDL; QPh9B: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto cztIe; } goto Y9rvi; Y9rvi: $this->set_error("\147\x72\157\165\160\x5f\x61\x6c\x72\145\141\144\171\x5f\145\170\x69\x73\164\163"); goto x3Kx1; mNN0J: s4Xnq: goto mGJy3; kb93X: if (!empty($group_id)) { goto Xpgro; } goto b2XX4; wuDid: ZGoO3: goto STXMR; Qy7_7: if (empty($group_name)) { goto ZGoO3; } goto IPnEG; XoxMU: gdF7O: goto FI3k0; bxvwA: $data["\156\x61\x6d\145"] = $group_name; goto wuDid; pczg2: Xpgro: goto n9E48; STXMR: $group = $this->db->get_where($this->tables["\147\162\157\x75\160\x73"], ["\151\144" => $group_id])->row(); goto tT0it; e5KOF: return FALSE; goto mNN0J; b2XX4: return FALSE; goto pczg2; tT0it: if (!($this->config->item("\141\x64\x6d\x69\x6e\x5f\x67\x72\x6f\x75\x70", "\151\157\x6e\137\141\x75\x74\x68") === $group->name && $group_name !== $group->name)) { goto s4Xnq; } goto xE5OK; IPnEG: $existing_group = $this->db->get_where($this->tables["\147\162\x6f\x75\x70\163"], ["\156\x61\x6d\145" => $group_name])->row(); goto QPh9B; xE5OK: $this->set_error("\147\x72\157\165\160\137\156\141\155\x65\x5f\141\x64\155\x69\x6e\x5f\x6e\x6f\164\137\x61\154\x74\145\162"); goto e5KOF; mGJy3: if (empty($additional_data)) { goto gdF7O; } goto bAa3L; lMXxD: cztIe: goto bxvwA; x3Kx1: return FALSE; goto lMXxD; bAa3L: $data = array_merge($this->_filter_data($this->tables["\147\162\157\165\x70\x73"], $additional_data), $data); goto XoxMU; lqe0C: $this->set_message("\x67\x72\157\x75\160\x5f\165\x70\x64\x61\164\x65\x5f\163\165\143\143\145\x73\163\x66\165\154"); goto pCmu_; FI3k0: $this->db->update($this->tables["\x67\162\157\x75\x70\163"], $data, ["\x69\x64" => $group_id]); goto lqe0C; eQNDL: } public function delete_group($group_id = FALSE) { goto DEvta; nW0Cu: $this->trigger_events(["\160\157\x73\164\137\x64\145\154\x65\x74\x65\x5f\147\x72\x6f\165\160", "\x70\157\163\164\x5f\144\145\x6c\145\164\x65\137\x67\162\x6f\165\x70\137\x6e\157\164\141\x6c\x6c\157\167\x65\x64"]); goto l6fXU; yM52P: $this->db->delete($this->tables["\147\162\157\165\160\x73"], ["\x69\144" => $group_id]); goto NAJgb; nzHv6: return FALSE; goto AwS9o; DEvta: if (!(!$group_id || empty($group_id))) { goto S9KLC; } goto Ojm2d; l6fXU: $this->set_error("\x67\162\x6f\165\160\137\x64\x65\154\x65\164\145\137\156\157\164\x61\154\154\x6f\x77\145\x64"); goto Y1Q9c; eRqPq: $this->set_error("\147\x72\157\x75\x70\137\x64\145\154\x65\x74\x65\137\x75\x6e\163\165\x63\x63\145\163\163\146\165\154"); goto nzHv6; Zvk7J: $this->trigger_events("\x70\162\x65\x5f\144\145\x6c\x65\x74\x65\x5f\x67\x72\157\x75\160"); goto CTl22; Y1Q9c: return FALSE; goto rmtGt; dBUqv: $this->db->trans_commit(); goto a359Y; Zt87P: $this->db->trans_rollback(); goto iA1iF; NAJgb: if (!($this->db->trans_status() === FALSE)) { goto tSlkc; } goto Zt87P; rmtGt: YPd4s: goto Zvk7J; iA1iF: $this->trigger_events(["\x70\x6f\x73\x74\137\144\x65\154\x65\x74\x65\137\x67\x72\x6f\x75\160", "\x70\x6f\x73\x74\137\x64\x65\x6c\x65\164\145\x5f\147\x72\x6f\165\160\x5f\x75\156\x73\165\143\143\x65\x73\x73\x66\165\154"]); goto eRqPq; mEMFR: $this->db->delete($this->tables["\x75\163\145\x72\163\137\x67\162\x6f\165\160\x73"], [$this->join["\x67\162\x6f\165\160\x73"] => $group_id]); goto yM52P; a3kSN: $this->set_message("\147\162\157\165\x70\137\144\x65\154\x65\164\145\x5f\163\x75\143\x63\x65\x73\163\146\x75\154"); goto DK7QR; a359Y: $this->trigger_events(["\x70\157\163\x74\x5f\x64\145\x6c\145\x74\145\137\147\x72\157\x75\x70", "\160\157\x73\x74\x5f\144\x65\154\145\164\145\137\x67\x72\157\x75\160\x5f\163\165\x63\143\x65\x73\163\x66\165\154"]); goto a3kSN; Ojm2d: return FALSE; goto HJQ9s; AwS9o: tSlkc: goto dBUqv; DK7QR: return TRUE; goto cuXoO; DdUFe: if (!($group->name == $this->config->item("\141\x64\x6d\151\x6e\137\x67\x72\157\x75\160", "\x69\x6f\x6e\x5f\x61\165\x74\150"))) { goto YPd4s; } goto nW0Cu; CTl22: $this->db->trans_begin(); goto mEMFR; HJQ9s: S9KLC: goto qNZzT; qNZzT: $group = $this->group($group_id)->row(); goto DdUFe; cuXoO: } public function set_hook($event, $name, $class, $method, $arguments) { goto GFgXL; GFgXL: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto Fh3o1; Fh3o1: $this->_ion_hooks->{$event}[$name]->class = $class; goto Kdxaw; Kdxaw: $this->_ion_hooks->{$event}[$name]->method = $method; goto J3gok; J3gok: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto j6j7z; j6j7z: } public function remove_hook($event, $name) { goto TGLi3; iBjde: unset($this->_ion_hooks->{$event}[$name]); goto WnjZr; WnjZr: ArAw6: goto B7p4L; TGLi3: if (!isset($this->_ion_hooks->{$event}[$name])) { goto ArAw6; } goto iBjde; B7p4L: } public function remove_hooks($event) { goto HDBmL; HDBmL: if (!isset($this->_ion_hooks->{$event})) { goto qcevF; } goto d_d16; hLW4w: qcevF: goto WIElH; d_d16: unset($this->_ion_hooks->{$event}); goto hLW4w; WIElH: } protected function _call_hook($event, $name) { goto oB2NQ; oB2NQ: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto LGcTN; } goto CTrzt; Tb1MN: return FALSE; goto zF3hr; KoRTr: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto kdHPa; CTrzt: $hook = $this->_ion_hooks->{$event}[$name]; goto KoRTr; kdHPa: LGcTN: goto Tb1MN; zF3hr: } public function trigger_events($events) { goto gq8Bs; K_nlV: foreach ($events as $event) { $this->trigger_events($event); QD13t: } goto uX6QJ; Dgul2: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto Vpz4F; } goto jWv95; uX6QJ: jR3Dd: goto vnkHB; LJT6J: sZ5Bc: goto Yi9H8; jWv95: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); S7Jty: } goto LJT6J; gq8Bs: if (is_array($events) && !empty($events)) { goto yBUhv; } goto Dgul2; vnkHB: DlQFA: goto E0qjZ; Yi9H8: Vpz4F: goto DJ_p_; DJ_p_: goto DlQFA; goto OrJzP; OrJzP: yBUhv: goto K_nlV; E0qjZ: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto j2BqD; j2BqD: $this->message_start_delimiter = $start_delimiter; goto O1OtE; O1OtE: $this->message_end_delimiter = $end_delimiter; goto lOl01; lOl01: return TRUE; goto Gi86B; Gi86B: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto o3RDi; JT8Pz: $this->error_end_delimiter = $end_delimiter; goto Fr55S; Fr55S: return TRUE; goto oFFNf; o3RDi: $this->error_start_delimiter = $start_delimiter; goto JT8Pz; oFFNf: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto QbYjo; nH9mj: return $_output; goto ESlsS; jwAFu: foreach ($this->messages as $message) { goto pwwnK; pwwnK: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\x23"; goto gwvda; Fw4I4: N0K8X: goto n2R_U; gwvda: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto Fw4I4; n2R_U: } goto gTU3p; gTU3p: Kf0iE: goto nH9mj; QbYjo: $_output = ''; goto jwAFu; ESlsS: } public function messages_array($langify = TRUE) { goto eeTWO; ufPxR: return $_output; goto RWOtQ; H1Dcx: goto Vba9K; goto aBSxa; LGFU_: return $this->messages; goto H1Dcx; ZO0JU: $_output = []; goto Q7TwQ; RWOtQ: Vba9K: goto mU66e; aBSxa: UVZZv: goto ZO0JU; Q7TwQ: foreach ($this->messages as $message) { goto HpHqO; h8pz1: QI8t4: goto rRWWL; TrH7K: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto h8pz1; HpHqO: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\43"; goto TrH7K; rRWWL: } goto mZZ2S; mZZ2S: k5VTk: goto ufPxR; eeTWO: if ($langify) { goto UVZZv; } goto LGFU_; mU66e: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto FG8ed; FG8ed: $_output = ''; goto WF3E3; WF3E3: foreach ($this->errors as $error) { goto PM3KR; mplrl: ubnsG: goto KNoOl; ardQK: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto mplrl; PM3KR: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\43\43"; goto ardQK; KNoOl: } goto DDc1h; tBbps: return $_output; goto Aphoi; DDc1h: dnuj6: goto tBbps; Aphoi: } public function errors_array($langify = TRUE) { goto hPkEd; vRTEE: D1OYS: goto nBfUe; xuwn6: return $_output; goto vRTEE; sBgna: dSMGH: goto xuwn6; o5Mzq: $_output = []; goto AZwWX; c79vH: LMApl: goto o5Mzq; fx0Uu: return $this->errors; goto GkMLv; hPkEd: if ($langify) { goto LMApl; } goto fx0Uu; GkMLv: goto D1OYS; goto c79vH; AZwWX: foreach ($this->errors as $error) { goto A780L; RokfY: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto q9w53; A780L: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto RokfY; q9w53: zCbVQ: goto cB9Vn; cB9Vn: } goto sBgna; nBfUe: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto zhV_a; Km21r: if (!($hash === FALSE)) { goto c0IKY; } goto xCsZQ; zhV_a: $hash = $this->hash_password($password, $identity); goto Km21r; nk7J4: c0IKY: goto UWv4A; hDUjk: $this->db->update($this->tables["\165\x73\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto Od36L; UWv4A: $data = ["\160\x61\163\163\x77\x6f\x72\x64" => $hash, "\x72\x65\x6d\x65\155\142\x65\162\x5f\x63\x6f\x64\x65" => NULL, "\146\x6f\162\147\157\164\x74\x65\156\x5f\x70\x61\x73\x73\167\157\162\x64\137\143\x6f\144\145" => NULL, "\146\x6f\x72\x67\157\x74\x74\x65\x6e\x5f\x70\x61\x73\163\x77\157\x72\x64\137\164\x69\155\145" => NULL]; goto ulv66; xCsZQ: return FALSE; goto nk7J4; ulv66: $this->trigger_events("\x65\x78\x74\x72\x61\137\x77\x68\145\162\x65"); goto hDUjk; Od36L: return $this->db->affected_rows() == 1; goto BQiiF; BQiiF: } protected function _filter_data($table, $data) { goto yLkUj; rQHXf: foreach ($columns as $column) { goto U8hi9; v3rqa: C1tUe: goto vQJ91; ECyg9: $filtered_data[$column] = $data[$column]; goto YN6Kg; YN6Kg: TMTyq: goto v3rqa; U8hi9: if (!array_key_exists($column, $data)) { goto TMTyq; } goto ECyg9; vQJ91: } goto bUdx5; bUdx5: dphI2: goto Nb2Sr; yLkUj: $filtered_data = []; goto a2OzU; a2OzU: $columns = $this->db->list_fields($table); goto gl85Q; gl85Q: if (!is_array($data)) { goto XnzwV; } goto rQHXf; Nb2Sr: XnzwV: goto Zktlz; Zktlz: return $filtered_data; goto Ot7CF; Ot7CF: } protected function _random_token($result_length = 32) { goto x6j30; do31S: return bin2hex(random_bytes($result_length / 2)); goto USIzu; icGLn: nFtJg: goto LCn26; M1uCi: xwb7L: goto KQW24; YSw15: if (!function_exists("\157\x70\145\156\163\163\x6c\137\x72\141\x6e\x64\157\155\137\160\x73\x65\165\144\157\137\142\171\x74\x65\163")) { goto xwb7L; } goto SGrG2; x6j30: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto nFtJg; } goto S2wZk; S2wZk: $result_length = 32; goto icGLn; ZGrZw: if (!function_exists("\x6d\143\x72\x79\x70\164\137\x63\162\x65\x61\164\x65\x5f\151\x76")) { goto MlJTh; } goto tMOyv; LCn26: if (!function_exists("\162\x61\156\144\x6f\155\137\142\171\x74\145\x73")) { goto pCxOB; } goto do31S; tMOyv: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto XulzQ; XulzQ: MlJTh: goto YSw15; SGrG2: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto M1uCi; KQW24: return FALSE; goto oL1iS; USIzu: pCxOB: goto ZGrZw; oL1iS: } protected function _get_hash_parameters($identity = NULL) { goto Y7ybF; tApuy: H7kd0: goto LEnog; F0wyL: if (!$identity) { goto hNs1O; } goto bVSzX; JSZoY: hNs1O: goto vqtfs; dA8dB: switch ($this->hash_method) { case "\142\143\x72\x79\x70\x74": $params = ["\x63\x6f\x73\x74" => $is_admin ? $this->config->item("\x62\x63\162\171\160\164\137\x61\x64\155\151\x6e\x5f\143\157\x73\x74", "\x69\157\x6e\137\141\165\x74\x68") : $this->config->item("\142\x63\162\x79\x70\164\x5f\144\145\x66\141\x75\154\164\137\143\x6f\163\164", "\151\x6f\156\x5f\141\x75\x74\150")]; goto H7kd0; case "\x61\162\x67\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\x72\147\x6f\156\x32\x5f\141\144\155\151\156\x5f\x70\x61\x72\141\155\x73", "\151\x6f\156\x5f\x61\165\x74\150") : $this->config->item("\x61\x72\x67\157\156\x32\137\x64\145\x66\141\165\154\x74\x5f\160\141\x72\141\x6d\x73", "\x69\x6f\x6e\x5f\x61\165\x74\x68"); goto H7kd0; default: } goto epNLn; bVSzX: $user_id = $this->get_user_id_from_identity($identity); goto rgz6d; Bl3Xe: $is_admin = TRUE; goto Fe7OH; LEnog: return $params; goto LRlWi; Fe7OH: RUTO0: goto JSZoY; rgz6d: if (!($user_id && $this->in_group($this->config->item("\x61\144\155\x69\156\137\x67\x72\157\165\160", "\151\157\156\x5f\141\165\x74\x68"), $user_id))) { goto RUTO0; } goto Bl3Xe; vqtfs: $params = FALSE; goto dA8dB; Y7ybF: $is_admin = FALSE; goto F0wyL; epNLn: j3xCS: goto tApuy; LRlWi: } protected function _get_hash_algo() { goto rn9do; rn9do: $algo = FALSE; goto kyvZ5; jGaGo: return $algo; goto RsNiQ; HmnKw: NRWGB: goto bOZpE; kyvZ5: switch ($this->hash_method) { case "\142\x63\162\171\160\164": $algo = PASSWORD_BCRYPT; goto jl3LR; case "\141\x72\x67\x6f\x6e\62": $algo = PASSWORD_ARGON2I; goto jl3LR; default: } goto HmnKw; bOZpE: jl3LR: goto jGaGo; RsNiQ: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto JDTli; v6a91: return (object) ["\x73\x65\154\x65\143\164\157\162" => $selector, "\166\141\x6c\x69\x64\141\164\157\x72\x5f\x68\141\163\150\145\x64" => $validator_hashed, "\165\163\145\x72\x5f\143\157\x64\145" => $user_code]; goto YAQIK; JDTli: $selector = $this->_random_token($selector_size); goto QUrl1; QUrl1: $validator = $this->_random_token($validator_size); goto uvDth; IXbLL: $user_code = "{$selector}\56{$validator}"; goto v6a91; uvDth: $validator_hashed = $this->hash_password($validator); goto IXbLL; YAQIK: } protected function _retrieve_selector_validator_couple($user_code) { goto X9YxQ; RHqM1: return FALSE; goto EicMN; dI3Wb: PYY7Z: goto RHqM1; hNbjL: return (object) ["\163\145\x6c\x65\143\x74\157\x72" => $tokens[0], "\166\x61\154\151\x64\141\164\x6f\x72" => $tokens[1]]; goto VOz1a; VOz1a: dCibV: goto dI3Wb; Bd3M0: if (!(count($tokens) === 2)) { goto dCibV; } goto hNbjL; X9YxQ: if (!$user_code) { goto PYY7Z; } goto OYzy_; OYzy_: $tokens = explode("\56", $user_code); goto Bd3M0; EicMN: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto nJStO; Zyxz6: return FALSE; goto pJC2p; fsVlV: return FALSE; goto Yw0mk; Yw0mk: SM_hZ: goto rPMzQ; M4QxP: if ($result) { goto RKWKR; } goto v1oK3; sG9Yt: goto bvcNl; goto ApkDR; CrbH5: if ($salt_length) { goto ZCcs2; } goto P7yAg; F8tnk: YTKoU: goto xjnUO; AROS8: bvcNl: goto ZOFYz; v1oK3: $this->trigger_events(["\160\157\163\x74\x5f\163\150\141\61\137\x70\x61\x73\x73\x77\157\x72\144\x5f\x6d\151\x67\162\x61\x74\x69\x6f\156", "\160\157\x73\164\137\x73\150\141\x31\x5f\x70\x61\163\163\167\x6f\162\144\137\155\x69\x67\x72\x61\164\151\157\156\137\165\156\x73\165\x63\x63\145\x73\163\146\x75\x6c"]); goto sG9Yt; nJStO: $this->trigger_events("\x70\x72\x65\137\163\150\x61\61\x5f\x70\141\x73\163\x77\x6f\162\144\137\155\x69\x67\x72\x61\164\151\157\156"); goto wIVPV; u6sy0: goto fnA_6; goto zrsQR; PVE9f: fnA_6: goto TCGJ2; hkNxA: ZCcs2: goto rewz7; rPMzQ: $hashed_password = sha1($password . $salt_db->salt); goto PVE9f; N8e9I: $result = $this->_set_password_db($identity, $password); goto M4QxP; FOJTG: cUO3O: goto N8e9I; Qtkex: $this->trigger_events(["\160\157\x73\164\x5f\x73\x68\141\x31\137\160\141\163\x73\167\157\x72\x64\137\x6d\151\x67\x72\x61\164\x69\x6f\156", "\x70\x6f\x73\164\x5f\x73\x68\x61\x31\x5f\x70\141\x73\163\167\x6f\x72\x64\137\155\151\147\x72\141\164\x69\157\156\x5f\x75\x6e\163\165\x63\x63\x65\163\163\146\x75\x6c"]); goto fsVlV; ZOFYz: return $result; goto F8tnk; H33ik: $salt_length = $this->config->item("\x73\x61\x6c\x74\137\x6c\x65\156\x67\164\150", "\x69\157\156\x5f\141\165\164\150"); goto CrbH5; pJC2p: goto YTKoU; goto FOJTG; k0JaA: if (!($query->num_rows() !== 1)) { goto SM_hZ; } goto Qtkex; zrsQR: jvzdh: goto c3dwB; ztsU9: $this->trigger_events(["\160\x6f\163\164\x5f\163\x68\141\61\x5f\x70\x61\x73\163\x77\157\x72\144\x5f\x6d\x69\147\162\x61\164\151\x6f\x6e", "\x70\x6f\163\x74\x5f\163\x68\141\x31\137\160\141\163\163\167\157\x72\144\137\155\x69\x67\x72\141\x74\x69\x6f\x6e\137\165\156\x73\x75\x63\143\145\163\163\146\x75\154"]); goto Zyxz6; CelgK: $salt_db = $query->row(); goto k0JaA; TCGJ2: if ($hashed_password === $hashed_password_db) { goto cUO3O; } goto ztsU9; wIVPV: if ($this->config->item("\x73\164\x6f\162\145\137\163\x61\x6c\164", "\x69\x6f\x6e\x5f\x61\165\164\x68")) { goto jvzdh; } goto H33ik; c3dwB: $query = $this->db->select("\163\x61\154\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\162\x73"]); goto CelgK; P7yAg: $this->trigger_events(["\x70\x6f\x73\x74\x5f\163\x68\x61\x31\x5f\x70\x61\163\163\x77\x6f\x72\144\137\x6d\151\147\x72\141\164\151\157\156", "\x70\157\163\x74\137\x73\150\141\x31\137\160\141\163\163\167\157\x72\144\137\x6d\151\147\x72\x61\164\x69\157\156\x5f\x75\x6e\x73\x75\x63\143\x65\163\x73\146\x75\154"]); goto o458i; vqts1: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto u6sy0; ApkDR: RKWKR: goto uZD1d; uZD1d: $this->trigger_events(["\160\157\x73\x74\x5f\x73\x68\x61\x31\137\160\x61\x73\163\167\157\162\144\137\155\x69\x67\x72\141\164\151\157\x6e", "\x70\x6f\163\164\x5f\163\x68\x61\x31\137\160\141\163\x73\x77\x6f\x72\144\137\x6d\x69\x67\162\141\x74\151\157\x6e\x5f\x73\x75\x63\x63\145\x73\x73\146\165\x6c"]); goto AROS8; rewz7: $salt = substr($hashed_password_db, 0, $salt_length); goto vqts1; o458i: return FALSE; goto hkNxA; xjnUO: } }
