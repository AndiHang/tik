<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\x53\x45\120\101\x54\110") or exit("\x4e\x6f\40\x64\x69\162\145\x63\164\40\163\x63\x72\x69\160\x74\40\141\143\143\x65\163\163\x20\141\154\x6c\157\x77\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto M9BhM; pLrBo: Zx4ZH: goto GcprE; foiOW: $this->messages = []; goto wBWl7; LMqj8: $this->hash_method = $this->config->item("\x68\x61\163\150\137\155\x65\x74\x68\157\x64", "\151\157\156\137\x61\165\164\x68"); goto foiOW; Xxqjv: $this->message_start_delimiter = $this->config->item("\155\145\x73\163\x61\147\145\x5f\x73\164\141\162\x74\137\x64\145\154\x69\155\151\x74\x65\162", "\x69\157\x6e\x5f\x61\x75\x74\x68"); goto PPMuh; M9BhM: $this->config->load("\x69\157\x6e\137\x61\x75\164\x68", TRUE); goto RHRxG; RHRxG: $this->load->helper("\x63\x6f\157\x6b\151\145"); goto tDWKE; IcJd8: $this->db = $this->load->database($group_name, TRUE, TRUE); goto Dy1Ec; ZeEu7: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto RWG41; tDWKE: $this->load->helper("\144\x61\x74\145"); goto KZmgS; I4AzP: VxtBr: goto K237Z; jLaPP: $error_prefix->setAccessible(TRUE); goto Ug7wH; qYLCo: $error_suffix->setAccessible(TRUE); goto ZeEu7; Ug7wH: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto iHKOy; KZmgS: $this->lang->load("\x69\157\x6e\137\x61\165\164\150"); goto j3Z9I; A0RWH: $error_suffix = $form_validation_class->getProperty("\137\x65\162\x72\x6f\x72\137\163\165\x66\146\151\170"); goto qYLCo; nIG46: $error_prefix = $form_validation_class->getProperty("\137\145\162\162\x6f\x72\137\160\x72\145\x66\151\170"); goto jLaPP; TWvEU: if ($delimiters_source === "\x66\x6f\x72\x6d\x5f\x76\x61\154\151\x64\141\164\x69\x6f\156") { goto XdMcz; } goto Xxqjv; N6ybq: $this->db = $CI->db; goto I4AzP; K237Z: $this->tables = $this->config->item("\164\141\x62\154\145\163", "\151\157\156\x5f\x61\165\164\150"); goto SDrbe; SQPoU: $this->trigger_events("\155\157\x64\x65\154\137\143\157\x6e\x73\x74\162\x75\x63\x74\157\x72"); goto alrzB; R9d0C: if (empty($group_name)) { goto vsqmu; } goto IcJd8; GcprE: $this->_ion_hooks = new stdClass(); goto SQPoU; M2XvA: $this->load->library("\x66\x6f\162\155\137\166\141\x6c\x69\x64\141\x74\151\157\x6e"); goto FWP9r; hDcZm: $this->join = $this->config->item("\152\x6f\x69\156", "\151\x6f\156\x5f\x61\x75\164\x68"); goto LMqj8; wBWl7: $this->errors = []; goto poFe7; PPMuh: $this->message_end_delimiter = $this->config->item("\x6d\x65\x73\163\141\147\145\137\x65\156\x64\x5f\144\x65\x6c\151\155\151\164\145\162", "\151\157\x6e\137\141\x75\x74\150"); goto vZezY; qtPz4: goto Zx4ZH; goto yPfS0; Dy1Ec: goto VxtBr; goto lOdHU; vZezY: $this->error_start_delimiter = $this->config->item("\x65\x72\162\x6f\162\137\x73\x74\141\x72\x74\x5f\144\x65\154\x69\155\x69\164\x65\x72", "\151\x6f\x6e\137\x61\165\164\x68"); goto Fl_Yg; j3Z9I: $group_name = $this->config->item("\x64\141\164\x61\142\141\163\x65\x5f\147\x72\x6f\x75\x70\x5f\156\x61\155\145", "\x69\x6f\x6e\x5f\141\x75\x74\x68"); goto R9d0C; Fl_Yg: $this->error_end_delimiter = $this->config->item("\x65\x72\162\x6f\162\137\x65\x6e\x64\x5f\144\x65\154\151\155\x69\x74\x65\162", "\x69\x6f\156\x5f\141\165\164\x68"); goto qtPz4; poFe7: $delimiters_source = $this->config->item("\144\x65\154\151\x6d\151\x74\x65\162\x73\x5f\x73\157\x75\x72\x63\145", "\151\157\156\137\x61\x75\164\150"); goto TWvEU; iHKOy: $this->message_start_delimiter = $this->error_start_delimiter; goto A0RWH; FVp0f: $CI =& get_instance(); goto N6ybq; SDrbe: $this->identity_column = $this->config->item("\151\x64\145\x6e\164\x69\164\x79", "\x69\157\156\x5f\x61\165\164\150"); goto hDcZm; yPfS0: XdMcz: goto M2XvA; FWP9r: $form_validation_class = new ReflectionClass("\103\111\137\106\x6f\x72\x6d\x5f\166\x61\154\x69\x64\141\x74\x69\157\156"); goto nIG46; lOdHU: vsqmu: goto FVp0f; RWG41: $this->message_end_delimiter = $this->error_end_delimiter; goto pLrBo; alrzB: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto P9pH4; P9pH4: if (!(empty($password) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto TfDXU; } goto rJM1k; Yd01c: return password_hash($password, $algo, $params); goto FJx_r; V2GtA: TfDXU: goto AWD8r; orw28: $params = $this->_get_hash_parameters($identity); goto oDrKT; oDrKT: if (!($algo !== FALSE && $params !== FALSE)) { goto xEkri; } goto Yd01c; pzf2x: return FALSE; goto jskd2; rJM1k: return FALSE; goto V2GtA; AWD8r: $algo = $this->_get_hash_algo(); goto orw28; FJx_r: xEkri: goto pzf2x; jskd2: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto UOF0f; i9UW4: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto utxNb; UOF0f: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto ectsg; } goto UUdri; k5AYQ: A08Nj: goto j7HH5; Ss4Ur: if (strpos($hash_password_db, "\x24") === 0) { goto YiNvU; } goto i9UW4; or_F7: return password_verify($password, $hash_password_db); goto k5AYQ; aCyp8: ectsg: goto Ss4Ur; utxNb: goto A08Nj; goto YEKnZ; UUdri: return FALSE; goto aCyp8; YEKnZ: YiNvU: goto or_F7; j7HH5: } public function rehash_password_if_needed($hash, $identity, $password) { goto t6JiV; OQHoU: L59l3: goto v2z5Y; oQ2LS: h19YG: goto QP0yl; jFeP9: if (!password_needs_rehash($hash, $algo, $params)) { goto Vua9H; } goto RK85M; t6JiV: $algo = $this->_get_hash_algo(); goto mtfvu; QP0yl: $this->trigger_events(["\162\145\x68\141\x73\x68\x5f\160\x61\x73\x73\167\157\x72\x64", "\162\x65\x68\x61\163\x68\137\160\x61\x73\x73\x77\x6f\162\x64\137\163\165\x63\143\x65\x73\163\146\165\154"]); goto OQHoU; dWvfy: $this->trigger_events(["\x72\145\150\141\x73\x68\x5f\160\x61\x73\163\167\157\162\144", "\x72\x65\x68\141\163\150\137\160\141\x73\163\x77\x6f\x72\144\137\165\156\x73\165\x63\143\145\163\163\146\165\x6c"]); goto Icbby; RK85M: if ($this->_set_password_db($identity, $password)) { goto h19YG; } goto dWvfy; mtfvu: $params = $this->_get_hash_parameters($identity); goto t0JVU; v2z5Y: Vua9H: goto k44FQ; k44FQ: BdrdG: goto MPvrC; Icbby: goto L59l3; goto oQ2LS; t0JVU: if (!($algo !== FALSE && $params !== FALSE)) { goto BdrdG; } goto jFeP9; MPvrC: } public function get_user_by_activation_code($user_code) { goto Pk7T_; u1SnM: Wj6Do: goto mvqeI; Pk7T_: $token = $this->_retrieve_selector_validator_couple($user_code); goto ZEnd8; mvqeI: bQy3l: goto BRL_V; BRL_V: return FALSE; goto aWdbJ; SnUiq: if (!$this->verify_password($token->validator, $user->activation_code)) { goto Wj6Do; } goto h9OXm; ZEnd8: $user = $this->where("\x61\143\x74\151\166\x61\164\151\157\x6e\x5f\x73\x65\x6c\x65\x63\x74\157\x72", $token->selector)->users()->row(); goto Ds2iZ; Ds2iZ: if (!$user) { goto bQy3l; } goto SnUiq; h9OXm: return $user; goto u1SnM; aWdbJ: } public function activate($id, $code = FALSE) { goto ZFj_U; c1gML: if (!($code === FALSE || $user && $user->id === $id)) { goto aNXvU; } goto UXXkA; UXXkA: $data = ["\x61\143\164\x69\166\141\164\151\x6f\156\137\x73\145\x6c\x65\x63\x74\x6f\162" => NULL, "\141\x63\x74\151\x76\141\x74\x69\157\x6e\137\x63\157\144\x65" => NULL, "\x61\x63\x74\151\166\x65" => 1]; goto rHieN; FJDwL: $this->trigger_events(["\160\x6f\163\x74\137\141\143\164\x69\x76\x61\164\x65", "\160\157\163\x74\137\141\143\164\151\166\x61\x74\x65\x5f\165\156\x73\165\x63\x63\x65\163\x73\x66\x75\x6c"]); goto ZjX3v; zsGfD: $this->set_message("\x61\143\164\x69\166\x61\164\x65\x5f\x73\x75\x63\x63\x65\163\x73\x66\x75\154"); goto sQNeV; sQNeV: return TRUE; goto H3Pnb; I2w4h: $user = $this->get_user_by_activation_code($code); goto dG2Ro; FKU45: $this->trigger_events(["\160\x6f\163\x74\137\141\x63\164\151\x76\141\x74\145", "\x70\157\x73\164\137\141\143\164\151\x76\x61\x74\145\x5f\163\x75\143\143\145\x73\163\146\x75\154"]); goto zsGfD; ZjX3v: $this->set_error("\x61\143\164\x69\x76\141\164\x65\137\x75\156\x73\165\143\143\x65\163\x73\146\165\x6c"); goto q4Nop; dG2Ro: X1_O2: goto c1gML; oFH6b: if (!($code !== FALSE)) { goto X1_O2; } goto I2w4h; r6cBM: $this->db->update($this->tables["\165\x73\145\162\163"], $data, ["\x69\144" => $id]); goto JsvC6; JsvC6: if (!($this->db->affected_rows() === 1)) { goto T6fPV; } goto FKU45; H3Pnb: T6fPV: goto aZ1fM; rHieN: $this->trigger_events("\145\x78\164\x72\141\x5f\x77\x68\145\x72\x65"); goto r6cBM; ZFj_U: $this->trigger_events("\x70\162\145\x5f\x61\143\164\x69\166\141\x74\145"); goto oFH6b; q4Nop: return FALSE; goto UlmtZ; aZ1fM: aNXvU: goto FJDwL; UlmtZ: } public function deactivate($id = NULL) { goto FViCH; X59VR: $token = $this->_generate_selector_validator_couple(20, 40); goto aWsTo; jK2Aa: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], $data, ["\151\144" => $id]); goto xDcri; FViCH: $this->trigger_events("\x64\145\141\x63\x74\151\x76\x61\x74\x65"); goto ji1VH; TS12X: return FALSE; goto xukxR; KuEa1: return FALSE; goto ltrKP; Vfwtm: $this->set_error("\144\x65\141\143\164\x69\x76\141\164\145\x5f\x75\x6e\x73\x75\143\x63\145\x73\163\x66\165\154"); goto YuOdu; iHDxu: InOfz: goto Wyf_d; QYaN1: return $return; goto nOATa; a0QmY: $this->set_error("\x64\145\x61\x63\164\x69\x76\141\164\145\137\143\x75\162\162\145\156\x74\137\x75\163\145\162\137\165\156\x73\165\x63\x63\x65\x73\163\x66\165\x6c"); goto TS12X; ji1VH: if (!isset($id)) { goto InOfz; } goto J2OEU; r3wlF: if ($return) { goto xD1Uk; } goto Vfwtm; YuOdu: goto EqcGX; goto VF_Y8; aWsTo: $this->activation_code = $token->user_code; goto oIdLt; NfIwv: $this->trigger_events("\x65\170\x74\x72\x61\x5f\167\x68\x65\x72\145"); goto jK2Aa; l02r2: goto STtaW; goto iHDxu; Wyf_d: $this->set_error("\144\x65\x61\x63\164\151\x76\141\164\145\137\x75\x6e\163\x75\143\143\145\163\x73\x66\165\154"); goto KuEa1; xDcri: $return = $this->db->affected_rows() == 1; goto r3wlF; VF_Y8: xD1Uk: goto ZmGjg; xukxR: wQFgh: goto l02r2; ltrKP: STtaW: goto X59VR; ZmGjg: $this->set_message("\x64\145\x61\143\x74\151\166\x61\x74\145\137\x73\x75\143\143\x65\163\163\x66\165\154"); goto fAKoR; J2OEU: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto wQFgh; } goto a0QmY; fAKoR: EqcGX: goto QYaN1; oIdLt: $data = ["\141\143\164\151\166\x61\164\151\x6f\156\137\163\x65\154\x65\x63\x74\157\162" => $token->selector, "\141\x63\164\151\x76\x61\164\151\157\x6e\137\143\x6f\144\x65" => $token->validator_hashed, "\x61\x63\164\x69\x76\145" => 0]; goto NfIwv; nOATa: } public function clear_forgotten_password_code($identity) { goto zueA1; QnigY: $this->db->update($this->tables["\x75\x73\x65\x72\x73"], $data, [$this->identity_column => $identity]); goto LDh2a; by32N: GnH2s: goto Z4p30; zueA1: if (!empty($identity)) { goto GnH2s; } goto YUEHs; LDh2a: return TRUE; goto Z3_g1; Z4p30: $data = ["\146\x6f\x72\147\157\x74\164\145\x6e\x5f\x70\x61\x73\x73\167\157\162\144\x5f\163\x65\154\x65\x63\x74\x6f\x72" => NULL, "\x66\x6f\x72\x67\x6f\164\164\145\x6e\137\x70\x61\x73\163\x77\157\162\x64\137\143\x6f\x64\145" => NULL, "\146\x6f\x72\147\157\164\x74\x65\156\137\160\x61\x73\163\167\157\x72\x64\x5f\164\x69\x6d\145" => NULL]; goto QnigY; YUEHs: return FALSE; goto by32N; Z3_g1: } public function clear_remember_code($identity) { goto eCcwC; OX8ji: return TRUE; goto ZGMny; EX6zo: return FALSE; goto Z2vDW; hkUP6: $this->db->update($this->tables["\x75\x73\145\162\x73"], $data, [$this->identity_column => $identity]); goto OX8ji; Z2vDW: demHE: goto LE6H5; eCcwC: if (!empty($identity)) { goto demHE; } goto EX6zo; LE6H5: $data = ["\x72\145\x6d\x65\x6d\x62\145\x72\137\163\145\x6c\x65\x63\x74\157\162" => NULL, "\162\145\155\145\x6d\142\x65\162\x5f\x63\157\x64\145" => NULL]; goto hkUP6; ZGMny: } public function reset_password($identity, $new) { goto dAUw3; DI4Hx: goto IXw3k; goto a0IKa; kAusG: return FALSE; goto r8b62; dbTy6: $this->trigger_events(["\x70\x6f\163\164\x5f\x63\150\141\156\147\145\x5f\x70\141\163\x73\167\x6f\x72\144", "\x70\x6f\163\164\137\143\x68\141\x6e\x67\x65\x5f\160\141\163\x73\167\157\162\144\137\x73\x75\143\143\145\x73\163\x66\x75\154"]); goto enKLp; lVl0X: $this->trigger_events(["\x70\x6f\x73\164\137\143\150\x61\156\x67\x65\x5f\x70\141\x73\163\x77\157\162\x64", "\x70\x6f\163\164\x5f\x63\x68\x61\x6e\x67\145\137\160\141\x73\163\167\157\162\144\137\165\156\x73\x75\x63\143\145\163\x73\146\165\154"]); goto XOXub; abd9b: $return = $this->_set_password_db($identity, $new); goto Wruyw; vZAQQ: $this->trigger_events(["\x70\157\163\164\x5f\x63\x68\x61\x6e\x67\145\137\160\x61\163\163\x77\x6f\x72\x64", "\160\157\x73\x74\137\143\150\x61\x6e\147\x65\x5f\160\141\163\163\x77\157\162\x64\x5f\x75\x6e\163\165\x63\x63\145\163\x73\x66\165\x6c"]); goto kAusG; XOXub: $this->set_error("\x70\x61\163\163\167\x6f\162\144\x5f\143\x68\x61\156\x67\x65\x5f\165\156\163\165\143\143\x65\163\163\146\165\154"); goto DI4Hx; Rnb9G: return $return; goto qr8H1; TZPB5: IXw3k: goto Rnb9G; a0IKa: V3j3m: goto dbTy6; A6Z7w: if ($this->identity_check($identity)) { goto E20bS; } goto vZAQQ; enKLp: $this->set_message("\160\x61\163\x73\167\x6f\162\x64\137\x63\150\x61\x6e\x67\145\x5f\163\165\143\143\145\x73\x73\x66\165\x6c"); goto TZPB5; r8b62: E20bS: goto abd9b; dAUw3: $this->trigger_events("\x70\162\x65\137\x63\150\x61\156\x67\145\137\160\x61\x73\163\x77\x6f\162\x64"); goto A6Z7w; Wruyw: if ($return) { goto V3j3m; } goto lVl0X; qr8H1: } public function change_password($identity, $old, $new) { goto L9V9_; T4_eF: return FALSE; goto Kfrgf; fCOx4: UX0c8: goto oAvCR; rmFiC: if ($result) { goto UX0c8; } goto zLqP5; zMXmO: $result = $this->_set_password_db($identity, $new); goto rmFiC; DVvdM: goto Xzb7h; goto fCOx4; qCCQu: return FALSE; goto wJUV9; szVgT: $this->set_error("\x70\141\x73\x73\x77\x6f\x72\x64\x5f\x63\x68\141\156\147\145\137\x75\156\x73\165\x63\x63\x65\x73\163\146\165\154"); goto DVvdM; MnH_m: SpQcn: goto beJHs; Kfrgf: iANW1: goto JfCAh; JFTnM: $this->set_error("\x70\x61\x73\x73\x77\157\162\144\x5f\x63\x68\141\156\147\x65\137\165\x6e\x73\x75\x63\143\145\163\x73\x66\x75\154"); goto T4_eF; beJHs: $this->set_error("\160\141\163\163\167\x6f\162\144\137\143\x68\141\156\147\145\137\x75\156\x73\165\x63\143\x65\x73\x73\146\165\154"); goto qCCQu; gEKEj: if (!($query->num_rows() !== 1)) { goto iANW1; } goto Gmctm; JfCAh: $user = $query->row(); goto SDaP2; SDaP2: if (!$this->verify_password($old, $user->password, $identity)) { goto SpQcn; } goto zMXmO; c508o: $this->trigger_events("\x65\170\164\162\141\137\x77\x68\x65\162\145"); goto tc9oV; zLqP5: $this->trigger_events(["\x70\x6f\x73\164\x5f\143\x68\x61\156\x67\145\137\160\141\x73\x73\167\x6f\x72\x64", "\x70\x6f\x73\164\137\143\150\141\156\147\145\x5f\x70\141\163\163\167\x6f\x72\144\137\x75\156\163\165\x63\x63\x65\x73\163\146\x75\x6c"]); goto szVgT; I7d_d: return $result; goto MnH_m; L9V9_: $this->trigger_events("\160\162\145\x5f\143\150\141\156\x67\145\137\x70\141\x73\163\167\157\162\x64"); goto c508o; oAvCR: $this->trigger_events(["\160\x6f\x73\164\x5f\x63\150\141\156\x67\x65\x5f\160\x61\x73\x73\x77\157\x72\x64", "\160\157\163\x74\137\x63\150\x61\156\147\145\x5f\x70\141\163\x73\167\157\x72\x64\x5f\x73\165\x63\x63\145\x73\x73\x66\165\154"]); goto OpQre; tc9oV: $query = $this->db->select("\x69\x64\x2c\40\160\x61\x73\x73\167\x6f\162\144")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\x64\x65\163\143")->get($this->tables["\x75\x73\145\x72\163"]); goto gEKEj; Gmctm: $this->trigger_events(["\x70\157\163\x74\x5f\x63\150\141\156\147\145\137\160\141\x73\x73\167\x6f\162\x64", "\x70\x6f\163\x74\137\x63\150\x61\x6e\x67\x65\x5f\160\141\163\163\167\x6f\162\144\137\165\156\163\x75\x63\143\x65\x73\163\146\165\x6c"]); goto JFTnM; BxnuO: Xzb7h: goto I7d_d; OpQre: $this->set_message("\160\x61\163\x73\x77\157\162\144\x5f\x63\150\x61\156\x67\x65\x5f\163\165\143\x63\x65\163\x73\x66\165\x6c"); goto BxnuO; wJUV9: } public function username_check($username = '') { goto MTW_4; Dc_B5: $this->trigger_events("\145\x78\x74\x72\141\x5f\x77\150\x65\162\x65"); goto MFHoq; N71En: return FALSE; goto vCBtA; MTW_4: $this->trigger_events("\165\x73\145\x72\156\x61\x6d\145\137\x63\x68\x65\143\153"); goto NZnFH; vCBtA: ByvNo: goto Dc_B5; NZnFH: if (!empty($username)) { goto ByvNo; } goto N71En; MFHoq: return $this->db->where("\165\163\x65\x72\156\x61\x6d\x65", $username)->limit(1)->count_all_results($this->tables["\x75\x73\145\162\x73"]) > 0; goto Wn3zH; Wn3zH: } public function email_check($email = '') { goto r19zz; K0q_r: $this->trigger_events("\x65\170\164\162\141\137\x77\x68\145\162\x65"); goto I0qtx; a0Cuf: return FALSE; goto gKSti; gKSti: JXM9q: goto K0q_r; r19zz: $this->trigger_events("\x65\x6d\141\151\x6c\137\143\150\x65\x63\x6b"); goto LHwtq; LHwtq: if (!empty($email)) { goto JXM9q; } goto a0Cuf; I0qtx: return $this->db->where("\145\x6d\x61\151\154", $email)->limit(1)->count_all_results($this->tables["\165\163\145\x72\163"]) > 0; goto gMnt8; gMnt8: } public function identity_check($identity = '') { goto V43Po; fWDLh: return FALSE; goto Svqjm; DA82x: if (!empty($identity)) { goto Y3dl2; } goto fWDLh; V43Po: $this->trigger_events("\x69\144\145\x6e\164\151\164\x79\137\143\x68\145\x63\x6b"); goto DA82x; Svqjm: Y3dl2: goto pgqL9; pgqL9: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\x73\145\162\163"]) > 0; goto D4tpu; D4tpu: } public function get_user_id_from_identity($identity = '') { goto fEWNi; s8SL4: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\145\162\x73"]); goto GRN6a; RKXQT: return $user->id; goto FVIrS; tIBVr: lWqqv: goto RGsb3; GRN6a: if (!($query->num_rows() !== 1)) { goto lWqqv; } goto n_ipB; RGsb3: $user = $query->row(); goto RKXQT; vU4TE: return FALSE; goto L4TZp; L4TZp: SziGa: goto s8SL4; fEWNi: if (!empty($identity)) { goto SziGa; } goto vU4TE; n_ipB: return FALSE; goto tIBVr; FVIrS: } public function forgotten_password($identity) { goto gVFcp; p9Jn_: return FALSE; goto lF301; yFPg0: PYySY: goto Vs1e1; qfV4W: ujtqD: goto FeTDT; s3U0q: jUKCB: goto On2ps; gVFcp: if (!empty($identity)) { goto PYySY; } goto ysLi6; LjMa4: $this->trigger_events(["\160\x6f\x73\x74\x5f\x66\x6f\x72\147\157\x74\x74\145\x6e\137\x70\141\x73\163\x77\x6f\162\144", "\160\x6f\163\164\137\146\x6f\162\147\x6f\x74\x74\x65\x6e\x5f\x70\x61\x73\x73\x77\157\x72\144\137\x75\156\163\x75\x63\143\x65\x73\163\146\x75\154"]); goto p9Jn_; ysLi6: $this->trigger_events(["\160\x6f\163\164\137\146\x6f\162\147\157\x74\164\145\156\137\160\x61\x73\x73\167\157\162\x64", "\160\x6f\x73\x74\137\x66\x6f\162\147\157\164\164\145\156\x5f\160\x61\163\163\x77\157\x72\x64\x5f\165\156\163\165\143\x63\145\x73\163\x66\165\154"]); goto OCXc1; epLC4: $this->trigger_events("\x65\x78\164\162\141\x5f\167\150\x65\162\x65"); goto GsfHN; gz7cP: $update = ["\x66\157\162\147\157\164\x74\x65\156\x5f\160\141\163\163\x77\157\162\x64\x5f\163\145\x6c\145\x63\x74\157\162" => $token->selector, "\146\x6f\x72\147\157\x74\x74\x65\156\x5f\x70\x61\163\163\x77\157\x72\x64\137\143\157\144\145" => $token->validator_hashed, "\146\x6f\x72\147\x6f\x74\x74\x65\x6e\x5f\160\141\163\x73\167\x6f\x72\144\x5f\164\151\x6d\x65" => time()]; goto epLC4; lF301: goto ujtqD; goto s3U0q; BwQX1: return $token->user_code; goto qfV4W; OCXc1: return FALSE; goto yFPg0; VuCX4: if ($this->db->affected_rows() === 1) { goto jUKCB; } goto LjMa4; GsfHN: $this->db->update($this->tables["\x75\163\145\162\x73"], $update, [$this->identity_column => $identity]); goto VuCX4; On2ps: $this->trigger_events(["\x70\157\163\x74\137\146\x6f\162\147\157\164\164\145\156\x5f\160\141\x73\163\x77\x6f\x72\x64", "\160\x6f\163\x74\x5f\x66\x6f\162\147\x6f\x74\x74\145\x6e\137\x70\141\x73\163\167\157\162\144\137\163\165\143\143\x65\163\x73\146\x75\x6c"]); goto BwQX1; Vs1e1: $token = $this->_generate_selector_validator_couple(20, 80); goto gz7cP; FeTDT: } public function get_user_by_forgotten_password_code($user_code) { goto N62H0; dSeFl: $user = $this->where("\x66\157\x72\x67\x6f\164\164\145\156\x5f\x70\141\x73\163\167\157\x72\144\137\163\145\154\145\143\x74\x6f\162", $token->selector)->users()->row(); goto MXr3b; N62H0: $token = $this->_retrieve_selector_validator_couple($user_code); goto dSeFl; XqI5m: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto apdc8; } goto eOQx7; ZA07o: yh9Fl: goto GAPcu; GAPcu: return FALSE; goto zYFbk; mH9Cl: apdc8: goto ZA07o; MXr3b: if (!$user) { goto yh9Fl; } goto XqI5m; eOQx7: return $user; goto mH9Cl; zYFbk: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto OuH4E; OuH4E: $this->trigger_events("\x70\x72\145\137\162\x65\147\x69\x73\x74\x65\x72"); goto iFYtE; WdeGL: $user_data = array_merge($this->_filter_data($this->tables["\165\163\145\x72\163"], $additional_data), $data); goto qDwmC; CGQDh: $this->trigger_events("\160\x6f\x73\x74\137\162\x65\147\x69\163\x74\145\162"); goto xmWm0; utaMq: return FALSE; goto OJJJR; Yr211: $query = $this->db->get_where($this->tables["\147\x72\157\x75\160\163"], ["\x6e\141\155\x65" => $this->config->item("\144\145\x66\x61\165\154\164\x5f\x67\x72\157\x75\x70", "\x69\x6f\156\x5f\x61\x75\x74\150")], 1)->row(); goto HuIg7; HMX4l: $groups[] = $default_group->id; goto lJ0n6; xmWm0: return isset($id) ? $id : FALSE; goto IcHlN; qDwmC: $this->trigger_events("\145\170\x74\162\141\x5f\163\145\x74"); goto pQbv1; iFYtE: $manual_activation = $this->config->item("\x6d\141\x6e\x75\x61\x6c\x5f\141\143\x74\x69\x76\141\x74\x69\x6f\156", "\x69\x6f\156\137\141\165\164\150"); goto x3Fi8; UtWi1: return FALSE; goto iMr8r; OJJJR: NR6Qk: goto u_48C; u_48C: $default_group = $query; goto Uom95; Uom95: $ip_address = $this->input->ip_address(); goto Xky4X; m0bRm: if (!($password === FALSE)) { goto eoIgW; } goto G9OHy; Xky4X: $password = $this->hash_password($password); goto m0bRm; pQbv1: $this->db->insert($this->tables["\165\x73\x65\162\163"], $user_data); goto cUce_; x3Fi8: if ($this->identity_check($identity)) { goto iiSkA; } goto zktDw; HuIg7: if (!(!isset($query->id) && empty($groups))) { goto NR6Qk; } goto wNTUI; G9OHy: $this->set_error("\x61\143\143\157\x75\156\x74\x5f\x63\x72\145\x61\164\151\x6f\x6e\137\165\x6e\163\x75\143\x63\x65\x73\x73\146\x75\x6c"); goto vtfpl; zktDw: if (!(!$this->config->item("\144\145\x66\141\165\154\164\x5f\x67\x72\157\165\160", "\151\157\156\137\x61\165\164\x68") && empty($groups))) { goto Wz3h0; } goto rY1fg; Hd1QV: foreach ($groups as $group) { $this->add_to_group($group, $id); cpjYI: } goto Icv3Q; wORos: D2XlK: goto CGQDh; FeA4H: eoIgW: goto nqBQj; vtfpl: return FALSE; goto FeA4H; nqBQj: $data = [$this->identity_column => $identity, "\165\163\145\162\156\x61\x6d\145" => $identity, "\160\x61\x73\x73\167\x6f\162\144" => $password, "\x65\x6d\x61\151\154" => $email, "\151\x70\x5f\x61\x64\x64\x72\145\163\x73" => $ip_address, "\x63\162\145\141\x74\x65\x64\x5f\x6f\x6e" => time(), "\x61\x63\164\151\166\x65" => $manual_activation === FALSE ? 1 : 0]; goto WdeGL; wNTUI: $this->set_error("\x61\x63\143\x6f\x75\156\164\137\x63\x72\145\x61\x74\x69\x6f\156\137\x69\x6e\166\141\154\x69\x64\x5f\x64\145\146\141\165\x6c\x74\x5f\147\162\157\x75\x70"); goto utaMq; iMr8r: OZgHC: goto Yr211; r6Aah: if (empty($groups)) { goto D2XlK; } goto Hd1QV; W9sAF: if (!(isset($default_group->id) && empty($groups))) { goto rXCAV; } goto HMX4l; y4Wl7: Wz3h0: goto J6JVO; bLfIG: $this->set_error("\x61\143\x63\157\165\x6e\164\137\x63\x72\x65\141\x74\x69\157\x6e\x5f\144\x75\x70\154\151\143\141\164\x65\x5f\x69\144\x65\x6e\x74\x69\x74\171"); goto UtWi1; lJ0n6: rXCAV: goto r6Aah; Dnsdn: return FALSE; goto y4Wl7; J6JVO: goto OZgHC; goto rm9Mp; Icv3Q: RCnAG: goto wORos; rY1fg: $this->set_error("\x61\x63\143\x6f\165\156\164\137\x63\162\145\x61\164\151\157\156\x5f\155\x69\x73\x73\151\x6e\147\x5f\x64\x65\146\x61\x75\154\164\x5f\x67\162\x6f\165\x70"); goto Dnsdn; cUce_: $id = $this->db->insert_id($this->tables["\165\x73\145\162\163"] . "\x5f\151\x64\x5f\163\x65\161"); goto W9sAF; rm9Mp: iiSkA: goto bLfIG; IcHlN: } public function login($identity, $password, $remember = FALSE) { goto Sx8dY; CJ7FH: $user = $query->row(); goto l0eyy; dnvPX: tCfQF: goto RS3qR; Sx8dY: $this->trigger_events("\160\x72\x65\137\x6c\157\x67\x69\156"); goto Uc_oh; nMWlr: $this->update_last_login($user->id); goto dGOBu; AV8ZL: prh9D: goto AP0V0; Y4o1w: $this->trigger_events("\160\x6f\163\164\137\154\x6f\147\x69\156\x5f\165\156\x73\x75\143\143\x65\163\163\x66\x75\154"); goto D7oI3; xBPFc: $this->set_message("\154\x6f\x67\151\x6e\x5f\163\x75\x63\143\145\x73\x73\x66\x75\x6c"); goto LpXLw; LpXLw: return TRUE; goto zSpSH; ABuvd: $this->trigger_events("\x70\157\x73\x74\x5f\x6c\157\x67\151\156\137\x75\x6e\163\165\x63\x63\x65\x73\x73\x66\165\154"); goto biUSK; l0eyy: if (!$this->verify_password($password, $user->password, $identity)) { goto RmENo; } goto EzbvF; k838n: WZ7P6: goto AV8ZL; oOIZU: if (!($query->num_rows() === 1)) { goto Tg0x6; } goto CJ7FH; Uc_oh: if (!(empty($identity) || empty($password))) { goto tCfQF; } goto dZKfD; N02cZ: $this->remember_user($identity); goto k838n; wzAB2: goto WZ7P6; goto JatlM; AP0V0: $this->rehash_password_if_needed($user->password, $identity, $password); goto eHZSl; PX6ge: $this->set_error("\x6c\x6f\147\x69\x6e\137\x74\x69\x6d\145\157\165\164"); goto DCaI7; gCHG5: $this->clear_remember_code($identity); goto wzAB2; eHZSl: $this->session->sess_regenerate(FALSE); goto v8wYv; DRz9h: $this->hash_password($password); goto ohQy3; D7oI3: $this->set_error("\x6c\157\147\151\156\137\165\x6e\x73\x75\x63\143\145\163\x73\146\x75\154"); goto j0NXN; zSpSH: RmENo: goto l3Znh; n73X0: $this->hash_password($password); goto uwWoM; v8wYv: $this->trigger_events(["\160\x6f\163\164\x5f\x6c\x6f\x67\x69\x6e", "\160\157\163\164\137\154\x6f\x67\151\x6e\x5f\163\165\x63\x63\x65\163\x73\x66\165\x6c"]); goto xBPFc; aDHJu: return FALSE; goto dnvPX; X3pPw: $this->clear_forgotten_password_code($identity); goto qIVe3; mZAtj: z6Spu: goto wS31M; pTkzX: FrwGw: goto oOIZU; DyKJ8: if ($remember) { goto TVbe1; } goto gCHG5; RS3qR: $this->trigger_events("\145\x78\164\x72\x61\137\x77\x68\145\162\x65"); goto vWsTm; l3Znh: Tg0x6: goto DRz9h; EzbvF: if (!($user->active == 0)) { goto z6Spu; } goto ABuvd; ohQy3: $this->increase_login_attempts($identity); goto Y4o1w; biUSK: $this->set_error("\x6c\x6f\x67\x69\156\x5f\x75\156\163\x75\143\x63\x65\163\163\146\x75\x6c\137\x6e\x6f\x74\x5f\x61\143\164\x69\166\x65"); goto UHOQw; uwWoM: $this->trigger_events("\160\x6f\163\164\x5f\154\x6f\x67\151\x6e\137\165\156\163\x75\143\x63\x65\163\163\146\x75\x6c"); goto PX6ge; j0NXN: return FALSE; goto XVcTL; JatlM: TVbe1: goto N02cZ; dGOBu: $this->clear_login_attempts($identity); goto X3pPw; wS31M: $this->set_session($user); goto nMWlr; DCaI7: return FALSE; goto pTkzX; vWsTm: $query = $this->db->select($this->identity_column . "\54\x20\x65\x6d\x61\151\x6c\x2c\40\151\144\54\x20\x70\x61\x73\x73\167\157\162\144\x2c\40\141\143\164\x69\x76\x65\54\x20\x6c\x61\163\x74\137\x6c\x6f\147\151\156")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\144", "\x64\x65\x73\x63")->get($this->tables["\165\x73\x65\x72\163"]); goto yjZEt; UHOQw: return FALSE; goto mZAtj; dZKfD: $this->set_error("\x6c\x6f\147\x69\156\137\x75\x6e\x73\x75\143\x63\x65\163\163\x66\x75\154"); goto aDHJu; yjZEt: if (!$this->is_max_login_attempts_exceeded($identity)) { goto FrwGw; } goto n73X0; qIVe3: if (!$this->config->item("\162\x65\x6d\x65\x6d\x62\x65\162\x5f\165\163\x65\x72\163", "\151\157\x6e\137\141\165\x74\x68")) { goto prh9D; } goto DyKJ8; XVcTL: } public function recheck_session() { goto Spdan; A5WNk: return FALSE; goto a4P66; a4P66: goto lA93j; goto NjhUO; WLB_D: lJJv6: goto JPbR4; Spdan: $recheck = NULL !== $this->config->item("\x72\145\143\150\x65\x63\153\137\x74\x69\x6d\x65\162", "\151\x6f\156\x5f\141\165\x74\x68") ? $this->config->item("\162\145\143\150\145\x63\153\137\x74\x69\155\145\162", "\x69\157\156\x5f\141\x75\x74\x68") : 0; goto SV0C5; IFwSX: if ($query->num_rows() === 1) { goto RaGJE; } goto Lvd2_; hfb60: $this->session->unset_userdata([$identity, "\x69\144", "\x75\x73\145\x72\x5f\x69\144"]); goto A5WNk; NjhUO: RaGJE: goto GGk_9; JPbR4: BBq1q: goto U1j9z; sZycX: $identity = $this->config->item("\x69\x64\145\x6e\164\151\x74\x79", "\151\157\x6e\x5f\x61\x75\x74\x68"); goto hfb60; SV0C5: if (!($recheck !== 0)) { goto BBq1q; } goto Feb3f; fBxNR: $query = $this->db->select("\x69\x64")->where([$this->identity_column => $this->session->userdata("\151\x64\x65\156\x74\151\x74\171"), "\141\x63\164\151\x76\145" => "\x31"])->limit(1)->order_by("\x69\144", "\x64\x65\163\143")->get($this->tables["\x75\163\145\x72\163"]); goto IFwSX; GGk_9: $this->session->set_userdata("\x6c\141\x73\164\137\143\x68\145\x63\153", time()); goto IyTYH; Lvd2_: $this->trigger_events("\154\x6f\147\x6f\165\164"); goto sZycX; U1j9z: return (bool) $this->session->userdata("\151\144\145\x6e\164\x69\x74\x79"); goto O1ULk; fx5ym: if (!($last_login + $recheck < time())) { goto lJJv6; } goto fBxNR; Feb3f: $last_login = $this->session->userdata("\x6c\x61\x73\164\x5f\x63\x68\x65\x63\x6b"); goto fx5ym; IyTYH: lA93j: goto WLB_D; O1ULk: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto kI98y; G1wHq: fv4Bf: goto k_avW; k_avW: return FALSE; goto HchIJ; Rl9j0: $attempts = $this->get_attempts_num($identity, $ip_address); goto MFpQN; frJbG: $max_attempts = $this->config->item("\155\141\x78\151\155\x75\155\x5f\154\157\147\151\156\x5f\x61\164\x74\x65\155\160\164\163", "\151\157\156\x5f\141\165\164\x68"); goto DXTyV; MFpQN: return $attempts >= $max_attempts; goto xzqdA; xzqdA: K3Kzp: goto G1wHq; kI98y: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\x6c\x6f\147\151\x6e\137\x61\x74\x74\145\155\160\164\163", "\151\x6f\x6e\x5f\x61\x75\x74\150")) { goto fv4Bf; } goto frJbG; DXTyV: if (!($max_attempts > 0)) { goto K3Kzp; } goto Rl9j0; HchIJ: } public function get_attempts_num($identity, $ip_address = NULL) { goto FR4an; lFpys: R310X: goto xTRHk; pqrsk: wJa2o: goto OfBqH; OrIie: $this->db->select("\x31", FALSE); goto CPMmI; OfBqH: return 0; goto ZatqO; N6v8c: if (!$this->config->item("\164\162\x61\x63\153\137\x6c\x6f\x67\151\156\137\x69\160\x5f\x61\144\x64\162\145\163\163", "\x69\157\x6e\137\141\165\x74\150")) { goto R310X; } goto H2hfv; NRDIY: $this->db->where("\x69\160\x5f\141\144\x64\162\x65\x73\x73", $ip_address); goto lFpys; hoMFc: qbfEL: goto NRDIY; y_zd2: return $qres->num_rows(); goto pqrsk; FR4an: if (!$this->config->item("\164\162\141\x63\153\x5f\x6c\157\147\x69\156\137\141\x74\x74\x65\155\x70\164\x73", "\x69\x6f\x6e\x5f\141\x75\x74\150")) { goto wJa2o; } goto OrIie; Wr4V3: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\x5f\x61\x74\x74\145\155\160\x74\163"]); goto y_zd2; pbx9q: $ip_address = $this->input->ip_address(); goto hoMFc; CPMmI: $this->db->where("\154\157\x67\151\x6e", $identity); goto N6v8c; xTRHk: $this->db->where("\x74\151\155\x65\x20\x3e", time() - $this->config->item("\x6c\x6f\x63\x6b\x6f\x75\x74\137\164\x69\x6d\x65", "\x69\x6f\x6e\137\x61\165\164\x68"), FALSE); goto Wr4V3; H2hfv: if (isset($ip_address)) { goto qbfEL; } goto pbx9q; ZatqO: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto TmgRg; AKv3b: LOS02: goto MJ7m3; h9u5Z: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\x6c\157\147\x69\x6e\137\x69\160\137\141\144\144\x72\x65\163\x73", "\151\157\156\137\x61\165\164\x68")) { goto JA6zl; } goto MDb15; CrePp: if (!($qres->num_rows() > 0)) { goto LOS02; } goto RDcD3; WBNDs: $this->db->where("\151\160\137\141\144\x64\x72\x65\x73\x73", $ip_address); goto vQW9n; hUQEq: $this->db->where("\154\157\147\x69\156", $identity); goto h9u5Z; pUSVc: ITyoX: goto WBNDs; MJ7m3: nnTnO: goto wtU84; OAhQw: $qres = $this->db->get($this->tables["\x6c\x6f\x67\x69\156\x5f\141\x74\x74\x65\x6d\160\164\163"], 1); goto CrePp; vQW9n: JA6zl: goto hyCPf; MDb15: if (isset($ip_address)) { goto ITyoX; } goto ZXztu; ZXztu: $ip_address = $this->input->ip_address(); goto pUSVc; hyCPf: $this->db->order_by("\x69\x64", "\144\145\x73\143"); goto OAhQw; wtU84: return 0; goto A77xL; RDcD3: return $qres->row()->time; goto AKv3b; CpDl4: $this->db->select("\x74\x69\155\145"); goto hUQEq; TmgRg: if (!$this->config->item("\164\162\141\143\153\137\154\x6f\147\x69\x6e\137\141\164\164\x65\155\160\x74\163", "\x69\157\156\137\x61\x75\x74\150")) { goto nnTnO; } goto CpDl4; A77xL: } public function get_last_attempt_ip($identity) { goto ghmy6; VWYJG: K2Bva: goto PhhAA; xYYon: return ''; goto sLUsS; ghmy6: if (!($this->config->item("\x74\x72\141\143\153\137\154\157\147\x69\x6e\137\141\x74\x74\x65\x6d\160\164\163", "\151\157\x6e\x5f\141\165\x74\x68") && $this->config->item("\x74\x72\141\x63\153\137\154\157\x67\151\x6e\137\x69\160\137\x61\144\144\162\145\163\x73", "\x69\157\x6e\x5f\x61\x75\x74\150"))) { goto arKCa; } goto EnS3G; irpFQ: return $qres->row()->ip_address; goto VWYJG; PhhAA: arKCa: goto xYYon; EnS3G: $this->db->select("\151\160\x5f\x61\x64\144\x72\x65\163\163"); goto QaPsD; hZTYe: if (!($qres->num_rows() > 0)) { goto K2Bva; } goto irpFQ; QaPsD: $this->db->where("\154\x6f\147\x69\156", $identity); goto QsSwx; uHQKQ: $qres = $this->db->get($this->tables["\154\157\147\151\x6e\137\141\x74\164\145\155\160\x74\x73"], 1); goto hZTYe; QsSwx: $this->db->order_by("\151\144", "\x64\x65\163\x63"); goto uHQKQ; sLUsS: } public function increase_login_attempts($identity) { goto m_ipH; DQal2: LOAGU: goto qzRyo; bxmmb: return FALSE; goto CfnW8; cpmQ2: $data["\x69\x70\x5f\141\x64\144\162\145\x73\163"] = $this->input->ip_address(); goto DQal2; m_ipH: if (!$this->config->item("\x74\162\141\143\153\137\x6c\157\x67\x69\x6e\137\x61\164\x74\145\155\x70\164\163", "\x69\157\x6e\x5f\141\x75\x74\x68")) { goto gWPmH; } goto D0LDy; Ve0mp: if (!$this->config->item("\x74\x72\141\143\x6b\137\x6c\157\x67\151\156\x5f\x69\x70\x5f\x61\x64\x64\162\145\163\163", "\151\157\156\137\141\x75\x74\150")) { goto LOAGU; } goto cpmQ2; uXtk0: gWPmH: goto bxmmb; qzRyo: return $this->db->insert($this->tables["\x6c\x6f\147\151\156\137\x61\164\164\145\x6d\160\x74\x73"], $data); goto uXtk0; D0LDy: $data = ["\151\x70\137\141\x64\144\162\145\163\x73" => '', "\154\157\x67\x69\156" => $identity, "\164\x69\155\x65" => time()]; goto Ve0mp; CfnW8: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto dmJ7Z; imetJ: sxB66: goto HFZG9; WIXTu: $this->db->where("\x69\160\137\x61\x64\x64\x72\x65\x73\x73", $ip_address); goto N40iv; N40iv: F2pUX: goto J4yB2; Jvk66: if (isset($ip_address)) { goto akC9I; } goto FGaAz; riw2f: $this->db->where("\x6c\157\147\x69\156", $identity); goto ypEbX; IzV7X: akC9I: goto WIXTu; FGaAz: $ip_address = $this->input->ip_address(); goto IzV7X; Ur0tE: return $this->db->delete($this->tables["\154\x6f\x67\151\156\137\x61\x74\x74\x65\x6d\x70\164\x73"]); goto imetJ; J4yB2: $this->db->or_where("\x74\x69\x6d\145\40\74", time() - $old_attempts_expire_period, FALSE); goto Ur0tE; dmJ7Z: if (!$this->config->item("\164\162\141\143\153\137\154\157\x67\x69\x6e\137\x61\x74\164\145\x6d\160\x74\x73", "\151\157\156\x5f\141\x75\164\150")) { goto sxB66; } goto M9wFc; HFZG9: return FALSE; goto dn9EE; M9wFc: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\157\x63\153\157\x75\x74\137\x74\151\155\145", "\x69\157\x6e\137\141\165\x74\150")); goto riw2f; ypEbX: if (!$this->config->item("\x74\162\141\x63\x6b\137\x6c\x6f\x67\151\x6e\x5f\151\x70\x5f\141\144\144\162\x65\x73\163", "\151\157\156\x5f\141\165\x74\x68")) { goto F2pUX; } goto Jvk66; dn9EE: } public function limit($limit) { goto qDIdu; BkGIn: return $this; goto D9c_6; XKQuU: $this->_ion_limit = $limit; goto BkGIn; qDIdu: $this->trigger_events("\154\151\x6d\151\164"); goto XKQuU; D9c_6: } public function offset($offset) { goto UmhOE; GyNdY: $this->_ion_offset = $offset; goto Y2VKz; Y2VKz: return $this; goto vjbJO; UmhOE: $this->trigger_events("\157\x66\x66\x73\145\x74"); goto GyNdY; vjbJO: } public function where($where, $value = NULL) { goto UmtyV; Q3WLG: return $this; goto CKOrF; Thblh: NEWTk: goto vKH39; owaRA: $where = [$where => $value]; goto Thblh; UmtyV: $this->trigger_events("\167\150\x65\162\x65"); goto qGtP8; vKH39: array_push($this->_ion_where, $where); goto Q3WLG; qGtP8: if (is_array($where)) { goto NEWTk; } goto owaRA; CKOrF: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\150") { goto LAihB; yRVxr: return $this; goto yl78Q; ccpF3: array_push($this->_ion_like, ["\x6c\151\x6b\145" => $like, "\x76\x61\154\165\145" => $value, "\160\157\163\151\164\151\x6f\x6e" => $position]); goto yRVxr; LAihB: $this->trigger_events("\x6c\151\153\x65"); goto ccpF3; yl78Q: } public function select($select) { goto zCLOx; svmZv: return $this; goto yw273; zCLOx: $this->trigger_events("\x73\x65\154\x65\x63\164"); goto dsDYC; dsDYC: $this->_ion_select[] = $select; goto svmZv; yw273: } public function order_by($by, $order = "\144\x65\x73\143") { goto CIx2z; uPBtT: $this->_ion_order = $order; goto Qrcrd; CIx2z: $this->trigger_events("\157\x72\144\145\162\137\x62\171"); goto lBNcF; Qrcrd: return $this; goto ATXiP; lBNcF: $this->_ion_order_by = $by; goto uPBtT; ATXiP: } public function row() { goto ck5xk; aX2MN: $row = $this->response->row(); goto jQlso; ck5xk: $this->trigger_events("\x72\x6f\167"); goto aX2MN; jQlso: return $row; goto PItT0; PItT0: } public function row_array() { goto WYtQY; uCPig: return $row; goto NGH1p; XU2N7: $row = $this->response->row_array(); goto uCPig; WYtQY: $this->trigger_events(["\x72\157\167", "\x72\157\x77\137\x61\162\x72\141\171"]); goto XU2N7; NGH1p: } public function result() { goto XA2Mx; NMyeP: $result = $this->response->result(); goto vH2ja; XA2Mx: $this->trigger_events("\x72\145\x73\x75\154\164"); goto NMyeP; vH2ja: return $result; goto jNLbG; jNLbG: } public function result_array() { goto BdE2_; a_bE5: $result = $this->response->result_array(); goto Qbycc; Qbycc: return $result; goto dx2tx; BdE2_: $this->trigger_events(["\x72\x65\163\165\x6c\164", "\x72\145\x73\x75\x6c\x74\137\x61\x72\162\x61\x79"]); goto a_bE5; dx2tx: } public function num_rows() { goto tOVYe; tOVYe: $this->trigger_events(["\x6e\x75\155\137\162\x6f\x77\163"]); goto b0bSN; jcHvy: return $result; goto seUms; b0bSN: $result = $this->response->num_rows(); goto jcHvy; seUms: } public function users($groups = NULL) { goto CltFK; VvFDs: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto PQu3n; } goto h0sF7; pncfU: $this->db->{$or_where_in}($this->tables["\165\x73\145\x72\x73\137\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\147\x72\157\x75\x70\x73"], $group_ids); goto URva1; fNQFd: if (!isset($groups)) { goto CuVb9; } goto GXqGK; v2MUf: PQu3n: goto Ccpvl; HJEmS: lp0Hx: goto RO9U2; gf0cw: goto YoeaM; goto V8Bux; URva1: cz4cr: goto G0Jgt; fVVBS: foreach ($this->_ion_where as $where) { $this->db->where($where); cUiY2: } goto HKJhC; PUESS: $this->trigger_events("\x65\170\164\162\141\137\x77\x68\145\162\x65"); goto MFA6e; dcDwx: $groups = [$groups]; goto w3Kuv; PEmy7: PUN1j: goto VvFDs; oaEDF: bkc_q: goto ppMQy; ppMQy: goto PUN1j; goto fzQk2; w3Kuv: HpBSo: goto hFBcA; sKK1i: ZvVw2: goto XbIcv; cqEPh: $this->_ion_offset = NULL; goto PEmy7; A5MdY: $this->_ion_where = []; goto HJEmS; j80WQ: zv72c: goto qFcat; E2RLP: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\x6b\145"], $like["\x76\141\154\x75\x65"], $like["\160\157\163\x69\164\151\157\156"]); C1cfK: } goto jZ0eZ; qIKqP: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto KTDFG; Ccpvl: $this->response = $this->db->get($this->tables["\165\x73\145\162\x73"]); goto V6esv; V8Bux: es5on: goto WhejQ; h_NHU: if (empty($group_names)) { goto ZvVw2; } goto LfH86; h0sF7: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto p9DOd; CZkiw: if (!isset($this->_ion_limit)) { goto bkc_q; } goto IZocg; fzQk2: ojl60: goto qIKqP; WhejQ: foreach ($this->_ion_select as $select) { $this->db->select($select); TgxTE: } goto L7O8h; b4Kx0: $this->db->where_in($this->tables["\x67\x72\x6f\x75\160\163"] . "\x2e\x6e\x61\155\x65", $group_names); goto sKK1i; WV40a: $this->_ion_like = []; goto FR1EB; db9hG: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto ojl60; } goto CZkiw; EnZrI: $this->db->join($this->tables["\x75\x73\x65\162\163\x5f\147\x72\157\165\x70\x73"], $this->tables["\x75\x73\x65\162\163\x5f\x67\x72\x6f\x75\x70\163"] . "\x2e" . $this->join["\165\x73\145\x72\x73"] . "\x3d" . $this->tables["\165\x73\x65\162\x73"] . "\56\151\x64", "\x69\156\x6e\145\162"); goto j80WQ; MANxf: VY9jo: goto aEmwX; CltFK: $this->trigger_events("\x75\x73\x65\x72\x73"); goto bB_Vz; DMNWP: $this->db->distinct(); goto EnZrI; bB_Vz: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto es5on; } goto Ih3At; RO9U2: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto KCNrf; } goto E2RLP; Ih3At: $this->db->select([$this->tables["\x75\163\x65\162\163"] . "\x2e\52", $this->tables["\x75\x73\x65\162\x73"] . "\56\151\x64\x20\141\x73\x20\x69\144", $this->tables["\165\163\145\x72\x73"] . "\x2e\x69\x64\x20\x61\163\40\x75\x73\x65\162\137\151\144"]); goto gf0cw; Kh9mK: $this->_ion_limit = NULL; goto oaEDF; jZ0eZ: GugYe: goto WV40a; p9DOd: $this->_ion_order = NULL; goto YxJ15; GXqGK: if (is_array($groups)) { goto HpBSo; } goto dcDwx; LfH86: $this->db->join($this->tables["\147\x72\x6f\165\160\163"], $this->tables["\165\x73\145\x72\163\x5f\147\x72\157\x75\160\x73"] . "\x2e" . $this->join["\x67\x72\157\x75\x70\x73"] . "\40\75\40" . $this->tables["\x67\x72\157\165\x70\x73"] . "\x2e\x69\144", "\x69\x6e\156\145\x72"); goto b4Kx0; YxJ15: $this->_ion_order_by = NULL; goto v2MUf; KTDFG: $this->_ion_limit = NULL; goto cqEPh; IZocg: $this->db->limit($this->_ion_limit); goto Kh9mK; V6esv: return $this; goto zzhhY; HKJhC: tzEhG: goto A5MdY; aEmwX: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\162\137\167\x68\x65\162\145\x5f\151\156" : "\x77\150\x65\162\145\x5f\151\156"; goto h_NHU; pgIOD: $this->_ion_select = []; goto leUGr; MFA6e: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto lp0Hx; } goto fVVBS; L7O8h: Phfz5: goto pgIOD; qFcat: $group_ids = []; goto kfM9H; FR1EB: KCNrf: goto db9hG; hFBcA: if (!(isset($groups) && !empty($groups))) { goto zv72c; } goto DMNWP; XbIcv: if (empty($group_ids)) { goto cz4cr; } goto pncfU; G0Jgt: CuVb9: goto PUESS; DA4bB: foreach ($groups as $group) { goto FS6KV; WdL2J: ESL5D: goto lKvsY; lKvsY: $group_ids[] = $group; goto t_UH4; OaGOn: LVsas: goto RhzR1; EWcdq: goto VSW8R; goto WdL2J; HoTQk: $group_names[] = $group; goto EWcdq; t_UH4: VSW8R: goto OaGOn; FS6KV: if (is_numeric($group)) { goto ESL5D; } goto HoTQk; RhzR1: } goto MANxf; leUGr: YoeaM: goto fNQFd; kfM9H: $group_names = []; goto DA4bB; zzhhY: } public function user($id = NULL) { goto IPvUf; cAHU5: $this->where($this->tables["\x75\163\x65\x72\x73"] . "\x2e\151\x64", $id); goto fe_tZ; sms_1: $this->order_by($this->tables["\x75\x73\145\x72\x73"] . "\56\151\x64", "\144\145\x73\x63"); goto cAHU5; fe_tZ: $this->users(); goto UozjU; UozjU: return $this; goto Ts2XH; IPvUf: $this->trigger_events("\x75\x73\x65\x72"); goto GOMVP; fMycU: $this->limit(1); goto sms_1; GOMVP: $id = isset($id) ? $id : $this->session->userdata("\x75\x73\x65\162\137\151\x64"); goto fMycU; Ts2XH: } public function get_users_groups($id = FALSE) { goto JVCOd; V6uPa: $id || ($id = $this->session->userdata("\x75\x73\145\x72\137\151\144")); goto IFHYB; IFHYB: return $this->db->select($this->tables["\165\163\145\x72\163\137\x67\162\x6f\165\x70\163"] . "\x2e" . $this->join["\x67\x72\x6f\x75\x70\163"] . "\40\141\x73\x20\151\144\x2c\x20" . $this->tables["\x67\x72\x6f\x75\x70\163"] . "\x2e\x6e\141\x6d\145\x2c\x20" . $this->tables["\x67\162\x6f\165\x70\x73"] . "\x2e\144\x65\163\x63\162\151\x70\164\151\x6f\x6e")->where($this->tables["\165\163\145\162\x73\x5f\147\x72\157\165\160\x73"] . "\x2e" . $this->join["\x75\x73\x65\x72\163"], $id)->join($this->tables["\x67\162\x6f\165\160\163"], $this->tables["\165\x73\x65\x72\x73\x5f\x67\x72\x6f\165\160\x73"] . "\56" . $this->join["\x67\x72\x6f\165\x70\163"] . "\75" . $this->tables["\x67\162\x6f\x75\x70\163"] . "\56\x69\144")->get($this->tables["\165\x73\145\162\x73\x5f\x67\162\x6f\x75\160\x73"]); goto d2R6S; JVCOd: $this->trigger_events("\x67\x65\x74\x5f\x75\x73\145\162\163\137\147\x72\157\x75\x70"); goto V6uPa; d2R6S: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto I3nzx; dGQYW: $this->_cache_user_in_group[$id] = $groups_array; goto bV355; wmMVn: ptT8m: goto EV8xp; bV355: goto ptT8m; goto JEQuc; DOydl: if (is_array($check_group)) { goto qLKsN; } goto PpKAy; TUH3Y: return $check_all; goto bo_mg; ba1OZ: st5mT: goto TUH3Y; VZUsm: if (isset($this->_cache_user_in_group[$id])) { goto m9Z2G; } goto kR2QG; I3nzx: $this->trigger_events("\x69\156\x5f\147\162\x6f\x75\160"); goto pNv9n; T4rhl: $groups_array = []; goto KnaoV; PpKAy: $check_group = [$check_group]; goto IwNEu; pNv9n: $id || ($id = $this->session->userdata("\165\x73\145\x72\x5f\x69\144")); goto DOydl; kR2QG: $users_groups = $this->get_users_groups($id)->result(); goto T4rhl; IwNEu: qLKsN: goto VZUsm; JEQuc: m9Z2G: goto UnCLJ; C1BKp: c82eu: goto dGQYW; KnaoV: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; c63D4: } goto C1BKp; EV8xp: foreach ($check_group as $key => $value) { goto IDwpQ; t_25z: return !$check_all; goto F2T_x; Ab7K1: pGgzt: goto SCi1E; Z9nvo: if (!(in_array($value, $groups) xor $check_all)) { goto v3jco; } goto t_25z; IDwpQ: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto Z9nvo; F2T_x: v3jco: goto Ab7K1; SCi1E: } goto ba1OZ; UnCLJ: $groups_array = $this->_cache_user_in_group[$id]; goto wmMVn; bo_mg: } public function add_to_group($group_ids, $user_id = FALSE) { goto hp6s3; uieKo: foreach ($group_ids as $group_id) { goto o2qWn; RMaW_: $group_name = $group[0]->name; goto K98Yu; GEKIl: k3f1K: goto dwctW; dwctW: $group_name = $this->_cache_groups[$group_id]; goto mbWxR; o2qWn: if (!$this->db->insert($this->tables["\x75\x73\145\x72\163\x5f\147\x72\157\165\x70\x73"], [$this->join["\x67\x72\157\165\160\x73"] => (float) $group_id, $this->join["\x75\163\145\162\163"] => (float) $user_id])) { goto pMrhv; } goto BUnaZ; DFp1U: $group = $this->group($group_id)->result(); goto RMaW_; YH1XL: pMrhv: goto rDfMi; BUnaZ: if (isset($this->_cache_groups[$group_id])) { goto k3f1K; } goto DFp1U; duYNh: $return++; goto YH1XL; PQiHw: goto T7AtB; goto GEKIl; INs23: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto duYNh; K98Yu: $this->_cache_groups[$group_id] = $group_name; goto PQiHw; mbWxR: T7AtB: goto INs23; rDfMi: TA54n: goto juC1E; juC1E: } goto YTSaa; QH4FF: return $return; goto LgahI; AfiZg: $return = 0; goto uieKo; hp6s3: $this->trigger_events("\141\144\144\137\x74\157\137\147\162\x6f\165\x70"); goto VrgYN; ZPZCN: if (is_array($group_ids)) { goto X3pe_; } goto ULSsZ; bcpDh: X3pe_: goto AfiZg; ULSsZ: $group_ids = [$group_ids]; goto bcpDh; VrgYN: $user_id || ($user_id = $this->session->userdata("\165\x73\x65\x72\x5f\x69\x64")); goto ZPZCN; YTSaa: unc7X: goto QH4FF; LgahI: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto aza2W; SXk8m: EHolR: goto rUeP7; crc0t: return $return; goto uP3Ju; mvC0E: qORwk: goto VEBXB; qEiHC: return FALSE; goto SXk8m; GBCMd: pLYLl: goto Hc2e8; Zx3E8: if (!empty($user_id)) { goto EHolR; } goto qEiHC; OK4AU: rhGCK: goto crc0t; eLk9o: foreach ($group_ids as $group_id) { goto Qwv_9; Qwv_9: $this->db->delete($this->tables["\165\x73\145\x72\163\137\147\x72\157\x75\x70\163"], [$this->join["\147\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\x75\x73\x65\162\x73"] => (float) $user_id]); goto WqlBI; XP88J: unset($this->_cache_user_in_group[$user_id][$group_id]); goto JrHlU; WqlBI: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto aUGPv; } goto XP88J; JrHlU: aUGPv: goto s97Ty; s97Ty: euJb7: goto eIpdV; eIpdV: } goto mvC0E; Bp0hP: AD2Lb: goto p2XEP; VEBXB: $return = TRUE; goto OK4AU; o_KOb: $group_ids = [$group_ids]; goto jI0WP; rUeP7: if (!empty($group_ids)) { goto AD2Lb; } goto D7QIh; zbEix: $this->_cache_user_in_group[$user_id] = []; goto GBCMd; jI0WP: W56PF: goto eLk9o; aza2W: $this->trigger_events("\x72\145\155\157\x76\145\x5f\x66\162\x6f\155\x5f\x67\x72\x6f\x75\x70"); goto Zx3E8; Hc2e8: goto rhGCK; goto Bp0hP; p2XEP: if (is_array($group_ids)) { goto W56PF; } goto o_KOb; D7QIh: if (!($return = $this->db->delete($this->tables["\x75\x73\x65\162\x73\x5f\x67\x72\157\165\x70\x73"], [$this->join["\x75\163\145\x72\x73"] => (float) $user_id]))) { goto pLYLl; } goto zbEix; uP3Ju: } public function groups() { goto UaIoa; pbWz7: $this->db->limit($this->_ion_limit); goto roTs1; N_CKF: $this->_ion_where = []; goto WUiCk; nM7Mi: MnYHi: goto kMF2M; DolTP: $this->_ion_limit = NULL; goto kHvnv; roTs1: $this->_ion_limit = NULL; goto nM7Mi; UkxHn: zK5f2: goto ll0dJ; F23X7: foreach ($this->_ion_where as $where) { $this->db->where($where); kkvmk: } goto m50Wm; asFVY: return $this; goto pOyoI; ll0dJ: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto DolTP; Z_StT: dhfFj: goto U8fmN; kMF2M: goto BhlsP; goto UkxHn; U8fmN: $this->response = $this->db->get($this->tables["\147\162\157\x75\x70\163"]); goto asFVY; PuNqN: BhlsP: goto jhzsg; AbdGJ: if (!isset($this->_ion_limit)) { goto MnYHi; } goto pbWz7; jhzsg: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto dhfFj; } goto G46dn; p_Oxm: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto nllS4; } goto F23X7; G46dn: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto Z_StT; kHvnv: $this->_ion_offset = NULL; goto PuNqN; UaIoa: $this->trigger_events("\x67\x72\157\x75\x70\x73"); goto p_Oxm; m50Wm: rYpO_: goto N_CKF; GQcIN: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto zK5f2; } goto AbdGJ; WUiCk: nllS4: goto GQcIN; pOyoI: } public function group($id = NULL) { goto TyAwL; TyAwL: $this->trigger_events("\147\162\157\165\160"); goto JssPJ; nEUDh: $this->where($this->tables["\x67\162\157\x75\160\163"] . "\56\x69\144", $id); goto TRX1Y; XK8KP: $this->limit(1); goto g0bPj; TRX1Y: HcY7h: goto XK8KP; g0bPj: $this->order_by("\x69\x64", "\144\x65\163\143"); goto dpCXx; JssPJ: if (!isset($id)) { goto HcY7h; } goto nEUDh; dpCXx: return $this->groups(); goto enodZ; enodZ: } public function update($id, array $data) { goto HaDek; q8Vsu: vn5oj: goto p0nhW; JLd1w: TCbG5: goto q8Vsu; SQDFT: $this->set_error("\165\x70\x64\141\x74\x65\x5f\x75\x6e\163\165\143\x63\145\x73\x73\146\x75\x6c"); goto ocWBd; Vfpde: $this->set_error("\x75\x70\x64\141\x74\145\x5f\x75\x6e\x73\165\143\x63\145\163\x73\x66\165\154"); goto F7WLx; F7WLx: return FALSE; goto ZFb_Z; UgsKu: $this->set_error("\165\160\x64\141\164\145\137\165\156\x73\x75\143\143\145\163\x73\x66\165\x6c"); goto bimjw; YDweL: return TRUE; goto FcH9i; bQn21: goto vn5oj; goto E12st; HaDek: $this->trigger_events("\x70\x72\x65\x5f\165\x70\144\x61\164\145\137\165\x73\x65\162"); goto nMNA_; Xo6sU: $this->trigger_events(["\x70\157\x73\x74\137\165\160\x64\141\164\x65\137\x75\163\x65\162", "\160\x6f\163\164\x5f\x75\160\x64\141\x74\145\x5f\165\x73\x65\162\137\163\x75\x63\143\145\x73\163\146\165\x6c"]); goto WmNvR; p0nhW: l4WKm: goto BADS1; ocWBd: return FALSE; goto SiwXv; SiwXv: kpQ6e: goto TYE94; QJ9QU: $this->set_error("\141\143\x63\157\165\x6e\x74\x5f\x63\x72\x65\x61\x74\151\157\x6e\x5f\x64\x75\x70\154\151\143\141\x74\145\x5f\151\144\x65\156\164\x69\164\171"); goto SS3xW; JMgJh: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\141\163\x73\x77\157\x72\144", $data) || array_key_exists("\145\155\x61\x69\x6c", $data))) { goto kAIXz; } goto EVbNl; SS3xW: $this->trigger_events(["\x70\157\x73\164\x5f\x75\160\144\141\x74\x65\137\x75\x73\145\162", "\160\x6f\x73\164\x5f\165\x70\144\141\164\x65\137\x75\163\x65\x72\x5f\165\x6e\x73\x75\143\143\x65\163\163\x66\165\154"]); goto SQDFT; DE7mj: $this->trigger_events("\145\170\x74\162\x61\x5f\x77\x68\x65\162\x65"); goto L_kSB; AT0FY: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto kpQ6e; } goto o_0eT; ZFb_Z: bu3Dj: goto wd139; KIj5t: if (!($data["\x70\x61\x73\163\167\x6f\x72\x64"] === FALSE)) { goto TCbG5; } goto y7pGq; nMNA_: $user = $this->user($id)->row(); goto uhjJy; E12st: qXmQh: goto oRmq_; pEy86: $this->trigger_events(["\x70\157\163\x74\137\165\160\144\x61\x74\145\137\x75\163\x65\162", "\160\x6f\163\x74\137\x75\x70\x64\x61\x74\x65\137\165\163\x65\162\137\x75\156\x73\165\143\x63\145\163\x73\x66\x75\154"]); goto UgsKu; EVbNl: if (!array_key_exists("\x70\x61\x73\163\167\x6f\x72\x64", $data)) { goto l4WKm; } goto wrGcr; gSK2T: unset($data["\160\141\x73\163\x77\x6f\162\x64"]); goto bQn21; oRmq_: $data["\160\x61\x73\x73\x77\x6f\x72\144"] = $this->hash_password($data["\160\141\163\163\x77\157\162\144"], $user->{$this->identity_column}); goto KIj5t; y7pGq: $this->db->trans_rollback(); goto pEy86; WmNvR: $this->set_message("\x75\x70\x64\141\164\x65\137\163\x75\143\143\x65\x73\x73\146\x75\x6c"); goto YDweL; wrGcr: if (!empty($data["\160\141\x73\163\x77\157\162\144"])) { goto qXmQh; } goto gSK2T; uhjJy: $this->db->trans_begin(); goto AT0FY; wd139: $this->db->trans_commit(); goto Xo6sU; TYE94: $data = $this->_filter_data($this->tables["\x75\x73\x65\162\x73"], $data); goto JMgJh; rf32p: $this->trigger_events(["\160\157\x73\164\137\x75\x70\x64\x61\164\x65\x5f\x75\x73\x65\162", "\x70\157\x73\x74\x5f\165\160\144\141\164\x65\137\x75\x73\x65\x72\137\165\x6e\163\x75\x63\143\145\163\x73\x66\x75\154"]); goto Vfpde; HzgWi: $this->db->trans_rollback(); goto rf32p; bimjw: return FALSE; goto JLd1w; L_kSB: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, ["\151\144" => $user->id]); goto NsLGm; BADS1: kAIXz: goto DE7mj; o_0eT: $this->db->trans_rollback(); goto QJ9QU; NsLGm: if (!($this->db->trans_status() === FALSE)) { goto bu3Dj; } goto HzgWi; FcH9i: } public function delete_user($id) { goto oYGnC; rqA2W: hYR3i: goto TRrpJ; tg5i2: $this->set_error("\x64\x65\154\145\164\145\x5f\165\x6e\x73\x75\x63\x63\145\x73\x73\x66\165\x6c"); goto tmOQ0; oYGnC: $this->trigger_events("\x70\x72\145\x5f\144\x65\x6c\x65\x74\145\137\x75\163\145\162"); goto d0RRr; LNJgA: if (!($this->db->trans_status() === FALSE)) { goto hYR3i; } goto YDWDe; d0RRr: $this->db->trans_begin(); goto y6lh8; n1Hpr: $this->trigger_events(["\x70\157\x73\164\x5f\x64\x65\154\145\164\145\137\165\163\x65\162", "\160\x6f\x73\x74\137\x64\x65\x6c\x65\164\145\137\x75\163\x65\162\x5f\163\x75\x63\x63\x65\163\163\146\x75\154"]); goto mcOE6; tmOQ0: return FALSE; goto rqA2W; D2A8o: return TRUE; goto lhuhy; mcOE6: $this->set_message("\144\x65\x6c\x65\x74\145\x5f\163\165\143\143\145\163\x73\146\x75\x6c"); goto D2A8o; y6lh8: $this->remove_from_group(NULL, $id); goto p8maS; vZTXa: $this->trigger_events(["\x70\x6f\x73\x74\x5f\144\145\154\145\x74\x65\x5f\165\163\x65\x72", "\x70\157\x73\x74\137\x64\145\154\x65\x74\x65\137\x75\x73\145\x72\137\x75\x6e\x73\x75\x63\143\145\x73\x73\x66\165\154"]); goto tg5i2; p8maS: $this->db->delete($this->tables["\x75\163\145\162\163"], ["\151\144" => $id]); goto LNJgA; YDWDe: $this->db->trans_rollback(); goto vZTXa; TRrpJ: $this->db->trans_commit(); goto n1Hpr; lhuhy: } public function update_last_login($id) { goto W2OZB; GJLAL: $this->load->helper("\144\141\164\x65"); goto xlrP7; xlrP7: $this->trigger_events("\x65\x78\164\x72\141\x5f\167\x68\145\162\x65"); goto dLUgw; VYIRP: return $this->db->affected_rows() == 1; goto LgEV9; W2OZB: $this->trigger_events("\165\x70\144\141\x74\x65\x5f\x6c\141\x73\x74\x5f\154\x6f\x67\151\156"); goto GJLAL; dLUgw: $this->db->update($this->tables["\165\163\x65\162\x73"], ["\154\141\x73\164\137\x6c\157\147\151\156" => time()], ["\x69\144" => $id]); goto VYIRP; LgEV9: } public function set_lang($lang = "\x65\156") { goto Q7Mde; jS4WX: set_cookie(["\x6e\x61\x6d\x65" => "\x6c\141\x6e\x67\x5f\x63\157\x64\x65", "\x76\141\154\x75\145" => $lang, "\x65\170\x70\x69\162\145" => $expire]); goto EHJij; gDbKN: $expire = self::MAX_COOKIE_LIFETIME; goto qSqNp; p86De: if ($this->config->item("\x75\x73\145\x72\137\145\x78\160\151\x72\145", "\151\x6f\x6e\137\x61\165\x74\150") === 0) { goto N06sU; } goto qIl4K; Q7Mde: $this->trigger_events("\x73\x65\x74\x5f\154\x61\156\147"); goto p86De; qIl4K: $expire = $this->config->item("\x75\x73\145\162\x5f\x65\170\160\x69\162\x65", "\x69\x6f\x6e\x5f\x61\x75\x74\x68"); goto lZmFh; qSqNp: rQcuj: goto jS4WX; nSuYd: N06sU: goto gDbKN; lZmFh: goto rQcuj; goto nSuYd; EHJij: return TRUE; goto rrsPk; rrsPk: } public function set_session($user) { goto bJ8Gy; Y3gW7: return TRUE; goto NsnLw; YnIIM: $this->session->set_userdata($session_data); goto NVJG6; T7z67: $session_data = ["\151\x64\145\156\164\x69\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\155\x61\x69\x6c" => $user->email, "\165\163\145\x72\137\x69\144" => $user->id, "\x6f\x6c\144\x5f\x6c\141\x73\x74\137\154\157\x67\x69\156" => $user->last_login, "\154\x61\163\x74\x5f\143\x68\145\143\x6b" => time()]; goto YnIIM; bJ8Gy: $this->trigger_events("\x70\x72\145\x5f\x73\145\164\x5f\163\x65\163\163\151\x6f\156"); goto T7z67; NVJG6: $this->trigger_events("\x70\157\163\x74\x5f\x73\x65\x74\137\x73\x65\x73\x73\x69\x6f\x6e"); goto Y3gW7; NsnLw: } public function remember_user($identity) { goto xx0ns; pr4do: return TRUE; goto O0DxF; lrDoQ: $this->db->update($this->tables["\x75\163\x65\162\163"], ["\x72\145\155\x65\155\x62\145\162\x5f\x73\145\x6c\x65\x63\x74\x6f\x72" => $token->selector, "\162\145\155\x65\x6d\142\x65\x72\x5f\x63\x6f\144\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto kBuA2; euTEC: set_cookie(["\156\x61\x6d\x65" => $this->config->item("\x72\145\x6d\145\x6d\142\x65\162\137\143\157\157\153\151\x65\137\156\141\x6d\x65", "\x69\157\x6e\x5f\x61\165\164\x68"), "\x76\141\x6c\165\145" => $token->user_code, "\145\170\160\151\162\145" => $expire]); goto rY0qP; XjwYP: XloKM: goto nM3XZ; O0DxF: Nx_wT: goto LAUTt; lXHMy: $this->trigger_events(["\x70\x6f\163\164\137\x72\145\155\145\x6d\x62\x65\x72\x5f\165\x73\145\x72", "\x72\145\x6d\145\155\142\x65\162\137\x75\163\145\x72\x5f\165\x6e\x73\x75\x63\x63\x65\x73\x73\x66\165\154"]); goto VEJZQ; nM3XZ: $expire = self::MAX_COOKIE_LIFETIME; goto XIjPI; ncwJz: $expire = $this->config->item("\165\163\x65\162\x5f\145\170\160\151\162\x65", "\151\x6f\x6e\x5f\x61\x75\164\150"); goto iVGc1; SMuK0: if (!$token->validator_hashed) { goto VGh3W; } goto lrDoQ; U7vNq: $token = $this->_generate_selector_validator_couple(); goto SMuK0; F5Kj1: if ($identity) { goto V7y2O; } goto VKtN7; rY0qP: $this->trigger_events(["\x70\x6f\163\x74\x5f\162\145\155\145\x6d\x62\145\x72\x5f\165\x73\x65\162", "\162\x65\x6d\145\x6d\142\x65\162\137\165\x73\145\x72\x5f\163\x75\x63\x63\145\x73\163\146\165\154"]); goto pr4do; VEJZQ: return FALSE; goto r99YL; VKtN7: return FALSE; goto aIjVD; kBuA2: if (!($this->db->affected_rows() > -1)) { goto Nx_wT; } goto HKEi6; XIjPI: DGIA7: goto euTEC; HKEi6: if ($this->config->item("\x75\x73\145\162\x5f\145\170\160\x69\162\145", "\151\157\156\x5f\141\x75\164\150") === 0) { goto XloKM; } goto ncwJz; LAUTt: VGh3W: goto lXHMy; xx0ns: $this->trigger_events("\x70\x72\x65\x5f\x72\145\155\145\x6d\142\145\x72\x5f\x75\163\145\162"); goto F5Kj1; aIjVD: V7y2O: goto U7vNq; iVGc1: goto DGIA7; goto XjwYP; r99YL: } public function login_remembered_user() { goto WtCSC; CfWl4: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto CrY9o; wHAg6: return FALSE; goto xsuG0; CrY9o: if (!($token === FALSE)) { goto I0qBc; } goto IEQvv; t35ae: $query = $this->db->select($this->identity_column . "\x2c\x20\151\x64\x2c\x20\x65\155\141\151\x6c\54\40\x72\x65\x6d\145\x6d\x62\x65\162\137\143\x6f\x64\145\54\40\x6c\x61\163\164\x5f\x6c\x6f\147\x69\156")->where("\162\145\155\x65\x6d\142\x65\162\137\163\145\x6c\145\x63\164\x6f\162", $token->selector)->where("\x61\143\164\x69\166\x65", 1)->limit(1)->get($this->tables["\x75\163\x65\162\x73"]); goto lI20Z; DYx5G: if (!$this->config->item("\x75\163\x65\162\137\x65\170\164\145\156\x64\x5f\157\156\x5f\x6c\x6f\147\x69\156", "\x69\157\x6e\x5f\141\x75\x74\x68")) { goto WcJOb; } goto u8uv_; z8VZz: $this->update_last_login($user->id); goto rqy14; WtCSC: $this->trigger_events("\x70\x72\145\x5f\154\x6f\x67\x69\x6e\x5f\162\x65\155\x65\x6d\142\145\x72\145\x64\137\x75\x73\145\162"); goto fBPqU; rgYVE: delete_cookie($this->config->item("\162\x65\155\x65\155\142\x65\162\137\143\x6f\x6f\153\151\145\x5f\156\x61\155\x65", "\151\157\156\137\141\165\164\150")); goto YFC4L; lI20Z: if (!($query->num_rows() === 1)) { goto DBGmu; } goto FXnRg; Aht5H: $this->trigger_events(["\160\157\163\x74\137\154\157\147\x69\x6e\x5f\x72\x65\155\x65\x6d\142\145\x72\x65\144\137\165\x73\145\162", "\160\x6f\163\164\x5f\x6c\x6f\147\151\x6e\x5f\162\x65\x6d\x65\155\142\x65\162\145\144\x5f\x75\163\x65\x72\137\x73\x75\x63\143\x65\163\x73\x66\165\154"]); goto u38QK; xm8C7: WcJOb: goto T9GQv; rqy14: $this->set_session($user); goto i8j2h; T9GQv: $this->session->sess_regenerate(FALSE); goto Aht5H; aNxWj: $this->trigger_events("\145\170\x74\162\141\x5f\167\x68\x65\162\x65"); goto t35ae; u38QK: return TRUE; goto pDmtJ; u8uv_: $this->remember_user($identity); goto xm8C7; FXnRg: $user = $query->row(); goto rPxYX; rPxYX: $identity = $user->{$this->identity_column}; goto hXWod; ehXjD: DBGmu: goto rgYVE; pDmtJ: oqLSG: goto ehXjD; YFC4L: $this->trigger_events(["\x70\157\x73\164\137\154\x6f\147\x69\x6e\137\x72\x65\155\145\x6d\142\x65\x72\145\144\x5f\165\163\x65\x72", "\x70\x6f\x73\x74\x5f\x6c\x6f\x67\151\x6e\137\x72\145\155\x65\155\142\x65\x72\x65\144\x5f\x75\x73\145\x72\x5f\165\x6e\163\x75\143\x63\x65\x73\163\x66\165\154"]); goto wHAg6; i8j2h: $this->clear_forgotten_password_code($identity); goto DYx5G; clcDC: I0qBc: goto aNxWj; fBPqU: $remember_cookie = get_cookie($this->config->item("\162\x65\x6d\145\155\x62\145\x72\137\x63\157\157\x6b\x69\x65\x5f\x6e\x61\x6d\145", "\151\x6f\x6e\137\x61\165\164\x68")); goto CfWl4; y6Vph: return FALSE; goto clcDC; IEQvv: $this->trigger_events(["\160\x6f\163\164\x5f\154\x6f\147\x69\156\x5f\162\x65\155\145\x6d\142\x65\162\145\x64\x5f\x75\163\145\162", "\x70\157\x73\164\x5f\154\157\147\x69\x6e\x5f\162\x65\x6d\x65\x6d\142\x65\162\x65\x64\x5f\165\x73\x65\162\x5f\165\156\x73\165\x63\143\x65\163\x73\x66\x75\x6c"]); goto y6Vph; hXWod: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto oqLSG; } goto z8VZz; xsuG0: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto ifiCa; ueFQ1: pzalX: goto aJMe2; aJMe2: $existing_group = $this->db->get_where($this->tables["\147\x72\x6f\165\160\x73"], ["\156\x61\155\145" => $group_name])->num_rows(); goto QOfWz; h6B4m: GdlNa: goto CEpx2; Llcxv: if (empty($additional_data)) { goto HtZOT; } goto Yq8AZ; poxMd: return FALSE; goto h6B4m; zm9HS: $this->set_message("\x67\x72\x6f\165\x70\137\143\x72\145\x61\x74\x69\157\156\137\163\165\143\x63\x65\163\x73\x66\x75\x6c"); goto PipGG; QOfWz: if (!($existing_group !== 0)) { goto GdlNa; } goto s1uUM; Yq8AZ: $data = array_merge($this->_filter_data($this->tables["\x67\x72\x6f\x75\160\x73"], $additional_data), $data); goto LdVVS; PipGG: return $group_id; goto z3h9X; LdVVS: HtZOT: goto MTJIL; MTJIL: $this->trigger_events("\x65\170\x74\162\141\137\x67\162\157\165\160\x5f\x73\145\x74"); goto jgNSN; CEpx2: $data = ["\x6e\141\x6d\145" => $group_name, "\144\x65\x73\143\x72\151\x70\164\151\x6f\x6e" => $group_description]; goto Llcxv; pzwD2: $group_id = $this->db->insert_id($this->tables["\147\162\x6f\x75\x70\163"] . "\x5f\x69\x64\x5f\163\145\x71"); goto zm9HS; X_4_m: return FALSE; goto ueFQ1; jgNSN: $this->db->insert($this->tables["\147\162\157\165\160\x73"], $data); goto pzwD2; dkL7u: $this->set_error("\147\x72\x6f\x75\x70\137\x6e\x61\x6d\x65\137\162\145\161\x75\151\x72\x65\x64"); goto X_4_m; ifiCa: if ($group_name) { goto pzalX; } goto dkL7u; s1uUM: $this->set_error("\147\162\x6f\165\160\x5f\x61\x6c\x72\145\141\x64\171\137\x65\170\x69\163\x74\x73"); goto poxMd; z3h9X: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto B1PaF; B6v6q: NA5ia: goto OgVDJ; CWlSE: if (empty($additional_data)) { goto pcHEp; } goto Fc1gS; m1z4U: return FALSE; goto LsMB5; OgVDJ: $group = $this->db->get_where($this->tables["\x67\x72\x6f\165\x70\x73"], ["\x69\144" => $group_id])->row(); goto Hwc0J; GgJ9L: $this->set_error("\147\162\x6f\165\x70\x5f\x6e\x61\x6d\145\x5f\x61\144\155\151\x6e\137\156\x6f\164\137\x61\x6c\164\x65\162"); goto ei8lO; sO494: sJKIl: goto dYNUY; HtyQh: $data["\156\x61\155\x65"] = $group_name; goto B6v6q; TmYEW: $this->db->update($this->tables["\147\162\157\165\160\x73"], $data, ["\x69\x64" => $group_id]); goto i7B5x; LsMB5: S_WfW: goto HtyQh; xxHcB: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto S_WfW; } goto FMPrL; p7pQJ: if (empty($group_name)) { goto NA5ia; } goto IjE1N; FMPrL: $this->set_error("\x67\x72\x6f\165\x70\x5f\141\x6c\162\145\x61\144\x79\137\145\x78\x69\x73\x74\163"); goto m1z4U; tV5O_: return FALSE; goto sO494; dYNUY: $data = []; goto p7pQJ; l9_jk: return TRUE; goto uyyKR; Hwc0J: if (!($this->config->item("\x61\x64\x6d\151\156\x5f\147\162\x6f\x75\160", "\151\x6f\x6e\137\x61\165\164\150") === $group->name && $group_name !== $group->name)) { goto qwjbD; } goto GgJ9L; rDWXv: qwjbD: goto CWlSE; i7B5x: $this->set_message("\147\x72\x6f\165\160\137\165\x70\144\141\x74\145\137\163\x75\x63\x63\145\x73\x73\x66\x75\154"); goto l9_jk; x04c0: pcHEp: goto TmYEW; IjE1N: $existing_group = $this->db->get_where($this->tables["\x67\x72\157\165\160\x73"], ["\156\141\x6d\x65" => $group_name])->row(); goto xxHcB; B1PaF: if (!empty($group_id)) { goto sJKIl; } goto tV5O_; ei8lO: return FALSE; goto rDWXv; Fc1gS: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\x70\163"], $additional_data), $data); goto x04c0; uyyKR: } public function delete_group($group_id = FALSE) { goto BowSk; aBTP3: return FALSE; goto iEVOa; BvD7N: $this->db->trans_commit(); goto nPtM3; toBGf: return TRUE; goto sySHh; KvT7p: l6CEw: goto UNFNv; iEVOa: q32mz: goto Caz4A; NRxGv: $this->db->trans_begin(); goto ZoOOW; s3Q_x: $this->trigger_events(["\x70\x6f\x73\x74\137\144\x65\154\145\164\145\x5f\x67\x72\x6f\165\160", "\x70\x6f\163\164\x5f\x64\145\154\145\x74\145\x5f\x67\162\157\x75\x70\137\156\157\164\141\154\154\157\x77\x65\144"]); goto Qgm_U; ZihI_: $this->trigger_events(["\160\x6f\163\x74\137\x64\x65\x6c\x65\x74\145\x5f\147\x72\157\165\x70", "\x70\157\x73\x74\137\x64\145\154\x65\164\x65\137\147\162\157\x75\x70\x5f\165\156\163\x75\x63\x63\x65\163\x73\146\x75\154"]); goto XdJR3; Caz4A: $group = $this->group($group_id)->row(); goto X2vgn; XdJR3: $this->set_error("\x67\x72\x6f\x75\x70\x5f\x64\145\154\x65\x74\x65\x5f\x75\156\163\165\143\x63\145\163\163\x66\x75\x6c"); goto UGf3z; alMI9: $this->db->trans_rollback(); goto ZihI_; X2vgn: if (!($group->name == $this->config->item("\x61\x64\x6d\x69\156\x5f\x67\162\157\x75\x70", "\151\x6f\x6e\x5f\141\x75\x74\150"))) { goto l6CEw; } goto s3Q_x; nPtM3: $this->trigger_events(["\160\x6f\163\x74\x5f\x64\x65\x6c\x65\164\x65\137\147\162\x6f\165\x70", "\160\x6f\x73\x74\x5f\144\x65\154\145\x74\x65\137\x67\x72\157\x75\x70\137\163\165\143\143\x65\x73\x73\x66\x75\154"]); goto Nl0fm; Nl0fm: $this->set_message("\x67\162\157\x75\x70\x5f\144\x65\154\145\164\145\137\163\165\x63\x63\x65\x73\163\146\165\154"); goto toBGf; UGf3z: return FALSE; goto KPBy2; UNFNv: $this->trigger_events("\160\x72\x65\137\x64\x65\x6c\x65\x74\145\137\x67\x72\x6f\x75\x70"); goto NRxGv; BowSk: if (!(!$group_id || empty($group_id))) { goto q32mz; } goto aBTP3; ZoOOW: $this->db->delete($this->tables["\x75\x73\x65\162\163\137\x67\x72\157\x75\160\163"], [$this->join["\147\x72\x6f\x75\160\x73"] => $group_id]); goto REsRz; KPBy2: Cwzon: goto BvD7N; GqTFQ: return FALSE; goto KvT7p; REsRz: $this->db->delete($this->tables["\x67\x72\x6f\x75\x70\163"], ["\x69\x64" => $group_id]); goto GuneQ; GuneQ: if (!($this->db->trans_status() === FALSE)) { goto Cwzon; } goto alMI9; Qgm_U: $this->set_error("\x67\x72\157\165\x70\137\x64\x65\154\x65\x74\145\x5f\x6e\x6f\x74\x61\x6c\154\157\167\x65\144"); goto GqTFQ; sySHh: } public function set_hook($event, $name, $class, $method, $arguments) { goto fI_3N; tnJhW: $this->_ion_hooks->{$event}[$name]->method = $method; goto SxpNP; hjZ5e: $this->_ion_hooks->{$event}[$name]->class = $class; goto tnJhW; fI_3N: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto hjZ5e; SxpNP: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto UK1TW; UK1TW: } public function remove_hook($event, $name) { goto pF1u3; pF1u3: if (!isset($this->_ion_hooks->{$event}[$name])) { goto VmVAQ; } goto rONcL; rONcL: unset($this->_ion_hooks->{$event}[$name]); goto TFYZK; TFYZK: VmVAQ: goto RlLlF; RlLlF: } public function remove_hooks($event) { goto uWOLE; U59OD: unset($this->_ion_hooks->{$event}); goto W5ZGC; uWOLE: if (!isset($this->_ion_hooks->{$event})) { goto TcM5o; } goto U59OD; W5ZGC: TcM5o: goto TuT_h; TuT_h: } protected function _call_hook($event, $name) { goto NhHcW; Hh7Yo: $hook = $this->_ion_hooks->{$event}[$name]; goto OQTw1; NhHcW: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto fKjlf; } goto Hh7Yo; PE3al: return FALSE; goto vqAS5; OQTw1: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto JQz23; JQz23: fKjlf: goto PE3al; vqAS5: } public function trigger_events($events) { goto Iritt; aOggQ: pfMFq: goto jRteJ; oL235: dFO7d: goto UCpG0; UCpG0: Wt5RX: goto XGrwv; wHWGJ: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto pfMFq; } goto a_q0h; bqThw: foreach ($events as $event) { $this->trigger_events($event); zkGDq: } goto oL235; Iritt: if (is_array($events) && !empty($events)) { goto DdOF_; } goto wHWGJ; g2h7V: J3cu8: goto aOggQ; Zc6b5: DdOF_: goto bqThw; jRteJ: goto Wt5RX; goto Zc6b5; a_q0h: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); DDKL3: } goto g2h7V; XGrwv: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto QDkd6; QDkd6: $this->message_start_delimiter = $start_delimiter; goto WhZae; BPyw2: return TRUE; goto INvRV; WhZae: $this->message_end_delimiter = $end_delimiter; goto BPyw2; INvRV: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto V23L3; VDbMZ: $this->error_end_delimiter = $end_delimiter; goto m02az; V23L3: $this->error_start_delimiter = $start_delimiter; goto VDbMZ; m02az: return TRUE; goto BxEEz; BxEEz: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto lcAKL; bYVSc: return $_output; goto RFxIo; lcAKL: $_output = ''; goto xGRp7; xUcRY: P5hJg: goto bYVSc; xGRp7: foreach ($this->messages as $message) { goto kt0Tm; pcl8Q: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto YbOS8; kt0Tm: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\43\x23" . $message . "\x23\43"; goto pcl8Q; YbOS8: vppnp: goto aHDBk; aHDBk: } goto xUcRY; RFxIo: } public function messages_array($langify = TRUE) { goto lisqS; vRWac: HaFAw: goto Uogiv; Lf1ZD: $_output = []; goto aC32m; lisqS: if ($langify) { goto ef0oG; } goto GPU2m; Uogiv: return $_output; goto RlotQ; JlNLK: goto J69yp; goto fENYV; RlotQ: J69yp: goto vmEWJ; fENYV: ef0oG: goto Lf1ZD; GPU2m: return $this->messages; goto JlNLK; aC32m: foreach ($this->messages as $message) { goto U1vEe; qauuh: wfBNX: goto Krlwz; iZNZx: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto qauuh; U1vEe: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\x23\43"; goto iZNZx; Krlwz: } goto vRWac; vmEWJ: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto CLNd9; xQ40N: foreach ($this->errors as $error) { goto QSpuh; QSpuh: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto Y_Kkd; Y_Kkd: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto sj3Qa; sj3Qa: LsMXH: goto iNZsh; iNZsh: } goto c5ibb; UdUOl: return $_output; goto H0_Bw; CLNd9: $_output = ''; goto xQ40N; c5ibb: MTCyM: goto UdUOl; H0_Bw: } public function errors_array($langify = TRUE) { goto vP_B7; qyuaM: return $this->errors; goto VUG1h; H1sMi: return $_output; goto tVRL9; PlxEa: NT6V0: goto W7h_n; tVRL9: dW_7f: goto yMF82; W7h_n: $_output = []; goto dHF3T; VUG1h: goto dW_7f; goto PlxEa; DNwqX: S_i3H: goto H1sMi; dHF3T: foreach ($this->errors as $error) { goto JoBJC; R_QZx: JpSVG: goto oMYGe; JoBJC: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\x23"; goto rtgO0; rtgO0: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto R_QZx; oMYGe: } goto DNwqX; vP_B7: if ($langify) { goto NT6V0; } goto qyuaM; yMF82: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto WEi26; WEi26: $hash = $this->hash_password($password, $identity); goto UNZyx; qInh_: $this->trigger_events("\145\170\164\162\141\137\167\150\x65\x72\x65"); goto Ki5uF; UNZyx: if (!($hash === FALSE)) { goto Rym8E; } goto hR0md; hR0md: return FALSE; goto SjqdJ; Ki5uF: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, [$this->identity_column => $identity]); goto cCtqP; bwGUh: $data = ["\x70\x61\163\x73\167\157\x72\144" => $hash, "\162\145\x6d\145\155\x62\x65\162\x5f\x63\x6f\x64\x65" => NULL, "\146\157\162\147\x6f\x74\164\x65\x6e\x5f\x70\x61\163\163\167\157\162\144\137\x63\x6f\144\145" => NULL, "\x66\x6f\x72\147\x6f\x74\x74\145\156\x5f\160\x61\x73\163\167\x6f\x72\144\x5f\164\151\155\145" => NULL]; goto qInh_; SjqdJ: Rym8E: goto bwGUh; cCtqP: return $this->db->affected_rows() == 1; goto LKRgS; LKRgS: } protected function _filter_data($table, $data) { goto ho7ZL; iXg2e: return $filtered_data; goto AX5hi; MREQh: q6TWL: goto iXg2e; yu3NS: foreach ($columns as $column) { goto Pdre3; bg1So: ti0fj: goto i2Ddt; Pdre3: if (!array_key_exists($column, $data)) { goto XLvDw; } goto DwUr_; cGCxX: XLvDw: goto bg1So; DwUr_: $filtered_data[$column] = $data[$column]; goto cGCxX; i2Ddt: } goto aGhjB; A0a36: if (!is_array($data)) { goto q6TWL; } goto yu3NS; cqBqK: $columns = $this->db->list_fields($table); goto A0a36; ho7ZL: $filtered_data = []; goto cqBqK; aGhjB: KkV6E: goto MREQh; AX5hi: } protected function _random_token($result_length = 32) { goto TCsEd; k63cD: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto xHCBj; lCXf1: bqBc8: goto cRT0q; VIDFU: if (!function_exists("\x72\141\156\x64\x6f\155\x5f\142\171\x74\145\163")) { goto bqBc8; } goto gTOrU; ixAOK: $result_length = 32; goto OuAMr; OuAMr: o79eR: goto VIDFU; ck7DU: return FALSE; goto PNZjG; cRT0q: if (!function_exists("\155\143\162\171\160\164\137\143\x72\x65\x61\164\145\137\151\166")) { goto Avb3E; } goto k63cD; ADVEq: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto oqCYd; XHaXe: if (!function_exists("\157\x70\145\156\163\163\154\137\x72\141\x6e\144\157\x6d\137\160\163\145\x75\144\157\137\x62\171\164\x65\163")) { goto KwQdR; } goto ADVEq; oqCYd: KwQdR: goto ck7DU; xHCBj: Avb3E: goto XHaXe; gTOrU: return bin2hex(random_bytes($result_length / 2)); goto lCXf1; TCsEd: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto o79eR; } goto ixAOK; PNZjG: } protected function _get_hash_parameters($identity = NULL) { goto xKtc6; iIBkI: $params = FALSE; goto R6Qc5; R6Qc5: switch ($this->hash_method) { case "\142\143\x72\x79\160\164": $params = ["\x63\157\163\x74" => $is_admin ? $this->config->item("\x62\x63\x72\x79\x70\164\x5f\x61\x64\155\x69\x6e\137\143\x6f\x73\164", "\x69\157\x6e\x5f\141\165\x74\150") : $this->config->item("\142\x63\162\x79\160\x74\137\144\x65\146\x61\165\x6c\164\137\x63\157\163\164", "\x69\x6f\x6e\137\141\165\164\x68")]; goto fOF09; case "\141\162\x67\157\x6e\62": $params = $is_admin ? $this->config->item("\141\x72\x67\x6f\x6e\62\137\x61\144\x6d\x69\x6e\137\160\141\162\141\x6d\163", "\x69\157\x6e\x5f\141\x75\x74\x68") : $this->config->item("\141\x72\147\157\156\62\137\144\145\146\x61\165\x6c\164\x5f\x70\x61\162\x61\x6d\163", "\x69\157\x6e\x5f\141\165\x74\x68"); goto fOF09; default: } goto Pa9VN; AF5Mf: tQeKx: goto ZjWSX; WZ31V: if (!($user_id && $this->in_group($this->config->item("\141\x64\155\151\156\137\x67\x72\157\165\x70", "\151\157\156\137\x61\x75\164\150"), $user_id))) { goto tQeKx; } goto HvySn; Wg99y: return $params; goto jKH5i; Pa9VN: N3GLR: goto RhPcL; ZjWSX: GInek: goto iIBkI; oTGvr: $user_id = $this->get_user_id_from_identity($identity); goto WZ31V; IfLPL: if (!$identity) { goto GInek; } goto oTGvr; RhPcL: fOF09: goto Wg99y; HvySn: $is_admin = TRUE; goto AF5Mf; xKtc6: $is_admin = FALSE; goto IfLPL; jKH5i: } protected function _get_hash_algo() { goto lLej5; Nno32: switch ($this->hash_method) { case "\x62\x63\162\171\x70\164": $algo = PASSWORD_BCRYPT; goto XMvBf; case "\141\162\x67\157\x6e\62": $algo = PASSWORD_ARGON2I; goto XMvBf; default: } goto SlTDK; lLej5: $algo = FALSE; goto Nno32; SlTDK: jwxHu: goto wcDcx; DIgT2: return $algo; goto jWJzi; wcDcx: XMvBf: goto DIgT2; jWJzi: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto AGK1o; GMF_l: return (object) ["\163\x65\154\145\x63\x74\157\162" => $selector, "\x76\141\x6c\151\144\x61\x74\157\162\137\x68\141\163\x68\145\144" => $validator_hashed, "\165\x73\145\x72\137\x63\157\144\145" => $user_code]; goto jWZjX; reNk6: $user_code = "{$selector}\x2e{$validator}"; goto GMF_l; AGK1o: $selector = $this->_random_token($selector_size); goto W3M22; siup3: $validator_hashed = $this->hash_password($validator); goto reNk6; W3M22: $validator = $this->_random_token($validator_size); goto siup3; jWZjX: } protected function _retrieve_selector_validator_couple($user_code) { goto zRT0m; zRT0m: if (!$user_code) { goto uKjbD; } goto WDhfN; WDhfN: $tokens = explode("\56", $user_code); goto M_VBz; Bz41z: Jao7u: goto ufn8S; ufn8S: uKjbD: goto h9P0K; M_VBz: if (!(count($tokens) === 2)) { goto Jao7u; } goto WC6ei; WC6ei: return (object) ["\163\145\x6c\145\x63\x74\157\x72" => $tokens[0], "\x76\141\x6c\151\x64\141\x74\x6f\162" => $tokens[1]]; goto Bz41z; h9P0K: return FALSE; goto mHeF3; mHeF3: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto mVSCP; sCwKC: if ($result) { goto rss5j; } goto SW9Wk; SW9Wk: $this->trigger_events(["\x70\x6f\163\164\137\163\x68\x61\x31\137\x70\141\x73\163\167\x6f\x72\144\137\x6d\x69\147\162\141\x74\x69\157\x6e", "\160\157\x73\164\x5f\x73\150\141\61\137\x70\x61\x73\163\x77\157\162\x64\x5f\x6d\x69\147\162\x61\164\x69\x6f\x6e\137\x75\156\x73\165\143\143\x65\163\163\x66\x75\154"]); goto NkMSp; mVSCP: $this->trigger_events("\x70\162\x65\137\163\x68\141\61\x5f\x70\141\163\163\x77\x6f\x72\144\137\x6d\151\147\x72\x61\164\x69\x6f\156"); goto VaP4L; driMy: zs5ww: goto QqvA4; NkMSp: goto Fnip5; goto tGS2h; HnRFF: $salt_db = $query->row(); goto P7t1Q; P7t1Q: if (!($query->num_rows() !== 1)) { goto l3rVA; } goto XO2YF; Z00lU: return FALSE; goto ZFhqR; yLRXB: $hashed_password = sha1($password . $salt_db->salt); goto DGo8K; VgrRb: l3rVA: goto yLRXB; Fp9iu: $this->trigger_events(["\x70\x6f\163\164\x5f\163\x68\x61\61\137\x70\x61\x73\163\x77\x6f\162\144\x5f\155\x69\147\x72\141\164\151\157\156", "\x70\157\x73\164\137\163\x68\x61\61\137\x70\x61\x73\163\x77\x6f\162\144\x5f\155\151\x67\162\x61\x74\x69\x6f\156\137\x73\x75\x63\143\x65\x73\163\x66\x75\154"]); goto mp2L5; lacH5: $salt = substr($hashed_password_db, 0, $salt_length); goto Ylr5k; tGS2h: rss5j: goto Fp9iu; v43p1: XkLdK: goto m0uM_; VaP4L: if ($this->config->item("\x73\x74\157\x72\145\137\163\141\154\x74", "\x69\x6f\156\x5f\x61\x75\x74\150")) { goto XkLdK; } goto uWhK_; eAzzD: goto voLtO; goto v43p1; trTFf: if ($salt_length) { goto A4Wos; } goto dhlUo; R7DCO: if ($hashed_password === $hashed_password_db) { goto zs5ww; } goto vaQpB; a7G89: goto v2fj9; goto driMy; DGo8K: voLtO: goto R7DCO; RbfjU: return $result; goto eSMVW; Cm9ez: return FALSE; goto a7G89; QqvA4: $result = $this->_set_password_db($identity, $password); goto sCwKC; Bjj7c: return FALSE; goto VgrRb; dhlUo: $this->trigger_events(["\x70\157\163\164\137\163\x68\x61\x31\137\160\x61\x73\163\167\x6f\162\x64\137\155\x69\x67\x72\x61\164\151\x6f\x6e", "\160\x6f\163\164\x5f\x73\x68\x61\x31\x5f\160\x61\x73\163\167\157\162\144\x5f\155\x69\147\162\141\x74\x69\157\x6e\137\165\156\163\x75\143\143\145\163\163\146\x75\154"]); goto Z00lU; mp2L5: Fnip5: goto RbfjU; XO2YF: $this->trigger_events(["\160\x6f\163\x74\137\x73\x68\141\61\137\x70\141\163\163\167\157\162\x64\137\155\x69\147\162\x61\x74\x69\157\x6e", "\160\157\163\164\x5f\163\150\141\61\x5f\x70\141\x73\163\167\157\162\144\137\155\x69\147\x72\x61\x74\x69\x6f\x6e\x5f\x75\x6e\163\x75\x63\x63\145\163\x73\x66\165\154"]); goto Bjj7c; m0uM_: $query = $this->db->select("\x73\141\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\x73\x65\162\x73"]); goto HnRFF; ZFhqR: A4Wos: goto lacH5; vaQpB: $this->trigger_events(["\x70\157\163\x74\x5f\x73\150\x61\61\137\x70\141\x73\163\x77\157\x72\144\x5f\x6d\151\x67\162\141\x74\x69\157\156", "\x70\157\x73\164\x5f\x73\150\141\61\x5f\x70\x61\163\x73\x77\157\x72\x64\137\x6d\151\147\162\x61\164\x69\157\x6e\137\x75\156\163\165\143\x63\145\163\163\146\165\x6c"]); goto Cm9ez; uWhK_: $salt_length = $this->config->item("\x73\x61\154\x74\137\x6c\x65\156\147\x74\150", "\x69\x6f\156\137\x61\x75\x74\150"); goto trTFf; eSMVW: v2fj9: goto wpo7q; Ylr5k: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto eAzzD; wpo7q: } }
