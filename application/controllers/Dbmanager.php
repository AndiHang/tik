<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\105\x50\101\124\110") or exit("\x4e\x6f\x20\x64\x69\x72\145\143\164\40\163\x63\162\151\x70\x74\40\141\143\143\145\x73\x73\40\x61\154\x6c\157\x77\145\x64"); class Dbmanager extends CI_Controller { public function __construct() { goto tiauJ; tiauJ: parent::__construct(); goto HRzRt; jBXOs: bQg2D: goto vIaOT; HRzRt: if (!$this->ion_auth->logged_in()) { goto T8zTP; } goto yEF4X; vIaOT: goto vR_Zs; goto GH_E6; Tj23L: $this->load->helper("\144\151\x72\145\143\x74\157\162\x79"); goto fRiLJ; u00AY: show_error("\x48\x61\x6e\171\x61\x20\x41\144\155\151\x6e\x20\171\141\x6e\147\x20\x62\157\x6c\x65\150\x20\x6d\x65\156\147\x61\x6b\163\x65\x73\40\150\141\154\x61\x6d\141\x6e\x20\151\x6e\x69", 403, "\x41\153\163\x65\x73\40\144\151\154\x61\x72\x61\x6e\147"); goto jBXOs; FcjGa: $this->load->library("\165\x70\154\157\141\144"); goto NXg27; aYzxi: redirect("\x61\x75\x74\x68"); goto c1VC8; yEF4X: if ($this->ion_auth->is_admin()) { goto bQg2D; } goto u00AY; GH_E6: T8zTP: goto aYzxi; c1VC8: vR_Zs: goto FcjGa; PgDhB: $this->load->model("\x44\x61\163\x68\x62\157\x61\162\x64\x5f\x6d\x6f\144\x65\154", "\144\141\x73\x68\x62\x6f\x61\162\144"); goto Tj23L; NXg27: $this->load->model("\123\145\x74\164\x69\156\147\x73\x5f\x6d\157\x64\x65\x6c", "\163\145\x74\x74\151\x6e\147\163"); goto PgDhB; fRiLJ: } public function output_json($data, $encode = true) { goto js8SE; ng65Y: $data = json_encode($data); goto l3JJ5; js8SE: if (!$encode) { goto rCGfe; } goto ng65Y; l3JJ5: rCGfe: goto Xxg79; Xxg79: $this->output->set_content_type("\141\160\x70\x6c\x69\143\141\164\x69\157\156\x2f\x6a\163\157\x6e")->set_output($data); goto F4KHG; F4KHG: } public function index() { goto C143_; Tz9Fz: $data["\163\x6d\164"] = $this->dashboard->getSemester(); goto HraIx; Kg1rp: $data["\x74\160\x5f\x61\x63\164\x69\166\x65"] = $this->dashboard->getTahunActive(); goto Tz9Fz; HraIx: $data["\163\x6d\164\x5f\x61\x63\x74\151\x76\145"] = $this->dashboard->getSemesterActive(); goto qBIKu; qIHsn: $data["\x6c\151\x73\x74"] = $arrFile; goto t6LoR; t6LoR: $data["\164\141\142\154\145\x73"] = $this->db->list_tables(); goto w0DxN; RDfgo: $this->load->view("\163\145\x74\164\x69\x6e\147\57\x64\142"); goto K8xqD; q75HS: UmWuY: goto qIHsn; Tc825: $arrFile = []; goto FrAhv; K8xqD: $this->load->view("\x5f\x74\145\x6d\160\154\141\x74\x65\x73\57\x64\141\163\x68\142\157\141\162\x64\x2f\137\x66\x6f\x6f\164\x65\x72"); goto osuvy; R8jYg: $data["\164\160"] = $this->dashboard->getTahun(); goto Kg1rp; w0DxN: $this->load->view("\x5f\x74\145\155\160\154\141\x74\x65\163\x2f\144\x61\163\150\142\157\141\162\144\x2f\137\150\x65\141\x64\145\x72", $data); goto RDfgo; FrAhv: foreach ($list as $key => $value) { goto a8Wde; a8Wde: $nfile = explode("\56", $value); goto B4Mzb; yN5D_: yhpfM: goto YIvtU; Tk8HT: $size = $this->formatSizeUnits(filesize("\56\57\x62\x61\x63\153\165\x70\163\57" . $value)); goto g0cG6; g0cG6: $arrFile[$key] = ["\x74\171\x70\x65" => $type, "\156\141\x6d\x61" => $nama, "\164\x67\154" => $tgl, "\163\x69\172\x65" => $size, "\x73\162\143" => $value]; goto yN5D_; DdXBp: $type = $nfile[1]; goto H4OYH; B4Mzb: $nama = $nfile[0]; goto DdXBp; H4OYH: $tgl = filemtime("\56\57\x62\x61\x63\153\x75\160\x73\57" . $value); goto Tk8HT; YIvtU: } goto q75HS; qBIKu: $list = directory_map("\x2e\57\x62\141\x63\x6b\165\160\x73\57"); goto Tc825; avD7K: $data = ["\x75\x73\x65\162" => $user, "\152\165\144\x75\x6c" => "\102\141\x63\x6b\165\160\40\x64\141\156\x20\x52\x65\163\164\157\162\145", "\x73\x75\x62\152\x75\144\x75\x6c" => "\x42\141\x63\153\165\160\x20\x53\x65\x6d\165\141\40\x44\141\164\141\142\141\163\x65\40\x64\141\x6e\40\106\151\x6c\145", "\x70\x72\x6f\146\151\x6c\x65" => $this->dashboard->getProfileAdmin($user->id), "\163\x65\164\164\x69\156\147" => $this->dashboard->getSetting()]; goto R8jYg; C143_: $user = $this->ion_auth->user()->row(); goto avD7K; osuvy: } public function manage() { goto PjMUD; PGlOO: u0CjI: goto xey0L; esg0k: $this->load->view("\x5f\x74\x65\x6d\160\x6c\x61\164\x65\163\x2f\144\x61\163\x68\142\x6f\141\162\x64\x2f\x5f\150\145\141\144\x65\x72", $data); goto YbMer; YbMer: $this->load->view("\163\x65\164\164\151\156\x67\57\155\x61\156\x61\x67\145"); goto jKJhW; PjMUD: $user = $this->ion_auth->user()->row(); goto NIVrF; jKJhW: $this->load->view("\x5f\164\x65\155\160\x6c\x61\x74\145\163\57\x64\x61\163\150\142\157\141\162\x64\x2f\x5f\146\x6f\157\164\x65\162"); goto d4LyK; r4WyS: $tables = $this->db->list_tables(); goto klT4_; nYomU: $data["\163\x6d\164"] = $this->dashboard->getSemester(); goto rmx6x; rmx6x: $data["\163\155\164\137\x61\x63\x74\151\166\x65"] = $this->dashboard->getSemesterActive(); goto Q_mHE; NIVrF: $data = ["\x75\x73\145\162" => $user, "\x6a\165\x64\165\154" => "\102\x65\x72\163\151\x68\x6b\x61\x6e\x20\104\141\x74\141", "\x73\x75\x62\x6a\x75\144\165\x6c" => "\x48\141\x70\165\163\40\104\x61\x74\141", "\160\162\x6f\x66\x69\154\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\164\x74\151\x6e\147" => $this->dashboard->getSetting()]; goto TKCp2; TKCp2: $data["\164\160"] = $this->dashboard->getTahun(); goto Y1Ezh; xey0L: $data["\164\141\142\x6c\145\x73"] = $data_tables; goto esg0k; klT4_: foreach ($tables as $table) { $data_tables[$table] = $this->settings->toJSON($table); do07q: } goto PGlOO; Y1Ezh: $data["\x74\x70\x5f\x61\143\x74\151\166\145"] = $this->dashboard->getTahunActive(); goto nYomU; Q_mHE: $data_tables = []; goto r4WyS; d4LyK: } public function truncate() { goto fvH00; fvH00: $tables = $this->db->list_tables(); goto Jh_jn; Jh_jn: $this->settings->truncate($tables); goto Nnwrl; Nnwrl: $this->output_json(["\163\x74\141\x74\x75\x73" => true]); goto FkEd3; FkEd3: } public function backupDb() { goto kCM8s; BaTzp: $backup = $this->dbutil->backup($prefs); goto Nk9A8; Gypsi: $this->output_json(["\164\x79\x70\x65" => "\x64\141\164\141\142\x61\163\145", "\155\x65\163\x73\x61\x67\145" => "\104\x61\x74\141\142\141\x73\145\x20\142\145\x72\150\141\163\151\154\40\x64\151\142\x61\x63\153\x75\160"]); goto rYN27; QMxss: write_file("\56\x2f\x62\141\x63\153\165\160\x73\57\142\141\143\x6b\165\x70\x2d\144\x62\x2d" . date("\131\55\155\x2d\x64\55\x48\x2d\x69\x2d\x73") . "\x2e\163\x71\x6c\56\x7a\x69\x70", $backup); goto Gypsi; kCM8s: $this->load->dbutil(); goto izDVk; Nk9A8: $this->load->helper("\146\151\154\x65"); goto QMxss; rSOGm: $prefs = ["\164\x61\x62\x6c\x65\x73" => $this->db->list_tables(), "\151\x67\156\x6f\162\145" => array(), "\146\157\x72\155\x61\164" => "\172\151\x70", "\146\151\x6c\x65\156\141\x6d\x65" => "\142\141\x63\x6b\165\x70\56\x73\x71\154", "\141\144\144\x5f\x64\x72\x6f\x70" => TRUE, "\141\144\x64\137\x69\156\163\145\162\164" => TRUE, "\x6e\145\x77\x6c\x69\x6e\145" => "\xa"]; goto BaTzp; izDVk: $this->dbutil->optimize_database(); goto rSOGm; rYN27: } public function backupData() { goto kbEx8; D669H: $this->output_json(["\x74\171\160\145" => "\146\151\x6c\145", "\155\145\x73\x73\x61\x67\x65" => "\x46\151\x6c\145\x20\144\x61\164\x61\x20\x62\x65\x72\x68\x61\x73\151\154\x20\x64\x69\142\141\x63\x6b\165\x70"]); goto jkrUB; QEhYR: $this->zip->archive("\56\x2f\142\x61\x63\x6b\165\x70\163\57\142\141\x63\x6b\x75\160\55\146\x69\x6c\145\55" . date("\x59\x2d\x6d\55\144\55\x48\x2d\x69\55\x73") . "\56\172\151\x70"); goto D669H; kbEx8: $this->load->library("\x7a\x69\160"); goto lansn; lansn: $this->zip->read_dir("\165\160\x6c\157\x61\x64\163"); goto QEhYR; jkrUB: } public function hapusBackup($src) { goto L1hzs; lp7m2: jHT4l: goto fs780; hkGtk: $this->output_json(["\163\x74\x61\x74\165\163" => true, "\155\145\x73\x73\x61\x67\x65" => "\102\x61\143\x6b\165\x70\x20\142\145\x72\150\x61\163\151\x6c\40\144\x69\x68\x61\x70\165\163"]); goto lp7m2; L1hzs: if (unlink("\x2e\x2f\x62\x61\x63\153\165\x70\163\57" . $src)) { goto UKfX6; } goto GrD4c; S70C1: UKfX6: goto hkGtk; GrD4c: $this->output_json(["\x73\164\141\164\165\x73" => false, "\x6d\145\x73\163\x61\x67\x65" => "\x47\141\147\x61\154\40\x6d\145\x6e\x67\x68\x61\x70\x75\163\40\142\141\x63\x6b\165\x70"]); goto qcLcZ; qcLcZ: goto jHT4l; goto S70C1; fs780: } function formatSizeUnits($bytes) { goto Fam0p; qCOPf: UJoSw: goto TzFZc; FV8cG: if ($bytes > 1) { goto XlYQ7; } goto JtVxV; Fam0p: if ($bytes >= 1073741824) { goto LM_86; } goto Huu_K; td38m: LM_86: goto Ljo8i; aqVgE: EK5eH: goto RwGUK; A91Ak: $bytes = number_format($bytes / 1024, 2) . "\40\x4b\x42"; goto sSZ6y; niKiB: goto YEo0F; goto px4gw; VqztG: goto YEo0F; goto qCOPf; RwGUK: $bytes = $bytes . "\x20\142\x79\x74\145"; goto boYyd; CmL1b: $bytes = $bytes . "\x20\x62\x79\164\x65\163"; goto buWqC; JtVxV: if ($bytes == 1) { goto EK5eH; } goto wIds3; wIds3: $bytes = "\60\x20\x62\171\164\x65\x73"; goto Rm44y; boYyd: YEo0F: goto okUR3; BqQow: XlYQ7: goto CmL1b; okUR3: return $bytes; goto bDVgO; px4gw: X2wKP: goto A91Ak; Huu_K: if ($bytes >= 1048576) { goto UJoSw; } goto p7vjo; Rm44y: goto YEo0F; goto td38m; sSZ6y: goto YEo0F; goto BqQow; buWqC: goto YEo0F; goto aqVgE; Ljo8i: $bytes = number_format($bytes / 1073741824, 2) . "\40\x47\x42"; goto VqztG; p7vjo: if ($bytes >= 1024) { goto X2wKP; } goto FV8cG; TzFZc: $bytes = number_format($bytes / 1048576, 2) . "\x20\x4d\x42"; goto niKiB; bDVgO: } }
