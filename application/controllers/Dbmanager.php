<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\x45\120\x41\124\x48") or exit("\x4e\157\40\x64\151\x72\x65\143\x74\40\163\143\x72\151\160\164\x20\x61\x63\143\x65\x73\x73\40\x61\154\154\x6f\x77\145\144"); class Dbmanager extends CI_Controller { public function __construct() { goto z1c2i; sWdIN: $this->load->helper("\144\x69\162\145\x63\164\x6f\x72\171"); goto eH3lv; k9FSY: RVPdy: goto JFOkX; pXkpM: R8a1E: goto e_J3r; aeE1X: $this->load->model("\104\141\x73\x68\x62\x6f\x61\162\144\x5f\155\157\144\145\154", "\144\x61\163\x68\142\x6f\x61\x72\x64"); goto sWdIN; e_J3r: redirect("\141\165\x74\x68"); goto axsGP; uH6Pp: show_error("\x48\x61\x6e\x79\141\x20\x41\x64\x6d\x69\x6e\x20\171\x61\x6e\x67\40\x62\x6f\x6c\x65\x68\40\x6d\145\156\x67\141\153\163\x65\x73\x20\x68\x61\154\x61\155\x61\156\40\x69\156\151", 403, "\x41\x6b\x73\x65\163\40\144\151\154\x61\x72\141\156\147"); goto k9FSY; hS1xy: $this->load->model("\x53\x65\164\x74\151\x6e\147\x73\137\155\x6f\144\x65\154", "\x73\145\164\164\x69\156\x67\163"); goto aeE1X; z1c2i: parent::__construct(); goto DJgW5; axsGP: etVv5: goto u2QXc; K49nw: if ($this->ion_auth->is_admin()) { goto RVPdy; } goto uH6Pp; DJgW5: if (!$this->ion_auth->logged_in()) { goto R8a1E; } goto K49nw; JFOkX: goto etVv5; goto pXkpM; u2QXc: $this->load->library("\165\160\154\157\141\x64"); goto hS1xy; eH3lv: } public function output_json($data, $encode = true) { goto jcXQf; EO5F_: $data = json_encode($data); goto KXS1N; KXS1N: z8k7g: goto xQlfZ; jcXQf: if (!$encode) { goto z8k7g; } goto EO5F_; xQlfZ: $this->output->set_content_type("\141\x70\160\x6c\x69\143\x61\164\x69\157\x6e\57\152\x73\157\156")->set_output($data); goto sJ2L9; sJ2L9: } public function index() { goto gbRzK; jOr_T: $data["\164\x70"] = $this->dashboard->getTahun(); goto g26mD; ekmNt: $this->load->view("\137\x74\x65\x6d\160\x6c\x61\x74\145\163\x2f\x64\141\163\x68\x62\x6f\x61\162\x64\x2f\137\x68\145\x61\x64\x65\162", $data); goto mgwO2; yf6BK: $arrFile = []; goto LIyky; YllQX: cUKw_: goto AffZq; nm7fp: $this->load->view("\137\x74\x65\155\x70\154\x61\x74\x65\163\57\x64\141\x73\x68\142\157\x61\162\x64\57\137\x66\x6f\157\164\x65\162"); goto E6x4d; mgwO2: $this->load->view("\x73\x65\x74\164\151\156\x67\x2f\144\142"); goto nm7fp; IUmTN: $data["\x73\155\164\137\x61\143\x74\x69\x76\x65"] = $this->dashboard->getSemesterActive(); goto lFNjD; g26mD: $data["\164\160\137\141\x63\164\x69\x76\x65"] = $this->dashboard->getTahunActive(); goto QRJGD; lFNjD: $list = directory_map("\56\57\x62\141\143\x6b\x75\x70\x73\57"); goto yf6BK; Ml6Pd: $data["\164\141\142\154\x65\x73"] = $this->db->list_tables(); goto ekmNt; DkoaS: $data = ["\165\x73\145\x72" => $user, "\x6a\165\x64\165\154" => "\x42\141\x63\x6b\x75\x70\x20\144\x61\x6e\x20\122\x65\x73\x74\x6f\x72\145", "\x73\165\x62\152\165\144\x75\154" => "\x42\x61\x63\x6b\165\x70\40\x53\145\155\165\x61\40\x44\141\164\x61\x62\x61\x73\145\x20\x64\x61\156\40\106\x69\154\x65", "\160\162\157\x66\x69\154\145" => $this->dashboard->getProfileAdmin($user->id), "\163\145\164\164\151\156\x67" => $this->dashboard->getSetting()]; goto jOr_T; LIyky: foreach ($list as $key => $value) { goto OInrG; GNnn7: S_7ch: goto SXeqJ; mkdy9: $size = $this->formatSizeUnits(filesize("\56\57\x62\x61\x63\x6b\x75\x70\163\57" . $value)); goto Gg8Lz; pfM9q: $tgl = filemtime("\56\57\x62\141\143\153\165\160\163\57" . $value); goto mkdy9; OInrG: $nfile = explode("\x2e", $value); goto Qe7jJ; Qe7jJ: $nama = $nfile[0]; goto nVb97; nVb97: $type = $nfile[1]; goto pfM9q; Gg8Lz: $arrFile[$key] = ["\x74\x79\160\145" => $type, "\x6e\x61\x6d\x61" => $nama, "\x74\x67\154" => $tgl, "\x73\x69\172\145" => $size, "\x73\162\x63" => $value]; goto GNnn7; SXeqJ: } goto YllQX; AffZq: $data["\154\151\x73\164"] = $arrFile; goto Ml6Pd; QRJGD: $data["\163\155\x74"] = $this->dashboard->getSemester(); goto IUmTN; gbRzK: $user = $this->ion_auth->user()->row(); goto DkoaS; E6x4d: } public function manage() { goto W7Aqe; fZi5a: G60sP: goto VIt62; tdOn3: $this->load->view("\x5f\164\x65\155\160\x6c\141\164\145\x73\57\x64\141\163\x68\142\x6f\x61\x72\144\x2f\x5f\150\x65\x61\x64\x65\x72", $data); goto r1Kmf; P0LVx: $data["\x73\x6d\164\137\x61\143\x74\x69\x76\x65"] = $this->dashboard->getSemesterActive(); goto rU_Gi; W7Aqe: $user = $this->ion_auth->user()->row(); goto nXlCh; VIt62: $data["\164\141\142\154\145\x73"] = $data_tables; goto tdOn3; ujocW: $data["\x74\160\x5f\141\x63\x74\151\166\x65"] = $this->dashboard->getTahunActive(); goto N8ocG; Bqf91: foreach ($tables as $table) { $data_tables[$table] = $this->settings->toJSON($table); FT5t6: } goto fZi5a; r1Kmf: $this->load->view("\x73\x65\164\164\x69\x6e\147\x2f\155\141\156\141\x67\145"); goto qcvmA; nXlCh: $data = ["\165\x73\x65\x72" => $user, "\152\165\144\x75\154" => "\102\x65\162\x73\151\150\153\x61\x6e\x20\104\x61\164\x61", "\x73\165\142\152\165\144\x75\154" => "\110\141\160\x75\x73\40\104\141\x74\x61", "\x70\162\x6f\146\x69\x6c\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\x74\x74\151\156\147" => $this->dashboard->getSetting()]; goto O3fAb; O3fAb: $data["\x74\x70"] = $this->dashboard->getTahun(); goto ujocW; qcvmA: $this->load->view("\137\164\145\x6d\160\x6c\141\x74\145\163\x2f\x64\141\x73\x68\x62\x6f\x61\x72\144\x2f\x5f\x66\157\157\x74\145\x72"); goto AXSls; mjiFh: $tables = $this->db->list_tables(); goto Bqf91; N8ocG: $data["\x73\155\x74"] = $this->dashboard->getSemester(); goto P0LVx; rU_Gi: $data_tables = []; goto mjiFh; AXSls: } public function truncate() { goto L8g6M; KZOot: $this->output_json(["\163\164\141\164\x75\x73" => true]); goto lx1XL; L8g6M: $tables = $this->db->list_tables(); goto PL5x1; PL5x1: $this->settings->truncate($tables); goto KZOot; lx1XL: } public function backupDb() { goto Xr0LZ; O4Xf0: $prefs = ["\x74\x61\x62\x6c\x65\x73" => $this->db->list_tables(), "\151\x67\x6e\x6f\x72\x65" => array(), "\146\157\x72\x6d\x61\164" => "\x7a\x69\x70", "\146\151\x6c\x65\x6e\141\x6d\x65" => "\x62\x61\143\x6b\x75\x70\x2e\163\161\x6c", "\141\x64\x64\x5f\144\162\x6f\x70" => TRUE, "\x61\144\144\137\x69\x6e\163\145\162\164" => TRUE, "\156\x65\167\x6c\x69\x6e\145" => "\xa"]; goto fZ467; N9VjT: write_file("\x2e\57\142\141\x63\153\x75\x70\163\57\142\141\143\153\165\160\55\144\142\55" . date("\x59\55\x6d\55\144\x2d\x48\55\151\x2d\x73") . "\56\163\x71\x6c\x2e\172\151\x70", $backup); goto DPXl6; fZ467: $backup = $this->dbutil->backup($prefs); goto w7oTC; DPXl6: $this->output_json(["\164\171\160\145" => "\x64\x61\x74\141\x62\141\x73\145", "\155\x65\163\x73\141\147\145" => "\x44\x61\x74\x61\142\141\x73\145\40\x62\x65\x72\x68\141\163\x69\x6c\40\144\x69\142\141\x63\153\x75\x70"]); goto MaHqR; Xr0LZ: $this->load->dbutil(); goto er9vi; er9vi: $this->dbutil->optimize_database(); goto O4Xf0; w7oTC: $this->load->helper("\146\x69\154\x65"); goto N9VjT; MaHqR: } public function backupData() { goto E6Jm0; E6Jm0: $this->load->library("\x7a\x69\160"); goto HDO1I; vtZN3: $this->output_json(["\164\171\x70\x65" => "\146\x69\x6c\x65", "\x6d\145\x73\x73\x61\x67\x65" => "\106\x69\154\145\x20\144\x61\164\x61\x20\x62\x65\162\150\141\163\x69\x6c\x20\x64\151\x62\141\x63\x6b\165\x70"]); goto i0fjO; x4jgI: $this->zip->archive("\56\57\142\141\x63\153\x75\x70\x73\x2f\142\x61\x63\153\165\160\55\146\x69\154\145\x2d" . date("\x59\x2d\x6d\x2d\x64\x2d\x48\55\x69\55\x73") . "\56\172\151\x70"); goto vtZN3; HDO1I: $this->zip->read_dir("\x75\x70\x6c\x6f\x61\144\x73"); goto x4jgI; i0fjO: } public function hapusBackup($src) { goto I10JB; nGIl_: goto DEcpo; goto tRIg9; OQUMx: DEcpo: goto u7vJf; tRIg9: ypNlp: goto aCckg; I10JB: if (unlink("\x2e\x2f\142\141\x63\x6b\165\x70\163\x2f" . $src)) { goto ypNlp; } goto HSQJw; HSQJw: $this->output_json(["\163\164\141\x74\x75\163" => false, "\155\145\163\163\x61\147\x65" => "\107\x61\x67\x61\154\x20\x6d\145\156\x67\150\x61\x70\x75\163\x20\142\x61\143\x6b\165\x70"]); goto nGIl_; aCckg: $this->output_json(["\163\164\141\164\x75\163" => true, "\155\x65\163\x73\x61\147\x65" => "\x42\x61\x63\x6b\165\160\40\x62\145\162\150\141\163\151\x6c\40\144\151\x68\141\x70\x75\x73"]); goto OQUMx; u7vJf: } function formatSizeUnits($bytes) { goto YSAs8; BgFV7: $bytes = number_format($bytes / 1048576, 2) . "\40\115\x42"; goto bY32D; YSAs8: if ($bytes >= 1073741824) { goto u9h_t; } goto WJZDK; WJZDK: if ($bytes >= 1048576) { goto Bu3dh; } goto SY7gU; Aovj2: pD_7s: goto OXCaS; T1nzl: goto pD_7s; goto wzbgV; jLgbi: $bytes = "\x30\40\142\171\x74\145\163"; goto zo4h8; UzGpG: LUptG: goto ItvaS; ItvaS: $bytes = number_format($bytes / 1024, 2) . "\40\113\x42"; goto Y4lDj; OXCaS: return $bytes; goto X3zWD; iCsWC: Bu3dh: goto BgFV7; eZ0_w: PXyJP: goto y7TcN; bY32D: goto pD_7s; goto UzGpG; zo4h8: goto pD_7s; goto jHrgK; yLtmK: if ($bytes > 1) { goto PXyJP; } goto dFtzB; Y4lDj: goto pD_7s; goto eZ0_w; jHrgK: u9h_t: goto LbNIX; m8H_w: goto pD_7s; goto iCsWC; dFtzB: if ($bytes == 1) { goto rPNqf; } goto jLgbi; y7TcN: $bytes = $bytes . "\x20\x62\171\x74\x65\x73"; goto T1nzl; SY7gU: if ($bytes >= 1024) { goto LUptG; } goto yLtmK; LbNIX: $bytes = number_format($bytes / 1073741824, 2) . "\40\107\x42"; goto m8H_w; PGhjS: $bytes = $bytes . "\40\142\171\164\145"; goto Aovj2; wzbgV: rPNqf: goto PGhjS; X3zWD: } }
