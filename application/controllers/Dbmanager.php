<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\105\x50\101\124\x48") or exit("\116\x6f\x20\144\151\162\145\x63\x74\40\163\x63\162\x69\160\164\40\x61\143\143\x65\163\x73\x20\141\154\x6c\x6f\167\x65\x64"); class Dbmanager extends CI_Controller { public function __construct() { goto Qfp5u; KxQbE: UtfG3: goto gXxCP; yvGg4: $this->load->model("\123\x65\x74\x74\x69\156\x67\x73\137\x6d\157\x64\145\154", "\x73\145\164\164\151\156\x67\x73"); goto HXFSx; h2a7R: if (!$this->ion_auth->logged_in()) { goto UtfG3; } goto yzB4f; HStuh: $this->load->library("\x75\x70\x6c\x6f\x61\144"); goto yvGg4; T3cxB: goto BKkO6; goto KxQbE; uHIw8: show_error("\x48\141\x6e\171\141\x20\101\x64\x6d\x69\156\x20\x79\x61\156\x67\40\x62\x6f\x6c\145\x68\40\155\145\x6e\147\141\153\x73\145\163\40\150\x61\x6c\141\x6d\141\156\x20\151\x6e\x69", 403, "\101\x6b\x73\145\163\x20\144\151\154\141\162\141\x6e\x67"); goto g_SKs; yzB4f: if ($this->ion_auth->is_admin()) { goto CK0_W; } goto uHIw8; HXFSx: $this->load->model("\104\141\163\150\142\157\141\x72\x64\137\x6d\157\x64\x65\x6c", "\x64\x61\x73\150\142\x6f\x61\x72\x64"); goto QYdaJ; QYdaJ: $this->load->helper("\x64\x69\x72\x65\x63\x74\157\x72\x79"); goto jNjpq; FSVmB: BKkO6: goto HStuh; g_SKs: CK0_W: goto T3cxB; gXxCP: redirect("\x61\165\x74\150"); goto FSVmB; Qfp5u: parent::__construct(); goto h2a7R; jNjpq: } public function output_json($data, $encode = true) { goto tDokp; tDokp: if (!$encode) { goto bvhRa; } goto OrOT_; cJ4fI: $this->output->set_content_type("\x61\160\x70\x6c\x69\143\x61\x74\151\x6f\x6e\57\x6a\163\157\x6e")->set_output($data); goto sLo_q; OrOT_: $data = json_encode($data); goto IDGKS; IDGKS: bvhRa: goto cJ4fI; sLo_q: } public function index() { goto t08e5; AHE5z: $data["\164\160"] = $this->dashboard->getTahun(); goto qbzxh; PMtKs: $list = directory_map("\x2e\57\142\x61\143\153\165\x70\x73\57"); goto LLrRq; qbzxh: $data["\x74\160\137\x61\x63\164\151\x76\145"] = $this->dashboard->getTahunActive(); goto VzKSZ; wxcFb: $this->load->view("\x5f\164\145\155\x70\154\x61\164\x65\163\x2f\144\x61\163\150\x62\157\141\162\x64\x2f\x5f\146\157\157\x74\145\162"); goto aRgiK; t08e5: $user = $this->ion_auth->user()->row(); goto FK_eR; ZtsNg: $data["\x6c\x69\163\164"] = $arrFile; goto vLUA2; mWenE: $this->load->view("\x5f\x74\145\155\160\x6c\x61\x74\x65\163\57\144\141\x73\150\142\x6f\x61\x72\144\x2f\x5f\150\145\141\x64\145\x72", $data); goto K5eyD; xZ1ho: kznQj: goto ZtsNg; LLrRq: $arrFile = []; goto Umdwu; Umdwu: foreach ($list as $key => $value) { goto ZtuFQ; ZtuFQ: $nfile = explode("\56", $value); goto In2ZG; jQ3Vm: $tgl = filemtime("\56\x2f\142\x61\x63\x6b\x75\x70\x73\57" . $value); goto gbpRS; gbpRS: $size = $this->formatSizeUnits(filesize("\56\57\x62\141\x63\x6b\x75\160\163\57" . $value)); goto BVotd; BVotd: $arrFile[$key] = ["\164\x79\x70\x65" => $type, "\x6e\x61\x6d\141" => $nama, "\x74\147\154" => $tgl, "\x73\151\x7a\x65" => $size, "\x73\162\143" => $value]; goto Tsa9Y; tW5Vr: $type = $nfile[1]; goto jQ3Vm; Tsa9Y: J4EEg: goto W3r_I; In2ZG: $nama = $nfile[0]; goto tW5Vr; W3r_I: } goto xZ1ho; K5eyD: $this->load->view("\163\x65\164\x74\x69\x6e\147\x2f\144\142"); goto wxcFb; VzKSZ: $data["\x73\x6d\164"] = $this->dashboard->getSemester(); goto rNjI2; FK_eR: $data = ["\x75\x73\x65\x72" => $user, "\152\x75\x64\165\154" => "\102\x61\x63\153\165\x70\x20\x64\x61\156\x20\x52\x65\x73\164\157\x72\145", "\x73\x75\x62\152\165\x64\x75\154" => "\x42\x61\143\153\165\160\x20\x53\145\155\165\141\x20\x44\x61\164\x61\x62\x61\163\145\40\x64\141\156\40\x46\151\x6c\x65", "\x70\162\x6f\x66\x69\154\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\x74\164\151\x6e\x67" => $this->dashboard->getSetting()]; goto AHE5z; vLUA2: $data["\x74\x61\142\x6c\x65\163"] = $this->db->list_tables(); goto mWenE; rNjI2: $data["\163\x6d\164\x5f\141\143\164\151\166\x65"] = $this->dashboard->getSemesterActive(); goto PMtKs; aRgiK: } public function manage() { goto gvk7u; ZVm2R: $this->load->view("\137\x74\x65\x6d\x70\x6c\x61\x74\x65\163\57\144\141\163\x68\142\x6f\141\162\x64\x2f\137\146\157\157\164\145\x72"); goto tbv1H; JJvn7: $data["\x74\160"] = $this->dashboard->getTahun(); goto AMa7q; eLHla: $this->load->view("\137\164\x65\155\160\x6c\141\x74\x65\x73\x2f\x64\x61\x73\150\142\157\141\x72\144\57\x5f\x68\x65\141\144\x65\x72", $data); goto es9dh; es9dh: $this->load->view("\163\145\164\164\151\156\x67\x2f\x6d\x61\156\141\147\x65"); goto ZVm2R; gvk7u: $user = $this->ion_auth->user()->row(); goto J052U; MMtUZ: $data["\x74\141\142\x6c\x65\x73"] = $data_tables; goto eLHla; GDzWU: $data["\163\155\164\137\141\x63\164\151\166\145"] = $this->dashboard->getSemesterActive(); goto n6ojj; sX7iB: $data["\x73\155\x74"] = $this->dashboard->getSemester(); goto GDzWU; TAaTu: $tables = $this->db->list_tables(); goto TcFjZ; AMa7q: $data["\x74\x70\x5f\x61\x63\x74\x69\x76\x65"] = $this->dashboard->getTahunActive(); goto sX7iB; Rro6E: rErkv: goto MMtUZ; TcFjZ: foreach ($tables as $table) { $data_tables[$table] = $this->settings->toJSON($table); bxVbX: } goto Rro6E; n6ojj: $data_tables = []; goto TAaTu; J052U: $data = ["\x75\x73\x65\x72" => $user, "\152\165\x64\x75\x6c" => "\x42\145\162\x73\x69\150\x6b\x61\156\40\104\x61\164\x61", "\x73\x75\x62\152\165\x64\x75\154" => "\110\141\160\x75\x73\40\x44\x61\x74\x61", "\160\x72\x6f\146\x69\154\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\164\x74\151\156\x67" => $this->dashboard->getSetting()]; goto JJvn7; tbv1H: } public function truncate() { goto jvecQ; jvecQ: $tables = $this->db->list_tables(); goto QeoAW; cpFH1: $this->output_json(["\x73\x74\141\164\x75\x73" => true]); goto B5oY4; QeoAW: $this->settings->truncate($tables); goto cpFH1; B5oY4: } public function backupDb() { goto a9ggK; zcj2U: $this->dbutil->optimize_database(); goto ot1nt; H8J5_: $this->load->helper("\x66\151\154\145"); goto uUDU6; ot1nt: $prefs = ["\164\141\142\154\x65\163" => $this->db->list_tables(), "\x69\147\156\157\162\x65" => array(), "\146\157\x72\155\x61\x74" => "\172\x69\x70", "\x66\x69\x6c\x65\156\141\155\x65" => "\x62\141\x63\x6b\165\160\56\163\161\x6c", "\141\144\144\x5f\x64\x72\x6f\160" => TRUE, "\141\x64\x64\x5f\151\156\163\145\162\x74" => TRUE, "\x6e\x65\167\154\x69\x6e\145" => "\12"]; goto pXhZU; a9ggK: $this->load->dbutil(); goto zcj2U; pXhZU: $backup = $this->dbutil->backup($prefs); goto H8J5_; v29UN: $this->output_json(["\164\171\160\145" => "\x64\141\164\141\142\141\x73\145", "\155\145\x73\x73\x61\x67\x65" => "\104\141\x74\x61\142\x61\163\x65\40\142\145\162\x68\x61\163\151\x6c\40\144\x69\142\141\x63\153\165\160"]); goto JFR_b; uUDU6: write_file("\56\x2f\x62\x61\143\153\165\x70\163\x2f\x62\141\143\x6b\x75\x70\x2d\144\142\55" . date("\131\55\155\x2d\x64\x2d\110\55\151\55\x73") . "\x2e\x73\x71\x6c\56\172\x69\x70", $backup); goto v29UN; JFR_b: } public function backupData() { goto P3wCi; FKNYs: $this->output_json(["\164\x79\x70\145" => "\x66\151\154\145", "\x6d\145\x73\163\141\147\x65" => "\106\x69\154\145\x20\x64\141\164\x61\40\x62\x65\162\150\141\163\x69\154\40\144\151\x62\141\x63\x6b\x75\x70"]); goto ST_6E; d_TCt: $this->zip->archive("\56\57\142\x61\x63\x6b\x75\160\163\x2f\x62\x61\x63\153\165\160\55\x66\x69\x6c\x65\55" . date("\x59\x2d\x6d\x2d\144\x2d\x48\x2d\x69\55\163") . "\x2e\172\151\x70"); goto FKNYs; P3wCi: $this->load->library("\x7a\x69\x70"); goto Yn53F; Yn53F: $this->zip->read_dir("\x75\160\x6c\x6f\x61\x64\163"); goto d_TCt; ST_6E: } public function hapusBackup($src) { goto MQUby; RH6c_: goto Ejyq1; goto NVmSK; SuXyE: $this->output_json(["\163\x74\x61\164\x75\x73" => true, "\155\x65\163\x73\x61\147\145" => "\102\141\143\x6b\x75\x70\40\x62\145\x72\x68\141\x73\x69\x6c\x20\144\151\150\x61\160\x75\x73"]); goto k4N1A; NVmSK: PDkvz: goto SuXyE; k4N1A: Ejyq1: goto R5F0X; UywE5: $this->output_json(["\x73\164\x61\x74\x75\163" => false, "\155\145\163\x73\141\147\x65" => "\x47\141\x67\x61\x6c\x20\155\x65\156\147\x68\x61\x70\x75\163\40\142\x61\143\x6b\165\x70"]); goto RH6c_; MQUby: if (unlink("\x2e\x2f\142\x61\x63\153\x75\160\x73\x2f" . $src)) { goto PDkvz; } goto UywE5; R5F0X: } function formatSizeUnits($bytes) { goto fBkuq; beMQe: goto IgutL; goto U9TTV; SSlcJ: ivs0_: goto nM7xU; nM7xU: $bytes = $bytes . "\x20\142\x79\164\x65\163"; goto dS3dg; t0fEs: $bytes = $bytes . "\40\142\x79\164\145"; goto vxNgl; dvhN2: tSuGR: goto Pkcll; hb1QO: $bytes = "\x30\40\x62\x79\x74\145\163"; goto FJtJD; BJSlY: if ($bytes >= 1048576) { goto NXILj; } goto tQqRa; vxNgl: IgutL: goto UqiKU; iuN28: goto IgutL; goto SSlcJ; tQqRa: if ($bytes >= 1024) { goto OIfz4; } goto CAhtz; dS3dg: goto IgutL; goto ksF0I; uLLm6: $bytes = number_format($bytes / 1048576, 2) . "\x20\x4d\102"; goto beMQe; CAhtz: if ($bytes > 1) { goto ivs0_; } goto cbH7G; Pkcll: $bytes = number_format($bytes / 1073741824, 2) . "\40\107\102"; goto GZz4T; UqiKU: return $bytes; goto NTyRK; FJtJD: goto IgutL; goto dvhN2; cbH7G: if ($bytes == 1) { goto uzj8B; } goto hb1QO; vWOCq: NXILj: goto uLLm6; U9TTV: OIfz4: goto xdAqW; fBkuq: if ($bytes >= 1073741824) { goto tSuGR; } goto BJSlY; GZz4T: goto IgutL; goto vWOCq; ksF0I: uzj8B: goto t0fEs; xdAqW: $bytes = number_format($bytes / 1024, 2) . "\x20\x4b\102"; goto iuN28; NTyRK: } }
