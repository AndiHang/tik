<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\x45\x50\x41\x54\x48") or exit("\116\157\x20\144\151\x72\x65\x63\x74\x20\163\143\x72\x69\x70\164\40\x61\x63\143\145\163\163\40\141\154\x6c\157\167\x65\144"); class Dbmanager extends CI_Controller { public function __construct() { goto CmTug; jKqyg: show_error("\x48\141\x6e\171\x61\40\101\x64\155\x69\x6e\x20\171\141\x6e\147\x20\142\157\x6c\145\150\40\x6d\x65\x6e\x67\141\153\x73\145\x73\40\x68\141\154\141\x6d\x61\156\x20\x69\156\x69", 403, "\101\x6b\163\145\x73\x20\x64\151\x6c\x61\162\x61\x6e\x67"); goto S0D36; lArBU: if (!$this->ion_auth->logged_in()) { goto if1Fx; } goto cBxV3; LTyO1: $this->load->model("\x53\145\164\164\151\156\x67\x73\x5f\155\x6f\144\145\154", "\x73\x65\x74\x74\151\156\147\x73"); goto mjzd4; CmTug: parent::__construct(); goto lArBU; mjzd4: $this->load->model("\104\x61\163\x68\x62\157\141\162\144\x5f\x6d\157\x64\x65\154", "\144\141\x73\150\x62\x6f\141\x72\x64"); goto WzfBC; FtAhM: $this->load->library("\165\x70\x6c\x6f\141\144"); goto LTyO1; jDohh: if1Fx: goto hnznc; cBxV3: if ($this->ion_auth->is_admin()) { goto pMguv; } goto jKqyg; WzfBC: $this->load->helper("\x64\x69\162\145\x63\x74\x6f\162\171"); goto pMRR2; EPWDO: SfTjW: goto FtAhM; rxDtS: goto SfTjW; goto jDohh; hnznc: redirect("\141\x75\164\150"); goto EPWDO; S0D36: pMguv: goto rxDtS; pMRR2: } public function output_json($data, $encode = true) { goto x8rH1; lMF9c: $data = json_encode($data); goto NRm3I; NRm3I: XFAl1: goto fR9Iy; fR9Iy: $this->output->set_content_type("\141\160\160\154\151\x63\x61\x74\x69\x6f\156\57\152\163\x6f\156")->set_output($data); goto pV2eI; x8rH1: if (!$encode) { goto XFAl1; } goto lMF9c; pV2eI: } public function index() { goto GPpsf; spLA0: $data = ["\165\163\145\x72" => $user, "\x6a\x75\x64\165\x6c" => "\x42\141\143\153\165\x70\x20\144\141\x6e\40\122\x65\163\x74\x6f\x72\145", "\x73\165\x62\152\x75\144\x75\154" => "\102\x61\143\x6b\x75\160\40\123\145\x6d\165\141\x20\104\141\164\x61\x62\x61\163\145\x20\144\141\156\x20\x46\151\x6c\x65", "\160\162\x6f\146\x69\x6c\x65" => $this->dashboard->getProfileAdmin($user->id), "\163\x65\164\x74\x69\156\147" => $this->dashboard->getSetting()]; goto iBVWc; MV0hM: EneDk: goto RfIkb; zJFiW: $data["\163\155\x74\137\x61\x63\164\151\166\x65"] = $this->dashboard->getSemesterActive(); goto O5P7D; GHZi8: foreach ($list as $key => $value) { goto TMisF; TMisF: $nfile = explode("\56", $value); goto WdPLA; bzJWd: $size = $this->formatSizeUnits(filesize("\x2e\x2f\142\x61\x63\153\165\x70\163\57" . $value)); goto NDd1x; WdPLA: $nama = $nfile[0]; goto UC1_9; Afvqr: $tgl = filemtime("\x2e\x2f\142\x61\x63\x6b\x75\160\x73\57" . $value); goto bzJWd; UC1_9: $type = $nfile[1]; goto Afvqr; NDd1x: $arrFile[$key] = ["\x74\171\160\145" => $type, "\x6e\x61\155\141" => $nama, "\164\147\154" => $tgl, "\x73\x69\x7a\x65" => $size, "\x73\x72\x63" => $value]; goto Mcvqb; Mcvqb: NGGW4: goto CLmpV; CLmpV: } goto MV0hM; RfIkb: $data["\154\151\x73\164"] = $arrFile; goto NbA9V; eurxd: $this->load->view("\x73\x65\164\164\151\x6e\147\x2f\144\x62"); goto BSCPq; BSCPq: $this->load->view("\137\164\x65\x6d\x70\154\x61\x74\x65\163\57\144\141\163\x68\142\157\x61\x72\x64\57\137\x66\157\157\164\145\162"); goto p99wh; LPpos: $data["\x74\x70\x5f\x61\143\x74\x69\166\145"] = $this->dashboard->getTahunActive(); goto ZTknf; O5P7D: $list = directory_map("\x2e\57\x62\141\x63\153\165\160\x73\57"); goto ccOhV; ZTknf: $data["\x73\x6d\164"] = $this->dashboard->getSemester(); goto zJFiW; iBVWc: $data["\x74\160"] = $this->dashboard->getTahun(); goto LPpos; GPpsf: $user = $this->ion_auth->user()->row(); goto spLA0; ccOhV: $arrFile = []; goto GHZi8; NbA9V: $data["\x74\x61\142\x6c\x65\163"] = $this->db->list_tables(); goto tZnKO; tZnKO: $this->load->view("\137\164\x65\155\x70\154\141\164\x65\x73\x2f\x64\141\163\150\x62\157\141\162\x64\x2f\x5f\150\145\x61\x64\145\162", $data); goto eurxd; p99wh: } public function manage() { goto Ip983; p34QV: $data["\163\155\164"] = $this->dashboard->getSemester(); goto kjQ1S; qpwkJ: $data["\164\x61\x62\x6c\x65\x73"] = $data_tables; goto HtU63; YhKqU: $data["\x74\x70\137\141\143\164\151\166\145"] = $this->dashboard->getTahunActive(); goto p34QV; o2rbb: $data_tables = []; goto hF6Lr; s775I: $this->load->view("\x73\145\164\164\151\156\147\x2f\x6d\141\156\x61\x67\x65"); goto HtEOd; HtEOd: $this->load->view("\137\x74\145\155\160\154\x61\164\x65\163\57\144\x61\x73\150\142\157\x61\x72\144\x2f\137\146\x6f\x6f\x74\145\x72"); goto FlWdY; W_xHM: foreach ($tables as $table) { $data_tables[$table] = $this->settings->toJSON($table); Usyun: } goto PZtAG; kjQ1S: $data["\x73\x6d\x74\x5f\x61\143\164\x69\166\145"] = $this->dashboard->getSemesterActive(); goto o2rbb; PZtAG: A3db5: goto qpwkJ; xeUIR: $data = ["\x75\163\145\162" => $user, "\152\165\x64\x75\154" => "\x42\145\162\x73\x69\150\153\141\156\40\x44\x61\164\x61", "\x73\165\x62\x6a\x75\144\165\x6c" => "\x48\x61\x70\x75\163\x20\x44\x61\x74\141", "\x70\x72\157\146\x69\154\x65" => $this->dashboard->getProfileAdmin($user->id), "\163\145\164\x74\x69\156\147" => $this->dashboard->getSetting()]; goto NIQ80; HtU63: $this->load->view("\137\164\145\155\160\154\x61\164\145\x73\57\144\x61\x73\150\x62\157\x61\162\x64\x2f\x5f\150\x65\x61\144\x65\162", $data); goto s775I; hF6Lr: $tables = $this->db->list_tables(); goto W_xHM; Ip983: $user = $this->ion_auth->user()->row(); goto xeUIR; NIQ80: $data["\x74\160"] = $this->dashboard->getTahun(); goto YhKqU; FlWdY: } public function truncate() { goto Q3DhH; Hb_3B: $this->output_json(["\163\x74\141\x74\x75\x73" => true]); goto mFK0q; bY5bR: $this->settings->truncate($tables); goto Hb_3B; Q3DhH: $tables = $this->db->list_tables(); goto bY5bR; mFK0q: } public function backupDb() { goto kD2rj; kiYYM: $this->output_json(["\164\171\x70\145" => "\x64\x61\164\141\x62\141\x73\x65", "\155\145\x73\x73\x61\x67\x65" => "\x44\141\164\x61\x62\x61\x73\x65\40\142\x65\x72\x68\x61\x73\x69\x6c\x20\144\151\x62\141\x63\153\x75\160"]); goto wauUL; DBMEw: $this->load->helper("\x66\x69\x6c\145"); goto Ubhq6; C2xny: $this->dbutil->optimize_database(); goto XDj7v; FcfLq: $backup = $this->dbutil->backup($prefs); goto DBMEw; XDj7v: $prefs = ["\x74\x61\142\154\x65\163" => $this->db->list_tables(), "\151\147\x6e\157\x72\145" => array(), "\x66\x6f\162\x6d\141\164" => "\172\151\160", "\146\x69\154\x65\x6e\141\155\x65" => "\x62\141\143\x6b\165\160\x2e\x73\161\x6c", "\x61\144\x64\x5f\x64\x72\x6f\x70" => TRUE, "\141\x64\144\137\x69\x6e\x73\145\162\164" => TRUE, "\156\x65\x77\x6c\151\x6e\145" => "\12"]; goto FcfLq; Ubhq6: write_file("\x2e\x2f\142\141\x63\x6b\x75\x70\163\57\142\141\x63\x6b\x75\x70\55\x64\142\x2d" . date("\x59\x2d\x6d\x2d\144\x2d\x48\x2d\151\x2d\163") . "\x2e\x73\x71\x6c\56\172\x69\160", $backup); goto kiYYM; kD2rj: $this->load->dbutil(); goto C2xny; wauUL: } public function backupData() { goto HwRk2; HwRk2: $this->load->library("\172\151\x70"); goto Va_Ea; l3Iu0: $this->output_json(["\x74\171\160\145" => "\x66\x69\154\x65", "\155\145\163\x73\141\147\x65" => "\x46\x69\154\x65\x20\x64\x61\164\x61\x20\142\x65\x72\x68\x61\163\151\154\x20\144\151\142\141\x63\153\x75\x70"]); goto Jo3wy; aeWZK: $this->zip->archive("\x2e\x2f\x62\141\x63\153\165\160\163\x2f\142\141\x63\x6b\165\x70\x2d\146\x69\x6c\145\55" . date("\131\55\x6d\x2d\x64\x2d\110\x2d\151\55\163") . "\x2e\172\151\x70"); goto l3Iu0; Va_Ea: $this->zip->read_dir("\165\160\x6c\157\141\144\x73"); goto aeWZK; Jo3wy: } public function hapusBackup($src) { goto ROcIP; IVkzC: goto SNCac; goto mhEWk; ROcIP: if (unlink("\x2e\57\x62\141\143\153\x75\x70\163\x2f" . $src)) { goto Zw1OI; } goto gQh1M; ASSy5: $this->output_json(["\163\164\x61\164\x75\163" => true, "\155\x65\x73\x73\x61\147\x65" => "\102\x61\143\153\165\160\x20\142\x65\x72\150\141\163\x69\x6c\40\x64\x69\x68\141\x70\x75\163"]); goto wtf2m; mhEWk: Zw1OI: goto ASSy5; gQh1M: $this->output_json(["\163\x74\x61\x74\x75\163" => false, "\155\x65\x73\163\141\x67\x65" => "\107\141\x67\x61\154\x20\155\145\156\147\150\141\x70\165\x73\40\142\141\x63\153\165\x70"]); goto IVkzC; wtf2m: SNCac: goto fba3r; fba3r: } function formatSizeUnits($bytes) { goto Pmgj0; Yf1kp: gS7SN: goto wQfM6; wQfM6: $bytes = number_format($bytes / 1048576, 2) . "\40\115\102"; goto ZYmtT; jmNpS: if ($bytes >= 1048576) { goto gS7SN; } goto rCcqO; bhj6c: if ($bytes > 1) { goto TFL_H; } goto ZIKnQ; FmOWg: z6bd7: goto V5sTG; seKok: goto oIuHX; goto q7CMP; dXcDc: $bytes = "\x30\x20\142\x79\164\x65\x73"; goto tH4j7; xydFf: return $bytes; goto sIXyz; ZIKnQ: if ($bytes == 1) { goto TbdPE; } goto dXcDc; eAikU: goto oIuHX; goto qvlCh; rCcqO: if ($bytes >= 1024) { goto hDkwL; } goto bhj6c; Slib3: $bytes = number_format($bytes / 1024, 2) . "\x20\x4b\102"; goto seKok; Pmgj0: if ($bytes >= 1073741824) { goto z6bd7; } goto jmNpS; qvlCh: TbdPE: goto Z9Vqc; Highk: $bytes = $bytes . "\40\142\x79\164\145\x73"; goto eAikU; ZYmtT: goto oIuHX; goto aDA3c; aDA3c: hDkwL: goto Slib3; tH4j7: goto oIuHX; goto FmOWg; OMW_H: oIuHX: goto xydFf; Z9Vqc: $bytes = $bytes . "\40\x62\171\164\145"; goto OMW_H; q7CMP: TFL_H: goto Highk; uSNHw: goto oIuHX; goto Yf1kp; V5sTG: $bytes = number_format($bytes / 1073741824, 2) . "\40\x47\x42"; goto uSNHw; sIXyz: } }
