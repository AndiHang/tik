<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 class Cbttoken extends CI_Controller { public function __construct() { goto YT8I1; mSMGu: YsaIj: goto AKDJl; ajBUW: $this->form_validation->set_error_delimiters('', ''); goto unvZa; YT8I1: parent::__construct(); goto QCiiN; qF4k3: $this->load->model("\x4c\x6f\147\137\x6d\x6f\144\145\x6c", "\x6c\x6f\x67\x67\151\156\x67"); goto ajBUW; V9a_H: wQpvB: goto aE8sH; BWaw1: $this->load->model("\104\141\163\150\x62\157\x61\x72\x64\x5f\155\x6f\144\x65\154", "\144\141\x73\x68\x62\x6f\x61\x72\144"); goto x2mbJ; QCiiN: $this->load->dbforge(); goto erqY9; aE8sH: $this->load->library(["\x64\x61\x74\x61\164\x61\x62\154\145\x73", "\x66\157\162\x6d\137\166\141\x6c\151\x64\x61\164\x69\157\156"]); goto Qn8xI; Qn8xI: $this->load->model("\115\x61\x73\x74\x65\162\137\x6d\x6f\144\x65\x6c", "\155\x61\x73\x74\145\162"); goto BWaw1; erqY9: if (!$this->ion_auth->logged_in()) { goto YsaIj; } goto kNLqN; x2mbJ: $this->load->model("\x43\x62\164\137\155\157\x64\145\x6c", "\143\142\x74"); goto qF4k3; hqI69: goto wQpvB; goto mSMGu; kNLqN: if (!(!$this->ion_auth->is_admin() && !$this->ion_auth->in_group("\x67\x75\x72\165"))) { goto j332s; } goto y2X19; AKDJl: redirect("\141\x75\x74\150"); goto V9a_H; y2X19: show_error("\110\141\x6e\171\141\x20\x41\x64\x6d\x69\x6e\151\163\164\x72\141\x74\157\162\x20\x79\x61\156\147\x20\144\151\x62\145\162\151\x20\x68\141\x6b\40\165\x6e\164\165\x6b\40\155\x65\156\x67\141\x6b\x73\145\x73\40\x68\141\154\141\x6d\x61\156\x20\x69\156\x69\54\40\x3c\x61\40\150\162\x65\x66\75\x22" . base_url("\x64\x61\x73\x68\142\x6f\x61\x72\x64") . "\x22\76\x4b\x65\155\x62\x61\154\151\40\153\x65\x20\x6d\x65\x6e\165\40\x61\167\141\x6c\74\57\x61\x3e", 403, "\101\153\163\x65\x73\x20\124\x65\x72\x6c\x61\x72\x61\x6e\x67"); goto pd54v; pd54v: j332s: goto hqI69; unvZa: } public function output_json($data, $encode = true) { goto K0adF; DMJ1p: $this->output->set_content_type("\x61\x70\160\x6c\151\x63\x61\164\x69\157\156\x2f\152\163\157\156")->set_output($data); goto adThq; iNvHk: RgPm4: goto DMJ1p; GsSoy: $data = json_encode($data); goto iNvHk; K0adF: if (!$encode) { goto RgPm4; } goto GsSoy; adThq: } public function index() { goto cnGgm; lUM5p: $this->load->view("\137\x74\145\155\x70\x6c\141\164\145\x73\57\144\x61\163\x68\x62\x6f\x61\162\x64\57\x5f\150\145\141\x64\x65\162", $data); goto Ddy4D; DFMAX: $guru = $this->dashboard->getDataGuruByUserId($user->id, $tp->id_tp, $smt->id_smt); goto aHPgz; vP2CL: $tkn["\x6a\141\162\141\153"] = "\x31"; goto OwwYf; fDJRr: $this->load->view("\155\x65\x6d\142\x65\162\x73\57\147\x75\162\x75\x2f\x63\x62\x74\x2f\x74\x6f\x6b\145\x6e\x2f\x64\141\x74\141"); goto pvh9n; DWJJ8: $data["\x73\x6d\164"] = $this->dashboard->getSemester(); goto zbPcz; zawSZ: $data["\x70\162\x6f\146\x69\x6c\x65"] = $this->dashboard->getProfileAdmin($user->id); goto lUM5p; HxAss: $tp = $this->master->getTahunActive(); goto aWKgI; OwwYf: $tkn["\x65\154\x61\160\163\x65\x64"] = "\x30\60\72\x30\60\72\60\60"; goto oyWor; rwV4r: goto m5PVh; goto MiINH; pLSek: $data = ["\165\163\x65\x72" => $user, "\152\165\x64\165\x6c" => "\124\157\x6b\145\156\40\125\152\x69\141\x6e", "\163\x75\142\x6a\x75\x64\x75\x6c" => "\x54\157\x6b\145\156", "\163\x65\164\x74\x69\156\x67" => $this->dashboard->getSetting()]; goto HxAss; oyWor: $data["\x74\157\x6b\145\x6e"] = $token != null ? $token : json_decode(json_encode($tkn)); goto jMiBQ; cnGgm: $user = $this->ion_auth->user()->row(); goto pLSek; pvh9n: $this->load->view("\x6d\145\155\142\x65\x72\163\x2f\x67\165\162\x75\57\164\x65\x6d\x70\x6c\x61\164\145\163\x2f\146\x6f\x6f\164\x65\162"); goto rwV4r; jMiBQ: if ($this->ion_auth->is_admin()) { goto veBgN; } goto DFMAX; BM686: $token = $this->cbt->getToken(); goto YeKa6; aWKgI: $smt = $this->master->getSemesterActive(); goto GiA3i; GiA3i: $data["\164\x70"] = $this->dashboard->getTahun(); goto wZEuJ; ohogq: $this->load->view("\137\x74\145\x6d\160\x6c\141\x74\x65\163\57\144\141\x73\150\142\x6f\141\x72\144\57\137\x66\x6f\x6f\164\145\162"); goto ejIxJ; ejIxJ: m5PVh: goto HPf8L; YeKa6: $tkn["\x74\x6f\153\x65\156"] = ''; goto UF4S_; zbPcz: $data["\163\155\164\137\141\x63\164\x69\x76\145"] = $smt; goto BM686; aHPgz: $data["\147\x75\162\x75"] = $guru; goto A2Myn; UF4S_: $tkn["\141\x75\x74\x6f"] = "\60"; goto vP2CL; A2Myn: $this->load->view("\x6d\145\x6d\x62\145\x72\x73\x2f\147\x75\162\165\57\x74\145\x6d\x70\154\141\x74\145\163\57\x68\145\141\144\x65\162", $data); goto fDJRr; wZEuJ: $data["\164\x70\x5f\x61\x63\x74\151\166\145"] = $tp; goto DWJJ8; MiINH: veBgN: goto zawSZ; Ddy4D: $this->load->view("\x63\142\164\x2f\164\x6f\153\x65\156\x2f\144\141\x74\141"); goto ohogq; HPf8L: } public function generateToken() { goto B3djN; FExhu: $diff = $mulai->diff(new DateTime()); goto UsSWw; IJwPI: $updated = date("\x59\x2d\x6d\x2d\144\40\x48\72\x69\72\163"); goto Om76s; zbZwl: $token->now = $updated; goto kr8Ll; RAy1z: if (!($total_minutes >= $post_token->jarak)) { goto Vh4YN; } goto i2AJK; Om76s: if ($force == "\61") { goto lPbIL; } goto Wc2Zh; i2AJK: $new = $this->createNewToken(); goto wd1dX; EMCPW: $total_minutes += $diff->h * 60; goto wIunN; ui2t9: $token = $this->cbt->getToken(); goto zbZwl; MwG5W: $force = $this->input->get("\x66\157\x72\143\x65"); goto FdFR2; rAJO0: lPbIL: goto bn648; bo5Hl: $post_token->updated = $updated; goto jO_0R; wd1dX: $post_token->token = $new; goto bo5Hl; XAONK: PM4od: goto ui2t9; zQl2O: $post_token->token = $new; goto IiLAi; jO_0R: $this->cbt->saveToken($post_token); goto K65gi; mEODa: goto PM4od; goto rAJO0; FdFR2: $token = $this->cbt->getToken(); goto IJwPI; UsSWw: $total_minutes = $diff->days * 24 * 60; goto EMCPW; kr8Ll: $this->output_json($token); goto GUT2I; YNV0G: $this->cbt->saveToken($post_token); goto XAONK; bn648: $new = $this->createNewToken(); goto zQl2O; IiLAi: $post_token->updated = $updated; goto YNV0G; B3djN: $post_token = json_decode($this->input->get("\144\141\164\141")); goto MwG5W; Wc2Zh: $mulai = new DateTime($token->updated); goto FExhu; K65gi: Vh4YN: goto mEODa; wIunN: $total_minutes += $diff->i; goto RAy1z; GUT2I: } public function loadToken() { goto rj6Go; c2g1m: Kpu8i: goto Trmi6; vfGHw: $data["\x65\x6c\x61\x70\x73\145\x64"] = "\60\60\x3a\x30\x30\x3a\x30\60"; goto cKTsA; C9RQA: $table_changed = false; goto ny_YI; E2n_O: $data["\x61\165\x74\157"] = "\60"; goto vfGHw; D01eD: $this->output_json($token); goto OM3oI; pzNPG: jO0H6: goto U8RXQ; zhvow: $data["\164\157\153\x65\x6e"] = ''; goto E2n_O; jxsEg: sIQE5: goto zhvow; S6lnb: if ($token == null) { goto sIQE5; } goto FKVKz; ny_YI: foreach ($dataflds as $fild) { goto DuaQY; xAQ76: if (!($fild->type != "\x76\141\162\143\x68\141\162")) { goto sH7jH; } goto QLhs3; UImKA: $table_changed = $this->dbforge->modify_column("\x63\x62\x74\x5f\x74\157\x6b\x65\x6e", $field); goto n5kd1; HHdHY: Y8yE1: goto Hpn0T; QLhs3: $field = ["\165\x70\144\141\x74\x65\x64" => array("\x74\x79\x70\145" => "\126\x41\122\103\x48\x41\x52", "\143\157\156\x73\x74\x72\141\151\x6e\x74" => 20, "\144\x65\x66\141\x75\154\164" => '')]; goto UImKA; DuaQY: if (!($fild->name == "\x75\x70\x64\141\164\145\x64")) { goto Y8yE1; } goto xAQ76; n5kd1: sH7jH: goto HHdHY; Hpn0T: Gzcuk: goto GiyHO; GiyHO: } goto pzNPG; rj6Go: $dataflds = $this->db->field_data("\x63\x62\x74\x5f\x74\x6f\x6b\145\156"); goto C9RQA; cKTsA: $this->output_json($data); goto c2g1m; OM3oI: goto Kpu8i; goto jxsEg; U8RXQ: $token = $this->cbt->getToken(); goto S6lnb; FKVKz: $token->now = date("\x59\55\155\x2d\x64\x20\110\72\x69\72\163"); goto D01eD; Trmi6: } private function createNewToken() { goto FCbtj; NHzFE: sUT1v: goto P9HNL; YDQpx: $new_token = ''; goto sNI1t; sNI1t: $i = 0; goto ZbtTI; Dl94L: return $new_token; goto pH3z1; Wgenv: $input_length = strlen($chars); goto YDQpx; NTids: goto UJfFu; goto FvF0t; ZbtTI: UJfFu: goto HFoZr; FvF0t: ZjKQp: goto Dl94L; FCbtj: $chars = "\101\x42\103\104\x45\x46\x47\110\111\x4a\113\x4c\x4d\x4e\117\120\x51\x52\x53\x54\125\x56\127\x58\131\x5a"; goto Wgenv; GIwul: $new_token .= $random_character; goto NHzFE; HFoZr: if (!($i < 6)) { goto ZjKQp; } goto hzkax; hzkax: $random_character = $chars[mt_rand(0, $input_length - 1)]; goto GIwul; P9HNL: $i++; goto NTids; pH3z1: } }
