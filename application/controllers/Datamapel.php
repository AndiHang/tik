<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\105\120\x41\124\110") or exit("\x4e\x6f\40\x64\151\162\145\x63\x74\x20\x73\143\162\x69\x70\x74\40\x61\143\x63\145\x73\163\40\141\154\x6c\x6f\x77\145\x64"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto yTylA; VnNv_: $this->load->dbforge(); goto b5q5i; tyiUI: $this->load->model("\x44\162\x6f\160\x64\157\167\156\137\x6d\x6f\x64\x65\154", "\144\x72\157\x70\x64\x6f\167\x6e"); goto zw6mD; FAl9z: if ($this->ion_auth->is_admin()) { goto mZap7; } goto rMa_L; zw6mD: $this->form_validation->set_error_delimiters('', ''); goto H2F3P; KV5MY: goto AS7jE; goto mrJ4Q; W_1wC: redirect("\141\165\x74\x68"); goto rvtlD; VzjQn: $this->load->model("\115\x61\x73\164\145\162\137\155\157\x64\x65\x6c", "\x6d\x61\x73\x74\x65\162"); goto s7mxV; mrJ4Q: B9FH9: goto W_1wC; JMLK2: if (!$this->ion_auth->logged_in()) { goto B9FH9; } goto FAl9z; rvtlD: AS7jE: goto VnNv_; yTylA: parent::__construct(); goto JMLK2; s7mxV: $this->load->model("\x44\141\x73\150\142\x6f\x61\x72\144\x5f\155\x6f\x64\x65\x6c", "\x64\141\163\x68\142\x6f\141\162\x64"); goto tyiUI; NH6Pm: mZap7: goto KV5MY; b5q5i: $this->load->library(["\144\141\164\x61\x74\141\142\x6c\x65\x73", "\x66\157\162\155\x5f\166\x61\154\151\144\x61\x74\x69\157\156"]); goto VzjQn; rMa_L: show_error("\x48\141\156\171\x61\40\x41\144\155\151\x6e\x69\163\x74\162\141\x74\x6f\162\x20\x79\141\x6e\x67\40\144\151\x62\x65\x72\x69\x20\150\x61\x6b\x20\165\156\x74\165\x6b\40\x6d\145\156\147\141\x6b\163\145\x73\x20\150\x61\x6c\x61\x6d\141\x6e\40\151\x6e\x69\x2c\x20\x3c\141\x20\x68\x72\145\x66\75\42" . base_url("\x64\x61\163\x68\142\157\x61\x72\144") . "\x22\x3e\x4b\x65\155\x62\x61\x6c\151\x20\x6b\x65\x20\155\x65\x6e\x75\x20\141\167\141\154\74\x2f\141\x3e", 403, "\x41\x6b\163\145\x73\40\124\x65\162\154\141\x72\141\156\147"); goto NH6Pm; H2F3P: } public function output_json($data, $encode = true) { goto QlURi; dV5LS: $this->output->set_content_type("\x61\x70\160\x6c\151\x63\141\x74\x69\x6f\x6e\57\x6a\163\x6f\x6e")->set_output($data); goto bBvS2; oAcPj: $data = json_encode($data); goto ahDkk; ahDkk: ZPfP2: goto dV5LS; QlURi: if (!$encode) { goto ZPfP2; } goto oAcPj; bBvS2: } private function updateUrutanTampil() { goto Zdvcu; Gbr72: if (!(count($insert) > 0)) { goto PCePA; } goto w12id; w12id: $this->db->update_batch("\x6d\x61\x73\x74\145\x72\x5f\x6d\141\x70\145\x6c", $insert); goto nBlIB; OaVb_: foreach ($mapels as $mapel) { $insert = ["\x69\x64\x5f\155\141\x70\x65\154" => $mapel->id_mapel, "\x6e\141\x6d\141\137\x6d\x61\160\145\154" => $mapel->id_mapel, "\153\x6f\x64\x65" => $mapel->id_mapel, "\x6b\x65\154\157\x6d\x70\x6f\x6b" => $mapel->id_mapel, "\142\157\x62\x6f\164\x5f\x70" => $mapel->id_mapel, "\142\x6f\142\x6f\164\x5f\x6b" => $mapel->id_mapel, "\152\145\x6e\152\141\x6e\147" => $mapel->id_mapel, "\x75\162\165\164\x61\156" => $mapel->id_mapel, "\165\x72\x75\164\141\156\137\164\x61\155\x70\x69\x6c" => $mapel->id_mapel, "\163\x74\x61\x74\x75\x73" => $mapel->id_mapel, "\144\x65\x6c\145\164\141\142\x6c\x65" => $mapel->id_mapel]; B1Fav: } goto kIoPK; Zdvcu: $mapels = $this->db->select("\52")->from("\155\x61\x73\164\x65\162\137\x6d\141\160\x65\154")->get()->result(); goto qy9DM; qy9DM: $insert = []; goto OaVb_; kIoPK: rcmKv: goto Gbr72; nBlIB: PCePA: goto klg3j; klg3j: } public function index() { goto BX089; XebP6: $data["\x73\x75\142\x5f\x6b\x65\x6c\157\x6d\160\x6f\153\137\155\x61\160\145\x6c"] = $this->master->getDataSubKelompokMapel(); goto TqVjh; vkyEg: $data["\x74\x70\x5f\141\143\164\x69\166\x65"] = $this->dashboard->getTahunActive(); goto FrXFD; frFbD: $data["\164\160"] = $this->dashboard->getTahun(); goto vkyEg; BX089: if ($this->db->field_exists("\x75\x72\x75\164\x61\x6e\x5f\x74\x61\x6d\160\151\x6c", "\x6d\x61\x73\x74\x65\162\x5f\x6d\x61\160\145\154")) { goto Vys7U; } goto pbHCm; uxZ3O: $setting = $this->dashboard->getSetting(); goto CCTiq; o8pdy: $data["\163\164\x61\164\165\163"] = ["\116\x6f\156\x61\153\x74\151\x66", "\x41\x6b\x74\x69\x66"]; goto HpXuP; OZVN_: $this->load->view("\137\x74\145\x6d\x70\154\x61\x74\x65\163\57\x64\x61\x73\x68\x62\x6f\x61\162\x64\57\137\146\157\157\x74\145\162"); goto KYzzb; vjCw5: $this->load->view("\x6d\x61\x73\x74\145\x72\57\155\x61\x70\145\x6c\x2f\144\141\x74\141"); goto OZVN_; bqWYe: $data["\x6b\145\x6c\157\x6d\x70\x6f\x6b\x5f\155\141\160\x65\x6c"] = $this->master->getDataKelompokMapel(); goto XebP6; FrXFD: $data["\163\155\x74"] = $this->dashboard->getSemester(); goto ISv_E; H5Z0_: Vys7U: goto QbSoA; i5djr: $this->dbforge->add_column("\155\141\x73\164\x65\x72\x5f\155\x61\160\x65\x6c", $fields); goto H5Z0_; ISv_E: $data["\163\x6d\164\137\x61\143\164\x69\x76\x65"] = $this->dashboard->getSemesterActive(); goto vyodm; pbHCm: $fields = array("\x75\x72\x75\164\x61\x6e\x5f\164\x61\155\x70\151\x6c" => array("\164\x79\160\x65" => "\151\x6e\164\x28\x33\51", "\x61\146\x74\145\x72" => "\165\162\165\x74\x61\x6e")); goto i5djr; TqVjh: $data["\153\145\x6c\x6f\x6d\x70\x6f\x6b"] = $this->dropdown->getDataKelompokMapel(); goto o8pdy; vyodm: $data["\x6b\141\x74\145\x67\157\162\151"] = ["\x57\101\112\x49\x42", "\x50\101\x49\40\x28\x4b\145\155\x65\x6e\x61\147\x29", "\x50\105\x4d\x49\116\101\x54\101\116\40\x41\113\x41\104\105\x4d\x49\113", "\x41\113\101\104\105\x4d\111\113\x20\113\x45\x4a\125\x52\125\101\x4e", "\114\111\116\124\101\123\40\115\x49\x4e\x41\124", "\115\125\x4c\x4f\x4b"]; goto bqWYe; HpXuP: $data["\155\x61\160\145\x6c\137\156\157\156\x5f\141\153\x74\x69\x66"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto dXdBh; dXdBh: $this->load->view("\x5f\164\145\x6d\160\x6c\141\x74\145\163\57\x64\141\163\x68\x62\157\141\162\144\x2f\137\x68\145\141\x64\x65\162", $data); goto vjCw5; QbSoA: $user = $this->ion_auth->user()->row(); goto uxZ3O; CCTiq: $data = ["\x75\163\145\162" => $user, "\152\x75\144\165\x6c" => "\115\141\164\141\x20\x50\145\154\141\152\x61\x72\141\156", "\163\165\142\152\165\x64\x75\154" => "\104\141\164\141\x20\x4d\x61\x74\x61\x20\120\145\154\141\x6a\141\x72\x61\x6e", "\160\162\157\x66\151\x6c\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\x74\x74\151\x6e\x67" => $setting]; goto frFbD; KYzzb: } public function addKelompokMapel() { goto Yqzp0; t5ZKX: $this->output->set_content_type("\x61\160\x70\154\151\x63\x61\x74\151\x6f\156\x2f\x6a\163\x6f\156")->set_output($data); goto dWrJ9; VvB1P: goto DxWRY; goto QDk8p; nujgA: DxWRY: goto t5ZKX; QDk8p: z_j0R: goto darHp; Yqzp0: $id = $this->input->post("\151\144\137\x6b\145\154\137\155\x61\x70\145\x6c"); goto WeF8T; dHeSc: $data = $this->db->update("\x6d\x61\163\164\x65\162\x5f\153\x65\154\157\x6d\160\x6f\153\x5f\x6d\141\160\x65\x6c", $insert); goto nujgA; WeF8T: $insert = ["\x6e\141\x6d\x61\x5f\x6b\145\154\x5f\155\x61\x70\145\154" => $this->input->post("\156\x61\155\x61\x5f\153\145\x6c\137\x6d\141\160\x65\x6c", true), "\153\157\144\x65\137\x6b\145\154\x5f\155\141\160\145\154" => $this->input->post("\x6b\x6f\x64\145\x5f\x6b\x65\x6c\137\x6d\x61\160\145\x6c", true), "\153\x61\164\145\x67\x6f\162\151" => $this->input->post("\153\x61\164\145\x67\x6f\162\x69", true), "\151\x64\x5f\x70\x61\x72\145\x6e\x74" => $this->input->post("\x69\x64\x5f\x70\141\x72\145\x6e\164", true)]; goto SAcMh; L3Z56: $data = $this->master->create("\x6d\141\x73\x74\x65\x72\137\x6b\x65\x6c\x6f\x6d\x70\157\x6b\137\155\x61\160\145\x6c", $insert); goto VvB1P; darHp: $this->db->where("\151\x64\x5f\x6b\145\x6c\x5f\155\141\160\x65\x6c", $id); goto dHeSc; SAcMh: if ($id != null) { goto z_j0R; } goto L3Z56; dWrJ9: } public function hapusKelompok() { goto t6qFq; y2jfJ: array_push($messages, "\x53\165\142\40\x4b\145\x6c\157\x6d\x70\157\x6b"); goto Dj_Ni; wl3pu: $this->db->where_in("\153\x65\x6c\157\155\160\x6f\153", $kode); goto dFITj; ZspQg: $kode = $this->input->post("\153\x6f\144\145"); goto ahfTM; JcIW7: if (!($numm > 0)) { goto M8T02; } goto JFSrJ; dFITj: $numm = $this->db->count_all_results("\155\141\163\x74\x65\162\137\155\141\160\x65\154"); goto JcIW7; GHkHb: $this->output_json(["\163\164\141\x74\x75\x73" => true, "\x6d\145\163\163\141\x67\145" => "\x62\145\x72\x68\x61\x73\151\x6c"]); goto TafDJ; t6qFq: $id = $this->input->post("\151\144\137\x6b\145\154"); goto ZspQg; Z9fkx: uKJDb: goto muSCU; hkrFJ: $this->output_json(["\x73\x74\141\164\165\x73" => false, "\155\x65\x73\x73\x61\147\145" => "\x4b\x65\x6c\x6f\x6d\x70\157\x6b\x20\115\x61\160\145\154\x20\144\151\147\165\156\x61\x6b\x61\156\40\144\151\x20" . count($messages) . "\x20\x74\141\x62\145\154\x3a\x3c\142\162\76" . implode("\74\142\x72\x3e", $messages)]); goto Z9fkx; H07sK: if (!($nums > 0)) { goto nXHBX; } goto y2jfJ; Dj_Ni: nXHBX: goto S_Bmb; S_Bmb: if (count($messages) > 0) { goto Ii3mO; } goto UDLqY; cBTsm: goto uKJDb; goto JGh_w; TafDJ: GpM81: goto cBTsm; UDLqY: if (!$this->master->delete("\x6d\141\x73\164\x65\162\137\153\x65\154\157\x6d\x70\x6f\153\x5f\x6d\x61\160\x65\154", $id, "\x69\x64\137\153\x65\154\137\x6d\141\x70\x65\154")) { goto GpM81; } goto GHkHb; Zk2r5: M8T02: goto Qvlbf; Qvlbf: $this->db->where_in("\x69\144\x5f\x70\141\x72\x65\156\x74", $id); goto kyUNX; kyUNX: $nums = $this->db->count_all_results("\155\141\x73\164\x65\x72\x5f\x6b\145\154\157\x6d\160\x6f\153\137\x6d\x61\160\x65\154"); goto H07sK; GgYiw: $messages = []; goto wl3pu; JFSrJ: array_push($messages, "\115\x61\x74\141\x20\120\x65\x6c\x61\x6a\141\162\141\156"); goto Zk2r5; ahfTM: $id_parent = $this->input->post("\x69\144\x5f\160\141\x72\145\x6e\x74"); goto GgYiw; JGh_w: Ii3mO: goto hkrFJ; muSCU: } public function create() { goto l7RUk; oKBdx: $data = $this->master->create("\155\x61\x73\x74\x65\162\x5f\x6d\141\x70\x65\x6c", $insert); goto eh4a0; eh4a0: $this->output->set_content_type("\x61\x70\160\154\151\143\x61\164\x69\x6f\156\x2f\x6a\163\157\x6e")->set_output($data); goto phgEC; l7RUk: $setting = $this->dashboard->getSetting(); goto nJZqM; nJZqM: $insert = ["\156\141\x6d\141\137\155\141\x70\145\x6c" => $this->input->post("\156\x61\155\141\137\155\x61\x70\145\x6c", true), "\153\x6f\x64\145" => $this->input->post("\x6b\157\144\145\137\155\x61\x70\x65\154", true), "\153\x65\x6c\x6f\x6d\160\157\153" => $this->input->post("\153\145\154\x6f\155\x70\157\x6b", true), "\x75\162\165\164\x61\x6e\137\x74\x61\x6d\x70\151\x6c" => $this->input->post("\165\162\165\x74\x61\x6e\137\164\x61\155\x70\x69\154", true), "\152\145\x6e\x6a\141\x6e\147" => $setting->jenjang]; goto oKBdx; phgEC: } public function getDataKelompok() { goto yGGeb; yGGeb: $this->datatables->select("\x2a"); goto vWe1J; aKcFV: echo $this->datatables->generate(); goto NloD2; sHLGR: $this->datatables->where("\x69\x64\x5f\160\x61\x72\145\x6e\164", "\x30"); goto TS2_8; TS2_8: $this->db->order_by("\153\157\144\145\137\x6b\x65\x6c\x5f\x6d\141\160\x65\154"); goto aKcFV; vWe1J: $this->datatables->from("\x6d\x61\163\x74\x65\x72\137\153\x65\x6c\157\x6d\160\157\153\137\x6d\141\x70\x65\154"); goto sHLGR; NloD2: } public function getDataSubKelompok() { goto eI4Ra; lEkNT: $this->datatables->where("\151\144\137\x70\141\x72\145\x6e\x74\40\x3c\76\40\60"); goto WK3mc; KIYKz: $this->datatables->from("\x6d\141\x73\164\145\x72\x5f\153\145\154\x6f\x6d\160\157\x6b\x5f\x6d\141\x70\x65\154"); goto lEkNT; WK3mc: $this->db->order_by("\153\x6f\x64\x65\137\153\145\154\137\155\x61\160\x65\154"); goto BIZeE; BIZeE: echo $this->datatables->generate(); goto HyJir; eI4Ra: $this->datatables->select("\52"); goto KIYKz; HyJir: } public function read() { goto f7PIs; r7nOh: $this->db->order_by("\x6b\145\154\x6f\x6d\160\x6f\153"); goto wG8Ns; f7PIs: $setting = $this->dashboard->getSetting(); goto zefBU; wG8Ns: $this->db->order_by("\x75\x72\165\164\141\156\137\164\141\x6d\x70\151\154"); goto l8EmP; zefBU: $this->datatables->select("\x69\144\x5f\x6d\141\160\145\154\x2c\x20\165\x72\x75\x74\x61\x6e\137\164\141\x6d\160\x69\154\54\40\156\x61\x6d\141\137\155\x61\160\145\x6c\x2c\40\153\157\x64\x65\54\40\x6b\x65\154\x6f\155\x70\x6f\x6b\54\x20\x64\x65\x6c\145\164\141\142\x6c\145\54\40\x73\164\x61\x74\165\163"); goto gK3WC; l8EmP: echo $this->datatables->generate(); goto pYpuk; gK3WC: $this->datatables->from("\x6d\141\163\x74\x65\162\x5f\x6d\141\x70\x65\x6c"); goto r7nOh; pYpuk: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\x70\160\x6c\151\143\x61\164\x69\157\x6e\x2f\152\x73\x6f\156")->set_output($data); } public function aktifkan($id) { goto FrdBt; vmX4B: $this->output_json($update); goto ZfiYo; FrdBt: $this->db->set("\x73\x74\141\x74\165\x73", "\x31"); goto ttuUD; JIrof: $update = $this->db->update("\155\141\x73\164\x65\162\137\x6d\141\160\145\154"); goto vmX4B; ttuUD: $this->db->where("\x69\x64\x5f\x6d\x61\160\145\x6c", $id); goto JIrof; ZfiYo: } public function delete() { goto K6Flo; F5Tnw: if (!$chk) { goto lL1eq; } goto slt3B; RSldg: sRiC7: goto psAdz; xLV30: Jta8p: goto Cs0US; K6Flo: $chk = $this->input->post("\143\150\145\x63\153\145\144", true); goto F5Tnw; yjgQD: $this->output_json(["\x73\164\x61\x74\x75\x73" => true, "\164\157\164\x61\x6c" => count($chk)]); goto BFjNz; TAQEw: if (!$this->master->delete("\x6d\141\163\164\145\162\137\x6d\141\x70\x65\x6c", $chk, "\x69\144\137\x6d\141\x70\x65\154")) { goto nPwc0; } goto yjgQD; LK5Iz: goto sRiC7; goto dS8s6; URcJr: foreach ($tabless as $table) { goto JWW8R; Ps5JT: foreach ($fields as $field) { goto uWLKk; uWLKk: if (!($field->name == "\x69\x64\137\155\x61\x70\x65\x6c" || $field->name == "\x6d\x61\x70\x65\154\137\x69\x64")) { goto k2Fuf; } goto GiVHK; Ribue: PjNN_: goto Urc94; m_1EF: k2Fuf: goto Ribue; GiVHK: array_push($tables, $table); goto m_1EF; Urc94: } goto aY8aF; QikO7: VowB2: goto Iir3n; JWW8R: $fields = $this->db->field_data($table); goto Ps5JT; aY8aF: cJBqb: goto QikO7; Iir3n: } goto JV2LG; JAlUW: $tables = []; goto a45Nr; Cs0US: if (count($messages) > 0) { goto TEbMT; } goto TAQEw; a45Nr: $tabless = $this->db->list_tables(); goto URcJr; slt3B: $messages = []; goto JAlUW; nmeQp: goto gUpdw; goto ncc0G; aKVnW: foreach ($tables as $table) { goto f19Df; PN2GS: ck0vf: goto kYv6E; OiCpI: if ($table == "\143\x62\x74\137\163\157\x61\x6c") { goto JsgY4; } goto PcgR6; qwDN0: if (!($num > 0)) { goto ck0vf; } goto lDNKT; kYv6E: mkCs6: goto Mn279; C_1tN: goto Cq8WY; goto kNgZs; lDNKT: array_push($messages, $table); goto PN2GS; f19Df: if (!($table != "\155\141\163\x74\145\x72\137\x6d\141\160\x65\154")) { goto mkCs6; } goto OiCpI; sTE3i: $num = $this->db->count_all_results($table); goto C_1tN; kNgZs: JsgY4: goto HlLL4; PcgR6: $this->db->where_in("\x69\x64\x5f\155\141\x70\x65\154", $chk); goto sTE3i; sbHR4: Cq8WY: goto qwDN0; OrL1c: $num = $this->db->count_all_results($table); goto sbHR4; Mn279: mxSsS: goto VUcj9; HlLL4: $this->db->where_in("\155\141\x70\145\x6c\x5f\151\144", $chk); goto OrL1c; VUcj9: } goto xLV30; BFjNz: nPwc0: goto nmeQp; JV2LG: fKoBa: goto aKVnW; n5_hC: gUpdw: goto LK5Iz; dS8s6: lL1eq: goto Br3Z9; Br3Z9: $this->output_json(["\x73\x74\x61\164\165\163" => false, "\164\157\164\141\154" => "\x54\151\144\x61\153\x20\141\x64\x61\40\x64\x61\164\x61\x20\171\x61\x6e\x67\x20\144\151\160\x69\x6c\151\x68\41"]); goto RSldg; YyZja: $this->output_json(["\163\x74\141\164\165\x73" => false, "\164\157\164\x61\154" => "\x4d\141\x70\x65\154\x20\144\151\x67\165\x6e\141\153\141\156\x20\144\151\x20" . count($messages) . "\x20\x74\141\x62\x65\x6c\x3a\74\x62\162\76" . implode("\74\142\x72\x3e", $messages)]); goto n5_hC; ncc0G: TEbMT: goto YyZja; psAdz: } public function import($import_data = null) { goto a6rbG; oDOTk: $this->load->view("\137\164\145\x6d\x70\154\141\164\x65\x73\57\144\141\x73\x68\x62\157\141\162\144\x2f\x5f\x66\x6f\157\164\145\162"); goto BcD3m; L036R: $this->load->view("\x6d\141\x73\164\x65\x72\x2f\x6d\141\160\x65\154\x2f\151\x6d\160\x6f\x72\164"); goto oDOTk; DnaXE: $data["\x74\160\x5f\141\x63\x74\151\166\145"] = $this->dashboard->getTahunActive(); goto mcfi0; kUgWH: QpKn1: goto ncKMO; aNx8e: if (!($import_data != null)) { goto QpKn1; } goto Ym5US; UWIlO: $data = ["\x75\x73\145\x72" => $user, "\x6a\x75\144\165\154" => "\x4d\x61\164\x61\40\120\145\154\141\152\x61\x72\x61\156", "\163\x75\x62\x6a\165\x64\165\x6c" => "\x49\155\160\x6f\x72\x74\x20\115\x61\164\141\40\120\x65\154\141\x6a\x61\x72\141\156", "\160\162\x6f\146\x69\154\x65" => $this->dashboard->getProfileAdmin($user->id), "\163\x65\164\164\x69\156\147" => $this->dashboard->getSetting()]; goto aNx8e; mcfi0: $data["\x73\155\164"] = $this->dashboard->getSemester(); goto Uw5wt; BHWnK: $this->load->view("\x5f\164\x65\155\x70\x6c\141\x74\x65\163\x2f\x64\141\163\150\142\x6f\141\162\x64\57\137\150\x65\x61\144\x65\x72", $data); goto L036R; Ym5US: $data["\x69\x6d\160\157\162\164"] = $import_data; goto kUgWH; ncKMO: $data["\x74\x70"] = $this->dashboard->getTahun(); goto DnaXE; Uw5wt: $data["\x73\155\164\x5f\141\x63\164\x69\x76\x65"] = $this->dashboard->getSemesterActive(); goto BHWnK; a6rbG: $user = $this->ion_auth->user()->row(); goto UWIlO; BcD3m: } public function previewExcel() { goto nmNkr; SIESc: $error = $this->upload->display_errors(); goto qhTBR; H0a8k: $data[] = ["\x6e\141\155\x61" => $sheetData[$i][1], "\153\157\x64\x65" => $sheetData[$i][2]]; goto QAbON; pBd6L: RLbZB: goto Ad6FA; Wx31j: Bmxut: goto FSmnc; B4gW3: $i = 1; goto Wx31j; hdFJH: $config["\155\x61\x78\x5f\163\x69\172\x65"] = 2048; goto TY7lM; TY7lM: $config["\x65\x6e\x63\162\x79\160\x74\137\x6e\x61\155\145"] = true; goto czMW0; nmNkr: $config["\x75\x70\x6c\x6f\141\x64\137\160\141\x74\x68"] = "\56\57\165\x70\x6c\x6f\x61\144\163\x2f\151\155\160\x6f\x72\x74\x2f"; goto U7_GT; n03JD: $data = []; goto B4gW3; VrONe: nuOer: goto uf8J1; czMW0: $this->load->library("\x75\x70\154\157\x61\144", $config); goto dqHA2; TfqWv: echo json_encode($data); goto whqMd; whqMd: goto A4W6R; goto Wr7_7; uf8J1: $spreadsheet = $reader->load($file); goto BBBf3; QCR2q: switch ($ext) { case "\x2e\170\x6c\x73\x78": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto nuOer; case "\56\x78\154\x73": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto nuOer; case "\56\143\163\x76": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto nuOer; default: echo "\x75\156\153\156\157\167\x6e\40\146\x69\x6c\145\x20\145\170\164"; die; } goto IZQwA; ReJtM: die; goto C16WT; QAbON: djbM0: goto kRnbN; FSmnc: if (!($i < count($sheetData))) { goto RLbZB; } goto SDVtx; Wr7_7: D6yQh: goto SIESc; BBBf3: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto n03JD; toAVn: goto Bmxut; goto pBd6L; Ad6FA: unlink($file); goto TfqWv; lbLI7: $file = $this->upload->data("\146\x75\154\x6c\x5f\x70\x61\x74\150"); goto KD_QI; C16WT: A4W6R: goto uUrVD; dqHA2: if (!$this->upload->do_upload("\165\160\x6c\157\x61\x64\x5f\146\x69\154\x65")) { goto D6yQh; } goto lbLI7; U7_GT: $config["\x61\154\154\157\167\145\144\137\x74\x79\x70\145\x73"] = "\170\154\163\x7c\x78\154\163\x78\174\143\x73\166"; goto hdFJH; SDVtx: if (!($sheetData[$i][1] != null)) { goto djbM0; } goto H0a8k; IZQwA: PAX1A: goto VrONe; biSiU: $i++; goto toAVn; qhTBR: echo $error; goto ReJtM; kRnbN: fRRsF: goto biSiU; KD_QI: $ext = $this->upload->data("\146\x69\154\145\x5f\x65\170\x74"); goto QCR2q; uUrVD: } public function previewWord() { goto Q8Xe7; Mjz1Y: $dom->loadHTML($text); goto oPey9; pC50O: $config["\x61\x6c\154\x6f\x77\x65\144\137\164\x79\x70\145\x73"] = "\x64\157\x63\x78"; goto GPsl9; SPGcj: p2xZJ: goto HCFHD; ASajI: if (!($i < $rows->count())) { goto GjNTn; } goto kJx9G; HCFHD: $error = $this->upload->display_errors(); goto V7Ggd; V7Ggd: echo $error; goto SSoBZ; GDILo: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto Tlctf; Q8Xe7: $config["\x75\x70\x6c\157\141\x64\137\160\x61\164\x68"] = "\56\x2f\x75\x70\154\157\x61\144\x73\x2f\151\x6d\x70\x6f\x72\164\57"; goto pC50O; kGLWW: if (!$this->upload->do_upload("\165\160\x6c\x6f\141\144\x5f\146\151\x6c\x65")) { goto p2xZJ; } goto Zl1M_; KtvHY: $i = 1; goto AHcCd; Iwzy_: unlink($file); goto nnCGx; OktyE: $dom->preserveWhiteSpace = false; goto gQmLM; EKmYP: $rows = $tables->item(0)->getElementsByTagName("\164\162"); goto KtvHY; gQmLM: $tables = $dom->getElementsByTagName("\x74\x61\x62\x6c\x65"); goto EKmYP; Tlctf: try { $htmlWriter->save("\x2e\x2f\165\x70\154\157\141\144\x73\x2f\x74\x65\155\160\x2f\144\x6f\x63\x2e\x68\x74\x6d\154"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto Iwzy_; JBiB0: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto GDILo; ejeVe: $this->load->library("\x75\160\154\157\141\144", $config); goto kGLWW; P2us0: goto THFzo; goto SPGcj; pdeQX: pwIfQ: goto Ts9NW; Zl1M_: $file = $this->upload->data("\146\165\x6c\x6c\137\160\x61\x74\x68"); goto JBiB0; zGgUm: $config["\x65\x6e\x63\x72\x79\x70\164\137\x6e\141\155\x65"] = true; goto ejeVe; nnCGx: $text = file_get_contents("\56\57\165\x70\x6c\x6f\x61\144\x73\57\x74\145\155\x70\x2f\x64\157\x63\56\x68\164\155\154"); goto Fo8ws; gPssx: THFzo: goto ypCEM; Ts9NW: $i++; goto PI7Dc; Fo8ws: $dom = new DOMDocument(); goto Mjz1Y; ojVN9: GjNTn: goto cT3XF; kJx9G: $cols = $rows[$i]->getElementsByTagName("\x74\x64"); goto kN6nY; GPsl9: $config["\155\141\x78\x5f\x73\x69\x7a\x65"] = 2048; goto zGgUm; SSoBZ: die; goto gPssx; PI7Dc: goto DIhRk; goto ojVN9; oPey9: $data = []; goto OktyE; AHcCd: DIhRk: goto ASajI; kN6nY: $data[] = ["\x6e\x61\155\141" => $cols->item(1)->nodeValue, "\x6b\157\x64\145" => $cols->item(2)->nodeValue]; goto pdeQX; cT3XF: echo json_encode($data); goto P2us0; ypCEM: } public function do_import() { goto Irhz0; JZC3N: $save = $this->master->create("\155\x61\x73\x74\x65\x72\137\155\141\x70\145\x6c", $mapel, true); goto kDTFF; KQM9s: tMbmV: goto JZC3N; Irhz0: $data = json_decode($this->input->post("\155\141\x70\145\x6c", true)); goto F7agW; F7agW: $mapel = []; goto ST_hP; ST_hP: foreach ($data as $j) { $mapel[] = ["\x6e\x61\x6d\141\137\x6d\x61\160\x65\154" => $j->nama, "\153\x6f\x64\145" => $j->kode]; EUr7i: } goto KQM9s; kDTFF: $this->output->set_content_type("\141\x70\160\x6c\151\x63\141\164\151\157\x6e\57\152\x73\x6f\x6e")->set_output($save); goto ZxuhK; ZxuhK: } }
