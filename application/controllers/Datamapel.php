<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\105\x50\x41\x54\110") or exit("\x4e\157\40\x64\x69\x72\145\x63\x74\x20\x73\x63\x72\151\160\x74\40\141\143\143\x65\163\x73\40\x61\154\154\x6f\x77\145\x64"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto G3YiA; GJPZs: $this->load->model("\x44\x61\x73\x68\x62\157\x61\162\144\x5f\x6d\157\144\x65\x6c", "\x64\x61\163\150\x62\x6f\141\x72\144"); goto bfru4; Ulns2: if (!$this->ion_auth->logged_in()) { goto Te5W4; } goto iooSl; J0cug: $this->load->dbforge(); goto zm3N9; qILUG: goto sYeJk; goto M6K2L; vFSGT: $this->form_validation->set_error_delimiters('', ''); goto qYFoD; FnQgc: jiXdy: goto qILUG; iooSl: if ($this->ion_auth->is_admin()) { goto jiXdy; } goto SCtyI; G3YiA: parent::__construct(); goto Ulns2; wNxf1: $this->load->model("\115\141\x73\164\145\162\x5f\x6d\x6f\x64\x65\x6c", "\x6d\x61\x73\164\145\162"); goto GJPZs; zm3N9: $this->load->library(["\x64\141\x74\x61\164\141\x62\154\x65\163", "\146\x6f\162\x6d\137\166\x61\x6c\x69\x64\x61\164\151\157\156"]); goto wNxf1; bfru4: $this->load->model("\104\x72\x6f\x70\144\157\x77\x6e\137\x6d\157\144\145\154", "\x64\162\157\160\144\x6f\x77\156"); goto vFSGT; cI_1V: sYeJk: goto J0cug; NtVI1: redirect("\141\x75\x74\150"); goto cI_1V; SCtyI: show_error("\x48\141\x6e\171\x61\x20\x41\x64\155\151\x6e\151\x73\x74\x72\x61\164\157\162\40\x79\x61\x6e\x67\40\x64\151\x62\145\162\151\40\150\141\153\40\x75\x6e\164\165\153\x20\155\145\156\147\x61\x6b\163\145\163\x20\150\x61\x6c\141\155\x61\x6e\x20\151\x6e\151\x2c\40\x3c\141\x20\x68\162\145\146\75\x22" . base_url("\144\x61\163\x68\x62\157\x61\x72\144") . "\42\x3e\113\x65\x6d\142\x61\154\151\x20\153\145\x20\155\x65\x6e\165\40\141\x77\x61\154\x3c\57\141\76", 403, "\x41\x6b\163\145\163\40\124\145\x72\154\x61\162\x61\156\147"); goto FnQgc; M6K2L: Te5W4: goto NtVI1; qYFoD: } public function output_json($data, $encode = true) { goto k7yzB; k7yzB: if (!$encode) { goto HjpyW; } goto Qytb8; diJF8: $this->output->set_content_type("\x61\160\160\154\x69\143\141\x74\151\157\156\57\x6a\163\x6f\156")->set_output($data); goto ItHcQ; lU7U_: HjpyW: goto diJF8; Qytb8: $data = json_encode($data); goto lU7U_; ItHcQ: } private function updateUrutanTampil() { goto pXEOY; piu1G: foreach ($mapels as $mapel) { $insert = ["\x69\x64\137\155\x61\x70\145\x6c" => $mapel->id_mapel, "\156\141\x6d\x61\137\x6d\x61\160\x65\x6c" => $mapel->id_mapel, "\153\x6f\x64\145" => $mapel->id_mapel, "\x6b\145\154\157\155\x70\157\153" => $mapel->id_mapel, "\142\157\142\x6f\x74\x5f\x70" => $mapel->id_mapel, "\x62\157\x62\x6f\164\137\x6b" => $mapel->id_mapel, "\152\x65\156\152\141\x6e\x67" => $mapel->id_mapel, "\165\162\165\164\x61\x6e" => $mapel->id_mapel, "\165\162\165\164\141\156\x5f\x74\141\155\160\x69\154" => $mapel->id_mapel, "\163\164\141\164\x75\x73" => $mapel->id_mapel, "\144\x65\154\145\164\x61\142\154\x65" => $mapel->id_mapel]; fGiw2: } goto sZYA5; pXEOY: $mapels = $this->db->select("\52")->from("\x6d\x61\163\x74\145\x72\x5f\x6d\141\160\145\154")->get()->result(); goto SQ_gO; sZYA5: YP57E: goto JLJwl; JLJwl: if (!(count($insert) > 0)) { goto rPQQr; } goto buAUU; buAUU: $this->db->update_batch("\155\x61\163\164\x65\162\137\x6d\141\160\x65\154", $insert); goto Ij9iJ; SQ_gO: $insert = []; goto piu1G; Ij9iJ: rPQQr: goto AcCGF; AcCGF: } public function index() { goto irPVO; H9kVk: YNq74: goto Kb7KS; W9XxB: $data = ["\165\x73\145\162" => $user, "\x6a\165\x64\x75\x6c" => "\x4d\141\164\141\40\120\145\154\141\x6a\x61\x72\x61\x6e", "\x73\165\x62\152\x75\x64\x75\154" => "\x44\x61\164\141\x20\115\141\x74\x61\x20\x50\145\154\x61\x6a\141\x72\x61\156", "\160\162\157\146\151\x6c\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\x74\164\151\156\x67" => $setting]; goto vkgAU; Kb7KS: $user = $this->ion_auth->user()->row(); goto oALq1; y5nBi: $data["\163\165\142\137\x6b\x65\154\x6f\155\x70\157\153\x5f\x6d\x61\160\x65\x6c"] = $this->master->getDataSubKelompokMapel(); goto qmbgQ; qmbgQ: $data["\153\x65\x6c\x6f\x6d\x70\x6f\x6b"] = $this->dropdown->getDataKelompokMapel(); goto lXA45; BeLaI: $this->load->view("\137\x74\x65\x6d\x70\154\x61\164\x65\x73\x2f\144\x61\163\x68\142\x6f\x61\x72\144\57\x5f\x66\157\x6f\164\x65\162"); goto dld41; cmKdf: $fields = array("\165\162\x75\x74\141\x6e\137\164\141\155\x70\x69\x6c" => array("\x74\x79\x70\x65" => "\x69\x6e\x74\50\x33\x29", "\x61\x66\164\x65\x72" => "\x75\162\x75\x74\141\156")); goto OsEC9; IRmn8: $this->load->view("\x6d\141\163\x74\145\162\x2f\155\x61\x70\x65\154\57\144\141\x74\141"); goto BeLaI; f9Ds6: $data["\163\x6d\x74"] = $this->dashboard->getSemester(); goto RlDyL; yjGnK: $this->load->view("\x5f\x74\x65\x6d\160\x6c\x61\164\x65\x73\57\x64\x61\x73\x68\142\157\x61\162\144\x2f\137\x68\145\141\144\x65\162", $data); goto IRmn8; IcHiP: $data["\153\145\154\x6f\x6d\160\157\x6b\x5f\155\x61\x70\x65\154"] = $this->master->getDataKelompokMapel(); goto y5nBi; OF3DW: $data["\164\x70\x5f\x61\143\x74\x69\x76\x65"] = $this->dashboard->getTahunActive(); goto f9Ds6; SIFVC: $data["\x6b\141\x74\145\x67\x6f\162\x69"] = ["\x57\101\x4a\x49\x42", "\120\x41\x49\x20\50\113\x65\x6d\145\156\141\x67\x29", "\x50\x45\115\x49\x4e\101\x54\x41\116\40\x41\x4b\x41\x44\105\115\x49\x4b", "\101\x4b\x41\x44\105\x4d\111\x4b\x20\113\105\112\125\122\x55\x41\116", "\114\x49\x4e\x54\x41\123\x20\115\111\116\x41\124", "\x4d\125\114\x4f\113"]; goto IcHiP; RlDyL: $data["\163\155\164\137\x61\x63\164\x69\x76\x65"] = $this->dashboard->getSemesterActive(); goto SIFVC; KkkbM: $data["\155\141\160\145\154\137\156\x6f\x6e\x5f\x61\x6b\164\x69\146"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto yjGnK; lXA45: $data["\163\164\141\x74\x75\x73"] = ["\116\x6f\156\141\x6b\164\x69\x66", "\x41\153\164\151\146"]; goto KkkbM; OsEC9: $this->dbforge->add_column("\x6d\x61\x73\164\x65\x72\137\155\141\160\x65\154", $fields); goto H9kVk; oALq1: $setting = $this->dashboard->getSetting(); goto W9XxB; vkgAU: $data["\x74\x70"] = $this->dashboard->getTahun(); goto OF3DW; irPVO: if ($this->db->field_exists("\x75\162\165\x74\x61\x6e\137\x74\x61\155\x70\151\154", "\155\141\x73\164\145\162\137\x6d\141\160\145\154")) { goto YNq74; } goto cmKdf; dld41: } public function addKelompokMapel() { goto SYDDU; dooUT: h9FO3: goto Y3pAi; jGrY5: $data = $this->master->create("\155\x61\163\x74\145\x72\x5f\153\x65\x6c\x6f\x6d\x70\x6f\153\137\x6d\x61\x70\x65\x6c", $insert); goto OIVF5; KQVEc: $data = $this->db->update("\x6d\x61\163\x74\x65\x72\137\153\145\154\157\155\x70\x6f\153\x5f\x6d\141\160\145\154", $insert); goto dooUT; wA4hV: if ($id != null) { goto Rm1YX; } goto jGrY5; SYDDU: $id = $this->input->post("\x69\x64\x5f\153\145\x6c\x5f\x6d\141\160\145\154"); goto gDY8k; Fb9YB: $this->db->where("\x69\144\x5f\153\x65\x6c\137\x6d\x61\160\x65\x6c", $id); goto KQVEc; gDY8k: $insert = ["\156\141\x6d\141\137\x6b\145\x6c\x5f\x6d\x61\x70\x65\154" => $this->input->post("\x6e\x61\155\141\x5f\153\x65\x6c\x5f\x6d\x61\160\145\x6c", true), "\x6b\x6f\x64\145\x5f\153\x65\x6c\137\155\141\x70\145\x6c" => $this->input->post("\x6b\157\144\x65\137\153\145\154\x5f\155\x61\x70\x65\x6c", true), "\153\x61\x74\x65\x67\x6f\x72\151" => $this->input->post("\153\141\x74\145\147\x6f\x72\151", true), "\151\144\x5f\x70\x61\x72\145\x6e\164" => $this->input->post("\151\x64\x5f\160\141\162\x65\x6e\164", true)]; goto wA4hV; bs5M3: Rm1YX: goto Fb9YB; Y3pAi: $this->output->set_content_type("\x61\160\x70\154\151\x63\x61\164\x69\157\x6e\57\152\x73\x6f\156")->set_output($data); goto z7Qdw; OIVF5: goto h9FO3; goto bs5M3; z7Qdw: } public function hapusKelompok() { goto HhUaF; Hh06a: if (!($nums > 0)) { goto Md_RS; } goto R2033; TbAYf: $id_parent = $this->input->post("\x69\144\137\x70\141\x72\x65\156\164"); goto s_Q6H; w27Mm: iNThW: goto RdJVD; vPc9U: $nums = $this->db->count_all_results("\x6d\x61\x73\x74\x65\162\x5f\153\145\154\x6f\155\x70\x6f\153\x5f\155\141\x70\x65\x6c"); goto Hh06a; c7Guf: $numm = $this->db->count_all_results("\x6d\x61\x73\x74\145\162\x5f\x6d\141\160\145\154"); goto Uw59h; DmoPC: if (count($messages) > 0) { goto C5NUy; } goto BFNcq; RdJVD: $this->db->where_in("\x69\144\137\x70\141\x72\145\156\164", $id); goto vPc9U; j_1Tz: $this->output_json(["\x73\164\141\164\165\x73" => true, "\x6d\145\x73\163\x61\x67\x65" => "\x62\x65\162\150\x61\x73\x69\154"]); goto Vq37v; o3l4P: Md_RS: goto DmoPC; R2033: array_push($messages, "\123\165\142\x20\x4b\x65\x6c\x6f\155\160\x6f\153"); goto o3l4P; SJ23S: goto SIXRy; goto egPtJ; HhUaF: $id = $this->input->post("\151\x64\137\153\x65\154"); goto Jg8Qw; rXoIP: array_push($messages, "\115\141\164\x61\x20\x50\x65\154\x61\152\141\162\141\x6e"); goto w27Mm; Vq37v: Mnhju: goto SJ23S; i7_sR: $this->db->where_in("\153\x65\154\157\155\x70\x6f\x6b", $kode); goto c7Guf; s_Q6H: $messages = []; goto i7_sR; pnu4f: SIXRy: goto w0wVD; egPtJ: C5NUy: goto YUqIU; YUqIU: $this->output_json(["\163\164\x61\164\165\x73" => false, "\x6d\145\x73\163\x61\147\145" => "\113\145\154\x6f\x6d\x70\x6f\153\40\115\x61\x70\145\x6c\40\x64\x69\147\165\x6e\x61\x6b\141\156\x20\x64\x69\x20" . count($messages) . "\40\x74\x61\142\x65\x6c\x3a\x3c\x62\162\76" . implode("\x3c\142\x72\76", $messages)]); goto pnu4f; Jg8Qw: $kode = $this->input->post("\x6b\x6f\144\x65"); goto TbAYf; BFNcq: if (!$this->master->delete("\x6d\x61\x73\164\x65\162\137\x6b\145\154\x6f\x6d\x70\x6f\x6b\137\x6d\x61\x70\145\x6c", $id, "\151\144\137\153\145\x6c\x5f\155\x61\160\x65\x6c")) { goto Mnhju; } goto j_1Tz; Uw59h: if (!($numm > 0)) { goto iNThW; } goto rXoIP; w0wVD: } public function create() { goto ASDBA; jg6vF: $this->output->set_content_type("\141\160\x70\154\x69\143\x61\x74\151\157\156\57\152\x73\157\156")->set_output($data); goto Q3Z8f; uMsnV: $insert = ["\156\141\155\x61\x5f\x6d\x61\x70\x65\x6c" => $this->input->post("\x6e\141\155\141\137\155\x61\x70\145\154", true), "\153\157\x64\x65" => $this->input->post("\x6b\157\144\x65\x5f\x6d\141\160\145\x6c", true), "\x6b\x65\x6c\157\155\160\157\153" => $this->input->post("\153\x65\x6c\x6f\x6d\160\157\x6b", true), "\165\x72\x75\x74\141\x6e\137\x74\x61\155\x70\151\x6c" => $this->input->post("\165\x72\x75\x74\x61\x6e\137\164\x61\155\x70\x69\154", true), "\152\x65\x6e\x6a\141\x6e\147" => $setting->jenjang]; goto rGQq3; ASDBA: $setting = $this->dashboard->getSetting(); goto uMsnV; rGQq3: $data = $this->master->create("\x6d\x61\x73\164\x65\162\x5f\x6d\141\160\x65\x6c", $insert); goto jg6vF; Q3Z8f: } public function getDataKelompok() { goto xGg5h; xGg5h: $this->datatables->select("\52"); goto A47oW; J7Pzu: $this->datatables->where("\x69\144\x5f\x70\141\x72\x65\x6e\x74", "\60"); goto ofBhI; fYYNM: echo $this->datatables->generate(); goto Zoo8X; ofBhI: $this->db->order_by("\x6b\x6f\x64\x65\137\x6b\x65\x6c\x5f\155\x61\160\145\x6c"); goto fYYNM; A47oW: $this->datatables->from("\155\141\x73\164\x65\x72\x5f\x6b\x65\x6c\x6f\155\160\157\153\x5f\155\x61\x70\x65\154"); goto J7Pzu; Zoo8X: } public function getDataSubKelompok() { goto gkQOh; gkQOh: $this->datatables->select("\52"); goto BMyPf; Tl5t7: $this->db->order_by("\153\x6f\144\x65\x5f\153\145\x6c\x5f\x6d\x61\160\x65\154"); goto AtMCW; AtMCW: echo $this->datatables->generate(); goto K3SwZ; SilsW: $this->datatables->where("\151\x64\137\160\141\x72\145\156\x74\40\74\x3e\40\60"); goto Tl5t7; BMyPf: $this->datatables->from("\155\x61\163\164\x65\162\x5f\153\145\154\157\x6d\x70\157\153\137\x6d\141\160\x65\x6c"); goto SilsW; K3SwZ: } public function read() { goto M2j6o; M2j6o: $setting = $this->dashboard->getSetting(); goto hmeoS; sHwvC: $this->db->order_by("\153\x65\154\x6f\155\x70\x6f\x6b"); goto nlOaw; ILyHy: echo $this->datatables->generate(); goto JgN85; hmeoS: $this->datatables->select("\x69\144\137\x6d\141\160\145\154\x2c\40\165\x72\165\x74\x61\x6e\137\164\141\x6d\x70\x69\154\54\40\156\x61\155\x61\x5f\x6d\141\160\145\154\54\40\x6b\x6f\144\145\x2c\40\153\x65\154\157\x6d\x70\x6f\153\54\40\144\x65\154\145\x74\141\x62\154\x65\54\40\163\x74\x61\164\165\163"); goto rbKTP; rbKTP: $this->datatables->from("\155\141\163\x74\x65\162\137\x6d\x61\160\x65\x6c"); goto sHwvC; nlOaw: $this->db->order_by("\165\x72\165\164\x61\156\x5f\164\141\x6d\x70\x69\x6c"); goto ILyHy; JgN85: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\160\160\154\x69\143\x61\164\151\x6f\x6e\57\152\x73\x6f\x6e")->set_output($data); } public function aktifkan($id) { goto POcPo; e2htF: $update = $this->db->update("\x6d\x61\163\164\x65\x72\137\155\141\x70\x65\154"); goto RXqMQ; RXqMQ: $this->output_json($update); goto LUbSr; vebq8: $this->db->where("\151\x64\137\x6d\x61\160\145\154", $id); goto e2htF; POcPo: $this->db->set("\x73\164\141\164\165\x73", "\61"); goto vebq8; LUbSr: } public function delete() { goto xuBaw; vMYuJ: foreach ($tabless as $table) { goto UT7Bl; NSWiB: foreach ($fields as $field) { goto xRYga; m_Gyh: bu0Rs: goto bRR1G; xRYga: if (!($field->name == "\x69\144\x5f\155\x61\x70\145\x6c" || $field->name == "\155\x61\160\x65\154\x5f\151\144")) { goto kkVau; } goto YCJYf; YCJYf: array_push($tables, $table); goto MdhOm; MdhOm: kkVau: goto m_Gyh; bRR1G: } goto nVc0U; jd3Pq: pGAhp: goto AY9lJ; nVc0U: G52VW: goto jd3Pq; UT7Bl: $fields = $this->db->field_data($table); goto NSWiB; AY9lJ: } goto TMSTj; mYvwo: $this->output_json(["\163\x74\141\164\x75\x73" => true, "\164\157\164\x61\154" => count($chk)]); goto iLrLN; xuBaw: $chk = $this->input->post("\143\150\x65\x63\153\145\x64", true); goto VaRpp; UrrKI: $tables = []; goto Zellj; Sja3M: d85FZ: goto U4Xnk; dPdZu: $messages = []; goto UrrKI; QnPjY: goto Ror06; goto KNOzs; RoaZ6: hr10i: goto B6UJc; Zellj: $tabless = $this->db->list_tables(); goto vMYuJ; IPBPE: goto Qhyqu; goto RoaZ6; FC1CD: Ror06: goto UJUb1; U4Xnk: if (count($messages) > 0) { goto hr10i; } goto f3dJQ; KNUYE: foreach ($tables as $table) { goto utw7v; YEZcS: qzHv1: goto Eytwu; FmwAz: $this->db->where_in("\x69\x64\137\155\141\x70\x65\x6c", $chk); goto k9aab; ifSYO: So61V: goto SK2qa; Eytwu: if (!($num > 0)) { goto L4dmB; } goto NjhbS; nnbQ9: h6StT: goto CuMq1; R8acI: if ($table == "\x63\x62\x74\x5f\x73\157\141\154") { goto So61V; } goto FmwAz; M2im4: $num = $this->db->count_all_results($table); goto YEZcS; T8ptu: x_Otd: goto nnbQ9; NjhbS: array_push($messages, $table); goto Kp3Jj; utw7v: if (!($table != "\x6d\141\163\x74\145\x72\x5f\155\141\160\145\154")) { goto x_Otd; } goto R8acI; k9aab: $num = $this->db->count_all_results($table); goto cDYfr; cDYfr: goto qzHv1; goto ifSYO; SK2qa: $this->db->where_in("\x6d\141\160\x65\x6c\x5f\x69\x64", $chk); goto M2im4; Kp3Jj: L4dmB: goto T8ptu; CuMq1: } goto Sja3M; HK5zz: $this->output_json(["\x73\x74\x61\x74\165\163" => false, "\164\157\x74\141\x6c" => "\124\x69\x64\x61\x6b\40\x61\x64\141\40\144\x61\164\141\x20\x79\141\156\147\40\144\x69\160\151\x6c\151\x68\41"]); goto FC1CD; B6UJc: $this->output_json(["\163\164\x61\164\165\163" => false, "\164\x6f\x74\x61\x6c" => "\x4d\x61\160\145\x6c\x20\x64\151\x67\x75\156\141\x6b\141\156\x20\x64\151\x20" . count($messages) . "\x20\164\x61\142\145\154\x3a\74\x62\162\x3e" . implode("\x3c\x62\x72\x3e", $messages)]); goto OoVpU; OoVpU: Qhyqu: goto QnPjY; VaRpp: if (!$chk) { goto V57FU; } goto dPdZu; TMSTj: kPU2Q: goto KNUYE; iLrLN: oS_Dq: goto IPBPE; KNOzs: V57FU: goto HK5zz; f3dJQ: if (!$this->master->delete("\155\141\163\164\145\x72\137\155\141\160\x65\x6c", $chk, "\151\144\137\155\141\160\145\154")) { goto oS_Dq; } goto mYvwo; UJUb1: } public function import($import_data = null) { goto Pz949; Gg6W8: $data = ["\x75\163\x65\x72" => $user, "\152\x75\144\165\154" => "\x4d\141\x74\141\40\x50\145\154\x61\x6a\x61\x72\141\x6e", "\x73\x75\x62\x6a\165\144\165\154" => "\111\x6d\160\x6f\x72\164\40\115\141\164\141\x20\x50\145\154\141\152\x61\x72\x61\156", "\160\x72\x6f\x66\x69\x6c\145" => $this->dashboard->getProfileAdmin($user->id), "\163\x65\x74\164\x69\156\147" => $this->dashboard->getSetting()]; goto V15_u; bJN2X: $this->load->view("\x5f\x74\145\155\160\x6c\141\164\x65\x73\x2f\x64\141\x73\150\142\x6f\141\x72\144\x2f\x5f\x68\x65\x61\x64\x65\162", $data); goto TPnzT; OZM1W: $data["\x73\x6d\x74\x5f\x61\143\164\151\166\x65"] = $this->dashboard->getSemesterActive(); goto bJN2X; njh_K: C9rTu: goto i4GXs; V15_u: if (!($import_data != null)) { goto C9rTu; } goto bsApq; Msyja: $this->load->view("\137\x74\x65\x6d\160\154\x61\x74\145\x73\x2f\x64\141\x73\x68\142\x6f\x61\x72\x64\x2f\137\x66\157\157\164\x65\x72"); goto E3zmE; i4GXs: $data["\164\160"] = $this->dashboard->getTahun(); goto udFUx; Pz949: $user = $this->ion_auth->user()->row(); goto Gg6W8; k9bRp: $data["\x73\155\x74"] = $this->dashboard->getSemester(); goto OZM1W; TPnzT: $this->load->view("\x6d\x61\163\164\x65\x72\57\x6d\x61\x70\145\x6c\57\x69\x6d\160\x6f\162\164"); goto Msyja; udFUx: $data["\x74\160\x5f\x61\x63\164\x69\166\x65"] = $this->dashboard->getTahunActive(); goto k9bRp; bsApq: $data["\151\x6d\x70\157\162\x74"] = $import_data; goto njh_K; E3zmE: } public function previewExcel() { goto Vbbj1; y1tEJ: qLOKY: goto G4plJ; oPOzU: die; goto hF8Kz; oCU48: XteHV: goto jjCQJ; AAg9o: if (!$this->upload->do_upload("\x75\x70\154\157\141\x64\x5f\146\x69\154\145")) { goto F22YJ; } goto uP1tE; cCCjn: $data = []; goto B3H7y; a0XYm: if (!($i < count($sheetData))) { goto jkBe4; } goto IS6AH; bzCze: F22YJ: goto FfdN1; DXLds: sn8dn: goto y1tEJ; uP1tE: $file = $this->upload->data("\146\165\154\x6c\137\160\x61\164\150"); goto f42dP; wsZ5w: $config["\141\x6c\154\x6f\167\145\144\137\x74\171\160\x65\x73"] = "\170\x6c\163\174\x78\154\x73\170\174\143\x73\x76"; goto QUg1N; i1cNr: $config["\145\156\143\x72\x79\160\x74\137\156\x61\x6d\x65"] = true; goto WnV8V; G4plJ: $i++; goto ZWZKx; QUg1N: $config["\x6d\x61\x78\137\x73\151\x7a\145"] = 2048; goto i1cNr; Wbn1T: unlink($file); goto mI7TR; IS6AH: if (!($sheetData[$i][1] != null)) { goto sn8dn; } goto Um8XE; jjCQJ: $spreadsheet = $reader->load($file); goto yen8r; TNiuI: echo $error; goto oPOzU; vxzEC: goto vLzll; goto bzCze; Vbbj1: $config["\165\160\154\157\x61\x64\137\x70\141\x74\x68"] = "\56\x2f\165\x70\154\157\141\144\163\57\x69\155\x70\157\x72\x74\57"; goto wsZ5w; p4It_: switch ($ext) { case "\x2e\x78\154\x73\170": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto XteHV; case "\x2e\170\154\163": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto XteHV; case "\x2e\143\x73\x76": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto XteHV; default: echo "\x75\x6e\153\156\x6f\167\x6e\x20\146\x69\154\145\40\145\x78\164"; die; } goto UD70O; F2pe_: S19ic: goto a0XYm; UD70O: iw4Jj: goto oCU48; f42dP: $ext = $this->upload->data("\146\151\x6c\x65\x5f\145\x78\164"); goto p4It_; B3H7y: $i = 1; goto F2pe_; mI7TR: echo json_encode($data); goto vxzEC; Um8XE: $data[] = ["\156\141\155\x61" => $sheetData[$i][1], "\153\157\144\145" => $sheetData[$i][2]]; goto DXLds; bCz8l: jkBe4: goto Wbn1T; WnV8V: $this->load->library("\165\160\154\157\141\144", $config); goto AAg9o; FfdN1: $error = $this->upload->display_errors(); goto TNiuI; ZWZKx: goto S19ic; goto bCz8l; yen8r: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto cCCjn; hF8Kz: vLzll: goto YsqdM; YsqdM: } public function previewWord() { goto AbiMP; j5Ndi: $this->load->library("\x75\x70\x6c\x6f\x61\x64", $config); goto z4__z; EgkCd: VxW9t: goto tklb2; ZwvHQ: $text = file_get_contents("\x2e\x2f\x75\x70\x6c\x6f\141\144\163\x2f\x74\145\155\160\x2f\x64\157\x63\x2e\150\164\155\154"); goto Yirvl; Yirvl: $dom = new DOMDocument(); goto NvzCh; UbW1t: unlink($file); goto ZwvHQ; rX84O: die; goto psgkp; tDiqX: if (!($i < $rows->count())) { goto iwhnY; } goto Pey0V; oo_eE: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto glBCV; MxwPX: bYxFj: goto tDiqX; psgkp: Pwp1d: goto S_Y3j; alF5_: $file = $this->upload->data("\146\x75\154\x6c\137\x70\141\164\x68"); goto hJkGZ; nVZlx: iwhnY: goto YSHl1; mnPJT: $rows = $tables->item(0)->getElementsByTagName("\164\162"); goto LGMoX; M711T: cHbkp: goto bXkDU; glBCV: try { $htmlWriter->save("\x2e\x2f\x75\160\x6c\157\141\144\x73\57\x74\145\155\x70\57\x64\x6f\x63\x2e\150\164\155\x6c"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto UbW1t; NvzCh: $dom->loadHTML($text); goto tYgOi; seMfA: goto Pwp1d; goto M711T; dmP0D: $config["\155\x61\x78\137\x73\x69\172\145"] = 2048; goto p5rSW; hJkGZ: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto oo_eE; wDkQi: goto bYxFj; goto nVZlx; tYgOi: $data = []; goto KL2xt; gcwVM: echo $error; goto rX84O; p5rSW: $config["\x65\156\x63\x72\171\x70\164\137\156\141\x6d\145"] = true; goto j5Ndi; YSHl1: echo json_encode($data); goto seMfA; AbiMP: $config["\x75\160\154\x6f\141\x64\x5f\160\141\164\150"] = "\56\57\165\x70\154\157\x61\x64\163\57\151\155\x70\157\x72\164\57"; goto NFEwP; uMSdC: $data[] = ["\156\141\x6d\x61" => $cols->item(1)->nodeValue, "\153\157\x64\x65" => $cols->item(2)->nodeValue]; goto EgkCd; z4__z: if (!$this->upload->do_upload("\165\x70\x6c\x6f\141\x64\x5f\146\x69\x6c\x65")) { goto cHbkp; } goto alF5_; KL2xt: $dom->preserveWhiteSpace = false; goto VZYwq; Pey0V: $cols = $rows[$i]->getElementsByTagName("\164\x64"); goto uMSdC; bXkDU: $error = $this->upload->display_errors(); goto gcwVM; tklb2: $i++; goto wDkQi; LGMoX: $i = 1; goto MxwPX; NFEwP: $config["\x61\x6c\x6c\x6f\x77\x65\144\137\x74\x79\160\145\x73"] = "\144\x6f\143\x78"; goto dmP0D; VZYwq: $tables = $dom->getElementsByTagName("\x74\141\x62\154\145"); goto mnPJT; S_Y3j: } public function do_import() { goto RESIO; JJB87: $save = $this->master->create("\155\x61\163\x74\145\162\x5f\x6d\x61\160\145\154", $mapel, true); goto k1nTO; PZ4Hd: akxLv: goto JJB87; VThlD: $mapel = []; goto v0PcJ; v0PcJ: foreach ($data as $j) { $mapel[] = ["\156\x61\155\141\x5f\x6d\x61\x70\x65\154" => $j->nama, "\x6b\157\144\145" => $j->kode]; T1Lwh: } goto PZ4Hd; k1nTO: $this->output->set_content_type("\x61\x70\160\154\151\x63\141\x74\x69\157\x6e\57\152\x73\157\156")->set_output($save); goto Z0eo6; RESIO: $data = json_decode($this->input->post("\155\141\160\145\154", true)); goto VThlD; Z0eo6: } }
