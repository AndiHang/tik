<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\123\x45\120\101\x54\x48") or exit("\x4e\x6f\40\x64\x69\162\x65\x63\x74\x20\163\143\x72\151\160\164\40\x61\x63\143\x65\x73\x73\40\141\154\154\x6f\167\145\x64"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto rf5bk; DFXDe: $this->load->model("\115\141\x73\x74\x65\162\137\155\x6f\x64\145\154", "\x6d\141\x73\164\145\x72"); goto fLAt4; Uq06G: $this->load->model("\104\162\x6f\x70\144\x6f\167\156\137\x6d\x6f\144\145\154", "\144\162\157\x70\144\x6f\167\x6e"); goto Z5qMV; NHUY6: if (!$this->ion_auth->logged_in()) { goto x6xRp; } goto z_Jud; noSV4: show_error("\110\x61\156\171\x61\x20\x41\x64\155\151\156\x69\x73\x74\162\141\x74\157\x72\x20\171\141\x6e\147\40\144\151\142\x65\x72\151\x20\x68\141\153\40\x75\x6e\164\x75\153\x20\155\145\156\x67\x61\x6b\163\x65\x73\40\x68\x61\x6c\x61\x6d\141\156\40\151\156\151\54\40\74\141\x20\x68\162\145\x66\x3d\42" . base_url("\144\x61\163\150\x62\157\141\x72\x64") . "\x22\76\113\145\x6d\x62\141\x6c\x69\40\153\145\40\x6d\x65\x6e\x75\x20\x61\167\141\154\x3c\x2f\x61\76", 403, "\x41\153\x73\x65\x73\x20\124\x65\162\154\141\x72\x61\156\x67"); goto bfN8z; Wf2BM: goto mCSKm; goto mSbCz; z_Jud: if ($this->ion_auth->is_admin()) { goto v7jat; } goto noSV4; Z5qMV: $this->form_validation->set_error_delimiters('', ''); goto EUM0k; bfN8z: v7jat: goto Wf2BM; umlLB: $this->load->library(["\x64\141\x74\141\164\x61\142\x6c\145\163", "\146\x6f\x72\155\137\166\x61\x6c\x69\144\141\x74\151\157\x6e"]); goto DFXDe; fLAt4: $this->load->model("\104\141\x73\x68\142\157\141\x72\x64\x5f\155\x6f\x64\x65\x6c", "\144\x61\x73\x68\x62\x6f\x61\162\144"); goto Uq06G; sNzYC: $this->load->dbforge(); goto umlLB; mSbCz: x6xRp: goto DWWm1; DWWm1: redirect("\141\165\164\150"); goto QJmzc; rf5bk: parent::__construct(); goto NHUY6; QJmzc: mCSKm: goto sNzYC; EUM0k: } public function output_json($data, $encode = true) { goto nKgwf; KVgz8: $data = json_encode($data); goto NGOOQ; NGOOQ: tXcgO: goto JBYXJ; nKgwf: if (!$encode) { goto tXcgO; } goto KVgz8; JBYXJ: $this->output->set_content_type("\x61\x70\160\154\151\143\141\x74\151\157\x6e\57\x6a\163\x6f\x6e")->set_output($data); goto x4wSJ; x4wSJ: } private function updateUrutanTampil() { goto dxyZi; OfQaT: foreach ($mapels as $mapel) { $insert = ["\x69\x64\137\155\141\x70\x65\154" => $mapel->id_mapel, "\156\x61\x6d\x61\x5f\x6d\x61\x70\145\154" => $mapel->id_mapel, "\153\x6f\144\x65" => $mapel->id_mapel, "\153\x65\154\x6f\x6d\x70\x6f\153" => $mapel->id_mapel, "\142\x6f\x62\157\164\x5f\160" => $mapel->id_mapel, "\142\x6f\142\157\x74\137\x6b" => $mapel->id_mapel, "\x6a\145\156\152\x61\x6e\147" => $mapel->id_mapel, "\x75\162\x75\164\141\x6e" => $mapel->id_mapel, "\165\x72\165\x74\141\x6e\137\164\141\155\160\151\154" => $mapel->id_mapel, "\x73\164\x61\164\x75\x73" => $mapel->id_mapel, "\144\x65\x6c\145\164\x61\142\x6c\x65" => $mapel->id_mapel]; sKkxJ: } goto k14Df; dxyZi: $mapels = $this->db->select("\52")->from("\155\x61\163\164\145\x72\137\155\x61\x70\145\x6c")->get()->result(); goto LD3Vq; Q3s11: $this->db->update_batch("\x6d\x61\163\164\145\x72\137\x6d\141\x70\145\154", $insert); goto SFr9N; SFr9N: DSdxD: goto sUsbE; SzYOe: if (!(count($insert) > 0)) { goto DSdxD; } goto Q3s11; k14Df: xKOrt: goto SzYOe; LD3Vq: $insert = []; goto OfQaT; sUsbE: } public function index() { goto TbiDw; U8Q8x: $setting = $this->dashboard->getSetting(); goto iWpxv; a1Lih: $data["\x74\160"] = $this->dashboard->getTahun(); goto Udy5g; rwV96: $data["\x73\x6d\164"] = $this->dashboard->getSemester(); goto xCGKx; CcfXB: $data["\155\x61\160\x65\x6c\137\156\157\156\x5f\x61\x6b\x74\x69\146"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto P43V6; X63eT: $this->load->view("\155\141\163\164\145\162\57\155\x61\160\x65\x6c\x2f\x64\x61\x74\x61"); goto rcWnI; bmyVJ: $user = $this->ion_auth->user()->row(); goto U8Q8x; oc9s6: kiPel: goto bmyVJ; P43V6: $this->load->view("\137\164\x65\x6d\x70\154\141\164\145\163\57\x64\141\163\150\142\157\x61\162\144\57\x5f\150\x65\141\144\145\x72", $data); goto X63eT; VWnNE: $data["\x6b\141\x74\x65\147\157\162\x69"] = ["\127\x41\x4a\111\x42", "\120\101\x49\x20\x28\113\x65\x6d\x65\x6e\141\147\x29", "\120\x45\x4d\111\x4e\x41\124\x41\116\x20\x41\x4b\x41\104\x45\115\x49\x4b", "\101\113\101\x44\x45\115\111\113\x20\113\x45\x4a\x55\122\125\101\x4e", "\114\111\116\x54\101\x53\40\115\x49\116\101\x54", "\x4d\x55\x4c\117\x4b"]; goto yo9oF; UGJdS: $data["\163\x74\141\x74\x75\x73"] = ["\116\x6f\x6e\141\153\x74\151\x66", "\x41\153\164\151\x66"]; goto CcfXB; yo9oF: $data["\153\x65\154\157\155\160\x6f\x6b\x5f\x6d\x61\160\145\x6c"] = $this->master->getDataKelompokMapel(); goto IAlFx; IAlFx: $data["\163\x75\142\137\x6b\x65\x6c\x6f\155\x70\x6f\153\137\x6d\x61\160\x65\x6c"] = $this->master->getDataSubKelompokMapel(); goto h1ov3; h1ov3: $data["\x6b\145\154\157\x6d\160\x6f\x6b"] = $this->dropdown->getDataKelompokMapel(); goto UGJdS; TbiDw: if ($this->db->field_exists("\165\162\x75\x74\x61\156\x5f\164\x61\155\160\x69\x6c", "\155\x61\x73\164\145\162\137\x6d\x61\160\145\x6c")) { goto kiPel; } goto LVUky; Udy5g: $data["\x74\160\137\141\143\164\x69\166\x65"] = $this->dashboard->getTahunActive(); goto rwV96; rcWnI: $this->load->view("\137\x74\145\155\x70\154\141\x74\x65\163\x2f\x64\x61\163\150\142\x6f\x61\162\x64\57\137\146\157\157\x74\145\162"); goto BqAab; LVUky: $fields = array("\x75\162\165\x74\x61\x6e\137\x74\141\x6d\160\x69\154" => array("\x74\171\x70\x65" => "\151\156\164\50\x33\x29", "\x61\146\x74\x65\162" => "\165\x72\x75\x74\141\x6e")); goto iIsYQ; iIsYQ: $this->dbforge->add_column("\x6d\x61\163\x74\x65\x72\x5f\x6d\141\x70\145\x6c", $fields); goto oc9s6; xCGKx: $data["\163\x6d\164\x5f\141\143\x74\151\166\145"] = $this->dashboard->getSemesterActive(); goto VWnNE; iWpxv: $data = ["\165\163\145\x72" => $user, "\x6a\x75\x64\x75\154" => "\115\141\164\141\40\120\x65\154\x61\x6a\x61\x72\141\x6e", "\163\165\142\152\165\x64\165\x6c" => "\104\141\146\x74\141\162\40\115\141\164\x61\x20\120\145\x6c\x61\152\141\x72\x61\x6e", "\160\x72\157\146\151\154\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\x74\164\x69\x6e\147" => $setting]; goto a1Lih; BqAab: } public function addKelompokMapel() { goto mGa4k; DY1Xj: goto E7q4C; goto jNpJg; wlRzr: $data = $this->master->create("\x6d\x61\163\x74\145\x72\x5f\153\x65\154\x6f\x6d\x70\x6f\153\137\155\141\x70\145\x6c", $insert); goto DY1Xj; yL4Cr: $this->db->where("\151\x64\x5f\153\x65\154\137\x6d\x61\160\145\x6c", $id); goto Srx8w; jNpJg: wva5R: goto yL4Cr; wsrZn: $insert = ["\x6e\x61\x6d\141\x5f\x6b\145\154\137\x6d\141\160\x65\154" => $this->input->post("\x6e\141\155\141\137\153\x65\x6c\137\155\141\160\x65\x6c", true), "\153\157\x64\x65\x5f\x6b\145\154\x5f\155\141\160\145\x6c" => $this->input->post("\153\x6f\144\145\137\153\145\x6c\137\155\x61\x70\x65\x6c", true), "\x6b\x61\164\145\x67\157\x72\x69" => $this->input->post("\153\x61\x74\x65\x67\x6f\162\151", true), "\x69\144\137\160\141\x72\x65\156\x74" => $this->input->post("\x69\x64\x5f\x70\141\x72\145\156\164", true)]; goto bmOCm; mGa4k: $id = $this->input->post("\151\x64\137\153\145\154\x5f\155\x61\160\x65\x6c"); goto wsrZn; bmOCm: if ($id != null) { goto wva5R; } goto wlRzr; b33gu: $this->output->set_content_type("\x61\x70\x70\x6c\x69\143\x61\164\x69\x6f\156\57\152\163\157\x6e")->set_output($data); goto WXivj; Srx8w: $data = $this->db->update("\155\x61\x73\164\145\x72\x5f\x6b\x65\x6c\157\x6d\160\x6f\153\x5f\x6d\141\x70\145\154", $insert); goto wEkWF; wEkWF: E7q4C: goto b33gu; WXivj: } public function hapusKelompok() { goto aOItn; UDvwt: $this->db->where_in("\151\x64\137\160\141\162\145\x6e\164", $id); goto FQeOy; RLLMg: $numm = $this->db->count_all_results("\155\x61\163\164\145\162\137\155\x61\x70\145\154"); goto a5S4o; OssJz: if (!$this->master->delete("\x6d\141\163\x74\x65\x72\137\153\x65\x6c\x6f\155\160\x6f\153\137\155\141\x70\x65\154", $id, "\x69\x64\x5f\x6b\x65\x6c\137\x6d\141\160\x65\x6c")) { goto CYSV2; } goto ZwHE_; t6OyE: CYSV2: goto nJKeR; N0Lbh: FPM6A: goto wdCp8; zpgvH: $id_parent = $this->input->post("\151\144\137\x70\141\x72\x65\x6e\164"); goto gNplH; ZwHE_: $this->output_json(["\163\164\x61\164\165\163" => true, "\x6d\145\x73\x73\141\x67\145" => "\142\x65\x72\150\x61\163\151\x6c"]); goto t6OyE; wdCp8: if (count($messages) > 0) { goto XtV1h; } goto OssJz; aOItn: $id = $this->input->post("\151\x64\137\x6b\145\x6c"); goto FpCBA; BXJp2: $this->output_json(["\163\x74\x61\x74\165\163" => false, "\x6d\x65\x73\163\x61\147\x65" => "\x4b\145\x6c\157\155\160\x6f\153\x20\x4d\x61\160\145\154\40\144\x69\147\165\x6e\141\153\141\x6e\x20\x64\x69\40" . count($messages) . "\40\x74\x61\142\145\x6c\x3a\74\x62\162\76" . implode("\x3c\142\162\x3e", $messages)]); goto aWfGF; oYQQz: array_push($messages, "\x4d\141\x74\141\40\x50\x65\x6c\141\x6a\141\162\141\156"); goto mTTdc; yj_4K: array_push($messages, "\x53\x75\x62\40\113\x65\154\x6f\155\x70\x6f\x6b"); goto N0Lbh; h2X3m: XtV1h: goto BXJp2; aWfGF: oMp9W: goto XsmeU; Pnel2: $this->db->where_in("\153\x65\x6c\x6f\x6d\160\x6f\153", $kode); goto RLLMg; gNplH: $messages = []; goto Pnel2; FpCBA: $kode = $this->input->post("\153\x6f\144\145"); goto zpgvH; nJKeR: goto oMp9W; goto h2X3m; FQeOy: $nums = $this->db->count_all_results("\x6d\141\163\x74\145\x72\137\153\145\154\157\x6d\160\x6f\x6b\x5f\x6d\x61\160\145\154"); goto bVVwp; mTTdc: pXWQK: goto UDvwt; a5S4o: if (!($numm > 0)) { goto pXWQK; } goto oYQQz; bVVwp: if (!($nums > 0)) { goto FPM6A; } goto yj_4K; XsmeU: } public function create() { goto LiiAc; HaY9P: $this->output->set_content_type("\x61\160\x70\154\x69\143\141\x74\x69\x6f\x6e\57\152\163\x6f\x6e")->set_output($data); goto VP9LO; XX3TO: $insert = ["\x6e\x61\155\x61\137\155\x61\160\x65\154" => $this->input->post("\156\141\155\141\137\x6d\x61\160\x65\154", true), "\x6b\x6f\x64\x65" => $this->input->post("\153\x6f\x64\145\x5f\155\141\160\x65\x6c", true), "\x6b\x65\154\x6f\x6d\x70\x6f\x6b" => $this->input->post("\x6b\145\154\157\x6d\160\x6f\x6b", true), "\x75\x72\165\164\x61\156\x5f\164\x61\x6d\160\151\x6c" => $this->input->post("\165\162\x75\x74\x61\156\x5f\164\x61\x6d\x70\151\x6c", true), "\152\x65\156\152\x61\x6e\x67" => $setting->jenjang]; goto bHws4; LiiAc: $setting = $this->dashboard->getSetting(); goto XX3TO; bHws4: $data = $this->master->create("\x6d\x61\x73\164\x65\x72\x5f\155\141\x70\145\154", $insert); goto HaY9P; VP9LO: } public function getDataKelompok() { goto b3gyk; GxT1l: echo $this->datatables->generate(); goto L0odm; b3gyk: $this->datatables->select("\x2a"); goto beOx6; beOx6: $this->datatables->from("\x6d\141\163\x74\145\162\x5f\x6b\145\x6c\157\x6d\x70\157\x6b\x5f\x6d\141\160\145\x6c"); goto i0X13; wXPyV: $this->db->order_by("\153\x6f\x64\145\x5f\x6b\x65\154\x5f\x6d\141\160\x65\154"); goto GxT1l; i0X13: $this->datatables->where("\x69\x64\137\x70\141\162\x65\x6e\x74", "\60"); goto wXPyV; L0odm: } public function getDataSubKelompok() { goto N2Qdc; ms1VZ: $this->datatables->from("\155\x61\163\x74\x65\162\x5f\153\x65\x6c\x6f\155\x70\x6f\x6b\x5f\155\x61\x70\x65\154"); goto gHpV5; gHpV5: $this->datatables->where("\x69\x64\137\x70\141\x72\145\x6e\164\x20\74\x3e\40\60"); goto IU_Lq; IU_Lq: $this->db->order_by("\x6b\157\x64\x65\x5f\x6b\145\154\x5f\155\x61\x70\145\x6c"); goto fMOtU; N2Qdc: $this->datatables->select("\52"); goto ms1VZ; fMOtU: echo $this->datatables->generate(); goto kaXPD; kaXPD: } public function read() { goto IhF0P; MXCCR: $this->datatables->from("\x6d\x61\163\164\145\162\x5f\x6d\141\160\x65\x6c"); goto KNzHu; IhF0P: $setting = $this->dashboard->getSetting(); goto Uf292; AbNHp: echo $this->datatables->generate(); goto XZGpH; Uf292: $this->datatables->select("\x69\144\137\x6d\141\x70\145\x6c\54\40\x75\162\165\164\141\x6e\137\164\x61\x6d\160\151\x6c\54\40\156\x61\x6d\141\137\x6d\x61\160\x65\154\x2c\x20\x6b\157\144\x65\x2c\40\x6b\145\154\157\x6d\x70\x6f\153\x2c\x20\x64\145\x6c\145\x74\141\x62\x6c\145\54\40\x73\164\x61\164\165\163"); goto MXCCR; KNzHu: $this->db->order_by("\153\145\x6c\x6f\155\160\x6f\153"); goto OGdRq; OGdRq: $this->db->order_by("\x75\162\x75\x74\x61\156\137\x74\141\155\160\151\x6c"); goto AbNHp; XZGpH: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\x70\160\x6c\151\x63\x61\x74\151\x6f\x6e\x2f\152\163\x6f\x6e")->set_output($data); } public function aktifkan($id) { goto gxfem; Xwzhn: $this->output_json($update); goto HcPP1; gxfem: $this->db->set("\x73\x74\141\x74\165\163", "\61"); goto U7kpS; U7kpS: $this->db->where("\x69\144\x5f\155\x61\160\145\154", $id); goto avgIZ; avgIZ: $update = $this->db->update("\155\x61\x73\x74\145\x72\x5f\x6d\141\x70\x65\154"); goto Xwzhn; HcPP1: } public function delete() { goto E6jwX; R6Mab: $this->output_json(["\163\x74\x61\164\165\x73" => true, "\x74\157\164\x61\154" => count($chk)]); goto MnSHD; MnSHD: BhC8V: goto bb28b; GKJoO: if (count($messages) > 0) { goto khjIA; } goto VW1aF; YY0OA: Z96OC: goto fqhL4; VW1aF: if (!$this->master->delete("\155\x61\163\164\145\x72\x5f\x6d\x61\160\x65\154", $chk, "\x69\x64\137\x6d\x61\160\x65\154")) { goto BhC8V; } goto R6Mab; BqcC4: il6zh: goto GKJoO; NkOjj: goto bieJR; goto YbyvG; fqhL4: foreach ($tables as $table) { goto QyX6U; QWow1: oHTgs: goto JeA_9; jexEr: if ($table == "\143\142\x74\137\163\x6f\141\x6c") { goto yNQNY; } goto ufRBw; dPbAl: Z6Yz0: goto A6w50; M5gpi: $num = $this->db->count_all_results($table); goto V1D7k; AewgB: wH1DK: goto JCF2O; S_0RC: $this->db->where_in("\x6d\x61\160\145\154\137\151\144", $chk); goto pSbZI; ufRBw: $this->db->where_in("\151\x64\x5f\x6d\x61\x70\x65\154", $chk); goto M5gpi; pSbZI: $num = $this->db->count_all_results($table); goto dPbAl; A6w50: if (!($num > 0)) { goto oHTgs; } goto NmIVN; QyX6U: if (!($table != "\x6d\x61\x73\x74\x65\x72\137\155\x61\x70\x65\x6c")) { goto ZBkYQ; } goto jexEr; V1D7k: goto Z6Yz0; goto mrfJS; NmIVN: array_push($messages, $table); goto QWow1; mrfJS: yNQNY: goto S_0RC; JeA_9: ZBkYQ: goto AewgB; JCF2O: } goto BqcC4; Ltrwe: $messages = []; goto tfNNN; l3Ve5: foreach ($tabless as $table) { goto jaMIa; cFJlK: M7F_W: goto bLSrU; jaMIa: $fields = $this->db->field_data($table); goto LBhPq; e_vMu: zmoO0: goto cFJlK; LBhPq: foreach ($fields as $field) { goto BY3Yc; YGBiJ: array_push($tables, $table); goto iiHHF; iiHHF: ZYYYe: goto mtHmg; mtHmg: kotY6: goto QRsFN; BY3Yc: if (!($field->name == "\x69\144\137\155\x61\x70\145\154" || $field->name == "\x6d\141\x70\x65\154\137\x69\144")) { goto ZYYYe; } goto YGBiJ; QRsFN: } goto e_vMu; bLSrU: } goto YY0OA; kWkmL: $this->output_json(["\x73\164\141\x74\x75\163" => false, "\164\157\164\141\x6c" => "\124\x69\144\x61\153\40\141\x64\x61\40\x64\141\x74\141\40\x79\x61\x6e\x67\40\144\151\x70\151\x6c\x69\150\x21"]); goto oyJpL; YbyvG: HEg4v: goto kWkmL; fKcQi: $this->output_json(["\x73\164\x61\x74\165\163" => false, "\x74\157\x74\x61\x6c" => "\x4d\141\160\x65\x6c\40\x64\151\x67\x75\156\x61\x6b\141\156\40\x64\x69\40" . count($messages) . "\40\164\141\142\x65\x6c\x3a\x3c\142\x72\x3e" . implode("\74\x62\x72\76", $messages)]); goto RuS7s; E6jwX: $chk = $this->input->post("\143\150\x65\x63\153\x65\144", true); goto vgCen; RuS7s: nOMyT: goto NkOjj; oyJpL: bieJR: goto ZwqYm; hZL4k: khjIA: goto fKcQi; tfNNN: $tables = []; goto O8ifl; O8ifl: $tabless = $this->db->list_tables(); goto l3Ve5; bb28b: goto nOMyT; goto hZL4k; vgCen: if (!$chk) { goto HEg4v; } goto Ltrwe; ZwqYm: } public function import($import_data = null) { goto MM1T3; MM1T3: $user = $this->ion_auth->user()->row(); goto JB9eP; qHsa5: $this->load->view("\155\141\163\164\145\162\57\155\141\x70\145\154\57\x69\x6d\x70\157\162\x74"); goto P0hoa; RnmmJ: $data["\x73\155\164"] = $this->dashboard->getSemester(); goto UeNPv; UeNPv: $data["\x73\155\x74\137\141\143\x74\151\x76\145"] = $this->dashboard->getSemesterActive(); goto EK8RL; Q_Qkh: pH4pb: goto Z79uT; EK8RL: $this->load->view("\137\164\x65\155\160\154\141\x74\x65\163\x2f\x64\x61\x73\150\142\x6f\141\x72\144\x2f\137\150\145\141\144\145\162", $data); goto qHsa5; JB9eP: $data = ["\x75\163\145\x72" => $user, "\152\x75\144\165\154" => "\115\141\164\x61\40\120\145\x6c\x61\152\141\162\x61\x6e", "\x73\x75\142\152\x75\144\x75\154" => "\x49\155\160\x6f\162\164\40\115\141\x74\x61\40\x50\x65\154\x61\152\141\162\x61\156", "\x70\162\x6f\x66\x69\x6c\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\x74\x74\151\156\147" => $this->dashboard->getSetting()]; goto fiQU8; yOZC1: $data["\x69\x6d\x70\157\x72\x74"] = $import_data; goto Q_Qkh; Z79uT: $data["\164\x70"] = $this->dashboard->getTahun(); goto teKaE; fiQU8: if (!($import_data != null)) { goto pH4pb; } goto yOZC1; teKaE: $data["\164\160\137\141\x63\164\x69\x76\x65"] = $this->dashboard->getTahunActive(); goto RnmmJ; P0hoa: $this->load->view("\137\164\145\155\160\x6c\141\x74\145\x73\x2f\144\x61\x73\x68\142\157\141\x72\144\57\x5f\x66\x6f\x6f\x74\x65\162"); goto Kjqnv; Kjqnv: } public function previewExcel() { goto qE7RI; VSnaz: $i++; goto w3Yg4; GaEnP: switch ($ext) { case "\x2e\170\x6c\163\170": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto yLBmY; case "\x2e\x78\154\x73": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto yLBmY; case "\56\x63\x73\166": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto yLBmY; default: echo "\x75\156\153\156\157\x77\x6e\40\x66\x69\154\x65\40\x65\170\164"; die; } goto OiohQ; zb29T: $error = $this->upload->display_errors(); goto PJrpF; V3gPs: M_WJ0: goto izma0; kAWGm: $config["\x61\x6c\x6c\157\x77\x65\144\x5f\x74\x79\160\145\x73"] = "\x78\x6c\x73\x7c\170\154\x73\x78\174\x63\x73\x76"; goto w9HZd; Izfdl: QMbHl: goto j8BZ5; IT65x: $this->load->library("\x75\x70\154\x6f\141\144", $config); goto kdiyg; YUFA0: goto QMbHl; goto G30sL; LNHDS: $data = []; goto EPLkU; nUL34: unlink($file); goto Lk44F; pI2KI: $file = $this->upload->data("\x66\x75\x6c\x6c\x5f\160\x61\x74\150"); goto fcGT3; fcGT3: $ext = $this->upload->data("\x66\151\x6c\145\137\145\x78\x74"); goto GaEnP; Lk44F: echo json_encode($data); goto YUFA0; XB5ui: yLBmY: goto E4b5T; skaFu: if (!($i < count($sheetData))) { goto wNG9T; } goto Brlxl; R4n8Q: $data[] = ["\x6e\141\155\x61" => $sheetData[$i][1], "\153\157\144\145" => $sheetData[$i][2]]; goto V3gPs; w3Yg4: goto sE8Do; goto TcgdJ; Brlxl: if (!($sheetData[$i][1] != null)) { goto M_WJ0; } goto R4n8Q; G30sL: x5lUW: goto zb29T; PJrpF: echo $error; goto HDJvK; izma0: shtEY: goto VSnaz; OiohQ: uV7d9: goto XB5ui; qE7RI: $config["\165\160\154\x6f\141\144\x5f\x70\x61\x74\150"] = "\x2e\x2f\165\x70\x6c\x6f\141\144\x73\x2f\151\x6d\160\157\x72\x74\x2f"; goto kAWGm; TcgdJ: wNG9T: goto nUL34; w9HZd: $config["\155\141\x78\137\163\151\x7a\145"] = 2048; goto L66dH; Ms0E0: sE8Do: goto skaFu; kdiyg: if (!$this->upload->do_upload("\165\x70\154\157\141\144\x5f\146\x69\154\145")) { goto x5lUW; } goto pI2KI; L66dH: $config["\x65\156\143\x72\x79\160\x74\x5f\156\141\x6d\145"] = true; goto IT65x; HDJvK: die; goto Izfdl; snb75: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto LNHDS; E4b5T: $spreadsheet = $reader->load($file); goto snb75; EPLkU: $i = 1; goto Ms0E0; j8BZ5: } public function previewWord() { goto lel3q; gpa03: $dom = new DOMDocument(); goto PuHvF; F3pjq: $i++; goto N7Qmh; WzWiJ: XBzID: goto ZKXVm; vp3fM: $dom->preserveWhiteSpace = false; goto aLoxH; bfmnJ: try { $htmlWriter->save("\56\x2f\x75\160\x6c\x6f\141\144\x73\x2f\164\x65\x6d\x70\x2f\144\x6f\x63\x2e\x68\x74\x6d\x6c"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto vTzNa; t4ISc: die; goto Tpkh5; N7Qmh: goto XBzID; goto E0dBS; qnf8z: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto bfmnJ; lel3q: $config["\165\x70\154\157\x61\144\137\160\141\164\x68"] = "\56\x2f\165\160\154\x6f\x61\x64\x73\x2f\x69\155\x70\157\162\x74\x2f"; goto y5ZXN; Fy2pe: $data = []; goto vp3fM; G9Whp: qHcPE: goto cVM25; uJMDh: $rows = $tables->item(0)->getElementsByTagName("\164\162"); goto FBkO9; XBjH_: $cols = $rows[$i]->getElementsByTagName("\164\x64"); goto JZAli; Tpkh5: kBBf5: goto Jvs05; lglo1: $config["\155\141\x78\x5f\x73\x69\172\x65"] = 2048; goto QyCwK; SCK59: goto kBBf5; goto G9Whp; JZAli: $data[] = ["\x6e\141\155\x61" => $cols->item(1)->nodeValue, "\153\157\x64\x65" => $cols->item(2)->nodeValue]; goto EMnHy; vTzNa: unlink($file); goto Iz4Gf; y5ZXN: $config["\x61\154\154\157\x77\x65\x64\x5f\164\x79\x70\145\x73"] = "\x64\157\143\170"; goto lglo1; fQj0w: $this->load->library("\165\x70\154\157\141\144", $config); goto FqCp_; EMnHy: oNU8v: goto F3pjq; IJypj: echo $error; goto t4ISc; FBkO9: $i = 1; goto WzWiJ; Iz4Gf: $text = file_get_contents("\56\57\x75\x70\x6c\x6f\141\144\x73\57\164\x65\x6d\160\x2f\144\x6f\143\x2e\x68\164\x6d\x6c"); goto gpa03; cVM25: $error = $this->upload->display_errors(); goto IJypj; PuHvF: $dom->loadHTML($text); goto Fy2pe; aLoxH: $tables = $dom->getElementsByTagName("\x74\141\x62\154\145"); goto uJMDh; bMuML: $file = $this->upload->data("\146\x75\x6c\x6c\x5f\160\x61\164\x68"); goto tPLZl; FqCp_: if (!$this->upload->do_upload("\165\x70\154\157\x61\x64\137\x66\x69\154\145")) { goto qHcPE; } goto bMuML; tPLZl: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto qnf8z; QyCwK: $config["\145\156\x63\162\x79\x70\164\x5f\156\141\155\145"] = true; goto fQj0w; ZKXVm: if (!($i < $rows->count())) { goto dPWWr; } goto XBjH_; zdGj2: echo json_encode($data); goto SCK59; E0dBS: dPWWr: goto zdGj2; Jvs05: } public function do_import() { goto r00jh; ET7rL: BhS8Y: goto GlcOO; d_ISj: foreach ($data as $j) { $mapel[] = ["\x6e\x61\x6d\141\x5f\x6d\x61\x70\145\154" => $j->nama, "\153\x6f\144\x65" => $j->kode]; EYjGM: } goto ET7rL; GlcOO: $save = $this->master->create("\155\x61\163\x74\x65\x72\x5f\155\x61\x70\x65\154", $mapel, true); goto S25wt; ZXSbs: $mapel = []; goto d_ISj; S25wt: $this->output->set_content_type("\x61\160\160\x6c\x69\143\141\164\x69\157\x6e\57\x6a\163\x6f\x6e")->set_output($save); goto fOG9q; r00jh: $data = json_decode($this->input->post("\x6d\x61\160\145\x6c", true)); goto ZXSbs; fOG9q: } }
