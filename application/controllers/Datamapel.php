<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\x53\x45\x50\101\124\x48") or exit("\x4e\157\x20\x64\151\162\145\143\x74\40\x73\143\x72\x69\x70\164\x20\141\x63\143\145\163\163\40\141\154\x6c\157\167\145\144"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto rsG0j; Q5Kak: $this->load->model("\115\141\x73\x74\145\162\137\x6d\x6f\x64\145\154", "\155\x61\163\164\145\162"); goto L5JDu; VlqFH: goto XznVL; goto ylHYk; Dht6E: XznVL: goto Jpz08; OOdsc: N17th: goto VlqFH; XYZob: $this->load->library(["\144\x61\x74\x61\164\141\x62\x6c\145\163", "\x66\x6f\162\x6d\137\x76\x61\x6c\x69\x64\x61\164\151\x6f\156"]); goto Q5Kak; sdL3D: $this->form_validation->set_error_delimiters('', ''); goto yC1tD; p8702: if ($this->ion_auth->is_admin()) { goto N17th; } goto y80UG; ylHYk: T6bLJ: goto v7gHd; y80UG: show_error("\110\141\156\171\x61\40\x41\144\155\151\156\x69\x73\164\162\x61\164\x6f\162\x20\171\x61\x6e\147\40\x64\x69\142\x65\162\x69\40\150\x61\x6b\40\x75\x6e\164\165\153\x20\x6d\x65\156\147\x61\x6b\163\x65\x73\x20\150\x61\x6c\141\155\141\x6e\40\151\x6e\x69\54\x20\74\x61\40\150\162\x65\x66\75\42" . base_url("\x64\141\x73\150\x62\x6f\141\x72\x64") . "\42\x3e\x4b\x65\x6d\142\x61\154\151\x20\153\145\x20\x6d\x65\156\165\x20\x61\167\x61\x6c\x3c\57\x61\76", 403, "\x41\x6b\x73\x65\163\x20\124\145\162\154\141\162\141\x6e\x67"); goto OOdsc; hNtGG: if (!$this->ion_auth->logged_in()) { goto T6bLJ; } goto p8702; rsG0j: parent::__construct(); goto hNtGG; Jpz08: $this->load->dbforge(); goto XYZob; C_Eu7: $this->load->model("\104\x72\157\160\144\157\x77\156\x5f\x6d\157\x64\145\x6c", "\x64\162\157\160\144\x6f\167\x6e"); goto sdL3D; L5JDu: $this->load->model("\104\141\x73\150\142\157\141\x72\144\x5f\x6d\x6f\144\145\154", "\144\x61\163\150\x62\x6f\141\x72\144"); goto C_Eu7; v7gHd: redirect("\x61\165\164\150"); goto Dht6E; yC1tD: } public function output_json($data, $encode = true) { goto TGiNf; QhGgY: $this->output->set_content_type("\x61\160\x70\154\151\143\x61\x74\x69\157\x6e\x2f\x6a\163\x6f\x6e")->set_output($data); goto DCshY; TGiNf: if (!$encode) { goto DEFvn; } goto jhYfp; jhYfp: $data = json_encode($data); goto BKfl2; BKfl2: DEFvn: goto QhGgY; DCshY: } private function updateUrutanTampil() { goto hWX6Z; XDkOn: if (!(count($insert) > 0)) { goto MnX3K; } goto AD0mS; hWX6Z: $mapels = $this->db->select("\x2a")->from("\155\141\163\x74\x65\162\137\155\141\160\x65\154")->get()->result(); goto kR4jU; ifWJ6: foreach ($mapels as $mapel) { $insert = ["\151\144\x5f\x6d\x61\x70\145\154" => $mapel->id_mapel, "\x6e\141\155\141\x5f\x6d\x61\160\145\x6c" => $mapel->id_mapel, "\153\157\144\x65" => $mapel->id_mapel, "\153\145\154\157\x6d\160\x6f\x6b" => $mapel->id_mapel, "\x62\157\x62\157\164\137\x70" => $mapel->id_mapel, "\x62\x6f\142\157\x74\137\153" => $mapel->id_mapel, "\152\145\156\152\141\x6e\147" => $mapel->id_mapel, "\x75\x72\x75\x74\141\156" => $mapel->id_mapel, "\165\x72\165\x74\141\x6e\x5f\164\x61\155\x70\151\x6c" => $mapel->id_mapel, "\x73\164\141\164\x75\163" => $mapel->id_mapel, "\144\145\x6c\x65\164\141\x62\x6c\x65" => $mapel->id_mapel]; p6Njd: } goto jX46X; AD0mS: $this->db->update_batch("\155\x61\x73\x74\145\162\x5f\x6d\x61\160\145\154", $insert); goto J8eq_; kR4jU: $insert = []; goto ifWJ6; J8eq_: MnX3K: goto sVXIR; jX46X: WMIhZ: goto XDkOn; sVXIR: } public function index() { goto XkDvt; Az1FY: $data["\x74\x70"] = $this->dashboard->getTahun(); goto xUF5A; ScCR3: $data["\x6b\145\x6c\x6f\x6d\160\157\153\x5f\155\x61\x70\145\x6c"] = $this->master->getDataKelompokMapel(); goto QAOSu; vTGN4: $data["\153\x61\x74\x65\x67\157\162\151"] = ["\x57\x41\x4a\111\102", "\x50\101\x49\40\x28\113\145\x6d\145\x6e\141\147\51", "\120\105\x4d\111\x4e\101\x54\101\116\x20\101\x4b\101\104\x45\x4d\111\113", "\101\113\x41\104\105\x4d\111\113\x20\x4b\x45\x4a\125\122\x55\101\x4e", "\x4c\111\116\124\x41\123\40\115\111\x4e\x41\x54", "\115\x55\114\x4f\x4b"]; goto ScCR3; t1fAV: $data["\155\x61\x70\145\154\x5f\x6e\157\156\x5f\x61\x6b\164\x69\x66"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto YLPLH; cqlxy: $setting = $this->dashboard->getSetting(); goto mUKqH; VR7Il: $data["\x73\155\x74\x5f\x61\x63\x74\151\x76\x65"] = $this->dashboard->getSemesterActive(); goto vTGN4; d42LY: $this->load->view("\x5f\x74\x65\x6d\160\x6c\x61\164\x65\x73\x2f\144\141\x73\x68\x62\157\x61\x72\x64\x2f\x5f\x66\157\157\x74\x65\162"); goto h7vl7; xmpxw: $fields = array("\x75\x72\165\x74\x61\x6e\137\164\x61\155\160\x69\x6c" => array("\x74\171\160\145" => "\151\x6e\164\50\x33\x29", "\x61\x66\x74\x65\162" => "\165\162\x75\x74\141\x6e")); goto ZN9cG; xUF5A: $data["\x74\160\x5f\141\x63\x74\x69\166\145"] = $this->dashboard->getTahunActive(); goto VDMl2; ZN9cG: $this->dbforge->add_column("\155\141\163\164\x65\162\137\155\141\x70\x65\154", $fields); goto ZhK5g; XkDvt: if ($this->db->field_exists("\x75\162\165\x74\141\x6e\137\164\x61\155\x70\x69\x6c", "\x6d\141\x73\x74\x65\162\137\155\141\x70\x65\154")) { goto rSgAD; } goto xmpxw; aPNUq: $data["\x73\x74\x61\x74\x75\163"] = ["\116\157\x6e\x61\x6b\x74\151\x66", "\101\x6b\x74\x69\146"]; goto t1fAV; JLcAe: $user = $this->ion_auth->user()->row(); goto cqlxy; jtkrm: $data["\153\145\x6c\157\x6d\160\157\x6b"] = $this->dropdown->getDataKelompokMapel(); goto aPNUq; YLPLH: $this->load->view("\x5f\164\145\155\160\154\x61\164\x65\x73\57\x64\141\x73\150\x62\157\x61\162\x64\57\x5f\x68\145\141\x64\x65\162", $data); goto SxeSa; SxeSa: $this->load->view("\x6d\x61\163\164\145\162\57\155\x61\x70\145\x6c\x2f\x64\x61\x74\x61"); goto d42LY; QAOSu: $data["\163\x75\142\137\153\145\x6c\x6f\155\160\157\x6b\x5f\155\x61\160\x65\154"] = $this->master->getDataSubKelompokMapel(); goto jtkrm; VDMl2: $data["\163\155\x74"] = $this->dashboard->getSemester(); goto VR7Il; ZhK5g: rSgAD: goto JLcAe; mUKqH: $data = ["\165\163\145\x72" => $user, "\152\165\144\x75\x6c" => "\115\x61\x74\141\x20\x50\145\x6c\141\152\x61\x72\141\156", "\163\x75\x62\x6a\x75\x64\165\154" => "\x44\141\164\x61\x20\115\141\164\x61\x20\120\x65\154\x61\x6a\141\x72\141\156", "\x70\x72\157\146\151\154\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\164\164\151\156\147" => $setting]; goto Az1FY; h7vl7: } public function addKelompokMapel() { goto tVwGK; gVk_p: $data = $this->master->create("\155\141\x73\164\x65\162\137\x6b\x65\x6c\157\155\160\157\153\x5f\155\x61\x70\x65\x6c", $insert); goto qF710; SyKCT: $this->output->set_content_type("\141\x70\160\154\151\143\x61\164\x69\157\156\x2f\x6a\163\157\x6e")->set_output($data); goto ggh9_; U5610: $this->db->where("\151\144\137\153\x65\x6c\x5f\155\141\x70\145\154", $id); goto cXHIF; CX7C8: JAVj2: goto U5610; aUbpL: if ($id != null) { goto JAVj2; } goto gVk_p; cXHIF: $data = $this->db->update("\155\x61\163\x74\x65\162\137\153\145\x6c\x6f\x6d\160\157\x6b\x5f\x6d\x61\160\x65\x6c", $insert); goto mG1K8; tVwGK: $id = $this->input->post("\151\144\137\153\x65\x6c\137\155\141\160\145\x6c"); goto kngZF; qF710: goto Ei8bZ; goto CX7C8; mG1K8: Ei8bZ: goto SyKCT; kngZF: $insert = ["\x6e\141\x6d\x61\x5f\153\x65\154\137\x6d\141\x70\145\154" => $this->input->post("\156\x61\x6d\141\137\x6b\145\154\137\x6d\141\160\145\x6c", true), "\153\157\144\x65\137\x6b\145\x6c\x5f\155\x61\x70\x65\x6c" => $this->input->post("\x6b\157\144\145\x5f\x6b\x65\x6c\137\x6d\x61\x70\145\x6c", true), "\153\x61\x74\x65\147\157\162\151" => $this->input->post("\153\x61\x74\x65\x67\x6f\162\x69", true), "\x69\144\137\160\x61\x72\x65\x6e\x74" => $this->input->post("\151\x64\137\160\141\x72\x65\156\x74", true)]; goto aUbpL; ggh9_: } public function hapusKelompok() { goto K1Fxr; iKDKo: $kode = $this->input->post("\x6b\157\144\145"); goto msI3R; FJcW6: $this->db->where_in("\x6b\145\x6c\157\x6d\x70\x6f\x6b", $kode); goto TuL3f; T9QcT: $this->db->where_in("\151\x64\x5f\160\x61\162\145\156\x74", $id); goto sHhMU; lUo1Z: array_push($messages, "\123\165\142\40\113\x65\154\x6f\x6d\160\x6f\x6b"); goto zrWt8; Dn2hp: if (!($nums > 0)) { goto FXzvS; } goto lUo1Z; zrWt8: FXzvS: goto qNwB4; ruarw: goto EtOMV; goto c0nj6; c0nj6: JZLM8: goto PsGnk; msI3R: $id_parent = $this->input->post("\x69\x64\x5f\x70\141\x72\145\x6e\164"); goto pjZt_; pjZt_: $messages = []; goto FJcW6; AQXMs: c2XRp: goto ruarw; BP_NW: $this->output_json(["\x73\x74\141\164\x75\x73" => true, "\155\x65\163\163\x61\x67\145" => "\142\145\x72\150\141\163\x69\154"]); goto AQXMs; TuL3f: $numm = $this->db->count_all_results("\x6d\x61\x73\164\145\x72\137\155\141\x70\x65\154"); goto HWPpF; PsGnk: $this->output_json(["\163\x74\141\164\x75\x73" => false, "\x6d\x65\163\x73\x61\x67\x65" => "\x4b\x65\x6c\x6f\155\160\157\153\x20\115\x61\x70\145\x6c\40\x64\x69\x67\x75\x6e\141\153\141\x6e\40\x64\151\x20" . count($messages) . "\40\164\141\x62\145\154\x3a\x3c\142\x72\x3e" . implode("\74\142\162\76", $messages)]); goto K2eag; HWPpF: if (!($numm > 0)) { goto h1uQ5; } goto VdLOe; StwTc: if (!$this->master->delete("\155\x61\x73\x74\145\x72\137\x6b\x65\154\157\155\160\x6f\153\137\155\x61\x70\x65\x6c", $id, "\151\144\x5f\x6b\x65\154\137\x6d\x61\160\x65\154")) { goto c2XRp; } goto BP_NW; qNwB4: if (count($messages) > 0) { goto JZLM8; } goto StwTc; VdLOe: array_push($messages, "\x4d\x61\x74\x61\40\x50\145\154\x61\x6a\141\162\x61\156"); goto cv02I; cv02I: h1uQ5: goto T9QcT; K1Fxr: $id = $this->input->post("\x69\x64\137\x6b\x65\x6c"); goto iKDKo; sHhMU: $nums = $this->db->count_all_results("\155\141\163\x74\145\x72\x5f\x6b\x65\x6c\157\155\160\157\x6b\137\155\141\160\145\154"); goto Dn2hp; K2eag: EtOMV: goto yOyzy; yOyzy: } public function create() { goto BRBdE; SuFcx: $this->output->set_content_type("\141\x70\160\154\151\143\141\x74\x69\157\156\57\152\x73\157\156")->set_output($data); goto p_Vyr; BRBdE: $setting = $this->dashboard->getSetting(); goto UG9It; pJObZ: $data = $this->master->create("\x6d\141\163\164\x65\162\137\x6d\x61\160\145\154", $insert); goto SuFcx; UG9It: $insert = ["\x6e\x61\155\x61\137\x6d\141\x70\145\x6c" => $this->input->post("\x6e\141\155\141\137\x6d\141\160\145\154", true), "\x6b\157\x64\145" => $this->input->post("\153\x6f\x64\145\x5f\155\x61\x70\145\154", true), "\153\x65\154\157\x6d\160\157\153" => $this->input->post("\x6b\x65\x6c\x6f\x6d\x70\157\153", true), "\165\162\x75\x74\x61\156\137\x74\141\x6d\160\x69\x6c" => $this->input->post("\165\x72\x75\x74\x61\x6e\x5f\x74\141\155\160\151\x6c", true), "\152\x65\156\x6a\x61\x6e\147" => $setting->jenjang]; goto pJObZ; p_Vyr: } public function getDataKelompok() { goto UO3p0; GEMMA: $this->db->order_by("\x6b\157\144\x65\x5f\x6b\145\x6c\x5f\155\x61\160\x65\154"); goto XEX2i; tXUfy: $this->datatables->where("\x69\144\x5f\x70\x61\x72\x65\156\x74", "\x30"); goto GEMMA; XEX2i: echo $this->datatables->generate(); goto nL6K2; UO3p0: $this->datatables->select("\52"); goto K7b_p; K7b_p: $this->datatables->from("\155\x61\163\164\145\162\x5f\x6b\x65\154\157\x6d\x70\x6f\x6b\137\155\x61\160\145\154"); goto tXUfy; nL6K2: } public function getDataSubKelompok() { goto Aemtq; GtQty: $this->datatables->from("\x6d\141\x73\164\x65\x72\137\153\145\x6c\157\x6d\x70\x6f\153\x5f\x6d\x61\160\145\x6c"); goto YOCjL; cu_Fj: $this->db->order_by("\153\157\x64\x65\137\153\x65\x6c\137\155\x61\x70\145\x6c"); goto RF4ND; YOCjL: $this->datatables->where("\x69\x64\x5f\160\x61\x72\x65\x6e\164\x20\74\x3e\40\60"); goto cu_Fj; RF4ND: echo $this->datatables->generate(); goto rjQjc; Aemtq: $this->datatables->select("\x2a"); goto GtQty; rjQjc: } public function read() { goto HlvrS; anxso: $this->datatables->select("\x69\x64\137\x6d\x61\x70\x65\154\54\40\165\162\165\x74\141\x6e\x5f\x74\x61\155\160\x69\154\x2c\x20\156\x61\x6d\141\137\155\141\x70\x65\154\54\x20\x6b\x6f\x64\x65\x2c\x20\x6b\x65\x6c\157\155\x70\157\x6b\x2c\40\144\x65\x6c\x65\164\x61\x62\154\x65\54\x20\163\x74\141\x74\165\x73"); goto kUfuO; HlvrS: $setting = $this->dashboard->getSetting(); goto anxso; tHc4e: $this->db->order_by("\153\x65\154\x6f\155\x70\x6f\x6b"); goto t12q2; kBfwI: echo $this->datatables->generate(); goto BsvlC; t12q2: $this->db->order_by("\x75\162\165\164\141\156\x5f\164\x61\x6d\x70\151\154"); goto kBfwI; kUfuO: $this->datatables->from("\155\x61\163\164\145\x72\x5f\155\141\160\x65\x6c"); goto tHc4e; BsvlC: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\x70\x70\154\151\x63\141\164\x69\157\156\x2f\x6a\x73\157\156")->set_output($data); } public function aktifkan($id) { goto wISFF; wISFF: $this->db->set("\163\x74\141\164\165\x73", "\x31"); goto BDofu; BDofu: $this->db->where("\x69\x64\137\x6d\x61\160\x65\x6c", $id); goto cQX4c; ivV6V: $this->output_json($update); goto Od8is; cQX4c: $update = $this->db->update("\155\141\x73\164\145\x72\137\x6d\x61\160\145\x6c"); goto ivV6V; Od8is: } public function delete() { goto LlpWQ; KXzaD: $this->output_json(["\163\164\x61\x74\x75\x73" => false, "\x74\x6f\x74\141\154" => "\x54\151\144\x61\153\x20\141\x64\x61\40\x64\x61\x74\141\40\171\141\x6e\x67\40\144\151\x70\x69\154\151\x68\41"]); goto iri0P; WhDMJ: if (!$chk) { goto YFYhs; } goto oR4JF; oR4JF: $messages = []; goto YYzyq; eskZn: foreach ($tabless as $table) { goto EgAZv; EgAZv: $fields = $this->db->field_data($table); goto hI2Af; P2r4h: FYgwo: goto V8DEo; sOaR0: ocw9X: goto P2r4h; hI2Af: foreach ($fields as $field) { goto sKdxo; gMD4J: array_push($tables, $table); goto mfZRj; wfg0Z: xr0Wy: goto vGaP3; mfZRj: gV8hE: goto wfg0Z; sKdxo: if (!($field->name == "\x69\x64\x5f\x6d\141\160\x65\154" || $field->name == "\155\x61\x70\145\154\x5f\151\x64")) { goto gV8hE; } goto gMD4J; vGaP3: } goto sOaR0; V8DEo: } goto eKNHC; trqYE: if (count($messages) > 0) { goto w_moI; } goto eKgVG; jnfJB: YFYhs: goto KXzaD; kmz8l: w_moI: goto NyY7_; goAdO: goto astTE; goto jnfJB; Kiu19: zOncK: goto D97CY; iri0P: astTE: goto dRg90; YYzyq: $tables = []; goto p9Otg; zdviB: BbKtJ: goto trqYE; p9Otg: $tabless = $this->db->list_tables(); goto eskZn; eKgVG: if (!$this->master->delete("\x6d\x61\163\164\x65\x72\137\x6d\x61\160\x65\154", $chk, "\151\144\137\155\x61\x70\x65\x6c")) { goto zOncK; } goto ZBnzg; LlpWQ: $chk = $this->input->post("\143\x68\145\x63\153\x65\144", true); goto WhDMJ; NyY7_: $this->output_json(["\x73\x74\141\164\x75\x73" => false, "\164\157\164\x61\x6c" => "\x4d\141\160\145\154\40\x64\x69\x67\x75\156\x61\153\x61\156\x20\144\151\x20" . count($messages) . "\x20\164\x61\142\x65\x6c\72\74\x62\162\x3e" . implode("\x3c\142\162\x3e", $messages)]); goto SeJIp; D97CY: goto eqWwL; goto kmz8l; ZBnzg: $this->output_json(["\163\x74\141\164\x75\163" => true, "\x74\157\164\141\154" => count($chk)]); goto Kiu19; SeJIp: eqWwL: goto goAdO; zo_9M: foreach ($tables as $table) { goto iX0r7; ZstgF: if ($table == "\x63\x62\x74\137\163\x6f\x61\154") { goto RlSX2; } goto hUAkG; ZIu3v: $num = $this->db->count_all_results($table); goto m2sWE; hUAkG: $this->db->where_in("\151\x64\137\155\x61\160\x65\154", $chk); goto owaYq; gk71x: P1crr: goto CrCPm; U5DDK: if (!($num > 0)) { goto Va1CC; } goto CWvCa; R6302: RlSX2: goto Nd72y; owaYq: $num = $this->db->count_all_results($table); goto Aoh5U; v97K4: mQt27: goto gk71x; m2sWE: TOO1D: goto U5DDK; Aoh5U: goto TOO1D; goto R6302; iX0r7: if (!($table != "\155\141\x73\x74\x65\162\x5f\x6d\141\x70\x65\154")) { goto mQt27; } goto ZstgF; VlgWF: Va1CC: goto v97K4; CWvCa: array_push($messages, $table); goto VlgWF; Nd72y: $this->db->where_in("\155\141\x70\x65\x6c\x5f\151\x64", $chk); goto ZIu3v; CrCPm: } goto zdviB; eKNHC: MuKex: goto zo_9M; dRg90: } public function import($import_data = null) { goto GuDhi; ZifNH: $this->load->view("\137\x74\x65\x6d\160\154\141\164\145\163\x2f\144\141\x73\x68\142\x6f\141\x72\x64\57\137\150\145\x61\144\x65\162", $data); goto mP88j; i3XZS: $data["\x73\x6d\164\x5f\x61\x63\x74\151\x76\145"] = $this->dashboard->getSemesterActive(); goto ZifNH; Em8sO: if (!($import_data != null)) { goto N6Bl9; } goto GHfdS; GuDhi: $user = $this->ion_auth->user()->row(); goto cJBXU; m80k5: $data["\163\x6d\x74"] = $this->dashboard->getSemester(); goto i3XZS; cJBXU: $data = ["\x75\x73\145\162" => $user, "\152\x75\x64\165\x6c" => "\115\x61\x74\x61\40\120\x65\x6c\x61\152\141\x72\x61\156", "\163\x75\x62\x6a\x75\144\165\x6c" => "\x49\x6d\x70\157\x72\164\40\115\141\x74\141\40\x50\145\154\x61\152\141\162\x61\x6e", "\160\x72\x6f\146\x69\154\145" => $this->dashboard->getProfileAdmin($user->id), "\163\x65\x74\x74\151\x6e\x67" => $this->dashboard->getSetting()]; goto Em8sO; OeT4x: $this->load->view("\x5f\x74\x65\x6d\x70\x6c\141\x74\x65\x73\57\x64\x61\163\x68\142\x6f\x61\x72\x64\57\137\146\157\157\x74\145\162"); goto nElNC; GHfdS: $data["\151\155\x70\157\x72\x74"] = $import_data; goto pp8wt; DZoO3: $data["\164\160\x5f\x61\143\164\151\x76\x65"] = $this->dashboard->getTahunActive(); goto m80k5; mP88j: $this->load->view("\155\141\163\164\x65\162\57\x6d\141\x70\145\154\57\151\155\160\x6f\162\x74"); goto OeT4x; rrjK1: $data["\164\x70"] = $this->dashboard->getTahun(); goto DZoO3; pp8wt: N6Bl9: goto rrjK1; nElNC: } public function previewExcel() { goto Q83kr; KbOQa: QROQv: goto a4_Ak; gNuvM: SRp4v: goto isKcs; mNIky: NJMbL: goto nZdxP; Zq0pw: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto mVw5D; dBQL6: $this->load->library("\x75\160\x6c\157\141\x64", $config); goto xpN7g; Wrczg: $file = $this->upload->data("\x66\x75\x6c\154\x5f\160\141\x74\150"); goto ZPcCa; Krz9A: R2lJa: goto mPgJM; cDP6H: goto NJMbL; goto KbOQa; INIbg: set5D: goto iwv6G; d_NO2: $i++; goto cDP6H; zZpgn: echo $error; goto LQVb6; Jq4qg: Z3fN2: goto d_NO2; isKcs: $spreadsheet = $reader->load($file); goto Zq0pw; xpN7g: if (!$this->upload->do_upload("\165\160\154\x6f\141\x64\137\x66\151\x6c\x65")) { goto R2lJa; } goto Wrczg; mPgJM: $error = $this->upload->display_errors(); goto zZpgn; awbKG: goto set5D; goto Krz9A; ZPcCa: $ext = $this->upload->data("\146\151\154\145\x5f\x65\170\164"); goto FOBhG; SajVV: echo json_encode($data); goto awbKG; LQVb6: die; goto INIbg; nZdxP: if (!($i < count($sheetData))) { goto QROQv; } goto pxGc4; Rg31S: jAebz: goto gNuvM; FOBhG: switch ($ext) { case "\x2e\x78\x6c\163\x78": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto SRp4v; case "\x2e\x78\154\x73": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto SRp4v; case "\x2e\143\163\166": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto SRp4v; default: echo "\165\156\153\x6e\157\x77\x6e\x20\146\151\154\145\40\x65\x78\x74"; die; } goto Rg31S; Q83kr: $config["\x75\160\154\157\x61\144\137\160\x61\164\150"] = "\x2e\x2f\165\160\x6c\157\x61\x64\163\x2f\x69\155\x70\157\162\164\x2f"; goto c11zW; pxGc4: if (!($sheetData[$i][1] != null)) { goto KYoNx; } goto HIVRH; a4_Ak: unlink($file); goto SajVV; JKuwC: KYoNx: goto Jq4qg; c11zW: $config["\141\x6c\154\x6f\167\145\144\137\x74\x79\160\145\163"] = "\x78\154\x73\x7c\x78\x6c\163\170\174\143\163\x76"; goto hFDrx; mVw5D: $data = []; goto OnklK; OnklK: $i = 1; goto mNIky; hFDrx: $config["\x6d\x61\x78\x5f\x73\151\172\145"] = 2048; goto Na2z8; HIVRH: $data[] = ["\x6e\141\x6d\x61" => $sheetData[$i][1], "\x6b\x6f\144\x65" => $sheetData[$i][2]]; goto JKuwC; Na2z8: $config["\x65\156\x63\162\x79\x70\x74\137\x6e\x61\x6d\145"] = true; goto dBQL6; iwv6G: } public function previewWord() { goto L39bq; athlh: X6cl7: goto yNLIg; WSMzW: echo $error; goto qUvJw; v3bjc: $dom = new DOMDocument(); goto Z0BFr; Z0BFr: $dom->loadHTML($text); goto K20iP; fwBSq: $config["\145\x6e\143\x72\x79\160\x74\x5f\156\x61\155\145"] = true; goto pOICy; NQsq3: $file = $this->upload->data("\x66\x75\x6c\154\137\160\141\164\x68"); goto gmSZk; L39bq: $config["\x75\160\x6c\157\x61\x64\x5f\x70\x61\164\x68"] = "\x2e\57\x75\x70\x6c\x6f\141\144\x73\57\151\155\x70\157\x72\164\x2f"; goto cHW0a; Qc3N2: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto j3l2P; zHFUq: $i++; goto AF4ZW; HNDRw: $config["\x6d\141\170\137\163\151\x7a\145"] = 2048; goto fwBSq; s6apM: $data[] = ["\156\x61\155\x61" => $cols->item(1)->nodeValue, "\x6b\157\144\x65" => $cols->item(2)->nodeValue]; goto gKByq; AF4ZW: goto G7xHg; goto athlh; cunn9: goto XuBX9; goto yF7KA; Z83XP: $dom->preserveWhiteSpace = false; goto iujtB; jOO_P: $error = $this->upload->display_errors(); goto WSMzW; qUvJw: die; goto KhHdV; Bce99: $text = file_get_contents("\x2e\57\x75\160\154\x6f\141\x64\163\57\x74\x65\155\160\x2f\144\x6f\x63\x2e\x68\164\x6d\154"); goto v3bjc; KhHdV: XuBX9: goto M_MKx; eU5vF: G7xHg: goto cJt8M; yNLIg: echo json_encode($data); goto cunn9; ISwPk: $rows = $tables->item(0)->getElementsByTagName("\164\x72"); goto t4KLz; gmSZk: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto Qc3N2; cJt8M: if (!($i < $rows->count())) { goto X6cl7; } goto a52iN; yF7KA: ReyIw: goto jOO_P; j3l2P: try { $htmlWriter->save("\x2e\57\165\160\x6c\157\141\x64\x73\x2f\164\x65\155\160\x2f\144\x6f\x63\x2e\150\x74\155\x6c"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto KWvzz; iujtB: $tables = $dom->getElementsByTagName("\164\141\142\154\145"); goto ISwPk; tcBmU: if (!$this->upload->do_upload("\x75\x70\x6c\157\141\x64\137\x66\151\x6c\x65")) { goto ReyIw; } goto NQsq3; a52iN: $cols = $rows[$i]->getElementsByTagName("\x74\144"); goto s6apM; K20iP: $data = []; goto Z83XP; cHW0a: $config["\x61\x6c\154\x6f\x77\145\144\137\x74\x79\x70\145\163"] = "\144\x6f\143\x78"; goto HNDRw; pOICy: $this->load->library("\x75\160\x6c\x6f\x61\x64", $config); goto tcBmU; KWvzz: unlink($file); goto Bce99; t4KLz: $i = 1; goto eU5vF; gKByq: QO2nf: goto zHFUq; M_MKx: } public function do_import() { goto ZYF12; DNLbN: foreach ($data as $j) { $mapel[] = ["\156\141\155\141\137\155\x61\x70\x65\x6c" => $j->nama, "\x6b\157\144\145" => $j->kode]; FVtRf: } goto K5MKt; c8t3g: $save = $this->master->create("\155\141\x73\x74\x65\x72\x5f\x6d\x61\x70\x65\154", $mapel, true); goto SZQS3; I4xQm: $mapel = []; goto DNLbN; K5MKt: KlBn1: goto c8t3g; ZYF12: $data = json_decode($this->input->post("\155\x61\160\x65\154", true)); goto I4xQm; SZQS3: $this->output->set_content_type("\x61\160\x70\x6c\x69\x63\x61\x74\x69\157\156\57\152\163\x6f\x6e")->set_output($save); goto pCw0o; pCw0o: } }
