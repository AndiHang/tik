<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\123\105\120\101\x54\110") or exit("\116\x6f\40\144\151\162\x65\x63\164\40\163\x63\162\151\160\x74\40\x61\x63\143\x65\163\x73\40\x61\x6c\154\157\x77\x65\x64"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto cYo9r; qeJZt: show_error("\x48\x61\x6e\x79\141\40\101\144\x6d\151\x6e\x69\x73\164\x72\141\164\157\162\40\171\141\156\147\40\144\x69\x62\145\x72\x69\x20\x68\141\x6b\40\165\156\164\x75\153\x20\155\145\x6e\x67\141\x6b\x73\x65\163\40\150\x61\x6c\x61\x6d\x61\156\x20\151\156\151\x2c\40\74\x61\40\150\x72\145\146\75\x22" . base_url("\x64\141\x73\150\142\x6f\x61\162\x64") . "\42\76\113\145\155\142\141\x6c\151\40\x6b\x65\x20\x6d\145\156\165\40\141\x77\141\154\x3c\57\x61\76", 403, "\101\x6b\163\145\163\40\124\145\x72\x6c\x61\x72\x61\156\147"); goto Otxx1; VBFzg: goto FHREM; goto LXJSf; VV0UV: $this->load->library(["\x64\141\164\x61\x74\x61\142\154\145\x73", "\x66\157\x72\155\137\x76\141\x6c\x69\144\141\x74\151\x6f\156"]); goto rBsAw; ANnwZ: $this->load->model("\x44\162\x6f\160\x64\x6f\167\x6e\x5f\x6d\x6f\144\145\154", "\144\x72\157\x70\x64\x6f\167\x6e"); goto I2AGb; px6M3: redirect("\141\x75\x74\x68"); goto b7cyr; I2AGb: $this->form_validation->set_error_delimiters('', ''); goto u2OBQ; b7cyr: FHREM: goto AYIZv; MPd5P: if ($this->ion_auth->is_admin()) { goto GZk7N; } goto qeJZt; rBsAw: $this->load->model("\115\x61\x73\x74\x65\162\x5f\x6d\x6f\144\x65\x6c", "\155\x61\163\x74\145\x72"); goto tySY3; LXJSf: q2X2b: goto px6M3; tySY3: $this->load->model("\x44\x61\x73\x68\x62\157\141\162\144\137\x6d\x6f\x64\145\x6c", "\144\x61\163\x68\142\x6f\x61\x72\144"); goto ANnwZ; cYo9r: parent::__construct(); goto nRZ2_; Otxx1: GZk7N: goto VBFzg; AYIZv: $this->load->dbforge(); goto VV0UV; nRZ2_: if (!$this->ion_auth->logged_in()) { goto q2X2b; } goto MPd5P; u2OBQ: } public function output_json($data, $encode = true) { goto kuNMw; ZWC5I: $this->output->set_content_type("\x61\160\x70\x6c\x69\x63\141\164\151\x6f\x6e\57\x6a\x73\x6f\x6e")->set_output($data); goto otjnu; tFkj5: VCAm8: goto ZWC5I; kuNMw: if (!$encode) { goto VCAm8; } goto T627E; T627E: $data = json_encode($data); goto tFkj5; otjnu: } private function updateUrutanTampil() { goto yDUkN; azxUZ: $this->db->update_batch("\155\x61\x73\164\x65\162\x5f\x6d\x61\160\145\x6c", $insert); goto gu_gm; bEGFa: $insert = []; goto yq4tv; PzJK2: Ue87N: goto zOqZe; gu_gm: r27Ds: goto gZ3uY; zOqZe: if (!(count($insert) > 0)) { goto r27Ds; } goto azxUZ; yDUkN: $mapels = $this->db->select("\x2a")->from("\x6d\x61\163\x74\145\x72\x5f\x6d\x61\x70\x65\154")->get()->result(); goto bEGFa; yq4tv: foreach ($mapels as $mapel) { $insert = ["\151\144\137\x6d\141\160\145\x6c" => $mapel->id_mapel, "\x6e\x61\x6d\141\137\155\141\160\x65\x6c" => $mapel->id_mapel, "\x6b\x6f\x64\145" => $mapel->id_mapel, "\x6b\x65\154\x6f\155\x70\x6f\x6b" => $mapel->id_mapel, "\x62\157\142\x6f\x74\x5f\x70" => $mapel->id_mapel, "\142\157\142\157\x74\137\x6b" => $mapel->id_mapel, "\x6a\x65\x6e\152\x61\x6e\147" => $mapel->id_mapel, "\165\x72\x75\164\141\x6e" => $mapel->id_mapel, "\x75\162\165\164\x61\156\137\164\x61\155\x70\x69\154" => $mapel->id_mapel, "\x73\x74\141\164\165\163" => $mapel->id_mapel, "\x64\145\x6c\145\x74\x61\x62\154\x65" => $mapel->id_mapel]; UDcgi: } goto PzJK2; gZ3uY: } public function index() { goto p3fit; wN5E3: sycmT: goto IwDjS; tu9Qb: $data["\x6b\x65\154\157\155\160\157\153\137\x6d\141\x70\x65\x6c"] = $this->master->getDataKelompokMapel(); goto dgXq2; F6JWi: $this->load->view("\155\141\x73\164\145\x72\57\155\x61\x70\145\x6c\x2f\144\141\x74\x61"); goto ElDE2; v26x0: $data["\x74\x70\x5f\x61\x63\x74\151\166\145"] = $this->dashboard->getTahunActive(); goto Jojvu; mDd0u: $this->dbforge->add_column("\155\141\x73\x74\x65\x72\137\155\x61\160\145\x6c", $fields); goto wN5E3; l_LGe: $setting = $this->dashboard->getSetting(); goto yLxDu; yLxDu: $data = ["\x75\x73\145\x72" => $user, "\x6a\165\x64\x75\x6c" => "\115\141\164\x61\40\120\145\x6c\x61\x6a\x61\162\141\156", "\x73\165\x62\x6a\165\x64\165\x6c" => "\x44\x61\164\141\40\x4d\x61\x74\x61\x20\120\145\154\x61\x6a\141\x72\x61\x6e", "\160\x72\x6f\146\151\154\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\x74\164\x69\156\x67" => $setting]; goto nBOP_; uzXY9: $data["\x6b\x65\154\x6f\155\160\157\x6b"] = $this->dropdown->getDataKelompokMapel(); goto k_JDR; p3fit: if ($this->db->field_exists("\x75\x72\165\x74\x61\156\137\164\141\155\160\151\154", "\155\x61\x73\164\x65\x72\x5f\x6d\x61\160\x65\x6c")) { goto sycmT; } goto Xp4cS; ElDE2: $this->load->view("\x5f\x74\x65\x6d\x70\x6c\141\x74\145\x73\x2f\x64\141\163\x68\142\x6f\x61\x72\x64\57\137\x66\x6f\x6f\x74\x65\x72"); goto iB768; VBOji: $this->load->view("\x5f\x74\145\x6d\x70\154\141\x74\145\x73\57\x64\x61\x73\x68\142\157\141\x72\144\x2f\x5f\150\x65\141\x64\x65\x72", $data); goto F6JWi; dgXq2: $data["\163\165\142\x5f\x6b\x65\x6c\157\155\160\x6f\x6b\x5f\155\141\160\145\154"] = $this->master->getDataSubKelompokMapel(); goto uzXY9; k_JDR: $data["\163\164\x61\164\x75\x73"] = ["\x4e\x6f\156\x61\153\x74\x69\146", "\101\153\x74\x69\146"]; goto jrJqe; Xp4cS: $fields = array("\x75\162\165\164\141\156\x5f\164\x61\x6d\x70\x69\154" => array("\164\x79\x70\x65" => "\151\x6e\164\50\63\x29", "\141\146\164\145\162" => "\x75\162\165\x74\141\156")); goto mDd0u; l1miB: $data["\153\x61\x74\x65\x67\157\x72\151"] = ["\127\101\x4a\111\102", "\x50\101\111\40\x28\113\x65\155\x65\x6e\x61\x67\51", "\120\105\115\x49\116\101\x54\x41\x4e\x20\x41\113\x41\x44\105\115\x49\x4b", "\x41\113\101\x44\x45\115\x49\113\40\x4b\x45\x4a\125\x52\125\101\116", "\114\x49\x4e\124\101\123\40\x4d\111\116\x41\124", "\x4d\125\114\x4f\x4b"]; goto tu9Qb; zmFyy: $data["\163\x6d\x74\x5f\141\143\x74\151\166\145"] = $this->dashboard->getSemesterActive(); goto l1miB; IwDjS: $user = $this->ion_auth->user()->row(); goto l_LGe; jrJqe: $data["\x6d\x61\160\145\154\x5f\x6e\x6f\x6e\137\x61\x6b\x74\x69\x66"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto VBOji; nBOP_: $data["\x74\160"] = $this->dashboard->getTahun(); goto v26x0; Jojvu: $data["\163\155\164"] = $this->dashboard->getSemester(); goto zmFyy; iB768: } public function addKelompokMapel() { goto aK3un; hlVoH: $data = $this->master->create("\155\x61\x73\164\145\x72\x5f\153\x65\x6c\x6f\155\x70\157\153\x5f\155\141\160\145\154", $insert); goto XzirZ; KeXYg: jv00g: goto gQEHz; WOM6m: $data = $this->db->update("\155\141\x73\164\145\x72\x5f\x6b\145\154\x6f\x6d\x70\157\153\x5f\155\141\x70\x65\154", $insert); goto YrFtC; gQEHz: $this->db->where("\151\144\137\153\x65\x6c\x5f\155\x61\160\145\x6c", $id); goto WOM6m; aK3un: $id = $this->input->post("\x69\x64\137\x6b\x65\154\x5f\x6d\141\160\x65\x6c"); goto wHqIO; jKjcY: $this->output->set_content_type("\141\160\x70\x6c\x69\x63\x61\164\x69\x6f\x6e\57\x6a\163\x6f\x6e")->set_output($data); goto BCjFp; YrFtC: W0Ww9: goto jKjcY; B8723: if ($id != null) { goto jv00g; } goto hlVoH; wHqIO: $insert = ["\x6e\x61\x6d\x61\x5f\x6b\x65\154\137\x6d\x61\x70\145\x6c" => $this->input->post("\156\141\x6d\141\137\x6b\145\154\x5f\155\141\160\x65\154", true), "\153\x6f\x64\x65\x5f\x6b\x65\154\137\155\141\x70\145\x6c" => $this->input->post("\x6b\x6f\144\145\x5f\x6b\145\x6c\x5f\155\x61\x70\x65\154", true), "\153\141\164\145\147\x6f\x72\x69" => $this->input->post("\x6b\141\x74\145\x67\x6f\162\151", true), "\x69\144\x5f\160\x61\x72\145\156\x74" => $this->input->post("\151\x64\137\160\141\x72\x65\156\x74", true)]; goto B8723; XzirZ: goto W0Ww9; goto KeXYg; BCjFp: } public function hapusKelompok() { goto pzCWE; basKY: $nums = $this->db->count_all_results("\155\141\x73\x74\145\162\137\153\145\154\x6f\155\x70\157\x6b\x5f\x6d\141\x70\145\x6c"); goto GD98t; edK5X: array_push($messages, "\x4d\x61\x74\141\x20\120\145\154\141\152\141\162\x61\156"); goto PMjOd; qm9Dt: array_push($messages, "\123\x75\x62\40\113\x65\154\157\155\160\157\x6b"); goto qaB5C; l23WO: $id_parent = $this->input->post("\x69\144\137\x70\x61\162\145\x6e\164"); goto rlcRZ; IWjKe: $numm = $this->db->count_all_results("\x6d\141\163\x74\145\x72\x5f\155\141\160\x65\154"); goto IENmb; GD98t: if (!($nums > 0)) { goto C9j38; } goto qm9Dt; rlcRZ: $messages = []; goto xa4q2; v3UQR: $this->output_json(["\x73\164\141\x74\165\x73" => false, "\155\x65\x73\163\141\x67\x65" => "\x4b\x65\x6c\x6f\155\160\157\153\40\115\141\x70\x65\x6c\x20\144\x69\147\165\156\x61\153\141\x6e\x20\x64\151\x20" . count($messages) . "\x20\164\141\142\x65\154\x3a\x3c\142\162\x3e" . implode("\x3c\x62\162\x3e", $messages)]); goto ECVY9; eHuI4: if (!$this->master->delete("\155\141\x73\x74\145\162\x5f\x6b\x65\154\x6f\155\160\x6f\x6b\137\x6d\141\x70\x65\x6c", $id, "\151\144\x5f\153\x65\154\x5f\155\x61\160\x65\x6c")) { goto ghbMG; } goto qAlnS; fVtxc: ghbMG: goto O1ZUV; xa4q2: $this->db->where_in("\x6b\145\154\157\155\160\157\x6b", $kode); goto IWjKe; IENmb: if (!($numm > 0)) { goto QuJwX; } goto edK5X; RjIYM: $kode = $this->input->post("\x6b\157\x64\x65"); goto l23WO; O1ZUV: goto WoG9I; goto s2HRu; ECVY9: WoG9I: goto QxhGD; PMjOd: QuJwX: goto EKHO0; MVBWj: if (count($messages) > 0) { goto KNtOM; } goto eHuI4; s2HRu: KNtOM: goto v3UQR; qAlnS: $this->output_json(["\163\x74\141\164\x75\163" => true, "\155\145\163\163\141\x67\145" => "\142\x65\x72\x68\x61\x73\151\154"]); goto fVtxc; pzCWE: $id = $this->input->post("\151\x64\137\153\x65\x6c"); goto RjIYM; qaB5C: C9j38: goto MVBWj; EKHO0: $this->db->where_in("\151\x64\x5f\160\x61\x72\145\156\x74", $id); goto basKY; QxhGD: } public function create() { goto dYmic; oj1eL: $this->output->set_content_type("\141\160\x70\154\151\x63\x61\164\x69\157\156\57\x6a\163\157\x6e")->set_output($data); goto Ml8Bs; dYmic: $setting = $this->dashboard->getSetting(); goto zZz7w; zZz7w: $insert = ["\x6e\x61\x6d\x61\137\155\x61\160\145\x6c" => $this->input->post("\x6e\x61\x6d\141\x5f\155\141\160\145\x6c", true), "\153\157\144\145" => $this->input->post("\x6b\157\x64\x65\137\155\141\x70\x65\x6c", true), "\x6b\x65\154\x6f\155\160\157\153" => $this->input->post("\153\x65\x6c\x6f\x6d\160\157\153", true), "\x75\x72\x75\164\141\x6e\x5f\164\141\155\160\151\x6c" => $this->input->post("\165\x72\x75\x74\141\156\137\x74\x61\155\160\x69\154", true), "\152\145\x6e\152\x61\x6e\x67" => $setting->jenjang]; goto t9Yeg; t9Yeg: $data = $this->master->create("\155\x61\x73\164\x65\x72\137\155\141\160\145\x6c", $insert); goto oj1eL; Ml8Bs: } public function getDataKelompok() { goto Hiuni; Hiuni: $this->datatables->select("\52"); goto eOp_C; n2fsJ: echo $this->datatables->generate(); goto IHKRD; tsifK: $this->datatables->where("\151\144\x5f\x70\141\x72\145\x6e\x74", "\60"); goto qjwol; eOp_C: $this->datatables->from("\x6d\x61\163\164\145\162\137\153\145\x6c\157\x6d\x70\157\153\x5f\x6d\x61\160\x65\154"); goto tsifK; qjwol: $this->db->order_by("\x6b\157\x64\145\x5f\x6b\145\154\x5f\155\141\x70\x65\x6c"); goto n2fsJ; IHKRD: } public function getDataSubKelompok() { goto CPU0l; B7iaK: $this->datatables->from("\x6d\x61\x73\164\145\162\137\x6b\x65\154\157\x6d\160\x6f\x6b\x5f\x6d\x61\x70\x65\154"); goto upr6x; vhx6a: $this->db->order_by("\153\157\x64\x65\137\153\145\154\137\155\x61\x70\x65\x6c"); goto P4SOv; P4SOv: echo $this->datatables->generate(); goto D8MvD; CPU0l: $this->datatables->select("\x2a"); goto B7iaK; upr6x: $this->datatables->where("\x69\144\137\x70\x61\162\x65\x6e\x74\x20\x3c\x3e\x20\60"); goto vhx6a; D8MvD: } public function read() { goto X32cA; uQG1h: echo $this->datatables->generate(); goto RCeQj; G02k0: $this->datatables->from("\155\141\163\164\x65\x72\x5f\x6d\x61\160\145\x6c"); goto Owb_i; UFrpT: $this->datatables->select("\x69\x64\x5f\155\x61\160\145\154\54\40\165\162\165\164\141\x6e\x5f\164\x61\155\160\x69\154\x2c\40\x6e\141\x6d\141\137\155\x61\x70\145\154\54\40\x6b\x6f\144\145\x2c\x20\x6b\x65\154\x6f\x6d\x70\157\x6b\54\x20\144\x65\x6c\145\164\x61\x62\154\145\x2c\40\x73\164\141\x74\165\x73"); goto G02k0; TsptC: $this->db->order_by("\165\x72\165\x74\x61\156\x5f\164\141\155\160\151\x6c"); goto uQG1h; X32cA: $setting = $this->dashboard->getSetting(); goto UFrpT; Owb_i: $this->db->order_by("\x6b\x65\154\x6f\x6d\x70\x6f\x6b"); goto TsptC; RCeQj: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\160\x70\x6c\151\143\141\164\x69\x6f\156\x2f\x6a\x73\x6f\x6e")->set_output($data); } public function aktifkan($id) { goto jzBe7; fzP6c: $this->output_json($update); goto otTub; jzBe7: $this->db->set("\163\164\x61\164\x75\x73", "\61"); goto vNsDw; vNsDw: $this->db->where("\x69\144\137\155\141\x70\x65\x6c", $id); goto hEXgw; hEXgw: $update = $this->db->update("\155\141\x73\164\145\162\x5f\155\141\160\x65\154"); goto fzP6c; otTub: } public function delete() { goto YXpqY; sCu4S: $tabless = $this->db->list_tables(); goto oyTDw; QMkhL: cqVVh: goto v8esb; oyTDw: foreach ($tabless as $table) { goto lWqYU; Dfb1V: foreach ($fields as $field) { goto if6tq; tNUl4: rSWz_: goto V9ZBE; if6tq: if (!($field->name == "\151\144\x5f\155\141\160\145\154" || $field->name == "\x6d\141\160\x65\x6c\137\151\144")) { goto cXZ__; } goto Xdi3_; Xdi3_: array_push($tables, $table); goto CUu7_; CUu7_: cXZ__: goto tNUl4; V9ZBE: } goto VixOU; xquCu: euLEU: goto tEiw6; VixOU: DwpPQ: goto xquCu; lWqYU: $fields = $this->db->field_data($table); goto Dfb1V; tEiw6: } goto Wjxrd; KyhWe: goto q0TKv; goto JMJ39; RBIsv: $tables = []; goto sCu4S; YXpqY: $chk = $this->input->post("\x63\x68\x65\x63\x6b\x65\x64", true); goto ygM90; EMjCK: URVSN: goto JS7uc; Q1Bdr: foreach ($tables as $table) { goto qypVV; wBCh3: Qn9cE: goto mqm5E; PYnUT: if ($table == "\143\142\164\137\163\x6f\x61\154") { goto iL5v_; } goto W30my; qypVV: if (!($table != "\155\141\x73\x74\x65\x72\x5f\x6d\141\x70\x65\x6c")) { goto Qn9cE; } goto PYnUT; Nrgnw: iv40x: goto wBCh3; IOxyW: rcIqL: goto RCZGK; W30my: $this->db->where_in("\151\144\137\155\x61\160\145\154", $chk); goto mzk1s; mqm5E: IdDvj: goto TH4oH; v8hf8: $num = $this->db->count_all_results($table); goto IOxyW; LL0yS: array_push($messages, $table); goto Nrgnw; RCZGK: if (!($num > 0)) { goto iv40x; } goto LL0yS; CEWMX: iL5v_: goto HafnT; qOcaB: goto rcIqL; goto CEWMX; HafnT: $this->db->where_in("\x6d\141\160\145\154\137\151\144", $chk); goto v8hf8; mzk1s: $num = $this->db->count_all_results($table); goto qOcaB; TH4oH: } goto QMkhL; gqXMv: J64ZT: goto KyhWe; q9MDj: $this->output_json(["\x73\x74\141\164\x75\x73" => false, "\x74\x6f\164\x61\154" => "\124\151\x64\141\x6b\40\141\144\141\40\x64\141\x74\141\x20\x79\141\x6e\x67\x20\x64\x69\160\151\x6c\x69\150\x21"]); goto qxRw7; aXw1N: QB2MB: goto qeoGg; JS7uc: goto J64ZT; goto aXw1N; qxRw7: q0TKv: goto pnG4B; JMJ39: cyzXX: goto q9MDj; ygM90: if (!$chk) { goto cyzXX; } goto X4tRE; X4tRE: $messages = []; goto RBIsv; KQzU4: $this->output_json(["\x73\164\x61\164\165\x73" => true, "\x74\x6f\164\141\154" => count($chk)]); goto EMjCK; v8esb: if (count($messages) > 0) { goto QB2MB; } goto bmXeM; bmXeM: if (!$this->master->delete("\x6d\x61\163\164\145\x72\137\155\141\x70\x65\154", $chk, "\151\144\x5f\x6d\141\160\145\154")) { goto URVSN; } goto KQzU4; Wjxrd: eHL3D: goto Q1Bdr; qeoGg: $this->output_json(["\163\164\141\x74\x75\163" => false, "\164\x6f\x74\x61\154" => "\x4d\x61\x70\145\x6c\x20\144\151\x67\165\156\x61\x6b\141\156\40\144\x69\40" . count($messages) . "\40\x74\x61\x62\145\154\x3a\74\142\162\76" . implode("\74\142\162\x3e", $messages)]); goto gqXMv; pnG4B: } public function import($import_data = null) { goto jmH4a; grXLB: $data["\x74\x70\137\x61\143\x74\151\x76\145"] = $this->dashboard->getTahunActive(); goto JDzo_; Rh6zX: $data = ["\165\x73\145\x72" => $user, "\x6a\165\x64\x75\x6c" => "\115\141\164\141\x20\x50\145\154\141\152\141\x72\141\156", "\163\x75\142\152\165\144\x75\154" => "\x49\x6d\160\x6f\162\x74\40\115\x61\x74\x61\40\120\x65\x6c\141\x6a\x61\x72\141\156", "\160\162\x6f\x66\151\x6c\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\164\164\x69\156\147" => $this->dashboard->getSetting()]; goto IABXp; IABXp: if (!($import_data != null)) { goto C1dMI; } goto qEGAY; BYggn: $this->load->view("\137\164\x65\155\160\154\x61\x74\145\x73\x2f\144\x61\x73\x68\142\157\141\162\144\x2f\x5f\146\157\x6f\x74\145\x72"); goto YL9x0; jAxah: C1dMI: goto gGJYE; AnQG6: $this->load->view("\155\141\163\164\x65\x72\57\x6d\x61\160\145\x6c\57\x69\155\x70\x6f\x72\164"); goto BYggn; jmH4a: $user = $this->ion_auth->user()->row(); goto Rh6zX; gGJYE: $data["\x74\x70"] = $this->dashboard->getTahun(); goto grXLB; JDzo_: $data["\x73\x6d\164"] = $this->dashboard->getSemester(); goto z76Tq; z76Tq: $data["\163\155\x74\x5f\141\x63\x74\x69\x76\x65"] = $this->dashboard->getSemesterActive(); goto BTdvD; BTdvD: $this->load->view("\x5f\x74\145\155\160\x6c\141\x74\x65\x73\57\x64\x61\163\150\x62\157\x61\x72\x64\x2f\x5f\150\x65\141\144\145\162", $data); goto AnQG6; qEGAY: $data["\151\x6d\x70\157\162\x74"] = $import_data; goto jAxah; YL9x0: } public function previewExcel() { goto Ka2pO; mDG5Q: switch ($ext) { case "\x2e\x78\x6c\x73\170": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto lgXnb; case "\x2e\x78\x6c\163": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto lgXnb; case "\56\143\163\166": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto lgXnb; default: echo "\x75\x6e\x6b\156\x6f\167\x6e\40\x66\151\154\x65\40\145\170\164"; die; } goto GRL_T; a7MJX: Zcvia: goto Xs2Pq; K3QhW: JhsrX: goto w5Zu1; jXe9J: echo json_encode($data); goto L0sGH; c5SK2: eHXE_: goto hJsZf; oMRHq: $this->load->library("\165\x70\x6c\157\141\144", $config); goto YpDv9; ynEZr: $config["\155\141\x78\137\163\x69\x7a\x65"] = 2048; goto iPuPh; YpDv9: if (!$this->upload->do_upload("\165\x70\154\157\x61\x64\137\x66\151\x6c\x65")) { goto eHXE_; } goto TyAfV; QY3nX: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto FDsjE; Xs2Pq: uBbwe: goto uaNs0; HC1BJ: $data[] = ["\156\x61\155\141" => $sheetData[$i][1], "\x6b\x6f\144\145" => $sheetData[$i][2]]; goto a7MJX; y71yc: $config["\x61\x6c\154\157\167\x65\144\x5f\x74\x79\160\x65\163"] = "\170\x6c\x73\x7c\x78\x6c\x73\x78\x7c\143\x73\x76"; goto ynEZr; lvX_u: die; goto K3QhW; FDsjE: $data = []; goto hotSf; hotSf: $i = 1; goto uOak2; e8bLP: auXG6: goto FDzwx; k3Mss: lgXnb: goto vmYJn; L0sGH: goto JhsrX; goto c5SK2; P76fM: if (!($sheetData[$i][1] != null)) { goto Zcvia; } goto HC1BJ; TyAfV: $file = $this->upload->data("\146\x75\154\154\137\160\x61\164\150"); goto L0UlM; uaNs0: $i++; goto cupwD; cupwD: goto K4SJK; goto e8bLP; Ka2pO: $config["\165\x70\154\x6f\x61\x64\x5f\x70\x61\164\150"] = "\x2e\x2f\165\x70\x6c\157\141\144\163\x2f\151\x6d\160\157\x72\x74\x2f"; goto y71yc; qfr7A: if (!($i < count($sheetData))) { goto auXG6; } goto P76fM; GRL_T: Ke7EO: goto k3Mss; hJsZf: $error = $this->upload->display_errors(); goto jBGeP; uOak2: K4SJK: goto qfr7A; L0UlM: $ext = $this->upload->data("\x66\x69\154\145\137\145\x78\164"); goto mDG5Q; jBGeP: echo $error; goto lvX_u; vmYJn: $spreadsheet = $reader->load($file); goto QY3nX; iPuPh: $config["\145\x6e\143\162\x79\x70\x74\137\x6e\141\155\145"] = true; goto oMRHq; FDzwx: unlink($file); goto jXe9J; w5Zu1: } public function previewWord() { goto ihzsS; OxmY9: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto yBBX9; NP0sw: $config["\155\x61\x78\x5f\x73\x69\x7a\145"] = 2048; goto qgpSr; ihzsS: $config["\x75\160\154\157\141\x64\x5f\160\141\164\150"] = "\x2e\57\165\x70\154\157\x61\144\x73\x2f\x69\x6d\x70\157\162\x74\57"; goto mS6Ke; GpZtx: Tmwat: goto Sark3; LCDqe: $dom->loadHTML($text); goto AYcPQ; IiJWn: $dom = new DOMDocument(); goto LCDqe; re1fo: $file = $this->upload->data("\x66\x75\154\x6c\x5f\160\x61\164\150"); goto kZXT2; PW7sX: $i++; goto b7E2t; kB6Eh: $dom->preserveWhiteSpace = false; goto TMzKn; L3d27: unlink($file); goto b3NuO; qgpSr: $config["\x65\156\143\x72\x79\160\x74\137\x6e\x61\x6d\145"] = true; goto jNXoR; jNXoR: $this->load->library("\165\x70\x6c\157\x61\144", $config); goto qByoq; yBBX9: try { $htmlWriter->save("\x2e\57\165\x70\154\x6f\x61\144\x73\x2f\164\145\155\x70\57\144\x6f\x63\x2e\x68\164\155\x6c"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto L3d27; qIOe0: uOdzb: goto iFLN_; XJd9k: goto rNDKR; goto lR2th; b3NuO: $text = file_get_contents("\x2e\x2f\x75\160\x6c\x6f\141\144\163\x2f\x74\145\155\160\x2f\144\157\x63\x2e\150\x74\155\x6c"); goto IiJWn; vC_H9: $data[] = ["\156\x61\155\x61" => $cols->item(1)->nodeValue, "\153\x6f\x64\145" => $cols->item(2)->nodeValue]; goto dWpiF; lR2th: Lc9wz: goto H9UDa; kZXT2: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto OxmY9; A0ZJn: echo $error; goto zSimT; qByoq: if (!$this->upload->do_upload("\x75\160\x6c\x6f\141\144\x5f\146\151\x6c\x65")) { goto Lc9wz; } goto re1fo; H9UDa: $error = $this->upload->display_errors(); goto A0ZJn; xh5SI: $rows = $tables->item(0)->getElementsByTagName("\164\x72"); goto F3ESQ; LxF0m: $cols = $rows[$i]->getElementsByTagName("\x74\x64"); goto vC_H9; Sark3: echo json_encode($data); goto XJd9k; F3ESQ: $i = 1; goto qIOe0; dWpiF: bo9aJ: goto PW7sX; oF8rs: rNDKR: goto th19l; AYcPQ: $data = []; goto kB6Eh; iFLN_: if (!($i < $rows->count())) { goto Tmwat; } goto LxF0m; zSimT: die; goto oF8rs; b7E2t: goto uOdzb; goto GpZtx; TMzKn: $tables = $dom->getElementsByTagName("\x74\141\142\154\x65"); goto xh5SI; mS6Ke: $config["\141\154\154\x6f\167\145\144\137\x74\171\x70\x65\163"] = "\144\x6f\x63\x78"; goto NP0sw; th19l: } public function do_import() { goto bVBc5; pLU0V: $mapel = []; goto vEeAk; PzNE7: m_tvl: goto aD42z; vEeAk: foreach ($data as $j) { $mapel[] = ["\156\x61\x6d\141\x5f\155\141\160\145\x6c" => $j->nama, "\153\157\x64\145" => $j->kode]; s2h9l: } goto PzNE7; GrsB9: $this->output->set_content_type("\x61\160\x70\154\x69\x63\x61\164\151\157\x6e\x2f\152\163\x6f\x6e")->set_output($save); goto gPd1f; bVBc5: $data = json_decode($this->input->post("\155\141\x70\145\x6c", true)); goto pLU0V; aD42z: $save = $this->master->create("\155\141\x73\x74\x65\162\137\155\x61\x70\145\154", $mapel, true); goto GrsB9; gPd1f: } }
