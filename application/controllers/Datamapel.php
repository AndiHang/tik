<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\x45\120\101\124\x48") or exit("\116\157\x20\x64\151\162\145\x63\164\x20\x73\143\162\151\x70\x74\40\x61\x63\143\x65\x73\x73\40\141\x6c\x6c\157\167\x65\x64"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto FfsZb; m5LRs: iAo8E: goto mbBgw; PwmV_: redirect("\x61\x75\164\150"); goto AOj8Q; G62X6: if (!$this->ion_auth->logged_in()) { goto ogfey; } goto LkdDB; sgrFH: show_error("\110\x61\x6e\x79\x61\40\101\x64\x6d\151\x6e\x69\163\164\x72\141\164\x6f\x72\x20\x79\141\156\147\x20\144\151\x62\x65\x72\x69\40\x68\x61\153\x20\165\156\164\165\x6b\40\x6d\145\156\147\141\153\x73\x65\x73\x20\x68\x61\x6c\141\x6d\x61\x6e\40\x69\156\x69\x2c\40\74\x61\40\150\162\145\x66\75\x22" . base_url("\x64\x61\x73\150\x62\157\x61\162\144") . "\x22\x3e\x4b\x65\155\142\x61\x6c\151\x20\153\x65\40\x6d\x65\156\165\40\141\167\141\x6c\74\57\141\76", 403, "\101\x6b\163\x65\x73\40\x54\145\x72\154\x61\162\141\156\x67"); goto m5LRs; F1ibI: $this->load->model("\x44\x72\x6f\160\x64\157\167\156\137\x6d\157\144\x65\x6c", "\144\162\x6f\x70\x64\157\167\156"); goto E_ngs; biQBM: ogfey: goto PwmV_; f4u_M: $this->load->model("\x44\x61\x73\x68\142\x6f\141\162\x64\137\x6d\157\x64\145\x6c", "\144\141\163\150\142\x6f\141\162\x64"); goto F1ibI; kYIv5: $this->load->library(["\144\141\164\x61\164\141\x62\154\x65\x73", "\146\157\x72\155\x5f\166\x61\x6c\151\144\x61\x74\151\157\x6e"]); goto FnUOQ; D9yR_: $this->load->dbforge(); goto kYIv5; E_ngs: $this->form_validation->set_error_delimiters('', ''); goto R7AVU; FfsZb: parent::__construct(); goto G62X6; AOj8Q: yR5e1: goto D9yR_; LkdDB: if ($this->ion_auth->is_admin()) { goto iAo8E; } goto sgrFH; FnUOQ: $this->load->model("\115\x61\x73\x74\x65\162\x5f\x6d\x6f\144\x65\x6c", "\x6d\141\163\164\145\162"); goto f4u_M; mbBgw: goto yR5e1; goto biQBM; R7AVU: } public function output_json($data, $encode = true) { goto xmSdh; b5eTu: $this->output->set_content_type("\141\x70\160\x6c\151\143\x61\164\151\157\156\57\152\x73\x6f\x6e")->set_output($data); goto bEjYJ; PuolA: $data = json_encode($data); goto UOQJJ; xmSdh: if (!$encode) { goto ZgDDg; } goto PuolA; UOQJJ: ZgDDg: goto b5eTu; bEjYJ: } private function updateUrutanTampil() { goto gWBVV; bL2jE: foreach ($mapels as $mapel) { $insert = ["\x69\144\x5f\x6d\141\x70\x65\154" => $mapel->id_mapel, "\156\141\x6d\141\137\x6d\141\x70\145\154" => $mapel->id_mapel, "\x6b\x6f\144\x65" => $mapel->id_mapel, "\153\145\x6c\157\155\x70\157\153" => $mapel->id_mapel, "\142\x6f\142\157\x74\x5f\160" => $mapel->id_mapel, "\x62\157\x62\157\164\x5f\153" => $mapel->id_mapel, "\x6a\x65\156\x6a\141\156\147" => $mapel->id_mapel, "\165\x72\165\164\x61\156" => $mapel->id_mapel, "\x75\162\x75\164\141\156\137\164\x61\x6d\160\x69\154" => $mapel->id_mapel, "\x73\164\141\164\165\163" => $mapel->id_mapel, "\144\x65\154\x65\x74\x61\x62\154\x65" => $mapel->id_mapel]; giy0x: } goto Xp32R; Alavq: $insert = []; goto bL2jE; i_DMl: MDTpu: goto eGdOs; Xp32R: tROz4: goto L47pv; gWBVV: $mapels = $this->db->select("\x2a")->from("\x6d\141\163\x74\145\x72\137\x6d\x61\x70\x65\154")->get()->result(); goto Alavq; L47pv: if (!(count($insert) > 0)) { goto MDTpu; } goto PMGGq; PMGGq: $this->db->update_batch("\155\141\163\x74\x65\162\x5f\155\x61\160\145\154", $insert); goto i_DMl; eGdOs: } public function index() { goto ZKfy1; qGxZb: $data["\153\145\154\157\x6d\160\x6f\x6b\137\x6d\141\x70\x65\154"] = $this->master->getDataKelompokMapel(); goto OO70H; G7cpU: $data["\x6d\x61\160\x65\x6c\137\156\157\156\x5f\x61\153\164\x69\146"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto D_0K7; Z2VKH: $data["\153\145\154\x6f\x6d\x70\157\153"] = $this->dropdown->getDataKelompokMapel(); goto nDJHy; ZKfy1: if ($this->db->field_exists("\x75\162\165\x74\x61\x6e\x5f\x74\141\155\160\151\x6c", "\155\141\163\164\145\x72\x5f\x6d\x61\x70\x65\x6c")) { goto MJcJF; } goto bNdgT; o53HC: $this->load->view("\x5f\x74\x65\x6d\160\x6c\x61\x74\145\x73\x2f\x64\141\x73\x68\x62\x6f\x61\162\144\57\x5f\x66\x6f\x6f\x74\x65\162"); goto vKv_a; NmMvD: $data["\x74\160"] = $this->dashboard->getTahun(); goto txfPt; xOde7: $this->load->view("\155\x61\163\x74\x65\162\x2f\x6d\x61\x70\x65\x6c\57\144\141\x74\141"); goto o53HC; OO70H: $data["\163\165\x62\137\x6b\x65\154\157\x6d\x70\157\153\137\155\x61\160\145\154"] = $this->master->getDataSubKelompokMapel(); goto Z2VKH; YThbP: $data["\163\155\x74"] = $this->dashboard->getSemester(); goto B9uS1; txfPt: $data["\164\x70\137\141\x63\164\x69\166\145"] = $this->dashboard->getTahunActive(); goto YThbP; XeOt6: $this->dbforge->add_column("\155\141\163\164\x65\162\x5f\155\x61\x70\x65\x6c", $fields); goto p77KX; LIyP7: $data["\153\x61\164\145\x67\157\162\x69"] = ["\127\x41\x4a\x49\102", "\120\101\111\40\50\113\x65\155\145\156\141\147\51", "\120\105\x4d\111\116\x41\124\101\116\x20\x41\x4b\x41\104\105\x4d\111\113", "\x41\x4b\x41\104\x45\115\x49\113\x20\113\105\112\125\122\x55\x41\x4e", "\x4c\x49\116\124\x41\x53\x20\x4d\x49\116\x41\124", "\x4d\125\114\117\x4b"]; goto qGxZb; D_0K7: $this->load->view("\137\164\x65\155\x70\154\141\x74\x65\163\x2f\x64\x61\163\150\x62\157\141\x72\144\x2f\x5f\x68\x65\141\144\145\162", $data); goto xOde7; B9uS1: $data["\163\155\164\x5f\141\143\164\x69\x76\145"] = $this->dashboard->getSemesterActive(); goto LIyP7; MDO7v: $setting = $this->dashboard->getSetting(); goto KlDGo; p77KX: MJcJF: goto SBZno; KlDGo: $data = ["\x75\163\145\162" => $user, "\152\165\144\x75\154" => "\x4d\141\164\x61\40\120\145\x6c\141\x6a\x61\x72\141\x6e", "\x73\165\x62\152\x75\144\165\x6c" => "\x44\141\146\164\141\x72\40\115\141\x74\141\x20\120\145\x6c\141\152\x61\x72\x61\156", "\160\x72\157\146\151\154\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\164\x74\x69\x6e\x67" => $setting]; goto NmMvD; SBZno: $user = $this->ion_auth->user()->row(); goto MDO7v; bNdgT: $fields = array("\165\x72\165\164\x61\156\x5f\164\x61\x6d\x70\151\154" => array("\x74\x79\x70\x65" => "\151\156\164\50\x33\x29", "\x61\146\x74\x65\162" => "\x75\x72\x75\164\141\156")); goto XeOt6; nDJHy: $data["\163\164\x61\164\x75\x73"] = ["\116\157\x6e\x61\x6b\164\151\146", "\x41\x6b\x74\151\x66"]; goto G7cpU; vKv_a: } public function addKelompokMapel() { goto E0ZDH; TtR2k: $insert = ["\x6e\x61\x6d\x61\137\153\x65\154\x5f\x6d\x61\x70\x65\154" => $this->input->post("\156\141\x6d\x61\137\153\x65\154\x5f\x6d\x61\x70\145\154", true), "\x6b\157\144\145\137\x6b\145\154\x5f\x6d\141\160\145\154" => $this->input->post("\x6b\x6f\144\145\137\153\x65\x6c\x5f\155\x61\x70\x65\x6c", true), "\x6b\x61\164\145\147\157\162\151" => $this->input->post("\x6b\141\164\145\147\157\162\151", true), "\151\x64\x5f\x70\x61\162\x65\x6e\164" => $this->input->post("\151\x64\x5f\x70\141\x72\x65\156\164", true)]; goto J713t; gxXqp: qpxc4: goto FgG8y; X8rTW: goto qpxc4; goto iT_Mp; RFiBV: $data = $this->db->update("\155\x61\x73\164\x65\x72\137\153\x65\154\x6f\x6d\160\157\153\x5f\x6d\x61\160\145\154", $insert); goto gxXqp; E0ZDH: $id = $this->input->post("\151\x64\x5f\153\x65\154\x5f\155\x61\x70\x65\x6c"); goto TtR2k; FgG8y: $this->output->set_content_type("\141\160\160\154\151\143\x61\164\x69\x6f\156\57\152\x73\157\x6e")->set_output($data); goto yt0Mv; iT_Mp: C_H03: goto MRJqX; eu60y: $data = $this->master->create("\x6d\141\x73\x74\x65\162\x5f\153\145\154\157\x6d\x70\157\153\137\x6d\141\160\x65\x6c", $insert); goto X8rTW; MRJqX: $this->db->where("\151\144\137\x6b\145\x6c\137\155\141\160\145\x6c", $id); goto RFiBV; J713t: if ($id != null) { goto C_H03; } goto eu60y; yt0Mv: } public function hapusKelompok() { goto lXyCq; jm4Sw: tVHaC: goto lwPf4; qxcJV: goto tVHaC; goto HNktI; HNktI: gjUz4: goto iEPvg; FD0pg: $numm = $this->db->count_all_results("\x6d\x61\x73\164\x65\x72\137\155\141\x70\x65\154"); goto rfhtO; lXyCq: $id = $this->input->post("\x69\144\137\153\145\154"); goto CK4K8; u8dL8: $this->db->where_in("\x6b\145\154\x6f\155\160\x6f\153", $kode); goto FD0pg; A_CbO: $id_parent = $this->input->post("\151\144\x5f\160\141\x72\x65\156\x74"); goto XToUc; xr24a: yfbkc: goto qxcJV; rTc5w: E8yp8: goto euyfn; iEPvg: $this->output_json(["\x73\x74\141\x74\x75\x73" => false, "\x6d\145\x73\x73\x61\147\x65" => "\x4b\145\154\x6f\x6d\x70\157\x6b\40\115\x61\x70\x65\x6c\40\x64\151\x67\165\156\x61\153\141\156\40\144\151\40" . count($messages) . "\40\x74\x61\142\x65\154\x3a\x3c\x62\162\76" . implode("\74\x62\162\x3e", $messages)]); goto jm4Sw; EnnIc: $this->output_json(["\x73\x74\141\x74\x75\163" => true, "\x6d\x65\x73\163\141\x67\x65" => "\x62\145\162\150\x61\163\x69\x6c"]); goto xr24a; h6fyg: if (!$this->master->delete("\x6d\141\163\164\145\162\x5f\153\x65\154\157\155\x70\x6f\x6b\137\x6d\x61\160\145\x6c", $id, "\x69\144\x5f\153\145\154\x5f\155\x61\160\x65\154")) { goto yfbkc; } goto EnnIc; Mlh2k: array_push($messages, "\123\165\142\x20\113\145\x6c\x6f\155\x70\157\x6b"); goto Wd5pU; CK4K8: $kode = $this->input->post("\153\157\x64\x65"); goto A_CbO; Wd5pU: JnY5t: goto mawLU; mawLU: if (count($messages) > 0) { goto gjUz4; } goto h6fyg; hlz1w: $nums = $this->db->count_all_results("\x6d\x61\x73\x74\145\162\137\x6b\145\154\157\x6d\x70\x6f\x6b\137\155\141\160\x65\x6c"); goto apkH0; XToUc: $messages = []; goto u8dL8; euyfn: $this->db->where_in("\151\x64\137\x70\141\x72\x65\156\x74", $id); goto hlz1w; apkH0: if (!($nums > 0)) { goto JnY5t; } goto Mlh2k; rfhtO: if (!($numm > 0)) { goto E8yp8; } goto OsPdc; OsPdc: array_push($messages, "\115\x61\x74\141\x20\120\145\154\141\152\x61\162\141\x6e"); goto rTc5w; lwPf4: } public function create() { goto dAv9A; dEvZB: $data = $this->master->create("\155\x61\163\164\x65\162\137\155\x61\x70\145\x6c", $insert); goto UCC1W; jGNqM: $insert = ["\x6e\x61\x6d\141\137\155\x61\x70\x65\x6c" => $this->input->post("\x6e\141\155\x61\x5f\155\x61\160\145\154", true), "\x6b\x6f\x64\145" => $this->input->post("\153\x6f\144\145\x5f\155\x61\x70\145\x6c", true), "\153\145\154\157\155\160\x6f\153" => $this->input->post("\x6b\x65\154\157\155\160\157\153", true), "\165\x72\x75\x74\x61\156\137\x74\141\x6d\160\x69\x6c" => $this->input->post("\165\x72\165\x74\141\156\x5f\164\141\155\x70\x69\154", true), "\x6a\x65\156\x6a\141\156\147" => $setting->jenjang]; goto dEvZB; UCC1W: $this->output->set_content_type("\x61\x70\x70\154\x69\x63\141\164\151\157\x6e\57\x6a\x73\157\156")->set_output($data); goto r8fJ0; dAv9A: $setting = $this->dashboard->getSetting(); goto jGNqM; r8fJ0: } public function getDataKelompok() { goto uBJaT; tp9ay: echo $this->datatables->generate(); goto Nf3T1; fUGFn: $this->db->order_by("\x6b\x6f\x64\x65\x5f\x6b\145\154\x5f\x6d\141\x70\145\154"); goto tp9ay; wk89s: $this->datatables->where("\x69\x64\137\160\141\162\145\156\x74", "\x30"); goto fUGFn; uBJaT: $this->datatables->select("\x2a"); goto z8428; z8428: $this->datatables->from("\x6d\141\x73\x74\x65\162\x5f\153\x65\154\x6f\155\x70\157\x6b\137\x6d\141\x70\145\154"); goto wk89s; Nf3T1: } public function getDataSubKelompok() { goto W3uCj; ImEwc: $this->datatables->from("\155\141\x73\x74\x65\x72\137\153\145\154\157\155\x70\x6f\x6b\x5f\155\141\160\x65\x6c"); goto Pqhia; Pqhia: $this->datatables->where("\151\x64\x5f\160\141\162\x65\x6e\164\40\x3c\76\40\x30"); goto qQSOo; qQSOo: $this->db->order_by("\153\157\x64\x65\x5f\153\x65\x6c\137\x6d\141\160\x65\x6c"); goto GHzRu; GHzRu: echo $this->datatables->generate(); goto WZVIR; W3uCj: $this->datatables->select("\52"); goto ImEwc; WZVIR: } public function read() { goto owvbC; UJoDc: $this->db->order_by("\165\x72\x75\x74\x61\x6e\137\x74\141\x6d\160\x69\154"); goto CgxuV; CgxuV: echo $this->datatables->generate(); goto mZ3Pj; MZRZk: $this->db->order_by("\x6b\x65\154\x6f\155\x70\x6f\153"); goto UJoDc; xR4U6: $this->datatables->select("\x69\144\x5f\155\141\x70\x65\x6c\54\40\165\162\165\164\x61\x6e\137\x74\x61\x6d\x70\151\154\54\40\156\141\x6d\141\x5f\155\141\160\145\x6c\54\40\x6b\x6f\144\145\x2c\x20\153\x65\x6c\x6f\x6d\160\157\153\x2c\40\x64\145\x6c\x65\164\141\142\x6c\145\x2c\40\163\x74\x61\164\x75\x73"); goto D_X8t; D_X8t: $this->datatables->from("\x6d\141\163\164\145\162\x5f\x6d\141\160\145\154"); goto MZRZk; owvbC: $setting = $this->dashboard->getSetting(); goto xR4U6; mZ3Pj: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\160\x70\154\x69\143\141\x74\x69\157\x6e\x2f\x6a\163\157\156")->set_output($data); } public function aktifkan($id) { goto yAfr8; qElNC: $this->db->where("\151\x64\137\x6d\x61\x70\x65\154", $id); goto zxdaj; zxdaj: $update = $this->db->update("\155\141\x73\164\x65\x72\137\155\141\x70\x65\x6c"); goto vsFnz; vsFnz: $this->output_json($update); goto q70Hp; yAfr8: $this->db->set("\x73\164\141\x74\x75\x73", "\61"); goto qElNC; q70Hp: } public function delete() { goto cbPt6; l0VEp: AP8ho: goto TbUG5; u76LD: if (!$this->master->delete("\x6d\141\x73\164\145\x72\137\x6d\141\x70\x65\154", $chk, "\151\x64\x5f\x6d\141\x70\145\x6c")) { goto abVO2; } goto oXuwj; m0JfG: atbMl: goto FMIWx; DStKm: if (count($messages) > 0) { goto sR1XQ; } goto u76LD; FGgdO: goto EV0dg; goto l0VEp; BIWLo: abVO2: goto yce4J; abd5H: $this->output_json(["\x73\164\x61\164\165\163" => false, "\164\157\164\x61\154" => "\x4d\141\x70\145\154\x20\x64\151\x67\x75\x6e\x61\153\141\x6e\x20\x64\x69\40" . count($messages) . "\40\x74\141\x62\145\154\72\74\142\x72\76" . implode("\x3c\142\x72\x3e", $messages)]); goto CxjIa; yce4J: goto Byxzs; goto LUsqJ; SoTEK: $messages = []; goto rKT9j; TbUG5: $this->output_json(["\x73\x74\141\x74\x75\x73" => false, "\x74\157\164\x61\x6c" => "\124\151\x64\x61\153\40\141\x64\141\40\144\x61\x74\141\x20\x79\141\x6e\x67\x20\x64\x69\x70\151\x6c\x69\150\41"]); goto eXK8K; jw0Dy: if (!$chk) { goto AP8ho; } goto SoTEK; FMIWx: foreach ($tables as $table) { goto WRzPM; gfxau: array_push($messages, $table); goto UjkSl; UjkSl: dJhJ6: goto oAqZk; oYqSU: goto Ur7b_; goto vQU5h; mbX0L: $num = $this->db->count_all_results($table); goto BrNdM; vQU5h: KLpuh: goto V8xV0; vk4Cy: if ($table == "\x63\x62\x74\x5f\163\157\x61\154") { goto KLpuh; } goto XJTlk; oAqZk: TsPSn: goto kZH1D; V8xV0: $this->db->where_in("\x6d\x61\160\145\154\x5f\151\x64", $chk); goto mbX0L; XJTlk: $this->db->where_in("\x69\144\x5f\155\141\x70\145\154", $chk); goto TGLiD; gM6m0: if (!($num > 0)) { goto dJhJ6; } goto gfxau; WRzPM: if (!($table != "\x6d\141\x73\x74\145\x72\x5f\x6d\141\160\145\154")) { goto TsPSn; } goto vk4Cy; TGLiD: $num = $this->db->count_all_results($table); goto oYqSU; kZH1D: JcZht: goto Cyp5m; BrNdM: Ur7b_: goto gM6m0; Cyp5m: } goto Usqq9; cbPt6: $chk = $this->input->post("\x63\x68\145\x63\x6b\145\144", true); goto jw0Dy; dSxk3: foreach ($tabless as $table) { goto z_iYS; z_iYS: $fields = $this->db->field_data($table); goto NT1LT; gvPdu: fwere: goto GWKxi; mkxu7: PvSNr: goto gvPdu; NT1LT: foreach ($fields as $field) { goto GkrS5; BJt7m: sC7at: goto pU5bO; pU5bO: AnFg8: goto k3lRC; OeJDy: array_push($tables, $table); goto BJt7m; GkrS5: if (!($field->name == "\x69\144\137\155\141\160\145\x6c" || $field->name == "\x6d\x61\160\x65\x6c\x5f\x69\144")) { goto sC7at; } goto OeJDy; k3lRC: } goto mkxu7; GWKxi: } goto m0JfG; BmXmq: $tabless = $this->db->list_tables(); goto dSxk3; LUsqJ: sR1XQ: goto abd5H; Usqq9: yaqCO: goto DStKm; eXK8K: EV0dg: goto xqW4i; rKT9j: $tables = []; goto BmXmq; CxjIa: Byxzs: goto FGgdO; oXuwj: $this->output_json(["\x73\x74\141\164\165\x73" => true, "\x74\157\x74\x61\154" => count($chk)]); goto BIWLo; xqW4i: } public function import($import_data = null) { goto oZe2d; WM6Tr: $data["\163\x6d\x74\x5f\x61\x63\x74\151\x76\x65"] = $this->dashboard->getSemesterActive(); goto Dnv11; mI6Jp: $this->load->view("\155\141\x73\x74\145\162\57\155\141\160\x65\154\57\x69\155\x70\157\x72\164"); goto fbLk4; yKOgK: $data["\151\155\x70\157\x72\164"] = $import_data; goto Z3uGO; oZe2d: $user = $this->ion_auth->user()->row(); goto uL55T; Dnv11: $this->load->view("\x5f\164\145\x6d\160\154\x61\x74\145\163\57\x64\x61\x73\x68\x62\157\x61\162\x64\x2f\137\150\145\x61\x64\x65\162", $data); goto mI6Jp; eo3n5: if (!($import_data != null)) { goto Rb7Lg; } goto yKOgK; K3e9i: $data["\164\x70"] = $this->dashboard->getTahun(); goto Fjm0I; Gh2RU: $data["\x73\155\164"] = $this->dashboard->getSemester(); goto WM6Tr; Z3uGO: Rb7Lg: goto K3e9i; Fjm0I: $data["\x74\160\x5f\141\x63\164\151\x76\145"] = $this->dashboard->getTahunActive(); goto Gh2RU; fbLk4: $this->load->view("\137\x74\x65\155\x70\154\141\164\x65\163\57\x64\141\163\x68\142\x6f\141\162\x64\x2f\137\146\x6f\x6f\164\145\162"); goto vUW8E; uL55T: $data = ["\x75\163\x65\162" => $user, "\x6a\x75\144\x75\154" => "\115\141\x74\x61\x20\x50\145\x6c\x61\x6a\x61\x72\x61\x6e", "\x73\x75\142\x6a\x75\144\x75\154" => "\x49\x6d\x70\157\x72\x74\40\x4d\x61\x74\x61\x20\x50\145\154\141\152\141\162\x61\156", "\160\x72\157\146\151\154\145" => $this->dashboard->getProfileAdmin($user->id), "\163\145\164\x74\151\156\147" => $this->dashboard->getSetting()]; goto eo3n5; vUW8E: } public function previewExcel() { goto NyZ7N; ISWLs: QP3ev: goto mCCSD; UeJMg: echo json_encode($data); goto FLQmA; E2kMS: $this->load->library("\165\160\154\157\x61\x64", $config); goto DJM9A; BKLKe: $config["\145\156\x63\x72\x79\160\x74\137\156\x61\155\145"] = true; goto E2kMS; mKBMw: $file = $this->upload->data("\146\165\x6c\x6c\x5f\160\x61\164\150"); goto DLDgD; DJM9A: if (!$this->upload->do_upload("\x75\160\x6c\x6f\x61\144\137\x66\151\x6c\145")) { goto yB0XQ; } goto mKBMw; CMB5Z: $error = $this->upload->display_errors(); goto xULNl; NyZ7N: $config["\x75\x70\x6c\x6f\141\x64\137\160\x61\x74\150"] = "\56\x2f\x75\160\154\x6f\x61\x64\163\x2f\x69\155\x70\157\x72\164\57"; goto NSlLa; NSlLa: $config["\141\x6c\x6c\157\x77\x65\x64\x5f\164\x79\x70\145\x73"] = "\170\x6c\163\174\170\x6c\x73\170\174\x63\x73\166"; goto pNzoZ; cNprT: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto yzIL7; t0v7T: H_qYU: goto Lw89H; yzIL7: $data = []; goto uyvEM; KpZEg: $spreadsheet = $reader->load($file); goto cNprT; vjDPT: goto EbYFX; goto Py1Vv; M9VGU: if (!($sheetData[$i][1] != null)) { goto QP3ev; } goto b14Dm; EPpyB: die; goto V19Ez; pNzoZ: $config["\x6d\141\x78\x5f\163\151\172\x65"] = 2048; goto BKLKe; mCCSD: d12jS: goto VesoD; uyvEM: $i = 1; goto xoV_N; VAZ2P: yB0XQ: goto CMB5Z; xULNl: echo $error; goto EPpyB; VesoD: $i++; goto vjDPT; Py1Vv: huuBw: goto vlJoZ; Lw89H: Ir1Vu: goto KpZEg; V19Ez: uvHU6: goto fc_JY; blr4Q: if (!($i < count($sheetData))) { goto huuBw; } goto M9VGU; DLDgD: $ext = $this->upload->data("\146\x69\x6c\x65\x5f\x65\x78\x74"); goto Gm5tF; vlJoZ: unlink($file); goto UeJMg; xoV_N: EbYFX: goto blr4Q; Gm5tF: switch ($ext) { case "\x2e\x78\154\163\170": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto Ir1Vu; case "\56\170\x6c\163": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto Ir1Vu; case "\56\143\163\166": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto Ir1Vu; default: echo "\x75\156\x6b\156\x6f\167\156\x20\x66\151\154\145\40\x65\170\164"; die; } goto t0v7T; b14Dm: $data[] = ["\x6e\x61\x6d\x61" => $sheetData[$i][1], "\x6b\x6f\144\x65" => $sheetData[$i][2]]; goto ISWLs; FLQmA: goto uvHU6; goto VAZ2P; fc_JY: } public function previewWord() { goto JTDcd; UhWXG: $config["\141\154\x6c\x6f\x77\x65\144\x5f\x74\x79\x70\x65\163"] = "\144\157\x63\170"; goto oiLB7; T_Rv3: $data[] = ["\156\x61\155\141" => $cols->item(1)->nodeValue, "\153\157\144\x65" => $cols->item(2)->nodeValue]; goto c1KAC; U_BeF: $error = $this->upload->display_errors(); goto VMTZO; h0SAL: die; goto ob7oG; JTDcd: $config["\x75\160\x6c\157\x61\144\137\160\x61\x74\x68"] = "\56\x2f\x75\160\154\157\x61\x64\x73\x2f\x69\155\x70\157\x72\164\57"; goto UhWXG; eZDDe: $i++; goto O3VYr; GWLJk: $dom->loadHTML($text); goto kM9Fz; OhPtd: if (!($i < $rows->count())) { goto VKFVR; } goto tlGyI; c1KAC: t4RmM: goto eZDDe; ah1tr: fOUtj: goto U_BeF; HRkQn: It6zR: goto OhPtd; O3VYr: goto It6zR; goto HZJ9k; UrHWl: echo json_encode($data); goto JOD0v; xb45L: $file = $this->upload->data("\146\x75\154\x6c\x5f\x70\x61\164\x68"); goto XIxMk; JOD0v: goto jjqsm; goto ah1tr; iuNJO: $this->load->library("\x75\x70\154\x6f\x61\x64", $config); goto kaGTv; k63bp: $config["\145\x6e\143\x72\x79\x70\164\137\x6e\x61\155\x65"] = true; goto iuNJO; kaGTv: if (!$this->upload->do_upload("\165\x70\x6c\x6f\141\144\x5f\x66\x69\154\x65")) { goto fOUtj; } goto xb45L; wbHlt: $dom = new DOMDocument(); goto GWLJk; E4jlP: $text = file_get_contents("\x2e\57\165\160\x6c\x6f\x61\x64\163\x2f\164\x65\x6d\160\57\x64\x6f\x63\x2e\150\x74\x6d\154"); goto wbHlt; HZJ9k: VKFVR: goto UrHWl; dgpmI: $tables = $dom->getElementsByTagName("\164\x61\x62\154\x65"); goto WnJxm; DKogp: unlink($file); goto E4jlP; oiLB7: $config["\x6d\141\x78\x5f\x73\x69\172\145"] = 2048; goto k63bp; XIxMk: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto QA621; X9znL: $dom->preserveWhiteSpace = false; goto dgpmI; gV2xq: try { $htmlWriter->save("\x2e\x2f\x75\x70\x6c\x6f\141\144\163\x2f\164\x65\155\160\57\144\157\x63\56\150\x74\155\154"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto DKogp; dX06Y: $i = 1; goto HRkQn; ob7oG: jjqsm: goto ogzNw; QA621: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto gV2xq; VMTZO: echo $error; goto h0SAL; WnJxm: $rows = $tables->item(0)->getElementsByTagName("\x74\x72"); goto dX06Y; kM9Fz: $data = []; goto X9znL; tlGyI: $cols = $rows[$i]->getElementsByTagName("\164\x64"); goto T_Rv3; ogzNw: } public function do_import() { goto lP6Rd; lP6Rd: $data = json_decode($this->input->post("\x6d\141\x70\145\154", true)); goto WaMyb; iMQ9o: G0p84: goto tFPOX; FwaL6: foreach ($data as $j) { $mapel[] = ["\x6e\141\155\141\137\155\141\160\x65\154" => $j->nama, "\x6b\x6f\144\x65" => $j->kode]; UEJD4: } goto iMQ9o; tFPOX: $save = $this->master->create("\155\x61\x73\x74\145\x72\137\155\141\x70\145\154", $mapel, true); goto EDKIL; EDKIL: $this->output->set_content_type("\141\160\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\152\163\x6f\156")->set_output($save); goto VGMtN; WaMyb: $mapel = []; goto FwaL6; VGMtN: } }
