<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\105\x50\x41\x54\x48") or exit("\x4e\x6f\x20\144\151\162\x65\143\164\x20\163\x63\x72\x69\160\x74\40\x61\143\143\145\163\163\40\141\x6c\x6c\x6f\x77\x65\x64"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto c2Ov7; zWGui: show_error("\110\x61\x6e\x79\141\40\x41\144\x6d\151\x6e\x69\163\164\162\x61\164\x6f\162\40\171\141\x6e\147\40\144\x69\142\145\162\x69\40\150\x61\x6b\x20\165\156\x74\165\x6b\x20\155\x65\156\x67\x61\153\x73\x65\x73\40\x68\x61\x6c\x61\x6d\x61\x6e\40\151\156\151\x2c\40\x3c\x61\40\x68\x72\145\x66\75\42" . base_url("\x64\x61\x73\x68\x62\x6f\x61\162\144") . "\42\x3e\x4b\145\155\142\141\154\x69\x20\x6b\x65\40\x6d\145\156\x75\x20\141\x77\x61\x6c\74\57\x61\76", 403, "\101\153\x73\x65\163\40\124\145\x72\x6c\x61\162\x61\156\147"); goto laysf; SA_id: ft0K8: goto aaVbB; ZHM3q: if ($this->ion_auth->is_admin()) { goto YT0Cw; } goto zWGui; DCMHw: if (!$this->ion_auth->logged_in()) { goto DkJqZ; } goto ZHM3q; I3w3q: $this->load->model("\115\x61\x73\x74\x65\x72\x5f\x6d\x6f\x64\x65\x6c", "\x6d\x61\163\164\145\x72"); goto yZ5R3; A50th: redirect("\x61\165\x74\x68"); goto SA_id; Y4H1Y: $this->form_validation->set_error_delimiters('', ''); goto hACO1; laysf: YT0Cw: goto xaMrt; xaMrt: goto ft0K8; goto GbAH1; yZ5R3: $this->load->model("\104\x61\x73\150\x62\157\x61\x72\144\137\x6d\x6f\144\x65\154", "\144\141\163\x68\x62\x6f\x61\162\144"); goto JPXHd; GbAH1: DkJqZ: goto A50th; aaVbB: $this->load->dbforge(); goto cgf3B; JPXHd: $this->load->model("\x44\x72\x6f\x70\x64\x6f\x77\x6e\137\x6d\157\144\x65\154", "\x64\x72\157\160\144\x6f\x77\x6e"); goto Y4H1Y; c2Ov7: parent::__construct(); goto DCMHw; cgf3B: $this->load->library(["\x64\141\164\x61\x74\x61\x62\x6c\145\163", "\x66\157\x72\x6d\137\166\141\x6c\x69\x64\141\x74\151\x6f\x6e"]); goto I3w3q; hACO1: } public function output_json($data, $encode = true) { goto OdtMY; Z_GEr: $this->output->set_content_type("\x61\160\160\154\x69\x63\x61\164\151\157\x6e\x2f\152\x73\157\x6e")->set_output($data); goto O7T72; Xidpa: $data = json_encode($data); goto Aksi0; Aksi0: JaeyU: goto Z_GEr; OdtMY: if (!$encode) { goto JaeyU; } goto Xidpa; O7T72: } private function updateUrutanTampil() { goto QpNHP; QpNHP: $mapels = $this->db->select("\52")->from("\x6d\141\x73\164\x65\162\137\155\x61\x70\145\154")->get()->result(); goto Dot83; Ei9se: OngQs: goto xQtKS; fBg_I: StL3x: goto m2V6K; ZyUkH: $this->db->update_batch("\155\141\163\x74\x65\x72\137\155\141\160\145\x6c", $insert); goto fBg_I; Dot83: $insert = []; goto e43qx; xQtKS: if (!(count($insert) > 0)) { goto StL3x; } goto ZyUkH; e43qx: foreach ($mapels as $mapel) { $insert = ["\151\144\137\x6d\141\x70\x65\x6c" => $mapel->id_mapel, "\x6e\x61\155\141\x5f\155\x61\160\145\154" => $mapel->id_mapel, "\153\157\x64\145" => $mapel->id_mapel, "\x6b\145\154\x6f\155\160\x6f\x6b" => $mapel->id_mapel, "\x62\x6f\x62\157\x74\x5f\x70" => $mapel->id_mapel, "\142\x6f\142\157\164\137\153" => $mapel->id_mapel, "\x6a\x65\156\x6a\141\x6e\147" => $mapel->id_mapel, "\165\x72\x75\x74\141\156" => $mapel->id_mapel, "\x75\162\x75\x74\x61\x6e\137\x74\141\x6d\x70\x69\154" => $mapel->id_mapel, "\163\x74\x61\x74\165\163" => $mapel->id_mapel, "\144\x65\154\x65\x74\x61\x62\154\145" => $mapel->id_mapel]; Zm7p4: } goto Ei9se; m2V6K: } public function index() { goto qrbjm; q82ih: $data["\x6b\145\x6c\157\155\160\x6f\153"] = $this->dropdown->getDataKelompokMapel(); goto JoYeC; he9VZ: $data["\x6d\x61\160\145\154\x5f\156\x6f\156\x5f\x61\x6b\164\151\146"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto md0HU; SWQRY: ppBdR: goto vTIrC; FV7fT: $data["\163\x6d\164"] = $this->dashboard->getSemester(); goto w5WXt; vTIrC: $user = $this->ion_auth->user()->row(); goto S0yvF; okNFY: $data["\x73\x75\x62\x5f\153\145\x6c\x6f\x6d\160\157\153\x5f\x6d\141\160\x65\154"] = $this->master->getDataSubKelompokMapel(); goto q82ih; y8g99: $this->load->view("\137\x74\x65\x6d\x70\154\x61\x74\x65\163\57\x64\141\163\150\142\x6f\x61\x72\x64\x2f\137\x66\x6f\157\x74\x65\x72"); goto Wswgr; w5WXt: $data["\163\x6d\x74\x5f\x61\143\x74\x69\x76\145"] = $this->dashboard->getSemesterActive(); goto xjh7T; ajZ1J: $data["\153\145\x6c\157\155\x70\157\153\137\x6d\x61\160\145\154"] = $this->master->getDataKelompokMapel(); goto okNFY; D2Rgr: $data = ["\x75\163\x65\162" => $user, "\152\x75\144\165\154" => "\115\141\164\x61\x20\120\145\x6c\141\x6a\141\x72\141\x6e", "\x73\x75\x62\152\x75\144\x75\154" => "\x44\141\x66\164\x61\162\40\x4d\141\x74\x61\x20\120\145\x6c\141\152\x61\x72\x61\x6e", "\160\x72\157\x66\x69\154\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\x74\164\151\156\x67" => $setting]; goto ITNIg; md0HU: $this->load->view("\x5f\164\145\x6d\x70\x6c\x61\x74\x65\x73\57\x64\141\x73\150\x62\157\141\x72\144\57\x5f\150\x65\141\144\145\162", $data); goto c1d4P; ITNIg: $data["\164\x70"] = $this->dashboard->getTahun(); goto NSkKF; dvUVF: $fields = array("\x75\x72\165\164\141\x6e\137\x74\x61\155\160\151\154" => array("\164\x79\160\145" => "\x69\x6e\x74\50\63\x29", "\x61\146\x74\145\162" => "\x75\x72\165\164\141\x6e")); goto GQeZy; NSkKF: $data["\164\x70\137\141\x63\x74\151\x76\x65"] = $this->dashboard->getTahunActive(); goto FV7fT; c1d4P: $this->load->view("\155\x61\x73\164\x65\x72\x2f\155\x61\x70\145\x6c\x2f\144\x61\x74\141"); goto y8g99; xjh7T: $data["\153\141\164\x65\x67\x6f\x72\151"] = ["\127\x41\112\x49\102", "\x50\x41\111\40\50\113\x65\155\145\156\141\x67\x29", "\120\x45\115\111\116\x41\124\101\x4e\40\101\x4b\x41\x44\105\115\x49\113", "\x41\113\x41\x44\105\115\111\113\x20\113\105\112\125\122\x55\101\116", "\x4c\111\x4e\124\101\123\x20\115\x49\x4e\101\124", "\x4d\125\x4c\117\113"]; goto ajZ1J; qrbjm: if ($this->db->field_exists("\165\162\x75\x74\141\x6e\137\164\x61\x6d\160\x69\154", "\x6d\x61\x73\164\x65\x72\x5f\x6d\x61\160\145\154")) { goto ppBdR; } goto dvUVF; S0yvF: $setting = $this->dashboard->getSetting(); goto D2Rgr; JoYeC: $data["\x73\164\141\x74\x75\163"] = ["\x4e\x6f\156\141\153\x74\151\x66", "\x41\x6b\164\x69\146"]; goto he9VZ; GQeZy: $this->dbforge->add_column("\x6d\141\x73\164\x65\162\x5f\155\141\x70\145\x6c", $fields); goto SWQRY; Wswgr: } public function addKelompokMapel() { goto WoW5I; IlbmQ: if ($id != null) { goto qnEi_; } goto D0Vzs; xhLMX: $this->db->where("\151\x64\137\153\145\x6c\x5f\155\141\x70\x65\x6c", $id); goto BisxD; UaOOR: goto f5v5j; goto JrlR_; BisxD: $data = $this->db->update("\155\141\x73\x74\x65\162\x5f\153\x65\x6c\157\155\x70\x6f\x6b\x5f\x6d\141\x70\145\x6c", $insert); goto KnWbC; Cjte_: $insert = ["\x6e\x61\x6d\141\x5f\x6b\145\154\137\155\141\160\145\x6c" => $this->input->post("\x6e\141\155\x61\x5f\153\x65\x6c\x5f\x6d\x61\x70\x65\154", true), "\x6b\157\144\x65\x5f\x6b\145\x6c\137\x6d\x61\160\145\154" => $this->input->post("\153\157\144\x65\x5f\x6b\145\154\x5f\155\x61\x70\x65\x6c", true), "\x6b\141\x74\145\x67\157\162\151" => $this->input->post("\x6b\x61\164\x65\147\x6f\x72\151", true), "\x69\144\137\160\141\x72\145\156\164" => $this->input->post("\x69\144\x5f\160\x61\x72\x65\x6e\x74", true)]; goto IlbmQ; JrlR_: qnEi_: goto xhLMX; D0Vzs: $data = $this->master->create("\155\141\163\164\145\x72\137\x6b\145\x6c\x6f\155\x70\x6f\x6b\x5f\155\141\x70\x65\x6c", $insert); goto UaOOR; pvq_f: $this->output->set_content_type("\141\160\x70\154\151\x63\x61\x74\151\157\x6e\x2f\x6a\x73\x6f\156")->set_output($data); goto OorFH; KnWbC: f5v5j: goto pvq_f; WoW5I: $id = $this->input->post("\x69\144\x5f\153\145\x6c\x5f\x6d\141\160\x65\154"); goto Cjte_; OorFH: } public function hapusKelompok() { goto VnVmU; yuPOL: $this->output_json(["\x73\164\141\164\x75\163" => true, "\155\145\x73\163\x61\147\145" => "\x62\x65\162\x68\x61\x73\x69\154"]); goto Q8aKa; jJu8K: WjldX: goto uZJTL; Q8aKa: S09da: goto otr36; Kt3ac: WP0N3: goto Rgjd3; HFd9Z: if (count($messages) > 0) { goto WP0N3; } goto vT9fy; VnVmU: $id = $this->input->post("\x69\x64\137\153\x65\154"); goto d_g2l; Rgjd3: $this->output_json(["\163\164\x61\x74\165\x73" => false, "\x6d\x65\x73\163\x61\147\x65" => "\x4b\x65\154\157\155\x70\x6f\153\x20\115\x61\x70\145\154\40\x64\x69\147\165\156\141\x6b\x61\156\40\144\x69\x20" . count($messages) . "\40\164\x61\142\145\x6c\72\x3c\x62\x72\76" . implode("\x3c\142\x72\x3e", $messages)]); goto H8oTg; H8oTg: elRzL: goto XA0GJ; K7t9f: $messages = []; goto J5ZXV; g6YoU: DIOYS: goto HFd9Z; vT9fy: if (!$this->master->delete("\155\x61\163\164\x65\162\137\x6b\x65\x6c\157\155\x70\x6f\x6b\x5f\x6d\x61\x70\x65\x6c", $id, "\x69\x64\x5f\x6b\x65\154\x5f\x6d\141\160\145\x6c")) { goto S09da; } goto yuPOL; mI9t9: if (!($nums > 0)) { goto DIOYS; } goto eqIHO; uZJTL: $this->db->where_in("\151\144\137\x70\x61\162\x65\x6e\164", $id); goto a9M1o; J5ZXV: $this->db->where_in("\x6b\145\x6c\157\x6d\160\x6f\x6b", $kode); goto dTOp0; wfQ2V: if (!($numm > 0)) { goto WjldX; } goto iusEQ; otr36: goto elRzL; goto Kt3ac; U92TU: $id_parent = $this->input->post("\151\x64\137\x70\x61\162\145\156\164"); goto K7t9f; a9M1o: $nums = $this->db->count_all_results("\x6d\141\163\x74\x65\162\137\153\145\154\157\155\x70\157\153\x5f\x6d\x61\x70\145\x6c"); goto mI9t9; iusEQ: array_push($messages, "\115\141\x74\141\x20\120\145\154\x61\152\141\162\141\156"); goto jJu8K; dTOp0: $numm = $this->db->count_all_results("\x6d\x61\163\164\145\x72\137\x6d\x61\160\x65\154"); goto wfQ2V; d_g2l: $kode = $this->input->post("\x6b\157\x64\x65"); goto U92TU; eqIHO: array_push($messages, "\123\165\x62\x20\x4b\x65\154\x6f\155\160\157\153"); goto g6YoU; XA0GJ: } public function create() { goto CoM5C; U5pbY: $insert = ["\x6e\141\155\141\x5f\155\x61\160\145\154" => $this->input->post("\x6e\x61\x6d\x61\x5f\x6d\x61\160\145\x6c", true), "\x6b\157\x64\x65" => $this->input->post("\x6b\157\144\145\137\x6d\x61\160\145\154", true), "\x6b\145\x6c\x6f\155\x70\157\153" => $this->input->post("\x6b\145\x6c\x6f\155\160\157\153", true), "\165\162\x75\164\x61\x6e\137\164\x61\155\x70\x69\x6c" => $this->input->post("\165\x72\x75\x74\x61\x6e\137\x74\x61\155\160\x69\x6c", true), "\x6a\x65\156\x6a\x61\156\x67" => $setting->jenjang]; goto K6mI5; K0_qw: $this->output->set_content_type("\141\x70\160\154\x69\143\141\x74\151\x6f\x6e\57\x6a\163\157\x6e")->set_output($data); goto dhv4L; K6mI5: $data = $this->master->create("\155\x61\163\x74\145\x72\137\155\141\x70\145\154", $insert); goto K0_qw; CoM5C: $setting = $this->dashboard->getSetting(); goto U5pbY; dhv4L: } public function getDataKelompok() { goto elEs5; G37g7: $this->db->order_by("\153\157\144\x65\137\153\145\x6c\137\155\x61\160\x65\x6c"); goto e1Ni7; e1Ni7: echo $this->datatables->generate(); goto iKjdd; yH2lV: $this->datatables->where("\x69\x64\137\x70\x61\162\145\156\164", "\60"); goto G37g7; elEs5: $this->datatables->select("\x2a"); goto vgxRI; vgxRI: $this->datatables->from("\155\141\x73\x74\x65\x72\x5f\153\145\x6c\157\155\160\x6f\x6b\x5f\155\x61\x70\145\x6c"); goto yH2lV; iKjdd: } public function getDataSubKelompok() { goto IRqiu; de1YK: $this->datatables->where("\x69\144\x5f\x70\141\x72\145\156\164\40\74\x3e\40\60"); goto Eptjy; PhxER: $this->datatables->from("\155\x61\x73\164\x65\162\x5f\x6b\145\x6c\x6f\155\x70\157\153\x5f\x6d\x61\x70\145\x6c"); goto de1YK; IRqiu: $this->datatables->select("\52"); goto PhxER; XdAlo: echo $this->datatables->generate(); goto T6aqw; Eptjy: $this->db->order_by("\153\x6f\x64\x65\137\153\145\154\x5f\155\x61\x70\145\x6c"); goto XdAlo; T6aqw: } public function read() { goto rXLPW; KVN2I: $this->datatables->select("\151\x64\x5f\155\x61\x70\145\x6c\x2c\40\x75\162\x75\164\141\156\137\x74\141\155\x70\151\154\54\40\156\141\x6d\141\x5f\x6d\x61\x70\x65\x6c\x2c\x20\x6b\x6f\144\145\54\40\153\145\154\157\155\x70\157\x6b\54\x20\x64\145\x6c\145\x74\x61\x62\154\145\x2c\x20\163\164\141\164\x75\163"); goto foAW8; RBTLH: $this->db->order_by("\165\x72\165\164\x61\156\137\x74\x61\155\160\x69\x6c"); goto QXukh; aF6G8: $this->db->order_by("\153\x65\154\157\x6d\x70\157\x6b"); goto RBTLH; foAW8: $this->datatables->from("\155\x61\163\164\x65\x72\137\x6d\141\x70\x65\154"); goto aF6G8; QXukh: echo $this->datatables->generate(); goto jVZ4M; rXLPW: $setting = $this->dashboard->getSetting(); goto KVN2I; jVZ4M: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\x70\160\154\x69\x63\x61\x74\x69\x6f\156\57\152\x73\x6f\x6e")->set_output($data); } public function aktifkan($id) { goto NLNZa; ouHmv: $this->db->where("\151\x64\137\x6d\141\160\x65\x6c", $id); goto twxK2; oMHGk: $this->output_json($update); goto KvYFe; twxK2: $update = $this->db->update("\155\141\163\x74\145\x72\137\155\x61\160\x65\154"); goto oMHGk; NLNZa: $this->db->set("\163\164\141\164\165\163", "\61"); goto ouHmv; KvYFe: } public function delete() { goto IfT69; vI_9D: $this->output_json(["\163\164\x61\x74\165\x73" => true, "\164\x6f\x74\x61\154" => count($chk)]); goto iE0rv; IfT69: $chk = $this->input->post("\143\x68\145\x63\x6b\x65\144", true); goto MMuYR; ZttOE: foreach ($tables as $table) { goto ykAO0; V0KHD: if ($table == "\143\x62\x74\x5f\x73\x6f\x61\x6c") { goto oPDwB; } goto cSwyW; xhdcV: $num = $this->db->count_all_results($table); goto uMb2d; A8a88: HLQ55: goto Mt8uL; ykAO0: if (!($table != "\155\141\163\x74\x65\162\x5f\155\x61\160\x65\x6c")) { goto vCrgL; } goto V0KHD; uMb2d: goto a6Sh5; goto Z_g2D; Z_g2D: oPDwB: goto nj9x1; fo7Rc: array_push($messages, $table); goto A8a88; lZNPq: a6Sh5: goto IJaTz; cSwyW: $this->db->where_in("\151\x64\x5f\x6d\141\160\x65\x6c", $chk); goto xhdcV; IJaTz: if (!($num > 0)) { goto HLQ55; } goto fo7Rc; nj9x1: $this->db->where_in("\x6d\x61\160\145\x6c\x5f\x69\144", $chk); goto TA61l; iwHI6: DKqsI: goto vb6TQ; Mt8uL: vCrgL: goto iwHI6; TA61l: $num = $this->db->count_all_results($table); goto lZNPq; vb6TQ: } goto CZrEV; iE0rv: y1P9m: goto myH6X; ypgnC: goto lnme8; goto DeU3L; kSQ1O: if (!$this->master->delete("\155\141\163\164\145\162\137\x6d\141\160\x65\x6c", $chk, "\151\x64\x5f\x6d\141\160\x65\154")) { goto y1P9m; } goto vI_9D; noTAa: $tables = []; goto SLkHt; SLkHt: $tabless = $this->db->list_tables(); goto WywCf; CZrEV: pKcln: goto FtnCa; MMuYR: if (!$chk) { goto lRb6q; } goto NeR3W; myH6X: goto XFRYd; goto fvmT8; J7_v9: L2XAx: goto ZttOE; NeR3W: $messages = []; goto noTAa; fvmT8: sVqKg: goto yMoYs; FtnCa: if (count($messages) > 0) { goto sVqKg; } goto kSQ1O; UkOBY: $this->output_json(["\163\x74\141\x74\x75\163" => false, "\164\157\x74\x61\154" => "\124\151\144\x61\153\x20\x61\144\141\40\144\141\x74\141\x20\171\141\x6e\147\x20\x64\151\160\151\154\151\x68\x21"]); goto G2eis; G2eis: lnme8: goto upSz4; yMoYs: $this->output_json(["\163\x74\141\x74\x75\x73" => false, "\164\x6f\x74\x61\x6c" => "\115\141\160\145\x6c\x20\x64\x69\x67\x75\156\141\153\141\156\x20\x64\x69\40" . count($messages) . "\x20\x74\x61\x62\x65\x6c\72\x3c\x62\162\x3e" . implode("\x3c\142\x72\x3e", $messages)]); goto BGffn; DeU3L: lRb6q: goto UkOBY; BGffn: XFRYd: goto ypgnC; WywCf: foreach ($tabless as $table) { goto jODHT; AvO3F: foreach ($fields as $field) { goto TYFBs; Kp5H7: a1pOC: goto QRH9L; QRH9L: qyc9l: goto nJfJS; TYFBs: if (!($field->name == "\151\x64\x5f\x6d\141\x70\145\154" || $field->name == "\155\x61\x70\x65\x6c\137\x69\144")) { goto a1pOC; } goto jMhJW; jMhJW: array_push($tables, $table); goto Kp5H7; nJfJS: } goto vULPm; wbhu4: q_Ezc: goto kOyLn; vULPm: PxNAA: goto wbhu4; jODHT: $fields = $this->db->field_data($table); goto AvO3F; kOyLn: } goto J7_v9; upSz4: } public function import($import_data = null) { goto iOz4Y; oZWtZ: $this->load->view("\x5f\164\145\x6d\160\154\x61\x74\x65\163\57\144\x61\163\x68\x62\157\141\162\x64\57\x5f\146\x6f\x6f\164\145\162"); goto u9UL4; UbYut: $data["\151\155\160\x6f\x72\164"] = $import_data; goto AlG2J; TZD7z: $data["\164\160"] = $this->dashboard->getTahun(); goto cOcd7; n8FqX: $this->load->view("\x5f\164\145\x6d\x70\x6c\x61\164\145\163\x2f\x64\x61\163\x68\142\157\x61\x72\x64\57\137\x68\x65\141\144\145\x72", $data); goto g5WFo; iOz4Y: $user = $this->ion_auth->user()->row(); goto yrjMS; Nq1ac: $data["\163\155\164\137\141\143\164\151\166\x65"] = $this->dashboard->getSemesterActive(); goto n8FqX; zWgBO: if (!($import_data != null)) { goto Kckg7; } goto UbYut; g5WFo: $this->load->view("\155\141\x73\164\145\162\x2f\155\141\160\x65\x6c\57\151\155\x70\157\x72\164"); goto oZWtZ; AlG2J: Kckg7: goto TZD7z; tuoS2: $data["\x73\x6d\x74"] = $this->dashboard->getSemester(); goto Nq1ac; cOcd7: $data["\x74\160\137\x61\143\x74\151\166\x65"] = $this->dashboard->getTahunActive(); goto tuoS2; yrjMS: $data = ["\165\163\x65\162" => $user, "\152\165\x64\165\154" => "\x4d\x61\x74\x61\x20\120\145\x6c\141\x6a\141\x72\141\156", "\163\x75\x62\x6a\165\x64\x75\154" => "\x49\x6d\x70\157\x72\164\x20\x4d\141\164\x61\x20\x50\145\154\x61\x6a\x61\x72\x61\156", "\160\x72\157\x66\x69\x6c\x65" => $this->dashboard->getProfileAdmin($user->id), "\x73\145\164\x74\x69\156\147" => $this->dashboard->getSetting()]; goto zWgBO; u9UL4: } public function previewExcel() { goto h2WBK; UUUv6: echo json_encode($data); goto nRsMk; khAGZ: $config["\155\141\170\x5f\163\x69\x7a\145"] = 2048; goto HecDw; HecDw: $config["\x65\156\x63\x72\171\x70\164\x5f\156\141\155\145"] = true; goto E9SXb; rXxcP: die; goto O0nfj; E9SXb: $this->load->library("\x75\x70\x6c\157\141\x64", $config); goto OK1S9; sLE9d: KIvwb: goto ScjJG; TL0Pq: mJ7Vc: goto xmkyX; CVFDc: Qc6kW: goto sLE9d; t5sUx: switch ($ext) { case "\x2e\170\x6c\163\x78": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto KIvwb; case "\x2e\x78\x6c\x73": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto KIvwb; case "\56\x63\x73\x76": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto KIvwb; default: echo "\x75\x6e\153\x6e\157\167\x6e\40\146\x69\x6c\x65\40\x65\170\x74"; die; } goto CVFDc; OK1S9: if (!$this->upload->do_upload("\165\160\x6c\x6f\x61\x64\x5f\146\x69\154\145")) { goto mZqRs; } goto MFSZR; nRsMk: goto RllvZ; goto tmKNw; YCABs: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto K3lWk; SOakI: $i = 1; goto ZUgCV; ikeyS: goto Ai4Yp; goto e5RDJ; K3lWk: $data = []; goto SOakI; mXB9S: echo $error; goto rXxcP; MFSZR: $file = $this->upload->data("\x66\165\x6c\x6c\137\160\141\164\150"); goto bJ6lt; T4J7B: if (!($i < count($sheetData))) { goto RMfkL; } goto XWpp4; ZUgCV: Ai4Yp: goto T4J7B; t9_hY: $config["\x61\x6c\x6c\157\x77\x65\144\x5f\x74\171\x70\x65\x73"] = "\x78\x6c\x73\174\x78\154\163\170\174\143\x73\x76"; goto khAGZ; O0nfj: RllvZ: goto MhgEE; ScjJG: $spreadsheet = $reader->load($file); goto YCABs; t2aYQ: $error = $this->upload->display_errors(); goto mXB9S; XWpp4: if (!($sheetData[$i][1] != null)) { goto vV85T; } goto jfHLF; O31k0: vV85T: goto TL0Pq; X2jLt: unlink($file); goto UUUv6; e5RDJ: RMfkL: goto X2jLt; jfHLF: $data[] = ["\x6e\141\155\141" => $sheetData[$i][1], "\x6b\157\144\145" => $sheetData[$i][2]]; goto O31k0; h2WBK: $config["\x75\x70\x6c\157\141\144\137\160\x61\164\150"] = "\56\x2f\165\160\x6c\157\141\144\163\x2f\151\155\x70\x6f\x72\164\x2f"; goto t9_hY; bJ6lt: $ext = $this->upload->data("\x66\x69\154\x65\x5f\145\x78\x74"); goto t5sUx; xmkyX: $i++; goto ikeyS; tmKNw: mZqRs: goto t2aYQ; MhgEE: } public function previewWord() { goto YgeFP; tJ0b8: $data[] = ["\156\x61\x6d\141" => $cols->item(1)->nodeValue, "\x6b\x6f\144\145" => $cols->item(2)->nodeValue]; goto owwUx; hASA0: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto T4e8s; PZIAG: $file = $this->upload->data("\x66\165\x6c\154\x5f\x70\141\164\x68"); goto lpnUh; PPLkn: if (!$this->upload->do_upload("\x75\x70\154\x6f\141\144\x5f\146\x69\154\145")) { goto uI6Hk; } goto PZIAG; TPu0x: $config["\141\x6c\x6c\x6f\x77\145\x64\x5f\164\x79\160\145\x73"] = "\x64\157\x63\170"; goto E_aYU; xj69G: $this->load->library("\x75\x70\154\x6f\141\144", $config); goto PPLkn; lamtu: uI6Hk: goto TV2d4; P43uv: mdsOx: goto cOQfY; i43eW: echo $error; goto PCumo; YgeFP: $config["\x75\x70\x6c\157\141\x64\x5f\x70\141\x74\x68"] = "\x2e\57\x75\x70\154\x6f\141\144\163\57\x69\155\x70\x6f\162\x74\x2f"; goto TPu0x; P4Fd6: goto azavw; goto P43uv; K3iA9: unlink($file); goto WmxJ0; UN16r: $dom->loadHTML($text); goto Ij_eI; Ij_eI: $data = []; goto KLH4L; cOQfY: echo json_encode($data); goto tsYHS; KLH4L: $dom->preserveWhiteSpace = false; goto QGd7h; E_aYU: $config["\x6d\141\x78\x5f\163\151\172\x65"] = 2048; goto PyjjW; IvOmx: JYo8y: goto Yg8UE; owwUx: tQU3C: goto o10zf; k9r1Z: azavw: goto ulbLx; ulbLx: if (!($i < $rows->count())) { goto mdsOx; } goto s1vew; QGd7h: $tables = $dom->getElementsByTagName("\164\141\142\x6c\x65"); goto CadZr; WmxJ0: $text = file_get_contents("\56\57\x75\160\x6c\x6f\x61\144\163\x2f\164\145\155\x70\57\144\157\x63\x2e\150\x74\155\x6c"); goto MO_07; o10zf: $i++; goto P4Fd6; CadZr: $rows = $tables->item(0)->getElementsByTagName("\x74\162"); goto zelyT; PyjjW: $config["\x65\156\x63\162\171\160\164\137\156\141\155\x65"] = true; goto xj69G; T4e8s: try { $htmlWriter->save("\56\57\x75\160\x6c\157\x61\144\163\57\164\145\155\160\x2f\x64\x6f\x63\x2e\x68\164\x6d\x6c"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto K3iA9; s1vew: $cols = $rows[$i]->getElementsByTagName("\x74\x64"); goto tJ0b8; PCumo: die; goto IvOmx; zelyT: $i = 1; goto k9r1Z; lpnUh: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto hASA0; MO_07: $dom = new DOMDocument(); goto UN16r; TV2d4: $error = $this->upload->display_errors(); goto i43eW; tsYHS: goto JYo8y; goto lamtu; Yg8UE: } public function do_import() { goto RbcSG; R5KUV: foreach ($data as $j) { $mapel[] = ["\156\141\x6d\141\137\155\141\160\145\x6c" => $j->nama, "\153\x6f\144\x65" => $j->kode]; wE2eY: } goto u2Fz_; RbcSG: $data = json_decode($this->input->post("\x6d\141\160\145\x6c", true)); goto dtnSl; aYiar: $save = $this->master->create("\x6d\x61\163\164\x65\162\x5f\155\141\160\x65\154", $mapel, true); goto OQRRj; dtnSl: $mapel = []; goto R5KUV; u2Fz_: KNBbd: goto aYiar; OQRRj: $this->output->set_content_type("\x61\160\160\154\151\x63\141\164\x69\157\x6e\57\152\x73\157\156")->set_output($save); goto dKIKx; dKIKx: } }
