<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\x53\105\120\x41\x54\x48") or exit("\116\x6f\40\x64\151\162\x65\143\x74\40\x73\x63\162\151\160\164\x20\141\x63\x63\x65\x73\163\40\x61\154\154\x6f\167\145\144"); use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; use PhpOffice\PhpSpreadsheet\Writer\Xls; use PhpOffice\PhpSpreadsheet\Writer\Csv; class Datamapel extends CI_Controller { public function __construct() { goto PE4r1; qG_dD: show_error("\x48\141\x6e\x79\141\40\x41\144\155\x69\156\151\x73\164\x72\x61\164\157\162\40\x79\141\156\147\40\144\x69\142\145\162\x69\x20\x68\141\x6b\40\165\x6e\164\165\x6b\40\155\145\156\147\141\153\163\145\x73\x20\x68\x61\x6c\141\x6d\141\x6e\40\x69\156\151\54\40\74\x61\x20\150\162\x65\x66\x3d\42" . base_url("\144\141\x73\x68\x62\157\x61\x72\x64") . "\42\x3e\113\x65\x6d\142\141\154\151\40\153\x65\x20\155\145\x6e\165\x20\141\x77\x61\154\x3c\57\141\x3e", 403, "\x41\153\163\x65\x73\x20\124\145\162\154\141\162\141\x6e\x67"); goto EwvTn; cDQth: $this->load->model("\104\x61\x73\150\142\x6f\141\162\x64\x5f\x6d\x6f\x64\x65\x6c", "\144\x61\x73\x68\142\x6f\x61\162\144"); goto X8X76; im4Lr: $this->load->library(["\x64\x61\x74\x61\164\x61\x62\154\x65\x73", "\146\157\x72\x6d\137\x76\141\154\151\x64\x61\164\x69\157\156"]); goto F05Nh; n0mi_: redirect("\x61\x75\x74\x68"); goto Y0iR_; Y0iR_: duVew: goto dkaX8; dkaX8: $this->load->dbforge(); goto im4Lr; H_zrJ: goto duVew; goto f42IY; EwvTn: Abpxj: goto H_zrJ; X8X76: $this->load->model("\x44\162\x6f\x70\x64\x6f\167\156\137\x6d\157\x64\x65\154", "\144\162\157\160\x64\157\167\156"); goto N5aQF; eGCNz: if ($this->ion_auth->is_admin()) { goto Abpxj; } goto qG_dD; tcHCZ: if (!$this->ion_auth->logged_in()) { goto jT2FB; } goto eGCNz; PE4r1: parent::__construct(); goto tcHCZ; F05Nh: $this->load->model("\115\x61\163\x74\x65\x72\137\x6d\157\x64\x65\154", "\155\141\x73\x74\x65\162"); goto cDQth; f42IY: jT2FB: goto n0mi_; N5aQF: $this->form_validation->set_error_delimiters('', ''); goto D6dCP; D6dCP: } public function output_json($data, $encode = true) { goto Fzs3e; crsPm: $data = json_encode($data); goto DPwJp; Fzs3e: if (!$encode) { goto n0T7S; } goto crsPm; Mx9ho: $this->output->set_content_type("\x61\x70\160\x6c\151\143\141\x74\151\157\x6e\57\x6a\163\157\156")->set_output($data); goto w1wBG; DPwJp: n0T7S: goto Mx9ho; w1wBG: } private function updateUrutanTampil() { goto lChKa; xOsNl: $this->db->update_batch("\155\x61\163\x74\x65\x72\137\155\x61\160\145\154", $insert); goto Qg8og; eQIyp: foreach ($mapels as $mapel) { $insert = ["\151\144\137\155\141\160\145\154" => $mapel->id_mapel, "\x6e\x61\155\141\x5f\155\x61\x70\x65\154" => $mapel->id_mapel, "\x6b\157\x64\x65" => $mapel->id_mapel, "\x6b\x65\x6c\x6f\155\160\x6f\153" => $mapel->id_mapel, "\x62\x6f\142\157\x74\137\160" => $mapel->id_mapel, "\x62\x6f\x62\x6f\164\x5f\153" => $mapel->id_mapel, "\x6a\145\x6e\x6a\141\156\x67" => $mapel->id_mapel, "\x75\x72\165\x74\141\x6e" => $mapel->id_mapel, "\x75\x72\165\164\x61\x6e\137\164\x61\x6d\160\151\154" => $mapel->id_mapel, "\x73\164\141\x74\x75\x73" => $mapel->id_mapel, "\x64\145\154\145\x74\141\142\154\x65" => $mapel->id_mapel]; tveaZ: } goto bGlgf; lChKa: $mapels = $this->db->select("\x2a")->from("\155\x61\x73\x74\145\x72\137\155\141\160\x65\x6c")->get()->result(); goto gmVBC; b3wgS: if (!(count($insert) > 0)) { goto PEt31; } goto xOsNl; gmVBC: $insert = []; goto eQIyp; bGlgf: VNFGe: goto b3wgS; Qg8og: PEt31: goto u5Ctf; u5Ctf: } public function index() { goto Dlrkn; GQwC3: $this->load->view("\x5f\x74\x65\155\x70\154\x61\164\145\163\x2f\x64\141\x73\150\142\x6f\x61\x72\144\x2f\x5f\x68\145\x61\144\x65\x72", $data); goto yQ1K_; BUDyS: mA_2d: goto AlS8k; yQ1K_: $this->load->view("\x6d\141\x73\x74\145\x72\57\155\141\160\x65\154\x2f\144\x61\x74\141"); goto see0E; NyC10: $setting = $this->dashboard->getSetting(); goto LNc5y; f56PD: $data["\x74\160\x5f\x61\143\164\x69\166\x65"] = $this->dashboard->getTahunActive(); goto O2InN; rlRKw: $data["\x74\x70"] = $this->dashboard->getTahun(); goto f56PD; LNc5y: $data = ["\x75\x73\145\x72" => $user, "\152\x75\144\165\x6c" => "\115\141\x74\x61\x20\x50\145\x6c\x61\152\141\x72\141\x6e", "\x73\165\142\152\x75\x64\165\x6c" => "\x44\141\146\164\141\x72\40\115\141\164\141\40\120\145\154\141\152\x61\x72\x61\x6e", "\x70\x72\x6f\x66\151\154\145" => $this->dashboard->getProfileAdmin($user->id), "\163\145\x74\x74\x69\x6e\x67" => $setting]; goto rlRKw; LEjqm: $data["\153\141\x74\145\147\x6f\x72\151"] = ["\x57\x41\112\x49\x42", "\120\x41\111\40\x28\x4b\145\x6d\x65\x6e\x61\x67\51", "\x50\x45\x4d\111\x4e\x41\x54\101\116\x20\x41\x4b\101\104\x45\115\111\x4b", "\x41\x4b\101\104\x45\x4d\111\x4b\40\113\x45\x4a\x55\x52\x55\101\x4e", "\x4c\x49\116\124\101\x53\40\x4d\111\x4e\x41\124", "\115\x55\x4c\x4f\113"]; goto zQWMC; dVhcn: $data["\153\145\x6c\x6f\x6d\160\157\153"] = $this->dropdown->getDataKelompokMapel(); goto tyajF; gkpWI: $this->dbforge->add_column("\x6d\141\163\x74\145\162\137\155\141\160\145\x6c", $fields); goto BUDyS; c_Xe2: $data["\x73\x75\x62\137\x6b\145\154\157\155\x70\157\x6b\x5f\155\x61\160\x65\x6c"] = $this->master->getDataSubKelompokMapel(); goto dVhcn; zQWMC: $data["\x6b\145\x6c\157\x6d\160\x6f\x6b\x5f\155\141\160\145\154"] = $this->master->getDataKelompokMapel(); goto c_Xe2; O2InN: $data["\x73\x6d\164"] = $this->dashboard->getSemester(); goto HxT1b; see0E: $this->load->view("\137\164\145\155\160\154\141\164\145\163\57\x64\141\163\150\142\x6f\x61\162\x64\x2f\x5f\146\157\x6f\x74\x65\x72"); goto tWJ8n; pp8AB: $data["\x6d\141\160\145\154\x5f\156\157\156\x5f\141\153\164\151\146"] = $this->master->getAllMapelNonAktif($setting->jenjang); goto GQwC3; Dlrkn: if ($this->db->field_exists("\x75\x72\165\x74\141\156\137\x74\x61\155\x70\x69\x6c", "\155\141\163\x74\x65\x72\x5f\x6d\141\160\145\154")) { goto mA_2d; } goto faeen; faeen: $fields = array("\x75\x72\x75\164\x61\156\x5f\164\141\155\x70\151\154" => array("\164\171\160\145" => "\151\156\x74\50\63\51", "\x61\x66\x74\x65\162" => "\165\x72\x75\x74\x61\156")); goto gkpWI; HxT1b: $data["\163\x6d\x74\x5f\141\x63\x74\151\166\145"] = $this->dashboard->getSemesterActive(); goto LEjqm; AlS8k: $user = $this->ion_auth->user()->row(); goto NyC10; tyajF: $data["\163\164\x61\164\165\x73"] = ["\116\x6f\156\141\x6b\x74\151\146", "\x41\x6b\164\x69\x66"]; goto pp8AB; tWJ8n: } public function addKelompokMapel() { goto BX34Q; g0EWZ: $data = $this->master->create("\155\x61\x73\164\x65\x72\137\153\x65\154\157\x6d\160\x6f\x6b\x5f\x6d\141\x70\145\154", $insert); goto lQE0d; Bhn6p: $this->output->set_content_type("\x61\160\x70\154\151\143\141\164\151\157\156\x2f\152\163\157\x6e")->set_output($data); goto VyIKt; kRa_j: $data = $this->db->update("\x6d\141\x73\164\x65\x72\137\153\x65\x6c\157\155\x70\x6f\153\137\155\x61\160\145\x6c", $insert); goto C5xsC; WDFeC: $insert = ["\156\141\155\x61\137\x6b\145\x6c\137\155\x61\160\145\x6c" => $this->input->post("\156\141\x6d\141\x5f\153\145\x6c\x5f\155\141\x70\x65\x6c", true), "\153\x6f\144\145\x5f\x6b\x65\x6c\137\155\141\x70\145\154" => $this->input->post("\x6b\157\x64\x65\x5f\153\145\154\137\155\x61\x70\x65\154", true), "\x6b\x61\164\145\147\x6f\x72\151" => $this->input->post("\153\x61\x74\145\147\157\x72\x69", true), "\151\144\137\160\x61\162\145\156\164" => $this->input->post("\x69\144\137\160\141\162\145\156\164", true)]; goto kzMEi; kzMEi: if ($id != null) { goto LYzfn; } goto g0EWZ; C5xsC: p3Fgw: goto Bhn6p; qF9q8: $this->db->where("\151\x64\137\153\x65\154\137\x6d\141\160\x65\154", $id); goto kRa_j; pe9i1: LYzfn: goto qF9q8; BX34Q: $id = $this->input->post("\151\144\x5f\153\145\154\137\x6d\141\160\x65\154"); goto WDFeC; lQE0d: goto p3Fgw; goto pe9i1; VyIKt: } public function hapusKelompok() { goto JrpZw; Zqlk3: goto z9QRQ; goto vG6cX; BqkWc: if (count($messages) > 0) { goto O1RS4; } goto G0xaB; auWDg: if (!($nums > 0)) { goto efmUI; } goto bQ7VY; kAnbm: $messages = []; goto SBt1n; qxCZl: $this->output_json(["\x73\164\x61\x74\x75\163" => false, "\x6d\145\x73\x73\141\x67\x65" => "\x4b\145\x6c\x6f\155\x70\157\x6b\x20\115\141\160\145\154\40\x64\x69\147\165\156\141\153\141\x6e\40\144\x69\40" . count($messages) . "\x20\164\141\142\145\154\72\74\x62\x72\76" . implode("\74\142\162\x3e", $messages)]); goto EZ3AF; h9UjF: if (!($numm > 0)) { goto HX2HX; } goto aUww5; P5F91: $id_parent = $this->input->post("\151\144\137\x70\x61\x72\145\156\x74"); goto kAnbm; N5IKU: L0NmF: goto Zqlk3; L34YQ: HX2HX: goto A3G5U; A3G5U: $this->db->where_in("\151\144\x5f\x70\141\162\145\156\164", $id); goto KlKPB; KlKPB: $nums = $this->db->count_all_results("\x6d\141\163\164\145\162\x5f\x6b\x65\x6c\157\x6d\160\157\153\137\x6d\x61\160\x65\154"); goto auWDg; bQ7VY: array_push($messages, "\123\x75\x62\x20\113\145\x6c\x6f\x6d\x70\157\153"); goto YfaEQ; G0xaB: if (!$this->master->delete("\155\141\163\x74\x65\162\x5f\x6b\x65\154\157\x6d\160\157\153\137\155\141\160\x65\x6c", $id, "\x69\x64\x5f\153\x65\x6c\137\155\141\x70\x65\x6c")) { goto L0NmF; } goto rmxqp; vG6cX: O1RS4: goto qxCZl; rmxqp: $this->output_json(["\x73\x74\141\x74\x75\163" => true, "\x6d\x65\x73\x73\141\x67\x65" => "\142\145\x72\150\141\x73\151\154"]); goto N5IKU; pBaiP: $numm = $this->db->count_all_results("\x6d\x61\163\x74\145\162\x5f\155\x61\x70\145\154"); goto h9UjF; Y5RkD: $kode = $this->input->post("\153\x6f\x64\145"); goto P5F91; aUww5: array_push($messages, "\x4d\x61\x74\141\x20\120\145\x6c\x61\x6a\x61\162\x61\x6e"); goto L34YQ; JrpZw: $id = $this->input->post("\151\x64\137\x6b\145\154"); goto Y5RkD; SBt1n: $this->db->where_in("\153\145\x6c\x6f\155\x70\x6f\153", $kode); goto pBaiP; YfaEQ: efmUI: goto BqkWc; EZ3AF: z9QRQ: goto vUFHu; vUFHu: } public function create() { goto QAwax; QAwax: $setting = $this->dashboard->getSetting(); goto J4C2t; Yy4M5: $data = $this->master->create("\x6d\141\x73\x74\x65\162\137\x6d\141\x70\145\x6c", $insert); goto aA2g8; aA2g8: $this->output->set_content_type("\141\x70\160\154\151\143\141\164\x69\x6f\x6e\x2f\x6a\x73\x6f\156")->set_output($data); goto oiOEm; J4C2t: $insert = ["\x6e\141\155\141\x5f\x6d\141\x70\145\x6c" => $this->input->post("\156\141\155\141\x5f\155\141\160\x65\154", true), "\153\157\144\145" => $this->input->post("\x6b\x6f\144\145\137\x6d\x61\160\145\x6c", true), "\x6b\x65\154\x6f\x6d\x70\157\153" => $this->input->post("\x6b\x65\154\157\155\160\x6f\153", true), "\165\162\165\x74\x61\156\137\x74\141\155\x70\x69\154" => $this->input->post("\x75\x72\x75\164\x61\x6e\137\164\x61\155\160\151\154", true), "\152\x65\156\x6a\141\x6e\147" => $setting->jenjang]; goto Yy4M5; oiOEm: } public function getDataKelompok() { goto FO2P9; KZM52: $this->datatables->from("\155\141\163\164\145\162\137\x6b\x65\x6c\x6f\155\x70\157\x6b\137\155\x61\x70\145\154"); goto Yb9vL; AxIB5: $this->db->order_by("\153\x6f\x64\x65\x5f\x6b\x65\154\x5f\155\x61\x70\145\x6c"); goto biY5w; biY5w: echo $this->datatables->generate(); goto ZWpry; Yb9vL: $this->datatables->where("\x69\x64\137\x70\x61\162\145\156\x74", "\x30"); goto AxIB5; FO2P9: $this->datatables->select("\x2a"); goto KZM52; ZWpry: } public function getDataSubKelompok() { goto Aw52p; XG84H: $this->db->order_by("\153\x6f\144\x65\x5f\153\x65\154\137\x6d\141\160\145\154"); goto CGgKq; yvFpO: $this->datatables->where("\x69\144\137\x70\141\x72\145\156\x74\x20\x3c\76\40\x30"); goto XG84H; CGgKq: echo $this->datatables->generate(); goto BouZO; Aw52p: $this->datatables->select("\x2a"); goto Tzuyn; Tzuyn: $this->datatables->from("\x6d\141\x73\x74\145\x72\137\x6b\145\154\157\x6d\x70\157\153\137\x6d\x61\x70\x65\154"); goto yvFpO; BouZO: } public function read() { goto ygClc; PnIJ0: $this->datatables->select("\151\x64\137\155\x61\160\x65\154\54\x20\165\162\x75\164\141\x6e\137\164\x61\x6d\x70\x69\x6c\54\x20\x6e\141\155\x61\x5f\155\x61\x70\145\154\54\x20\153\157\x64\145\54\x20\153\x65\x6c\x6f\x6d\160\x6f\153\54\40\144\145\154\x65\x74\141\142\154\145\x2c\40\163\x74\x61\164\165\x73"); goto w3dq_; w3dq_: $this->datatables->from("\155\141\x73\164\145\162\137\155\141\160\145\x6c"); goto ogp7B; UCjbL: $this->db->order_by("\x75\162\165\164\141\x6e\x5f\164\x61\x6d\160\151\x6c"); goto dOEu0; ogp7B: $this->db->order_by("\153\x65\x6c\x6f\x6d\x70\x6f\153"); goto UCjbL; ygClc: $setting = $this->dashboard->getSetting(); goto PnIJ0; dOEu0: echo $this->datatables->generate(); goto oLEM1; oLEM1: } public function update() { $data = $this->master->updateMapel(); $this->output->set_content_type("\x61\160\160\154\151\143\141\164\151\x6f\156\57\152\163\157\x6e")->set_output($data); } public function aktifkan($id) { goto rjpUi; Fnbet: $this->db->where("\151\144\137\155\x61\160\x65\154", $id); goto jUXrL; jUXrL: $update = $this->db->update("\155\x61\x73\164\145\162\x5f\x6d\x61\x70\x65\x6c"); goto Mv1i9; Mv1i9: $this->output_json($update); goto H0t3X; rjpUi: $this->db->set("\x73\164\x61\x74\165\x73", "\61"); goto Fnbet; H0t3X: } public function delete() { goto F0ba6; F0ba6: $chk = $this->input->post("\x63\x68\145\x63\x6b\x65\144", true); goto U2OR0; Oxv8X: foreach ($tables as $table) { goto yc0M7; HTadR: cqYma: goto Qd2Vu; ozLWX: if (!($num > 0)) { goto Uutz9; } goto NuMop; NuMop: array_push($messages, $table); goto cBaXC; yc0M7: if (!($table != "\x6d\141\x73\164\145\x72\x5f\155\141\x70\145\x6c")) { goto rAedC; } goto mO_WK; Px47k: goto QDKjt; goto Virda; cBaXC: Uutz9: goto tLm4X; BbBRm: QDKjt: goto ozLWX; G4lWz: $num = $this->db->count_all_results($table); goto BbBRm; LuNaw: $num = $this->db->count_all_results($table); goto Px47k; mO_WK: if ($table == "\143\142\164\137\163\157\x61\154") { goto hXVA2; } goto IhTp8; PSHmV: $this->db->where_in("\x6d\x61\x70\145\x6c\137\151\x64", $chk); goto G4lWz; IhTp8: $this->db->where_in("\151\x64\x5f\x6d\x61\x70\x65\154", $chk); goto LuNaw; Virda: hXVA2: goto PSHmV; tLm4X: rAedC: goto HTadR; Qd2Vu: } goto I2Ypq; ikGS4: $this->output_json(["\163\x74\141\x74\x75\x73" => false, "\x74\x6f\164\141\154" => "\x54\x69\144\x61\153\40\141\x64\x61\40\144\141\x74\x61\x20\x79\x61\156\147\x20\x64\151\x70\151\154\x69\x68\41"]); goto yT46M; zmZ0a: Ig2Ng: goto SFHwD; EOnjZ: if (!$this->master->delete("\x6d\x61\x73\164\x65\x72\x5f\x6d\x61\x70\x65\154", $chk, "\151\x64\x5f\155\141\160\x65\154")) { goto w4eCW; } goto SCWNF; yT46M: heK0C: goto tanMT; DZtrL: if (count($messages) > 0) { goto Ig2Ng; } goto EOnjZ; RPJKV: D_GPK: goto Oxv8X; Rq71I: DX2Wy: goto ikGS4; IamDr: h1NNC: goto DxYdS; jGZsB: w4eCW: goto uZ_4z; DxYdS: goto heK0C; goto Rq71I; SCWNF: $this->output_json(["\163\x74\x61\164\165\x73" => true, "\x74\157\164\141\154" => count($chk)]); goto jGZsB; SFHwD: $this->output_json(["\x73\164\x61\164\165\x73" => false, "\x74\157\164\x61\154" => "\x4d\141\160\x65\x6c\40\x64\151\x67\x75\156\x61\x6b\x61\156\40\144\151\40" . count($messages) . "\x20\164\x61\142\x65\154\x3a\74\142\x72\x3e" . implode("\74\x62\162\x3e", $messages)]); goto IamDr; mtP4k: foreach ($tabless as $table) { goto Noz_5; AUtWc: sR3Eq: goto z2iu6; HC76I: mbgpW: goto AUtWc; QNbXc: foreach ($fields as $field) { goto en0tA; en0tA: if (!($field->name == "\x69\x64\137\155\141\x70\x65\x6c" || $field->name == "\155\141\160\x65\154\x5f\x69\144")) { goto JEUdc; } goto JnkJU; vGSVr: WM_yM: goto rK6j7; JnkJU: array_push($tables, $table); goto uCzKE; uCzKE: JEUdc: goto vGSVr; rK6j7: } goto HC76I; Noz_5: $fields = $this->db->field_data($table); goto QNbXc; z2iu6: } goto RPJKV; I2Ypq: WxLQ2: goto DZtrL; JuoAK: $tables = []; goto W42se; uZ_4z: goto h1NNC; goto zmZ0a; U2OR0: if (!$chk) { goto DX2Wy; } goto ist0P; ist0P: $messages = []; goto JuoAK; W42se: $tabless = $this->db->list_tables(); goto mtP4k; tanMT: } public function import($import_data = null) { goto SJIH9; B4Y7D: $this->load->view("\x5f\x74\145\x6d\x70\x6c\141\164\x65\163\x2f\144\141\163\150\142\x6f\x61\x72\x64\x2f\x5f\146\157\x6f\x74\x65\x72"); goto APtQo; aaRXO: $data["\x74\160\x5f\x61\143\x74\x69\x76\145"] = $this->dashboard->getTahunActive(); goto rP1Tw; GQXQZ: $data["\163\155\x74\x5f\141\143\x74\x69\166\145"] = $this->dashboard->getSemesterActive(); goto cfq7A; z1gBA: $this->load->view("\x6d\x61\163\164\145\x72\x2f\155\x61\x70\x65\154\x2f\x69\x6d\160\157\x72\x74"); goto B4Y7D; rP1Tw: $data["\x73\155\164"] = $this->dashboard->getSemester(); goto GQXQZ; UEhO5: if (!($import_data != null)) { goto v_iPn; } goto SLfKx; cfq7A: $this->load->view("\x5f\164\x65\x6d\160\154\141\164\x65\163\x2f\x64\141\x73\x68\x62\157\141\162\x64\x2f\x5f\x68\145\141\x64\145\162", $data); goto z1gBA; dqsVu: v_iPn: goto FZcmh; FZcmh: $data["\164\160"] = $this->dashboard->getTahun(); goto aaRXO; SJIH9: $user = $this->ion_auth->user()->row(); goto EgEt0; SLfKx: $data["\151\x6d\x70\x6f\162\164"] = $import_data; goto dqsVu; EgEt0: $data = ["\165\163\x65\162" => $user, "\x6a\x75\x64\165\154" => "\115\141\164\141\x20\x50\145\x6c\141\152\x61\162\141\156", "\163\x75\x62\x6a\x75\144\x75\154" => "\x49\155\160\157\x72\x74\40\x4d\141\164\141\40\120\x65\x6c\141\152\141\162\141\156", "\160\162\157\x66\151\x6c\145" => $this->dashboard->getProfileAdmin($user->id), "\x73\x65\x74\x74\x69\156\x67" => $this->dashboard->getSetting()]; goto UEhO5; APtQo: } public function previewExcel() { goto qBj5c; vguJJ: unlink($file); goto RaG7h; klNqs: pgmvY: goto NLVA9; dLbOy: if (!($sheetData[$i][1] != null)) { goto JlGea; } goto nyyIe; Kp1xd: $config["\x61\154\x6c\157\x77\145\x64\137\164\171\x70\x65\163"] = "\170\154\x73\x7c\170\x6c\x73\x78\174\143\x73\x76"; goto gTMWN; Ch693: echo $error; goto ySKPd; HZAHE: Skxtl: goto vguJJ; jWmg7: $this->load->library("\165\160\x6c\x6f\x61\144", $config); goto R52wh; SIRzT: $i = 1; goto eG44K; FE2pS: $file = $this->upload->data("\x66\165\154\x6c\x5f\x70\141\x74\x68"); goto MCGVk; bEgAJ: QBAK9: goto TRAlZ; muRG0: Ylrq2: goto AMWGE; AMWGE: $error = $this->upload->display_errors(); goto Ch693; ySKPd: die; goto bEgAJ; GZpX4: goto QBAK9; goto muRG0; RaG7h: echo json_encode($data); goto GZpX4; nyyIe: $data[] = ["\x6e\x61\x6d\x61" => $sheetData[$i][1], "\x6b\157\x64\x65" => $sheetData[$i][2]]; goto N7xNS; R52wh: if (!$this->upload->do_upload("\165\160\x6c\x6f\141\144\137\146\x69\154\x65")) { goto Ylrq2; } goto FE2pS; M_8BA: if (!($i < count($sheetData))) { goto Skxtl; } goto dLbOy; zNgx1: switch ($ext) { case "\x2e\170\154\163\x78": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xlsx(); goto z0HfU; case "\x2e\x78\x6c\x73": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Xls(); goto z0HfU; case "\56\143\x73\166": $reader = new \PhpOffice\PhpSpreadsheet\Reader\Csv(); goto z0HfU; default: echo "\165\156\153\156\157\167\x6e\x20\146\151\x6c\145\40\x65\x78\164"; die; } goto j4qoW; eG44K: nYZMR: goto M_8BA; LGQiC: $data = []; goto SIRzT; BMKHH: z0HfU: goto b2WJM; fy5dk: $config["\145\x6e\143\x72\171\160\x74\137\156\141\x6d\x65"] = true; goto jWmg7; F7tPa: goto nYZMR; goto HZAHE; b2WJM: $spreadsheet = $reader->load($file); goto TJJ7N; TJJ7N: $sheetData = $spreadsheet->getActiveSheet()->toArray(); goto LGQiC; qBj5c: $config["\x75\x70\154\x6f\x61\x64\137\160\x61\x74\x68"] = "\56\x2f\165\160\x6c\157\x61\x64\x73\x2f\151\155\160\x6f\162\x74\57"; goto Kp1xd; j4qoW: V01lu: goto BMKHH; N7xNS: JlGea: goto klNqs; gTMWN: $config["\155\141\170\137\163\151\172\x65"] = 2048; goto fy5dk; MCGVk: $ext = $this->upload->data("\146\x69\154\x65\137\145\170\x74"); goto zNgx1; NLVA9: $i++; goto F7tPa; TRAlZ: } public function previewWord() { goto lQy1T; ou8Ge: $cols = $rows[$i]->getElementsByTagName("\x74\144"); goto KOrmf; aHmrW: TXd4B: goto CvXW9; ijReh: goto TXd4B; goto dKurL; MfJdz: iCss5: goto nyFQn; ke0SU: unlink($file); goto AzEI9; hSLXt: $dom->preserveWhiteSpace = false; goto YMlHt; Cr4TB: oHYLN: goto fzS0M; KOrmf: $data[] = ["\156\x61\155\141" => $cols->item(1)->nodeValue, "\153\157\x64\145" => $cols->item(2)->nodeValue]; goto Cr4TB; cummZ: $config["\x65\x6e\143\162\x79\160\164\137\x6e\141\155\x65"] = true; goto I7GuT; lQy1T: $config["\165\160\x6c\x6f\x61\x64\x5f\160\x61\x74\x68"] = "\56\x2f\165\x70\x6c\157\x61\144\x73\x2f\x69\155\x70\x6f\162\164\x2f"; goto OW4tM; JMG51: $phpWord = \PhpOffice\PhpWord\IOFactory::load($file); goto ZsNZ1; xvRco: ysFbF: goto aqmty; lidpM: try { $htmlWriter->save("\x2e\57\x75\x70\154\157\x61\x64\163\x2f\x74\x65\155\160\57\x64\157\143\56\150\164\x6d\154"); } catch (\PhpOffice\PhpWord\Exception\Exception $e) { } goto ke0SU; dKurL: Tk3wY: goto mGOHc; I7GuT: $this->load->library("\165\160\x6c\157\x61\144", $config); goto aeo2Q; NoR_j: $file = $this->upload->data("\x66\x75\154\154\x5f\160\x61\164\x68"); goto JMG51; aeo2Q: if (!$this->upload->do_upload("\x75\x70\x6c\157\x61\x64\x5f\x66\151\x6c\145")) { goto Tk3wY; } goto NoR_j; fzS0M: $i++; goto yk6t5; AzEI9: $text = file_get_contents("\56\57\x75\160\x6c\x6f\141\x64\163\x2f\164\x65\155\x70\x2f\144\157\143\x2e\x68\164\x6d\154"); goto ovWsk; ZsNZ1: $htmlWriter = new \PhpOffice\PhpWord\Writer\HTML($phpWord); goto lidpM; iCBwE: echo $error; goto Ey561; mGOHc: $error = $this->upload->display_errors(); goto iCBwE; dtEM0: $data = []; goto hSLXt; OW4tM: $config["\x61\x6c\x6c\x6f\167\145\x64\x5f\164\x79\x70\145\163"] = "\144\157\x63\x78"; goto rbODM; BZZSZ: $dom->loadHTML($text); goto dtEM0; rbODM: $config["\x6d\141\x78\137\163\x69\172\145"] = 2048; goto cummZ; yk6t5: goto iCss5; goto xvRco; aqmty: echo json_encode($data); goto ijReh; YMlHt: $tables = $dom->getElementsByTagName("\x74\x61\x62\x6c\145"); goto txwwX; ovWsk: $dom = new DOMDocument(); goto BZZSZ; T0gl1: $i = 1; goto MfJdz; Ey561: die; goto aHmrW; nyFQn: if (!($i < $rows->count())) { goto ysFbF; } goto ou8Ge; txwwX: $rows = $tables->item(0)->getElementsByTagName("\x74\162"); goto T0gl1; CvXW9: } public function do_import() { goto o3xLz; vymkZ: upqFW: goto Z6TaB; loR2a: $mapel = []; goto zy2er; Z6TaB: $save = $this->master->create("\x6d\141\163\x74\x65\162\137\x6d\141\160\145\154", $mapel, true); goto NLqMF; o3xLz: $data = json_decode($this->input->post("\x6d\x61\160\x65\154", true)); goto loR2a; zy2er: foreach ($data as $j) { $mapel[] = ["\156\x61\x6d\141\137\x6d\141\160\145\x6c" => $j->nama, "\153\x6f\144\145" => $j->kode]; ntflx: } goto vymkZ; NLqMF: $this->output->set_content_type("\141\160\160\154\151\x63\x61\x74\x69\x6f\x6e\57\x6a\x73\157\156")->set_output($save); goto NZvjB; NZvjB: } }
