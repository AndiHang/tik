<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto Vq86M; Vq86M: if (defined("\x42\101\123\105\120\101\x54\x48")) { goto VEYjf; } goto hgcu0; JKs2a: VEYjf: goto SnbnQ; hgcu0: exit("\x4e\157\x20\144\x69\162\x65\x63\164\40\x73\143\x72\151\x70\164\40\141\x63\143\145\163\163\x20\141\154\x6c\x6f\167\x65\144"); goto JKs2a; SnbnQ: class Compare extends CI_Controller { function __construct() { goto AU1Im; yoOoG: $this->DB2 = $this->load->database("\154\x69\x76\x65", TRUE); goto lIPpp; AsCAk: $this->CHARACTER_SET = "\165\x74\x66\70\x20\103\117\114\114\x41\x54\105\x20\165\164\146\x38\137\147\145\x6e\x65\162\x61\x6c\137\x63\x69"; goto GAiRn; GAiRn: $this->DB1 = $this->load->database("\155\141\x69\x6e\137\x67\141\x72\x75\x64\141", TRUE); goto yoOoG; AU1Im: parent::__construct(); goto AsCAk; lIPpp: } function index() { goto razq9; tRhg8: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; MEtyB: } goto u_0F7; S9VzE: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto AdpYG; DIYQy: echo "\74\x70\162\145\76\12"; goto Hae1G; jRScH: $tables_to_create = array_diff($development_tables, $live_tables); goto rPhU1; IRjIG: goto ExLs9; goto QyUnw; rPhU1: $tables_to_drop = array_diff($live_tables, $development_tables); goto C36TR; FUDV0: echo "\x3c\150\x32\x3e\x54\150\145\40\144\141\x74\x61\142\141\x73\145\x20\x61\x70\x70\145\141\162\x73\40\164\x6f\x20\x62\x65\40\165\x70\40\x74\157\40\x64\141\164\145\x3c\57\150\x32\76\12"; goto IRjIG; u_0F7: gK99q: goto DIYQy; lVRbF: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto E5mdO; Hae1G: ExLs9: goto kmImZ; E5mdO: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto KqaIy; } goto FUDV0; AdpYG: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto lVRbF; QyUnw: KqaIy: goto k0wb6; b0ErY: $development_tables = $this->DB1->list_tables(); goto jygje; YqZh5: echo "\x3c\x70\x72\145\40\163\164\171\x6c\145\x3d\47\x70\141\x64\144\151\156\147\x3a\40\62\60\160\170\x3b\x20\142\141\x63\x6b\x67\x72\x6f\x75\x6e\144\55\x63\x6f\x6c\157\162\x3a\x20\x23\x46\x46\106\x41\x46\x30\x3b\47\x3e\12"; goto tRhg8; k0wb6: echo "\74\x68\62\x3e\124\150\x65\x20\x64\x61\x74\x61\x62\141\x73\145\x20\x69\163\x20\x6f\165\x74\40\x6f\x66\40\x53\171\x6e\143\41\74\x2f\x68\62\x3e\12"; goto yCugu; jygje: $live_tables = $this->DB2->list_tables(); goto jRScH; C36TR: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\x72\x65\x61\164\x65")) : array(); goto mR42O; razq9: $sql_commands_to_run = array(); goto b0ErY; mR42O: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\x72\157\160")) : array(); goto S9VzE; yCugu: echo "\x3c\160\76\124\x68\145\40\146\x6f\154\x6c\157\167\151\156\147\x20\x53\x51\114\x20\x63\x6f\x6d\155\x61\156\144\x73\40\x6e\x65\145\x64\40\x74\157\x20\142\x65\40\145\170\x65\x63\165\x74\x65\144\40\164\157\x20\x62\x72\x69\x6e\147\x20\x74\x68\145\40\x4c\x69\x76\145\x20\144\x61\164\x61\142\x61\163\145\40\x74\141\x62\x6c\x65\x73\x20\165\160\x20\164\x6f\40\x64\x61\164\x65\x3a\40\x3c\57\x70\x3e\xa"; goto YqZh5; kmImZ: } function manage_tables($tables, $action) { goto arVwi; cPv93: aLbM3: goto JVslv; arVwi: $sql_commands_to_run = array(); goto r8LMx; U5W2a: nsCe3: goto t2aOb; r8LMx: if (!($action == "\x63\x72\145\x61\x74\145")) { goto Wod8T; } goto kygzm; Cu_iS: return $sql_commands_to_run; goto Va3CX; E0dct: if (!($action == "\x64\x72\x6f\x70")) { goto OhdPb; } goto MukKc; JVslv: Wod8T: goto E0dct; t2aOb: OhdPb: goto Cu_iS; MukKc: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\x52\x4f\x50\x20\124\101\x42\114\x45\x20{$table}\x3b"; GfDk_: } goto U5W2a; kygzm: foreach ($tables as $table) { goto aGNjq; h0itZ: $sql_commands_to_run[] = $table_structure["\103\x72\x65\x61\164\145\x20\x54\x61\x62\x6c\145"] . "\73"; goto jGKTn; kHuGk: $table_structure = $query->row_array(); goto h0itZ; jGKTn: gYX96: goto fPu8K; aGNjq: $query = $this->DB1->query("\123\x48\x4f\127\x20\103\x52\x45\x41\124\x45\x20\124\x41\102\x4c\105\40\x60{$table}\x60\40\55\x2d\40\x63\162\145\141\x74\x65\x20\x74\x61\142\154\145\163"); goto kHuGk; fPu8K: } goto cPv93; Va3CX: } function compare_table_structures($development_tables, $live_tables) { goto biY3R; Rt2xR: foreach ($live_tables as $table) { goto JX9PH; cx230: $live_table_structures[$table] = $table_structure["\x43\162\x65\x61\x74\x65\x20\x54\141\x62\154\145"]; goto qycO7; JX9PH: $query = $this->DB2->query("\x53\x48\117\127\x20\103\122\105\101\x54\105\40\124\101\x42\x4c\105\40\x60{$table}\140\40\55\55\40\154\151\x76\145"); goto qfBgU; qfBgU: $table_structure = $query->row_array(); goto cx230; qycO7: dgk2t: goto IBi5K; IBi5K: } goto XbCZn; biY3R: $tables_need_updating = array(); goto yUESU; XbCZn: Z3eAs: goto yU0XS; Qup0h: igAI6: goto pLscA; pLscA: return $tables_need_updating; goto Wohm2; bCaws: zO38d: goto Rt2xR; yU0XS: foreach ($development_tables as $table) { goto byKG1; RzAVI: z5qZt: goto WpsQ5; GUNwR: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto jblaK; WpsQ5: sBTz2: goto NTaBu; jblaK: if (!($this->count_differences($development_table, $live_table) > 0)) { goto z5qZt; } goto o8brK; o8brK: $tables_need_updating[] = $table; goto RzAVI; byKG1: $development_table = $development_table_structures[$table]; goto GUNwR; NTaBu: } goto Qup0h; yUESU: $live_table_structures = $development_table_structures = array(); goto BKf6c; BKf6c: foreach ($development_tables as $table) { goto nz0o_; Xew30: he9vT: goto IF0k3; USe7Q: $development_table_structures[$table] = $table_structure["\x43\x72\x65\x61\x74\x65\40\124\x61\142\x6c\x65"]; goto Xew30; nz0o_: $query = $this->DB1->query("\x53\110\x4f\127\40\x43\x52\105\x41\124\105\40\124\x41\x42\x4c\105\40\140{$table}\x60\x20\55\x2d\40\x64\x65\166"); goto L2ICy; L2ICy: $table_structure = $query->row_array(); goto USe7Q; IF0k3: } goto bCaws; Wohm2: } function count_differences($old, $new) { goto M7ksI; VMtMQ: $old = trim(preg_replace("\x2f\134\163\53\x2f", '', $old)); goto b4dCs; tonNj: return $differences; goto DfV3o; FZZ_U: rPW4q: goto tonNj; Au7PP: $i++; goto tNi9P; AlXr1: NRbaj: goto Au7PP; NdwbD: $length = max(count($old), count($new)); goto qA2rS; SY5e3: $new = explode("\40", $new ?? ''); goto NdwbD; bE8BK: if (!($old == $new)) { goto UZcGn; } goto MdrkH; M7ksI: $differences = 0; goto VMtMQ; GINXR: if (!($old[$i] != $new[$i])) { goto O8ujw; } goto jWnDm; HwyUm: $old = explode("\40", $old ?? ''); goto SY5e3; Tj6Ei: F_RgM: goto C9Cfe; jWnDm: $differences++; goto gBqo4; MdrkH: return $differences; goto iPWb4; iPWb4: UZcGn: goto HwyUm; C9Cfe: if (!($i < $length)) { goto rPW4q; } goto GINXR; tNi9P: goto F_RgM; goto FZZ_U; gBqo4: O8ujw: goto AlXr1; qA2rS: $i = 0; goto Tj6Ei; b4dCs: $new = trim(preg_replace("\57\x5c\x73\53\x2f", '', $new)); goto bE8BK; DfV3o: } function update_existing_tables($tables) { goto m8UDM; Fe6PX: $table_structure_live = array(); goto dPXAA; Dwbeg: d6uA4: goto l6kbz; LLrha: return $sql_commands_to_run; goto msZ1K; j9_Kb: foreach ($tables as $table) { goto ZsQyH; ZsQyH: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto Xe7vY; s636x: vcdHQ: goto UM6Gt; Xe7vY: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto s636x; UM6Gt: } goto uUrX8; uUrX8: RkTA5: goto Dwbeg; iIzmD: $table_structure_development = array(); goto Fe6PX; l6kbz: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto LLrha; dPXAA: if (!(is_array($tables) && !empty($tables))) { goto d6uA4; } goto j9_Kb; m8UDM: $sql_commands_to_run = array(); goto iIzmD; msZ1K: } function table_field_data($database, $table) { goto SO2zx; fRnYu: goto jyyJX; goto pZxml; Z3Uef: $fields[] = $row; goto fRnYu; Opl2w: jyyJX: goto vt72s; SO2zx: $conn = mysqli_connect($database["\x68\157\x73\x74\x6e\141\155\145"], $database["\165\163\x65\x72\x6e\141\155\x65"], $database["\160\141\x73\163\167\157\x72\144"]); goto U45Gw; pZxml: gJoVX: goto GUsEg; vt72s: if (!($row = mysql_fetch_assoc($result))) { goto gJoVX; } goto Z3Uef; GUsEg: return $fields; goto qneZa; y3lhu: $result = mysql_query("\123\110\x4f\127\40\103\117\114\x55\x4d\116\123\40\106\x52\117\115\40\140{$table}\140"); goto Opl2w; U45Gw: mysql_select_db($database["\x64\141\164\141\x62\x61\163\x65"]); goto y3lhu; qneZa: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto ZiMGG; ZiMGG: $sql_commands_to_run = array(); goto wjqaT; Dw78Z: Mz7Dc: goto VQOol; wjqaT: foreach ($source_field_structures as $table => $fields) { goto JowLq; Yun4q: PJkU2: goto sAJEl; hyn7n: nNuYp: goto Yun4q; JowLq: foreach ($fields as $field) { goto GStOi; dSufm: LZIWY: goto OSYiT; krObw: $modify_field .= isset($fields[$n]["\105\x78\164\162\141"]) && $fields[$n]["\105\170\x74\x72\x61"] != '' ? "\40" . $fields[$n]["\x45\x78\x74\162\x61"] : ''; goto QdaEi; dOmzn: $sql_commands_to_run[] = $modify_field; goto a_T0r; HVA6m: goto LZIWY; goto Eqz8b; TQsvt: goto qSeuT; goto NJwRl; bVv_M: if (!(is_array($differences) && !empty($differences))) { goto TCnzR; } goto E14JT; E14JT: $modify_field = "\x41\x4c\x54\x45\122\40\124\101\x42\x4c\105\x20{$table}\40\115\x4f\104\111\x46\x59\40\x43\x4f\114\125\x4d\116\x20\x60" . $fields[$n]["\x46\x69\x65\154\144"] . "\x60\x20" . $fields[$n]["\x54\x79\160\145"] . "\40\x43\110\x41\x52\101\x43\x54\105\122\x20\x53\105\124\40" . $this->CHARACTER_SET; goto n6qXB; xlJ2G: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto oGRKH; } goto dOmzn; AnXpQ: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto bVv_M; WG2E9: $n++; goto HVA6m; JCxdl: qryHe: goto WG2E9; CheFD: $add_field .= "\73"; goto CT0wR; GStOi: if ($this->in_array_recursive($field["\x46\x69\x65\x6c\x64"], $destination_field_structures[$table])) { goto M3_Rl; } goto Sa1Jk; vdS2L: $modify_field .= "\x3b"; goto sLnlv; XHNqF: qSeuT: goto BC72C; n6qXB: $modify_field .= isset($fields[$n]["\104\x65\146\x61\x75\x6c\x74"]) && $fields[$n]["\104\145\x66\x61\x75\x6c\x74"] != '' ? "\40\104\105\x46\x41\125\x4c\x54\40\47" . $fields[$n]["\x44\145\x66\141\165\154\164"] . "\47" : ''; goto pZ0MN; OSYiT: if (!($n < count($fields))) { goto N1v6b; } goto TMSSW; NJwRl: M3_Rl: goto ZqjnI; QdaEi: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\x41\106\x54\105\122\x20" . $previous_field : ''; goto vdS2L; mxgss: $add_field .= isset($field["\116\165\x6c\154"]) && $field["\x4e\x75\154\154"] == "\131\x45\123" ? "\40\x4e\x75\154\x6c" : ''; goto AXS7a; k9Yxj: $add_field .= isset($field["\105\x78\164\x72\x61"]) && $field["\x45\x78\164\162\x61"] != '' ? "\x20" . $field["\x45\170\x74\162\141"] : ''; goto CheFD; ZqjnI: $modify_field = ''; goto dZTu5; dZTu5: $n = 0; goto dSufm; AXS7a: $add_field .= "\40\104\105\106\101\x55\x4c\x54\x20" . $field["\x44\145\146\141\165\x6c\164"]; goto k9Yxj; a_T0r: oGRKH: goto JCxdl; QG8zs: bze_2: goto xlJ2G; Sa1Jk: $add_field = "\101\x4c\124\x45\x52\x20\x54\x41\102\x4c\105\x20{$table}\x20\101\x44\104\x20\103\x4f\114\125\x4d\x4e\x20\x60" . $field["\x46\151\x65\154\x64"] . "\x60\x20" . $field["\124\x79\x70\145"] . "\40\x43\110\101\122\x41\103\124\105\x52\x20\x53\105\124\x20" . $this->CHARACTER_SET; goto mxgss; TMSSW: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\145\154\144"] == $destination_field_structures[$table][$n]["\106\x69\145\x6c\x64"])) { goto bze_2; } goto AnXpQ; pZ0MN: $modify_field .= isset($fields[$n]["\116\165\154\x6c"]) && $fields[$n]["\x4e\165\154\154"] == "\x59\x45\x53" ? "\40\x4e\x55\114\x4c" : "\x20\116\x4f\x54\40\116\x55\x4c\114"; goto krObw; Sz6rU: $previous_field = $fields[$n]["\106\x69\145\154\144"]; goto QG8zs; BC72C: zw2YK: goto ngWJl; CT0wR: $sql_commands_to_run[] = $add_field; goto TQsvt; sLnlv: TCnzR: goto Sz6rU; Eqz8b: N1v6b: goto XHNqF; ngWJl: } goto hyn7n; sAJEl: } goto Dw78Z; VQOol: return $sql_commands_to_run; goto n6MrU; n6MrU: } function in_array_recursive($needle, $haystack, $strict = false) { goto kM8Js; bX11s: Fd34i: goto K9Gzh; K9Gzh: return false; goto kMxCJ; kM8Js: foreach ($haystack as $array => $item) { goto ZCeYm; ZCeYm: $item = $item["\x46\x69\145\154\x64"]; goto N2VBL; N2VBL: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto S6BHG; } goto OdRWi; WdHOB: S6BHG: goto M2zu3; M2zu3: S8NoV: goto J0BgH; OdRWi: return true; goto WdHOB; J0BgH: } goto bX11s; kMxCJ: } }
