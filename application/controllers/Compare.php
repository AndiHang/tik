<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto zRj95; zRj95: if (defined("\102\x41\123\105\x50\x41\124\110")) { goto hqkJf; } goto cq9DI; cq9DI: exit("\x4e\x6f\40\x64\x69\162\145\143\x74\40\163\143\x72\151\160\x74\40\x61\143\x63\145\x73\x73\40\x61\154\154\x6f\167\145\x64"); goto QetBA; QetBA: hqkJf: goto BuAUR; BuAUR: class Compare extends CI_Controller { function __construct() { goto rhd95; pVQlC: $this->DB1 = $this->load->database("\x6d\x61\x69\x6e\137\147\x61\162\x75\x64\141", TRUE); goto k5BjZ; k5BjZ: $this->DB2 = $this->load->database("\x6c\151\x76\145", TRUE); goto eZWlF; rhd95: parent::__construct(); goto GLK00; GLK00: $this->CHARACTER_SET = "\x75\164\x66\70\40\103\x4f\114\x4c\101\x54\105\40\165\x74\146\x38\137\147\x65\x6e\145\162\x61\154\137\x63\x69"; goto pVQlC; eZWlF: } function index() { goto Yo3Sk; jyGMv: pc99O: goto RB3Mt; XccAy: $tables_to_drop = array_diff($live_tables, $development_tables); goto UMwHT; zKYJI: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\162\157\x70")) : array(); goto AgYg1; m1L1E: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto rim2X; } goto iDD4V; m2HW0: rim2X: goto nFQti; UyasL: echo "\74\160\76\124\150\x65\40\146\157\x6c\x6c\x6f\x77\x69\x6e\147\40\123\x51\114\40\143\x6f\x6d\155\141\x6e\144\x73\40\156\x65\x65\x64\x20\x74\157\40\x62\145\x20\145\x78\x65\143\x75\164\145\144\40\164\x6f\40\x62\162\x69\156\147\40\x74\x68\x65\x20\114\x69\x76\145\x20\144\141\164\141\x62\141\163\145\x20\x74\x61\142\154\x65\x73\x20\x75\160\x20\164\x6f\40\144\141\x74\x65\x3a\40\x3c\x2f\x70\76\xa"; goto ga1Z_; AgYg1: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto CU4BX; UMwHT: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\162\x65\141\164\145")) : array(); goto zKYJI; vCajy: $development_tables = $this->DB1->list_tables(); goto R3riX; qaKMB: goto pc99O; goto m2HW0; Yo3Sk: $sql_commands_to_run = array(); goto vCajy; DdWzK: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; tvBbG: } goto SeT1H; b4ZVU: $tables_to_create = array_diff($development_tables, $live_tables); goto XccAy; SeT1H: t8gRZ: goto pMdu3; ga1Z_: echo "\74\160\x72\x65\40\x73\164\x79\x6c\145\75\47\160\x61\x64\144\151\156\x67\x3a\x20\62\60\160\170\73\40\142\141\143\x6b\x67\162\157\165\156\144\55\x63\157\154\x6f\x72\72\40\x23\106\106\x46\101\106\60\x3b\x27\76\12"; goto DdWzK; R3riX: $live_tables = $this->DB2->list_tables(); goto b4ZVU; pMdu3: echo "\74\160\x72\145\x3e\xa"; goto jyGMv; nFQti: echo "\74\x68\x32\76\x54\x68\145\40\144\x61\164\x61\142\141\x73\x65\x20\x69\163\40\157\165\x74\x20\157\146\40\x53\x79\x6e\143\41\74\x2f\150\62\x3e\12"; goto UyasL; cCPlz: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto m1L1E; CU4BX: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto cCPlz; iDD4V: echo "\x3c\x68\x32\x3e\x54\150\145\40\144\x61\x74\x61\x62\141\x73\x65\x20\141\x70\160\x65\x61\x72\x73\x20\164\157\x20\x62\145\40\165\x70\40\164\157\40\144\x61\x74\x65\x3c\57\x68\x32\x3e\12"; goto qaKMB; RB3Mt: } function manage_tables($tables, $action) { goto Kx5ww; B_tOE: q0d1D: goto odK0h; Kx5ww: $sql_commands_to_run = array(); goto hOXuV; L1fN1: return $sql_commands_to_run; goto GE4kY; FwKKE: foreach ($tables as $table) { goto jZ3qv; YjATd: $sql_commands_to_run[] = $table_structure["\103\x72\145\141\x74\145\x20\124\x61\142\x6c\145"] . "\73"; goto teWqS; jZ3qv: $query = $this->DB1->query("\x53\x48\117\x57\x20\103\x52\105\101\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x60{$table}\x60\40\55\55\x20\143\x72\145\141\164\145\x20\x74\x61\x62\x6c\x65\163"); goto qoPhC; qoPhC: $table_structure = $query->row_array(); goto YjATd; teWqS: DmA3l: goto pNAXi; pNAXi: } goto qbsWj; hOXuV: if (!($action == "\x63\162\145\141\x74\145")) { goto q0d1D; } goto FwKKE; R_nd3: MIqbJ: goto aFO52; aFO52: obvj8: goto L1fN1; qbsWj: AldJw: goto B_tOE; odK0h: if (!($action == "\x64\162\x6f\x70")) { goto obvj8; } goto LHxVG; LHxVG: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\122\x4f\120\x20\x54\101\102\x4c\105\40{$table}\x3b"; par8M: } goto R_nd3; GE4kY: } function compare_table_structures($development_tables, $live_tables) { goto Jhj87; mMcGh: return $tables_need_updating; goto DSpyZ; BaL8n: QwSv6: goto mMcGh; GPwky: $live_table_structures = $development_table_structures = array(); goto xAARp; FYkv4: foreach ($live_tables as $table) { goto qPeAP; iI7ZL: ZgBpx: goto khZIH; qPeAP: $query = $this->DB2->query("\123\110\117\x57\x20\x43\122\x45\x41\124\105\40\124\101\x42\x4c\105\x20\x60{$table}\x60\x20\x2d\55\40\x6c\x69\x76\145"); goto Z0dr1; Z0dr1: $table_structure = $query->row_array(); goto fSxsv; fSxsv: $live_table_structures[$table] = $table_structure["\103\x72\145\x61\164\145\40\x54\141\x62\154\145"]; goto iI7ZL; khZIH: } goto p30UX; Jhj87: $tables_need_updating = array(); goto GPwky; weV6T: foreach ($development_tables as $table) { goto SMrS9; mxR5g: $tables_need_updating[] = $table; goto KIdOl; NoClz: hwPk2: goto LbEiP; KIdOl: FGF1c: goto NoClz; SMrS9: $development_table = $development_table_structures[$table]; goto xNdAB; SmnpP: if (!($this->count_differences($development_table, $live_table) > 0)) { goto FGF1c; } goto mxR5g; xNdAB: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto SmnpP; LbEiP: } goto BaL8n; KDIJa: A_KFk: goto FYkv4; xAARp: foreach ($development_tables as $table) { goto fUb0o; fUb0o: $query = $this->DB1->query("\123\x48\117\127\40\103\x52\105\x41\124\105\40\124\x41\102\x4c\x45\x20\140{$table}\x60\40\x2d\x2d\x20\144\x65\x76"); goto Vfe9m; rxQf8: $development_table_structures[$table] = $table_structure["\103\x72\x65\x61\x74\x65\x20\x54\141\142\154\x65"]; goto gsxJb; gsxJb: s8OLk: goto AsHP4; Vfe9m: $table_structure = $query->row_array(); goto rxQf8; AsHP4: } goto KDIJa; p30UX: YOjPY: goto weV6T; DSpyZ: } function count_differences($old, $new) { goto Oq9Fo; cvFgm: $i = 0; goto IZpKx; PxVgB: tzsnU: goto GQv_I; j2pCi: if (!($i < $length)) { goto DPnwo; } goto b2CL9; mow0R: $old = trim(preg_replace("\57\x5c\163\53\x2f", '', $old)); goto Wv99E; Oq9Fo: $differences = 0; goto mow0R; IZpKx: xkW35: goto j2pCi; xc3nh: $old = explode("\40", $old); goto RG76g; ndMHU: goto xkW35; goto bDQ8l; JYD7e: $length = max(count($old), count($new)); goto cvFgm; LEFvr: return $differences; goto Jjhx7; Wv99E: $new = trim(preg_replace("\x2f\x5c\163\53\57", '', $new)); goto RfeHt; Jjhx7: dAgev: goto xc3nh; b2CL9: if (!($old[$i] != $new[$i])) { goto XjTkt; } goto sX2Rv; F6LZe: return $differences; goto epNX8; GQv_I: $i++; goto ndMHU; bDQ8l: DPnwo: goto F6LZe; RG76g: $new = explode("\40", $new); goto JYD7e; RfeHt: if (!($old == $new)) { goto dAgev; } goto LEFvr; sX2Rv: $differences++; goto gbJu9; gbJu9: XjTkt: goto PxVgB; epNX8: } function update_existing_tables($tables) { goto JE6_N; s47Q6: $table_structure_live = array(); goto WGGq1; cDNhU: MFbqY: goto Z3Ln7; HGbKt: uwuhB: goto cDNhU; UvqL2: $table_structure_development = array(); goto s47Q6; EsGWr: return $sql_commands_to_run; goto kWfhy; WGGq1: if (!(is_array($tables) && !empty($tables))) { goto MFbqY; } goto WUAsm; JE6_N: $sql_commands_to_run = array(); goto UvqL2; Z3Ln7: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto EsGWr; WUAsm: foreach ($tables as $table) { goto yUnfs; tgLFy: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto hQ3yo; yUnfs: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto tgLFy; hQ3yo: a0QPr: goto qJzJp; qJzJp: } goto HGbKt; kWfhy: } function table_field_data($database, $table) { goto gtQpE; MDirn: $fields[] = $row; goto iaY5T; GWraN: return $fields; goto my_1e; RT_8I: $result = mysql_query("\x53\110\117\x57\40\103\x4f\114\x55\115\116\x53\x20\x46\122\x4f\115\x20\x60{$table}\x60"); goto K5Fb_; I9kg3: mysql_select_db($database["\x64\141\164\x61\142\141\163\x65"]); goto RT_8I; gtQpE: $conn = mysqli_connect($database["\x68\157\x73\x74\156\x61\x6d\x65"], $database["\165\163\145\x72\x6e\141\155\145"], $database["\160\141\163\x73\167\157\x72\x64"]); goto I9kg3; HJZUX: nHzxy: goto GWraN; nyr8i: if (!($row = mysql_fetch_assoc($result))) { goto nHzxy; } goto MDirn; iaY5T: goto olTSX; goto HJZUX; K5Fb_: olTSX: goto nyr8i; my_1e: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto v8p_Z; v8p_Z: $sql_commands_to_run = array(); goto aCYwK; QbK1m: return $sql_commands_to_run; goto R_bWL; USJ42: ETjdV: goto QbK1m; aCYwK: foreach ($source_field_structures as $table => $fields) { goto g5pkj; r7i5c: ovHND: goto S2bSu; g5pkj: foreach ($fields as $field) { goto M_dRC; k5J9k: goto R_yr3; goto kLf0b; LX6Ru: $add_field .= "\73"; goto iZY57; OSNkX: goto Rq7t_; goto JsCUx; iXbxk: $modify_field .= isset($fields[$n]["\x44\145\146\141\x75\x6c\x74"]) && $fields[$n]["\x44\145\x66\x61\x75\154\164"] != '' ? "\x20\x44\105\106\101\x55\x4c\124\x20\47" . $fields[$n]["\104\145\x66\x61\x75\154\164"] . "\47" : ''; goto Nieqr; c_Bqg: Rq7t_: goto R_yJk; Nieqr: $modify_field .= isset($fields[$n]["\116\x75\x6c\154"]) && $fields[$n]["\116\165\154\154"] == "\x59\x45\123" ? "\x20\x4e\x55\x4c\x4c" : "\x20\116\117\x54\x20\x4e\x55\x4c\x4c"; goto UbE7U; JsCUx: ymW10: goto SFY53; DKaWG: if (!(is_array($differences) && !empty($differences))) { goto X2JVb; } goto eyKx9; a5aDE: $previous_field = $fields[$n]["\106\151\145\x6c\144"]; goto Vvn23; UbE7U: $modify_field .= isset($fields[$n]["\105\170\x74\x72\x61"]) && $fields[$n]["\105\170\x74\x72\141"] != '' ? "\40" . $fields[$n]["\x45\170\x74\162\141"] : ''; goto uMM85; uMM85: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\x41\x46\124\x45\x52\x20" . $previous_field : ''; goto nWnET; xnrD4: X2JVb: goto a5aDE; M_dRC: if ($this->in_array_recursive($field["\106\x69\x65\x6c\x64"], $destination_field_structures[$table])) { goto ymW10; } goto CO6_l; eyKx9: $modify_field = "\x41\x4c\x54\x45\122\40\124\101\x42\114\105\x20{$table}\x20\x4d\117\104\111\106\x59\x20\103\x4f\114\x55\x4d\116\x20\140" . $fields[$n]["\x46\x69\145\x6c\x64"] . "\x60\x20" . $fields[$n]["\x54\x79\x70\145"] . "\40\103\x48\x41\x52\101\103\x54\x45\122\x20\123\105\x54\40" . $this->CHARACTER_SET; goto iXbxk; s7Gj0: $add_field .= isset($field["\x45\170\x74\x72\x61"]) && $field["\105\x78\x74\x72\141"] != '' ? "\x20" . $field["\105\170\x74\162\141"] : ''; goto LX6Ru; nWnET: $modify_field .= "\73"; goto xnrD4; hEjUx: $add_field .= "\40\104\x45\x46\x41\x55\114\124\x20" . $field["\104\145\146\141\165\x6c\x74"]; goto s7Gj0; GcCFJ: $n = 0; goto Vozwe; SiItb: $add_field .= isset($field["\x4e\x75\x6c\x6c"]) && $field["\116\x75\154\x6c"] == "\x59\x45\x53" ? "\40\x4e\165\x6c\x6c" : ''; goto hEjUx; iZY57: $sql_commands_to_run[] = $add_field; goto OSNkX; Vozwe: R_yr3: goto uptyc; RMzqR: $n++; goto k5J9k; uptyc: if (!($n < count($fields))) { goto cbuM9; } goto nHCO0; R_yJk: l8GEg: goto JydiE; HunFp: wu7Jr: goto RMzqR; u43Gh: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto DKaWG; RaOsD: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto olifQ; } goto LatY6; SFY53: $modify_field = ''; goto GcCFJ; kLf0b: cbuM9: goto c_Bqg; w_Suy: olifQ: goto HunFp; nHCO0: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\151\145\154\144"] == $destination_field_structures[$table][$n]["\106\151\x65\x6c\x64"])) { goto HD1r3; } goto u43Gh; Vvn23: HD1r3: goto RaOsD; CO6_l: $add_field = "\101\114\x54\105\122\40\124\101\102\x4c\105\x20{$table}\40\101\104\x44\40\103\117\114\x55\x4d\x4e\40\x60" . $field["\106\151\145\x6c\x64"] . "\x60\x20" . $field["\124\171\160\x65"] . "\x20\103\110\x41\x52\x41\x43\x54\x45\x52\x20\x53\105\124\x20" . $this->CHARACTER_SET; goto SiItb; LatY6: $sql_commands_to_run[] = $modify_field; goto w_Suy; JydiE: } goto dQnvi; dQnvi: xYANA: goto r7i5c; S2bSu: } goto USJ42; R_bWL: } function in_array_recursive($needle, $haystack, $strict = false) { goto p1pA6; p1pA6: foreach ($haystack as $array => $item) { goto arRUb; iSogM: L8r_x: goto i5Tm7; arRUb: $item = $item["\106\151\x65\x6c\144"]; goto biy0x; I0UlM: return true; goto D12IS; D12IS: MiEN7: goto iSogM; biy0x: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto MiEN7; } goto I0UlM; i5Tm7: } goto UMCpq; rH_Ud: return false; goto E_aIQ; UMCpq: Ep063: goto rH_Ud; E_aIQ: } }
