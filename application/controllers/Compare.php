<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto JnrzF; h8Rje: exit("\116\157\40\144\x69\x72\145\143\x74\40\163\143\162\151\x70\164\x20\141\x63\x63\145\163\x73\x20\x61\x6c\x6c\x6f\x77\145\144"); goto q7ien; JnrzF: if (defined("\x42\x41\x53\x45\120\101\x54\110")) { goto FFRBx; } goto h8Rje; q7ien: FFRBx: goto ip8BG; ip8BG: class Compare extends CI_Controller { function __construct() { goto As9jl; xYPdW: $this->DB1 = $this->load->database("\155\141\151\x6e\137\x67\141\x72\x75\x64\141", TRUE); goto lvUNq; XMhvr: $this->CHARACTER_SET = "\x75\x74\146\70\x20\x43\117\114\x4c\x41\x54\105\40\x75\x74\146\x38\x5f\x67\x65\x6e\145\162\x61\x6c\x5f\143\151"; goto xYPdW; lvUNq: $this->DB2 = $this->load->database("\x6c\x69\166\x65", TRUE); goto txtFy; As9jl: parent::__construct(); goto XMhvr; txtFy: } function index() { goto skqJw; qSoj5: echo "\x3c\x70\162\x65\x3e\12"; goto ZDKQA; z62SV: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\x72\x65\x61\x74\145")) : array(); goto iWWJh; a8jVt: $development_tables = $this->DB1->list_tables(); goto Wu5Ko; D1Ojg: UljDM: goto hz5YX; mfwSM: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto UljDM; } goto ozFIP; skqJw: $sql_commands_to_run = array(); goto a8jVt; nE_MB: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto R5l4j; iWWJh: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\x72\x6f\x70")) : array(); goto OE7RZ; vzYDC: $tables_to_create = array_diff($development_tables, $live_tables); goto k4vVa; iULFd: echo "\x3c\160\x3e\x54\x68\145\40\146\157\x6c\154\x6f\x77\151\x6e\147\x20\123\x51\114\x20\x63\x6f\x6d\155\x61\156\144\x73\40\156\145\x65\144\40\164\157\x20\x62\145\40\145\170\145\143\165\x74\145\x64\40\164\x6f\40\x62\162\x69\x6e\x67\40\164\x68\x65\x20\x4c\151\x76\x65\40\144\x61\164\141\x62\141\163\145\40\x74\141\142\x6c\145\x73\x20\x75\160\x20\x74\157\x20\144\x61\164\x65\72\40\74\57\160\76\xa"; goto b5cE3; b5cE3: echo "\74\160\162\145\x20\163\164\171\x6c\x65\x3d\x27\160\141\144\x64\151\x6e\147\x3a\40\x32\60\160\170\73\40\x62\x61\x63\x6b\x67\x72\157\165\x6e\144\55\x63\x6f\x6c\x6f\x72\72\40\x23\106\x46\106\x41\x46\x30\73\x27\x3e\xa"; goto Edp0x; KBe12: lmboM: goto qSoj5; ZDKQA: qO4wN: goto o8PGK; Wu5Ko: $live_tables = $this->DB2->list_tables(); goto vzYDC; ozFIP: echo "\x3c\150\62\x3e\124\150\145\x20\x64\141\x74\x61\x62\x61\x73\x65\40\x61\x70\160\x65\x61\x72\163\x20\164\157\x20\x62\145\x20\165\x70\x20\164\x6f\40\144\141\x74\x65\x3c\57\x68\62\76\12"; goto q0bCs; Edp0x: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; rxrC7: } goto KBe12; R5l4j: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto mfwSM; k4vVa: $tables_to_drop = array_diff($live_tables, $development_tables); goto z62SV; OE7RZ: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto nE_MB; hz5YX: echo "\74\150\x32\76\x54\x68\x65\40\x64\141\x74\x61\142\x61\163\x65\40\151\163\40\x6f\x75\x74\x20\157\x66\40\123\171\x6e\x63\x21\x3c\x2f\150\x32\76\12"; goto iULFd; q0bCs: goto qO4wN; goto D1Ojg; o8PGK: } function manage_tables($tables, $action) { goto X9geN; QFaab: sbkfi: goto BzbxB; GT2X1: apSzB: goto QFaab; BzbxB: if (!($action == "\144\x72\157\x70")) { goto Dmi4n; } goto IvYoC; A3Pmr: Dmi4n: goto bjQUX; C6UmU: v7AYW: goto A3Pmr; MNgV3: if (!($action == "\143\162\145\x61\164\x65")) { goto sbkfi; } goto lHShU; lHShU: foreach ($tables as $table) { goto X3mnZ; X3mnZ: $query = $this->DB1->query("\x53\110\x4f\x57\40\103\x52\105\101\124\x45\40\124\x41\102\x4c\x45\x20\x60{$table}\140\40\x2d\x2d\40\x63\162\145\x61\x74\145\40\x74\141\142\x6c\145\x73"); goto rSTrs; RM8mj: $sql_commands_to_run[] = $table_structure["\x43\162\145\141\164\145\x20\124\x61\142\154\x65"] . "\73"; goto RlfRH; RlfRH: kg5YZ: goto iZPqO; rSTrs: $table_structure = $query->row_array(); goto RM8mj; iZPqO: } goto GT2X1; X9geN: $sql_commands_to_run = array(); goto MNgV3; IvYoC: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\x52\117\x50\40\124\101\x42\x4c\105\40{$table}\x3b"; BQ1bz: } goto C6UmU; bjQUX: return $sql_commands_to_run; goto iqMie; iqMie: } function compare_table_structures($development_tables, $live_tables) { goto Nl1t_; CGarD: nKCER: goto DNqV0; JJ7zz: return $tables_need_updating; goto cZtIi; Shq_E: foreach ($development_tables as $table) { goto cUHoJ; S92JC: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto zustj; BiOLi: SPATc: goto AZlNz; zustj: if (!($this->count_differences($development_table, $live_table) > 0)) { goto SPATc; } goto bdacr; cUHoJ: $development_table = $development_table_structures[$table]; goto S92JC; bdacr: $tables_need_updating[] = $table; goto BiOLi; AZlNz: GD3Jd: goto FpqVJ; FpqVJ: } goto JRAwH; aGja0: $live_table_structures = $development_table_structures = array(); goto Hy5nJ; Nl1t_: $tables_need_updating = array(); goto aGja0; Hy5nJ: foreach ($development_tables as $table) { goto GW2UL; GW2UL: $query = $this->DB1->query("\x53\x48\x4f\127\40\103\122\105\101\x54\x45\40\x54\101\102\x4c\x45\40\140{$table}\x60\40\x2d\55\40\x64\145\x76"); goto vw46h; dudEC: bvI9Q: goto ZN2F9; hKEBZ: $development_table_structures[$table] = $table_structure["\x43\x72\x65\141\164\145\40\x54\141\x62\154\145"]; goto dudEC; vw46h: $table_structure = $query->row_array(); goto hKEBZ; ZN2F9: } goto CGarD; DNqV0: foreach ($live_tables as $table) { goto cVEJR; RtTpe: $table_structure = $query->row_array(); goto iyFnh; iyFnh: $live_table_structures[$table] = $table_structure["\x43\x72\145\141\164\145\40\124\x61\x62\154\145"]; goto k7rgK; k7rgK: efv0a: goto u3YVe; cVEJR: $query = $this->DB2->query("\123\x48\117\127\x20\103\x52\105\x41\x54\x45\40\x54\x41\x42\x4c\x45\40\x60{$table}\140\40\55\x2d\x20\154\151\166\x65"); goto RtTpe; u3YVe: } goto NHkhc; JRAwH: Dc9al: goto JJ7zz; NHkhc: mDX7f: goto Shq_E; cZtIi: } function count_differences($old, $new) { goto YyMtw; tv5Mq: $i = 0; goto rihVp; HWyNy: LHyw6: goto decqK; iFUos: $length = max(count($old), count($new)); goto tv5Mq; s23Op: $differences++; goto xBLFT; TPaE4: if (!($i < $length)) { goto WeXgc; } goto g_QNq; YyMtw: $differences = 0; goto RIRfT; Hb8oB: $new = trim(preg_replace("\x2f\134\163\x2b\x2f", '', $new)); goto ofHfq; Unp2q: $new = explode("\x20", $new); goto iFUos; eocm8: return $differences; goto HWyNy; RWK1y: WeXgc: goto XtDqr; lPyS_: goto Ltmzy; goto RWK1y; XtDqr: return $differences; goto EwxHA; g_QNq: if (!($old[$i] != $new[$i])) { goto WGAfd; } goto s23Op; xBLFT: WGAfd: goto RxqNu; decqK: $old = explode("\40", $old); goto Unp2q; VVmRk: $i++; goto lPyS_; RxqNu: Qg833: goto VVmRk; ofHfq: if (!($old == $new)) { goto LHyw6; } goto eocm8; rihVp: Ltmzy: goto TPaE4; RIRfT: $old = trim(preg_replace("\x2f\x5c\x73\53\x2f", '', $old)); goto Hb8oB; EwxHA: } function update_existing_tables($tables) { goto pyT8Z; okM4g: foreach ($tables as $table) { goto FADZc; aVDje: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto LD3sn; LD3sn: YTOcF: goto DVgcZ; FADZc: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto aVDje; DVgcZ: } goto Oo3UA; UM2em: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto fNbkx; xjTmw: $table_structure_development = array(); goto xzBQK; fNbkx: return $sql_commands_to_run; goto KkJhu; HqACh: sh8iu: goto UM2em; Oo3UA: rVxAR: goto HqACh; mVqQi: if (!(is_array($tables) && !empty($tables))) { goto sh8iu; } goto okM4g; xzBQK: $table_structure_live = array(); goto mVqQi; pyT8Z: $sql_commands_to_run = array(); goto xjTmw; KkJhu: } function table_field_data($database, $table) { goto v0lUw; aPTne: if (!($row = mysql_fetch_assoc($result))) { goto JBP2d; } goto gU5lh; WD6y2: mysql_select_db($database["\144\x61\x74\x61\x62\141\x73\145"]); goto jWTKu; ZR73C: h2339: goto aPTne; v0lUw: $conn = mysqli_connect($database["\x68\x6f\163\x74\156\141\x6d\x65"], $database["\165\163\145\x72\156\x61\155\145"], $database["\x70\141\x73\163\167\157\162\x64"]); goto WD6y2; jWTKu: $result = mysql_query("\x53\x48\117\x57\x20\103\117\x4c\125\x4d\116\123\x20\106\x52\x4f\x4d\40\x60{$table}\x60"); goto ZR73C; tsnSQ: JBP2d: goto HxNeI; HxNeI: return $fields; goto CPlTj; hTdQn: goto h2339; goto tsnSQ; gU5lh: $fields[] = $row; goto hTdQn; CPlTj: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto LWIS_; LWIS_: $sql_commands_to_run = array(); goto GW9_t; M6MXs: return $sql_commands_to_run; goto DKW6x; iWz71: eS4A6: goto M6MXs; GW9_t: foreach ($source_field_structures as $table => $fields) { goto ERz6X; JdJjf: Z72XV: goto efCIm; AfP8c: k0cZH: goto JdJjf; ERz6X: foreach ($fields as $field) { goto Js_EV; enb0m: QhUyP: goto hWxRM; x_ZGt: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto kUpUP; Kaegi: $sql_commands_to_run[] = $modify_field; goto i6XC8; Js_EV: if ($this->in_array_recursive($field["\106\151\x65\x6c\x64"], $destination_field_structures[$table])) { goto PzMDH; } goto pks2b; EIqZW: $modify_field .= isset($fields[$n]["\x4e\165\x6c\154"]) && $fields[$n]["\116\165\x6c\154"] == "\131\105\x53" ? "\x20\116\125\x4c\x4c" : "\x20\116\x4f\124\40\116\125\114\x4c"; goto KA6ob; dWLCU: $modify_field .= "\73"; goto tSnYM; zipr4: DSMgb: goto enb0m; ZoPxG: $add_field .= "\73"; goto nLwmL; T8WJQ: $n++; goto f01OH; nLwmL: $sql_commands_to_run[] = $add_field; goto SQrdn; zVFgS: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\x65\x6c\144"] == $destination_field_structures[$table][$n]["\106\151\x65\x6c\144"])) { goto pqov1; } goto x_ZGt; Hin9t: $add_field .= isset($field["\116\165\154\154"]) && $field["\x4e\165\154\154"] == "\131\x45\x53" ? "\x20\116\165\154\x6c" : ''; goto k0i5A; ekSn0: $modify_field = "\101\x4c\124\x45\x52\40\124\x41\x42\x4c\105\40{$table}\x20\115\117\104\111\106\131\x20\x43\x4f\114\125\115\116\40\x60" . $fields[$n]["\106\x69\x65\x6c\x64"] . "\x60\x20" . $fields[$n]["\124\x79\160\145"] . "\x20\x43\110\x41\x52\101\103\124\x45\x52\40\123\105\x54\40" . $this->CHARACTER_SET; goto JX4Qs; JX4Qs: $modify_field .= isset($fields[$n]["\x44\x65\x66\141\165\x6c\x74"]) && $fields[$n]["\x44\x65\146\x61\x75\154\x74"] != '' ? "\x20\x44\x45\106\x41\x55\114\124\x20\x27" . $fields[$n]["\x44\x65\146\141\165\154\x74"] . "\47" : ''; goto EIqZW; M2puC: PzMDH: goto BZR4P; vB65S: tBDA3: goto T8WJQ; jqPcD: $previous_field = $fields[$n]["\106\x69\145\x6c\x64"]; goto WEJwO; zQm8Y: LCwWr: goto bKCEb; k0i5A: $add_field .= "\x20\x44\x45\x46\101\x55\x4c\x54\x20" . $field["\x44\x65\x66\x61\x75\154\x74"]; goto ArDpi; ArDpi: $add_field .= isset($field["\105\x78\x74\162\141"]) && $field["\105\x78\164\162\141"] != '' ? "\40" . $field["\x45\x78\x74\162\141"] : ''; goto ZoPxG; sspml: $n = 0; goto zQm8Y; pks2b: $add_field = "\101\x4c\124\105\x52\40\124\x41\x42\x4c\105\40{$table}\40\101\104\x44\x20\103\x4f\x4c\125\x4d\116\x20\x60" . $field["\106\x69\145\x6c\144"] . "\140\40" . $field["\124\171\x70\x65"] . "\40\103\x48\x41\122\x41\103\x54\105\x52\x20\123\105\x54\40" . $this->CHARACTER_SET; goto Hin9t; i6XC8: M7Dng: goto vB65S; KA6ob: $modify_field .= isset($fields[$n]["\x45\170\x74\x72\141"]) && $fields[$n]["\105\170\164\162\x61"] != '' ? "\x20" . $fields[$n]["\105\x78\x74\162\141"] : ''; goto YUS3q; YUS3q: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\106\124\105\x52\x20" . $previous_field : ''; goto dWLCU; cIjAW: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto M7Dng; } goto Kaegi; tSnYM: Zj0Cq: goto jqPcD; bKCEb: if (!($n < count($fields))) { goto DSMgb; } goto zVFgS; f01OH: goto LCwWr; goto zipr4; BZR4P: $modify_field = ''; goto sspml; WEJwO: pqov1: goto cIjAW; SQrdn: goto QhUyP; goto M2puC; hWxRM: zm490: goto e6xQP; kUpUP: if (!(is_array($differences) && !empty($differences))) { goto Zj0Cq; } goto ekSn0; e6xQP: } goto AfP8c; efCIm: } goto iWz71; DKW6x: } function in_array_recursive($needle, $haystack, $strict = false) { goto D3XOE; D3XOE: foreach ($haystack as $array => $item) { goto uzcXt; ECcUz: return true; goto VnLKN; uzcXt: $item = $item["\x46\x69\145\154\144"]; goto hm0Ql; hm0Ql: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto XAZiU; } goto ECcUz; QTI2J: LEOfI: goto u8Veq; VnLKN: XAZiU: goto QTI2J; u8Veq: } goto WXhpz; B4oY7: return false; goto M1Mg8; WXhpz: tFzgO: goto B4oY7; M1Mg8: } }
