<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto H8wfq; WmA9l: exit("\x4e\157\x20\x64\151\162\x65\x63\164\40\163\143\162\151\160\x74\x20\x61\x63\x63\145\163\163\x20\x61\x6c\154\157\167\145\x64"); goto W_z3T; H8wfq: if (defined("\102\x41\x53\105\120\101\x54\x48")) { goto Bbz3g; } goto WmA9l; W_z3T: Bbz3g: goto xzYPb; xzYPb: class Compare extends CI_Controller { function __construct() { goto jH5Ak; jH5Ak: parent::__construct(); goto ib5Y5; HaNvV: $this->DB2 = $this->load->database("\x6c\151\166\145", TRUE); goto PWIb7; ib5Y5: $this->CHARACTER_SET = "\165\x74\x66\x38\x20\103\117\114\x4c\x41\124\x45\x20\x75\164\x66\70\x5f\147\145\x6e\145\162\x61\154\x5f\x63\x69"; goto low0d; low0d: $this->DB1 = $this->load->database("\155\141\151\156\137\147\141\162\x75\x64\141", TRUE); goto HaNvV; PWIb7: } function index() { goto PD02r; Uo8FZ: OvLHy: goto g5bV9; rRgdT: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\x72\145\141\x74\145")) : array(); goto BXzvK; Bc6h2: echo "\x3c\x68\62\76\x54\x68\x65\x20\144\141\x74\x61\142\x61\x73\x65\40\151\163\x20\x6f\165\164\x20\157\146\40\x53\171\156\143\41\x3c\57\150\x32\76\12"; goto X2GPp; X2GPp: echo "\x3c\x70\76\124\x68\145\40\x66\x6f\154\154\157\x77\151\156\147\x20\x53\x51\x4c\40\x63\157\x6d\x6d\x61\156\144\x73\40\x6e\x65\145\144\x20\164\x6f\x20\142\145\x20\145\x78\x65\143\165\164\145\144\40\164\157\x20\142\162\x69\156\147\40\x74\150\145\x20\x4c\151\x76\x65\x20\x64\141\164\141\x62\141\x73\x65\40\x74\x61\x62\154\145\163\40\x75\160\40\x74\157\40\x64\x61\164\x65\72\40\74\x2f\160\76\12"; goto QzkYH; A27Mn: echo "\74\x70\x72\145\x3e\12"; goto Uo8FZ; Mr6J2: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto N5yYI; qes0g: Hzfbi: goto Bc6h2; XIeal: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto Mr6J2; N5yYI: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto Ha3Lp; dBDWM: $development_tables = $this->DB1->list_tables(); goto LAwvz; lSZtX: $tables_to_drop = array_diff($live_tables, $development_tables); goto rRgdT; QzkYH: echo "\x3c\160\x72\145\x20\163\x74\x79\154\x65\x3d\x27\x70\141\x64\144\151\156\147\x3a\40\x32\x30\x70\170\73\40\142\x61\x63\153\147\x72\x6f\165\156\144\55\x63\x6f\154\157\162\x3a\x20\43\106\x46\x46\x41\106\60\x3b\47\x3e\12"; goto p4a4R; BXzvK: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\x72\x6f\x70")) : array(); goto XIeal; N8sSD: echo "\x3c\150\x32\x3e\x54\x68\145\40\144\141\x74\141\x62\141\x73\145\40\x61\x70\x70\x65\141\x72\163\x20\x74\157\40\142\145\x20\165\160\x20\164\157\40\x64\x61\x74\x65\x3c\x2f\x68\x32\76\12"; goto qtKid; Ha3Lp: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto Hzfbi; } goto N8sSD; LAwvz: $live_tables = $this->DB2->list_tables(); goto QSvti; ZRp_o: Rm1p_: goto A27Mn; p4a4R: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; cu1q1: } goto ZRp_o; qtKid: goto OvLHy; goto qes0g; QSvti: $tables_to_create = array_diff($development_tables, $live_tables); goto lSZtX; PD02r: $sql_commands_to_run = array(); goto dBDWM; g5bV9: } function manage_tables($tables, $action) { goto sX3CM; u4Wu7: if (!($action == "\x64\x72\x6f\x70")) { goto KnWDC; } goto pYk0V; TTREz: aEq3X: goto j7B6y; sX3CM: $sql_commands_to_run = array(); goto suB8S; hK3JL: KnWDC: goto DZGR2; suB8S: if (!($action == "\143\x72\145\141\164\x65")) { goto YpPA2; } goto arInL; LdjiZ: WPfGb: goto hK3JL; DZGR2: return $sql_commands_to_run; goto PVXvI; j7B6y: YpPA2: goto u4Wu7; pYk0V: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\122\117\120\x20\124\x41\x42\x4c\x45\40{$table}\73"; kiAHP: } goto LdjiZ; arInL: foreach ($tables as $table) { goto M6XjD; XHwZC: $sql_commands_to_run[] = $table_structure["\103\x72\x65\141\x74\x65\x20\124\x61\142\x6c\145"] . "\x3b"; goto RbJmi; k_0IV: $table_structure = $query->row_array(); goto XHwZC; RbJmi: pF7Ex: goto kbiTL; M6XjD: $query = $this->DB1->query("\x53\x48\117\127\40\x43\x52\105\x41\x54\105\40\124\101\x42\x4c\x45\40\x60{$table}\140\x20\55\55\40\143\162\145\141\x74\145\40\x74\141\x62\x6c\145\x73"); goto k_0IV; kbiTL: } goto TTREz; PVXvI: } function compare_table_structures($development_tables, $live_tables) { goto fjEPd; dyvb6: return $tables_need_updating; goto sdR0W; a7rqs: foreach ($live_tables as $table) { goto n0410; Oks7e: $live_table_structures[$table] = $table_structure["\x43\x72\x65\141\164\145\x20\124\141\142\154\145"]; goto dB0Oh; n0410: $query = $this->DB2->query("\123\110\117\x57\x20\103\122\105\x41\x54\x45\x20\124\x41\x42\114\105\x20\x60{$table}\x60\x20\55\x2d\40\154\151\x76\x65"); goto Sa7r0; dB0Oh: GhTAi: goto pGZoL; Sa7r0: $table_structure = $query->row_array(); goto Oks7e; pGZoL: } goto YyQj8; gAV3z: foreach ($development_tables as $table) { goto O8pc_; mxLCe: $development_table_structures[$table] = $table_structure["\x43\x72\145\141\x74\145\40\124\141\142\x6c\x65"]; goto GFrrH; O8pc_: $query = $this->DB1->query("\123\x48\x4f\x57\40\103\x52\105\x41\x54\x45\40\124\101\x42\x4c\x45\40\x60{$table}\x60\40\x2d\55\40\x64\145\x76"); goto VKAXj; GFrrH: nAvRH: goto dhblE; VKAXj: $table_structure = $query->row_array(); goto mxLCe; dhblE: } goto YXbdJ; fjEPd: $tables_need_updating = array(); goto Co0JO; Co0JO: $live_table_structures = $development_table_structures = array(); goto gAV3z; YXbdJ: t9wxW: goto a7rqs; YyQj8: pxqTw: goto vSBpX; vSBpX: foreach ($development_tables as $table) { goto twoHm; mI5Jz: $tables_need_updating[] = $table; goto fhgsP; ZI_LX: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto OJxuC; K4rdx: ANmtw: goto xU3u0; OJxuC: if (!($this->count_differences($development_table, $live_table) > 0)) { goto MJ0Uh; } goto mI5Jz; fhgsP: MJ0Uh: goto K4rdx; twoHm: $development_table = $development_table_structures[$table]; goto ZI_LX; xU3u0: } goto rbdRr; rbdRr: iMjb5: goto dyvb6; sdR0W: } function count_differences($old, $new) { goto YUeBv; pA1SM: goto rJDgx; goto TR31l; cR6WR: if (!($i < $length)) { goto kMrWE; } goto UtCrA; xxYXG: $new = trim(preg_replace("\x2f\134\163\x2b\57", '', $new)); goto GgW6V; UtCrA: if (!($old[$i] != $new[$i])) { goto HEBy3; } goto t5FSD; o31Hm: $new = explode("\x20", $new); goto Q2pav; fYC9q: avvLx: goto IK8Ky; TR31l: kMrWE: goto qdEHj; YUeBv: $differences = 0; goto vXGBW; AS8hN: HEBy3: goto fYC9q; lTCSC: $old = explode("\x20", $old); goto o31Hm; gE2KS: ahuUr: goto lTCSC; fSiFK: rJDgx: goto cR6WR; t5FSD: $differences++; goto AS8hN; knzEf: return $differences; goto gE2KS; vXGBW: $old = trim(preg_replace("\x2f\x5c\163\53\x2f", '', $old)); goto xxYXG; qdEHj: return $differences; goto WPdV5; Q2pav: $length = max(count($old), count($new)); goto qx3u8; qx3u8: $i = 0; goto fSiFK; GgW6V: if (!($old == $new)) { goto ahuUr; } goto knzEf; IK8Ky: $i++; goto pA1SM; WPdV5: } function update_existing_tables($tables) { goto sPgsG; c6fwX: tEV0i: goto bCO98; VTQ1g: TgD8I: goto c6fwX; MkPnc: return $sql_commands_to_run; goto Bsv9F; sPgsG: $sql_commands_to_run = array(); goto S6vpn; mu2OB: foreach ($tables as $table) { goto u7yNG; x0mUN: HBWc0: goto kflKq; GtEbm: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto x0mUN; u7yNG: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto GtEbm; kflKq: } goto VTQ1g; bCO98: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto MkPnc; S6vpn: $table_structure_development = array(); goto GviYT; zjnVz: if (!(is_array($tables) && !empty($tables))) { goto tEV0i; } goto mu2OB; GviYT: $table_structure_live = array(); goto zjnVz; Bsv9F: } function table_field_data($database, $table) { goto sbKGH; wG0GI: return $fields; goto dVpGF; sbKGH: $conn = mysqli_connect($database["\x68\157\x73\164\x6e\x61\x6d\x65"], $database["\x75\163\x65\162\x6e\x61\x6d\145"], $database["\x70\141\x73\163\167\157\162\x64"]); goto TJ4Zg; I0Vj_: $result = mysql_query("\x53\110\x4f\x57\40\x43\117\114\x55\115\116\123\40\106\x52\x4f\115\40\140{$table}\x60"); goto wdcNJ; Tid2Y: goto PzA4G; goto abNy0; P3nx0: $fields[] = $row; goto Tid2Y; TJ4Zg: mysql_select_db($database["\x64\141\x74\141\x62\141\163\145"]); goto I0Vj_; abNy0: DP0Jl: goto wG0GI; wdcNJ: PzA4G: goto Fojoz; Fojoz: if (!($row = mysql_fetch_assoc($result))) { goto DP0Jl; } goto P3nx0; dVpGF: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto NpiC4; GG2gF: return $sql_commands_to_run; goto GeuF8; EII17: CVQ9n: goto GG2gF; aH487: foreach ($source_field_structures as $table => $fields) { goto XonYM; XonYM: foreach ($fields as $field) { goto e1ixo; U94v8: $add_field .= isset($field["\116\x75\x6c\x6c"]) && $field["\116\165\154\x6c"] == "\x59\x45\x53" ? "\x20\x4e\x75\x6c\x6c" : ''; goto D1WFN; U6yLN: $modify_field .= isset($fields[$n]["\x44\x65\146\141\165\x6c\x74"]) && $fields[$n]["\104\145\x66\x61\x75\154\164"] != '' ? "\x20\x44\x45\106\101\x55\x4c\x54\40\47" . $fields[$n]["\104\x65\146\141\x75\154\164"] . "\x27" : ''; goto zxSAU; dj1oX: dMQK9: goto Ky4Iq; KZrnp: Y1DRP: goto ZB6L4; DEXOo: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\x69\x65\154\x64"] == $destination_field_structures[$table][$n]["\x46\151\145\x6c\144"])) { goto SMyJZ; } goto FNbMN; vHyCm: $sql_commands_to_run[] = $modify_field; goto ZgggI; FNbMN: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto d9JA4; Zht3B: SMyJZ: goto XjcDj; d9JA4: if (!(is_array($differences) && !empty($differences))) { goto dMQK9; } goto kWZyl; ZgggI: qnnty: goto cdQFS; ZRt06: goto e6SZr; goto KZrnp; jpB1w: $add_field = "\101\114\124\x45\122\40\124\x41\x42\114\x45\40{$table}\40\x41\104\104\40\x43\117\114\125\x4d\x4e\x20\140" . $field["\106\151\x65\x6c\144"] . "\140\x20" . $field["\124\171\160\x65"] . "\x20\x43\110\101\x52\101\x43\124\105\x52\40\x53\105\124\40" . $this->CHARACTER_SET; goto U94v8; ZB6L4: $modify_field = ''; goto mbSuS; t1q0e: $modify_field .= isset($fields[$n]["\x45\x78\x74\x72\141"]) && $fields[$n]["\x45\x78\164\162\141"] != '' ? "\40" . $fields[$n]["\x45\170\x74\162\x61"] : ''; goto RXX_K; c7NW0: $add_field .= isset($field["\105\x78\x74\x72\141"]) && $field["\x45\170\x74\162\x61"] != '' ? "\40" . $field["\x45\170\x74\x72\x61"] : ''; goto zEb35; SSp8n: goto LZFJa; goto iivzH; LIq30: $sql_commands_to_run[] = $add_field; goto ZRt06; Ky4Iq: $previous_field = $fields[$n]["\106\x69\x65\x6c\x64"]; goto Zht3B; nmFtX: e6SZr: goto VU_xE; bWOfZ: if (!($n < count($fields))) { goto y6_jh; } goto DEXOo; iivzH: y6_jh: goto nmFtX; e1ixo: if ($this->in_array_recursive($field["\x46\x69\x65\154\x64"], $destination_field_structures[$table])) { goto Y1DRP; } goto jpB1w; WfJV7: $modify_field .= "\73"; goto dj1oX; zEb35: $add_field .= "\73"; goto LIq30; zxSAU: $modify_field .= isset($fields[$n]["\x4e\165\x6c\154"]) && $fields[$n]["\x4e\x75\x6c\154"] == "\x59\105\123" ? "\40\x4e\125\x4c\x4c" : "\x20\116\117\124\40\x4e\125\114\114"; goto t1q0e; mbSuS: $n = 0; goto jJOy0; RXX_K: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\101\106\x54\x45\122\x20" . $previous_field : ''; goto WfJV7; D1WFN: $add_field .= "\x20\x44\105\x46\101\x55\114\x54\40" . $field["\104\145\146\141\165\154\164"]; goto c7NW0; AdUVq: $n++; goto SSp8n; VU_xE: TH0rf: goto L7pnA; kWZyl: $modify_field = "\x41\x4c\x54\105\x52\40\124\101\x42\x4c\105\40{$table}\40\x4d\117\104\x49\x46\x59\x20\103\x4f\x4c\125\x4d\116\40\140" . $fields[$n]["\x46\x69\145\154\144"] . "\140\40" . $fields[$n]["\x54\171\x70\x65"] . "\x20\x43\110\101\122\x41\x43\124\105\122\40\x53\105\124\40" . $this->CHARACTER_SET; goto U6yLN; XjcDj: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto qnnty; } goto vHyCm; cdQFS: Q3u3q: goto AdUVq; jJOy0: LZFJa: goto bWOfZ; L7pnA: } goto Q7rPG; pvB2V: hIf6S: goto gzxDc; Q7rPG: Eu8oz: goto pvB2V; gzxDc: } goto EII17; NpiC4: $sql_commands_to_run = array(); goto aH487; GeuF8: } function in_array_recursive($needle, $haystack, $strict = false) { goto SKvCi; e3HyH: return false; goto Y9vqy; SKvCi: foreach ($haystack as $array => $item) { goto nl48r; oYqYH: UuB67: goto HR45Q; HR45Q: Wxa01: goto HLSgS; nl48r: $item = $item["\106\151\x65\154\x64"]; goto TryQP; TryQP: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto UuB67; } goto Z_cmd; Z_cmd: return true; goto oYqYH; HLSgS: } goto JQ4Tq; JQ4Tq: eadwQ: goto e3HyH; Y9vqy: } }
