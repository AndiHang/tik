<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto N36jb; N36jb: if (defined("\102\101\x53\105\x50\101\x54\x48")) { goto FdJ83; } goto EDhQH; f5bmQ: FdJ83: goto L1AzJ; EDhQH: exit("\x4e\157\40\x64\151\x72\145\143\164\x20\163\x63\x72\x69\x70\164\40\141\143\x63\145\163\x73\x20\141\x6c\154\x6f\x77\145\x64"); goto f5bmQ; L1AzJ: class Compare extends CI_Controller { function __construct() { goto ADQKs; ADQKs: parent::__construct(); goto KP0Yc; svvkp: $this->DB2 = $this->load->database("\x6c\151\x76\145", TRUE); goto upBep; KP0Yc: $this->CHARACTER_SET = "\165\x74\x66\70\x20\x43\117\x4c\114\x41\124\x45\x20\x75\164\146\70\137\147\x65\x6e\x65\162\141\154\137\x63\x69"; goto LJJ9T; LJJ9T: $this->DB1 = $this->load->database("\155\141\151\156\137\147\141\x72\165\144\141", TRUE); goto svvkp; upBep: } function index() { goto iNAYi; lJfxp: $tables_to_create = array_diff($development_tables, $live_tables); goto YdLMV; g0Dan: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto UnVI1; } goto ah1FT; YdLMV: $tables_to_drop = array_diff($live_tables, $development_tables); goto KK4zs; YPTzo: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto eMY8P; eMY8P: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto g0Dan; pzcgN: $live_tables = $this->DB2->list_tables(); goto lJfxp; cCYzR: UnVI1: goto EOFEx; XC3zs: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\162\157\160")) : array(); goto nMH4i; EOFEx: echo "\x3c\150\x32\76\x54\x68\x65\x20\144\141\164\x61\x62\141\x73\x65\40\x69\x73\40\x6f\x75\164\x20\x6f\146\x20\123\x79\x6e\143\x21\74\x2f\150\x32\76\xa"; goto gjyGs; lFQ15: b8d1k: goto LVDCM; nMH4i: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto YPTzo; pQ2OZ: echo "\x3c\x70\162\x65\40\163\164\171\154\x65\75\x27\160\141\144\144\151\x6e\147\x3a\40\62\x30\x70\170\x3b\x20\x62\x61\143\153\x67\x72\x6f\x75\156\144\55\x63\157\154\x6f\x72\72\x20\43\106\106\x46\x41\106\60\73\x27\76\xa"; goto LpGmJ; KK4zs: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\141\x74\145")) : array(); goto XC3zs; iNAYi: $sql_commands_to_run = array(); goto oCnJ0; ah1FT: echo "\x3c\150\62\x3e\x54\150\x65\40\144\x61\x74\141\142\141\x73\x65\x20\141\x70\160\145\x61\162\x73\40\164\x6f\40\x62\145\x20\165\160\40\x74\157\x20\x64\141\x74\145\74\57\x68\62\76\xa"; goto pqkSH; pqkSH: goto b8d1k; goto cCYzR; CsK8z: echo "\x3c\x70\x72\145\76\12"; goto lFQ15; gjyGs: echo "\x3c\160\x3e\x54\150\145\x20\146\x6f\154\154\157\x77\x69\156\x67\x20\x53\x51\114\x20\143\x6f\x6d\x6d\141\x6e\144\x73\x20\156\x65\x65\x64\x20\x74\x6f\40\142\145\x20\145\170\145\x63\x75\x74\145\x64\40\164\157\40\142\x72\151\x6e\x67\x20\164\x68\x65\x20\x4c\x69\166\145\x20\x64\x61\164\141\142\141\x73\x65\40\164\x61\x62\x6c\145\163\x20\165\160\40\x74\157\40\x64\141\164\x65\72\x20\74\x2f\x70\x3e\xa"; goto pQ2OZ; zyX2Q: Wo3zb: goto CsK8z; LpGmJ: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; BSpin: } goto zyX2Q; oCnJ0: $development_tables = $this->DB1->list_tables(); goto pzcgN; LVDCM: } function manage_tables($tables, $action) { goto dppXM; TgMMF: if (!($action == "\x63\x72\145\x61\164\x65")) { goto PDHvd; } goto CF_xF; unCsf: yRmhP: goto FSegH; CF_xF: foreach ($tables as $table) { goto jMfNW; Ax5hm: $table_structure = $query->row_array(); goto UBDTe; m9pom: ySjrC: goto BqWYP; UBDTe: $sql_commands_to_run[] = $table_structure["\x43\162\x65\x61\164\x65\x20\x54\x61\x62\x6c\x65"] . "\x3b"; goto m9pom; jMfNW: $query = $this->DB1->query("\123\110\117\127\x20\103\x52\x45\101\124\x45\x20\124\x41\102\x4c\x45\40\x60{$table}\x60\x20\55\x2d\40\x63\162\x65\x61\x74\x65\x20\164\141\x62\x6c\x65\x73"); goto Ax5hm; BqWYP: } goto hBrB6; S20hD: return $sql_commands_to_run; goto VUled; FSegH: RErbA: goto S20hD; hGxut: PDHvd: goto qwzrh; dppXM: $sql_commands_to_run = array(); goto TgMMF; qwzrh: if (!($action == "\144\x72\x6f\160")) { goto RErbA; } goto xzvSu; xzvSu: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\122\x4f\x50\40\124\x41\x42\x4c\x45\40{$table}\x3b"; Msw0N: } goto unCsf; hBrB6: oEzIO: goto hGxut; VUled: } function compare_table_structures($development_tables, $live_tables) { goto kmBRn; SeW9M: $live_table_structures = $development_table_structures = array(); goto ecF2x; UDUeu: mrrra: goto PyCNW; kmBRn: $tables_need_updating = array(); goto SeW9M; uIgMF: mQTIh: goto tURzo; ecF2x: foreach ($development_tables as $table) { goto Xee9e; Njmer: $table_structure = $query->row_array(); goto YySo5; p7TaF: gJBRX: goto qn2u9; Xee9e: $query = $this->DB1->query("\123\110\117\127\x20\x43\x52\x45\101\x54\x45\x20\124\101\102\x4c\105\x20\140{$table}\140\x20\x2d\55\x20\x64\145\166"); goto Njmer; YySo5: $development_table_structures[$table] = $table_structure["\x43\x72\x65\x61\x74\x65\40\x54\x61\142\154\145"]; goto p7TaF; qn2u9: } goto uIgMF; PyCNW: return $tables_need_updating; goto CSOB6; E0epW: DL0GB: goto bZgB4; bZgB4: foreach ($development_tables as $table) { goto OVMIk; OVMIk: $development_table = $development_table_structures[$table]; goto vpVQN; LujQk: $tables_need_updating[] = $table; goto pSmzm; H5SA6: ZZm8J: goto D4foC; vpVQN: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto bBLIg; bBLIg: if (!($this->count_differences($development_table, $live_table) > 0)) { goto fubYf; } goto LujQk; pSmzm: fubYf: goto H5SA6; D4foC: } goto UDUeu; tURzo: foreach ($live_tables as $table) { goto C2FKx; s4kai: $live_table_structures[$table] = $table_structure["\103\x72\145\x61\164\x65\x20\x54\x61\x62\154\145"]; goto ZhvKz; ZhvKz: B6_ET: goto iQ9Rm; OwsI3: $table_structure = $query->row_array(); goto s4kai; C2FKx: $query = $this->DB2->query("\123\110\x4f\127\x20\x43\122\x45\x41\x54\x45\40\124\x41\102\x4c\x45\x20\140{$table}\140\x20\x2d\x2d\x20\x6c\x69\x76\145"); goto OwsI3; iQ9Rm: } goto E0epW; CSOB6: } function count_differences($old, $new) { goto KNaLl; WWEov: $old = trim(preg_replace("\x2f\x5c\x73\53\57", '', $old)); goto xqup8; MygL3: $differences++; goto oQsM0; KNaLl: $differences = 0; goto WWEov; oQsM0: lTuVP: goto PZX_F; BV7UE: xmgJv: goto Ku62t; YUxZv: $old = explode("\40", $old); goto QmBEX; Bmst0: x6Ptd: goto YUxZv; FT0J3: $i++; goto JKFx3; PZX_F: teieX: goto FT0J3; JKFx3: goto xmgJv; goto fBT0c; X3qdv: return $differences; goto Bmst0; p8IRB: return $differences; goto n7DFZ; LoyNn: if (!($old == $new)) { goto x6Ptd; } goto X3qdv; R9JpC: $i = 0; goto BV7UE; Iu7tE: $length = max(count($old), count($new)); goto R9JpC; fBT0c: pWqz4: goto p8IRB; xqup8: $new = trim(preg_replace("\57\x5c\x73\x2b\x2f", '', $new)); goto LoyNn; rxU0P: if (!($old[$i] != $new[$i])) { goto lTuVP; } goto MygL3; Ku62t: if (!($i < $length)) { goto pWqz4; } goto rxU0P; QmBEX: $new = explode("\x20", $new); goto Iu7tE; n7DFZ: } function update_existing_tables($tables) { goto E9YM_; TwYgU: $table_structure_live = array(); goto Bn0qd; A4Jnb: $table_structure_development = array(); goto TwYgU; Bn0qd: if (!(is_array($tables) && !empty($tables))) { goto Eeg52; } goto bNiDj; E9YM_: $sql_commands_to_run = array(); goto A4Jnb; bNiDj: foreach ($tables as $table) { goto CI4a2; O13Ci: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto WJDMC; WJDMC: q0KFQ: goto ndG9d; CI4a2: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto O13Ci; ndG9d: } goto WdqZ7; WdqZ7: r8O_Z: goto odzNj; EsObf: return $sql_commands_to_run; goto vabeM; rKbS3: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto EsObf; odzNj: Eeg52: goto rKbS3; vabeM: } function table_field_data($database, $table) { goto vPQH1; kxgKN: rYQZY: goto Zi_2a; bjzBO: mysql_select_db($database["\144\x61\x74\141\x62\x61\x73\145"]); goto rDWmZ; rDWmZ: $result = mysql_query("\123\x48\117\127\40\103\117\x4c\125\x4d\x4e\123\40\106\122\117\115\x20\140{$table}\140"); goto b2HCv; vPQH1: $conn = mysqli_connect($database["\x68\x6f\163\164\x6e\141\x6d\145"], $database["\165\x73\145\x72\156\141\x6d\x65"], $database["\x70\x61\163\x73\167\x6f\162\x64"]); goto bjzBO; yMZKZ: goto ZxduV; goto kxgKN; tW9ci: if (!($row = mysql_fetch_assoc($result))) { goto rYQZY; } goto aP8F2; b2HCv: ZxduV: goto tW9ci; Zi_2a: return $fields; goto MXoNA; aP8F2: $fields[] = $row; goto yMZKZ; MXoNA: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto VXDSN; CjzeI: return $sql_commands_to_run; goto mA2GD; YxH9P: C0rHP: goto CjzeI; VXDSN: $sql_commands_to_run = array(); goto Nuq6Y; Nuq6Y: foreach ($source_field_structures as $table => $fields) { goto MKRJi; kD4Um: S4f0f: goto nTJWU; MKRJi: foreach ($fields as $field) { goto CM3X5; epnE5: $sql_commands_to_run[] = $add_field; goto j3I24; U1gCc: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\x65\154\144"] == $destination_field_structures[$table][$n]["\x46\151\x65\x6c\x64"])) { goto ESI6i; } goto u_oij; AO8EV: $add_field .= "\x3b"; goto epnE5; j3I24: goto H1F9j; goto d4ng2; KnctO: $previous_field = $fields[$n]["\x46\x69\145\x6c\144"]; goto Xzy1_; jkZg2: V9S8p: goto GdW1p; uzRMt: $modify_field .= "\73"; goto MHlAT; HylsS: $modify_field = ''; goto d6hQF; u_oij: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto QN_s1; O5SPg: $modify_field .= isset($fields[$n]["\116\x75\154\x6c"]) && $fields[$n]["\116\x75\154\154"] == "\131\105\x53" ? "\40\116\x55\114\114" : "\40\x4e\x4f\x54\40\116\x55\114\114"; goto h3MQZ; hBwUB: hQcZa: goto Ue2Ee; Xzy1_: ESI6i: goto OeYL9; QN_s1: if (!(is_array($differences) && !empty($differences))) { goto depTv; } goto GwNq9; BwBlX: goto VS46M; goto hBwUB; Ue2Ee: H1F9j: goto P4sKQ; EvyaG: $add_field .= isset($field["\105\170\164\162\141"]) && $field["\105\170\x74\x72\141"] != '' ? "\x20" . $field["\105\x78\164\x72\141"] : ''; goto AO8EV; OeYL9: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto V9S8p; } goto VzSLw; bFn33: $modify_field .= isset($fields[$n]["\x44\145\146\141\165\x6c\x74"]) && $fields[$n]["\x44\x65\146\141\165\x6c\x74"] != '' ? "\40\104\105\x46\101\125\x4c\124\40\47" . $fields[$n]["\104\x65\146\x61\x75\x6c\x74"] . "\x27" : ''; goto O5SPg; h3MQZ: $modify_field .= isset($fields[$n]["\x45\x78\164\162\141"]) && $fields[$n]["\x45\170\x74\162\x61"] != '' ? "\40" . $fields[$n]["\105\x78\x74\x72\x61"] : ''; goto dWiDR; P4sKQ: FrXtB: goto A10Gg; a1wme: $add_field .= "\x20\x44\105\x46\101\125\x4c\x54\40" . $field["\104\145\x66\141\x75\x6c\164"]; goto EvyaG; VzSLw: $sql_commands_to_run[] = $modify_field; goto jkZg2; fYUb4: $add_field = "\x41\x4c\124\105\122\x20\124\101\102\114\105\x20{$table}\40\101\104\104\x20\103\117\x4c\x55\x4d\116\40\x60" . $field["\106\x69\x65\154\144"] . "\140\40" . $field["\124\x79\160\x65"] . "\40\x43\x48\101\x52\x41\103\x54\105\122\40\123\x45\x54\x20" . $this->CHARACTER_SET; goto FMiXG; GdW1p: UQzvA: goto jw3oc; FMiXG: $add_field .= isset($field["\x4e\x75\154\154"]) && $field["\x4e\x75\154\154"] == "\131\x45\123" ? "\40\116\x75\154\154" : ''; goto a1wme; MHlAT: depTv: goto KnctO; BIC17: if (!($n < count($fields))) { goto hQcZa; } goto U1gCc; d6hQF: $n = 0; goto L9e8z; GwNq9: $modify_field = "\x41\114\124\105\x52\x20\x54\101\x42\x4c\x45\40{$table}\x20\x4d\117\104\111\106\131\x20\x43\x4f\x4c\125\x4d\116\40\x60" . $fields[$n]["\x46\x69\x65\x6c\x64"] . "\x60\40" . $fields[$n]["\124\x79\x70\x65"] . "\40\103\x48\101\x52\101\103\x54\105\x52\40\123\105\x54\40" . $this->CHARACTER_SET; goto bFn33; L9e8z: VS46M: goto BIC17; d4ng2: DNVf6: goto HylsS; dWiDR: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\x41\x46\x54\x45\x52\x20" . $previous_field : ''; goto uzRMt; CM3X5: if ($this->in_array_recursive($field["\106\151\x65\154\x64"], $destination_field_structures[$table])) { goto DNVf6; } goto fYUb4; jw3oc: $n++; goto BwBlX; A10Gg: } goto X_njx; X_njx: i0fKI: goto kD4Um; nTJWU: } goto YxH9P; mA2GD: } function in_array_recursive($needle, $haystack, $strict = false) { goto VUHyp; iFzra: return false; goto z2O39; VUHyp: foreach ($haystack as $array => $item) { goto q3tx5; Q8djd: BAqn_: goto S3d4K; izIjm: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto IOrz6; } goto ZKQqo; hN6WL: IOrz6: goto Q8djd; q3tx5: $item = $item["\x46\x69\x65\x6c\x64"]; goto izIjm; ZKQqo: return true; goto hN6WL; S3d4K: } goto kbjbQ; kbjbQ: iTaej: goto iFzra; z2O39: } }
