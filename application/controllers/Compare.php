<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto YV2L6; YV2L6: if (defined("\102\x41\123\x45\x50\101\124\x48")) { goto d2ux7; } goto Dwbio; P1ugr: d2ux7: goto qpp11; Dwbio: exit("\x4e\x6f\40\144\x69\x72\145\x63\x74\x20\163\x63\162\151\x70\x74\40\x61\143\x63\145\163\x73\40\x61\x6c\x6c\x6f\167\145\144"); goto P1ugr; qpp11: class Compare extends CI_Controller { function __construct() { goto jTQqp; v71_k: $this->DB1 = $this->load->database("\x6d\x61\x69\x6e\137\x67\x61\x72\165\x64\x61", TRUE); goto Cc_Y4; jTQqp: parent::__construct(); goto J9hki; Cc_Y4: $this->DB2 = $this->load->database("\154\x69\166\x65", TRUE); goto sgjvT; J9hki: $this->CHARACTER_SET = "\165\x74\x66\x38\40\103\x4f\114\x4c\x41\124\105\40\165\x74\146\x38\x5f\147\145\x6e\145\x72\x61\154\137\143\x69"; goto v71_k; sgjvT: } function index() { goto Es7yL; E5cVk: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\162\x65\x61\164\145")) : array(); goto hMyw3; pRqgc: $tables_to_create = array_diff($development_tables, $live_tables); goto jpcvB; xiInN: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto vDj3R; } goto G0yvi; ibCYL: echo "\74\x70\x3e\124\150\145\40\x66\157\x6c\154\157\167\151\156\x67\40\123\x51\114\x20\x63\x6f\x6d\x6d\x61\x6e\x64\x73\x20\x6e\145\x65\x64\x20\164\157\x20\142\x65\x20\145\170\145\143\x75\x74\145\144\x20\x74\x6f\40\142\162\x69\x6e\147\40\x74\x68\x65\x20\114\151\166\x65\x20\144\x61\164\x61\x62\x61\163\x65\x20\164\x61\x62\x6c\x65\x73\x20\x75\160\40\x74\157\x20\144\141\x74\x65\72\40\74\57\160\x3e\xa"; goto PoGiw; BfapT: Jhmax: goto ljnyk; p54ii: $development_tables = $this->DB1->list_tables(); goto vBwVR; hMyw3: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\x72\x6f\160")) : array(); goto qOn3Z; ljnyk: echo "\74\160\162\145\76\12"; goto Tem_a; vBwVR: $live_tables = $this->DB2->list_tables(); goto pRqgc; Jeyfa: goto eiiaz; goto HpSB7; BzFIL: echo "\x3c\150\x32\x3e\x54\150\145\x20\144\x61\164\141\142\141\163\x65\40\151\163\40\157\x75\164\x20\x6f\146\40\123\x79\156\x63\x21\x3c\x2f\x68\62\x3e\xa"; goto ibCYL; o8CQU: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto xiInN; qOn3Z: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto bVCsV; G0yvi: echo "\74\x68\62\76\x54\150\x65\x20\x64\141\164\x61\x62\141\x73\x65\x20\x61\160\160\145\141\162\163\x20\x74\x6f\40\x62\x65\40\x75\x70\x20\x74\157\40\x64\141\x74\x65\74\x2f\150\x32\x3e\12"; goto Jeyfa; PoGiw: echo "\74\x70\x72\145\x20\x73\164\171\154\x65\x3d\x27\x70\x61\144\x64\x69\x6e\x67\72\x20\62\x30\x70\x78\73\x20\x62\141\143\x6b\x67\162\157\x75\x6e\x64\x2d\143\x6f\154\157\x72\x3a\40\x23\x46\106\106\101\106\x30\73\x27\x3e\12"; goto utJZz; HpSB7: vDj3R: goto BzFIL; Tem_a: eiiaz: goto ChdEX; utJZz: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; PKc1q: } goto BfapT; Es7yL: $sql_commands_to_run = array(); goto p54ii; jpcvB: $tables_to_drop = array_diff($live_tables, $development_tables); goto E5cVk; bVCsV: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto o8CQU; ChdEX: } function manage_tables($tables, $action) { goto Y84Rs; exwxF: if (!($action == "\143\x72\145\x61\164\x65")) { goto qYzQj; } goto MaCqh; AA7q2: j_yX1: goto dNA8b; Y84Rs: $sql_commands_to_run = array(); goto exwxF; CO_DW: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\122\x4f\x50\40\x54\x41\x42\114\x45\x20{$table}\73"; gmNjK: } goto sL1na; BTtun: if (!($action == "\144\162\x6f\x70")) { goto j_yX1; } goto CO_DW; sL1na: h1C9s: goto AA7q2; SuiIv: Mos_t: goto e17fr; MaCqh: foreach ($tables as $table) { goto uSGXE; P3q3g: $sql_commands_to_run[] = $table_structure["\103\162\145\x61\164\x65\40\124\x61\x62\x6c\145"] . "\73"; goto KkflG; IBKqt: $table_structure = $query->row_array(); goto P3q3g; uSGXE: $query = $this->DB1->query("\123\110\117\127\40\x43\122\105\101\124\105\x20\x54\x41\102\114\x45\x20\x60{$table}\x60\40\55\x2d\40\143\162\x65\141\164\145\x20\164\x61\x62\x6c\x65\163"); goto IBKqt; KkflG: doqEK: goto wDnGz; wDnGz: } goto SuiIv; e17fr: qYzQj: goto BTtun; dNA8b: return $sql_commands_to_run; goto hm_z7; hm_z7: } function compare_table_structures($development_tables, $live_tables) { goto u1jd7; p0k0k: foreach ($development_tables as $table) { goto GWfWP; dqoE1: vdflR: goto CSF2V; jfhyp: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto osWpL; osWpL: if (!($this->count_differences($development_table, $live_table) > 0)) { goto qiUs8; } goto vwGsR; c7Qv0: qiUs8: goto dqoE1; GWfWP: $development_table = $development_table_structures[$table]; goto jfhyp; vwGsR: $tables_need_updating[] = $table; goto c7Qv0; CSF2V: } goto qWdu6; qWdu6: NueLw: goto T3c4n; PSbWq: $live_table_structures = $development_table_structures = array(); goto LWSxW; XOQmm: foreach ($live_tables as $table) { goto FLJUZ; FLJUZ: $query = $this->DB2->query("\123\110\117\x57\40\x43\x52\105\x41\x54\x45\40\124\101\102\114\x45\40\x60{$table}\140\x20\55\55\40\x6c\x69\x76\145"); goto oAJZD; oAJZD: $table_structure = $query->row_array(); goto R72ZO; JuYQt: a_7SP: goto oiqOj; R72ZO: $live_table_structures[$table] = $table_structure["\103\162\x65\x61\164\x65\x20\x54\x61\142\154\145"]; goto JuYQt; oiqOj: } goto loBvT; u1jd7: $tables_need_updating = array(); goto PSbWq; Zxi3N: oJIea: goto XOQmm; T3c4n: return $tables_need_updating; goto Z8Pvr; LWSxW: foreach ($development_tables as $table) { goto K_rLg; K_rLg: $query = $this->DB1->query("\123\110\117\x57\40\x43\x52\105\101\124\x45\x20\124\x41\x42\x4c\x45\40\x60{$table}\140\40\55\x2d\40\144\x65\x76"); goto xyf9c; xyf9c: $table_structure = $query->row_array(); goto Lt2Eg; Czr6C: I_wzq: goto fR798; Lt2Eg: $development_table_structures[$table] = $table_structure["\x43\x72\x65\x61\x74\145\40\x54\141\x62\x6c\145"]; goto Czr6C; fR798: } goto Zxi3N; loBvT: AbKAp: goto p0k0k; Z8Pvr: } function count_differences($old, $new) { goto HdFsM; MLFXP: xVAHt: goto oledN; zsfRp: if (!($i < $length)) { goto sKuzw; } goto oj0q4; kgnFM: goto WKLaJ; goto Gcv5F; oAoC_: return $differences; goto ydCdc; wedrX: tPMI7: goto Y7AN3; HdFsM: $differences = 0; goto gBCS2; Af6XF: $new = explode("\40", $new ?? ''); goto ykASv; f24lm: WKLaJ: goto zsfRp; Gcv5F: sKuzw: goto oAoC_; rHMma: $new = trim(preg_replace("\57\134\x73\x2b\x2f", '', $new) ?? ''); goto VVSAs; uDGAg: BLx7u: goto wedrX; Y7AN3: $i++; goto kgnFM; oj0q4: if (!($old[$i] != $new[$i])) { goto BLx7u; } goto Yxzdi; gBCS2: $old = trim(preg_replace("\x2f\134\x73\x2b\57", '', $old) ?? ''); goto rHMma; xxpYg: $i = 0; goto f24lm; VVSAs: if (!($old == $new)) { goto xVAHt; } goto z9n1F; Yxzdi: $differences++; goto uDGAg; oledN: $old = explode("\x20", $old ?? ''); goto Af6XF; ykASv: $length = max(count($old), count($new)); goto xxpYg; z9n1F: return $differences; goto MLFXP; ydCdc: } function update_existing_tables($tables) { goto KdF_y; HJKGs: $table_structure_live = array(); goto mowPk; sjbWb: DNSk7: goto r5U1C; r5U1C: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto S54PN; KdF_y: $sql_commands_to_run = array(); goto LT7ZU; RE4nn: u9dXn: goto sjbWb; eAT8_: foreach ($tables as $table) { goto ivT1H; ivT1H: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto uR8mX; uR8mX: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto LYM7_; LYM7_: b7ItE: goto MENJ2; MENJ2: } goto RE4nn; LT7ZU: $table_structure_development = array(); goto HJKGs; S54PN: return $sql_commands_to_run; goto jcdNB; mowPk: if (!(is_array($tables) && !empty($tables))) { goto DNSk7; } goto eAT8_; jcdNB: } function table_field_data($database, $table) { goto Z012y; Y63D6: goto N3gj8; goto EiTAN; hfCFh: N3gj8: goto UcWF2; Z012y: $conn = mysqli_connect($database["\x68\157\163\164\x6e\x61\x6d\145"], $database["\165\163\145\162\156\x61\x6d\145"], $database["\x70\x61\x73\x73\167\x6f\x72\144"]); goto Fte8o; UcWF2: if (!($row = mysql_fetch_assoc($result))) { goto Ev5Vs; } goto KxgtY; Fte8o: mysql_select_db($database["\144\141\x74\141\142\x61\163\145"]); goto U2dnj; PSE44: return $fields; goto lz7wC; U2dnj: $result = mysql_query("\123\110\117\x57\x20\x43\117\114\125\x4d\116\x53\x20\106\122\x4f\x4d\x20\140{$table}\x60"); goto hfCFh; KxgtY: $fields[] = $row; goto Y63D6; EiTAN: Ev5Vs: goto PSE44; lz7wC: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto wz0oH; wz0oH: $sql_commands_to_run = array(); goto Ig9nB; aeE5H: return $sql_commands_to_run; goto wLUZF; Ig9nB: foreach ($source_field_structures as $table => $fields) { goto O5pxs; O5pxs: foreach ($fields as $field) { goto K8Pch; Cran_: yzNbp: goto aMsDa; xxlCc: $n++; goto VPOdR; QwDAU: $modify_field = ''; goto qxsMm; UJu2J: if (!($n < count($fields))) { goto eDs5c; } goto OLg20; KSSxZ: $add_field = "\x41\x4c\124\x45\122\40\x54\x41\x42\x4c\x45\x20{$table}\40\x41\104\104\40\x43\117\x4c\x55\115\x4e\40\140" . $field["\106\151\145\x6c\144"] . "\140\40" . $field["\x54\x79\x70\x65"] . "\x20\103\x48\x41\x52\101\103\124\105\x52\40\123\x45\124\40" . $this->CHARACTER_SET; goto ZEHiF; q_p_L: $add_field .= "\x3b"; goto C4ycg; Z9nVg: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto kw3BA; hwGnb: $add_field .= isset($field["\105\x78\x74\162\141"]) && $field["\x45\170\164\x72\x61"] != '' ? "\x20" . $field["\105\170\164\162\x61"] : ''; goto q_p_L; XQS1k: goto yzNbp; goto sVLD7; OLg20: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\x65\x6c\144"] == $destination_field_structures[$table][$n]["\x46\x69\x65\154\x64"])) { goto D_rpq; } goto Z9nVg; Z8vaf: wU4LS: goto UJu2J; VPOdR: goto wU4LS; goto b_x_x; lncbc: $modify_field .= isset($fields[$n]["\116\165\154\154"]) && $fields[$n]["\x4e\x75\x6c\x6c"] == "\131\x45\123" ? "\x20\116\125\x4c\x4c" : "\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c"; goto CWm2J; E7eA8: $add_field .= "\x20\104\105\106\x41\x55\114\124\x20" . $field["\x44\145\x66\x61\x75\x6c\x74"]; goto hwGnb; d6co_: LQRQH: goto Gd74N; K8Pch: if ($this->in_array_recursive($field["\x46\x69\145\x6c\x64"], $destination_field_structures[$table])) { goto QzV_Q; } goto KSSxZ; OycEP: $sql_commands_to_run[] = $modify_field; goto A4hD7; ZEHiF: $add_field .= isset($field["\x4e\x75\x6c\x6c"]) && $field["\116\165\x6c\154"] == "\131\x45\123" ? "\x20\x4e\x75\x6c\x6c" : ''; goto E7eA8; CWm2J: $modify_field .= isset($fields[$n]["\105\170\x74\162\141"]) && $fields[$n]["\105\170\x74\x72\x61"] != '' ? "\x20" . $fields[$n]["\105\170\x74\162\141"] : ''; goto Jx2NW; h1NKD: $modify_field = "\x41\x4c\124\105\122\x20\x54\x41\x42\x4c\105\x20{$table}\40\115\117\x44\x49\106\131\40\103\117\114\125\115\x4e\x20\x60" . $fields[$n]["\x46\151\x65\x6c\x64"] . "\140\x20" . $fields[$n]["\124\x79\x70\x65"] . "\x20\x43\110\x41\122\x41\x43\124\105\x52\40\123\x45\x54\40" . $this->CHARACTER_SET; goto RzHx1; A4hD7: RlP68: goto ZzaKB; sVLD7: QzV_Q: goto QwDAU; ZzaKB: XpVfe: goto xxlCc; b_x_x: eDs5c: goto Cran_; kw3BA: if (!(is_array($differences) && !empty($differences))) { goto LQRQH; } goto h1NKD; nPRnl: D_rpq: goto nw0xn; aMsDa: TikJK: goto nqY2v; Gd74N: $previous_field = $fields[$n]["\106\x69\x65\154\x64"]; goto nPRnl; Jx2NW: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\x41\106\x54\105\x52\40" . $previous_field : ''; goto ADbPs; qxsMm: $n = 0; goto Z8vaf; C4ycg: $sql_commands_to_run[] = $add_field; goto XQS1k; ADbPs: $modify_field .= "\73"; goto d6co_; RzHx1: $modify_field .= isset($fields[$n]["\x44\x65\x66\141\x75\154\164"]) && $fields[$n]["\104\x65\146\141\165\x6c\x74"] != '' ? "\x20\x44\105\x46\101\125\x4c\x54\40\47" . $fields[$n]["\104\145\146\141\x75\154\164"] . "\x27" : ''; goto lncbc; nw0xn: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto RlP68; } goto OycEP; nqY2v: } goto PqAQL; PqAQL: rgiYQ: goto xXmgP; xXmgP: Dtk0G: goto m1aWw; m1aWw: } goto hjlEH; hjlEH: hW8d8: goto aeE5H; wLUZF: } function in_array_recursive($needle, $haystack, $strict = false) { goto f9YZK; idLdY: return false; goto ph2OM; f9YZK: foreach ($haystack as $array => $item) { goto lIKzq; akOla: FNn24: goto JLq01; lIKzq: $item = $item["\106\x69\x65\x6c\144"]; goto wOoJX; wOoJX: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto Svu7y; } goto jUIOF; EwZaV: Svu7y: goto akOla; jUIOF: return true; goto EwZaV; JLq01: } goto JMpUx; JMpUx: lDI9O: goto idLdY; ph2OM: } }
