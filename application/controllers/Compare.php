<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto fqsey; uerWS: exit("\116\157\x20\144\151\162\x65\143\164\40\x73\143\162\151\160\x74\x20\x61\x63\143\x65\x73\x73\x20\x61\154\x6c\157\x77\x65\144"); goto wZCXG; fqsey: if (defined("\102\101\x53\105\x50\101\124\110")) { goto T9yZ2; } goto uerWS; wZCXG: T9yZ2: goto hGrme; hGrme: class Compare extends CI_Controller { function __construct() { goto T3eXF; FW7R8: $this->DB2 = $this->load->database("\x6c\151\166\x65", TRUE); goto QMuFG; D32W6: $this->DB1 = $this->load->database("\155\141\151\x6e\137\147\x61\162\165\x64\x61", TRUE); goto FW7R8; T3eXF: parent::__construct(); goto lk_m3; lk_m3: $this->CHARACTER_SET = "\x75\164\x66\x38\x20\x43\117\114\x4c\x41\x54\x45\x20\165\164\146\70\137\x67\x65\x6e\145\x72\x61\154\x5f\x63\151"; goto D32W6; QMuFG: } function index() { goto tNPo0; tNPo0: $sql_commands_to_run = array(); goto ohrh7; RPwPh: echo "\x3c\x70\x72\x65\x20\163\x74\171\154\145\75\47\x70\141\144\x64\x69\x6e\147\x3a\40\62\60\160\x78\x3b\40\142\141\143\153\147\x72\x6f\x75\x6e\144\x2d\143\157\x6c\157\162\72\40\43\x46\106\x46\101\x46\60\73\47\x3e\12"; goto M_ci2; JhiSU: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\141\x74\145")) : array(); goto BWimY; YyJds: $tables_to_drop = array_diff($live_tables, $development_tables); goto JhiSU; Txq1u: echo "\x3c\150\62\76\x54\150\145\x20\144\141\164\141\x62\141\163\145\x20\151\x73\40\x6f\x75\164\x20\157\146\x20\123\x79\x6e\x63\41\74\x2f\150\x32\x3e\12"; goto AKv7x; BWimY: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\x72\x6f\160")) : array(); goto w98vy; eO_Ar: goto C_4Hx; goto Elxt3; W_q6Q: fSZKY: goto kmPTN; kmPTN: echo "\74\x70\x72\x65\x3e\xa"; goto Mokfl; YavhK: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto eocpV; w98vy: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto YavhK; Elxt3: YF03C: goto Txq1u; wNn9E: $live_tables = $this->DB2->list_tables(); goto Dyc3z; Dyc3z: $tables_to_create = array_diff($development_tables, $live_tables); goto YyJds; M_ci2: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; VXVMt: } goto W_q6Q; eocpV: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto XzxFX; ohrh7: $development_tables = $this->DB1->list_tables(); goto wNn9E; XzxFX: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto YF03C; } goto E9usb; AKv7x: echo "\74\160\76\124\x68\145\40\146\x6f\154\x6c\x6f\167\x69\x6e\147\40\x53\x51\114\40\x63\x6f\x6d\x6d\x61\x6e\x64\x73\40\156\x65\145\144\40\x74\x6f\40\x62\145\x20\x65\x78\145\x63\165\x74\145\x64\x20\164\157\40\x62\162\151\156\147\x20\x74\150\145\40\x4c\x69\166\x65\x20\144\141\x74\x61\x62\141\x73\145\x20\x74\x61\x62\x6c\x65\x73\x20\165\x70\x20\164\157\x20\144\141\x74\x65\72\40\74\57\x70\x3e\xa"; goto RPwPh; E9usb: echo "\x3c\x68\x32\76\x54\x68\145\x20\144\x61\x74\x61\x62\141\x73\145\x20\x61\160\160\145\x61\162\x73\x20\164\x6f\x20\142\x65\x20\x75\x70\40\x74\x6f\x20\144\141\164\x65\x3c\x2f\150\x32\76\12"; goto eO_Ar; Mokfl: C_4Hx: goto w6S5Y; w6S5Y: } function manage_tables($tables, $action) { goto tmQfD; tmQfD: $sql_commands_to_run = array(); goto yQ4uC; lJVE9: i8C74: goto TVYvv; f8orJ: b5vgR: goto rzAgH; yQ4uC: if (!($action == "\x63\x72\x65\141\164\x65")) { goto b5vgR; } goto Ah_hV; TVYvv: return $sql_commands_to_run; goto KEuaP; gRGZD: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\x52\117\120\x20\124\x41\x42\114\105\x20{$table}\x3b"; OpagR: } goto QsB4w; Ah_hV: foreach ($tables as $table) { goto SE4AE; gnvOU: $table_structure = $query->row_array(); goto dl4VP; dl4VP: $sql_commands_to_run[] = $table_structure["\103\x72\145\x61\x74\145\x20\124\x61\x62\154\145"] . "\73"; goto HZ0jr; HZ0jr: rxEgD: goto II64T; SE4AE: $query = $this->DB1->query("\x53\x48\117\127\x20\x43\122\x45\x41\124\105\x20\124\101\102\x4c\105\x20\x60{$table}\x60\x20\55\x2d\40\x63\x72\145\x61\x74\145\40\x74\141\142\154\145\x73"); goto gnvOU; II64T: } goto FIZcB; QsB4w: AwdsQ: goto lJVE9; rzAgH: if (!($action == "\144\162\157\160")) { goto i8C74; } goto gRGZD; FIZcB: DEwCF: goto f8orJ; KEuaP: } function compare_table_structures($development_tables, $live_tables) { goto o8ILK; OgpZM: XzEEG: goto T1_EA; hRykm: foreach ($development_tables as $table) { goto XL1Km; dpkEf: qpjn0: goto QjScQ; b5PNn: $table_structure = $query->row_array(); goto nqcqz; nqcqz: $development_table_structures[$table] = $table_structure["\x43\x72\145\141\x74\x65\x20\124\141\x62\x6c\145"]; goto dpkEf; XL1Km: $query = $this->DB1->query("\x53\110\117\x57\40\x43\x52\x45\x41\124\105\40\124\101\x42\x4c\105\x20\140{$table}\140\x20\55\x2d\40\144\145\x76"); goto b5PNn; QjScQ: } goto YhzxO; AZx0U: return $tables_need_updating; goto iZzPR; T1_EA: foreach ($development_tables as $table) { goto xi2Bs; O9Q8i: B4EpL: goto SJfnI; Jedje: ZeKUD: goto O9Q8i; PqP3s: $tables_need_updating[] = $table; goto Jedje; xi2Bs: $development_table = $development_table_structures[$table]; goto vXRlz; vXRlz: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto fZA2_; fZA2_: if (!($this->count_differences($development_table, $live_table) > 0)) { goto ZeKUD; } goto PqP3s; SJfnI: } goto VS63F; o8ILK: $tables_need_updating = array(); goto KEiHY; n2xqd: foreach ($live_tables as $table) { goto cMqha; e5nGa: $table_structure = $query->row_array(); goto nJCSH; cMqha: $query = $this->DB2->query("\123\110\x4f\127\40\103\122\105\101\x54\x45\x20\x54\101\102\x4c\x45\40\x60{$table}\140\x20\x2d\x2d\x20\x6c\151\166\145"); goto e5nGa; Dut_x: z7ErS: goto GwDzy; nJCSH: $live_table_structures[$table] = $table_structure["\x43\x72\x65\141\164\x65\x20\x54\x61\142\154\145"]; goto Dut_x; GwDzy: } goto OgpZM; KEiHY: $live_table_structures = $development_table_structures = array(); goto hRykm; VS63F: U8Qws: goto AZx0U; YhzxO: SeVC7: goto n2xqd; iZzPR: } function count_differences($old, $new) { goto Y8lIT; gNnTU: p2CkF: goto wL4i7; rVRW2: if (!($old[$i] != $new[$i])) { goto T0gdt; } goto MTIE6; xq7sa: $old = explode("\x20", $old); goto SBJnU; MTIE6: $differences++; goto xY3ma; lbbZ9: UjnFW: goto xq7sa; zZQVB: return $differences; goto cZpOT; nJED4: eOJn_: goto vCstC; G1FQA: goto eOJn_; goto DHcZM; Y8lIT: $differences = 0; goto dQK7a; O461Q: $i = 0; goto nJED4; traWU: return $differences; goto lbbZ9; gQ3eO: $length = max(count($old), count($new)); goto O461Q; dQK7a: $old = trim(preg_replace("\57\x5c\x73\53\x2f", '', $old)); goto hGJaV; wL4i7: $i++; goto G1FQA; DHcZM: s43hC: goto zZQVB; k_2Do: if (!($old == $new)) { goto UjnFW; } goto traWU; xY3ma: T0gdt: goto gNnTU; hGJaV: $new = trim(preg_replace("\57\134\163\x2b\57", '', $new)); goto k_2Do; SBJnU: $new = explode("\x20", $new); goto gQ3eO; vCstC: if (!($i < $length)) { goto s43hC; } goto rVRW2; cZpOT: } function update_existing_tables($tables) { goto iKd8L; A5ltg: clp1Z: goto rkQ0H; iKd8L: $sql_commands_to_run = array(); goto gNYAk; m2clu: if (!(is_array($tables) && !empty($tables))) { goto clp1Z; } goto mQ0Rb; rkQ0H: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto BoXXo; WaUg7: j43_T: goto A5ltg; gNYAk: $table_structure_development = array(); goto a1Fnk; a1Fnk: $table_structure_live = array(); goto m2clu; mQ0Rb: foreach ($tables as $table) { goto aPPFf; a3saI: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto WPaqt; aPPFf: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto a3saI; WPaqt: pFcRQ: goto aligX; aligX: } goto WaUg7; BoXXo: return $sql_commands_to_run; goto QZHXX; QZHXX: } function table_field_data($database, $table) { goto kSvOT; kSvOT: $conn = mysqli_connect($database["\150\x6f\x73\x74\x6e\141\155\x65"], $database["\165\x73\145\162\156\141\155\x65"], $database["\160\x61\x73\163\x77\157\x72\x64"]); goto vhPZn; E68lN: y6U_0: goto JsA33; o44b2: XaFnZ: goto o7KLN; vhPZn: mysql_select_db($database["\144\x61\164\x61\x62\x61\x73\x65"]); goto y4qzC; y4qzC: $result = mysql_query("\123\110\117\127\40\x43\117\114\x55\x4d\x4e\x53\x20\106\122\x4f\115\40\140{$table}\x60"); goto E68lN; WrWXm: $fields[] = $row; goto JSTYu; o7KLN: return $fields; goto YMhkZ; JsA33: if (!($row = mysql_fetch_assoc($result))) { goto XaFnZ; } goto WrWXm; JSTYu: goto y6U_0; goto o44b2; YMhkZ: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto Gq8At; LTBPA: UQH3M: goto rSpd4; Gq8At: $sql_commands_to_run = array(); goto VHy7a; VHy7a: foreach ($source_field_structures as $table => $fields) { goto m6dUX; L3hZZ: LHI1U: goto V6VJ9; m6dUX: foreach ($fields as $field) { goto J1BBA; ou5jW: $modify_field .= isset($fields[$n]["\104\x65\x66\141\165\154\x74"]) && $fields[$n]["\104\x65\146\x61\x75\154\164"] != '' ? "\40\x44\x45\x46\x41\125\x4c\x54\40\47" . $fields[$n]["\x44\145\x66\141\165\154\164"] . "\47" : ''; goto VBIIn; qERUl: $sql_commands_to_run[] = $modify_field; goto fl2Zj; J1BBA: if ($this->in_array_recursive($field["\106\151\x65\154\x64"], $destination_field_structures[$table])) { goto kBnaP; } goto gRt8v; WLlfx: $add_field .= "\73"; goto Wxtwg; aExtN: if (!($n < count($fields))) { goto MssWj; } goto HSn_y; Ky6iR: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto TJjfy; } goto qERUl; NNNB3: n9jBB: goto k9ra0; OjfT_: wi_Df: goto Ky6iR; qzc9I: $add_field .= "\x20\x44\x45\106\x41\125\x4c\124\x20" . $field["\104\145\x66\x61\x75\x6c\164"]; goto o0QhA; sG1MW: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto YP9fg; Nd486: $modify_field .= "\x3b"; goto NNNB3; fl2Zj: TJjfy: goto NNNlh; xQjqc: kBnaP: goto L5lLN; k9ra0: $previous_field = $fields[$n]["\x46\151\145\x6c\144"]; goto OjfT_; Wxtwg: $sql_commands_to_run[] = $add_field; goto dvFS7; o0kuo: $n = 0; goto gkugo; HSn_y: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\x69\x65\x6c\x64"] == $destination_field_structures[$table][$n]["\x46\x69\145\154\144"])) { goto wi_Df; } goto sG1MW; dvFS7: goto oe2mH; goto xQjqc; uE9g5: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\x46\x54\x45\122\40" . $previous_field : ''; goto Nd486; HpUoz: MssWj: goto sYO66; WTCy6: goto PSEOe; goto HpUoz; uoRDw: $modify_field .= isset($fields[$n]["\x45\170\x74\x72\x61"]) && $fields[$n]["\x45\x78\x74\162\141"] != '' ? "\x20" . $fields[$n]["\x45\170\x74\x72\141"] : ''; goto uE9g5; gRt8v: $add_field = "\101\x4c\x54\105\122\40\124\101\102\x4c\x45\x20{$table}\40\101\104\x44\40\103\117\114\x55\115\116\40\140" . $field["\106\x69\x65\154\x64"] . "\140\40" . $field["\x54\171\160\x65"] . "\x20\x43\110\x41\122\x41\x43\124\105\x52\x20\123\105\x54\x20" . $this->CHARACTER_SET; goto rr35y; Wegbl: F351W: goto sMBuB; VBIIn: $modify_field .= isset($fields[$n]["\x4e\x75\154\154"]) && $fields[$n]["\116\165\154\x6c"] == "\x59\x45\x53" ? "\40\x4e\125\114\114" : "\x20\x4e\117\124\x20\x4e\x55\x4c\114"; goto uoRDw; o0QhA: $add_field .= isset($field["\x45\x78\164\x72\141"]) && $field["\x45\x78\164\162\141"] != '' ? "\x20" . $field["\x45\x78\x74\162\141"] : ''; goto WLlfx; L5lLN: $modify_field = ''; goto o0kuo; gkugo: PSEOe: goto aExtN; NNNlh: x16l2: goto EOMsz; YP9fg: if (!(is_array($differences) && !empty($differences))) { goto n9jBB; } goto rgNTM; sYO66: oe2mH: goto Wegbl; EOMsz: $n++; goto WTCy6; rgNTM: $modify_field = "\101\x4c\x54\x45\122\40\x54\101\102\x4c\x45\40{$table}\x20\115\x4f\x44\x49\106\x59\x20\x43\117\114\125\115\116\x20\140" . $fields[$n]["\x46\x69\x65\154\x64"] . "\x60\40" . $fields[$n]["\124\x79\160\x65"] . "\x20\x43\x48\101\122\101\103\x54\x45\x52\x20\123\105\124\40" . $this->CHARACTER_SET; goto ou5jW; rr35y: $add_field .= isset($field["\x4e\x75\x6c\x6c"]) && $field["\116\x75\154\154"] == "\131\105\x53" ? "\40\116\x75\x6c\x6c" : ''; goto qzc9I; sMBuB: } goto L3hZZ; V6VJ9: MyZqX: goto lKWva; lKWva: } goto LTBPA; rSpd4: return $sql_commands_to_run; goto CPOQa; CPOQa: } function in_array_recursive($needle, $haystack, $strict = false) { goto ONduC; kEPCR: return false; goto DmLtF; va8nV: cy01P: goto kEPCR; ONduC: foreach ($haystack as $array => $item) { goto imTfL; yZ0lF: return true; goto IoZED; j7iQq: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto NFu5X; } goto yZ0lF; IoZED: NFu5X: goto OJI3Y; imTfL: $item = $item["\106\x69\x65\154\144"]; goto j7iQq; OJI3Y: X3fK3: goto C0_Pb; C0_Pb: } goto va8nV; DmLtF: } }
