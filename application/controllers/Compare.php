<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto x19s7; Y90oc: r34m4: goto W9BEp; x19s7: if (defined("\102\x41\x53\105\x50\101\124\110")) { goto r34m4; } goto gGfeM; gGfeM: exit("\x4e\157\40\x64\151\x72\x65\143\x74\40\x73\143\162\151\x70\x74\x20\x61\143\x63\145\163\163\x20\x61\x6c\x6c\157\167\145\x64"); goto Y90oc; W9BEp: class Compare extends CI_Controller { function __construct() { goto gAjNd; vZ_1u: $this->DB2 = $this->load->database("\x6c\151\x76\x65", TRUE); goto fCTI1; hf7do: $this->DB1 = $this->load->database("\x6d\x61\151\x6e\x5f\147\141\162\x75\x64\141", TRUE); goto vZ_1u; s8lDG: $this->CHARACTER_SET = "\x75\x74\146\x38\x20\103\117\x4c\114\x41\124\x45\x20\x75\164\146\x38\137\x67\x65\x6e\x65\162\x61\154\137\x63\151"; goto hf7do; gAjNd: parent::__construct(); goto s8lDG; fCTI1: } function index() { goto kJeRI; Hvquq: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto Noejs; zPNrY: SS2CY: goto j3JA6; j3JA6: echo "\74\x70\x72\145\x3e\12"; goto jkTb9; phjoM: $tables_to_create = array_diff($development_tables, $live_tables); goto a26p7; b287G: echo "\x3c\160\x3e\x54\150\x65\x20\146\157\154\154\x6f\x77\151\156\x67\x20\x53\x51\114\x20\x63\157\155\155\x61\x6e\x64\x73\x20\x6e\145\145\x64\40\x74\x6f\40\142\x65\40\145\170\x65\x63\x75\164\x65\x64\x20\x74\x6f\40\x62\162\151\x6e\x67\x20\164\150\145\40\114\151\166\x65\40\x64\141\164\141\142\x61\x73\x65\40\x74\x61\142\x6c\x65\163\40\165\x70\x20\164\x6f\40\x64\141\x74\145\x3a\x20\74\x2f\x70\x3e\xa"; goto nBl_S; uHYlC: kIAF1: goto lbTae; lbTae: echo "\x3c\150\62\76\x54\x68\x65\40\144\141\x74\x61\142\141\163\145\x20\x69\163\40\157\165\164\x20\157\x66\40\x53\x79\x6e\143\x21\x3c\57\x68\62\76\xa"; goto b287G; a26p7: $tables_to_drop = array_diff($live_tables, $development_tables); goto almtJ; khSjc: $development_tables = $this->DB1->list_tables(); goto QQ1th; jMfDY: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto Hvquq; jkTb9: ehtCl: goto om4v3; almtJ: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\141\164\145")) : array(); goto Bg1Vu; xLyL1: goto ehtCl; goto uHYlC; j1LnU: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto kIAF1; } goto kWt02; Bg1Vu: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\x72\x6f\160")) : array(); goto jMfDY; QQ1th: $live_tables = $this->DB2->list_tables(); goto phjoM; Noejs: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto j1LnU; kWt02: echo "\x3c\x68\62\76\124\x68\145\x20\144\x61\164\x61\142\x61\x73\x65\x20\x61\160\160\x65\x61\x72\163\x20\x74\157\x20\142\145\x20\165\160\x20\x74\x6f\40\x64\x61\x74\x65\74\57\x68\x32\x3e\12"; goto xLyL1; kJeRI: $sql_commands_to_run = array(); goto khSjc; QvDtr: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; cn3ou: } goto zPNrY; nBl_S: echo "\x3c\x70\162\x65\40\163\164\x79\154\x65\x3d\47\x70\x61\x64\144\x69\156\147\x3a\x20\x32\x30\x70\x78\x3b\x20\142\x61\143\x6b\147\x72\157\x75\x6e\x64\x2d\x63\x6f\154\x6f\162\x3a\40\43\x46\x46\x46\101\106\60\73\x27\x3e\xa"; goto QvDtr; om4v3: } function manage_tables($tables, $action) { goto wXKxl; QG3fc: if (!($action == "\144\x72\157\x70")) { goto tE4gm; } goto Pejdt; wXKxl: $sql_commands_to_run = array(); goto LyV93; Pejdt: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\x52\x4f\120\40\x54\x41\x42\114\105\x20{$table}\x3b"; YpS3f: } goto lP405; eOnsd: foreach ($tables as $table) { goto g94Ed; WB4wZ: $table_structure = $query->row_array(); goto BvdR0; BvdR0: $sql_commands_to_run[] = $table_structure["\103\162\x65\x61\x74\145\40\124\141\142\x6c\x65"] . "\x3b"; goto FJe5c; g94Ed: $query = $this->DB1->query("\123\110\117\x57\40\103\122\105\101\124\105\40\x54\x41\102\x4c\x45\x20\140{$table}\x60\40\x2d\55\x20\143\162\x65\141\x74\145\x20\164\x61\x62\154\145\x73"); goto WB4wZ; FJe5c: Umrno: goto nLjiX; nLjiX: } goto Y3fDd; cYk3F: return $sql_commands_to_run; goto WX3rj; LyV93: if (!($action == "\x63\162\x65\141\x74\x65")) { goto QZsjP; } goto eOnsd; zAcGS: QZsjP: goto QG3fc; yA_r9: tE4gm: goto cYk3F; Y3fDd: kjzmk: goto zAcGS; lP405: iTC9C: goto yA_r9; WX3rj: } function compare_table_structures($development_tables, $live_tables) { goto sMWpX; wfPxD: v_5A3: goto FFja0; FFja0: return $tables_need_updating; goto BXMJx; z9HU_: $live_table_structures = $development_table_structures = array(); goto jyQzS; jyQzS: foreach ($development_tables as $table) { goto pVJDI; tACOt: LpJEf: goto w0SJW; pVJDI: $query = $this->DB1->query("\x53\x48\117\x57\x20\103\122\x45\x41\x54\x45\40\124\101\x42\x4c\x45\x20\140{$table}\x60\x20\55\x2d\x20\144\145\x76"); goto PZdDh; IgYpd: $development_table_structures[$table] = $table_structure["\x43\162\145\x61\x74\145\x20\124\141\142\x6c\145"]; goto tACOt; PZdDh: $table_structure = $query->row_array(); goto IgYpd; w0SJW: } goto JkZEA; lYtEi: foreach ($live_tables as $table) { goto J5L4h; gOLcn: MmK7d: goto SFsrA; VsEw3: $table_structure = $query->row_array(); goto g40F_; J5L4h: $query = $this->DB2->query("\123\110\x4f\x57\x20\x43\122\x45\x41\124\x45\40\x54\x41\x42\114\x45\x20\x60{$table}\140\x20\x2d\55\40\x6c\151\x76\x65"); goto VsEw3; g40F_: $live_table_structures[$table] = $table_structure["\103\162\145\141\x74\145\40\x54\x61\x62\154\145"]; goto gOLcn; SFsrA: } goto gzB2D; NGCqi: foreach ($development_tables as $table) { goto lfvoB; ik6bx: $tables_need_updating[] = $table; goto kNblh; lfvoB: $development_table = $development_table_structures[$table]; goto WeNb0; g8jZG: if (!($this->count_differences($development_table, $live_table) > 0)) { goto p1Gw7; } goto ik6bx; eeqCr: UyqBa: goto JMaUF; kNblh: p1Gw7: goto eeqCr; WeNb0: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto g8jZG; JMaUF: } goto wfPxD; sMWpX: $tables_need_updating = array(); goto z9HU_; JkZEA: YoxKB: goto lYtEi; gzB2D: OZJrB: goto NGCqi; BXMJx: } function count_differences($old, $new) { goto BmV44; Om_A4: if (!($i < $length)) { goto H1Rr9; } goto XkRLd; zuv_D: $i++; goto CM4vH; JaJHr: $new = explode("\40", $new); goto Zb368; Yyz67: $old = explode("\40", $old); goto JaJHr; XkRLd: if (!($old[$i] != $new[$i])) { goto EZ1La; } goto BiSB1; BmV44: $differences = 0; goto EuUsU; MLa8n: return $differences; goto VIp60; iwt1K: wJrzq: goto Om_A4; EuUsU: $old = trim(preg_replace("\x2f\x5c\163\x2b\x2f", '', $old)); goto B62fG; CM4vH: goto wJrzq; goto l1lpM; PUxbd: $i = 0; goto iwt1K; ix2bo: if (!($old == $new)) { goto SYpRh; } goto MLa8n; VIp60: SYpRh: goto Yyz67; Zb368: $length = max(count($old), count($new)); goto PUxbd; U9MC2: EZ1La: goto PljaG; t9bvf: return $differences; goto zHgoi; PljaG: tRmcZ: goto zuv_D; B62fG: $new = trim(preg_replace("\x2f\134\x73\53\x2f", '', $new)); goto ix2bo; l1lpM: H1Rr9: goto t9bvf; BiSB1: $differences++; goto U9MC2; zHgoi: } function update_existing_tables($tables) { goto kZaHZ; CUiv1: foreach ($tables as $table) { goto bIUPB; bIUPB: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto c1_TV; c1_TV: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto e6tbN; e6tbN: a7P54: goto g3JXx; g3JXx: } goto bXnOa; WIfVt: ye7UO: goto DJbG9; DJbG9: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto khgGz; x1sHP: $table_structure_live = array(); goto Di5fX; khgGz: return $sql_commands_to_run; goto tP9oY; kZaHZ: $sql_commands_to_run = array(); goto pfvH3; Di5fX: if (!(is_array($tables) && !empty($tables))) { goto ye7UO; } goto CUiv1; pfvH3: $table_structure_development = array(); goto x1sHP; bXnOa: KvinK: goto WIfVt; tP9oY: } function table_field_data($database, $table) { goto ZTzVu; X8VOE: if (!($row = mysql_fetch_assoc($result))) { goto fom1r; } goto nkyg8; MAnCN: $result = mysql_query("\x53\110\x4f\127\40\x43\117\114\125\x4d\x4e\123\40\x46\122\117\115\40\x60{$table}\140"); goto pl1Sa; pvZu0: mysql_select_db($database["\144\x61\x74\141\x62\141\163\x65"]); goto MAnCN; Haxm0: return $fields; goto jBRbK; nkyg8: $fields[] = $row; goto Y7je2; kdxRt: fom1r: goto Haxm0; pl1Sa: mpSmC: goto X8VOE; ZTzVu: $conn = mysqli_connect($database["\x68\x6f\x73\164\x6e\141\155\145"], $database["\x75\163\145\x72\156\141\155\145"], $database["\x70\x61\163\163\167\x6f\x72\x64"]); goto pvZu0; Y7je2: goto mpSmC; goto kdxRt; jBRbK: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto hJniF; L_DsD: return $sql_commands_to_run; goto brK2i; D_Sv8: r3Gzz: goto L_DsD; o2pnc: foreach ($source_field_structures as $table => $fields) { goto zDAlB; zDAlB: foreach ($fields as $field) { goto samLw; q530u: $n++; goto VhoLb; iFEd4: $add_field .= "\x3b"; goto c7kLy; nyNN5: o5NtF: goto X6ha1; JMgwY: FiG3H: goto o6qvl; jKYUc: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto FiG3H; } goto ZaF_P; gPhmZ: if (!(is_array($differences) && !empty($differences))) { goto aMvpg; } goto DE_mj; s0EBB: $modify_field .= isset($fields[$n]["\116\x75\154\x6c"]) && $fields[$n]["\116\165\154\154"] == "\131\105\x53" ? "\40\116\125\114\x4c" : "\x20\116\117\124\x20\x4e\x55\114\114"; goto vBVco; u9kci: aMvpg: goto e0Hgt; vBVco: $modify_field .= isset($fields[$n]["\x45\170\164\162\x61"]) && $fields[$n]["\x45\170\x74\162\x61"] != '' ? "\x20" . $fields[$n]["\x45\170\164\162\x61"] : ''; goto yas35; yas35: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\x46\124\105\122\x20" . $previous_field : ''; goto S6Hgc; zXqTy: if (!($n < count($fields))) { goto czb_L; } goto Kw6Qd; jHaFy: $modify_field .= isset($fields[$n]["\104\x65\146\141\x75\154\164"]) && $fields[$n]["\x44\145\146\141\x75\154\164"] != '' ? "\40\x44\x45\106\x41\x55\x4c\x54\40\x27" . $fields[$n]["\104\x65\146\x61\x75\x6c\x74"] . "\x27" : ''; goto s0EBB; JuvBy: $n = 0; goto sZCRQ; samLw: if ($this->in_array_recursive($field["\x46\x69\x65\154\x64"], $destination_field_structures[$table])) { goto UHCZf; } goto j2VQ0; GWAZ0: $modify_field = ''; goto JuvBy; euz9Z: $add_field .= "\40\x44\105\x46\101\x55\x4c\x54\40" . $field["\104\x65\x66\141\x75\154\x74"]; goto ImR30; Kw6Qd: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\151\145\x6c\x64"] == $destination_field_structures[$table][$n]["\x46\x69\x65\x6c\x64"])) { goto cc1JK; } goto vqNAz; e0Hgt: $previous_field = $fields[$n]["\x46\151\x65\154\144"]; goto k292P; vqNAz: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto gPhmZ; VhoLb: goto wm7fP; goto Pw7WG; Pw7WG: czb_L: goto nyNN5; j2VQ0: $add_field = "\x41\114\124\x45\122\40\124\x41\102\x4c\x45\40{$table}\x20\x41\x44\x44\x20\x43\117\x4c\125\115\116\x20\x60" . $field["\x46\x69\x65\x6c\x64"] . "\140\40" . $field["\x54\171\x70\145"] . "\x20\x43\x48\101\122\101\103\x54\x45\x52\40\x53\105\x54\40" . $this->CHARACTER_SET; goto rXVdk; sZCRQ: wm7fP: goto zXqTy; rXVdk: $add_field .= isset($field["\116\165\154\x6c"]) && $field["\x4e\165\154\154"] == "\131\x45\123" ? "\x20\116\165\x6c\x6c" : ''; goto euz9Z; S6Hgc: $modify_field .= "\73"; goto u9kci; X6ha1: MqCxH: goto uyfzn; ZaF_P: $sql_commands_to_run[] = $modify_field; goto JMgwY; k292P: cc1JK: goto jKYUc; ImR30: $add_field .= isset($field["\x45\x78\164\162\x61"]) && $field["\105\x78\x74\x72\x61"] != '' ? "\x20" . $field["\x45\170\x74\x72\x61"] : ''; goto iFEd4; c7kLy: $sql_commands_to_run[] = $add_field; goto BM7Wu; DE_mj: $modify_field = "\x41\114\x54\105\122\x20\x54\101\102\114\105\40{$table}\40\x4d\117\104\111\x46\x59\40\x43\x4f\x4c\125\115\116\40\140" . $fields[$n]["\x46\x69\145\154\x64"] . "\140\x20" . $fields[$n]["\124\x79\160\x65"] . "\40\103\x48\101\122\x41\103\124\105\122\x20\x53\105\x54\x20" . $this->CHARACTER_SET; goto jHaFy; Mpo_j: UHCZf: goto GWAZ0; BM7Wu: goto o5NtF; goto Mpo_j; o6qvl: LYWhp: goto q530u; uyfzn: } goto Th4_N; Th4_N: GQm8Y: goto gxtnD; gxtnD: D5hXG: goto orJ6C; orJ6C: } goto D_Sv8; hJniF: $sql_commands_to_run = array(); goto o2pnc; brK2i: } function in_array_recursive($needle, $haystack, $strict = false) { goto J4Hkg; rYbUU: f89Pv: goto JqerF; J4Hkg: foreach ($haystack as $array => $item) { goto SKw28; qMMM_: return true; goto jjkvB; SKw28: $item = $item["\106\x69\145\154\x64"]; goto gclgG; Wzzuf: Iv0qN: goto ljs1O; jjkvB: Hi2sU: goto Wzzuf; gclgG: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto Hi2sU; } goto qMMM_; ljs1O: } goto rYbUU; JqerF: return false; goto mg_tD; mg_tD: } }
