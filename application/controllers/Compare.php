<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto uD7n6; fXErS: Qo55d: goto VSMVz; EtSz8: exit("\x4e\x6f\x20\144\x69\x72\145\x63\x74\40\x73\143\162\151\x70\x74\x20\141\143\x63\x65\163\163\40\x61\x6c\x6c\157\167\145\x64"); goto fXErS; uD7n6: if (defined("\x42\x41\x53\x45\120\101\124\110")) { goto Qo55d; } goto EtSz8; VSMVz: class Compare extends CI_Controller { function __construct() { goto K2N1X; NpR_H: $this->CHARACTER_SET = "\x75\164\146\x38\x20\x43\117\114\x4c\101\124\x45\40\x75\x74\146\x38\x5f\x67\145\156\145\x72\x61\154\x5f\143\x69"; goto Bc3iA; Bc3iA: $this->DB1 = $this->load->database("\155\141\x69\156\137\x67\x61\162\165\144\141", TRUE); goto i0xT_; K2N1X: parent::__construct(); goto NpR_H; i0xT_: $this->DB2 = $this->load->database("\154\x69\166\x65", TRUE); goto A24CV; A24CV: } function index() { goto NdGm5; DLHmS: echo "\74\x70\x3e\124\x68\145\40\146\x6f\x6c\154\157\x77\x69\156\x67\x20\123\121\114\40\x63\x6f\155\155\141\156\x64\x73\40\x6e\145\145\x64\40\x74\157\40\x62\x65\40\x65\170\145\x63\165\164\145\x64\40\164\x6f\x20\x62\x72\151\x6e\x67\40\164\150\x65\x20\114\151\166\x65\x20\x64\x61\x74\141\142\141\163\145\x20\164\x61\142\154\145\x73\40\165\160\40\164\157\40\144\x61\x74\145\x3a\x20\74\57\160\x3e\12"; goto Vwv0Q; qd5CT: r8MZH: goto c2OcZ; J7sBy: $tables_to_create = array_diff($development_tables, $live_tables); goto f9JM8; NdGm5: $sql_commands_to_run = array(); goto sQl6u; KlURf: goto r8MZH; goto B6tXb; gkIkz: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto qkkdH; QRAth: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\x72\x6f\160")) : array(); goto x8nx3; H0oFl: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto aEnoa; } goto BoPMO; PcwiE: $live_tables = $this->DB2->list_tables(); goto J7sBy; sQl6u: $development_tables = $this->DB1->list_tables(); goto PcwiE; qkkdH: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto H0oFl; twK8y: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; rwr12: } goto jmv5V; x8nx3: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto gkIkz; oK8v_: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\x72\x65\x61\164\x65")) : array(); goto QRAth; B6tXb: aEnoa: goto nWSAR; nWSAR: echo "\x3c\x68\x32\76\124\x68\145\x20\144\141\164\x61\x62\x61\163\x65\40\151\163\40\157\x75\164\x20\157\146\x20\123\171\156\143\41\x3c\x2f\150\x32\76\xa"; goto DLHmS; BoPMO: echo "\74\150\62\x3e\x54\150\x65\40\x64\x61\164\x61\x62\141\x73\145\40\141\x70\160\145\x61\x72\163\40\x74\x6f\40\142\x65\x20\x75\160\40\x74\157\40\x64\141\164\145\x3c\x2f\x68\x32\x3e\12"; goto KlURf; f9JM8: $tables_to_drop = array_diff($live_tables, $development_tables); goto oK8v_; eV6uR: echo "\x3c\x70\x72\145\76\xa"; goto qd5CT; jmv5V: WFvL5: goto eV6uR; Vwv0Q: echo "\74\160\x72\x65\40\x73\x74\171\154\x65\75\47\x70\x61\144\144\x69\x6e\147\72\x20\x32\60\160\170\73\40\x62\141\x63\x6b\147\x72\x6f\x75\x6e\x64\x2d\x63\x6f\154\x6f\162\72\x20\x23\x46\106\106\101\106\60\73\x27\x3e\xa"; goto twK8y; c2OcZ: } function manage_tables($tables, $action) { goto g4mhg; g4mhg: $sql_commands_to_run = array(); goto aENnx; T_j8j: uEVaw: goto IlraB; IlraB: D0WrN: goto C1ra0; C1ra0: if (!($action == "\x64\162\x6f\160")) { goto D9FMQ; } goto BZkBX; BZkBX: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\x52\x4f\x50\x20\124\x41\102\114\105\40{$table}\73"; ZMU8n: } goto HAQJJ; aENnx: if (!($action == "\143\162\x65\x61\x74\145")) { goto D0WrN; } goto fcQiL; A0x2u: return $sql_commands_to_run; goto SoEcb; HAQJJ: gNBYi: goto UF5H7; fcQiL: foreach ($tables as $table) { goto sWHKC; MR9q0: YrJo2: goto yrZGl; XbaNb: $table_structure = $query->row_array(); goto Vgsqc; sWHKC: $query = $this->DB1->query("\123\110\x4f\127\40\103\122\x45\101\x54\x45\x20\124\x41\x42\114\105\x20\140{$table}\x60\40\x2d\x2d\x20\143\162\x65\141\x74\x65\40\x74\141\142\154\x65\x73"); goto XbaNb; Vgsqc: $sql_commands_to_run[] = $table_structure["\x43\162\x65\141\x74\145\x20\x54\x61\x62\x6c\145"] . "\73"; goto MR9q0; yrZGl: } goto T_j8j; UF5H7: D9FMQ: goto A0x2u; SoEcb: } function compare_table_structures($development_tables, $live_tables) { goto G3MYo; iIe1i: foreach ($development_tables as $table) { goto fnPo8; AgGEy: t8zKk: goto oWOR0; fnPo8: $query = $this->DB1->query("\123\110\x4f\x57\x20\103\122\x45\101\124\x45\40\x54\x41\102\x4c\105\40\x60{$table}\140\40\x2d\55\x20\x64\145\x76"); goto yJR00; yJR00: $table_structure = $query->row_array(); goto pI2W8; pI2W8: $development_table_structures[$table] = $table_structure["\103\162\x65\141\x74\x65\x20\x54\x61\x62\154\145"]; goto AgGEy; oWOR0: } goto u0Vvy; u0Vvy: uqtkR: goto g1C_E; G3MYo: $tables_need_updating = array(); goto hVFJJ; g1C_E: foreach ($live_tables as $table) { goto kUogG; kUogG: $query = $this->DB2->query("\x53\x48\117\127\x20\103\x52\105\101\x54\105\40\x54\101\x42\x4c\105\x20\140{$table}\x60\40\x2d\x2d\x20\x6c\151\x76\145"); goto EWrXM; so09l: qpLd9: goto bENnr; yYy7Z: $live_table_structures[$table] = $table_structure["\103\162\x65\x61\x74\145\40\124\x61\142\154\x65"]; goto so09l; EWrXM: $table_structure = $query->row_array(); goto yYy7Z; bENnr: } goto kA0go; ilBSP: gyDfE: goto HrpPr; hVFJJ: $live_table_structures = $development_table_structures = array(); goto iIe1i; ff8sE: foreach ($development_tables as $table) { goto tpEZb; LE1G3: lf7Cf: goto XXk2v; tpEZb: $development_table = $development_table_structures[$table]; goto URqhU; URqhU: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto MX25L; QGX8n: $tables_need_updating[] = $table; goto LE1G3; MX25L: if (!($this->count_differences($development_table, $live_table) > 0)) { goto lf7Cf; } goto QGX8n; XXk2v: DU29V: goto i5WBC; i5WBC: } goto ilBSP; HrpPr: return $tables_need_updating; goto CPBBf; kA0go: IG_jQ: goto ff8sE; CPBBf: } function count_differences($old, $new) { goto gZWpo; P2ECy: return $differences; goto pC5UY; vmwpm: fhE8f: goto mx7J9; nL6rJ: return $differences; goto WK2H3; wKdQF: if (!($i < $length)) { goto zLB_R; } goto DM4qe; mx7J9: alewY: goto oBBFB; Cwj1T: $length = max(count($old), count($new)); goto SX4Bw; g_fMw: $new = explode("\x20", $new); goto Cwj1T; OJxld: if (!($old == $new)) { goto TTuGy; } goto nL6rJ; kFLR7: $new = trim(preg_replace("\x2f\134\x73\x2b\x2f", '', $new)); goto OJxld; oBBFB: $i++; goto IGNXz; YoG8a: zLB_R: goto P2ECy; DM4qe: if (!($old[$i] != $new[$i])) { goto fhE8f; } goto jCZSP; SX4Bw: $i = 0; goto EGy9h; WK2H3: TTuGy: goto DrOUY; jCZSP: $differences++; goto vmwpm; NpPpv: $old = trim(preg_replace("\x2f\x5c\163\x2b\x2f", '', $old)); goto kFLR7; EGy9h: Fiyjy: goto wKdQF; gZWpo: $differences = 0; goto NpPpv; DrOUY: $old = explode("\40", $old); goto g_fMw; IGNXz: goto Fiyjy; goto YoG8a; pC5UY: } function update_existing_tables($tables) { goto Mek_7; jiUPZ: if (!(is_array($tables) && !empty($tables))) { goto R2Yyn; } goto L9ipv; tg81R: $table_structure_live = array(); goto jiUPZ; a3QFB: return $sql_commands_to_run; goto piSmm; t3HtI: R2Yyn: goto LB3Gk; L9ipv: foreach ($tables as $table) { goto p9Z1u; uBgV6: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto EeOTW; EeOTW: t4gfR: goto qJP_Q; p9Z1u: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto uBgV6; qJP_Q: } goto N4FjC; jga0J: $table_structure_development = array(); goto tg81R; LB3Gk: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto a3QFB; Mek_7: $sql_commands_to_run = array(); goto jga0J; N4FjC: U1Q_R: goto t3HtI; piSmm: } function table_field_data($database, $table) { goto pIRIT; AFPid: mysql_select_db($database["\x64\141\164\x61\x62\x61\x73\x65"]); goto xXnHM; kEdXH: if (!($row = mysql_fetch_assoc($result))) { goto M5Hlo; } goto WeYMq; ET4eu: goto xzjGi; goto yvggL; J9gBc: return $fields; goto m0A4O; pIRIT: $conn = mysqli_connect($database["\x68\x6f\163\x74\x6e\141\x6d\x65"], $database["\x75\163\x65\162\156\x61\x6d\x65"], $database["\x70\x61\x73\163\x77\x6f\x72\144"]); goto AFPid; yvggL: M5Hlo: goto J9gBc; WeYMq: $fields[] = $row; goto ET4eu; xXnHM: $result = mysql_query("\123\x48\x4f\x57\x20\x43\x4f\114\x55\115\116\123\x20\x46\x52\x4f\x4d\x20\140{$table}\140"); goto SweHi; SweHi: xzjGi: goto kEdXH; m0A4O: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto w0B4u; vHCnJ: wOQpJ: goto WR75b; WR75b: return $sql_commands_to_run; goto brJkG; w0B4u: $sql_commands_to_run = array(); goto MNKw6; MNKw6: foreach ($source_field_structures as $table => $fields) { goto aHpXz; PbNDD: FWwRE: goto D_mAS; D_mAS: AEp2j: goto P0wXX; aHpXz: foreach ($fields as $field) { goto y3Wlk; ykY7e: goto U6qyF; goto V11sn; V11sn: lX79x: goto f3I77; UEIX3: $modify_field .= isset($fields[$n]["\x4e\x75\154\154"]) && $fields[$n]["\116\165\x6c\x6c"] == "\x59\105\123" ? "\40\x4e\x55\x4c\114" : "\x20\x4e\117\124\40\116\x55\114\x4c"; goto gRkli; H52xl: lCXgq: goto HW_yA; A3fjP: if (!(is_array($differences) && !empty($differences))) { goto CykOp; } goto V0vl0; ogD5f: $add_field .= "\x20\x44\x45\x46\101\125\114\124\40" . $field["\104\x65\x66\x61\165\154\x74"]; goto QK3ns; QK3ns: $add_field .= isset($field["\x45\x78\164\x72\x61"]) && $field["\x45\170\164\162\x61"] != '' ? "\40" . $field["\x45\170\164\162\141"] : ''; goto FEdRC; V0vl0: $modify_field = "\x41\x4c\124\x45\x52\40\124\101\102\114\105\x20{$table}\x20\x4d\x4f\104\x49\106\x59\40\103\x4f\114\125\x4d\116\40\x60" . $fields[$n]["\x46\x69\x65\x6c\144"] . "\140\x20" . $fields[$n]["\x54\x79\160\145"] . "\x20\x43\110\101\x52\101\x43\x54\105\122\x20\x53\x45\x54\x20" . $this->CHARACTER_SET; goto P0Eqf; tYaSV: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\x41\106\x54\x45\x52\x20" . $previous_field : ''; goto rEMp8; wtxJ2: if (!($n < count($fields))) { goto lX79x; } goto iWuDL; rEMp8: $modify_field .= "\x3b"; goto a9uDN; bF0Hj: hIfZY: goto WQkix; UDm7B: Meisg: goto UGWr5; f3I77: Cvqyh: goto mFx0p; XxM1J: goto Cvqyh; goto bF0Hj; iWuDL: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\x69\x65\x6c\144"] == $destination_field_structures[$table][$n]["\106\151\145\x6c\x64"])) { goto Meisg; } goto LG8mg; HW_yA: TzOx6: goto MyIzc; dXMvV: $sql_commands_to_run[] = $modify_field; goto H52xl; y3Wlk: if ($this->in_array_recursive($field["\106\151\145\154\144"], $destination_field_structures[$table])) { goto hIfZY; } goto SWJtL; YrWLu: $sql_commands_to_run[] = $add_field; goto XxM1J; LG8mg: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto A3fjP; WRhf0: $add_field .= isset($field["\116\x75\154\x6c"]) && $field["\x4e\x75\x6c\x6c"] == "\131\x45\x53" ? "\x20\x4e\165\154\x6c" : ''; goto ogD5f; SWJtL: $add_field = "\x41\114\x54\x45\x52\40\124\101\102\114\x45\x20{$table}\40\101\104\x44\x20\103\117\114\125\x4d\116\x20\140" . $field["\x46\151\145\154\144"] . "\x60\x20" . $field["\x54\171\x70\145"] . "\40\x43\110\x41\x52\101\103\124\105\122\40\x53\105\x54\x20" . $this->CHARACTER_SET; goto WRhf0; taX0y: $n = 0; goto Lrhz0; Ob12P: $previous_field = $fields[$n]["\106\x69\x65\x6c\x64"]; goto UDm7B; Lrhz0: U6qyF: goto wtxJ2; P0Eqf: $modify_field .= isset($fields[$n]["\104\x65\x66\141\165\154\164"]) && $fields[$n]["\104\145\x66\x61\165\x6c\164"] != '' ? "\40\x44\x45\106\x41\x55\114\124\x20\x27" . $fields[$n]["\x44\145\x66\x61\165\154\164"] . "\x27" : ''; goto UEIX3; FEdRC: $add_field .= "\x3b"; goto YrWLu; gRkli: $modify_field .= isset($fields[$n]["\x45\x78\164\162\141"]) && $fields[$n]["\105\x78\164\x72\141"] != '' ? "\x20" . $fields[$n]["\x45\x78\164\x72\141"] : ''; goto tYaSV; UGWr5: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto lCXgq; } goto dXMvV; a9uDN: CykOp: goto Ob12P; WQkix: $modify_field = ''; goto taX0y; mFx0p: icYi6: goto N0Lto; MyIzc: $n++; goto ykY7e; N0Lto: } goto PbNDD; P0wXX: } goto vHCnJ; brJkG: } function in_array_recursive($needle, $haystack, $strict = false) { goto t4gI7; RPjNn: return false; goto bpUDz; Gb958: K5sv3: goto RPjNn; t4gI7: foreach ($haystack as $array => $item) { goto QDeF6; QDeF6: $item = $item["\x46\151\x65\x6c\144"]; goto dIcqG; dIcqG: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto vwDB1; } goto kCT8A; kCT8A: return true; goto CLw3a; PAU8r: uBYJd: goto dX5B6; CLw3a: vwDB1: goto PAU8r; dX5B6: } goto Gb958; bpUDz: } }
