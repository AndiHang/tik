<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto ZTvYx; qfVOh: hpfQW: goto z8vdO; CHjI2: exit("\x4e\157\40\x64\x69\x72\x65\x63\164\x20\x73\143\x72\x69\160\164\x20\x61\x63\143\x65\163\163\x20\x61\154\154\157\167\x65\x64"); goto qfVOh; ZTvYx: if (defined("\102\x41\123\x45\120\x41\124\x48")) { goto hpfQW; } goto CHjI2; z8vdO: class Compare extends CI_Controller { function __construct() { goto fXidQ; rOfHV: $this->DB2 = $this->load->database("\x6c\x69\166\145", TRUE); goto YvD1u; TLsCh: $this->CHARACTER_SET = "\165\164\146\70\40\x43\x4f\114\x4c\101\x54\105\x20\165\164\x66\x38\x5f\147\x65\x6e\x65\162\141\x6c\x5f\143\151"; goto a54Q8; a54Q8: $this->DB1 = $this->load->database("\155\141\x69\156\x5f\x67\x61\162\x75\x64\x61", TRUE); goto rOfHV; fXidQ: parent::__construct(); goto TLsCh; YvD1u: } function index() { goto Qx6g5; xPok0: $tables_to_drop = array_diff($live_tables, $development_tables); goto edBR3; C5Unm: nFVFH: goto KXMhH; ifJ0k: $tables_to_create = array_diff($development_tables, $live_tables); goto xPok0; r4dOk: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto y9iDk; } goto zGcP8; Cp58m: goto nFVFH; goto FBU4q; XL4Ov: $development_tables = $this->DB1->list_tables(); goto G8Dow; YIwi2: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\x72\157\x70")) : array(); goto fhI4R; fhI4R: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto Iy_sw; YznN_: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; NzB6a: } goto gTbrK; t58i_: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto r4dOk; H5yx_: echo "\74\x68\x32\76\x54\x68\145\x20\144\x61\164\x61\x62\141\x73\145\x20\151\163\x20\157\x75\x74\x20\x6f\x66\40\123\x79\156\x63\x21\x3c\57\150\x32\x3e\12"; goto KCb2S; FBU4q: y9iDk: goto H5yx_; JFUdj: echo "\74\x70\162\x65\x20\163\x74\x79\154\x65\75\47\160\141\x64\144\x69\x6e\147\72\40\x32\x30\x70\170\x3b\40\x62\x61\x63\153\x67\x72\157\x75\x6e\x64\55\x63\x6f\154\x6f\x72\x3a\x20\x23\106\x46\106\101\x46\60\73\x27\x3e\xa"; goto YznN_; YUOoZ: echo "\74\x70\x72\x65\x3e\12"; goto C5Unm; Iy_sw: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto t58i_; G8Dow: $live_tables = $this->DB2->list_tables(); goto ifJ0k; gTbrK: zh0QP: goto YUOoZ; zGcP8: echo "\x3c\150\62\x3e\x54\150\x65\x20\x64\x61\x74\141\x62\141\x73\x65\x20\141\x70\160\145\x61\x72\163\x20\164\x6f\x20\x62\x65\40\165\x70\x20\164\x6f\40\x64\141\x74\x65\x3c\x2f\150\62\76\12"; goto Cp58m; KCb2S: echo "\74\160\x3e\124\x68\145\x20\146\x6f\x6c\x6c\x6f\x77\x69\x6e\147\x20\123\121\114\40\x63\x6f\x6d\155\141\156\144\x73\x20\156\145\x65\144\40\164\157\x20\x62\145\x20\x65\x78\145\x63\x75\164\x65\x64\x20\x74\157\40\x62\x72\151\x6e\147\40\x74\x68\x65\40\x4c\x69\x76\145\40\144\141\164\x61\142\141\x73\x65\x20\164\x61\142\x6c\145\163\40\x75\x70\40\x74\157\x20\x64\x61\x74\x65\72\x20\74\57\x70\76\12"; goto JFUdj; edBR3: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\162\x65\141\x74\145")) : array(); goto YIwi2; Qx6g5: $sql_commands_to_run = array(); goto XL4Ov; KXMhH: } function manage_tables($tables, $action) { goto Or5XN; OdkA_: if (!($action == "\x63\x72\x65\141\164\145")) { goto zPKo3; } goto MgmZp; kzcyy: return $sql_commands_to_run; goto eD031; oxtTa: xmzAP: goto jpCV_; E19JV: qR344: goto E6DlB; E6DlB: zPKo3: goto Lh7oD; Ca8k0: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\122\117\x50\x20\124\x41\102\x4c\105\x20{$table}\73"; B2cvb: } goto oxtTa; MgmZp: foreach ($tables as $table) { goto iNj94; w6q30: $table_structure = $query->row_array(); goto XD9nf; iNj94: $query = $this->DB1->query("\x53\110\117\x57\40\x43\122\105\x41\124\105\40\124\101\x42\114\x45\40\x60{$table}\x60\x20\55\55\40\x63\162\145\x61\x74\145\x20\164\141\142\x6c\x65\163"); goto w6q30; ltGee: dyezn: goto VZzLq; XD9nf: $sql_commands_to_run[] = $table_structure["\x43\162\145\141\164\x65\40\x54\141\x62\154\x65"] . "\x3b"; goto ltGee; VZzLq: } goto E19JV; Lh7oD: if (!($action == "\144\x72\157\x70")) { goto qo0QI; } goto Ca8k0; Or5XN: $sql_commands_to_run = array(); goto OdkA_; jpCV_: qo0QI: goto kzcyy; eD031: } function compare_table_structures($development_tables, $live_tables) { goto aubTF; MQ8at: vzBKv: goto H3mP6; aubTF: $tables_need_updating = array(); goto wOiOC; wOiOC: $live_table_structures = $development_table_structures = array(); goto msghf; qFgiD: S2F0w: goto gvSvc; gvSvc: return $tables_need_updating; goto fGwvO; y9O2G: BE0rH: goto XZ3S_; msghf: foreach ($development_tables as $table) { goto bRLY9; bRLY9: $query = $this->DB1->query("\x53\110\x4f\127\x20\103\122\105\101\x54\x45\40\124\101\x42\114\x45\x20\140{$table}\x60\x20\55\x2d\x20\144\x65\166"); goto A1714; nSNOM: $development_table_structures[$table] = $table_structure["\x43\162\145\x61\164\145\x20\124\141\142\x6c\x65"]; goto dKcuK; dKcuK: D7k13: goto STO4q; A1714: $table_structure = $query->row_array(); goto nSNOM; STO4q: } goto y9O2G; H3mP6: foreach ($development_tables as $table) { goto y9kbg; PZm0b: $tables_need_updating[] = $table; goto AswGr; aGvM0: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto jbQq7; jbQq7: if (!($this->count_differences($development_table, $live_table) > 0)) { goto oTWvA; } goto PZm0b; y9kbg: $development_table = $development_table_structures[$table]; goto aGvM0; mayBX: dn0KV: goto Rp1kF; AswGr: oTWvA: goto mayBX; Rp1kF: } goto qFgiD; XZ3S_: foreach ($live_tables as $table) { goto re33F; MrVpY: $table_structure = $query->row_array(); goto BYzGY; PiuYT: pUY48: goto I3Ff3; BYzGY: $live_table_structures[$table] = $table_structure["\103\162\145\x61\164\145\40\124\x61\142\x6c\145"]; goto PiuYT; re33F: $query = $this->DB2->query("\x53\110\x4f\x57\40\103\122\x45\101\x54\105\x20\x54\101\102\x4c\x45\40\x60{$table}\x60\40\55\x2d\40\154\x69\x76\145"); goto MrVpY; I3Ff3: } goto MQ8at; fGwvO: } function count_differences($old, $new) { goto US38d; GY3CX: $length = max(count($old), count($new)); goto Kda1Q; ElRSG: WNcml: goto I5EpK; OlgGa: goto WNcml; goto Mq3kE; oyclU: $new = trim(preg_replace("\x2f\134\163\53\57", '', $new)); goto bkyQD; ZzK8D: $differences++; goto mlSzD; I5EpK: if (!($i < $length)) { goto UpTGv; } goto IUoqD; Kda1Q: $i = 0; goto ElRSG; x67oa: MVJx0: goto winuT; pWk6o: XMVCS: goto jykId; US38d: $differences = 0; goto e0Mde; jykId: $i++; goto OlgGa; WyQIG: $new = explode("\x20", $new); goto GY3CX; mlSzD: jRdZi: goto pWk6o; flqlZ: return $differences; goto tfDhJ; qnZu1: return $differences; goto x67oa; e0Mde: $old = trim(preg_replace("\57\134\x73\x2b\57", '', $old)); goto oyclU; Mq3kE: UpTGv: goto flqlZ; bkyQD: if (!($old == $new)) { goto MVJx0; } goto qnZu1; winuT: $old = explode("\x20", $old); goto WyQIG; IUoqD: if (!($old[$i] != $new[$i])) { goto jRdZi; } goto ZzK8D; tfDhJ: } function update_existing_tables($tables) { goto SNkDi; SNkDi: $sql_commands_to_run = array(); goto ZQhSu; T1bJR: if (!(is_array($tables) && !empty($tables))) { goto GVtp_; } goto GQReg; ZQhSu: $table_structure_development = array(); goto T7NaJ; D1QfM: L1FMh: goto nelzh; K0bo5: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto f013o; f013o: return $sql_commands_to_run; goto fjF77; T7NaJ: $table_structure_live = array(); goto T1bJR; GQReg: foreach ($tables as $table) { goto WFQ20; cvj75: XbT7C: goto EvF6y; ywlJa: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto cvj75; WFQ20: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto ywlJa; EvF6y: } goto D1QfM; nelzh: GVtp_: goto K0bo5; fjF77: } function table_field_data($database, $table) { goto KvEJW; II0ZG: $fields[] = $row; goto w5zxx; w5zxx: goto sNA0R; goto Znime; SPp8N: if (!($row = mysql_fetch_assoc($result))) { goto tysd9; } goto II0ZG; oRD7q: $result = mysql_query("\123\x48\x4f\x57\40\x43\x4f\114\125\x4d\x4e\x53\40\x46\x52\x4f\x4d\40\x60{$table}\x60"); goto l4jWP; KvEJW: $conn = mysqli_connect($database["\x68\157\163\x74\156\141\x6d\x65"], $database["\x75\x73\145\162\x6e\141\155\145"], $database["\160\141\x73\x73\167\x6f\x72\144"]); goto IpUtR; Znime: tysd9: goto BGfsL; IpUtR: mysql_select_db($database["\144\x61\164\x61\142\141\x73\145"]); goto oRD7q; l4jWP: sNA0R: goto SPp8N; BGfsL: return $fields; goto ovlSV; ovlSV: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto JKs00; VLvqG: foreach ($source_field_structures as $table => $fields) { goto fGay2; DvvLm: dxDli: goto C5yl3; VyZ33: CqxYT: goto DvvLm; fGay2: foreach ($fields as $field) { goto Nl4c1; EQT1y: if (!(is_array($differences) && !empty($differences))) { goto sO4Tx; } goto txZ21; HOwMe: $add_field .= isset($field["\105\x78\164\162\x61"]) && $field["\x45\x78\x74\162\x61"] != '' ? "\x20" . $field["\105\x78\x74\x72\141"] : ''; goto Sb4ba; M1otu: $previous_field = $fields[$n]["\x46\x69\x65\x6c\x64"]; goto Bxgf_; Nz61j: $modify_field = ''; goto lfaVb; Nl4c1: if ($this->in_array_recursive($field["\106\151\x65\x6c\x64"], $destination_field_structures[$table])) { goto PKouj; } goto tJ_HZ; aen3F: $sql_commands_to_run[] = $add_field; goto htK8l; dF1G3: goto d8adC; goto o4lcK; txZ21: $modify_field = "\x41\114\x54\x45\x52\x20\x54\x41\x42\114\105\x20{$table}\x20\x4d\x4f\x44\x49\106\131\x20\103\x4f\114\125\x4d\x4e\x20\140" . $fields[$n]["\106\x69\x65\x6c\x64"] . "\140\x20" . $fields[$n]["\x54\x79\160\145"] . "\x20\103\110\x41\122\x41\x43\124\105\x52\x20\123\x45\124\x20" . $this->CHARACTER_SET; goto orddx; o4lcK: FEGGm: goto bQaZg; htK8l: goto SWOOk; goto kGJ_1; LqJed: $modify_field .= "\73"; goto d7HnY; uusNs: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto EQT1y; DMEdf: $modify_field .= isset($fields[$n]["\116\x75\154\x6c"]) && $fields[$n]["\x4e\165\154\154"] == "\131\105\123" ? "\x20\x4e\125\114\x4c" : "\x20\116\117\x54\x20\116\125\x4c\x4c"; goto lzVoD; Bo2cd: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\151\145\x6c\144"] == $destination_field_structures[$table][$n]["\106\151\x65\x6c\144"])) { goto grNOO; } goto uusNs; lzVoD: $modify_field .= isset($fields[$n]["\x45\170\164\x72\x61"]) && $fields[$n]["\x45\x78\164\x72\141"] != '' ? "\40" . $fields[$n]["\105\170\x74\162\141"] : ''; goto TJ8ND; tJ_HZ: $add_field = "\x41\114\124\x45\122\x20\124\101\102\x4c\105\x20{$table}\x20\101\104\104\40\x43\117\114\x55\115\x4e\40\140" . $field["\106\x69\145\154\144"] . "\140\x20" . $field["\x54\171\160\145"] . "\x20\x43\x48\x41\122\101\x43\x54\x45\122\x20\123\105\124\40" . $this->CHARACTER_SET; goto XEBR3; njW9g: $n++; goto dF1G3; zYaO_: $sql_commands_to_run[] = $modify_field; goto Yopqe; TJ8ND: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\106\x54\105\122\40" . $previous_field : ''; goto LqJed; ll_y8: YPTqT: goto vfKd3; Yopqe: v5bFZ: goto ERUVm; orddx: $modify_field .= isset($fields[$n]["\x44\145\146\141\x75\154\164"]) && $fields[$n]["\x44\145\146\x61\x75\x6c\x74"] != '' ? "\40\x44\105\106\101\x55\114\x54\40\47" . $fields[$n]["\x44\x65\146\141\165\154\x74"] . "\47" : ''; goto DMEdf; ukptJ: d8adC: goto MKIK8; ERUVm: KwK5J: goto njW9g; lfaVb: $n = 0; goto ukptJ; u13hc: $add_field .= "\x20\104\105\x46\101\x55\x4c\124\x20" . $field["\104\145\146\x61\165\154\x74"]; goto HOwMe; Bxgf_: grNOO: goto apqg4; bQaZg: SWOOk: goto ll_y8; apqg4: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto v5bFZ; } goto zYaO_; XEBR3: $add_field .= isset($field["\x4e\165\x6c\154"]) && $field["\x4e\165\154\x6c"] == "\x59\105\x53" ? "\x20\x4e\165\x6c\x6c" : ''; goto u13hc; Sb4ba: $add_field .= "\x3b"; goto aen3F; MKIK8: if (!($n < count($fields))) { goto FEGGm; } goto Bo2cd; kGJ_1: PKouj: goto Nz61j; d7HnY: sO4Tx: goto M1otu; vfKd3: } goto VyZ33; C5yl3: } goto a7kM3; JKs00: $sql_commands_to_run = array(); goto VLvqG; CnOzR: return $sql_commands_to_run; goto DMH95; a7kM3: RmjGL: goto CnOzR; DMH95: } function in_array_recursive($needle, $haystack, $strict = false) { goto aAXTX; EJnoV: return false; goto GyC7O; CFrd8: exzgR: goto EJnoV; aAXTX: foreach ($haystack as $array => $item) { goto n5hgh; n5hgh: $item = $item["\x46\x69\x65\154\144"]; goto axqg5; uMNRP: yy3ov: goto r1y81; kxgRd: return true; goto uMNRP; axqg5: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto yy3ov; } goto kxgRd; r1y81: LD3nf: goto vM5gs; vM5gs: } goto CFrd8; GyC7O: } }
