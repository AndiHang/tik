<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto mMwHM; B93gn: exit("\116\x6f\40\144\151\162\145\143\x74\40\163\x63\x72\x69\x70\x74\40\x61\x63\x63\x65\163\x73\40\141\x6c\x6c\x6f\167\x65\x64"); goto Tfync; Tfync: wgvcX: goto ixL37; mMwHM: if (defined("\x42\101\x53\105\120\101\124\110")) { goto wgvcX; } goto B93gn; ixL37: class Compare extends CI_Controller { function __construct() { goto AlzFT; dwFzV: $this->DB2 = $this->load->database("\154\x69\166\145", TRUE); goto W4hsH; FzfZ3: $this->CHARACTER_SET = "\165\164\146\70\40\x43\x4f\114\114\x41\124\x45\40\x75\x74\146\70\137\x67\145\x6e\145\162\x61\x6c\x5f\143\x69"; goto xiv6F; xiv6F: $this->DB1 = $this->load->database("\x6d\141\151\156\137\147\x61\162\165\144\141", TRUE); goto dwFzV; AlzFT: parent::__construct(); goto FzfZ3; W4hsH: } function index() { goto L1uo3; UI38f: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto VfIue; L1uo3: $sql_commands_to_run = array(); goto mPnEK; bqLVi: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto UI38f; HkzFi: fP1gh: goto ahDUl; Dg8aY: goto oDA9p; goto HkzFi; QGoiH: oDA9p: goto LUglb; N157Z: echo "\74\160\x72\x65\76\xa"; goto QGoiH; xzZJJ: $tables_to_drop = array_diff($live_tables, $development_tables); goto T97Br; GaGOl: $tables_to_create = array_diff($development_tables, $live_tables); goto xzZJJ; lc37j: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; jzRRn: } goto ltgH5; mPnEK: $development_tables = $this->DB1->list_tables(); goto Sor0F; ahDUl: echo "\74\x68\x32\76\x54\150\145\x20\144\141\164\141\142\x61\163\145\40\x69\x73\x20\x6f\x75\x74\x20\x6f\x66\x20\x53\x79\156\x63\41\x3c\57\150\x32\x3e\xa"; goto b3Paf; b3Paf: echo "\x3c\x70\x3e\124\150\145\40\x66\x6f\154\154\x6f\167\151\156\x67\x20\x53\x51\114\x20\x63\157\x6d\155\141\156\x64\x73\x20\156\145\x65\144\40\164\x6f\40\142\145\40\145\x78\145\143\165\164\145\144\x20\164\x6f\40\142\x72\151\x6e\147\40\x74\x68\145\x20\114\x69\x76\145\40\144\x61\164\x61\142\141\163\x65\x20\x74\x61\x62\154\145\x73\40\x75\x70\x20\164\x6f\x20\x64\141\164\145\72\x20\x3c\57\160\76\12"; goto SfiRm; bs2U8: echo "\x3c\x68\x32\x3e\x54\150\x65\40\x64\141\x74\x61\142\141\x73\145\40\141\160\160\145\x61\x72\x73\40\164\x6f\40\x62\145\40\x75\x70\40\x74\x6f\40\x64\141\164\x65\74\x2f\150\62\x3e\xa"; goto Dg8aY; ltgH5: liGRq: goto N157Z; Z3ybB: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto bqLVi; T97Br: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\x61\x74\145")) : array(); goto a3ntj; a3ntj: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\162\x6f\160")) : array(); goto Z3ybB; VfIue: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto fP1gh; } goto bs2U8; Sor0F: $live_tables = $this->DB2->list_tables(); goto GaGOl; SfiRm: echo "\x3c\x70\x72\x65\40\x73\x74\171\154\x65\75\x27\160\141\x64\144\x69\x6e\x67\72\40\x32\x30\x70\170\73\x20\x62\141\143\x6b\x67\x72\x6f\x75\156\x64\x2d\143\157\x6c\157\162\72\40\x23\106\106\x46\101\106\60\73\47\76\12"; goto lc37j; LUglb: } function manage_tables($tables, $action) { goto SeD1l; PKmlP: yB3Ir: goto YtgTl; cwq3L: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\x52\117\x50\x20\x54\101\x42\114\x45\40{$table}\x3b"; IQ4Nk: } goto qqcnQ; wKSz4: d723w: goto PKmlP; YtgTl: if (!($action == "\x64\x72\157\x70")) { goto Ltoa3; } goto cwq3L; TK5Ig: Ltoa3: goto tYRjh; tYRjh: return $sql_commands_to_run; goto aq613; xybsU: if (!($action == "\143\x72\145\141\164\x65")) { goto yB3Ir; } goto q5EJ9; qqcnQ: lhd8e: goto TK5Ig; q5EJ9: foreach ($tables as $table) { goto cRXbx; N9Enx: $table_structure = $query->row_array(); goto BN1OM; cRXbx: $query = $this->DB1->query("\x53\110\117\x57\x20\103\x52\x45\101\124\x45\40\x54\101\x42\114\x45\x20\140{$table}\140\x20\x2d\x2d\40\x63\162\145\x61\164\145\x20\x74\141\142\154\145\163"); goto N9Enx; BN1OM: $sql_commands_to_run[] = $table_structure["\103\162\x65\141\x74\x65\x20\x54\141\x62\154\145"] . "\73"; goto BN3Wc; BN3Wc: OLdML: goto F10y2; F10y2: } goto wKSz4; SeD1l: $sql_commands_to_run = array(); goto xybsU; aq613: } function compare_table_structures($development_tables, $live_tables) { goto jfsUq; DZVvG: y2ZtO: goto WVVYt; tl_3w: foreach ($development_tables as $table) { goto zKCS4; zKCS4: $query = $this->DB1->query("\x53\110\x4f\x57\40\x43\122\105\101\124\105\x20\124\x41\x42\114\105\x20\x60{$table}\x60\x20\55\55\40\x64\145\x76"); goto t0kWn; t0kWn: $table_structure = $query->row_array(); goto uSX9y; vv6ru: dgIGF: goto kL19H; uSX9y: $development_table_structures[$table] = $table_structure["\x43\x72\x65\141\164\x65\40\x54\141\x62\x6c\145"]; goto vv6ru; kL19H: } goto DZVvG; Mt2PY: $live_table_structures = $development_table_structures = array(); goto tl_3w; jfsUq: $tables_need_updating = array(); goto Mt2PY; WVVYt: foreach ($live_tables as $table) { goto tLsR0; i89ot: jzjb9: goto caC9T; tLsR0: $query = $this->DB2->query("\123\x48\x4f\127\x20\103\x52\x45\101\x54\x45\x20\x54\x41\102\x4c\x45\x20\140{$table}\140\40\x2d\55\40\154\x69\x76\x65"); goto vj8PR; vj8PR: $table_structure = $query->row_array(); goto OeU9A; OeU9A: $live_table_structures[$table] = $table_structure["\x43\162\145\x61\164\x65\x20\x54\141\x62\x6c\x65"]; goto i89ot; caC9T: } goto SteKK; depUn: foreach ($development_tables as $table) { goto WM2oh; WM2oh: $development_table = $development_table_structures[$table]; goto F3y3O; ShbtM: $tables_need_updating[] = $table; goto tRkMW; wLp1k: WJM4k: goto uenZD; tRkMW: KqEct: goto wLp1k; RB24J: if (!($this->count_differences($development_table, $live_table) > 0)) { goto KqEct; } goto ShbtM; F3y3O: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto RB24J; uenZD: } goto UH_A8; UH_A8: iOZ3k: goto uqklX; uqklX: return $tables_need_updating; goto lZvi9; SteKK: Co258: goto depUn; lZvi9: } function count_differences($old, $new) { goto U8rHR; o4rsT: if (!($i < $length)) { goto BOMBb; } goto qsGSl; CA5cE: $new = explode("\40", $new); goto X8dYr; DUi2O: $differences++; goto yVotB; PmTYP: $old = trim(preg_replace("\x2f\x5c\x73\x2b\57", '', $old)); goto Utpy5; OttxP: return $differences; goto D12sE; jHZmr: $i++; goto BpyUi; X8dYr: $length = max(count($old), count($new)); goto Vc0L9; qsGSl: if (!($old[$i] != $new[$i])) { goto J04vu; } goto DUi2O; vFI5l: return $differences; goto JWDzI; sJYSN: $old = explode("\x20", $old); goto CA5cE; U8rHR: $differences = 0; goto PmTYP; R49zq: PSvxt: goto o4rsT; Vc0L9: $i = 0; goto R49zq; Qcss9: LFyz5: goto jHZmr; yVotB: J04vu: goto Qcss9; vMHKi: if (!($old == $new)) { goto kYWW2; } goto vFI5l; JWDzI: kYWW2: goto sJYSN; BpyUi: goto PSvxt; goto t0weW; t0weW: BOMBb: goto OttxP; Utpy5: $new = trim(preg_replace("\57\134\x73\x2b\x2f", '', $new)); goto vMHKi; D12sE: } function update_existing_tables($tables) { goto kpwHW; tIw7T: $table_structure_development = array(); goto eeTd8; gLEFt: return $sql_commands_to_run; goto AF85B; sbenO: if (!(is_array($tables) && !empty($tables))) { goto qbBqn; } goto jA4bI; jA4bI: foreach ($tables as $table) { goto q4qB7; q4qB7: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto abRYy; abRYy: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto XVhmV; XVhmV: sqTDX: goto Rs6Ne; Rs6Ne: } goto aEVRq; aEVRq: H9qgJ: goto NdYB4; kpwHW: $sql_commands_to_run = array(); goto tIw7T; eeTd8: $table_structure_live = array(); goto sbenO; NdYB4: qbBqn: goto OQy25; OQy25: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto gLEFt; AF85B: } function table_field_data($database, $table) { goto VEIqG; rJw0M: return $fields; goto PG_de; cAHKf: mysql_select_db($database["\144\x61\164\x61\142\141\163\145"]); goto BCz1t; RbSEX: $fields[] = $row; goto XK4pO; jBpFD: F0Pwk: goto dH3Gd; Dqc4C: KCT_o: goto rJw0M; dH3Gd: if (!($row = mysql_fetch_assoc($result))) { goto KCT_o; } goto RbSEX; XK4pO: goto F0Pwk; goto Dqc4C; BCz1t: $result = mysql_query("\x53\110\117\x57\40\x43\117\x4c\x55\x4d\116\x53\40\106\x52\117\115\40\140{$table}\x60"); goto jBpFD; VEIqG: $conn = mysqli_connect($database["\150\x6f\163\x74\156\x61\x6d\x65"], $database["\x75\x73\145\162\156\x61\x6d\145"], $database["\160\x61\163\x73\x77\157\x72\x64"]); goto cAHKf; PG_de: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto Gb0Q8; vuinl: return $sql_commands_to_run; goto fT4ft; Gb0Q8: $sql_commands_to_run = array(); goto Bfv64; Bfv64: foreach ($source_field_structures as $table => $fields) { goto aZ1po; k2lgV: h2Rfz: goto Vobre; MAmWF: HMVBi: goto k2lgV; aZ1po: foreach ($fields as $field) { goto ANY2G; H5iDv: $modify_field .= isset($fields[$n]["\x4e\x75\154\x6c"]) && $fields[$n]["\116\x75\x6c\x6c"] == "\131\105\x53" ? "\x20\x4e\125\114\114" : "\40\x4e\x4f\124\40\x4e\x55\114\x4c"; goto gCzQs; S_RTV: $add_field .= isset($field["\105\170\164\162\x61"]) && $field["\105\170\164\162\141"] != '' ? "\x20" . $field["\105\x78\164\162\141"] : ''; goto KUgIM; IrkOM: $sql_commands_to_run[] = $modify_field; goto MdUgX; osCIm: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto MuJwo; gCzQs: $modify_field .= isset($fields[$n]["\105\x78\x74\162\x61"]) && $fields[$n]["\105\170\x74\x72\x61"] != '' ? "\x20" . $fields[$n]["\x45\x78\x74\x72\141"] : ''; goto ZHkZT; uR6qO: wY77M: goto Xnr2m; e3J3V: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\x69\145\x6c\x64"] == $destination_field_structures[$table][$n]["\x46\x69\x65\154\x64"])) { goto wY77M; } goto osCIm; sW6GB: CMKCo: goto JsKI1; HjvEP: i_D2K: goto Z2WYs; z2q5U: goto kZ9ul; goto HjvEP; qf0LE: X0h2w: goto HmTrN; ZHkZT: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\101\x46\x54\105\122\x20" . $previous_field : ''; goto rR3NP; bvvLq: goto aOSn_; goto sW6GB; rR3NP: $modify_field .= "\73"; goto y3890; MuJwo: if (!(is_array($differences) && !empty($differences))) { goto i4jiv; } goto IbJ74; LFxT2: if (!($n < count($fields))) { goto i_D2K; } goto e3J3V; YTpV6: bp1QB: goto COCpQ; DXd_c: $add_field .= isset($field["\116\165\x6c\154"]) && $field["\x4e\x75\154\x6c"] == "\x59\105\x53" ? "\x20\x4e\165\154\154" : ''; goto YC1II; y3890: i4jiv: goto tQyU3; KUgIM: $add_field .= "\x3b"; goto mATFS; Z2WYs: aOSn_: goto qf0LE; MdUgX: pHsag: goto YTpV6; YC1II: $add_field .= "\x20\104\105\106\101\125\114\x54\40" . $field["\x44\x65\146\x61\x75\154\x74"]; goto S_RTV; Xnr2m: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto pHsag; } goto IrkOM; mATFS: $sql_commands_to_run[] = $add_field; goto bvvLq; IbJ74: $modify_field = "\101\114\124\105\122\40\x54\101\102\114\105\40{$table}\40\115\117\104\x49\x46\x59\x20\103\x4f\x4c\x55\x4d\116\40\140" . $fields[$n]["\x46\x69\x65\154\144"] . "\140\40" . $fields[$n]["\124\171\x70\x65"] . "\x20\103\x48\101\x52\x41\103\x54\105\x52\x20\x53\105\124\40" . $this->CHARACTER_SET; goto QOL16; QOL16: $modify_field .= isset($fields[$n]["\x44\x65\146\x61\x75\x6c\x74"]) && $fields[$n]["\104\x65\146\x61\165\x6c\x74"] != '' ? "\40\x44\x45\x46\x41\x55\114\124\x20\x27" . $fields[$n]["\x44\145\x66\x61\165\154\164"] . "\x27" : ''; goto H5iDv; ANY2G: if ($this->in_array_recursive($field["\106\151\145\154\x64"], $destination_field_structures[$table])) { goto CMKCo; } goto Bo4Se; COCpQ: $n++; goto z2q5U; Bo4Se: $add_field = "\x41\114\124\105\x52\40\124\x41\102\114\105\x20{$table}\x20\101\104\x44\x20\x43\x4f\x4c\x55\115\116\x20\140" . $field["\x46\x69\145\154\144"] . "\140\x20" . $field["\124\x79\x70\145"] . "\x20\x43\x48\101\122\101\x43\x54\105\x52\x20\x53\x45\x54\x20" . $this->CHARACTER_SET; goto DXd_c; tQyU3: $previous_field = $fields[$n]["\106\x69\x65\x6c\144"]; goto uR6qO; hfniO: kZ9ul: goto LFxT2; JsKI1: $modify_field = ''; goto rkqkx; rkqkx: $n = 0; goto hfniO; HmTrN: } goto MAmWF; Vobre: } goto tdKve; tdKve: gJDY2: goto vuinl; fT4ft: } function in_array_recursive($needle, $haystack, $strict = false) { goto gRAcI; vOKc7: return false; goto TqHPe; gRAcI: foreach ($haystack as $array => $item) { goto vegnS; LMB6y: y5e3g: goto NfKjM; B4YFt: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto y5e3g; } goto e2dsT; vegnS: $item = $item["\106\151\145\x6c\144"]; goto B4YFt; e2dsT: return true; goto LMB6y; NfKjM: EjGxe: goto mpstg; mpstg: } goto fFD3I; fFD3I: xaGkN: goto vOKc7; TqHPe: } }
