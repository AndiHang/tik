<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto OUU5Q; sJEb9: AoZtn: goto WYa5T; qxhi3: exit("\x4e\x6f\40\x64\151\x72\x65\143\x74\x20\x73\x63\162\x69\x70\x74\40\141\143\143\x65\163\x73\x20\141\154\154\x6f\x77\x65\x64"); goto sJEb9; OUU5Q: if (defined("\102\101\123\x45\120\x41\x54\110")) { goto AoZtn; } goto qxhi3; WYa5T: class Compare extends CI_Controller { function __construct() { goto mLAiT; gOYtj: $this->CHARACTER_SET = "\165\x74\146\x38\x20\103\x4f\114\x4c\101\x54\x45\40\x75\x74\x66\x38\137\x67\x65\156\x65\x72\x61\x6c\137\143\151"; goto Gwk8g; Gwk8g: $this->DB1 = $this->load->database("\155\x61\151\156\x5f\147\141\x72\165\144\x61", TRUE); goto ml_wp; mLAiT: parent::__construct(); goto gOYtj; ml_wp: $this->DB2 = $this->load->database("\154\151\166\x65", TRUE); goto Yn5pc; Yn5pc: } function index() { goto d9NoK; YEkOq: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto WPmQ3; WPmQ3: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto hUjgs; VbLG1: pMkDi: goto SH3f2; D7qWX: echo "\74\x70\x72\x65\x20\x73\164\x79\x6c\x65\x3d\47\160\141\x64\144\151\156\x67\72\x20\62\60\160\x78\73\x20\142\x61\x63\x6b\x67\162\x6f\x75\156\144\x2d\143\157\x6c\157\x72\x3a\x20\x23\106\x46\x46\101\106\x30\73\x27\x3e\xa"; goto jadiR; ekqf4: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto PxVYe; } goto xQMSz; d9NoK: $sql_commands_to_run = array(); goto ZHF7m; ZHF7m: $development_tables = $this->DB1->list_tables(); goto U6xxM; s69zX: Q3dDC: goto znZV2; hUjgs: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto ekqf4; U6xxM: $live_tables = $this->DB2->list_tables(); goto YAq11; gPxpq: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\x72\x65\141\x74\x65")) : array(); goto CcwJQ; jadiR: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; sIFgg: } goto s69zX; xQMSz: echo "\74\x68\62\76\x54\x68\145\40\x64\141\164\x61\142\x61\x73\x65\x20\141\160\x70\145\141\x72\163\x20\164\x6f\x20\x62\145\40\x75\160\x20\164\157\40\144\141\164\x65\x3c\x2f\150\x32\76\xa"; goto yCo1M; YAq11: $tables_to_create = array_diff($development_tables, $live_tables); goto KZQ4T; znZV2: echo "\74\160\x72\x65\76\12"; goto VbLG1; aPa52: PxVYe: goto ipfOI; yCo1M: goto pMkDi; goto aPa52; CcwJQ: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\162\x6f\x70")) : array(); goto YEkOq; Gb4RQ: echo "\74\x70\x3e\124\150\145\40\x66\x6f\154\x6c\x6f\x77\151\156\x67\40\x53\x51\114\40\143\157\x6d\x6d\x61\x6e\x64\x73\40\156\x65\145\x64\40\x74\x6f\40\142\145\40\x65\x78\x65\143\165\164\x65\x64\40\x74\157\40\x62\x72\x69\x6e\147\40\164\x68\145\x20\x4c\x69\x76\x65\40\x64\141\164\x61\x62\141\x73\145\x20\x74\141\142\x6c\145\x73\40\x75\x70\40\x74\x6f\x20\144\141\164\145\72\40\74\x2f\160\76\xa"; goto D7qWX; KZQ4T: $tables_to_drop = array_diff($live_tables, $development_tables); goto gPxpq; ipfOI: echo "\74\x68\x32\x3e\124\x68\145\x20\x64\141\x74\x61\142\141\x73\145\40\151\163\x20\157\165\x74\40\x6f\146\x20\123\x79\156\x63\x21\74\57\150\x32\x3e\12"; goto Gb4RQ; SH3f2: } function manage_tables($tables, $action) { goto gO0dJ; U5ekb: return $sql_commands_to_run; goto d2CbF; lCzC7: if (!($action == "\x63\162\x65\141\164\x65")) { goto GiyO3; } goto HnqaV; HnqaV: foreach ($tables as $table) { goto m1xAn; QEN00: oo9Ko: goto P3mDS; m1xAn: $query = $this->DB1->query("\x53\110\x4f\x57\x20\103\x52\x45\101\x54\105\x20\x54\x41\102\x4c\x45\x20\140{$table}\140\40\55\55\x20\x63\x72\x65\x61\164\145\x20\x74\x61\x62\154\x65\x73"); goto Ksvuy; nh80F: $sql_commands_to_run[] = $table_structure["\x43\x72\145\141\164\145\x20\124\x61\142\154\145"] . "\73"; goto QEN00; Ksvuy: $table_structure = $query->row_array(); goto nh80F; P3mDS: } goto tNFyf; lLFFv: P0XkG: goto QD_VV; zPVH_: if (!($action == "\144\162\x6f\160")) { goto H5FpY; } goto pmvVD; QD_VV: H5FpY: goto U5ekb; pmvVD: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\x52\117\120\40\x54\x41\102\x4c\105\40{$table}\73"; wS23u: } goto lLFFv; s0OmI: GiyO3: goto zPVH_; gO0dJ: $sql_commands_to_run = array(); goto lCzC7; tNFyf: aCYQf: goto s0OmI; d2CbF: } function compare_table_structures($development_tables, $live_tables) { goto KANqu; P81w8: return $tables_need_updating; goto r2PgM; P12Hs: WxAF2: goto P81w8; ARvIW: foreach ($live_tables as $table) { goto nrTR6; YLQWb: $live_table_structures[$table] = $table_structure["\x43\162\145\x61\164\x65\x20\124\141\142\154\x65"]; goto hT5T8; RcR9B: $table_structure = $query->row_array(); goto YLQWb; hT5T8: oXvsM: goto NrHMk; nrTR6: $query = $this->DB2->query("\x53\x48\117\x57\40\103\x52\105\x41\x54\x45\x20\124\x41\102\114\105\x20\x60{$table}\x60\x20\x2d\55\40\154\151\166\x65"); goto RcR9B; NrHMk: } goto kecY1; GABbG: foreach ($development_tables as $table) { goto NpIec; NpIec: $query = $this->DB1->query("\x53\110\x4f\x57\40\103\x52\x45\x41\x54\105\40\124\101\x42\114\105\40\140{$table}\x60\40\x2d\55\40\144\145\166"); goto CCg4z; fV1Ux: tF61A: goto FtjAX; CCg4z: $table_structure = $query->row_array(); goto OiAyU; OiAyU: $development_table_structures[$table] = $table_structure["\103\162\145\141\x74\145\x20\124\x61\142\154\x65"]; goto fV1Ux; FtjAX: } goto CejDk; CejDk: AKpSZ: goto ARvIW; KANqu: $tables_need_updating = array(); goto AQdrz; kecY1: liniQ: goto gYWCK; AQdrz: $live_table_structures = $development_table_structures = array(); goto GABbG; gYWCK: foreach ($development_tables as $table) { goto F7mSy; Y3q3p: KIWoP: goto b5iBq; F7mSy: $development_table = $development_table_structures[$table]; goto dOVZB; dOVZB: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto cRJSn; JKSML: $tables_need_updating[] = $table; goto vv35q; cRJSn: if (!($this->count_differences($development_table, $live_table) > 0)) { goto MOAV8; } goto JKSML; vv35q: MOAV8: goto Y3q3p; b5iBq: } goto P12Hs; r2PgM: } function count_differences($old, $new) { goto QJW5O; J28Kb: $length = max(count($old), count($new)); goto GKhwm; GKhwm: $i = 0; goto AEmn3; CjGHM: goto H2ZFu; goto Nqynw; a299g: $new = trim(preg_replace("\x2f\x5c\163\53\x2f", '', $new)); goto l9DsA; zskES: $new = explode("\x20", $new); goto J28Kb; ddDRS: S3GFT: goto EigdJ; QJW5O: $differences = 0; goto SU9iH; l9DsA: if (!($old == $new)) { goto S3GFT; } goto Ev8Fa; NuOK4: return $differences; goto D74Qt; KTOnw: if (!($old[$i] != $new[$i])) { goto T8kkB; } goto J7ng5; Ev8Fa: return $differences; goto ddDRS; PImnM: $i++; goto CjGHM; gUGJq: giytc: goto PImnM; Nqynw: pR1Eg: goto NuOK4; EigdJ: $old = explode("\x20", $old); goto zskES; M0m5G: T8kkB: goto gUGJq; J7ng5: $differences++; goto M0m5G; AEmn3: H2ZFu: goto i6KJ8; i6KJ8: if (!($i < $length)) { goto pR1Eg; } goto KTOnw; SU9iH: $old = trim(preg_replace("\57\x5c\163\53\x2f", '', $old)); goto a299g; D74Qt: } function update_existing_tables($tables) { goto id_qa; id_qa: $sql_commands_to_run = array(); goto wx_mg; ZMyv_: return $sql_commands_to_run; goto CCBOq; ppwQG: if (!(is_array($tables) && !empty($tables))) { goto RcLSZ; } goto a7kxt; ca5gN: $table_structure_live = array(); goto ppwQG; RqWjW: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto ZMyv_; FBQcI: RcLSZ: goto RqWjW; a7kxt: foreach ($tables as $table) { goto zy1Sb; AjpS1: bToBe: goto LFGvG; IejBL: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto AjpS1; zy1Sb: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto IejBL; LFGvG: } goto T2nvW; wx_mg: $table_structure_development = array(); goto ca5gN; T2nvW: vtWtq: goto FBQcI; CCBOq: } function table_field_data($database, $table) { goto aT76D; HczRu: $fields[] = $row; goto a1ub7; wuj_q: if (!($row = mysql_fetch_assoc($result))) { goto RNZm0; } goto HczRu; x7j1U: fAoLq: goto wuj_q; szrHa: $result = mysql_query("\123\x48\x4f\127\40\103\117\x4c\x55\x4d\x4e\x53\x20\x46\x52\x4f\x4d\x20\x60{$table}\x60"); goto x7j1U; Axnjp: mysql_select_db($database["\x64\x61\164\141\142\x61\x73\x65"]); goto szrHa; a1ub7: goto fAoLq; goto OIUab; yGF7F: return $fields; goto SyHv6; OIUab: RNZm0: goto yGF7F; aT76D: $conn = mysqli_connect($database["\150\157\x73\x74\156\141\155\x65"], $database["\x75\x73\145\x72\x6e\x61\x6d\145"], $database["\x70\141\163\163\167\x6f\162\x64"]); goto Axnjp; SyHv6: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto wCwV6; kiRDp: foreach ($source_field_structures as $table => $fields) { goto eyo1I; JDiHx: awCzW: goto si4vf; eyo1I: foreach ($fields as $field) { goto mE53L; FGljo: X2Q65: goto zasEE; NypAv: jKHIy: goto kfSUe; xsg7J: $sql_commands_to_run[] = $modify_field; goto T8K51; vEtbx: $add_field .= "\73"; goto f1TFK; tPNGX: NhDEv: goto alq4r; wKDSN: $add_field .= isset($field["\105\170\164\162\x61"]) && $field["\x45\170\164\x72\x61"] != '' ? "\x20" . $field["\105\x78\x74\162\x61"] : ''; goto vEtbx; Wp3hX: $add_field .= "\x20\104\105\106\x41\125\x4c\x54\40" . $field["\x44\145\x66\x61\165\154\x74"]; goto wKDSN; LZrl6: if (!(is_array($differences) && !empty($differences))) { goto jKHIy; } goto hscdw; ruWjY: y_K6B: goto frJtK; T94TL: $modify_field .= isset($fields[$n]["\104\x65\x66\141\165\154\x74"]) && $fields[$n]["\104\145\x66\x61\165\154\164"] != '' ? "\x20\104\105\x46\101\125\x4c\x54\40\47" . $fields[$n]["\104\x65\x66\x61\165\x6c\x74"] . "\47" : ''; goto NMAat; Om6a_: $modify_field .= isset($fields[$n]["\x45\x78\164\162\141"]) && $fields[$n]["\x45\x78\164\162\141"] != '' ? "\x20" . $fields[$n]["\105\170\164\162\141"] : ''; goto RjvME; yELIQ: OFVNM: goto yl6Hn; T8K51: uGdxx: goto yELIQ; BHXVz: goto cS0pP; goto kt__7; zasEE: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto uGdxx; } goto xsg7J; NiGpL: cS0pP: goto RmmiY; f1TFK: $sql_commands_to_run[] = $add_field; goto LH9pI; RBd1U: aDpXZ: goto ruWjY; yl6Hn: $n++; goto BHXVz; kt__7: esG6B: goto RBd1U; RmmiY: if (!($n < count($fields))) { goto esG6B; } goto pTC2e; kfSUe: $previous_field = $fields[$n]["\106\151\145\154\x64"]; goto FGljo; Z28t8: $modify_field .= "\x3b"; goto NypAv; RjvME: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\x41\106\124\x45\122\40" . $previous_field : ''; goto Z28t8; mE53L: if ($this->in_array_recursive($field["\x46\x69\145\x6c\144"], $destination_field_structures[$table])) { goto NhDEv; } goto i4Ktz; i4Ktz: $add_field = "\101\x4c\124\x45\x52\40\124\101\102\x4c\105\40{$table}\x20\x41\104\104\x20\103\117\114\125\115\x4e\x20\140" . $field["\106\151\x65\154\144"] . "\x60\40" . $field["\124\171\x70\145"] . "\40\103\x48\x41\x52\x41\103\x54\105\x52\x20\123\x45\124\40" . $this->CHARACTER_SET; goto smKbs; NMAat: $modify_field .= isset($fields[$n]["\116\165\x6c\x6c"]) && $fields[$n]["\116\165\x6c\x6c"] == "\x59\x45\123" ? "\40\116\x55\114\114" : "\40\x4e\x4f\124\40\116\x55\x4c\x4c"; goto Om6a_; smKbs: $add_field .= isset($field["\116\x75\x6c\x6c"]) && $field["\116\165\x6c\154"] == "\x59\105\123" ? "\x20\116\x75\x6c\x6c" : ''; goto Wp3hX; eGTKi: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto LZrl6; H_FjK: $n = 0; goto NiGpL; hscdw: $modify_field = "\101\x4c\x54\x45\x52\40\x54\101\x42\114\x45\40{$table}\x20\115\117\104\111\x46\131\x20\103\x4f\x4c\125\115\116\40\x60" . $fields[$n]["\106\151\145\154\144"] . "\140\40" . $fields[$n]["\x54\x79\160\x65"] . "\40\103\110\101\x52\x41\x43\124\x45\x52\x20\x53\x45\124\40" . $this->CHARACTER_SET; goto T94TL; LH9pI: goto aDpXZ; goto tPNGX; pTC2e: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\145\x6c\x64"] == $destination_field_structures[$table][$n]["\x46\151\145\x6c\144"])) { goto X2Q65; } goto eGTKi; alq4r: $modify_field = ''; goto H_FjK; frJtK: } goto JDiHx; si4vf: Ce5pv: goto W2FHL; W2FHL: } goto cMCXg; cMCXg: WLehP: goto uZ2Pm; wCwV6: $sql_commands_to_run = array(); goto kiRDp; uZ2Pm: return $sql_commands_to_run; goto porgD; porgD: } function in_array_recursive($needle, $haystack, $strict = false) { goto CAkkK; nu0V0: return false; goto M2mjR; lq7Rn: Ca7wO: goto nu0V0; CAkkK: foreach ($haystack as $array => $item) { goto Tfodi; bREPc: S9Nqc: goto dV_ht; Tfodi: $item = $item["\106\x69\x65\154\x64"]; goto VByBZ; xy8Es: return true; goto bREPc; dV_ht: hGmbB: goto k_oAh; VByBZ: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto S9Nqc; } goto xy8Es; k_oAh: } goto lq7Rn; M2mjR: } }
