<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto b5P4S; t3HSt: exit("\116\x6f\x20\x64\x69\162\x65\x63\164\40\163\143\x72\x69\x70\x74\40\141\x63\x63\145\x73\x73\x20\x61\154\x6c\157\x77\145\144"); goto l2RoT; b5P4S: if (defined("\x42\101\x53\105\120\x41\x54\x48")) { goto hitK2; } goto t3HSt; l2RoT: hitK2: goto M2Q5p; M2Q5p: class Compare extends CI_Controller { function __construct() { goto Bq0sM; Gy06i: $this->DB1 = $this->load->database("\x6d\x61\151\x6e\x5f\x67\x61\x72\x75\144\x61", TRUE); goto p5Ocj; p5Ocj: $this->DB2 = $this->load->database("\x6c\151\x76\x65", TRUE); goto alTxV; FC1O8: $this->CHARACTER_SET = "\165\x74\x66\x38\x20\x43\117\114\x4c\x41\124\x45\x20\165\164\146\70\x5f\147\x65\156\x65\x72\x61\154\x5f\143\x69"; goto Gy06i; Bq0sM: parent::__construct(); goto FC1O8; alTxV: } function index() { goto q21_D; K0yi8: UgiHB: goto l27D8; dfPqA: n4J0P: goto aGUda; q0YJu: echo "\74\160\x72\x65\x20\163\164\x79\x6c\145\x3d\47\x70\x61\144\144\x69\x6e\147\x3a\40\62\x30\x70\x78\x3b\40\x62\141\143\153\147\162\157\165\156\144\55\x63\157\x6c\x6f\162\x3a\40\x23\x46\106\x46\x41\x46\60\73\47\x3e\xa"; goto WO1NT; QDv01: echo "\x3c\x68\62\76\124\x68\x65\40\144\141\164\x61\x62\141\x73\x65\x20\x61\x70\x70\145\x61\x72\163\40\164\157\x20\x62\145\40\165\160\40\164\157\x20\x64\x61\x74\x65\74\57\150\x32\76\12"; goto kgcUP; GNkBu: echo "\74\x70\76\x54\150\x65\x20\146\157\x6c\x6c\157\x77\151\156\x67\40\x53\x51\114\40\143\157\x6d\155\141\x6e\144\163\40\156\x65\145\144\x20\164\157\x20\x62\x65\x20\x65\x78\145\143\165\164\x65\144\40\164\157\40\142\x72\151\x6e\x67\x20\x74\150\x65\x20\x4c\x69\166\x65\40\144\x61\x74\141\142\x61\x73\145\x20\164\141\x62\x6c\145\x73\40\x75\x70\40\x74\157\40\x64\141\x74\145\x3a\x20\74\57\x70\x3e\xa"; goto q0YJu; kgcUP: goto VlWho; goto dfPqA; yZoti: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\162\x6f\x70")) : array(); goto CUXLO; dafaG: $development_tables = $this->DB1->list_tables(); goto rpZoc; q21_D: $sql_commands_to_run = array(); goto dafaG; CUXLO: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto SQ8LQ; WO1NT: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; VRc4q: } goto K0yi8; rpZoc: $live_tables = $this->DB2->list_tables(); goto sVdal; RlBwJ: VlWho: goto GqBni; PU1m4: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto n4J0P; } goto QDv01; BkmAH: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\141\x74\145")) : array(); goto yZoti; sVdal: $tables_to_create = array_diff($development_tables, $live_tables); goto bklLU; PTk2V: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto PU1m4; SQ8LQ: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto PTk2V; l27D8: echo "\74\160\162\x65\x3e\xa"; goto RlBwJ; bklLU: $tables_to_drop = array_diff($live_tables, $development_tables); goto BkmAH; aGUda: echo "\x3c\150\x32\x3e\x54\150\145\40\144\x61\164\141\142\x61\163\145\x20\x69\x73\40\x6f\165\x74\x20\x6f\x66\x20\x53\171\156\143\x21\74\x2f\x68\62\x3e\12"; goto GNkBu; GqBni: } function manage_tables($tables, $action) { goto gvUoH; u9v4L: ihmTh: goto z0aj1; xlrbL: if (!($action == "\x63\162\x65\x61\164\x65")) { goto RIUqT; } goto KSDg6; gvUoH: $sql_commands_to_run = array(); goto xlrbL; rnoWH: if (!($action == "\x64\162\157\x70")) { goto ihmTh; } goto Be3a8; L0mWV: WrgwX: goto u9v4L; Be3a8: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\x52\117\120\x20\124\x41\x42\x4c\105\x20{$table}\73"; v6El_: } goto L0mWV; y5w4W: zp9Vk: goto ZJHBo; KSDg6: foreach ($tables as $table) { goto GqVLw; UbPjT: $sql_commands_to_run[] = $table_structure["\103\x72\145\141\x74\145\x20\124\x61\142\154\145"] . "\x3b"; goto Zfvqz; Zfvqz: Qxqm6: goto RLz9P; uYmZv: $table_structure = $query->row_array(); goto UbPjT; GqVLw: $query = $this->DB1->query("\123\110\x4f\127\x20\103\x52\105\101\124\x45\x20\124\x41\x42\114\105\x20\x60{$table}\x60\40\55\55\x20\x63\162\x65\x61\x74\145\40\164\x61\x62\154\x65\x73"); goto uYmZv; RLz9P: } goto y5w4W; z0aj1: return $sql_commands_to_run; goto eF2rN; ZJHBo: RIUqT: goto rnoWH; eF2rN: } function compare_table_structures($development_tables, $live_tables) { goto AOHqy; AOHqy: $tables_need_updating = array(); goto tAry6; tAry6: $live_table_structures = $development_table_structures = array(); goto akq5f; GsW5b: uK4RW: goto wsQYP; akq5f: foreach ($development_tables as $table) { goto QRimv; QRimv: $query = $this->DB1->query("\123\110\x4f\127\x20\x43\122\105\x41\x54\x45\x20\x54\101\x42\x4c\105\40\140{$table}\140\x20\55\x2d\40\144\145\166"); goto sL8Js; RPxsU: p3bvr: goto fyU9D; sL8Js: $table_structure = $query->row_array(); goto dkHb_; dkHb_: $development_table_structures[$table] = $table_structure["\103\x72\x65\x61\x74\145\x20\124\141\x62\x6c\145"]; goto RPxsU; fyU9D: } goto TNE8Z; rmr2l: foreach ($live_tables as $table) { goto QxKhx; NfDoC: $table_structure = $query->row_array(); goto xOBxy; xOBxy: $live_table_structures[$table] = $table_structure["\103\x72\x65\x61\x74\x65\40\124\x61\142\154\145"]; goto hQJhH; QxKhx: $query = $this->DB2->query("\x53\x48\x4f\x57\40\x43\122\x45\x41\x54\x45\40\124\101\102\114\105\40\140{$table}\140\40\55\55\40\x6c\151\166\x65"); goto NfDoC; hQJhH: uKH_9: goto M4t8N; M4t8N: } goto rjkJb; wsQYP: return $tables_need_updating; goto E221N; C3TYp: foreach ($development_tables as $table) { goto nRGpq; s9IfV: A0iAL: goto r8GzZ; N3JOj: if (!($this->count_differences($development_table, $live_table) > 0)) { goto xFYov; } goto PPkI8; Ejj8v: xFYov: goto s9IfV; PPkI8: $tables_need_updating[] = $table; goto Ejj8v; nRGpq: $development_table = $development_table_structures[$table]; goto ZinPu; ZinPu: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto N3JOj; r8GzZ: } goto GsW5b; TNE8Z: IZX9y: goto rmr2l; rjkJb: TtcPV: goto C3TYp; E221N: } function count_differences($old, $new) { goto haTFL; or1un: $differences++; goto zsmK_; haTFL: $differences = 0; goto XFAc9; XFAc9: $old = trim(preg_replace("\x2f\134\163\x2b\57", '', $old)); goto X8rXA; UO43D: return $differences; goto Iobqe; A_kl8: if (!($i < $length)) { goto SGQ3M; } goto rfgHD; rfgHD: if (!($old[$i] != $new[$i])) { goto RoSzb; } goto or1un; SsktL: m0wj6: goto A_kl8; MXGjW: Ru11M: goto LjLM6; MSv73: if (!($old == $new)) { goto CT5qX; } goto UO43D; fHBeO: SGQ3M: goto jA3k6; Et98G: $new = explode("\x20", $new); goto QA9OC; jA3k6: return $differences; goto wcjzR; LjLM6: $i++; goto a3Fn3; KbI3z: $i = 0; goto SsktL; QA9OC: $length = max(count($old), count($new)); goto KbI3z; X8rXA: $new = trim(preg_replace("\x2f\134\x73\x2b\x2f", '', $new)); goto MSv73; a3Fn3: goto m0wj6; goto fHBeO; zsmK_: RoSzb: goto MXGjW; Iobqe: CT5qX: goto wmZq1; wmZq1: $old = explode("\x20", $old); goto Et98G; wcjzR: } function update_existing_tables($tables) { goto z8Q4D; o6gWG: hp1hh: goto gFcJO; CxnMy: foreach ($tables as $table) { goto XPBXE; Uu5Mj: lqWo3: goto Rps3H; XPBXE: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto ysCEw; ysCEw: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto Uu5Mj; Rps3H: } goto RBOyt; RBOyt: KDrFh: goto o6gWG; i45Ji: $table_structure_live = array(); goto v14Mx; gFcJO: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto yVtcV; v14Mx: if (!(is_array($tables) && !empty($tables))) { goto hp1hh; } goto CxnMy; yVtcV: return $sql_commands_to_run; goto nYlgn; PnGra: $table_structure_development = array(); goto i45Ji; z8Q4D: $sql_commands_to_run = array(); goto PnGra; nYlgn: } function table_field_data($database, $table) { goto c6bC1; rX5FD: $fields[] = $row; goto GAixf; D8gow: return $fields; goto utPPu; c6bC1: $conn = mysqli_connect($database["\x68\x6f\163\164\156\x61\155\x65"], $database["\x75\x73\x65\162\156\141\155\x65"], $database["\160\141\163\163\167\x6f\x72\x64"]); goto fWjY6; UMfen: if (!($row = mysql_fetch_assoc($result))) { goto uD7ax; } goto rX5FD; fWjY6: mysql_select_db($database["\x64\141\164\141\x62\141\x73\145"]); goto TJwnH; k3OjR: GmSbz: goto UMfen; GAixf: goto GmSbz; goto xbw8C; TJwnH: $result = mysql_query("\x53\x48\x4f\x57\40\x43\117\114\125\x4d\x4e\123\x20\106\122\117\115\40\x60{$table}\x60"); goto k3OjR; xbw8C: uD7ax: goto D8gow; utPPu: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto B3piB; DmXWC: foreach ($source_field_structures as $table => $fields) { goto sRMcV; XxG9j: iSvSY: goto HV813; sRMcV: foreach ($fields as $field) { goto heMpi; yFMcE: if (!(is_array($differences) && !empty($differences))) { goto Z8Cdc; } goto Q9zfF; kRd4U: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\101\x46\x54\x45\x52\40" . $previous_field : ''; goto LmKmp; qLuLc: $sql_commands_to_run[] = $modify_field; goto hVevG; f19Rp: LRODQ: goto FLU8w; Y13Ff: $add_field .= isset($field["\116\x75\154\x6c"]) && $field["\116\165\x6c\154"] == "\x59\105\x53" ? "\40\x4e\x75\x6c\154" : ''; goto J80Gp; ef1Bw: SaQzC: goto bD_Rg; SH887: goto SaQzC; goto f19Rp; hVevG: N03D0: goto KCJru; tp6Ey: $modify_field .= isset($fields[$n]["\116\x75\154\x6c"]) && $fields[$n]["\x4e\x75\154\154"] == "\x59\x45\123" ? "\x20\x4e\x55\114\114" : "\40\116\117\124\40\116\125\x4c\x4c"; goto NoiHC; qEPvG: oK0Hy: goto ef1Bw; jMKDj: $add_field = "\x41\x4c\x54\x45\122\x20\124\x41\x42\x4c\x45\x20{$table}\x20\101\x44\104\40\x43\x4f\114\x55\x4d\116\40\140" . $field["\x46\x69\x65\x6c\144"] . "\140\40" . $field["\124\171\160\x65"] . "\x20\x43\x48\101\x52\101\x43\124\105\122\x20\x53\x45\124\40" . $this->CHARACTER_SET; goto Y13Ff; NoiHC: $modify_field .= isset($fields[$n]["\105\170\x74\x72\141"]) && $fields[$n]["\x45\x78\164\x72\x61"] != '' ? "\40" . $fields[$n]["\x45\170\164\x72\141"] : ''; goto kRd4U; wwv0a: L1ziW: goto VxdSG; FLU8w: $modify_field = ''; goto CeGg7; PVgQ2: $previous_field = $fields[$n]["\106\151\x65\x6c\144"]; goto wwv0a; CeGg7: $n = 0; goto KU1wQ; LmKmp: $modify_field .= "\73"; goto FIYRC; FKiDV: $sql_commands_to_run[] = $add_field; goto SH887; VxdSG: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto N03D0; } goto qLuLc; KU1wQ: M26KD: goto KSo6e; heMpi: if ($this->in_array_recursive($field["\x46\151\145\154\x64"], $destination_field_structures[$table])) { goto LRODQ; } goto jMKDj; iGqJS: $modify_field .= isset($fields[$n]["\x44\145\146\x61\165\154\x74"]) && $fields[$n]["\104\145\x66\141\165\154\164"] != '' ? "\40\104\x45\x46\101\x55\114\x54\x20\x27" . $fields[$n]["\x44\x65\x66\x61\165\x6c\x74"] . "\47" : ''; goto tp6Ey; KCJru: Br0D1: goto WGvm6; qEC_x: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto yFMcE; FBKET: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\x69\145\x6c\x64"] == $destination_field_structures[$table][$n]["\106\x69\145\x6c\x64"])) { goto L1ziW; } goto qEC_x; FIYRC: Z8Cdc: goto PVgQ2; KSo6e: if (!($n < count($fields))) { goto oK0Hy; } goto FBKET; fkaPD: $add_field .= "\x3b"; goto FKiDV; WGvm6: $n++; goto x2shp; bD_Rg: KO22D: goto pPfAS; Nohhh: $add_field .= isset($field["\105\170\164\x72\x61"]) && $field["\105\170\x74\162\x61"] != '' ? "\40" . $field["\105\170\164\x72\x61"] : ''; goto fkaPD; Q9zfF: $modify_field = "\101\x4c\x54\105\x52\x20\x54\101\102\x4c\105\x20{$table}\40\115\x4f\x44\111\106\131\40\103\x4f\x4c\x55\x4d\x4e\40\x60" . $fields[$n]["\x46\151\x65\154\x64"] . "\140\40" . $fields[$n]["\124\171\160\145"] . "\40\103\x48\x41\x52\101\103\124\105\122\40\x53\x45\x54\40" . $this->CHARACTER_SET; goto iGqJS; x2shp: goto M26KD; goto qEPvG; J80Gp: $add_field .= "\40\104\x45\106\x41\125\114\124\x20" . $field["\x44\x65\x66\x61\165\x6c\x74"]; goto Nohhh; pPfAS: } goto s9DS2; s9DS2: oRbtc: goto XxG9j; HV813: } goto AOt23; AOt23: mtb5Y: goto ZwHUU; B3piB: $sql_commands_to_run = array(); goto DmXWC; ZwHUU: return $sql_commands_to_run; goto OvSmS; OvSmS: } function in_array_recursive($needle, $haystack, $strict = false) { goto qR90M; qR90M: foreach ($haystack as $array => $item) { goto Nh31E; Pqe1z: QoJkf: goto lLiZ_; awvJU: return true; goto AciAR; AciAR: VZLZD: goto Pqe1z; BBrLy: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto VZLZD; } goto awvJU; Nh31E: $item = $item["\x46\151\145\154\x64"]; goto BBrLy; lLiZ_: } goto mAoIk; icIj9: return false; goto WOlpO; mAoIk: yp_IM: goto icIj9; WOlpO: } }
