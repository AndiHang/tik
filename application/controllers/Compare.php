<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto BcWJ9; BcWJ9: if (defined("\x42\x41\x53\105\x50\101\124\110")) { goto SfbUK; } goto qB3Tk; yTXCS: SfbUK: goto WM2N7; qB3Tk: exit("\116\x6f\x20\x64\x69\x72\x65\x63\164\x20\163\143\x72\151\x70\164\40\x61\143\x63\x65\x73\163\40\x61\x6c\154\x6f\x77\145\144"); goto yTXCS; WM2N7: class Compare extends CI_Controller { function __construct() { goto mB6qz; ZoPvO: $this->DB1 = $this->load->database("\x6d\x61\x69\156\137\x67\141\162\165\144\x61", TRUE); goto Psg3s; mB6qz: parent::__construct(); goto hXKeI; hXKeI: $this->CHARACTER_SET = "\165\x74\x66\x38\x20\103\117\114\x4c\101\124\x45\x20\165\x74\x66\70\137\147\145\156\x65\x72\x61\154\x5f\x63\151"; goto ZoPvO; Psg3s: $this->DB2 = $this->load->database("\x6c\x69\x76\145", TRUE); goto FGmCN; FGmCN: } function index() { goto FWexx; clU5E: $tables_to_create = array_diff($development_tables, $live_tables); goto h3gQB; nn5C_: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto zUl3L; } goto ZgIUy; S7zX_: $live_tables = $this->DB2->list_tables(); goto clU5E; UGvpy: $development_tables = $this->DB1->list_tables(); goto S7zX_; HytL9: echo "\74\160\162\x65\x3e\12"; goto DZR3L; IrJM7: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\162\157\160")) : array(); goto ocFK8; jUyB7: echo "\74\x70\76\124\x68\x65\40\x66\157\x6c\x6c\x6f\x77\151\x6e\x67\40\123\121\x4c\x20\x63\157\x6d\x6d\x61\x6e\x64\163\40\156\145\145\x64\x20\x74\x6f\40\x62\x65\40\x65\x78\145\143\165\164\x65\x64\x20\x74\x6f\40\x62\x72\151\x6e\147\x20\x74\x68\145\40\114\x69\x76\145\x20\144\141\164\x61\x62\141\163\145\x20\x74\141\x62\x6c\x65\x73\40\165\160\40\x74\157\40\x64\x61\x74\x65\x3a\x20\74\x2f\x70\x3e\12"; goto xwO0k; xwO0k: echo "\x3c\160\162\145\40\163\x74\x79\154\145\x3d\47\x70\x61\144\144\151\x6e\x67\x3a\40\62\x30\x70\x78\x3b\x20\x62\141\143\x6b\147\x72\157\x75\156\144\x2d\143\157\x6c\157\x72\x3a\40\43\x46\106\x46\101\106\60\73\47\76\xa"; goto ervdB; Z61t7: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\141\164\145")) : array(); goto IrJM7; DZR3L: pB3bN: goto VGd5R; ocFK8: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto auVNx; m000Z: zUl3L: goto DDl1R; ervdB: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; fcMd2: } goto f3kKo; UNNPr: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto nn5C_; FWexx: $sql_commands_to_run = array(); goto UGvpy; ZgIUy: echo "\x3c\x68\x32\x3e\x54\x68\145\40\x64\141\164\x61\x62\x61\163\145\40\x61\x70\x70\x65\141\x72\163\40\x74\157\x20\142\145\40\x75\160\x20\164\157\40\144\141\164\x65\x3c\57\150\62\x3e\xa"; goto Xo_WE; h3gQB: $tables_to_drop = array_diff($live_tables, $development_tables); goto Z61t7; Xo_WE: goto pB3bN; goto m000Z; DDl1R: echo "\74\150\x32\76\x54\x68\145\40\x64\x61\164\x61\142\141\x73\x65\x20\x69\163\40\x6f\165\x74\x20\x6f\146\40\x53\x79\x6e\x63\x21\x3c\57\x68\62\76\12"; goto jUyB7; f3kKo: ijUdz: goto HytL9; auVNx: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto UNNPr; VGd5R: } function manage_tables($tables, $action) { goto ajsH0; dIzfP: KhllH: goto mrn2A; kvRZb: foreach ($tables as $table) { goto FUjCc; uaMWN: $table_structure = $query->row_array(); goto qzu1U; KgyLm: l52jG: goto v7yvV; FUjCc: $query = $this->DB1->query("\x53\110\x4f\127\40\103\122\105\x41\x54\105\40\124\101\102\114\105\x20\x60{$table}\x60\40\55\55\x20\143\162\145\x61\x74\x65\x20\164\x61\142\154\x65\163"); goto uaMWN; qzu1U: $sql_commands_to_run[] = $table_structure["\x43\x72\x65\x61\x74\145\40\x54\x61\x62\x6c\145"] . "\73"; goto KgyLm; v7yvV: } goto dIzfP; Xcny6: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\122\x4f\x50\x20\124\101\102\114\x45\40{$table}\73"; xkc12: } goto V0ZtE; GZlqk: if (!($action == "\144\162\157\160")) { goto L_JRg; } goto Xcny6; yWtzI: L_JRg: goto Ee9_t; Ee9_t: return $sql_commands_to_run; goto trHrN; QH1V2: if (!($action == "\143\x72\x65\x61\x74\x65")) { goto osnal; } goto kvRZb; V0ZtE: cvwat: goto yWtzI; mrn2A: osnal: goto GZlqk; ajsH0: $sql_commands_to_run = array(); goto QH1V2; trHrN: } function compare_table_structures($development_tables, $live_tables) { goto m_OnM; jDa8X: bjBBv: goto Q2SX3; nn_rH: Gf8Xc: goto heOpp; aJzeT: foreach ($development_tables as $table) { goto MdBWR; WVg6Y: $table_structure = $query->row_array(); goto q61pB; q61pB: $development_table_structures[$table] = $table_structure["\103\x72\x65\141\x74\x65\x20\124\141\x62\154\145"]; goto tWuEG; tWuEG: a00nc: goto bquZx; MdBWR: $query = $this->DB1->query("\123\x48\117\127\x20\103\x52\x45\101\x54\x45\40\x54\x41\x42\114\x45\40\140{$table}\x60\40\x2d\x2d\40\144\x65\166"); goto WVg6Y; bquZx: } goto nn_rH; M3jww: v21AV: goto UlXeh; Q2SX3: return $tables_need_updating; goto ZqWam; heOpp: foreach ($live_tables as $table) { goto Qr8MM; Qr8MM: $query = $this->DB2->query("\x53\x48\x4f\x57\40\103\x52\x45\x41\x54\105\x20\124\x41\102\x4c\105\40\x60{$table}\x60\40\55\55\x20\154\x69\166\145"); goto T4LOE; T4LOE: $table_structure = $query->row_array(); goto P1eXq; P1eXq: $live_table_structures[$table] = $table_structure["\103\162\x65\x61\x74\x65\40\x54\x61\x62\x6c\x65"]; goto cUORM; cUORM: PmowA: goto QA9Oi; QA9Oi: } goto M3jww; UlXeh: foreach ($development_tables as $table) { goto k6nfZ; k6nfZ: $development_table = $development_table_structures[$table]; goto uXKfH; uFEW3: UveHr: goto mRKXr; uXKfH: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto hpMhr; mRKXr: jBflW: goto GCH1W; hpMhr: if (!($this->count_differences($development_table, $live_table) > 0)) { goto UveHr; } goto zkr0z; zkr0z: $tables_need_updating[] = $table; goto uFEW3; GCH1W: } goto jDa8X; m_OnM: $tables_need_updating = array(); goto y7y29; y7y29: $live_table_structures = $development_table_structures = array(); goto aJzeT; ZqWam: } function count_differences($old, $new) { goto OjhC_; gBCiD: $new = explode("\40", $new); goto v90y_; Wfuds: $new = trim(preg_replace("\x2f\134\163\x2b\57", '', $new)); goto d2Wd8; UDA3g: $differences++; goto O_Tko; bUdRP: $i++; goto SCQuV; SCQuV: goto Ap23s; goto tw19O; O_Tko: QhWT4: goto rZ5gn; tw19O: ZRyL0: goto JQfCk; rZ5gn: K8hEZ: goto bUdRP; KWfYP: $i = 0; goto UDfCf; q1JCC: if (!($old[$i] != $new[$i])) { goto QhWT4; } goto UDA3g; dcgYV: $old = trim(preg_replace("\57\x5c\x73\x2b\x2f", '', $old)); goto Wfuds; wLCRy: if (!($i < $length)) { goto ZRyL0; } goto q1JCC; d2Wd8: if (!($old == $new)) { goto U50uK; } goto dZo6D; v90y_: $length = max(count($old), count($new)); goto KWfYP; OjhC_: $differences = 0; goto dcgYV; dZo6D: return $differences; goto sxa8p; UDfCf: Ap23s: goto wLCRy; sB4Fm: $old = explode("\40", $old); goto gBCiD; JQfCk: return $differences; goto eti0Q; sxa8p: U50uK: goto sB4Fm; eti0Q: } function update_existing_tables($tables) { goto LjTZF; oNynU: $table_structure_live = array(); goto cDPtg; c0ueo: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto wEhCG; WwhDW: foreach ($tables as $table) { goto jI95K; B4T_a: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto pz0vg; jI95K: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto B4T_a; pz0vg: jDqBi: goto w5rcq; w5rcq: } goto S4nQR; LjTZF: $sql_commands_to_run = array(); goto BE3DE; S4nQR: cGy57: goto E3Ptc; cDPtg: if (!(is_array($tables) && !empty($tables))) { goto gVltU; } goto WwhDW; wEhCG: return $sql_commands_to_run; goto AJVEO; E3Ptc: gVltU: goto c0ueo; BE3DE: $table_structure_development = array(); goto oNynU; AJVEO: } function table_field_data($database, $table) { goto MpND9; gzPSq: return $fields; goto BUz45; rzYgz: mysql_select_db($database["\144\141\x74\x61\x62\141\x73\145"]); goto yHlZF; yHlZF: $result = mysql_query("\x53\110\x4f\x57\40\x43\x4f\x4c\x55\x4d\x4e\x53\x20\106\x52\117\x4d\40\x60{$table}\x60"); goto DgKfP; toxcJ: GMRTh: goto gzPSq; JYMD9: goto drMbd; goto toxcJ; Z_D9j: $fields[] = $row; goto JYMD9; VlB26: if (!($row = mysql_fetch_assoc($result))) { goto GMRTh; } goto Z_D9j; DgKfP: drMbd: goto VlB26; MpND9: $conn = mysqli_connect($database["\150\157\163\164\x6e\x61\155\x65"], $database["\x75\163\x65\x72\x6e\x61\155\145"], $database["\x70\x61\163\x73\167\157\162\x64"]); goto rzYgz; BUz45: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto D6tOt; KM5Uz: Qdeg3: goto cjOFO; Ei2J1: foreach ($source_field_structures as $table => $fields) { goto tqlT2; tqlT2: foreach ($fields as $field) { goto YXhkI; F1PNJ: JlDat: goto TkHC2; T5gGT: $add_field = "\x41\114\x54\105\122\40\124\101\x42\x4c\x45\40{$table}\x20\101\x44\x44\40\x43\117\114\125\x4d\x4e\40\140" . $field["\106\151\x65\x6c\x64"] . "\140\x20" . $field["\124\171\160\145"] . "\x20\103\110\101\x52\x41\x43\x54\x45\122\40\x53\x45\x54\40" . $this->CHARACTER_SET; goto gQbWr; zHJ2f: $add_field .= "\40\x44\x45\x46\x41\125\x4c\x54\40" . $field["\x44\x65\146\x61\165\154\164"]; goto oh_l8; TBD0I: QtGOc: goto F1PNJ; hECuj: Epcjh: goto Rhg68; BhEwk: $sql_commands_to_run[] = $modify_field; goto uYhr6; ayY3Z: goto gGtlp; goto GXpNM; u1rGB: wIIOD: goto W0i97; JwVvc: $sql_commands_to_run[] = $add_field; goto YsKUd; Rhg68: $n++; goto ayY3Z; ucp0J: $add_field .= "\x3b"; goto JwVvc; Qnf0z: $modify_field = ''; goto pZDgr; kheOC: if (!(is_array($differences) && !empty($differences))) { goto wIIOD; } goto ex12S; YsKUd: goto QtGOc; goto gtv0k; jx43_: if (!($n < count($fields))) { goto GU0Yl; } goto ouDuu; gQbWr: $add_field .= isset($field["\x4e\165\x6c\x6c"]) && $field["\116\165\154\154"] == "\131\105\123" ? "\x20\116\x75\154\154" : ''; goto zHJ2f; gtv0k: sK5hf: goto Qnf0z; GvzOw: $modify_field .= "\x3b"; goto u1rGB; pZDgr: $n = 0; goto pjMQx; TRk0W: zdwLj: goto b8ZyG; ex12S: $modify_field = "\101\x4c\x54\105\x52\40\124\101\x42\x4c\105\40{$table}\40\115\117\x44\111\106\131\x20\x43\117\114\x55\115\x4e\x20\140" . $fields[$n]["\x46\151\x65\x6c\144"] . "\140\x20" . $fields[$n]["\124\x79\x70\x65"] . "\x20\103\x48\x41\x52\101\103\x54\x45\122\40\x53\105\124\x20" . $this->CHARACTER_SET; goto l5KdA; Bv6G5: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\106\x54\105\122\40" . $previous_field : ''; goto GvzOw; AElXa: $modify_field .= isset($fields[$n]["\116\x75\154\154"]) && $fields[$n]["\x4e\165\154\154"] == "\131\x45\123" ? "\x20\116\x55\114\114" : "\x20\116\x4f\x54\x20\116\x55\114\114"; goto SF8kG; pjMQx: gGtlp: goto jx43_; SF8kG: $modify_field .= isset($fields[$n]["\x45\x78\164\x72\141"]) && $fields[$n]["\105\x78\164\162\141"] != '' ? "\40" . $fields[$n]["\105\x78\164\162\x61"] : ''; goto Bv6G5; NqYSh: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto kheOC; uYhr6: PANzw: goto hECuj; GXpNM: GU0Yl: goto TBD0I; ouDuu: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\x69\145\x6c\x64"] == $destination_field_structures[$table][$n]["\x46\151\145\x6c\144"])) { goto zdwLj; } goto NqYSh; oh_l8: $add_field .= isset($field["\x45\170\164\162\x61"]) && $field["\105\170\164\162\x61"] != '' ? "\40" . $field["\x45\x78\x74\x72\x61"] : ''; goto ucp0J; b8ZyG: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto PANzw; } goto BhEwk; YXhkI: if ($this->in_array_recursive($field["\106\x69\x65\x6c\144"], $destination_field_structures[$table])) { goto sK5hf; } goto T5gGT; l5KdA: $modify_field .= isset($fields[$n]["\104\145\x66\x61\165\154\x74"]) && $fields[$n]["\104\145\146\141\165\154\164"] != '' ? "\40\104\105\x46\x41\x55\114\124\x20\47" . $fields[$n]["\104\145\146\141\165\154\x74"] . "\47" : ''; goto AElXa; W0i97: $previous_field = $fields[$n]["\x46\x69\145\154\144"]; goto TRk0W; TkHC2: } goto aRxXh; aRxXh: ijedb: goto EtQwR; EtQwR: XrTHJ: goto JcSXd; JcSXd: } goto KM5Uz; cjOFO: return $sql_commands_to_run; goto tKxdb; D6tOt: $sql_commands_to_run = array(); goto Ei2J1; tKxdb: } function in_array_recursive($needle, $haystack, $strict = false) { goto l6WAU; l8xhC: BTGVz: goto dd6LH; dd6LH: return false; goto TlGRt; l6WAU: foreach ($haystack as $array => $item) { goto R13W1; R13W1: $item = $item["\106\x69\x65\x6c\144"]; goto ymprU; TQd4K: iMH9f: goto VwY_z; kTKxE: return true; goto TQd4K; VwY_z: WvAPE: goto lsGxb; ymprU: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto iMH9f; } goto kTKxE; lsGxb: } goto l8xhC; TlGRt: } }
