<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto TJ1GZ; h5jDS: exit("\116\x6f\40\144\x69\162\x65\143\x74\x20\x73\143\x72\x69\x70\x74\x20\141\143\143\145\163\x73\x20\141\x6c\x6c\157\167\x65\144"); goto yKcOY; yKcOY: q7d2L: goto Szk5q; TJ1GZ: if (defined("\x42\x41\123\105\x50\101\x54\x48")) { goto q7d2L; } goto h5jDS; Szk5q: class Compare extends CI_Controller { function __construct() { goto OzWc2; lLsQq: $this->DB1 = $this->load->database("\x6d\141\x69\156\x5f\x67\141\162\x75\x64\x61", TRUE); goto v0uU0; rYEKz: $this->CHARACTER_SET = "\x75\x74\x66\70\x20\x43\x4f\x4c\x4c\101\124\x45\40\165\x74\x66\70\137\147\x65\x6e\145\x72\x61\x6c\x5f\x63\x69"; goto lLsQq; OzWc2: parent::__construct(); goto rYEKz; v0uU0: $this->DB2 = $this->load->database("\x6c\151\166\145", TRUE); goto ol_lr; ol_lr: } function index() { goto HfuE5; xsvMF: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\x65\x61\164\145")) : array(); goto uKhxn; sARmj: echo "\x3c\150\x32\x3e\x54\x68\x65\x20\x64\141\x74\x61\142\x61\x73\145\x20\x69\x73\40\x6f\165\164\x20\157\x66\40\x53\x79\156\x63\41\74\x2f\150\x32\x3e\xa"; goto q_SCN; HfuE5: $sql_commands_to_run = array(); goto r1WFa; ZtU9r: echo "\74\160\162\x65\x3e\xa"; goto xsbwS; w9Yxm: goto AUDPA; goto lhh0O; lb7MQ: echo "\74\x70\x72\145\x20\163\164\x79\154\x65\75\47\160\x61\x64\x64\151\156\x67\72\40\x32\x30\160\x78\73\40\142\141\143\x6b\147\x72\x6f\165\156\144\55\x63\157\154\157\x72\72\x20\43\x46\x46\106\101\x46\60\x3b\47\x3e\xa"; goto hBgJ2; q_SCN: echo "\74\x70\x3e\124\150\x65\40\x66\157\x6c\154\x6f\167\x69\x6e\147\x20\123\121\114\x20\143\x6f\155\155\x61\x6e\144\163\40\156\145\145\144\x20\164\157\x20\142\145\x20\x65\x78\145\143\165\x74\145\x64\40\x74\157\x20\x62\162\x69\x6e\x67\40\164\x68\x65\x20\x4c\x69\x76\145\40\x64\x61\x74\x61\x62\x61\163\145\40\x74\x61\142\x6c\x65\x73\x20\x75\x70\x20\x74\157\40\x64\141\x74\145\x3a\x20\74\x2f\x70\76\12"; goto lb7MQ; VdUoh: $tables_to_drop = array_diff($live_tables, $development_tables); goto xsvMF; lhh0O: S_YN4: goto sARmj; yD02K: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto Mtbxk; hBgJ2: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; iDpLv: } goto tQRkz; CNDU6: $live_tables = $this->DB2->list_tables(); goto fx0XG; r1WFa: $development_tables = $this->DB1->list_tables(); goto CNDU6; woC0Y: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto OJmxw; tQRkz: Cr7km: goto ZtU9r; Mtbxk: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto S_YN4; } goto MO31F; uKhxn: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\162\x6f\160")) : array(); goto woC0Y; MO31F: echo "\74\x68\x32\76\124\150\x65\x20\x64\x61\164\x61\x62\141\163\x65\x20\141\160\x70\x65\141\x72\x73\40\164\157\x20\142\x65\x20\x75\160\x20\164\x6f\x20\x64\141\164\x65\74\57\x68\x32\76\12"; goto w9Yxm; xsbwS: AUDPA: goto tB2eq; fx0XG: $tables_to_create = array_diff($development_tables, $live_tables); goto VdUoh; OJmxw: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto yD02K; tB2eq: } function manage_tables($tables, $action) { goto mXx0H; yT5CB: if (!($action == "\x64\x72\157\x70")) { goto UNR07; } goto Mresw; zRcgj: dQ0zX: goto WcCht; fIiA9: if (!($action == "\x63\x72\x65\141\x74\x65")) { goto l6P6I; } goto OQs8f; Mresw: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\122\117\120\40\x54\x41\102\114\x45\40{$table}\x3b"; Ufusa: } goto zRcgj; ORyIl: return $sql_commands_to_run; goto eeSBb; tXi35: l6P6I: goto yT5CB; OQs8f: foreach ($tables as $table) { goto ef8tj; Ez14n: $table_structure = $query->row_array(); goto A_5Pl; y1tfR: fgbEf: goto s5ZNO; A_5Pl: $sql_commands_to_run[] = $table_structure["\103\x72\x65\141\x74\x65\x20\124\x61\142\154\145"] . "\73"; goto y1tfR; ef8tj: $query = $this->DB1->query("\x53\x48\117\x57\x20\x43\x52\105\101\124\105\40\x54\x41\102\x4c\x45\x20\140{$table}\140\40\55\x2d\40\143\x72\145\141\x74\145\40\164\x61\x62\154\x65\x73"); goto Ez14n; s5ZNO: } goto bM1Aa; bM1Aa: WEDiO: goto tXi35; WcCht: UNR07: goto ORyIl; mXx0H: $sql_commands_to_run = array(); goto fIiA9; eeSBb: } function compare_table_structures($development_tables, $live_tables) { goto vE8Uj; tO3Yf: return $tables_need_updating; goto EH0VA; lkP2e: Ivgrq: goto zXiMC; uhoo3: foreach ($development_tables as $table) { goto Klv4m; B9Glw: $tables_need_updating[] = $table; goto tYMrN; AnE9R: UZFMJ: goto t7j8h; JQVLv: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto KDp4_; KDp4_: if (!($this->count_differences($development_table, $live_table) > 0)) { goto q5lFZ; } goto B9Glw; tYMrN: q5lFZ: goto AnE9R; Klv4m: $development_table = $development_table_structures[$table]; goto JQVLv; t7j8h: } goto DCd2r; LcXJD: wRUk7: goto uhoo3; DCd2r: QsPSn: goto tO3Yf; zXiMC: foreach ($live_tables as $table) { goto nVbF7; gvcRi: $live_table_structures[$table] = $table_structure["\x43\x72\x65\141\x74\145\40\124\x61\142\x6c\x65"]; goto Iy9af; nVbF7: $query = $this->DB2->query("\x53\110\x4f\x57\40\x43\x52\105\x41\x54\x45\x20\x54\x41\102\x4c\105\40\x60{$table}\140\x20\x2d\x2d\x20\154\x69\166\x65"); goto SvyPY; SvyPY: $table_structure = $query->row_array(); goto gvcRi; Iy9af: kzhRU: goto DQm9b; DQm9b: } goto LcXJD; vN9id: $live_table_structures = $development_table_structures = array(); goto a3nSn; a3nSn: foreach ($development_tables as $table) { goto iNPGY; YoV3A: Ry51e: goto uwXyZ; iNPGY: $query = $this->DB1->query("\x53\110\117\127\40\103\x52\105\x41\x54\105\40\x54\x41\x42\114\x45\x20\140{$table}\x60\x20\x2d\55\40\x64\145\166"); goto YYINP; tl2oY: $development_table_structures[$table] = $table_structure["\103\162\x65\x61\164\x65\x20\x54\141\142\154\145"]; goto YoV3A; YYINP: $table_structure = $query->row_array(); goto tl2oY; uwXyZ: } goto lkP2e; vE8Uj: $tables_need_updating = array(); goto vN9id; EH0VA: } function count_differences($old, $new) { goto p0wBH; I5bfu: $length = max(count($old), count($new)); goto b25mF; uj2Jb: u1ost: goto v3zBq; tBD_5: mCYXF: goto Ie0BC; X7MYa: YPqDp: goto N1j6Q; KiXsR: return $differences; goto EzJNX; Ie0BC: $i++; goto oyRpc; b25mF: $i = 0; goto X7MYa; p0wBH: $differences = 0; goto okRYD; v3zBq: $old = explode("\x20", $old); goto RxRzw; oyRpc: goto YPqDp; goto YRy40; gcZU7: return $differences; goto uj2Jb; okRYD: $old = trim(preg_replace("\x2f\x5c\x73\x2b\x2f", '', $old)); goto B3dgH; CszqF: if (!($old == $new)) { goto u1ost; } goto gcZU7; x_ye9: $differences++; goto B3GZo; B3GZo: EHxS1: goto tBD_5; YRy40: paY7T: goto KiXsR; ZF0I8: if (!($old[$i] != $new[$i])) { goto EHxS1; } goto x_ye9; B3dgH: $new = trim(preg_replace("\x2f\134\x73\x2b\x2f", '', $new)); goto CszqF; RxRzw: $new = explode("\x20", $new); goto I5bfu; N1j6Q: if (!($i < $length)) { goto paY7T; } goto ZF0I8; EzJNX: } function update_existing_tables($tables) { goto KRgE4; itu4n: lKZi7: goto XqkfV; KRgE4: $sql_commands_to_run = array(); goto c3CLr; c3CLr: $table_structure_development = array(); goto B3Qa5; nZsj2: return $sql_commands_to_run; goto IzSqO; Wz1Bu: wV8Ay: goto itu4n; XqkfV: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto nZsj2; XZyjV: if (!(is_array($tables) && !empty($tables))) { goto lKZi7; } goto ITNrZ; B3Qa5: $table_structure_live = array(); goto XZyjV; ITNrZ: foreach ($tables as $table) { goto vGRPi; Zj00p: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto t9zrX; t9zrX: x7JZy: goto keRKr; vGRPi: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto Zj00p; keRKr: } goto Wz1Bu; IzSqO: } function table_field_data($database, $table) { goto JcqjM; X5V1M: vNa3c: goto bTCrA; yv0HT: $result = mysql_query("\123\x48\x4f\127\x20\103\x4f\114\125\115\116\123\x20\106\122\117\x4d\40\x60{$table}\x60"); goto X5V1M; bTCrA: if (!($row = mysql_fetch_assoc($result))) { goto bXqyq; } goto HFWUx; HFWUx: $fields[] = $row; goto pyCCS; qVzsm: mysql_select_db($database["\x64\141\164\141\x62\141\163\145"]); goto yv0HT; pyCCS: goto vNa3c; goto Up4Yv; JcqjM: $conn = mysqli_connect($database["\150\x6f\163\x74\156\141\155\x65"], $database["\x75\x73\145\x72\156\x61\155\x65"], $database["\160\x61\x73\163\167\157\162\144"]); goto qVzsm; qaA0q: return $fields; goto hBeJu; Up4Yv: bXqyq: goto qaA0q; hBeJu: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto hmGnw; vhLaM: return $sql_commands_to_run; goto YHPwA; hmGnw: $sql_commands_to_run = array(); goto fnIvn; fnIvn: foreach ($source_field_structures as $table => $fields) { goto tfWW2; nSZ2a: pLNu_: goto pCqKE; tfWW2: foreach ($fields as $field) { goto JqkE4; DAKQB: p6gD4: goto NlQ1u; JqkE4: if ($this->in_array_recursive($field["\x46\x69\x65\x6c\144"], $destination_field_structures[$table])) { goto gvhyY; } goto Gc5Du; VJ0F1: $n++; goto KW5J7; KLY2h: $n = 0; goto DoAtg; zfMA7: $add_field .= "\x3b"; goto v0pLX; rPgYs: AI9z9: goto MZmbn; PMxCE: kBo5J: goto VsWWW; w6P27: gvhyY: goto rhtdZ; NlQ1u: KSIL9: goto VJ0F1; iN2h8: $add_field .= isset($field["\105\170\x74\162\x61"]) && $field["\105\170\164\162\x61"] != '' ? "\40" . $field["\x45\x78\164\162\x61"] : ''; goto zfMA7; Gm2Fy: $modify_field .= isset($fields[$n]["\104\145\x66\141\165\x6c\x74"]) && $fields[$n]["\x44\x65\x66\141\165\154\164"] != '' ? "\40\104\105\106\x41\x55\x4c\x54\x20\47" . $fields[$n]["\104\145\146\141\x75\x6c\x74"] . "\47" : ''; goto BiF1O; v0pLX: $sql_commands_to_run[] = $add_field; goto aI2Yl; JvFKG: $modify_field = "\101\x4c\x54\105\x52\x20\124\101\x42\114\105\x20{$table}\x20\x4d\x4f\104\111\x46\x59\x20\103\117\x4c\125\x4d\116\x20\140" . $fields[$n]["\106\151\x65\x6c\x64"] . "\x60\x20" . $fields[$n]["\124\171\x70\x65"] . "\40\x43\110\101\122\101\103\x54\105\x52\40\123\x45\124\40" . $this->CHARACTER_SET; goto Gm2Fy; BiF1O: $modify_field .= isset($fields[$n]["\x4e\165\x6c\154"]) && $fields[$n]["\x4e\165\154\154"] == "\131\105\123" ? "\x20\x4e\125\x4c\114" : "\40\116\117\x54\x20\116\x55\114\x4c"; goto Yslhk; RCEbh: $add_field .= "\40\104\105\x46\101\x55\114\124\x20" . $field["\x44\x65\146\x61\165\154\x74"]; goto iN2h8; wgACJ: if (!($n < count($fields))) { goto SZ8YF; } goto E0ubO; Y42HZ: $sql_commands_to_run[] = $modify_field; goto DAKQB; Yslhk: $modify_field .= isset($fields[$n]["\x45\170\164\162\x61"]) && $fields[$n]["\105\x78\x74\x72\141"] != '' ? "\x20" . $fields[$n]["\105\170\x74\x72\141"] : ''; goto RoEoA; ofZk9: LdQXZ: goto E4uP2; rlgDZ: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto W2LHF; KW5J7: goto V9N50; goto RqQAo; MZmbn: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto p6gD4; } goto Y42HZ; E0ubO: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\151\145\154\x64"] == $destination_field_structures[$table][$n]["\x46\151\145\x6c\144"])) { goto AI9z9; } goto rlgDZ; rhtdZ: $modify_field = ''; goto KLY2h; RqQAo: SZ8YF: goto PMxCE; W2LHF: if (!(is_array($differences) && !empty($differences))) { goto LdQXZ; } goto JvFKG; l_EGF: $add_field .= isset($field["\x4e\165\154\154"]) && $field["\116\165\x6c\154"] == "\131\105\123" ? "\x20\x4e\x75\x6c\x6c" : ''; goto RCEbh; E4uP2: $previous_field = $fields[$n]["\x46\x69\x65\x6c\144"]; goto rPgYs; DoAtg: V9N50: goto wgACJ; RoEoA: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\106\x54\x45\122\40" . $previous_field : ''; goto iCMad; iCMad: $modify_field .= "\73"; goto ofZk9; Gc5Du: $add_field = "\x41\114\x54\x45\122\x20\124\101\102\x4c\x45\x20{$table}\x20\101\x44\x44\x20\x43\x4f\114\x55\x4d\x4e\x20\140" . $field["\106\151\x65\x6c\x64"] . "\140\x20" . $field["\x54\171\160\x65"] . "\40\x43\x48\x41\x52\101\103\124\105\122\x20\123\x45\124\x20" . $this->CHARACTER_SET; goto l_EGF; VsWWW: mTnGy: goto r6IcW; aI2Yl: goto kBo5J; goto w6P27; r6IcW: } goto nSZ2a; pCqKE: CrvSJ: goto yROYq; yROYq: } goto BgNpK; BgNpK: jUcFL: goto vhLaM; YHPwA: } function in_array_recursive($needle, $haystack, $strict = false) { goto jLD10; jLD10: foreach ($haystack as $array => $item) { goto nXXVD; y1W2n: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto kRUzh; } goto Gy2vw; fG4Pv: mzrv8: goto sL96o; GK23I: kRUzh: goto fG4Pv; nXXVD: $item = $item["\106\151\145\x6c\x64"]; goto y1W2n; Gy2vw: return true; goto GK23I; sL96o: } goto JaAbi; JaAbi: nOnLz: goto PLlIH; PLlIH: return false; goto vgoZq; vgoZq: } }
