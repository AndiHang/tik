<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto Y8NhY; NQduh: cWZ6b: goto eBy6z; HZfrb: exit("\116\157\x20\144\151\162\145\143\x74\40\x73\143\162\x69\160\x74\x20\141\x63\143\145\163\163\x20\141\x6c\154\157\x77\x65\144"); goto NQduh; Y8NhY: if (defined("\x42\x41\x53\x45\x50\x41\x54\110")) { goto cWZ6b; } goto HZfrb; eBy6z: class Compare extends CI_Controller { function __construct() { goto AQv28; o2Oh3: $this->CHARACTER_SET = "\x75\x74\146\x38\40\103\x4f\x4c\x4c\x41\124\105\x20\x75\x74\146\70\137\147\145\x6e\145\x72\x61\154\137\143\151"; goto Ie8P0; Ie8P0: $this->DB1 = $this->load->database("\155\141\151\156\x5f\x67\141\x72\x75\144\x61", TRUE); goto wkU2W; wkU2W: $this->DB2 = $this->load->database("\x6c\x69\x76\x65", TRUE); goto yZ6Y0; AQv28: parent::__construct(); goto o2Oh3; yZ6Y0: } function index() { goto KI3Kn; Ix5n4: echo "\x3c\x70\x72\145\x3e\xa"; goto KF0aH; HAuSj: echo "\74\x68\x32\x3e\x54\150\145\40\x64\x61\x74\141\x62\141\x73\x65\40\151\163\x20\x6f\x75\x74\40\157\146\x20\x53\171\x6e\143\x21\x3c\x2f\x68\62\x3e\12"; goto PYkfG; dIn2K: R_Lj3: goto HAuSj; z1AzN: $tables_to_drop = array_diff($live_tables, $development_tables); goto R_1fK; d2TD0: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto UL6Kz; ZakRB: Yq0v_: goto Ix5n4; VDA1g: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; zgO6F: } goto ZakRB; A9qZM: goto jU3x5; goto dIn2K; Bmcjn: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto GudKs; juTXq: $live_tables = $this->DB2->list_tables(); goto sqjM9; RbCut: echo "\x3c\150\x32\76\124\150\x65\40\144\141\x74\x61\142\141\x73\145\x20\141\160\160\145\x61\x72\x73\x20\x74\x6f\40\x62\x65\x20\165\x70\x20\164\x6f\40\x64\141\164\x65\74\x2f\150\x32\76\12"; goto A9qZM; GudKs: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto R_Lj3; } goto RbCut; hY_Zx: echo "\74\x70\162\145\40\163\164\171\x6c\145\x3d\47\160\141\144\144\x69\x6e\147\72\40\x32\x30\x70\x78\x3b\x20\x62\x61\x63\153\x67\x72\157\x75\156\x64\x2d\x63\x6f\154\x6f\162\72\x20\43\x46\x46\x46\x41\106\60\73\x27\76\xa"; goto VDA1g; RqJ_0: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\162\x6f\160")) : array(); goto d2TD0; PYkfG: echo "\74\x70\x3e\x54\x68\x65\x20\146\157\x6c\x6c\157\x77\151\156\x67\40\x53\x51\x4c\40\143\x6f\x6d\155\141\156\x64\163\x20\x6e\145\x65\x64\40\x74\157\40\142\x65\x20\145\x78\x65\143\165\x74\145\144\40\164\157\40\x62\162\151\156\x67\40\x74\x68\x65\40\x4c\x69\x76\x65\40\144\141\x74\x61\x62\141\163\145\x20\164\141\x62\154\145\163\x20\x75\x70\x20\x74\157\x20\144\x61\x74\145\x3a\x20\x3c\x2f\160\x3e\12"; goto hY_Zx; sqjM9: $tables_to_create = array_diff($development_tables, $live_tables); goto z1AzN; OPvcS: $development_tables = $this->DB1->list_tables(); goto juTXq; KF0aH: jU3x5: goto alG5b; KI3Kn: $sql_commands_to_run = array(); goto OPvcS; R_1fK: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\162\x65\x61\164\x65")) : array(); goto RqJ_0; UL6Kz: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto Bmcjn; alG5b: } function manage_tables($tables, $action) { goto V0kX0; jKnAa: L3u4y: goto zjekr; V0kX0: $sql_commands_to_run = array(); goto UdEXe; YWtrs: x5KSI: goto FH3NI; uytIc: return $sql_commands_to_run; goto fR4da; Zd_6D: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\x52\117\120\x20\124\101\102\x4c\x45\x20{$table}\73"; RnGiH: } goto YWtrs; zjekr: CAaC2: goto yquNG; UdEXe: if (!($action == "\x63\x72\145\141\164\145")) { goto CAaC2; } goto AQhPQ; AQhPQ: foreach ($tables as $table) { goto cGiJc; cGiJc: $query = $this->DB1->query("\123\x48\x4f\127\x20\x43\x52\105\101\x54\x45\40\x54\101\x42\114\105\40\140{$table}\140\40\x2d\x2d\x20\143\162\x65\141\x74\145\40\x74\141\x62\154\x65\163"); goto PCR8x; PCR8x: $table_structure = $query->row_array(); goto FO0f2; WfvPF: g26UX: goto eDOj1; FO0f2: $sql_commands_to_run[] = $table_structure["\x43\162\145\141\x74\x65\x20\124\141\142\154\145"] . "\x3b"; goto WfvPF; eDOj1: } goto jKnAa; FH3NI: fMYTS: goto uytIc; yquNG: if (!($action == "\x64\x72\157\x70")) { goto fMYTS; } goto Zd_6D; fR4da: } function compare_table_structures($development_tables, $live_tables) { goto S7QVc; CLA1F: foreach ($development_tables as $table) { goto p1GER; p1GER: $development_table = $development_table_structures[$table]; goto gsj4D; Xufyl: h3cQy: goto vlZDE; gsj4D: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto ZqlRs; zOKZ2: n_Rvz: goto Xufyl; ZqlRs: if (!($this->count_differences($development_table, $live_table) > 0)) { goto n_Rvz; } goto dkDtG; dkDtG: $tables_need_updating[] = $table; goto zOKZ2; vlZDE: } goto lP4kw; bMl57: $live_table_structures = $development_table_structures = array(); goto lnEDM; bbunX: foreach ($live_tables as $table) { goto jJ_Td; jJ_Td: $query = $this->DB2->query("\123\110\x4f\127\x20\x43\122\x45\101\124\x45\x20\x54\x41\102\x4c\x45\x20\x60{$table}\140\x20\55\55\x20\154\x69\166\145"); goto YgzkX; w0uu5: u1IRp: goto c9vQW; YgzkX: $table_structure = $query->row_array(); goto v9uf6; v9uf6: $live_table_structures[$table] = $table_structure["\x43\162\145\141\164\145\x20\124\x61\142\154\x65"]; goto w0uu5; c9vQW: } goto pCoiB; S7QVc: $tables_need_updating = array(); goto bMl57; lP4kw: DfMvC: goto Oq1td; r_imN: Av2qO: goto bbunX; Oq1td: return $tables_need_updating; goto ALlqP; lnEDM: foreach ($development_tables as $table) { goto LEf08; vOSod: $development_table_structures[$table] = $table_structure["\x43\162\145\x61\x74\x65\40\x54\141\x62\154\145"]; goto N1gdj; N1gdj: m6Ezx: goto brYMV; LEf08: $query = $this->DB1->query("\123\x48\x4f\127\40\103\122\105\101\x54\x45\x20\x54\101\102\x4c\105\40\x60{$table}\140\x20\55\x2d\40\144\145\166"); goto vtQn7; vtQn7: $table_structure = $query->row_array(); goto vOSod; brYMV: } goto r_imN; pCoiB: i6y0B: goto CLA1F; ALlqP: } function count_differences($old, $new) { goto QdHPd; cvB6Y: if (!($old[$i] != $new[$i])) { goto mRWb2; } goto fK5Li; rYWAF: $new = trim(preg_replace("\57\x5c\x73\x2b\57", '', $new)); goto Wr0rV; hVP2x: VwoY0: goto xQCmi; HSXXS: $length = max(count($old), count($new)); goto tfRcu; Wr0rV: if (!($old == $new)) { goto VwoY0; } goto KJSqZ; tfRcu: $i = 0; goto mien2; mien2: yON_0: goto kiH4C; dM6vs: goto yON_0; goto pO4Rx; hEzck: $i++; goto dM6vs; kiH4C: if (!($i < $length)) { goto VGCX9; } goto cvB6Y; fK5Li: $differences++; goto eXX2S; IvKFQ: $new = explode("\40", $new); goto HSXXS; BDaaT: efSfO: goto hEzck; pO4Rx: VGCX9: goto ErDZW; eXX2S: mRWb2: goto BDaaT; QdHPd: $differences = 0; goto FvQZB; KJSqZ: return $differences; goto hVP2x; ErDZW: return $differences; goto gPzrA; FvQZB: $old = trim(preg_replace("\57\134\163\x2b\57", '', $old)); goto rYWAF; xQCmi: $old = explode("\40", $old); goto IvKFQ; gPzrA: } function update_existing_tables($tables) { goto cAT3b; cAT3b: $sql_commands_to_run = array(); goto DFhH4; eTXmj: taf0u: goto dn6bi; VP_XP: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto ORSvv; ORSvv: return $sql_commands_to_run; goto uliUg; xmZre: if (!(is_array($tables) && !empty($tables))) { goto GgDcl; } goto rzcU2; rzcU2: foreach ($tables as $table) { goto qNPb9; w86pH: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto XzZuE; qNPb9: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto w86pH; XzZuE: yShUq: goto qgnyd; qgnyd: } goto eTXmj; dn6bi: GgDcl: goto VP_XP; DFhH4: $table_structure_development = array(); goto sEeGR; sEeGR: $table_structure_live = array(); goto xmZre; uliUg: } function table_field_data($database, $table) { goto BsLJf; hbyzU: $result = mysql_query("\x53\110\x4f\x57\40\103\117\x4c\125\115\x4e\x53\40\106\122\x4f\115\40\x60{$table}\140"); goto W7zMg; Bm1ZS: mysql_select_db($database["\144\141\164\141\142\x61\163\x65"]); goto hbyzU; W7zMg: OGj9R: goto ODTPG; t9OIK: PIWD_: goto CnGOp; ODTPG: if (!($row = mysql_fetch_assoc($result))) { goto PIWD_; } goto WNv3x; WNv3x: $fields[] = $row; goto iBWYi; BsLJf: $conn = mysqli_connect($database["\150\157\163\x74\x6e\141\155\145"], $database["\x75\163\145\x72\x6e\141\155\x65"], $database["\x70\x61\163\163\167\157\162\x64"]); goto Bm1ZS; iBWYi: goto OGj9R; goto t9OIK; CnGOp: return $fields; goto vvone; vvone: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto qOmFM; WC_tW: k92Sf: goto cbpeJ; rjRnl: foreach ($source_field_structures as $table => $fields) { goto hcZsT; RINz2: TdJ0L: goto TCeO1; TCeO1: Smp7f: goto t66aa; hcZsT: foreach ($fields as $field) { goto d1zVt; krw7P: $modify_field .= isset($fields[$n]["\x45\170\164\x72\x61"]) && $fields[$n]["\x45\170\x74\x72\141"] != '' ? "\40" . $fields[$n]["\x45\x78\x74\x72\x61"] : ''; goto JA3j7; T0knJ: U_Vv_: goto uh6uJ; PCwaP: $add_field .= "\40\x44\x45\106\101\x55\114\x54\x20" . $field["\104\x65\x66\x61\165\x6c\164"]; goto st0UC; Yodu5: ngEr3: goto T0knJ; ZVtDF: $modify_field .= isset($fields[$n]["\x4e\165\154\x6c"]) && $fields[$n]["\x4e\x75\154\154"] == "\131\105\x53" ? "\40\x4e\125\114\x4c" : "\40\x4e\117\124\x20\x4e\125\x4c\x4c"; goto krw7P; d1zVt: if ($this->in_array_recursive($field["\106\x69\145\x6c\144"], $destination_field_structures[$table])) { goto Mt3FZ; } goto J5cNM; JJodK: $add_field .= isset($field["\x4e\165\154\154"]) && $field["\116\165\154\154"] == "\131\105\123" ? "\40\116\x75\x6c\x6c" : ''; goto PCwaP; BUYI0: uDV_E: goto WtHuL; SNH1d: goto f_Khk; goto pj9ye; st0UC: $add_field .= isset($field["\105\170\x74\x72\141"]) && $field["\105\170\x74\x72\x61"] != '' ? "\40" . $field["\105\170\164\x72\x61"] : ''; goto R8wUX; IyHl2: Mt3FZ: goto XJmU_; RkHWW: if (!(is_array($differences) && !empty($differences))) { goto fzqYA; } goto ASh47; gGjdV: goto Zf4lL; goto IyHl2; JA3j7: $modify_field .= isset($previous_field) && $previous_field != '' ? "\40\x41\106\124\105\x52\40" . $previous_field : ''; goto sPZtC; uh6uJ: $n++; goto SNH1d; cvkvn: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto RkHWW; XYOra: $sql_commands_to_run[] = $modify_field; goto Yodu5; Ctcg1: $previous_field = $fields[$n]["\106\x69\x65\154\x64"]; goto KvDTk; Z2C9E: Zf4lL: goto BUYI0; hVaVj: f_Khk: goto cO6j6; A93Gj: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\145\154\x64"] == $destination_field_structures[$table][$n]["\106\151\x65\154\x64"])) { goto ZNvPR; } goto cvkvn; XJmU_: $modify_field = ''; goto hrJJ2; ASh47: $modify_field = "\x41\114\x54\x45\x52\40\124\101\102\114\105\x20{$table}\40\x4d\x4f\x44\111\106\131\x20\103\117\114\x55\x4d\116\x20\140" . $fields[$n]["\106\151\x65\154\144"] . "\x60\40" . $fields[$n]["\x54\171\x70\x65"] . "\40\x43\110\101\122\x41\103\x54\105\x52\x20\x53\x45\124\40" . $this->CHARACTER_SET; goto s2Iao; s2Iao: $modify_field .= isset($fields[$n]["\x44\145\146\141\165\154\164"]) && $fields[$n]["\x44\145\146\141\165\154\164"] != '' ? "\40\104\105\106\101\125\x4c\124\x20\47" . $fields[$n]["\104\145\146\141\x75\154\164"] . "\x27" : ''; goto ZVtDF; cO6j6: if (!($n < count($fields))) { goto FShmn; } goto A93Gj; Vefkp: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto ngEr3; } goto XYOra; Yx2db: $sql_commands_to_run[] = $add_field; goto gGjdV; pj9ye: FShmn: goto Z2C9E; sPZtC: $modify_field .= "\x3b"; goto o3mDZ; o3mDZ: fzqYA: goto Ctcg1; R8wUX: $add_field .= "\x3b"; goto Yx2db; J5cNM: $add_field = "\x41\114\x54\105\122\x20\124\101\x42\x4c\105\x20{$table}\x20\101\x44\x44\40\103\117\x4c\125\x4d\x4e\40\140" . $field["\106\x69\x65\154\x64"] . "\140\40" . $field["\124\171\x70\145"] . "\40\x43\110\x41\122\x41\103\x54\105\x52\x20\123\x45\x54\x20" . $this->CHARACTER_SET; goto JJodK; hrJJ2: $n = 0; goto hVaVj; KvDTk: ZNvPR: goto Vefkp; WtHuL: } goto RINz2; t66aa: } goto WC_tW; cbpeJ: return $sql_commands_to_run; goto XJYGC; qOmFM: $sql_commands_to_run = array(); goto rjRnl; XJYGC: } function in_array_recursive($needle, $haystack, $strict = false) { goto vPErF; aeAyl: OPTce: goto HdHOk; vPErF: foreach ($haystack as $array => $item) { goto ZF1w9; ZF1w9: $item = $item["\106\x69\x65\154\x64"]; goto JrBmG; W1xmQ: return true; goto ZCkmx; ZCkmx: ttY_y: goto gvE9G; gvE9G: j9yh1: goto q7YPt; JrBmG: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto ttY_y; } goto W1xmQ; q7YPt: } goto aeAyl; HdHOk: return false; goto kVAor; kVAor: } }
