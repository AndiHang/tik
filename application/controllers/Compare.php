<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto Tq_mr; VdSY4: vycC2: goto CojRa; Tq_mr: if (defined("\102\x41\123\x45\x50\x41\x54\110")) { goto vycC2; } goto qLcpm; qLcpm: exit("\116\x6f\40\144\151\162\145\x63\164\x20\x73\x63\162\x69\x70\x74\x20\x61\143\143\145\x73\x73\x20\141\154\x6c\x6f\167\145\144"); goto VdSY4; CojRa: class Compare extends CI_Controller { function __construct() { goto jnnhx; HOkYE: $this->DB1 = $this->load->database("\x6d\141\151\x6e\x5f\147\141\x72\165\144\x61", TRUE); goto Q6Cip; Q6Cip: $this->DB2 = $this->load->database("\154\151\x76\145", TRUE); goto o3GR_; jnnhx: parent::__construct(); goto lb7Th; lb7Th: $this->CHARACTER_SET = "\x75\164\146\x38\x20\x43\117\x4c\x4c\x41\x54\x45\x20\x75\x74\x66\x38\137\x67\x65\x6e\x65\x72\x61\x6c\x5f\x63\151"; goto HOkYE; o3GR_: } function index() { goto fDe4I; ZZMtD: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto UPH21; kAcYR: $live_tables = $this->DB2->list_tables(); goto wxe1x; UPH21: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto RcNKj; ZfHJd: echo "\x3c\x70\162\x65\x20\x73\x74\171\154\145\x3d\x27\x70\x61\144\144\151\x6e\147\x3a\40\x32\x30\x70\x78\73\x20\x62\141\143\x6b\x67\x72\157\165\156\144\x2d\x63\157\154\x6f\162\x3a\40\x23\106\106\x46\101\106\60\73\x27\x3e\xa"; goto jGw71; GK7Fl: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\162\145\x61\x74\x65")) : array(); goto CLcKd; IM3xH: $development_tables = $this->DB1->list_tables(); goto kAcYR; CLcKd: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\162\157\x70")) : array(); goto wyauv; UqeTd: D07qE: goto LtVFo; yBDAW: echo "\74\160\x3e\124\x68\x65\x20\146\x6f\x6c\154\x6f\167\x69\156\147\x20\123\121\114\x20\x63\x6f\155\x6d\141\156\x64\163\x20\156\145\x65\x64\x20\x74\157\x20\x62\x65\x20\145\x78\145\x63\x75\x74\145\144\x20\x74\x6f\40\142\162\x69\x6e\x67\40\x74\x68\145\40\x4c\151\x76\x65\x20\144\x61\x74\x61\x62\141\x73\x65\40\x74\141\x62\x6c\x65\x73\40\165\x70\x20\x74\x6f\40\x64\141\164\x65\72\x20\74\x2f\160\76\xa"; goto ZfHJd; l5RfB: u4Ign: goto MbgDt; YdVmp: pLBbh: goto VSagF; LtVFo: echo "\74\x70\162\x65\76\12"; goto YdVmp; RcNKj: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto u4Ign; } goto Lmtqc; hi4vN: $tables_to_drop = array_diff($live_tables, $development_tables); goto GK7Fl; jGw71: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\12"; CtHO4: } goto UqeTd; wyauv: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto ZZMtD; MbgDt: echo "\74\150\62\76\124\150\x65\40\x64\x61\164\x61\142\x61\163\145\40\151\x73\x20\x6f\165\164\40\x6f\146\40\x53\x79\x6e\x63\41\74\57\x68\62\76\12"; goto yBDAW; fDe4I: $sql_commands_to_run = array(); goto IM3xH; Lmtqc: echo "\x3c\x68\x32\76\124\x68\x65\40\x64\x61\164\141\142\141\x73\x65\40\x61\160\x70\145\x61\162\163\x20\164\157\40\142\x65\40\165\x70\x20\x74\157\40\x64\x61\164\x65\74\57\150\x32\x3e\12"; goto X853j; X853j: goto pLBbh; goto l5RfB; wxe1x: $tables_to_create = array_diff($development_tables, $live_tables); goto hi4vN; VSagF: } function manage_tables($tables, $action) { goto QJ4HZ; QJ4HZ: $sql_commands_to_run = array(); goto w823Z; MyC9G: foreach ($tables as $table) { goto AJDov; AJDov: $query = $this->DB1->query("\x53\110\x4f\127\x20\x43\122\105\x41\124\105\40\x54\101\102\x4c\105\x20\140{$table}\x60\x20\x2d\x2d\x20\143\x72\145\141\164\x65\x20\x74\141\x62\x6c\145\x73"); goto ft0e0; luaDx: $sql_commands_to_run[] = $table_structure["\x43\x72\145\x61\x74\x65\40\x54\x61\142\x6c\x65"] . "\x3b"; goto ghpNi; ghpNi: X0_Nv: goto cNKXE; ft0e0: $table_structure = $query->row_array(); goto luaDx; cNKXE: } goto nE8a5; iXQNB: return $sql_commands_to_run; goto d603A; nE8a5: YtbOe: goto Pwyby; R2z8Q: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\122\x4f\120\x20\x54\101\x42\x4c\x45\x20{$table}\x3b"; rakGs: } goto vqoq_; TKFXx: vNcpI: goto iXQNB; Nnlxg: if (!($action == "\x64\x72\x6f\x70")) { goto vNcpI; } goto R2z8Q; Pwyby: IXlU0: goto Nnlxg; vqoq_: CGspJ: goto TKFXx; w823Z: if (!($action == "\x63\x72\145\x61\x74\145")) { goto IXlU0; } goto MyC9G; d603A: } function compare_table_structures($development_tables, $live_tables) { goto vz5y3; HTFmh: return $tables_need_updating; goto uaIpJ; cZg2k: hWDEn: goto HTFmh; Sgrky: HJVTL: goto uWvss; A8d4W: $live_table_structures = $development_table_structures = array(); goto EK43P; uWvss: foreach ($development_tables as $table) { goto iQ9cT; GYqOP: $tables_need_updating[] = $table; goto ezpxP; xbHX9: if (!($this->count_differences($development_table, $live_table) > 0)) { goto U3pwf; } goto GYqOP; VnDJr: RHxOI: goto mc8Fg; ezpxP: U3pwf: goto VnDJr; UazMx: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto xbHX9; iQ9cT: $development_table = $development_table_structures[$table]; goto UazMx; mc8Fg: } goto cZg2k; WiTi5: r_NXq: goto bZmBz; bZmBz: foreach ($live_tables as $table) { goto rsU1x; hbye1: NkxFc: goto ey1PY; rsU1x: $query = $this->DB2->query("\123\110\x4f\x57\x20\x43\122\x45\x41\124\x45\40\124\101\102\x4c\105\x20\140{$table}\140\40\x2d\55\40\x6c\x69\166\145"); goto v1kmz; v1kmz: $table_structure = $query->row_array(); goto aDz13; aDz13: $live_table_structures[$table] = $table_structure["\x43\x72\145\141\164\145\x20\x54\x61\x62\x6c\x65"]; goto hbye1; ey1PY: } goto Sgrky; vz5y3: $tables_need_updating = array(); goto A8d4W; EK43P: foreach ($development_tables as $table) { goto Weeq_; Weeq_: $query = $this->DB1->query("\123\x48\117\x57\40\103\122\105\x41\x54\x45\x20\124\101\x42\114\105\x20\140{$table}\x60\x20\x2d\x2d\40\144\145\x76"); goto qb8yc; qb8yc: $table_structure = $query->row_array(); goto K1sd5; K1sd5: $development_table_structures[$table] = $table_structure["\103\162\x65\x61\164\145\40\124\141\142\x6c\x65"]; goto riMYl; riMYl: GPZEB: goto toAs6; toAs6: } goto WiTi5; uaIpJ: } function count_differences($old, $new) { goto Swx0B; weWx5: if (!($old[$i] != $new[$i])) { goto tzjwx; } goto G5ldN; lrCiF: return $differences; goto MTZLp; Swx0B: $differences = 0; goto yc2w4; VdDIx: return $differences; goto UeDUy; LxR4W: goto QmB6q; goto H8oP6; zr2eU: if (!($old == $new)) { goto dIcMP; } goto lrCiF; wzOS7: lBt2s: goto y2HsC; KxP9J: $i = 0; goto x2qoz; G5ldN: $differences++; goto czcqT; U72hx: $old = explode("\40", $old); goto SvGav; MTZLp: dIcMP: goto U72hx; x2qoz: QmB6q: goto xPMTq; I3xYO: $length = max(count($old), count($new)); goto KxP9J; SvGav: $new = explode("\40", $new); goto I3xYO; czcqT: tzjwx: goto wzOS7; H8oP6: A0pXH: goto VdDIx; xPMTq: if (!($i < $length)) { goto A0pXH; } goto weWx5; SYiQW: $new = trim(preg_replace("\x2f\x5c\163\53\x2f", '', $new)); goto zr2eU; y2HsC: $i++; goto LxR4W; yc2w4: $old = trim(preg_replace("\x2f\134\x73\x2b\57", '', $old)); goto SYiQW; UeDUy: } function update_existing_tables($tables) { goto R64gb; KN0Qy: if (!(is_array($tables) && !empty($tables))) { goto lwPCC; } goto G4cn1; LmD_3: lwPCC: goto jWbAd; UZAWv: $table_structure_live = array(); goto KN0Qy; jWbAd: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto rq8TD; DTwi1: $table_structure_development = array(); goto UZAWv; xnqIt: T33lS: goto LmD_3; rq8TD: return $sql_commands_to_run; goto nFqMo; R64gb: $sql_commands_to_run = array(); goto DTwi1; G4cn1: foreach ($tables as $table) { goto qNMuE; kv0M4: Lwsbr: goto uG_2V; vHZoO: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto kv0M4; qNMuE: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto vHZoO; uG_2V: } goto xnqIt; nFqMo: } function table_field_data($database, $table) { goto xnPDT; xnPDT: $conn = mysqli_connect($database["\150\x6f\x73\x74\156\141\155\x65"], $database["\165\163\145\162\x6e\141\155\x65"], $database["\x70\x61\x73\x73\167\157\x72\144"]); goto KtWK0; Qrsi8: $result = mysql_query("\123\x48\x4f\127\40\103\117\114\125\x4d\x4e\123\x20\106\x52\117\115\x20\140{$table}\140"); goto BBXJj; fEg_M: return $fields; goto Ni34R; uivgY: $fields[] = $row; goto C30ty; BBXJj: Ap07K: goto a5Wbs; a5Wbs: if (!($row = mysql_fetch_assoc($result))) { goto rJVZe; } goto uivgY; KtWK0: mysql_select_db($database["\x64\x61\x74\141\142\141\x73\x65"]); goto Qrsi8; swd07: rJVZe: goto fEg_M; C30ty: goto Ap07K; goto swd07; Ni34R: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto Lrf51; Lrf51: $sql_commands_to_run = array(); goto DiO36; mBpv3: xrW9o: goto QouyL; DiO36: foreach ($source_field_structures as $table => $fields) { goto G8OhC; BMubB: c_En3: goto zmT21; zmT21: Rc5Zb: goto cGXoT; G8OhC: foreach ($fields as $field) { goto LMdIk; jbFgL: $modify_field .= isset($fields[$n]["\x44\145\146\141\165\x6c\x74"]) && $fields[$n]["\x44\145\x66\141\x75\154\x74"] != '' ? "\40\x44\x45\x46\x41\x55\114\124\40\47" . $fields[$n]["\x44\145\146\141\x75\154\164"] . "\x27" : ''; goto mz42a; mz42a: $modify_field .= isset($fields[$n]["\x4e\x75\x6c\154"]) && $fields[$n]["\x4e\165\x6c\154"] == "\131\x45\123" ? "\x20\x4e\125\114\114" : "\x20\x4e\117\x54\x20\x4e\x55\114\114"; goto pLn9d; yo8Zi: goto Zxa6k; goto OXAue; ef6hn: c256I: goto qQUcJ; cMI28: $n++; goto yo8Zi; RZ2mQ: if (!($n < count($fields))) { goto KPhHh; } goto ayfjc; kCJcz: CVGAD: goto DdUpY; OXAue: KPhHh: goto ezIb9; qQUcJ: $previous_field = $fields[$n]["\x46\151\145\x6c\x64"]; goto z4Wzx; pLn9d: $modify_field .= isset($fields[$n]["\x45\170\x74\162\141"]) && $fields[$n]["\105\x78\x74\x72\x61"] != '' ? "\x20" . $fields[$n]["\105\170\164\x72\141"] : ''; goto rX0P9; ezIb9: CNldI: goto kCJcz; ojaxg: $n = 0; goto kpoJh; vchvb: XT_WW: goto cMI28; jpzd8: PdoDh: goto kXjZu; ftWJ_: $add_field .= isset($field["\105\170\x74\162\141"]) && $field["\105\170\164\x72\x61"] != '' ? "\40" . $field["\x45\x78\x74\x72\x61"] : ''; goto YkKnf; YkKnf: $add_field .= "\x3b"; goto hwc21; LMdIk: if ($this->in_array_recursive($field["\106\151\x65\154\x64"], $destination_field_structures[$table])) { goto PdoDh; } goto X2sYQ; BcHQs: $add_field .= "\40\104\105\106\x41\125\114\124\40" . $field["\x44\145\146\141\x75\154\164"]; goto ftWJ_; BmdqA: if (!(is_array($differences) && !empty($differences))) { goto c256I; } goto xXlGd; N0CPa: sOkyA: goto vchvb; ASmEl: $modify_field .= "\73"; goto ef6hn; ukMWd: $sql_commands_to_run[] = $modify_field; goto N0CPa; wlbDL: $add_field .= isset($field["\116\x75\x6c\154"]) && $field["\116\165\154\x6c"] == "\x59\x45\123" ? "\x20\116\x75\x6c\154" : ''; goto BcHQs; hwc21: $sql_commands_to_run[] = $add_field; goto t9AIf; kpoJh: Zxa6k: goto RZ2mQ; t9AIf: goto CNldI; goto jpzd8; gyNnG: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto sOkyA; } goto ukMWd; z4Wzx: Brwmm: goto gyNnG; kXjZu: $modify_field = ''; goto ojaxg; xXlGd: $modify_field = "\x41\114\x54\105\x52\x20\x54\x41\x42\114\x45\40{$table}\40\x4d\117\104\111\x46\x59\x20\103\117\114\125\x4d\116\40\140" . $fields[$n]["\x46\151\x65\154\x64"] . "\140\40" . $fields[$n]["\x54\171\160\x65"] . "\40\x43\110\101\x52\x41\103\124\x45\122\40\x53\x45\124\40" . $this->CHARACTER_SET; goto jbFgL; Xyg0I: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto BmdqA; X2sYQ: $add_field = "\101\114\x54\105\x52\40\124\101\102\114\x45\40{$table}\x20\101\104\104\x20\x43\117\x4c\x55\x4d\x4e\40\140" . $field["\106\151\x65\x6c\x64"] . "\x60\40" . $field["\124\171\160\145"] . "\40\103\x48\101\122\101\x43\x54\x45\x52\x20\123\105\124\40" . $this->CHARACTER_SET; goto wlbDL; rX0P9: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\101\x46\x54\x45\122\40" . $previous_field : ''; goto ASmEl; ayfjc: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\106\151\145\154\144"] == $destination_field_structures[$table][$n]["\x46\151\x65\154\x64"])) { goto Brwmm; } goto Xyg0I; DdUpY: } goto BMubB; cGXoT: } goto mBpv3; QouyL: return $sql_commands_to_run; goto sEYcn; sEYcn: } function in_array_recursive($needle, $haystack, $strict = false) { goto IdYk3; pygdT: return false; goto H9FaG; SOL36: JNqyF: goto pygdT; IdYk3: foreach ($haystack as $array => $item) { goto QdD_F; FRKYl: EubKn: goto Sy8yW; OH16v: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto EubKn; } goto OgcbQ; Sy8yW: VZ6lI: goto MhbQg; OgcbQ: return true; goto FRKYl; QdD_F: $item = $item["\x46\x69\145\x6c\144"]; goto OH16v; MhbQg: } goto SOL36; H9FaG: } }
