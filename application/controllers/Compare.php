<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto Efs3k; Efs3k: if (defined("\x42\101\x53\x45\120\x41\x54\x48")) { goto hSmwe; } goto x7KoT; x7KoT: exit("\116\x6f\x20\144\x69\x72\x65\x63\x74\x20\163\x63\x72\151\x70\x74\40\x61\143\x63\145\x73\x73\x20\x61\x6c\154\x6f\x77\x65\144"); goto hKanq; hKanq: hSmwe: goto jWPYg; jWPYg: class Compare extends CI_Controller { function __construct() { goto i9O24; INWXR: $this->CHARACTER_SET = "\x75\x74\146\70\x20\x43\x4f\114\x4c\101\x54\105\x20\x75\x74\146\70\x5f\x67\x65\x6e\x65\162\x61\154\137\x63\151"; goto kGIcJ; kGIcJ: $this->DB1 = $this->load->database("\155\141\151\156\x5f\x67\141\x72\x75\x64\141", TRUE); goto GfHD9; GfHD9: $this->DB2 = $this->load->database("\154\151\x76\145", TRUE); goto va5yG; i9O24: parent::__construct(); goto INWXR; va5yG: } function index() { goto K79dl; nCzKb: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\143\162\145\141\x74\x65")) : array(); goto or2VK; RuZj6: echo "\x3c\x68\62\x3e\124\x68\x65\x20\x64\x61\164\x61\x62\x61\163\145\40\x61\x70\x70\145\x61\x72\163\x20\x74\x6f\x20\142\x65\x20\x75\x70\40\x74\157\40\144\x61\x74\x65\74\57\x68\62\x3e\xa"; goto jLWpz; jLWpz: goto eC23n; goto ZJl2x; zzvWB: $tables_to_create = array_diff($development_tables, $live_tables); goto iYuRS; or2VK: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\x64\x72\x6f\160")) : array(); goto rMyoO; E_YC8: echo "\74\160\162\x65\76\xa"; goto lxXi8; o9hSc: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; Ick60: } goto jBeCO; K79dl: $sql_commands_to_run = array(); goto af9RG; lxXi8: eC23n: goto NFHuX; ZJl2x: SEBY0: goto Z8HSj; af9RG: $development_tables = $this->DB1->list_tables(); goto ff5RG; I7UAs: echo "\74\160\x3e\124\150\145\x20\x66\x6f\154\x6c\157\x77\151\156\147\x20\x53\121\114\x20\x63\x6f\155\x6d\x61\x6e\x64\x73\x20\156\145\145\x64\40\x74\157\40\142\145\40\145\x78\145\143\x75\164\x65\144\40\x74\157\40\142\162\x69\x6e\x67\x20\164\x68\x65\40\x4c\151\x76\x65\40\144\x61\x74\141\142\x61\x73\x65\40\164\141\x62\x6c\x65\x73\x20\165\160\40\x74\157\x20\144\x61\x74\x65\x3a\x20\74\x2f\160\76\xa"; goto xzKQI; jBeCO: mP3FL: goto E_YC8; SvVZg: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto TxyVt; xzKQI: echo "\74\x70\x72\x65\x20\x73\x74\171\x6c\145\75\x27\x70\x61\144\144\x69\x6e\x67\x3a\40\x32\x30\160\170\x3b\40\x62\141\143\x6b\147\x72\x6f\x75\x6e\144\55\x63\157\x6c\157\x72\72\40\x23\106\x46\106\x41\x46\x30\73\47\76\12"; goto o9hSc; ff5RG: $live_tables = $this->DB2->list_tables(); goto zzvWB; TxyVt: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto SEBY0; } goto RuZj6; iYuRS: $tables_to_drop = array_diff($live_tables, $development_tables); goto nCzKb; dTJCk: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto SvVZg; Z8HSj: echo "\74\x68\62\x3e\x54\x68\145\40\144\141\164\x61\142\x61\163\145\40\x69\x73\x20\x6f\x75\164\x20\x6f\146\x20\123\171\156\x63\x21\x3c\57\150\62\x3e\xa"; goto I7UAs; rMyoO: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto dTJCk; NFHuX: } function manage_tables($tables, $action) { goto xs0Yu; YrkRc: BKAhe: goto CoSTq; xs0Yu: $sql_commands_to_run = array(); goto CcH1z; G3m8X: foreach ($tables as $table) { goto tft3R; a7n5f: $sql_commands_to_run[] = $table_structure["\103\162\x65\x61\x74\x65\x20\124\141\142\x6c\145"] . "\73"; goto jAKz0; fZE2m: $table_structure = $query->row_array(); goto a7n5f; jAKz0: G_kRX: goto vjLIQ; tft3R: $query = $this->DB1->query("\123\x48\x4f\127\40\103\x52\x45\x41\x54\105\x20\x54\x41\102\x4c\x45\x20\140{$table}\140\40\x2d\x2d\x20\x63\x72\x65\141\164\x65\40\164\x61\x62\154\x65\163"); goto fZE2m; vjLIQ: } goto A1Pz3; QtFEt: fKMMs: goto YrkRc; A1Pz3: nl6qK: goto DfE6_; CoSTq: return $sql_commands_to_run; goto OtWMD; vDmdB: if (!($action == "\x64\x72\x6f\x70")) { goto BKAhe; } goto JQqGK; JQqGK: foreach ($tables as $table) { $sql_commands_to_run[] = "\x44\122\117\x50\x20\x54\101\102\114\105\40{$table}\73"; cT869: } goto QtFEt; DfE6_: SNoIm: goto vDmdB; CcH1z: if (!($action == "\143\162\x65\x61\x74\145")) { goto SNoIm; } goto G3m8X; OtWMD: } function compare_table_structures($development_tables, $live_tables) { goto Oua2g; Oua2g: $tables_need_updating = array(); goto f1vB1; KeDLv: PaVlw: goto eh9cl; HvUCz: sg1Dg: goto iNxkL; eh9cl: foreach ($live_tables as $table) { goto kh3hH; tmVfS: $table_structure = $query->row_array(); goto Qvtml; Qvtml: $live_table_structures[$table] = $table_structure["\103\162\x65\141\164\x65\40\124\141\x62\x6c\145"]; goto s_tZf; kh3hH: $query = $this->DB2->query("\123\x48\117\127\x20\103\x52\105\x41\124\105\x20\124\101\x42\114\x45\x20\140{$table}\140\x20\x2d\x2d\40\154\151\x76\145"); goto tmVfS; s_tZf: xLVBE: goto W4Wj0; W4Wj0: } goto rVOaJ; f1vB1: $live_table_structures = $development_table_structures = array(); goto UjFqg; iNxkL: return $tables_need_updating; goto c5t3j; rVOaJ: OTiUt: goto WlzJJ; UjFqg: foreach ($development_tables as $table) { goto rZsrm; z3IJ3: $table_structure = $query->row_array(); goto U0ADr; rwGz7: C1psk: goto m6yy4; U0ADr: $development_table_structures[$table] = $table_structure["\103\x72\145\141\164\x65\40\x54\x61\142\154\145"]; goto rwGz7; rZsrm: $query = $this->DB1->query("\123\x48\117\127\x20\x43\122\x45\x41\x54\x45\x20\124\x41\102\x4c\x45\40\x60{$table}\x60\x20\x2d\55\x20\x64\145\x76"); goto z3IJ3; m6yy4: } goto KeDLv; WlzJJ: foreach ($development_tables as $table) { goto RLEoj; avWEz: Wks6J: goto dxzg_; kO_eL: $tables_need_updating[] = $table; goto FKXOD; O9Vsh: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto ZfR1W; RLEoj: $development_table = $development_table_structures[$table]; goto O9Vsh; FKXOD: ycqkA: goto avWEz; ZfR1W: if (!($this->count_differences($development_table, $live_table) > 0)) { goto ycqkA; } goto kO_eL; dxzg_: } goto HvUCz; c5t3j: } function count_differences($old, $new) { goto vb3a7; dT6G8: return $differences; goto SPwlN; eani2: meJlH: goto byLrX; kqzbC: $length = max(count($old), count($new)); goto bG0g0; wiu2t: $i++; goto jF77t; znrjh: $new = explode("\40", $new); goto kqzbC; WjzI9: $differences++; goto t_uHo; HC9S7: $new = trim(preg_replace("\x2f\134\x73\x2b\x2f", '', $new)); goto K2Dws; vb3a7: $differences = 0; goto Wtg1c; KksVJ: fAlcm: goto wiu2t; tQGe1: return $differences; goto eani2; dLCIg: wuKWF: goto SIjjb; K2Dws: if (!($old == $new)) { goto meJlH; } goto tQGe1; t_uHo: kImjg: goto KksVJ; gz70O: if (!($old[$i] != $new[$i])) { goto kImjg; } goto WjzI9; byLrX: $old = explode("\40", $old); goto znrjh; bG0g0: $i = 0; goto dLCIg; SIjjb: if (!($i < $length)) { goto jarpW; } goto gz70O; Wtg1c: $old = trim(preg_replace("\x2f\134\163\53\x2f", '', $old)); goto HC9S7; wtYPh: jarpW: goto dT6G8; jF77t: goto wuKWF; goto wtYPh; SPwlN: } function update_existing_tables($tables) { goto WtcoD; eLuQU: e__fh: goto XVddy; nJRVu: return $sql_commands_to_run; goto DUe7k; fMaFk: m6_Q2: goto eLuQU; yenDr: foreach ($tables as $table) { goto w91as; xng4W: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto qHzBg; qHzBg: zPPRB: goto VjAHI; w91as: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto xng4W; VjAHI: } goto fMaFk; SddRm: if (!(is_array($tables) && !empty($tables))) { goto e__fh; } goto yenDr; SizsG: $table_structure_live = array(); goto SddRm; XVddy: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto nJRVu; u01xt: $table_structure_development = array(); goto SizsG; WtcoD: $sql_commands_to_run = array(); goto u01xt; DUe7k: } function table_field_data($database, $table) { goto ho6Da; LlsZ7: $fields[] = $row; goto BSbPX; ho6Da: $conn = mysqli_connect($database["\150\157\x73\x74\x6e\141\155\145"], $database["\x75\163\x65\x72\x6e\x61\155\145"], $database["\160\141\x73\163\167\x6f\x72\144"]); goto PtAYq; BSbPX: goto A4foC; goto aQD0y; F3HZC: if (!($row = mysql_fetch_assoc($result))) { goto by5cv; } goto LlsZ7; jJvP2: $result = mysql_query("\x53\x48\117\x57\40\x43\117\x4c\125\x4d\116\123\x20\106\x52\x4f\115\40\140{$table}\x60"); goto p6SDH; p6SDH: A4foC: goto F3HZC; aQD0y: by5cv: goto ZoOTC; ZoOTC: return $fields; goto Md2xy; PtAYq: mysql_select_db($database["\x64\141\x74\x61\x62\x61\163\145"]); goto jJvP2; Md2xy: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto KvWbK; nhmPs: foreach ($source_field_structures as $table => $fields) { goto M2cVA; M2cVA: foreach ($fields as $field) { goto P32g_; MbUBx: $modify_field = ''; goto nl7D2; pJzN4: $modify_field .= isset($fields[$n]["\104\x65\x66\x61\x75\154\x74"]) && $fields[$n]["\x44\145\146\141\165\x6c\x74"] != '' ? "\40\x44\x45\x46\101\x55\114\124\40\x27" . $fields[$n]["\x44\x65\146\x61\165\154\x74"] . "\47" : ''; goto Nn1Oo; NCgQJ: OqGN2: goto Kx1ov; OrUbq: $sql_commands_to_run[] = $modify_field; goto YDiHz; PXD3q: EVLRC: goto ktzRY; EURAX: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\101\106\124\x45\x52\x20" . $previous_field : ''; goto ubX1m; UZHeI: $modify_field .= isset($fields[$n]["\105\170\x74\162\x61"]) && $fields[$n]["\x45\170\164\162\141"] != '' ? "\40" . $fields[$n]["\x45\x78\164\162\x61"] : ''; goto EURAX; EKO_A: if (!($n < count($fields))) { goto Atxpn; } goto XKojP; tDI43: $add_field .= "\40\x44\105\106\x41\x55\x4c\x54\40" . $field["\104\145\x66\x61\x75\x6c\x74"]; goto nHAk1; KKv6t: goto U8P5z; goto zeEKh; slzAK: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto rm6GM; jeNUB: $modify_field = "\x41\114\124\105\122\40\x54\101\102\x4c\x45\40{$table}\x20\115\117\x44\x49\106\131\x20\x43\x4f\114\x55\x4d\116\x20\x60" . $fields[$n]["\x46\x69\x65\154\144"] . "\140\x20" . $fields[$n]["\124\171\x70\145"] . "\x20\x43\110\x41\x52\101\103\124\x45\122\40\123\x45\x54\40" . $this->CHARACTER_SET; goto pJzN4; eCnPj: $add_field .= "\73"; goto dw59m; WKQMN: LEq3q: goto vVP6N; tps0w: goto EVLRC; goto lnxgS; XKojP: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\x69\145\x6c\144"] == $destination_field_structures[$table][$n]["\x46\151\x65\154\144"])) { goto OqGN2; } goto slzAK; rm6GM: if (!(is_array($differences) && !empty($differences))) { goto LEq3q; } goto jeNUB; hCBnJ: $add_field = "\x41\x4c\124\x45\x52\x20\124\x41\x42\114\105\40{$table}\x20\x41\104\x44\x20\103\117\114\125\115\x4e\x20\140" . $field["\x46\x69\145\x6c\x64"] . "\140\40" . $field["\124\x79\160\145"] . "\40\103\x48\101\x52\101\103\x54\x45\x52\x20\x53\105\124\40" . $this->CHARACTER_SET; goto CAbxX; zeEKh: Atxpn: goto PXD3q; YDiHz: fwDp2: goto XOoPV; vOKN2: $n++; goto KKv6t; XOoPV: c2wQP: goto vOKN2; N93rl: U8P5z: goto EKO_A; ktzRY: YP7kK: goto v0exD; ubX1m: $modify_field .= "\73"; goto WKQMN; nHAk1: $add_field .= isset($field["\x45\170\164\x72\x61"]) && $field["\x45\170\x74\x72\141"] != '' ? "\x20" . $field["\x45\170\164\162\x61"] : ''; goto eCnPj; P32g_: if ($this->in_array_recursive($field["\x46\151\x65\x6c\144"], $destination_field_structures[$table])) { goto SaB3Q; } goto hCBnJ; nl7D2: $n = 0; goto N93rl; lnxgS: SaB3Q: goto MbUBx; Kx1ov: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto fwDp2; } goto OrUbq; CAbxX: $add_field .= isset($field["\116\165\x6c\x6c"]) && $field["\x4e\x75\x6c\x6c"] == "\x59\105\x53" ? "\40\x4e\165\154\154" : ''; goto tDI43; vVP6N: $previous_field = $fields[$n]["\106\151\x65\154\144"]; goto NCgQJ; Nn1Oo: $modify_field .= isset($fields[$n]["\x4e\x75\x6c\154"]) && $fields[$n]["\x4e\x75\154\154"] == "\131\x45\123" ? "\40\116\x55\x4c\114" : "\40\116\117\x54\40\x4e\125\114\114"; goto UZHeI; dw59m: $sql_commands_to_run[] = $add_field; goto tps0w; v0exD: } goto aWgl1; fsJRK: HGoW8: goto myPU2; aWgl1: OipO_: goto fsJRK; myPU2: } goto q5Fa8; GnQu_: return $sql_commands_to_run; goto Xt3Hk; KvWbK: $sql_commands_to_run = array(); goto nhmPs; q5Fa8: ddbkk: goto GnQu_; Xt3Hk: } function in_array_recursive($needle, $haystack, $strict = false) { goto nysrV; XRboP: rahQ9: goto QnkP9; nysrV: foreach ($haystack as $array => $item) { goto PnwSv; a11sx: return true; goto Hfz4t; nSt62: Ym8d3: goto tFNcI; uVTt9: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto RJApz; } goto a11sx; PnwSv: $item = $item["\106\x69\145\154\x64"]; goto uVTt9; Hfz4t: RJApz: goto nSt62; tFNcI: } goto XRboP; QnkP9: return false; goto TfT_s; TfT_s: } }
