<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 goto LPrCP; DteiH: IW6KG: goto EXNaJ; LPrCP: if (defined("\102\x41\123\105\120\x41\x54\x48")) { goto IW6KG; } goto ygn6W; ygn6W: exit("\116\x6f\x20\144\x69\x72\145\143\x74\40\163\x63\162\x69\160\164\x20\x61\x63\143\145\163\163\x20\x61\154\154\x6f\167\x65\144"); goto DteiH; EXNaJ: class Compare extends CI_Controller { function __construct() { goto DoVCI; veTpE: $this->DB1 = $this->load->database("\x6d\x61\x69\156\137\x67\141\x72\x75\144\x61", TRUE); goto FPIYJ; DoVCI: parent::__construct(); goto pltiC; pltiC: $this->CHARACTER_SET = "\165\164\x66\x38\x20\103\x4f\x4c\x4c\x41\124\x45\x20\x75\164\146\70\137\x67\145\156\x65\x72\141\x6c\x5f\x63\x69"; goto veTpE; FPIYJ: $this->DB2 = $this->load->database("\x6c\x69\166\x65", TRUE); goto knlEh; knlEh: } function index() { goto s4msE; AxI_h: YCzZL: goto alvMw; IjdqA: $tables_to_drop = array_diff($live_tables, $development_tables); goto pixsN; V88Th: goto yFhlm; goto AxI_h; V_O4V: echo "\74\160\x72\145\x20\x73\164\171\154\145\x3d\x27\160\141\x64\x64\x69\156\x67\x3a\x20\62\60\x70\170\73\x20\x62\x61\x63\153\147\x72\157\165\x6e\144\x2d\143\x6f\x6c\x6f\x72\72\x20\x23\106\x46\x46\101\106\60\73\x27\x3e\xa"; goto ecWpx; pqRXq: echo "\74\160\76\124\x68\x65\40\146\157\x6c\x6c\x6f\167\151\x6e\147\40\x53\121\x4c\x20\x63\157\155\x6d\141\156\x64\x73\x20\156\x65\145\x64\x20\164\x6f\40\x62\145\40\145\170\145\143\x75\164\x65\144\x20\164\x6f\40\x62\x72\151\x6e\147\x20\x74\x68\145\x20\x4c\151\x76\145\40\144\x61\164\x61\x62\141\x73\145\x20\x74\141\142\154\145\163\40\165\x70\40\164\157\40\x64\x61\x74\x65\x3a\40\74\57\160\76\xa"; goto V_O4V; H2KXu: YikU1: goto UTRXR; vOORM: $tables_to_update = $this->compare_table_structures($development_tables, $live_tables); goto C1nvk; UTRXR: echo "\74\160\x72\x65\x3e\xa"; goto cOMNQ; aBl0J: $sql_commands_to_run = is_array($tables_to_drop) && !empty($tables_to_drop) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_drop, "\144\162\157\x70")) : array(); goto vOORM; vEH13: if (is_array($sql_commands_to_run) && !empty($sql_commands_to_run)) { goto YCzZL; } goto qgtvP; RxIS6: $tables_to_create = array_diff($development_tables, $live_tables); goto IjdqA; C1nvk: $tables_to_update = array_diff($tables_to_update, $tables_to_create); goto WzXRl; oQw_0: $development_tables = $this->DB1->list_tables(); goto ZBErf; alvMw: echo "\x3c\x68\x32\76\124\x68\145\40\144\141\164\141\142\141\x73\x65\x20\x69\163\40\157\165\x74\40\157\146\x20\123\x79\156\x63\x21\74\x2f\150\62\x3e\12"; goto pqRXq; pixsN: $sql_commands_to_run = is_array($tables_to_create) && !empty($tables_to_create) ? array_merge($sql_commands_to_run, $this->manage_tables($tables_to_create, "\x63\x72\145\x61\164\x65")) : array(); goto aBl0J; qgtvP: echo "\74\150\62\76\x54\150\x65\40\x64\x61\x74\x61\142\x61\163\x65\40\141\x70\x70\145\x61\x72\163\x20\164\x6f\40\x62\145\40\165\160\40\164\x6f\40\144\x61\x74\145\74\x2f\150\x32\x3e\xa"; goto V88Th; s4msE: $sql_commands_to_run = array(); goto oQw_0; cOMNQ: yFhlm: goto w7JLh; ZBErf: $live_tables = $this->DB2->list_tables(); goto RxIS6; WzXRl: $sql_commands_to_run = is_array($tables_to_update) && !empty($tables_to_update) ? array_merge($sql_commands_to_run, $this->update_existing_tables($tables_to_update)) : ''; goto vEH13; ecWpx: foreach ($sql_commands_to_run as $sql_command) { echo "{$sql_command}\xa"; rgSMP: } goto H2KXu; w7JLh: } function manage_tables($tables, $action) { goto VoERw; da4fV: ZHNsf: goto WM14t; VoERw: $sql_commands_to_run = array(); goto slCRz; WM14t: if (!($action == "\144\162\x6f\160")) { goto U5UQp; } goto Bs21E; KPapp: i_JL9: goto da4fV; pxBg6: U5UQp: goto MDccX; slCRz: if (!($action == "\x63\x72\145\x61\x74\x65")) { goto ZHNsf; } goto CVgew; snbZS: cn15V: goto pxBg6; CVgew: foreach ($tables as $table) { goto Zh92r; eIU00: CnEA1: goto RuG5_; Zh92r: $query = $this->DB1->query("\123\110\x4f\127\40\103\x52\x45\x41\x54\x45\x20\x54\x41\x42\114\105\40\x60{$table}\x60\40\x2d\x2d\x20\x63\x72\145\141\164\x65\40\164\141\142\x6c\x65\x73"); goto floH9; Ir9Hg: $sql_commands_to_run[] = $table_structure["\103\162\145\141\x74\145\x20\124\x61\142\x6c\145"] . "\73"; goto eIU00; floH9: $table_structure = $query->row_array(); goto Ir9Hg; RuG5_: } goto KPapp; Bs21E: foreach ($tables as $table) { $sql_commands_to_run[] = "\104\x52\x4f\120\x20\124\x41\102\114\x45\40{$table}\73"; ObzYB: } goto snbZS; MDccX: return $sql_commands_to_run; goto M6_Ot; M6_Ot: } function compare_table_structures($development_tables, $live_tables) { goto NLMfb; R_1dH: return $tables_need_updating; goto Ir47P; Aqidc: foreach ($development_tables as $table) { goto G293B; ZnqUf: C9WmF: goto numOx; wELuJ: if (!($this->count_differences($development_table, $live_table) > 0)) { goto C9WmF; } goto oJ99_; eyVBK: $live_table = isset($live_table_structures[$table]) ? $live_table_structures[$table] : ''; goto wELuJ; numOx: OuV1g: goto bx13S; G293B: $development_table = $development_table_structures[$table]; goto eyVBK; oJ99_: $tables_need_updating[] = $table; goto ZnqUf; bx13S: } goto I4gFg; rKFnE: foreach ($development_tables as $table) { goto fHHXh; l9M__: HHTZ0: goto eQzOI; S1lXb: $table_structure = $query->row_array(); goto DTGju; DTGju: $development_table_structures[$table] = $table_structure["\x43\x72\x65\x61\164\x65\40\124\141\x62\154\x65"]; goto l9M__; fHHXh: $query = $this->DB1->query("\x53\110\x4f\x57\40\x43\122\105\101\124\x45\x20\x54\x41\102\114\105\x20\x60{$table}\x60\x20\55\x2d\x20\x64\x65\x76"); goto S1lXb; eQzOI: } goto RGsN1; RGsN1: IBD36: goto Fiyjb; tsADW: N5fdR: goto Aqidc; NLMfb: $tables_need_updating = array(); goto eC_th; eC_th: $live_table_structures = $development_table_structures = array(); goto rKFnE; I4gFg: H4Coe: goto R_1dH; Fiyjb: foreach ($live_tables as $table) { goto yb8Tp; LncLp: $live_table_structures[$table] = $table_structure["\103\x72\x65\x61\x74\x65\x20\x54\x61\142\154\145"]; goto i3S9W; jTDnf: $table_structure = $query->row_array(); goto LncLp; i3S9W: mz_I4: goto veG5C; yb8Tp: $query = $this->DB2->query("\123\110\x4f\127\40\x43\122\x45\101\x54\105\40\124\101\x42\114\x45\x20\x60{$table}\x60\x20\x2d\x2d\40\154\151\166\x65"); goto jTDnf; veG5C: } goto tsADW; Ir47P: } function count_differences($old, $new) { goto YJC_y; mzqbL: $i++; goto ruEDl; pxaN_: $new = explode("\40", $new); goto YrBCm; YJC_y: $differences = 0; goto K61pf; UK1c4: return $differences; goto RpDnV; O1aSp: $i = 0; goto tnGan; niue3: HuAmH: goto UK1c4; okUfD: $new = trim(preg_replace("\57\134\163\53\57", '', $new)); goto jRCGf; jRCGf: if (!($old == $new)) { goto VAHWh; } goto nlrB5; ruEDl: goto UJX0k; goto niue3; YrBCm: $length = max(count($old), count($new)); goto O1aSp; tnGan: UJX0k: goto j0Io_; K61pf: $old = trim(preg_replace("\x2f\x5c\x73\x2b\x2f", '', $old)); goto okUfD; LJIBz: EPMLl: goto mzqbL; gf3pn: bvqAA: goto LJIBz; R3CiV: $differences++; goto gf3pn; n9TF5: $old = explode("\x20", $old); goto pxaN_; Qorzl: VAHWh: goto n9TF5; nlrB5: return $differences; goto Qorzl; j0Io_: if (!($i < $length)) { goto HuAmH; } goto u7HAg; u7HAg: if (!($old[$i] != $new[$i])) { goto bvqAA; } goto R3CiV; RpDnV: } function update_existing_tables($tables) { goto WqXq2; z0tcv: $table_structure_development = array(); goto OZI5m; WqXq2: $sql_commands_to_run = array(); goto z0tcv; OZI5m: $table_structure_live = array(); goto tmotw; tmotw: if (!(is_array($tables) && !empty($tables))) { goto t4a5W; } goto N99tD; N99tD: foreach ($tables as $table) { goto pULhk; pULhk: $table_structure_development[$table] = $this->table_field_data((array) $this->DB1, $table); goto k91ZF; k91ZF: $table_structure_live[$table] = $this->table_field_data((array) $this->DB2, $table); goto ndqqG; ndqqG: ernQR: goto Hduex; Hduex: } goto R7XYm; rXu1I: t4a5W: goto xcMlU; JcFZh: return $sql_commands_to_run; goto FxDn3; R7XYm: SgYT6: goto rXu1I; xcMlU: $sql_commands_to_run = array_merge($sql_commands_to_run, $this->determine_field_changes($table_structure_development, $table_structure_live)); goto JcFZh; FxDn3: } function table_field_data($database, $table) { goto TeuZ6; TeuZ6: $conn = mysqli_connect($database["\150\157\163\x74\156\x61\155\x65"], $database["\x75\163\145\x72\x6e\141\155\x65"], $database["\x70\141\x73\x73\x77\157\x72\x64"]); goto TJgde; WejaN: goto sD3d7; goto B5ies; B5ies: qOucx: goto kZLaC; TX2b7: sD3d7: goto O6ZR_; kZLaC: return $fields; goto vSAGA; cU5pe: $result = mysql_query("\123\110\117\x57\x20\x43\x4f\114\x55\115\x4e\x53\x20\x46\x52\x4f\115\40\x60{$table}\x60"); goto TX2b7; TJgde: mysql_select_db($database["\x64\x61\164\x61\142\141\163\x65"]); goto cU5pe; lnqM_: $fields[] = $row; goto WejaN; O6ZR_: if (!($row = mysql_fetch_assoc($result))) { goto qOucx; } goto lnqM_; vSAGA: } function determine_field_changes($source_field_structures, $destination_field_structures) { goto XlOuT; bbZzQ: return $sql_commands_to_run; goto GAkh6; VdLvN: foreach ($source_field_structures as $table => $fields) { goto ItXOp; e7FMm: NuiuX: goto Etp7k; ItXOp: foreach ($fields as $field) { goto XXO1c; S1iro: $differences = array_diff($fields[$n], $destination_field_structures[$table][$n]); goto rnw3w; MSRkZ: hTk1i: goto UVSpZ; HrPX8: goto rgiWt; goto E4EkP; j3e_O: $add_field .= isset($field["\105\x78\164\x72\141"]) && $field["\105\170\164\x72\x61"] != '' ? "\40" . $field["\x45\170\164\162\141"] : ''; goto oHPqw; TpT0d: $sql_commands_to_run[] = $add_field; goto HrPX8; DbnAW: HqOCl: goto ZI9YY; MDMap: $modify_field .= isset($fields[$n]["\x45\170\164\162\x61"]) && $fields[$n]["\x45\170\x74\162\x61"] != '' ? "\x20" . $fields[$n]["\105\x78\164\x72\141"] : ''; goto LML0u; XDXdH: OonEJ: goto PJNbi; oHPqw: $add_field .= "\73"; goto TpT0d; hXCjr: $modify_field .= "\73"; goto JAHaS; EiRYh: $modify_field = "\x41\114\x54\x45\122\40\124\101\x42\x4c\x45\x20{$table}\40\115\117\x44\x49\106\131\x20\103\117\x4c\x55\115\x4e\x20\x60" . $fields[$n]["\106\151\145\154\144"] . "\140\40" . $fields[$n]["\124\171\160\x65"] . "\x20\103\110\x41\122\101\x43\124\x45\122\x20\123\105\x54\40" . $this->CHARACTER_SET; goto Shg78; KQPB5: goto hTk1i; goto XDXdH; ZI9YY: wbODu: goto Mjhje; Shg78: $modify_field .= isset($fields[$n]["\x44\x65\146\x61\165\x6c\164"]) && $fields[$n]["\104\145\146\x61\165\x6c\x74"] != '' ? "\40\x44\105\106\x41\x55\x4c\124\x20\x27" . $fields[$n]["\x44\x65\x66\x61\x75\154\x74"] . "\47" : ''; goto hBbwa; E4EkP: EUe9q: goto BCnl1; v1ha6: $sql_commands_to_run[] = $modify_field; goto DbnAW; c_REm: $add_field .= isset($field["\x4e\x75\154\154"]) && $field["\116\x75\154\154"] == "\x59\105\x53" ? "\x20\116\x75\x6c\x6c" : ''; goto RPzLz; HchHS: if (!($modify_field != '' && !in_array($modify_field, $sql_commands_to_run))) { goto HqOCl; } goto v1ha6; JAHaS: qVq0s: goto MB3a4; rnw3w: if (!(is_array($differences) && !empty($differences))) { goto qVq0s; } goto EiRYh; LML0u: $modify_field .= isset($previous_field) && $previous_field != '' ? "\x20\101\x46\x54\x45\122\40" . $previous_field : ''; goto hXCjr; k3FEm: PJCVA: goto eoSxV; UVSpZ: if (!($n < count($fields))) { goto OonEJ; } goto uyx7t; zDqCC: YRbsH: goto HchHS; Fp1nv: $add_field = "\x41\x4c\x54\x45\x52\x20\x54\101\x42\114\x45\x20{$table}\40\x41\104\104\40\103\117\x4c\125\x4d\x4e\x20\x60" . $field["\x46\x69\145\x6c\144"] . "\x60\40" . $field["\x54\171\160\x65"] . "\x20\103\x48\101\122\101\x43\x54\105\122\40\x53\105\x54\x20" . $this->CHARACTER_SET; goto c_REm; Vxb3i: $n = 0; goto MSRkZ; PJNbi: rgiWt: goto k3FEm; hBbwa: $modify_field .= isset($fields[$n]["\116\165\154\154"]) && $fields[$n]["\116\165\154\x6c"] == "\x59\105\x53" ? "\40\116\125\114\114" : "\40\x4e\x4f\x54\40\116\x55\x4c\114"; goto MDMap; uyx7t: if (!(isset($fields[$n]) && isset($destination_field_structures[$table][$n]) && $fields[$n]["\x46\151\145\154\x64"] == $destination_field_structures[$table][$n]["\x46\151\x65\154\x64"])) { goto YRbsH; } goto S1iro; XXO1c: if ($this->in_array_recursive($field["\106\151\145\154\x64"], $destination_field_structures[$table])) { goto EUe9q; } goto Fp1nv; Mjhje: $n++; goto KQPB5; BCnl1: $modify_field = ''; goto Vxb3i; MB3a4: $previous_field = $fields[$n]["\106\x69\145\154\144"]; goto zDqCC; RPzLz: $add_field .= "\40\x44\105\106\101\125\114\x54\40" . $field["\x44\x65\146\x61\165\154\164"]; goto j3e_O; eoSxV: } goto UvhbP; UvhbP: gT5fS: goto e7FMm; Etp7k: } goto PXkaM; XlOuT: $sql_commands_to_run = array(); goto VdLvN; PXkaM: K82oH: goto bbZzQ; GAkh6: } function in_array_recursive($needle, $haystack, $strict = false) { goto O0yPl; TwfQo: return false; goto pHjDV; GKgjO: dk13z: goto TwfQo; O0yPl: foreach ($haystack as $array => $item) { goto AILrJ; A0f73: AekTa: goto QsDqt; GZWMN: if (!(($strict ? $item === $needle : $item == $needle) || is_array($item) && in_array_recursive($needle, $item, $strict))) { goto AekTa; } goto V8aVM; QsDqt: IIsgY: goto rXkAa; AILrJ: $item = $item["\106\151\x65\154\x64"]; goto GZWMN; V8aVM: return true; goto A0f73; rXkAa: } goto GKgjO; pHjDV: } }
