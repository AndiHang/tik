<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\x53\105\x50\x41\x54\110") or exit("\116\x6f\x20\x64\151\162\x65\143\x74\40\163\x63\x72\x69\160\x74\40\x61\143\143\x65\163\x73\x20\141\154\154\x6f\167\145\x64"); class Update extends CI_Controller { function __construct() { goto E6ixb; nj6uM: include APPPATH . "\x63\157\x6e\x66\151\147\57\x64\141\164\141\142\x61\x73\x65\x2e\160\x68\160"; goto XlNNu; XlNNu: $this->load->dbforge(); goto f_ho2; f_ho2: $this->load->database(); goto e2G3M; E6ixb: parent::__construct(); goto nj6uM; e2G3M: $this->load->library("\x65\x6e\x63\162\171\160\x74\151\157\x6e"); goto YFmkF; YFmkF: } public function output_json($data, $encode = true) { goto rd9iA; ESzDx: y26v0: goto kQjA9; kQjA9: $this->output->set_content_type("\141\x70\x70\154\x69\x63\x61\164\x69\157\x6e\x2f\x6a\x73\x6f\156")->set_output($data); goto OZVAh; jFGSz: $data = json_encode($data); goto ESzDx; rd9iA: if (!$encode) { goto y26v0; } goto jFGSz; OZVAh: } public function index() { goto AD40J; LyFVm: $json = json_decode($json); goto xM7uy; GqL0Q: $this->load->view("\x69\x6e\163\164\x61\154\154\x2f\x68\x65\141\x64\x65\162", $data); goto Na5sQ; Yct8B: $data["\152\x73\157\156"] = $json; goto GqL0Q; Na5sQ: $this->load->view("\x69\x6e\x73\x74\x61\x6c\x6c\x2f\165\x70\x64\x61\x74\x65"); goto w2ylG; w2ylG: $this->load->view("\151\x6e\x73\164\x61\154\154\x2f\146\x6f\157\x74\145\162"); goto rfMq0; xM7uy: $json = (array) $json; goto Yct8B; AD40J: $json = file_get_contents("\x2e\57\141\163\x73\x65\x74\163\57\x61\160\160\57\144\142\x2f\144\x61\x74\x61\x62\141\x73\145\56\152\x73\157\156"); goto LyFVm; rfMq0: } function object_to_array($data) { goto VgzbD; knV6S: $result = []; goto JxoOf; N7Pmc: return $result; goto TwyUo; VgzbD: if (!(is_array($data) || is_object($data))) { goto BepFd; } goto knV6S; Vb6Dt: return $data; goto wBDps; TwyUo: BepFd: goto Vb6Dt; JxoOf: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; Ve1Tu: } goto qZodG; qZodG: QrvEq: goto N7Pmc; wBDps: } public function checkDatabase() { goto a1foo; NcCdw: $this->db->db_debug = FALSE; goto bSbOo; C2LR2: $data = ["\144\142" => $fields, "\x63\x72\x65\141\164\x65" => $create_tables, "\155\157\144\x69\146\171" => $edit_columns, "\141\144\x64" => $add_columns, "\143\157\x75\156\x74\163" => $counts, "\152\x73\x6f\156" => $json, "\x63\165\162\162\x65\x6e\x74" => $currentDb]; goto UEi54; OUkwt: $full_tables = array_unique($full_tables); goto MQYZR; PzdNy: $fields = []; goto FaNjC; G4Kux: $create_tables = []; goto oI6iQ; bSbOo: $tabless = $this->db->list_tables(); goto PzdNy; Ztif2: $edit_columns = []; goto l2N0s; FaNjC: $currentDb = []; goto SeZi6; a1foo: $db_debug = $this->db->db_debug; goto NcCdw; SeZi6: foreach ($tabless as $table) { goto qdbqB; WWQ1U: sravU: goto Lu9U1; HfcrF: $retval = array(); goto efcKs; UebKj: Mn3ca: goto SXFi5; BNNGE: if (!($i < $c)) { goto i1XRT; } goto gVDsO; Lu9U1: pXZ_Z: goto DMh_p; RCuq1: $retval[$i]->extra = $query[$i]->extra; goto jh0bz; l1Kby: goto oic62; goto WxzXE; BDAgP: goto sravU; goto CAqfH; f3Q9q: $currentDb[$table] = $retval; goto vOzl3; QJhJK: $retval[$i]->name = $query[$i]->column_name; goto RCuq1; rF59q: if (!(($query = $this->db->query($sql)) === FALSE)) { goto Mn3ca; } goto YSftY; CAqfH: YoR1_: goto fPMF2; iOIyU: $sql = "\x53\x45\x4c\105\103\x54\x20\140\x63\157\x6c\165\x6d\x6e\x5f\156\141\155\x65\140\x2c\x20\140\156\165\155\145\x72\151\143\x5f\x70\x72\145\143\151\x73\151\x6f\156\x60\54\x20\140\145\x78\x74\x72\x61\x60\54\40\x60\x69\x73\137\156\x75\x6c\154\141\x62\154\145\x60" . "\x20\x46\122\x4f\115\40\140\151\156\146\157\162\x6d\x61\x74\151\x6f\156\x5f\x73\143\x68\x65\x6d\141\140\x2e\140\x63\157\x6c\165\x6d\x6e\x73\140\x20\x57\110\x45\x52\x45\x20\x74\141\x62\154\x65\x5f\163\143\x68\x65\155\141\40\x3d\x20\42" . $this->db->database . "\42\x20\101\x4e\104\40\164\x61\142\x6c\x65\x5f\x6e\141\155\145\40\x3d\x20\42" . $table . "\42"; goto rF59q; JYnI0: WgZgJ: goto olbrw; jh0bz: WrAYy: goto R4dqU; Kpp2B: if ($query[$i]->extra == "\141\x75\x74\x6f\137\151\156\x63\162\145\155\145\x6e\x74") { goto YoR1_; } goto jZxus; gVDsO: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto mpBNk; } goto G_yER; fPMF2: $datafld[$i]->auto_increment = true; goto WWQ1U; SXFi5: $query = $query->result_object(); goto HfcrF; G_yER: if (!($query[$i]->extra != '')) { goto pXZ_Z; } goto Kpp2B; WxzXE: i1XRT: goto f3Q9q; jZxus: $datafld[$i]->extra = $query[$i]->extra; goto BDAgP; NVYsG: $c = count($query); goto XDOOI; R4dqU: $i++; goto l1Kby; JuRR4: $retval[$i] = new stdClass(); goto QJhJK; YSftY: $currentDb = FALSE; goto UebKj; vOzl3: $fields[$table] = $datafld; goto JYnI0; efcKs: $i = 0; goto NVYsG; DMh_p: mpBNk: goto JuRR4; XDOOI: oic62: goto BNNGE; qdbqB: $datafld = $this->db->field_data($table); goto iOIyU; olbrw: } goto ny_br; MQYZR: sort($full_tables); goto G4Kux; zGLqb: $json = file_get_contents("\56\x2f\x61\x73\x73\145\x74\x73\x2f\x61\160\160\x2f\x64\142\57\x64\141\164\x61\x62\141\x73\145\x2e\152\x73\157\x6e"); goto ZZkVU; L0kv4: $json = (array) $json; goto ythtW; nb3o2: OJXKk: goto KF7Sn; KIzWr: $tbl_ada = array_keys($fields); goto pTl1X; pTl1X: $full_tables = array_merge($tbl_baru, $tbl_ada); goto OUkwt; ny_br: xOxOa: goto zGLqb; oI6iQ: $add_columns = []; goto Ztif2; ythtW: $tbl_baru = array_keys($json); goto KIzWr; ZZkVU: $json = json_decode($json); goto L0kv4; l2N0s: foreach ($full_tables as $table) { goto YUiyd; vCJUI: $create_tables[$table] = $json[$table]; goto NCz4L; oar_Z: h3ku0: goto gyz7o; fnIkU: y3d2q: goto G6fgF; G6fgF: if (!isset($json[$table])) { goto GKTMb; } goto HpnuO; HpnuO: foreach ($json[$table] as $jtbl) { goto flWLX; d8Nkz: F_kwH: goto venru; mUMPJ: hn3oi: goto WIQqs; venru: MCQ7H: goto IvMJA; flWLX: if ($this->db->field_exists($jtbl->name, $table)) { goto hn3oi; } goto As2Vo; As2Vo: $add_columns[$table][] = $jtbl; goto ruyz0; WIQqs: foreach ($fields[$table] as $ftbl) { goto XHUon; XHUon: if (!($jtbl->name == $ftbl->name)) { goto y4u4Y; } goto Hrw53; Fnlow: djjNx: goto yUpHL; FPu3z: $edit_columns[$table][] = $jtbl; goto Fnlow; Hrw53: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto djjNx; } goto FPu3z; yUpHL: y4u4Y: goto i4QLr; i4QLr: DlHCq: goto Jsqxw; Jsqxw: } goto BnQdb; ruyz0: goto F_kwH; goto mUMPJ; BnQdb: zgFqJ: goto d8Nkz; IvMJA: } goto oar_Z; fiZRP: bEMAk: goto G2ln2; gyz7o: GKTMb: goto y1Lnb; NCz4L: goto BOmwX; goto fnIkU; y1Lnb: BOmwX: goto fiZRP; YUiyd: if ($this->db->table_exists($table)) { goto y3d2q; } goto vCJUI; G2ln2: } goto nb3o2; KF7Sn: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto C2LR2; UEi54: $this->output_json($data); goto ABKm5; ABKm5: } public function updateDatabase() { goto u4Phz; GApFV: echo true; goto rTAdx; eM0li: $json = (array) $json; goto dbePW; j6i0j: sort($full_tables); goto GFrav; ksQGO: $full_tables = array_unique($full_tables); goto j6i0j; eMFW1: YnYDp: goto GApFV; u4Phz: $tabless = $this->db->list_tables(); goto ZTLrr; xT8J5: $json = json_decode($json); goto eM0li; ZTLrr: $fields = []; goto dUQW5; hIyS0: $json = file_get_contents("\x2e\57\141\x73\163\x65\164\163\x2f\141\x70\x70\x2f\x64\x62\x2f\x64\141\164\x61\142\x61\x73\145\56\x6a\x73\x6f\x6e"); goto xT8J5; dbePW: $tbl_baru = array_keys($json); goto sERN6; dUQW5: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); iu0V1: } goto TmhI3; TmhI3: whf_z: goto hIyS0; Jr7jU: $full_tables = array_merge($tbl_baru, $tbl_ada); goto ksQGO; GFrav: foreach ($full_tables as $table) { goto QWBIt; dPbF5: K32GK: goto sm0YH; AqHcQ: if (!isset($json[$table])) { goto K32GK; } goto bAGvz; fOFck: $this->db->query("\x41\x4c\124\x45\x52\40\124\x41\102\114\x45\40\40\x60" . $table . "\x60\40\x45\x4e\107\x49\x4e\105\40\75\40\x49\156\x6e\157\104\102"); goto dPbF5; EC0Mv: P8uhC: goto Fuiv_; ugv2f: $this->dbforge->create_table($table, TRUE); goto fOFck; IGvDm: Rz4AP: goto RGWpp; sm0YH: goto cDJx4; goto EC0Mv; bAGvz: foreach ($json[$table] as $tbl => $jtbl) { goto tUPHw; tUPHw: $field = [$jtbl->name => ["\x74\171\x70\x65" => $jtbl->type, "\143\157\x6e\x73\164\x72\141\151\x6e\x74" => $jtbl->max_length, "\x6e\165\154\154" => $jtbl->primary_key == 0]]; goto nX5Cb; zZYsR: if (!($jtbl->primary_key == 1)) { goto K9F7z; } goto LZmri; nX5Cb: $this->dbforge->add_field($field); goto zZYsR; wvjed: bCwYp: goto xDoCJ; LZmri: $this->dbforge->add_key($jtbl->name, true); goto BDcsf; BDcsf: K9F7z: goto wvjed; xDoCJ: } goto v4q4P; KYBi2: Hqm0S: goto sTAJU; Fuiv_: if (!isset($json[$table])) { goto d2ykZ; } goto GU_ad; GU_ad: foreach ($json[$table] as $jtbl) { goto Izn1D; WyIja: OC2zu: goto ttlxd; ttlxd: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\143\157\x6e\x73\164\x72\x61\x69\x6e\x74" => $jtbl->max_length, "\144\x65\x66\x61\165\x6c\164" => $jtbl->default)); goto KrYm1; I4F21: cEYnN: goto cphY3; ocD1n: TqjZo: goto xo18q; Izn1D: if ($this->db->field_exists($jtbl->name, $table)) { goto L4bgC; } goto b4NLf; grhMY: L4bgC: goto qwzNk; cphY3: sVNhG: goto nEvoV; KrYm1: $this->dbforge->add_column($table, $field); goto ocD1n; EPcbj: $field = array($jtbl->name => array("\x74\x79\160\145" => $jtbl->type, "\143\x6f\156\x73\x74\162\141\x69\156\x74" => $jtbl->max_length, "\156\x75\154\x6c" => false)); goto PqQP6; b4NLf: if ($jtbl->primary_key == 0) { goto OC2zu; } goto EPcbj; qwzNk: foreach ($fields[$table] as $ftbl) { goto Y6cJI; Gpi9k: $field = array($jtbl->name => array("\164\x79\160\145" => $jtbl->type, "\x63\x6f\156\x73\x74\x72\141\x69\156\164" => $jtbl->max_length, "\x64\145\x66\141\165\x6c\x74" => $jtbl->default)); goto QEv7f; BTxlv: goto fBs2O; goto ZnETc; wro0L: if ($jtbl->default == "\103\125\x52\x52\105\x4e\x54\137\x54\x49\x4d\x45\x53\x54\101\x4d\x50") { goto w3mrv; } goto Gpi9k; VRcAq: gFmbG: goto mUv8j; KOxYP: iIzxM: goto r1tdD; Y6cJI: if (!($jtbl->name == $ftbl->name)) { goto iIzxM; } goto n505M; kWUHh: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\x63\157\x6e\x73\164\162\141\x69\x6e\164" => $jtbl->max_length, "\x6e\165\154\154" => false, "\x61\x75\x74\157\x5f\151\156\x63\x72\145\x6d\x65\x6e\164" => true)); goto VRcAq; avrJh: $this->dbforge->modify_column($table, $field); goto BTxlv; fbH91: if ($jtbl->primary_key == 0) { goto iDH3I; } goto GfNJ3; hn6F1: $this->dbforge->modify_column($table, $field); goto s6iUS; sNW9S: FK5Y_: goto kWUHh; ZnETc: iDH3I: goto wro0L; r1tdD: VGO38: goto lZ8_1; QEv7f: goto nQz6Z; goto R1g5H; F3mps: zKYxn: goto KOxYP; mUv8j: $this->dbforge->add_key($jtbl->name, true); goto avrJh; amHHI: goto gFmbG; goto sNW9S; n505M: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto zKYxn; } goto fbH91; BbfIB: $field = array($jtbl->name . "\x20\x64\141\164\145\x74\x69\155\145\40\x64\145\x66\x61\165\154\164\40\x63\165\x72\162\145\156\x74\x5f\x74\151\x6d\145\163\x74\x61\155\160" . $onUpdate); goto WO2hy; GfNJ3: if ($jtbl->auto_increment == true) { goto FK5Y_; } goto cu_3s; s6iUS: fBs2O: goto F3mps; cu_3s: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\x63\x6f\x6e\163\x74\x72\x61\151\x6e\164" => $jtbl->max_length, "\156\165\154\x6c" => false)); goto amHHI; R1g5H: w3mrv: goto Met0j; WO2hy: nQz6Z: goto hn6F1; Met0j: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto BbfIB; lZ8_1: } goto UejAt; UejAt: oX343: goto I4F21; vgwe0: goto TqjZo; goto WyIja; lMXfc: $this->dbforge->add_column($table, $field); goto vgwe0; xo18q: goto cEYnN; goto grhMY; PqQP6: $this->dbforge->add_key($jtbl->name, true); goto lMXfc; nEvoV: } goto IGvDm; QWBIt: if ($this->db->table_exists($table)) { goto P8uhC; } goto AqHcQ; v4q4P: E_O7o: goto ugv2f; YVUrB: cDJx4: goto KYBi2; RGWpp: d2ykZ: goto YVUrB; sTAJU: } goto eMFW1; sERN6: $tbl_ada = array_keys($fields); goto Jr7jU; rTAdx: } public function checkDb() { goto sly7i; leQ0F: $this->db->db_debug = FALSE; goto bJsFt; Fdh4p: $edit_columns = []; goto DKrom; K_1nW: $json = (array) $json; goto RBVGo; gYOLn: $script_create_table = []; goto KF810; EyHw7: $tbl_ada = array_keys($fields); goto fNGt8; C40Cv: F8S8f: goto LwgCT; vJj5A: $this->output_json($data); goto yaXyW; XORCX: $script_create_column = []; goto Fdh4p; RBVGo: $tbl_seharusnya = array_keys($json); goto EyHw7; RheKs: $json = file_get_contents("\x2e\57\141\163\163\145\x74\163\57\141\x70\160\57\x64\142\57\144\141\164\x61\142\x61\x73\x65\x2e\152\163\157\x6e"); goto T9fzK; huRtT: sort($full_tables); goto OmLRE; OmLRE: $create_tables = []; goto gYOLn; pORKq: Tg7hV: goto RheKs; RRXBB: foreach ($tabless as $table) { goto JulLu; nqBAJ: $c = count($query); goto Bflak; Sdwzv: $retval[$i]->col_type = $query[$i]->column_type; goto p8_zk; JulLu: $sql = "\x53\105\x4c\105\x43\x54\x20\x60\x63\157\x6c\165\x6d\x6e\x5f\156\141\155\145\140\x2c\x20\140\143\x6f\154\x75\x6d\156\137\x74\x79\160\145\x60\54\40\x60\x63\157\154\x6c\141\x74\x69\x6f\156\137\156\x61\x6d\x65\140\54\x20\140\144\x61\x74\141\x5f\x74\171\x70\x65\140\54\40\140\x63\150\x61\162\x61\143\164\x65\x72\x5f\x6d\x61\170\151\155\165\155\x5f\x6c\x65\156\147\164\x68\140\54\x20\x60\156\165\x6d\x65\x72\x69\x63\x5f\160\x72\145\143\x69\x73\151\157\x6e\x60\x2c" . "\x20\140\143\x6f\154\x75\x6d\156\x5f\x64\145\146\x61\x75\154\164\140\x2c\40\x60\x63\x6f\154\x75\x6d\x6e\137\153\145\x79\140\54\40\x60\143\157\154\165\155\156\x5f\x63\x6f\x6d\x6d\x65\x6e\164\x60\x2c\40\140\x65\x78\164\x72\141\140\x2c\40\140\151\163\x5f\x6e\165\x6c\154\141\x62\x6c\145\140\xd\xa\11\x9\11\x46\122\x4f\115\x20\140\151\156\x66\x6f\162\155\x61\164\x69\157\156\x5f\163\143\x68\x65\x6d\141\x60\x2e\x60\x63\x6f\154\165\155\156\x73\140\40\x57\x48\x45\122\x45\x20\164\x61\x62\154\145\x5f\163\143\x68\x65\x6d\x61\40\75\40\x22" . $this->db->database . "\42\40\101\x4e\104\40\x74\x61\x62\x6c\x65\137\156\141\155\x65\x20\x3d\40\42" . $table . "\x22"; goto eafra; bq3nL: $retval[$i]->comment = $query[$i]->column_comment; goto YTxfq; eafra: if (!(($query = $this->db->query($sql)) === FALSE)) { goto UtbPO; } goto m4v11; Ka01N: $i = 0; goto nqBAJ; VromN: KzYjr: goto y9Ak0; eFftG: $retval[$i]->primary = $query[$i]->column_key; goto KqP3W; Teodo: goto mIR2J; goto Cd58Z; C1AZW: UtbPO: goto u_beb; EULm9: $retval[$i]->name = $query[$i]->column_name; goto Sdwzv; jyD7y: $retval[$i] = new stdClass(); goto EULm9; p8_zk: $retval[$i]->type = $query[$i]->data_type; goto U3t8g; Bflak: mIR2J: goto U_nh7; YTxfq: $retval[$i]->extra = $query[$i]->extra; goto ph7X0; eXiyt: $fields[$table] = (object) ["\x74\141\142\x6c\x65\137\156\x61\x6d\x65" => $table, "\143\157\154\165\x6d\156\163" => $retval]; goto VromN; ph7X0: $retval[$i]->nullable = $query[$i]->is_nullable; goto eFftG; f0Cn2: $i++; goto Teodo; Cd58Z: tO1tK: goto eXiyt; u_beb: $query = $query->result_object(); goto UWSuz; U_nh7: if (!($i < $c)) { goto tO1tK; } goto jyD7y; m4v11: $fields = FALSE; goto C1AZW; U3t8g: $retval[$i]->collation = $query[$i]->collation_name; goto DiHGm; UWSuz: $retval = array(); goto Ka01N; f6Ts3: $retval[$i]->default = $query[$i]->column_default; goto bq3nL; DiHGm: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto f6Ts3; KqP3W: wuuOM: goto f0Cn2; y9Ak0: } goto pORKq; vqkMI: $fields = []; goto RRXBB; GwhKY: foreach ($full_tables as $table) { goto PkosB; Vpqrr: if (!(count($add_column) > 0)) { goto RxtIf; } goto rgPrA; PkosB: if (!$this->db->table_exists($table)) { goto jJqHc; } goto G5Jo2; NIl8V: ol5Dp: goto AAeGl; oxZdA: foreach ($json[$table]->columns as $column) { goto N_xD5; yTl6q: goto nEWmU; goto C6h1t; TSkrt: JPY8m: goto wvm72; jIUXT: if ($column->type == "\x69\156\164") { goto oXcmV; } goto i_n8Z; APY28: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto SUHyY; ott4p: nEWmU: goto TSkrt; V84O6: xQ1Gn: goto RsWyl; h0FWx: jO6QV: goto ESsFE; q1rkC: $length = "\x28" . ($column->max_length + 1) . "\51"; goto ott4p; SUHyY: $comment = $column->comment == '' ? '' : "\40\103\117\x4d\115\105\116\124\x20\47" . $column->comment . "\47"; goto nG_hF; Fq0yJ: x9G8s: goto jIUXT; N_xD5: if ($column->max_length == null) { goto xQ1Gn; } goto ASr7C; RsWyl: $length = ''; goto d7cOj; d7cOj: goto JPY8m; goto Fq0yJ; ZOFp8: goto JPY8m; goto V84O6; ASr7C: if ($column->type != "\x6c\x6f\x6e\147\164\145\x78\x74" && $column->type != "\x6d\x65\x64\x69\165\x6d\x74\145\170\164" && $column->type != "\164\x65\170\x74") { goto x9G8s; } goto jedxR; jedxR: $length = ''; goto ZOFp8; WmbEL: $pri .= $column->primary != '' ? "\x50\x52\111\x4d\x41\x52\x59\40\113\105\x59\x20\50\140" . $column->name . "\140\51" : ''; goto h0FWx; wvm72: $nullable = $column->nullable == "\x4e\117" ? "\x20\116\117\x54\40\116\x55\114\x4c" : ''; goto gC1nN; C6h1t: oXcmV: goto q1rkC; gC1nN: $default = $column->default == null ? '' : "\40\x44\105\106\101\125\x4c\124\x20" . $column->default; goto APY28; nG_hF: $script .= "\x60" . $column->name . "\x60\x20" . $column->type . $length . $nullable . $default . $extra . $comment . "\x2c\x20"; goto WmbEL; i_n8Z: $length = "\50" . $column->max_length . "\51"; goto yTl6q; ESsFE: } goto YDTMR; rgPrA: $script_create_column[$table] = "\x41\x4c\124\105\122\x20\124\x41\x42\114\105\40\140" . $table . "\x60\40" . implode("\54\40", $add_column) . "\x3b"; goto PLLOH; PLLOH: RxtIf: goto g4R4K; J1j12: $script .= $pri . "\51\40\105\116\x47\x49\x4e\105\75\x49\x6e\156\157\x44\102\x20\x44\x45\106\x41\x55\114\x54\x20\103\110\x41\x52\123\105\x54\75\x75\164\146\70\155\142\x34\73"; goto R39Az; kjeo_: qZ8j0: goto Vpqrr; PsoUK: $pri = ''; goto oxZdA; YDTMR: dbEQt: goto J1j12; DDlys: $add_column = []; goto JNRFO; X8Z7E: jJqHc: goto g6mes; AAeGl: yJefJ: goto N2DCb; g6mes: $create_tables[] = $json[$table]; goto M0NwP; JNRFO: $modif_column = []; goto Czw0N; c6jc7: $script_edit_column[$table] = "\x41\x4c\124\x45\122\40\x54\x41\102\x4c\105\x20\140" . $table . "\140\40" . implode("\x2c\x20", $modif_column) . "\x3b"; goto NIl8V; Czw0N: foreach ($json[$table]->columns as $jtbl) { goto dLowl; IWFCF: array_push($add_column, "\101\104\104\x20\140" . $jtbl->name . "\x60\x20" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto YzK9U; w2Jb9: $default = $jtbl->default == null ? '' : "\40\104\105\x46\x41\125\x4c\124\x20" . $jtbl->default; goto ittx4; eoVPo: $nullable = $jtbl->nullable == "\116\x4f" ? "\40\x4e\117\124\x20\x4e\125\x4c\114" : ''; goto w2Jb9; mKvxf: foreach ($fields[$table]->columns as $ftbl) { goto SPMit; p3Vib: array_push($modif_column, "\115\x4f\104\x49\x46\131\40\140" . $jtbl->name . "\140\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto iBDch; pFLR4: if (strtolower($jtbl->primary) == "\x75\x6e\151") { goto pFa_W; } goto WwMX_; XEs22: iwM2R: goto N0qX5; us07E: if (!($jtbl->extra != $ftbl->extra)) { goto kPkPH; } goto B07Fl; N0qX5: if (!($jtbl->extra != null)) { goto N4LDZ; } goto qRi8m; YWMGV: if (!($ftbl->default != null)) { goto hFS7P; } goto uQi9o; ApVU8: if (!($jtbl->comment != $ftbl->comment)) { goto NTzI0; } goto QfJl6; uQi9o: $ftbl->default = str_replace("\x28\51", '', $ftbl->default); goto ybvQH; B07Fl: $edit_columns[$table][$jtbl->name]["\x65\x78\x74\162\x61"] = $jtbl->extra; goto d0vaL; QfJl6: $edit_columns[$table][$jtbl->name]["\x63\x6f\x6d\x6d\145\156\164"] = $jtbl->comment; goto paWBV; kwUMg: $edit_columns[$table][$jtbl->name]["\156\x75\x6c\154\141\142\x6c\145"] = $jtbl->nullable; goto o30aA; ktbcW: if (!($ftbl->extra != null)) { goto ahaUB; } goto CtLAB; Qb12E: if (!($jtbl->default != $ftbl->default)) { goto iwM2R; } goto JpWCh; T6xIA: e2Wml: goto Lj5Xj; Jmze2: array_push($modif_column, "\101\104\104\40\x50\122\111\x4d\101\x52\131\40\113\105\x59\x20\50\x60" . $jtbl->name . "\x60\x29"); goto WOAMo; WwMX_: goto UQRMK; goto qiGBT; wZyTc: $jtbl->default = str_replace("\x28\x29", '', $jtbl->default); goto u9wSf; oXLKn: $edit_columns[$table][$jtbl->name]["\143\157\x6c\x5f\x74\171\160\145"] = $jtbl->col_type; goto jHkU0; GX_i5: if (!($jtbl->col_type != $ftbl->col_type)) { goto gBh4o; } goto oXLKn; XbaUW: $jtbl->extra = strtoupper($jtbl->extra); goto ntyHj; jHkU0: gBh4o: goto atojF; u9wSf: $jtbl->default = strtoupper($jtbl->default); goto KhRsd; WOAMo: goto UQRMK; goto LaIH7; vwTKf: UQRMK: goto g2dQE; paWBV: NTzI0: goto WGJP7; iBDch: SEQ6g: goto T6xIA; JpWCh: $edit_columns[$table][$jtbl->name]["\144\x65\x66\141\165\x6c\164"] = $jtbl->default; goto XEs22; upwX2: ahaUB: goto us07E; wGP60: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto SEQ6g; } goto yMafU; yMafU: $nullable = $jtbl->nullable == "\116\x4f" ? "\x20\116\x4f\124\x20\x4e\125\114\x4c" : ''; goto wdhNJ; KhRsd: YvRZC: goto YWMGV; g2dQE: dVnbC: goto wGP60; Lj5Xj: rEkRz: goto pTdnH; ntyHj: N4LDZ: goto ktbcW; qiGBT: HOCo9: goto Jmze2; F_AeY: $comment = $jtbl->comment == '' ? '' : "\x20\103\x4f\x4d\x4d\x45\116\x54\x20\x27" . $jtbl->comment . "\x27"; goto p3Vib; qRi8m: $jtbl->extra = str_replace("\x28\51", '', $jtbl->extra); goto XbaUW; gwr0s: if (!($jtbl->default != null)) { goto YvRZC; } goto wZyTc; SPMit: if (!($jtbl->name == $ftbl->name)) { goto e2Wml; } goto GX_i5; svBfm: array_push($modif_column, "\x41\104\104\x20\125\x4e\111\121\x55\x45\x20\x4b\105\x59\40\x60" . $jtbl->name . "\140\x20\50\140" . $jtbl->name . "\x60\51"); goto vwTKf; cRmag: if (strtolower($jtbl->primary) == "\160\162\x69") { goto HOCo9; } goto pFLR4; CtLAB: $ftbl->extra = str_replace("\x28\x29", '', $ftbl->extra); goto wbY4X; ybvQH: $ftbl->default = strtoupper($ftbl->default); goto vtbu1; d0vaL: kPkPH: goto ApVU8; nuhKj: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto F_AeY; atojF: if (!($jtbl->nullable != $ftbl->nullable)) { goto Pnydl; } goto kwUMg; vtbu1: hFS7P: goto Qb12E; dP6PO: $edit_columns[$table][$jtbl->name]["\160\162\x69\155\141\x72\x79"] = $jtbl->primary; goto cRmag; wdhNJ: $default = $jtbl->default == null ? '' : "\x20\x44\x45\x46\101\125\114\x54\x20" . $jtbl->default; goto nuhKj; o30aA: Pnydl: goto gwr0s; wbY4X: $ftbl->extra = strtoupper($ftbl->extra); goto upwX2; LaIH7: pFa_W: goto svBfm; WGJP7: if (!($jtbl->primary != $ftbl->primary)) { goto dVnbC; } goto dP6PO; pTdnH: } goto n2K6u; zPAoL: $length = "\x28" . $jtbl->max_length . "\51"; goto rcrk0; rFAJa: $length = ''; goto cPdHR; JVKft: C_N4C: goto vMkAN; n2K6u: mODq1: goto Hlf4_; Ixmtl: BAmR8: goto N7SIK; B3Z2W: $extra .= "\x20\x50\x52\111\x4d\101\122\131\x20\x4b\x45\131"; goto ePZE6; ePZE6: EX861: goto l8fhL; YzK9U: kAEQq: goto mKvxf; gBLBc: $length = ''; goto gJmdM; a8Uyk: if ($jtbl->type != "\x6c\157\x6e\x67\164\145\x78\164" && $jtbl->type != "\x6d\x65\144\151\x75\155\x74\x65\x78\164" && $jtbl->type != "\x74\145\170\x74") { goto Ue85P; } goto rFAJa; BmPFH: if (!(strtoupper($extra) == "\40\101\125\124\x4f\x5f\x49\x4e\103\x52\105\x4d\105\116\x54")) { goto EX861; } goto B3Z2W; ittx4: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto BmPFH; zXonn: $add_columns[$table][] = $jtbl; goto YpzU_; V8FxO: Ue85P: goto UX1VC; cpVe5: HLkXh: goto gBLBc; YpzU_: if ($jtbl->max_length == null) { goto HLkXh; } goto a8Uyk; l8fhL: $comment = $jtbl->comment == '' ? '' : "\40\x43\x4f\115\115\x45\116\124\40\47" . $jtbl->comment . "\x27"; goto IWFCF; UX1VC: if ($jtbl->type == "\x69\156\x74") { goto BAmR8; } goto zPAoL; N7SIK: $length = "\50" . ($jtbl->max_length + 1) . "\x29"; goto JVKft; vMkAN: v3Hf1: goto eoVPo; dLowl: if ($this->db->field_exists($jtbl->name, $table)) { goto kAEQq; } goto zXonn; gJmdM: goto v3Hf1; goto V8FxO; cPdHR: goto v3Hf1; goto cpVe5; rcrk0: goto C_N4C; goto Ixmtl; Hlf4_: OFQqK: goto xn1ow; xn1ow: } goto kjeo_; g4R4K: if (!(count($modif_column) > 0)) { goto ol5Dp; } goto c6jc7; N2DCb: goto D0bEV; goto X8Z7E; R39Az: $script_create_table[$table] = $script; goto D7Xkv; zx5X3: uWGNz: goto jM2SA; D7Xkv: D0bEV: goto zx5X3; G5Jo2: if (!isset($json[$table])) { goto yJefJ; } goto DDlys; M0NwP: $script = "\x43\x52\105\101\x54\105\40\x54\101\102\x4c\105\x20\140" . $table . "\140\40\x28"; goto PsoUK; jM2SA: } goto C40Cv; fNGt8: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto LEAah; bJsFt: $tabless = $this->db->list_tables(); goto vqkMI; T9fzK: $json = json_decode($json); goto K_1nW; DKrom: $script_edit_column = []; goto GwhKY; LwgCT: $this->db->db_debug = $db_debug; goto V12YR; sly7i: $db_debug = $this->db->db_debug; goto leQ0F; KF810: $add_columns = []; goto XORCX; LEAah: $full_tables = array_unique($full_tables); goto huRtT; V12YR: $data = ["\146\x69\145\x6c\x64\163" => $fields, "\143\162\x65\141\x74\x65\137\164\141\142\x6c\x65\x73" => $create_tables, "\x63\157\x75\x6e\x74\137\x74\142\154" => count($create_tables), "\x61\144\144\x5f\143\x6f\154\165\x6d\156\163\137\x74\157\x5f\164\141\142\154\x65" => $add_columns, "\143\x6f\x75\156\164\137\x63\157\x6c" => count($add_columns), "\145\144\x69\164\x5f\x63\157\x6c\x75\x6d\x6e\x73" => $edit_columns, "\143\157\x75\x6e\164\x5f\155\157\144" => count($edit_columns), "\141\144\144\x5f\x74\142\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\x61\144\x64\x5f\x63\x6f\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\x6f\144\137\x63\x6f\154" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto vJj5A; yaXyW: } public function createTable() { goto pK9Ir; Xih1p: $data["\163\165\143\143\145\x73\x73"] = $this->runQuery($queries); goto RbBnB; FUsgu: $this->output_json($data); goto H64K7; pK9Ir: $scripts = $this->input->post("\144\141\164\x61", true); goto QTAWd; QTAWd: str_replace("\45\62\102", "\x2b", $scripts); goto Fl4Sv; YyUcy: ZMHed: goto Xih1p; szZMM: $scripts = json_decode($this->encryption->decrypt($scripts)); goto mpJDf; mpJDf: $queries = ''; goto LHXDs; LHXDs: foreach ($scripts as $script) { $queries .= $script; HZ0k3: } goto YyUcy; RbBnB: $data["\155\145\163\163\x61\x67\145"] = "\125\x70\x64\x61\x74\145\x20\x6b\x6f\154\x6f\x6d"; goto FUsgu; Fl4Sv: sleep(1); goto szZMM; H64K7: } public function createColumn() { goto xxXN6; T4yGw: isWb_: goto cxxh0; xVbx_: str_replace("\45\62\102", "\x2b", $scripts); goto d0Hlp; DnHRA: $scripts = json_decode($this->encryption->decrypt($scripts)); goto n4r27; ZINS7: $this->output_json($data); goto KBaB9; d0Hlp: sleep(1); goto DnHRA; xxXN6: $scripts = $this->input->post("\x64\x61\164\x61", true); goto xVbx_; cxxh0: if (!(strpos("\x60\165\x69\144\x60", $queries) !== false)) { goto hxuIC; } goto Ztb4n; VM0k7: foreach ($scripts as $script) { $queries .= $script; MvzMw: } goto T4yGw; n4r27: $queries = ''; goto VM0k7; ELiPW: $data["\163\165\x63\143\x65\x73\x73"] = $this->runQuery($queries); goto OEgWb; MTbeB: hxuIC: goto ELiPW; Ztb4n: $this->updateUID(); goto MTbeB; OEgWb: $data["\155\145\x73\163\141\x67\145"] = "\115\x6f\x64\x69\x66\x79\x20\x6b\157\x6c\157\x6d"; goto ZINS7; KBaB9: } public function editColumn() { goto uXZvh; eAU7m: $data["\163\x75\143\x63\x65\x73\x73"] = $this->runQuery($queries); goto f32E8; f32E8: $data["\x6d\145\x73\x73\141\147\145"] = "\125\x70\144\141\164\x65\40\163\x65\x6c\145\x73\x61\151"; goto q8Hdu; q8Hdu: $this->output_json($data); goto PnIk2; wT1aI: $scripts = json_decode($this->encryption->decrypt($scripts)); goto GHCV4; E0Yag: str_replace("\x25\x32\x42", "\53", $scripts); goto ipRb7; i0irF: foreach ($scripts as $script) { $queries .= $script; qh0HM: } goto C6l35; GHCV4: $queries = ''; goto i0irF; C6l35: huGEo: goto eAU7m; ipRb7: sleep(1); goto wT1aI; uXZvh: $scripts = $this->input->post("\x64\141\164\141", true); goto E0Yag; PnIk2: } function runQuery($script) { goto Fx5p0; GDNd4: ejQ28: goto iPN8Z; Fx5p0: $hostname = $this->db->hostname; goto qM8JA; fn0s1: $hostpass = $this->db->password; goto wUc84; wUc84: $database = $this->db->database; goto bcvHU; HKasz: return mysqli_connect_errno(); goto GDNd4; tcw3I: return true; goto Vop8O; bcvHU: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto N52l3; iPN8Z: $mysqli->multi_query($script); goto KGA2B; qM8JA: $hostuser = $this->db->username; goto fn0s1; KGA2B: $mysqli->close(); goto tcw3I; N52l3: if (!mysqli_connect_errno()) { goto ejQ28; } goto HKasz; Vop8O: } function updateUID() { goto ECQc6; ECQc6: $this->load->library("\125\x75\151\x64", "\165\x75\x69\144"); goto jaDTY; B3YeJ: return $this->db->update_batch("\x6d\x61\x73\164\x65\x72\137\x73\151\163\x77\x61", $input, "\151\144\x5f\x73\x69\x73\167\x61"); goto LqQnO; GhgeV: foreach ($siswas as $siswa) { $input[] = array("\151\144\137\x73\x69\x73\x77\x61" => $siswa->id_siswa, "\165\151\144" => $this->uuid->v4()); z21Q2: } goto FOnk7; jaDTY: $siswas = $this->db->get("\x6d\x61\163\164\145\162\137\x73\151\163\x77\141")->result(); goto zkxxZ; zkxxZ: $input = array(); goto GhgeV; FOnk7: D7EUr: goto B3YeJ; LqQnO: } function make_base() { } }
