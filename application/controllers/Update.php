<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\x53\x45\120\101\x54\110") or exit("\x4e\x6f\40\144\x69\162\145\x63\x74\x20\x73\143\162\151\x70\x74\40\x61\x63\x63\145\163\x73\40\x61\x6c\154\157\x77\145\x64"); class Update extends CI_Controller { function __construct() { goto iLbFp; f285T: $this->load->database(); goto rNPXJ; oX1ny: include APPPATH . "\143\x6f\156\146\x69\x67\x2f\144\141\164\x61\x62\141\x73\145\56\160\150\160"; goto q9C0K; rNPXJ: $this->load->library("\145\156\x63\162\x79\160\x74\151\157\x6e"); goto K0d5T; iLbFp: parent::__construct(); goto oX1ny; q9C0K: $this->load->dbforge(); goto f285T; K0d5T: } public function output_json($data, $encode = true) { goto x5eCA; KZ8VI: y1Zga: goto bV4gF; bV4gF: $this->output->set_content_type("\x61\x70\x70\154\151\x63\141\x74\x69\157\156\x2f\x6a\163\157\156")->set_output($data); goto iJY1R; uaUsi: $data = json_encode($data); goto KZ8VI; x5eCA: if (!$encode) { goto y1Zga; } goto uaUsi; iJY1R: } public function index() { goto XpHod; PQrmG: $this->load->view("\151\x6e\163\x74\141\x6c\154\x2f\x75\160\x64\x61\x74\x65"); goto CAX3L; ehHcL: $json = json_decode($json); goto aAntP; CAX3L: $this->load->view("\x69\x6e\163\164\x61\x6c\154\57\146\157\157\164\145\162"); goto InLQ1; LMZ0G: $data["\152\163\x6f\x6e"] = $json; goto ZFDmj; ZFDmj: $this->load->view("\151\x6e\x73\164\141\154\x6c\x2f\150\145\x61\x64\145\162", $data); goto PQrmG; aAntP: $json = (array) $json; goto LMZ0G; XpHod: $json = file_get_contents("\x2e\57\x61\x73\x73\x65\x74\x73\57\x61\x70\160\x2f\x64\x62\x2f\144\141\164\141\x62\141\163\145\x2e\x6a\x73\157\x6e"); goto ehHcL; InLQ1: } function object_to_array($data) { goto qmGzC; hTTXM: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; GNwDH: } goto cjsjS; qmGzC: if (!(is_array($data) || is_object($data))) { goto mIj9Q; } goto uyAGQ; uyAGQ: $result = []; goto hTTXM; cjsjS: hcu5W: goto eyNT9; ccMB5: mIj9Q: goto KkreW; KkreW: return $data; goto saSY2; eyNT9: return $result; goto ccMB5; saSY2: } public function checkDatabase() { goto yvzgE; GdSUI: Ycf3S: goto nIQpv; yS785: $full_tables = array_merge($tbl_baru, $tbl_ada); goto rrM66; Clelf: $data = ["\144\x62" => $fields, "\143\x72\x65\x61\164\x65" => $create_tables, "\x6d\x6f\144\151\x66\171" => $edit_columns, "\141\144\x64" => $add_columns, "\x63\157\165\x6e\164\163" => $counts, "\x6a\x73\157\156" => $json, "\x63\x75\162\162\145\156\x74" => $currentDb]; goto hezdR; djSxe: foreach ($full_tables as $table) { goto HD6_S; aBSL9: $create_tables[$table] = $json[$table]; goto U1CzS; U1CzS: goto DJoWY; goto P539E; nfmrM: if (!isset($json[$table])) { goto tBDhg; } goto F3Xe3; BQEPB: DJoWY: goto g4ybq; P539E: g6odE: goto nfmrM; g4ybq: YIXCI: goto ZsOO8; dPzxA: tBDhg: goto BQEPB; HD6_S: if ($this->db->table_exists($table)) { goto g6odE; } goto aBSL9; Czim0: cJjkm: goto dPzxA; F3Xe3: foreach ($json[$table] as $jtbl) { goto X_acI; dqqLC: QCaC5: goto IGtgS; R_C_J: F4uVK: goto dqqLC; X_acI: if ($this->db->field_exists($jtbl->name, $table)) { goto eA9s_; } goto IHq5H; yChWA: foreach ($fields[$table] as $ftbl) { goto lZcic; uyVBm: pnfS3: goto Rhqyc; m9ZwN: hm23P: goto ILcP3; WkV1T: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto hm23P; } goto S7Gni; ILcP3: zJu0l: goto uyVBm; lZcic: if (!($jtbl->name == $ftbl->name)) { goto zJu0l; } goto WkV1T; S7Gni: $edit_columns[$table][] = $jtbl; goto m9ZwN; Rhqyc: } goto R_C_J; IGtgS: D31f0: goto X0ios; IHGOM: eA9s_: goto yChWA; TlRur: goto QCaC5; goto IHGOM; IHq5H: $add_columns[$table][] = $jtbl; goto TlRur; X0ios: } goto Czim0; ZsOO8: } goto m8qB3; aCyHE: $this->db->db_debug = FALSE; goto pnczl; LZEF4: $create_tables = []; goto U7OeU; hbQWZ: $fields = []; goto M73G1; b4vMV: $json = (array) $json; goto jLGR9; hezdR: $this->output_json($data); goto sB52J; nIQpv: $json = file_get_contents("\x2e\57\x61\x73\163\x65\x74\x73\x2f\141\160\x70\x2f\144\x62\x2f\x64\141\x74\141\x62\x61\x73\x65\56\x6a\163\157\x6e"); goto idsj0; sYaJ0: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto Clelf; RXt0t: $edit_columns = []; goto djSxe; LExSo: foreach ($tabless as $table) { goto yUTxq; v16mr: $retval[$i]->name = $query[$i]->column_name; goto aKLOi; d1I4L: if (!(($query = $this->db->query($sql)) === FALSE)) { goto QZrV9; } goto oSk_J; Ddweu: goto P6XfN; goto tgLLp; KxOko: uFEOl: goto UrmLz; h5H8C: $i++; goto Ddweu; ogacb: $retval[$i] = new stdClass(); goto v16mr; Rhvt7: So1dP: goto A22mC; gSX0C: $sql = "\x53\x45\114\x45\x43\124\x20\x60\143\157\x6c\165\155\x6e\137\x6e\141\x6d\145\140\54\40\140\156\x75\x6d\x65\x72\151\143\x5f\160\x72\x65\143\x69\163\151\x6f\x6e\140\54\40\x60\x65\170\x74\x72\x61\x60\x2c\40\x60\151\163\137\x6e\x75\154\154\141\142\x6c\145\140" . "\40\106\122\117\115\x20\x60\x69\156\x66\157\x72\x6d\x61\x74\151\157\x6e\137\x73\143\150\x65\x6d\141\x60\56\140\143\157\154\x75\x6d\x6e\x73\x60\40\x57\110\x45\x52\105\x20\164\x61\x62\x6c\x65\137\163\143\x68\145\155\141\40\75\40\x22" . $this->db->database . "\x22\x20\101\x4e\x44\x20\x74\x61\142\x6c\x65\137\x6e\141\x6d\x65\x20\75\40\42" . $table . "\42"; goto d1I4L; ZnlZs: goto yBHFl; goto BbL71; ZlgGz: if ($query[$i]->extra == "\x61\165\164\157\137\x69\x6e\143\162\x65\155\145\156\x74") { goto PEpQM; } goto mk4yP; QDyre: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto MXrLP; } goto GOhao; P1xuE: $currentDb[$table] = $retval; goto KZNRS; tgLLp: k9oSo: goto P1xuE; BbL71: PEpQM: goto a14r3; A22mC: MXrLP: goto ogacb; cTnYQ: yBHFl: goto Rhvt7; KZNRS: $fields[$table] = $datafld; goto KxOko; k6AYd: qfcs1: goto h5H8C; aKLOi: $retval[$i]->extra = $query[$i]->extra; goto k6AYd; JxB4t: P6XfN: goto kIeK2; a14r3: $datafld[$i]->auto_increment = true; goto cTnYQ; l7n2T: $retval = array(); goto enR2x; QGpPw: $c = count($query); goto JxB4t; kIeK2: if (!($i < $c)) { goto k9oSo; } goto QDyre; fHk7r: QZrV9: goto BeCSM; oSk_J: $currentDb = FALSE; goto fHk7r; yUTxq: $datafld = $this->db->field_data($table); goto gSX0C; GOhao: if (!($query[$i]->extra != '')) { goto So1dP; } goto ZlgGz; mk4yP: $datafld[$i]->extra = $query[$i]->extra; goto ZnlZs; BeCSM: $query = $query->result_object(); goto l7n2T; enR2x: $i = 0; goto QGpPw; UrmLz: } goto GdSUI; yvzgE: $db_debug = $this->db->db_debug; goto aCyHE; M73G1: $currentDb = []; goto LExSo; jLGR9: $tbl_baru = array_keys($json); goto EajfU; idsj0: $json = json_decode($json); goto b4vMV; pnczl: $tabless = $this->db->list_tables(); goto hbQWZ; m8qB3: sLF8G: goto sYaJ0; rrM66: $full_tables = array_unique($full_tables); goto vm1JN; EajfU: $tbl_ada = array_keys($fields); goto yS785; vm1JN: sort($full_tables); goto LZEF4; U7OeU: $add_columns = []; goto RXt0t; sB52J: } public function updateDatabase() { goto c2kln; IjYC0: foreach ($full_tables as $table) { goto ey3KJ; ey3KJ: if ($this->db->table_exists($table)) { goto mw2Cr; } goto wVy2k; GgtOT: foreach ($json[$table] as $jtbl) { goto RcpGB; w0ivF: goto SWpE2; goto RLsXb; ndBDH: KGJ2H: goto cN6t5; BYhCa: $this->dbforge->add_column($table, $field); goto rW_TP; ZQa8K: $this->dbforge->add_column($table, $field); goto lu0l5; rW_TP: goto Yrtik; goto AZQgI; lu0l5: Yrtik: goto w0ivF; y6zVe: if ($jtbl->primary_key == 0) { goto pPwWZ; } goto D7rud; AZQgI: pPwWZ: goto cv4_T; s9Hh5: $this->dbforge->add_key($jtbl->name, true); goto BYhCa; cv4_T: $field = array($jtbl->name => array("\x74\x79\160\x65" => $jtbl->type, "\143\x6f\156\163\164\162\x61\151\x6e\164" => $jtbl->max_length, "\144\145\x66\x61\165\x6c\164" => $jtbl->default)); goto ZQa8K; RLsXb: zW8mY: goto NGQvO; IWRrQ: SWpE2: goto ndBDH; KsmbW: oZvZJ: goto IWRrQ; RcpGB: if ($this->db->field_exists($jtbl->name, $table)) { goto zW8mY; } goto y6zVe; NGQvO: foreach ($fields[$table] as $ftbl) { goto KSdpl; JKnwx: $field = array($jtbl->name . "\40\144\141\x74\145\164\151\x6d\145\x20\x64\x65\x66\141\165\x6c\164\40\143\x75\x72\x72\145\x6e\164\x5f\164\x69\155\145\x73\x74\x61\x6d\x70" . $onUpdate); goto QxFyL; TN1DK: $this->dbforge->modify_column($table, $field); goto YY91D; YY91D: N2cJM: goto PO8VU; T4q2X: $field = array($jtbl->name => array("\164\171\160\x65" => $jtbl->type, "\x63\x6f\156\x73\164\x72\x61\x69\x6e\x74" => $jtbl->max_length, "\x6e\165\154\x6c" => false)); goto UmzcB; UmzcB: goto s2FN0; goto GK_bB; A1yqJ: if ($jtbl->auto_increment == true) { goto tD2Pr; } goto T4q2X; py_vo: goto Kaj0Y; goto zyOhd; c8BXp: s2FN0: goto N_ubK; PO8VU: aERi9: goto qV8b_; GK_bB: tD2Pr: goto YQEld; qV8b_: tNbNR: goto eH4A6; KSdpl: if (!($jtbl->name == $ftbl->name)) { goto tNbNR; } goto ORT_X; oJm3D: $onUpdate = isset($jtbl->extra) ? "\40" . strtolower($jtbl->extra) : ''; goto JKnwx; gA0D2: goto N2cJM; goto PoOkk; PoOkk: Obt0Z: goto jTlKo; seFyl: if ($jtbl->primary_key == 0) { goto Obt0Z; } goto A1yqJ; zyOhd: f3MRn: goto oJm3D; YQEld: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\x63\157\x6e\163\164\162\x61\x69\x6e\164" => $jtbl->max_length, "\156\x75\x6c\154" => false, "\x61\165\164\157\x5f\151\x6e\x63\x72\x65\155\145\x6e\164" => true)); goto c8BXp; eH4A6: ITovU: goto PPGK0; EBuRj: $field = array($jtbl->name => array("\164\x79\x70\145" => $jtbl->type, "\143\x6f\156\163\164\x72\141\151\x6e\164" => $jtbl->max_length, "\144\145\146\x61\165\154\x74" => $jtbl->default)); goto py_vo; jTlKo: if ($jtbl->default == "\103\x55\122\x52\105\x4e\124\x5f\124\x49\115\x45\x53\124\101\x4d\120") { goto f3MRn; } goto EBuRj; N_ubK: $this->dbforge->add_key($jtbl->name, true); goto tzZky; QxFyL: Kaj0Y: goto TN1DK; tzZky: $this->dbforge->modify_column($table, $field); goto gA0D2; ORT_X: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto aERi9; } goto seFyl; PPGK0: } goto KsmbW; D7rud: $field = array($jtbl->name => array("\x74\171\x70\x65" => $jtbl->type, "\143\157\x6e\x73\164\x72\141\151\156\x74" => $jtbl->max_length, "\x6e\x75\x6c\x6c" => false)); goto s9Hh5; cN6t5: } goto yflw_; wpnsn: foreach ($json[$table] as $tbl => $jtbl) { goto xxEk6; gCCMV: pF120: goto Ko6qa; ZmKdJ: if (!($jtbl->primary_key == 1)) { goto pF120; } goto fLQtf; Ko6qa: PXTEM: goto WbJUs; xxEk6: $field = [$jtbl->name => ["\164\171\x70\x65" => $jtbl->type, "\143\157\156\x73\x74\x72\x61\151\156\x74" => $jtbl->max_length, "\x6e\165\154\x6c" => $jtbl->primary_key == 0]]; goto MUekt; fLQtf: $this->dbforge->add_key($jtbl->name, true); goto gCCMV; MUekt: $this->dbforge->add_field($field); goto ZmKdJ; WbJUs: } goto tqzCC; M4O_Z: Zrhqq: goto Bte1s; A1YEu: goto Zrhqq; goto Q1TXk; edWrJ: $this->dbforge->create_table($table, TRUE); goto mdFuP; Bte1s: DnHK5: goto ULb_s; mdFuP: $this->db->query("\101\x4c\x54\105\122\x20\124\x41\x42\x4c\105\40\40\x60" . $table . "\x60\40\x45\x4e\x47\111\116\x45\x20\x3d\x20\x49\156\x6e\157\x44\x42"); goto zLGfI; w4wRD: cBn1c: goto M4O_Z; yflw_: GHXLA: goto w4wRD; Q1TXk: mw2Cr: goto eZb5j; tqzCC: aBcwj: goto edWrJ; zLGfI: XLrIq: goto A1YEu; eZb5j: if (!isset($json[$table])) { goto cBn1c; } goto GgtOT; wVy2k: if (!isset($json[$table])) { goto XLrIq; } goto wpnsn; ULb_s: } goto k2c3u; b6Wwm: $tbl_baru = array_keys($json); goto pY1E9; lOLBq: $json = file_get_contents("\56\x2f\141\163\163\145\164\x73\57\141\160\160\x2f\x64\142\x2f\x64\141\164\x61\142\141\x73\145\56\x6a\x73\x6f\156"); goto tgnen; msvh8: $full_tables = array_unique($full_tables); goto nhloM; tXAbu: $fields = []; goto TaqkE; gNoEO: eADxm: goto lOLBq; tgnen: $json = json_decode($json); goto Y_ZCD; nhloM: sort($full_tables); goto IjYC0; TaqkE: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); m3zkH: } goto gNoEO; c2kln: $tabless = $this->db->list_tables(); goto tXAbu; k2c3u: wehNI: goto eaST5; eaST5: echo true; goto rOHQc; pj8Ji: $full_tables = array_merge($tbl_baru, $tbl_ada); goto msvh8; pY1E9: $tbl_ada = array_keys($fields); goto pj8Ji; Y_ZCD: $json = (array) $json; goto b6Wwm; rOHQc: } public function checkDb() { goto NhBw_; ASrQL: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto WDEFc; d4N3n: $json = file_get_contents("\56\57\x61\x73\x73\145\x74\x73\57\x61\160\x70\x2f\x64\x62\x2f\x64\x61\x74\x61\142\141\163\145\x2e\152\x73\x6f\x6e"); goto Rkfk5; TQg1q: sort($full_tables); goto fgaqx; WDEFc: $full_tables = array_unique($full_tables); goto TQg1q; NhBw_: $db_debug = $this->db->db_debug; goto xAFho; Rkfk5: $json = json_decode($json); goto HGyEE; EGziL: foreach ($tabless as $table) { goto jvMLs; ZkdNc: $retval = array(); goto UDpVD; f0aaq: if (!(($query = $this->db->query($sql)) === FALSE)) { goto V8fAg; } goto EX15o; A4apJ: $retval[$i]->type = $query[$i]->data_type; goto anv88; Rh5Np: $retval[$i] = new stdClass(); goto Gz702; sgeAC: $retval[$i]->default = $query[$i]->column_default; goto RMka3; jrpcH: hwVRz: goto LIpcH; wriyL: ZzeLS: goto JWSw3; lmfRB: $c = count($query); goto AU854; UDpVD: $i = 0; goto lmfRB; B_eJd: $retval[$i]->nullable = $query[$i]->is_nullable; goto KViPC; YhDyJ: V8fAg: goto OgqJj; X4rLm: $retval[$i]->col_type = $query[$i]->column_type; goto A4apJ; r9Xs_: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto sgeAC; AU854: Xj5aM: goto xxfz3; jvMLs: $sql = "\123\105\x4c\105\x43\124\40\140\x63\x6f\x6c\x75\x6d\156\137\x6e\141\155\145\x60\x2c\40\140\143\157\154\x75\155\156\x5f\x74\171\160\145\140\x2c\40\x60\143\157\x6c\154\141\x74\151\157\x6e\x5f\156\141\x6d\x65\x60\x2c\x20\140\x64\x61\x74\x61\x5f\x74\171\160\145\140\x2c\40\x60\x63\x68\x61\162\141\x63\164\x65\x72\137\x6d\141\170\x69\155\x75\155\137\154\x65\x6e\x67\x74\150\x60\x2c\40\140\x6e\x75\155\145\162\151\x63\x5f\x70\162\x65\x63\151\163\151\x6f\x6e\140\54" . "\40\x60\143\x6f\x6c\165\x6d\156\x5f\x64\x65\146\141\x75\154\x74\140\x2c\40\140\x63\x6f\x6c\165\x6d\156\x5f\153\145\171\140\54\x20\x60\x63\x6f\154\165\155\156\x5f\143\x6f\x6d\155\145\x6e\164\x60\54\x20\140\145\x78\164\x72\141\140\54\40\x60\151\x73\137\156\165\154\154\141\142\x6c\x65\x60\15\xa\x9\11\11\106\122\x4f\x4d\x20\x60\x69\x6e\146\157\x72\155\141\164\151\x6f\x6e\x5f\163\143\150\x65\155\141\x60\56\140\x63\x6f\x6c\165\155\156\x73\140\40\x57\110\x45\122\105\x20\x74\x61\142\154\145\x5f\x73\x63\150\x65\x6d\x61\40\x3d\40\x22" . $this->db->database . "\42\40\101\116\x44\40\164\141\142\x6c\145\x5f\156\141\x6d\x65\40\x3d\x20\42" . $table . "\x22"; goto f0aaq; RMka3: $retval[$i]->comment = $query[$i]->column_comment; goto lBbdQ; xxfz3: if (!($i < $c)) { goto ZzeLS; } goto Rh5Np; EX15o: $fields = FALSE; goto YhDyJ; JWSw3: $fields[$table] = (object) ["\x74\141\142\154\145\137\156\x61\155\x65" => $table, "\143\x6f\x6c\x75\x6d\x6e\163" => $retval]; goto vcTOz; KViPC: $retval[$i]->primary = $query[$i]->column_key; goto jrpcH; lBbdQ: $retval[$i]->extra = $query[$i]->extra; goto B_eJd; LIpcH: $i++; goto N7rsA; N7rsA: goto Xj5aM; goto wriyL; vcTOz: hgcgZ: goto h_Ixx; Gz702: $retval[$i]->name = $query[$i]->column_name; goto X4rLm; OgqJj: $query = $query->result_object(); goto ZkdNc; anv88: $retval[$i]->collation = $query[$i]->collation_name; goto r9Xs_; h_Ixx: } goto YABnR; KhC68: $add_columns = []; goto mOOL_; jCZa_: foreach ($full_tables as $table) { goto L6woO; UKlYr: $create_tables[] = $json[$table]; goto Ruf3y; DdoKA: i10eD: goto UKlYr; KoP6k: MKA2v: goto Vym_s; e5sc6: foreach ($json[$table]->columns as $jtbl) { goto Kgeag; QEqgn: nff1N: goto q2Y4M; JZv4l: if ($jtbl->max_length == null) { goto nff1N; } goto voPW7; jrCwW: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto o0NdM; aj3Xp: bcY0k: goto VNPQg; R53Ck: $length = ''; goto UZBG3; L2u1V: xMFHY: goto HGvZl; eR1ME: qu6lB: goto jHUoL; vYVKk: $length = "\50" . $jtbl->max_length . "\51"; goto V7ZdR; hgp7u: SJONh: goto k_iO4; J64hY: $add_columns[$table][] = $jtbl; goto JZv4l; TcIXb: $extra .= "\x20\120\122\x49\x4d\x41\x52\x59\x20\x4b\x45\131"; goto eR1ME; HGvZl: $nullable = $jtbl->nullable == "\116\x4f" ? "\x20\x4e\x4f\124\40\x4e\125\x4c\114" : ''; goto J5UWa; l2C2C: t5lyx: goto jbjXk; V7ZdR: goto Yyj3d; goto aj3Xp; bgYX4: array_push($add_column, "\101\x44\104\x20\x60" . $jtbl->name . "\x60\x20" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto l2C2C; k_iO4: WPnLn: goto RRkVf; OW11c: goto xMFHY; goto sABNE; sABNE: AN9Ga: goto to30y; nMlb2: Yyj3d: goto L2u1V; jHUoL: $comment = $jtbl->comment == '' ? '' : "\x20\x43\117\x4d\x4d\105\x4e\x54\40\x27" . $jtbl->comment . "\47"; goto bgYX4; q2Y4M: $length = ''; goto OW11c; J5UWa: $default = $jtbl->default == null ? '' : "\40\x44\x45\x46\101\x55\x4c\x54\x20" . $jtbl->default; goto jrCwW; to30y: if ($jtbl->type == "\151\156\x74") { goto bcY0k; } goto vYVKk; VNPQg: $length = "\x28" . ($jtbl->max_length + 1) . "\51"; goto nMlb2; Kgeag: if ($this->db->field_exists($jtbl->name, $table)) { goto t5lyx; } goto J64hY; o0NdM: if (!(strtoupper($extra) == "\40\x41\x55\x54\x4f\137\x49\x4e\x43\122\x45\x4d\105\116\x54")) { goto qu6lB; } goto TcIXb; jbjXk: foreach ($fields[$table]->columns as $ftbl) { goto xCvBL; Scit7: if (!($jtbl->col_type != $ftbl->col_type)) { goto lanWC; } goto fxJZY; cdHOH: if (!($jtbl->default != null)) { goto DUzOJ; } goto gCcEn; L7kIf: DUzOJ: goto Zhvo2; mhH1u: $jtbl->default = strtoupper($jtbl->default); goto L7kIf; lAksg: array_push($modif_column, "\115\117\104\111\x46\x59\40\x60" . $jtbl->name . "\x60\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto D_gZ2; ZqRB5: if (!($jtbl->default != $ftbl->default)) { goto YM0Rz; } goto zZzyd; pfDSI: if (!($jtbl->extra != $ftbl->extra)) { goto hv2Xb; } goto yJGKI; ufl_7: $ftbl->default = str_replace("\x28\x29", '', $ftbl->default); goto Ee9jK; XruYN: $edit_columns[$table][$jtbl->name]["\143\157\155\155\x65\x6e\x74"] = $jtbl->comment; goto CER_n; yKV8X: vu7OL: goto kaIJx; pyDY7: YM0Rz: goto diUzU; YkSEC: hv2Xb: goto Ba7aC; zZzyd: $edit_columns[$table][$jtbl->name]["\144\145\146\x61\165\154\164"] = $jtbl->default; goto pyDY7; yeqzl: if (strtolower($jtbl->primary) == "\x75\156\x69") { goto H8QDc; } goto Gab1f; MsICj: if (!($jtbl->primary != $ftbl->primary)) { goto PGOOg; } goto dn8av; ertmB: lanWC: goto njV2T; YeQ0L: H8QDc: goto Zo5Iw; kaIJx: if (!($ftbl->extra != null)) { goto RxfDW; } goto iSkqf; fgq5Z: fJAmY: goto ract9; diUzU: if (!($jtbl->extra != null)) { goto vu7OL; } goto xXry9; dn8av: $edit_columns[$table][$jtbl->name]["\x70\x72\151\x6d\141\162\171"] = $jtbl->primary; goto ne_wd; dR0zt: S1KVH: goto ZqRB5; gCcEn: $jtbl->default = str_replace("\50\51", '', $jtbl->default); goto mhH1u; CWM73: BWdcC: goto cdHOH; njV2T: if (!($jtbl->nullable != $ftbl->nullable)) { goto BWdcC; } goto rTBDV; YJKvM: $default = $jtbl->default == null ? '' : "\40\x44\105\106\x41\x55\114\x54\x20" . $jtbl->default; goto FzCnD; fxJZY: $edit_columns[$table][$jtbl->name]["\143\157\154\137\164\x79\x70\x65"] = $jtbl->col_type; goto ertmB; Blemh: $ftbl->extra = strtoupper($ftbl->extra); goto D1ur0; D_gZ2: ZM5Gs: goto fgq5Z; Szy_n: PGOOg: goto AAaKj; ract9: Et4pz: goto t_Lyh; iSkqf: $ftbl->extra = str_replace("\x28\51", '', $ftbl->extra); goto Blemh; xCvBL: if (!($jtbl->name == $ftbl->name)) { goto fJAmY; } goto Scit7; iaAiN: a1eg_: goto stC0E; yJGKI: $edit_columns[$table][$jtbl->name]["\x65\170\x74\x72\x61"] = $jtbl->extra; goto YkSEC; Zhvo2: if (!($ftbl->default != null)) { goto S1KVH; } goto ufl_7; jx61L: $nullable = $jtbl->nullable == "\x4e\117" ? "\40\116\x4f\x54\40\116\x55\114\x4c" : ''; goto YJKvM; AAaKj: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto ZM5Gs; } goto jx61L; xXry9: $jtbl->extra = str_replace("\50\x29", '', $jtbl->extra); goto GSfqP; CER_n: AnBAF: goto MsICj; Ba7aC: if (!($jtbl->comment != $ftbl->comment)) { goto AnBAF; } goto XruYN; ne_wd: if (strtolower($jtbl->primary) == "\160\162\x69") { goto a1eg_; } goto yeqzl; MDXTp: $comment = $jtbl->comment == '' ? '' : "\x20\x43\117\x4d\x4d\x45\x4e\x54\x20\x27" . $jtbl->comment . "\x27"; goto lAksg; Ee9jK: $ftbl->default = strtoupper($ftbl->default); goto dR0zt; Zo5Iw: array_push($modif_column, "\101\x44\x44\x20\x55\x4e\x49\x51\x55\x45\x20\113\x45\131\x20\x60" . $jtbl->name . "\x60\40\x28\x60" . $jtbl->name . "\140\x29"); goto nJv_H; GSfqP: $jtbl->extra = strtoupper($jtbl->extra); goto yKV8X; nJv_H: oFeWY: goto Szy_n; rTBDV: $edit_columns[$table][$jtbl->name]["\x6e\165\x6c\x6c\141\x62\154\145"] = $jtbl->nullable; goto CWM73; FzCnD: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto MDXTp; ZAey8: goto oFeWY; goto YeQ0L; stC0E: array_push($modif_column, "\101\x44\x44\x20\120\x52\111\115\x41\x52\131\40\113\x45\131\40\50\140" . $jtbl->name . "\140\51"); goto ZAey8; D1ur0: RxfDW: goto pfDSI; Gab1f: goto oFeWY; goto iaAiN; t_Lyh: } goto hgp7u; voPW7: if ($jtbl->type != "\154\157\156\x67\164\145\x78\164" && $jtbl->type != "\155\x65\144\x69\165\x6d\164\x65\x78\x74" && $jtbl->type != "\x74\x65\x78\164") { goto AN9Ga; } goto R53Ck; UZBG3: goto xMFHY; goto QEqgn; RRkVf: } goto wLPe3; wM2we: $script_create_column[$table] = "\101\114\124\105\x52\x20\x54\101\x42\x4c\105\x20\140" . $table . "\140\40" . implode("\x2c\40", $add_column) . "\x3b"; goto RlI9X; LuDs1: $script_edit_column[$table] = "\101\114\x54\105\x52\40\124\x41\x42\114\105\x20\140" . $table . "\140\40" . implode("\x2c\40", $modif_column) . "\x3b"; goto mfvup; ixSgI: if (!(count($add_column) > 0)) { goto jPKJE; } goto wM2we; BCTSP: $pri = ''; goto tY0ZE; W1NIt: $modif_column = []; goto e5sc6; IOaUa: $add_column = []; goto W1NIt; b_BS3: if (!(count($modif_column) > 0)) { goto ip6r_; } goto LuDs1; MOts1: if (!isset($json[$table])) { goto t89ON; } goto IOaUa; Wh9Kc: zqQz0: goto rx01E; Ruf3y: $script = "\103\122\x45\x41\124\105\40\124\x41\102\x4c\x45\40\x60" . $table . "\140\x20\x28"; goto BCTSP; RlI9X: jPKJE: goto b_BS3; L6woO: if (!$this->db->table_exists($table)) { goto i10eD; } goto MOts1; wLPe3: miCpg: goto ixSgI; tAeoD: $script_create_table[$table] = $script; goto Hg4MG; jhbY4: t89ON: goto Jcf_B; mfvup: ip6r_: goto jhbY4; Hg4MG: CzAin: goto Wh9Kc; tY0ZE: foreach ($json[$table]->columns as $column) { goto mLQue; OeukX: $pri .= $column->primary != '' ? "\120\x52\x49\115\x41\x52\131\x20\113\x45\x59\x20\x28\x60" . $column->name . "\x60\51" : ''; goto g_vyv; YD6DJ: F2aCi: goto VB09V; vxBMy: $length = ''; goto CCsVk; CCsVk: goto Mm7c5; goto YD6DJ; vMdqi: k90Xl: goto t7Iff; VB09V: if ($column->type == "\x69\156\x74") { goto Xzf5J; } goto vPI0z; n41eL: $default = $column->default == null ? '' : "\40\104\105\106\x41\125\114\x54\40" . $column->default; goto xXDFP; yOuqk: ho06G: goto vxBMy; xXDFP: $extra = $column->extra == '' ? '' : "\40" . strtoupper($column->extra); goto R43tf; zmF2D: $length = "\50" . ($column->max_length + 1) . "\x29"; goto vMdqi; mLQue: if ($column->max_length == null) { goto ho06G; } goto ox2P0; R43tf: $comment = $column->comment == '' ? '' : "\40\x43\117\115\x4d\105\x4e\x54\x20\47" . $column->comment . "\47"; goto Niqf6; g_vyv: KujIX: goto DcgpN; Nn_3m: goto k90Xl; goto qyq0C; vPI0z: $length = "\50" . $column->max_length . "\51"; goto Nn_3m; qyq0C: Xzf5J: goto zmF2D; Niqf6: $script .= "\140" . $column->name . "\140\x20" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\40"; goto OeukX; t7Iff: Mm7c5: goto lh2FE; OROI5: $length = ''; goto TTiqL; TTiqL: goto Mm7c5; goto yOuqk; ox2P0: if ($column->type != "\x6c\x6f\x6e\147\164\x65\170\164" && $column->type != "\x6d\x65\x64\151\165\x6d\x74\x65\x78\x74" && $column->type != "\x74\x65\x78\164") { goto F2aCi; } goto OROI5; lh2FE: $nullable = $column->nullable == "\x4e\x4f" ? "\x20\x4e\x4f\124\40\x4e\125\114\x4c" : ''; goto n41eL; DcgpN: } goto KoP6k; Jcf_B: goto CzAin; goto DdoKA; Vym_s: $script .= $pri . "\x29\x20\x45\x4e\x47\111\116\x45\x3d\111\156\x6e\x6f\x44\102\40\x44\105\106\101\x55\114\124\40\103\x48\101\x52\x53\105\124\x3d\165\x74\x66\x38\155\142\64\x3b"; goto tAeoD; rx01E: } goto kMp2W; Y7v1X: $tabless = $this->db->list_tables(); goto oemvk; nglY9: $data = ["\x66\x69\145\154\144\x73" => $fields, "\143\x72\x65\x61\x74\145\137\x74\x61\142\154\x65\x73" => $create_tables, "\x63\x6f\x75\x6e\164\x5f\164\x62\154" => count($create_tables), "\141\x64\144\x5f\x63\157\x6c\x75\155\156\163\137\x74\x6f\137\x74\x61\142\x6c\x65" => $add_columns, "\143\157\165\156\164\x5f\x63\x6f\x6c" => count($add_columns), "\145\x64\151\164\x5f\x63\157\154\x75\155\156\163" => $edit_columns, "\143\x6f\x75\x6e\164\137\x6d\157\144" => count($edit_columns), "\141\144\x64\137\x74\x62\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\144\144\x5f\143\157\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\x6d\x6f\144\x5f\143\x6f\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto ZbuNW; NUNco: $edit_columns = []; goto MmFw6; SprGH: $script_create_table = []; goto KhC68; xAFho: $this->db->db_debug = FALSE; goto Y7v1X; MmFw6: $script_edit_column = []; goto jCZa_; mOOL_: $script_create_column = []; goto NUNco; oemvk: $fields = []; goto EGziL; YABnR: TBs5C: goto d4N3n; fgaqx: $create_tables = []; goto SprGH; kMp2W: BWyoo: goto s5oT3; O4u0Y: $tbl_seharusnya = array_keys($json); goto YhQ4X; YhQ4X: $tbl_ada = array_keys($fields); goto ASrQL; HGyEE: $json = (array) $json; goto O4u0Y; s5oT3: $this->db->db_debug = $db_debug; goto nglY9; ZbuNW: $this->output_json($data); goto SdmAS; SdmAS: } public function createTable() { goto oNjiE; oNjiE: $scripts = $this->input->post("\144\x61\164\141", true); goto NcF03; MeHRr: sleep(1); goto ykG6M; BETMO: $this->output_json($data); goto bjJx3; NcF03: str_replace("\45\x32\x42", "\x2b", $scripts); goto MeHRr; yAHNN: $queries = ''; goto gRW3L; hgnMn: $data["\155\145\x73\x73\x61\x67\145"] = "\125\x70\x64\141\x74\x65\x20\153\x6f\154\157\x6d"; goto BETMO; URuWe: sAgIr: goto wShWW; wShWW: $data["\x73\165\x63\143\145\163\163"] = $this->runQuery($queries); goto hgnMn; gRW3L: foreach ($scripts as $script) { $queries .= $script; SHfNL: } goto URuWe; ykG6M: $scripts = json_decode($this->encryption->decrypt($scripts)); goto yAHNN; bjJx3: } public function createColumn() { goto GQ0Au; tzx5s: Q1fC4: goto SQmaf; Jq0I_: $this->output_json($data); goto kh30J; rc2EA: str_replace("\x25\62\102", "\53", $scripts); goto Z_0CS; qHAFD: if (!(strpos("\x60\165\151\144\x60", $queries) !== false)) { goto Q1fC4; } goto r4OfP; Z_0CS: sleep(1); goto TfZ7X; T223b: foreach ($scripts as $script) { $queries .= $script; uFe4o: } goto hF84o; ZVQxB: $data["\155\145\x73\x73\141\147\145"] = "\x4d\157\x64\151\x66\171\x20\153\157\154\157\x6d"; goto Jq0I_; r4OfP: $this->updateUID(); goto tzx5s; GQ0Au: $scripts = $this->input->post("\x64\141\x74\x61", true); goto rc2EA; hF84o: Yzweb: goto qHAFD; SQmaf: $data["\163\165\143\143\145\x73\163"] = $this->runQuery($queries); goto ZVQxB; PH6yH: $queries = ''; goto T223b; TfZ7X: $scripts = json_decode($this->encryption->decrypt($scripts)); goto PH6yH; kh30J: } public function editColumn() { goto KV3Uo; FTg0W: $data["\163\x75\143\x63\145\x73\163"] = $this->runQuery($queries); goto EMMyh; riHXs: $scripts = json_decode($this->encryption->decrypt($scripts)); goto Yn1cK; nR53y: str_replace("\45\x32\102", "\53", $scripts); goto ZmGMH; KV3Uo: $scripts = $this->input->post("\144\x61\x74\x61", true); goto nR53y; XsosW: Qp7cn: goto FTg0W; OwTN5: $this->output_json($data); goto n5RX6; ZmGMH: sleep(1); goto riHXs; nO31R: foreach ($scripts as $script) { $queries .= $script; X1LDz: } goto XsosW; Yn1cK: $queries = ''; goto nO31R; EMMyh: $data["\x6d\145\163\x73\x61\147\145"] = "\x55\160\x64\x61\x74\145\40\x73\x65\x6c\x65\x73\x61\x69"; goto OwTN5; n5RX6: } function runQuery($script) { goto ru1BA; R20zY: if (!mysqli_connect_errno()) { goto OTrfk; } goto jhggN; f1Qj5: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto R20zY; CO0jG: $hostpass = $this->db->password; goto V9NGQ; ru1BA: $hostname = $this->db->hostname; goto jD4cR; V9NGQ: $database = $this->db->database; goto f1Qj5; aoFL2: return true; goto ek0UI; SFfSv: OTrfk: goto YLl6e; CFYUL: $mysqli->close(); goto aoFL2; jD4cR: $hostuser = $this->db->username; goto CO0jG; YLl6e: $mysqli->multi_query($script); goto CFYUL; jhggN: return mysqli_connect_errno(); goto SFfSv; ek0UI: } function updateUID() { goto Bq8Ii; qSMOD: TRyXb: goto pS9kP; GQey4: $input = array(); goto cACAB; cACAB: foreach ($siswas as $siswa) { $input[] = array("\151\x64\x5f\163\x69\163\x77\141" => $siswa->id_siswa, "\165\151\144" => $this->uuid->v4()); Rr474: } goto qSMOD; Bq8Ii: $this->load->library("\125\x75\x69\144", "\x75\165\151\x64"); goto ZxyNv; ZxyNv: $siswas = $this->db->get("\x6d\141\163\x74\145\x72\137\x73\151\x73\x77\x61")->result(); goto GQey4; pS9kP: return $this->db->update_batch("\155\x61\x73\x74\145\162\x5f\x73\x69\163\x77\141", $input, "\151\x64\137\x73\151\x73\167\x61"); goto ldJO9; ldJO9: } function make_base() { } }
