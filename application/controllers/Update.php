<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\105\120\101\x54\110") or exit("\x4e\157\40\144\x69\162\145\143\x74\x20\163\x63\x72\151\x70\164\40\141\x63\x63\x65\x73\163\x20\141\x6c\x6c\157\167\x65\144"); class Update extends CI_Controller { function __construct() { goto JjMuf; Xt8br: $this->load->database(); goto U1Lt4; JjMuf: parent::__construct(); goto zRv8Y; nojp1: $this->load->dbforge(); goto Xt8br; U1Lt4: $this->load->library("\x65\156\x63\x72\x79\x70\164\151\x6f\156"); goto Y4eMA; zRv8Y: include APPPATH . "\143\157\156\x66\x69\147\x2f\x64\x61\x74\x61\x62\141\x73\x65\56\x70\x68\160"; goto nojp1; Y4eMA: } public function output_json($data, $encode = true) { goto OrbTv; uPRr4: GLGca: goto j7rAj; OrbTv: if (!$encode) { goto GLGca; } goto hrPfd; j7rAj: $this->output->set_content_type("\141\160\x70\x6c\x69\143\x61\164\151\157\156\57\152\x73\157\x6e")->set_output($data); goto WujJI; hrPfd: $data = json_encode($data); goto uPRr4; WujJI: } public function index() { goto xaKg_; xaKg_: $json = file_get_contents("\x2e\x2f\x61\163\163\145\164\163\x2f\141\160\160\57\x64\142\57\x64\141\164\x61\x62\x61\163\x65\x2e\x6a\163\157\x6e"); goto N7Lct; OlXvg: $this->load->view("\x69\156\163\x74\141\x6c\154\57\165\160\144\141\x74\x65"); goto AGeBe; c9clu: $data["\152\163\157\156"] = $json; goto bsZik; AGeBe: $this->load->view("\151\x6e\163\x74\141\x6c\154\x2f\146\157\x6f\164\145\x72"); goto SAvQY; bsZik: $this->load->view("\151\x6e\x73\x74\x61\x6c\154\x2f\x68\x65\141\x64\x65\162", $data); goto OlXvg; N7Lct: $json = json_decode($json); goto oWAfK; oWAfK: $json = (array) $json; goto c9clu; SAvQY: } function object_to_array($data) { goto uPoUu; uPoUu: if (!(is_array($data) || is_object($data))) { goto mFpyE; } goto Iff_w; PTBzC: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; N9Z7a: } goto P_YPH; RZPYb: mFpyE: goto hjDxL; iff8z: return $result; goto RZPYb; Iff_w: $result = []; goto PTBzC; P_YPH: lQcsE: goto iff8z; hjDxL: return $data; goto T4edb; T4edb: } public function checkDatabase() { goto ZIpul; ZIpul: $db_debug = $this->db->db_debug; goto TyZc1; ZOqZr: foreach ($full_tables as $table) { goto x3iqp; pA7cZ: MXQqu: goto q5_ug; YXjSm: goto T6aFm; goto mNYwJ; E08NM: if (!isset($json[$table])) { goto MXQqu; } goto nEKRy; DcY7q: g_smu: goto pA7cZ; nEKRy: foreach ($json[$table] as $jtbl) { goto JPkCW; UTMMo: AUZz1: goto UKNL6; tZKu6: KOpsE: goto UTMMo; wq3wP: xobZ3: goto tZKu6; JPkCW: if ($this->db->field_exists($jtbl->name, $table)) { goto vttb_; } goto J1d2t; oP4Gi: goto KOpsE; goto hGYNQ; hGYNQ: vttb_: goto znzdE; znzdE: foreach ($fields[$table] as $ftbl) { goto rht0v; DjqNe: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto CYbkt; } goto SQ4e1; QTuj3: sdu4I: goto omusk; ATgiU: CYbkt: goto QTuj3; rht0v: if (!($jtbl->name == $ftbl->name)) { goto sdu4I; } goto DjqNe; omusk: e00J1: goto qQ463; SQ4e1: $edit_columns[$table][] = $jtbl; goto ATgiU; qQ463: } goto wq3wP; J1d2t: $add_columns[$table][] = $jtbl; goto oP4Gi; UKNL6: } goto DcY7q; q5_ug: T6aFm: goto F15SR; F15SR: zalGM: goto Xc00t; mNYwJ: s0Y44: goto E08NM; WP6oG: $create_tables[$table] = $json[$table]; goto YXjSm; x3iqp: if ($this->db->table_exists($table)) { goto s0Y44; } goto WP6oG; Xc00t: } goto UGHH1; JCMdP: foreach ($tabless as $table) { goto RK8Lu; FGNbn: kY8DY: goto IFlZy; pbPsF: $retval[$i] = new stdClass(); goto oa4_d; BBmPQ: lru64: goto xaMw1; lWDRv: $retval[$i]->extra = $query[$i]->extra; goto Jm_3N; MyYHm: tmjlX: goto PL5or; EL5QG: $fields[$table] = $datafld; goto vApC1; hqp2v: $retval = array(); goto tTfR0; Jm_3N: hpAPU: goto gtCdz; ljoBe: goto iCFK3; goto B7wqj; UDyl5: $c = count($query); goto hh3qe; PL5or: $query = $query->result_object(); goto hqp2v; UrasQ: if (!(($query = $this->db->query($sql)) === FALSE)) { goto tmjlX; } goto qR1rl; ex1Tk: $datafld[$i]->extra = $query[$i]->extra; goto ljoBe; nMcPd: $datafld[$i]->auto_increment = true; goto lsoiW; tTfR0: $i = 0; goto UDyl5; xaMw1: $currentDb[$table] = $retval; goto EL5QG; lsoiW: iCFK3: goto FGNbn; NcaNm: if ($query[$i]->extra == "\141\x75\164\x6f\x5f\x69\x6e\x63\x72\145\x6d\145\x6e\x74") { goto hJTKi; } goto ex1Tk; gtCdz: $i++; goto NVPHk; ULbIC: $sql = "\123\x45\x4c\x45\x43\124\x20\140\x63\157\154\165\x6d\x6e\x5f\156\x61\x6d\x65\140\54\40\140\156\x75\x6d\145\x72\151\x63\x5f\x70\x72\x65\143\x69\163\151\157\156\140\x2c\x20\x60\145\x78\x74\x72\141\140\54\x20\x60\151\163\x5f\x6e\x75\154\x6c\141\142\x6c\145\140" . "\40\106\x52\117\115\x20\x60\x69\156\146\x6f\162\155\141\x74\x69\157\x6e\x5f\163\x63\150\x65\x6d\141\x60\x2e\140\x63\157\x6c\x75\155\156\163\x60\x20\x57\x48\105\x52\x45\40\164\141\142\x6c\x65\x5f\x73\x63\150\145\155\x61\40\75\x20\x22" . $this->db->database . "\42\x20\101\116\104\x20\x74\141\142\154\145\x5f\156\x61\155\x65\40\x3d\40\42" . $table . "\x22"; goto UrasQ; IFlZy: jx2SM: goto pbPsF; vApC1: wZICb: goto q7DUz; B5CSk: if (!($query[$i]->extra != '')) { goto kY8DY; } goto NcaNm; apbDM: if (!($i < $c)) { goto lru64; } goto WOZ0J; B7wqj: hJTKi: goto nMcPd; qR1rl: $currentDb = FALSE; goto MyYHm; WOZ0J: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto jx2SM; } goto B5CSk; RK8Lu: $datafld = $this->db->field_data($table); goto ULbIC; hh3qe: b4Eav: goto apbDM; NVPHk: goto b4Eav; goto BBmPQ; oa4_d: $retval[$i]->name = $query[$i]->column_name; goto lWDRv; q7DUz: } goto nqyM8; lelQg: $json = (array) $json; goto US_JF; Ia0kk: $edit_columns = []; goto ZOqZr; US_JF: $tbl_baru = array_keys($json); goto MOnoq; I_LCf: $currentDb = []; goto JCMdP; nqyM8: l2A00: goto itUkT; LaaZx: $tabless = $this->db->list_tables(); goto Mraqz; MOnoq: $tbl_ada = array_keys($fields); goto sguwf; IuLbw: $add_columns = []; goto Ia0kk; TDYVY: $full_tables = array_unique($full_tables); goto LgxBt; Mraqz: $fields = []; goto I_LCf; TyZc1: $this->db->db_debug = FALSE; goto LaaZx; hjnjR: $create_tables = []; goto IuLbw; sguwf: $full_tables = array_merge($tbl_baru, $tbl_ada); goto TDYVY; itUkT: $json = file_get_contents("\x2e\57\x61\163\x73\145\164\163\x2f\x61\x70\x70\57\144\x62\x2f\x64\141\164\141\x62\x61\163\145\56\152\x73\x6f\156"); goto Cku7h; LgxBt: sort($full_tables); goto hjnjR; XCLrK: $data = ["\144\142" => $fields, "\x63\x72\145\x61\x74\145" => $create_tables, "\x6d\x6f\x64\x69\x66\x79" => $edit_columns, "\141\144\x64" => $add_columns, "\x63\157\165\x6e\x74\x73" => $counts, "\x6a\163\x6f\156" => $json, "\x63\x75\x72\x72\x65\x6e\164" => $currentDb]; goto E5yer; Cku7h: $json = json_decode($json); goto lelQg; bCnqc: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto XCLrK; UGHH1: we2Ly: goto bCnqc; E5yer: $this->output_json($data); goto aKIfU; aKIfU: } public function updateDatabase() { goto Z9Hz6; riXU3: $full_tables = array_unique($full_tables); goto adjFA; Z9Hz6: $tabless = $this->db->list_tables(); goto R3Fme; JMR09: SvFjQ: goto Fmq4L; Fmq4L: echo true; goto Stzch; BCx3s: $json = file_get_contents("\56\57\x61\163\x73\x65\164\163\57\x61\x70\160\57\144\142\57\x64\x61\164\x61\x62\x61\163\145\x2e\x6a\163\157\156"); goto nfv4a; VeruW: $tbl_baru = array_keys($json); goto Zi435; Zi435: $tbl_ada = array_keys($fields); goto YFxvs; YFxvs: $full_tables = array_merge($tbl_baru, $tbl_ada); goto riXU3; R9z4C: foreach ($full_tables as $table) { goto w032V; IlX6E: if (!isset($json[$table])) { goto y61gU; } goto Jwx9E; WPPXI: goto cafSk; goto LXjkS; TRAxQ: cafSk: goto anzVT; s4my8: eJh97: goto NcY5U; ZwXVs: tWCRm: goto YHtgY; anzVT: JMUFU: goto Cx9Oc; LXjkS: EaFzV: goto kk5CN; NcY5U: AuR12: goto TRAxQ; Jwx9E: foreach ($json[$table] as $tbl => $jtbl) { goto v17bK; imIgn: if (!($jtbl->primary_key == 1)) { goto AZbKR; } goto hMHmz; tAflk: Nj0lU: goto lGIqw; x1KlU: AZbKR: goto tAflk; hMHmz: $this->dbforge->add_key($jtbl->name, true); goto x1KlU; v17bK: $field = [$jtbl->name => ["\x74\171\160\x65" => $jtbl->type, "\143\157\x6e\163\164\162\x61\x69\156\164" => $jtbl->max_length, "\x6e\x75\x6c\154" => $jtbl->primary_key == 0]]; goto vrLXU; vrLXU: $this->dbforge->add_field($field); goto imIgn; lGIqw: } goto ZwXVs; xAVWO: foreach ($json[$table] as $jtbl) { goto AUnPi; AeZzN: goto XjI9t; goto IN0Ih; AzgF_: $field = array($jtbl->name => array("\164\x79\160\145" => $jtbl->type, "\143\x6f\x6e\x73\x74\x72\141\151\156\164" => $jtbl->max_length, "\144\145\146\141\165\154\x74" => $jtbl->default)); goto Odqkf; bVaMy: sJ8oH: goto P32qO; cS013: k01wK: goto MhE10; LRqJP: qrauH: goto cS013; VlPqI: goto qrauH; goto bVaMy; IN0Ih: v0FGi: goto AzgF_; uCO0Z: $this->dbforge->add_column($table, $field); goto AeZzN; P32qO: foreach ($fields[$table] as $ftbl) { goto R13QL; TvZoS: $field = array($jtbl->name => array("\x74\x79\160\x65" => $jtbl->type, "\143\x6f\x6e\163\164\x72\141\151\x6e\x74" => $jtbl->max_length, "\144\x65\146\x61\x75\x6c\164" => $jtbl->default)); goto vIp7x; c1U0S: $field = array($jtbl->name => array("\164\x79\160\x65" => $jtbl->type, "\143\157\156\163\x74\162\x61\x69\156\x74" => $jtbl->max_length, "\x6e\165\154\x6c" => false, "\141\x75\x74\x6f\137\x69\156\x63\162\145\155\145\x6e\x74" => true)); goto CPzwi; XTGmd: if ($jtbl->primary_key == 0) { goto PuwGG; } goto UV0xv; x6SHZ: $this->dbforge->modify_column($table, $field); goto B_sb0; D_pnh: igcyO: goto Tgjpm; vGg_7: $this->dbforge->modify_column($table, $field); goto nTuJH; GpPkX: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto T8CX_; } goto XTGmd; R13QL: if (!($jtbl->name == $ftbl->name)) { goto igcyO; } goto GpPkX; r0Q7B: PjKB1: goto LQrK4; l4Sjw: $field = array($jtbl->name => array("\164\x79\160\x65" => $jtbl->type, "\143\157\x6e\x73\164\x72\x61\x69\156\164" => $jtbl->max_length, "\x6e\165\x6c\x6c" => false)); goto dcUR0; UV0xv: if ($jtbl->auto_increment == true) { goto EU87a; } goto l4Sjw; vIp7x: goto Q2cnO; goto r0Q7B; bkEOk: $field = array($jtbl->name . "\x20\144\x61\164\145\x74\x69\x6d\145\x20\x64\145\x66\141\x75\x6c\164\x20\x63\165\162\162\145\156\x74\137\164\x69\x6d\x65\x73\x74\x61\x6d\x70" . $onUpdate); goto v4ntY; B_sb0: SmiuX: goto ry_s_; dcUR0: goto jDojk; goto JoAJ8; nTuJH: goto SmiuX; goto olXlG; olXlG: PuwGG: goto lr86v; v4ntY: Q2cnO: goto x6SHZ; JoAJ8: EU87a: goto c1U0S; ry_s_: T8CX_: goto D_pnh; CPzwi: jDojk: goto s75KE; lr86v: if ($jtbl->default == "\103\125\x52\x52\105\116\x54\x5f\124\x49\x4d\x45\123\x54\101\x4d\120") { goto PjKB1; } goto TvZoS; LQrK4: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra ?? '') : ''; goto bkEOk; s75KE: $this->dbforge->add_key($jtbl->name, true); goto vGg_7; Tgjpm: Kquo1: goto YpcLw; YpcLw: } goto MIqQm; MIqQm: JE8tY: goto LRqJP; sEhC9: if ($jtbl->primary_key == 0) { goto v0FGi; } goto Ra7Qm; AUnPi: if ($this->db->field_exists($jtbl->name, $table)) { goto sJ8oH; } goto sEhC9; Odqkf: $this->dbforge->add_column($table, $field); goto Tjxhg; Tjxhg: XjI9t: goto VlPqI; evdRj: $this->dbforge->add_key($jtbl->name, true); goto uCO0Z; Ra7Qm: $field = array($jtbl->name => array("\x74\x79\160\x65" => $jtbl->type, "\x63\157\x6e\x73\x74\162\x61\151\x6e\164" => $jtbl->max_length, "\156\165\x6c\x6c" => false)); goto evdRj; MhE10: } goto s4my8; w032V: if ($this->db->table_exists($table)) { goto EaFzV; } goto IlX6E; slpvb: y61gU: goto WPPXI; YHtgY: $this->dbforge->create_table($table, TRUE); goto YbEv_; kk5CN: if (!isset($json[$table])) { goto AuR12; } goto xAVWO; YbEv_: $this->db->query("\101\x4c\124\105\x52\x20\x54\x41\x42\114\x45\x20\40\x60" . $table . "\140\x20\105\x4e\x47\111\116\105\40\x3d\40\x49\x6e\156\x6f\104\102"); goto slpvb; Cx9Oc: } goto JMR09; oRTjK: $json = (array) $json; goto VeruW; twEug: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); WUF4H: } goto dLzVq; nfv4a: $json = json_decode($json); goto oRTjK; adjFA: sort($full_tables); goto R9z4C; dLzVq: wxerQ: goto BCx3s; R3Fme: $fields = []; goto twEug; Stzch: } public function checkDb() { goto gc4hR; Da9zo: $json = file_get_contents("\x2e\57\x61\x73\163\x65\x74\163\57\141\160\x70\x2f\144\x62\x2f\x64\x61\x74\141\142\x61\x73\145\56\x6a\163\x6f\156"); goto qK1ki; cPJLz: Nx9nQ: goto Da9zo; SXjgj: sort($full_tables); goto CRzEO; KpzZ4: $script_create_table = []; goto CpViB; weTsG: $tabless = $this->db->list_tables(); goto FEBaZ; gc4hR: $db_debug = $this->db->db_debug; goto BQ8D3; Yl5z0: $this->db->db_debug = $db_debug; goto n_egp; SwRFp: $full_tables = array_unique($full_tables); goto SXjgj; qfrnI: foreach ($full_tables as $table) { goto BRfNm; lwFeg: o5mYE: goto YmFLw; zhe6Y: umlBQ: goto paOUd; Hzt0u: $add_column = []; goto oEi0z; EzVL9: $script = "\x43\x52\105\x41\x54\105\x20\124\x41\102\x4c\105\40\x60" . $table . "\140\40\x28"; goto ygDTr; d0r6M: goto SkaaB; goto qiebk; QZPa3: if (!(count($add_column) > 0)) { goto umlBQ; } goto V9ZpT; uAFIp: $create_tables[] = $json[$table]; goto EzVL9; paOUd: if (!(count($modif_column) > 0)) { goto g2aSL; } goto xIF1Q; g6E3N: DvQy3: goto ureBT; AUJ9G: if (!isset($json[$table])) { goto S0KhI; } goto Hzt0u; Td2zm: $script_create_table[$table] = $script; goto FspTl; BRfNm: if (!$this->db->table_exists($table)) { goto svsZT; } goto AUJ9G; qiebk: svsZT: goto uAFIp; UrwAX: k6SR_: goto QZPa3; jOxeA: S0KhI: goto d0r6M; YmFLw: $script .= $pri . "\51\x20\x45\116\107\x49\x4e\x45\x3d\x49\156\156\157\104\102\40\x44\105\x46\101\x55\114\124\x20\x43\x48\101\x52\123\105\124\x3d\x75\x74\146\70\155\142\64\73"; goto Td2zm; oEi0z: $modif_column = []; goto xO151; V9ZpT: $script_create_column[$table] = "\101\x4c\x54\105\122\x20\124\x41\x42\114\105\40\x60" . $table . "\140\x20" . implode("\54\40", $add_column) . "\73"; goto zhe6Y; xO151: foreach ($json[$table]->columns as $jtbl) { goto xQWDp; unFGl: $length = ''; goto CAx76; WCvT3: if (!(strtoupper($extra ?? '') == "\40\x41\125\124\x4f\x5f\111\x4e\103\122\105\x4d\105\x4e\x54")) { goto JrwZm; } goto TAZpc; YDe7Z: $length = "\x28" . ($jtbl->max_length + 1) . "\x29"; goto RfgqS; RfgqS: Ed1UE: goto kdZK9; Rra3O: $add_columns[$table][] = $jtbl; goto txplT; CAx76: goto oaBWh; goto wYcL9; ABxDD: bxOIk: goto YDe7Z; kMtqh: if ($jtbl->type != "\154\157\156\x67\164\x65\x78\x74" && $jtbl->type != "\x6d\145\144\x69\x75\x6d\x74\145\170\164" && $jtbl->type != "\x74\x65\170\x74") { goto sDuqg; } goto D39Xw; LyVjJ: if ($jtbl->type == "\x69\156\x74") { goto bxOIk; } goto ym0E0; F7OBZ: $comment = $jtbl->comment == '' ? '' : "\40\103\117\115\x4d\x45\x4e\124\x20\47" . $jtbl->comment . "\x27"; goto nH6Cf; nsbeQ: ojXRg: goto gKBaK; D39Xw: $length = ''; goto DP3i7; DP3i7: goto oaBWh; goto FBD97; kdZK9: oaBWh: goto A5AC7; wYcL9: sDuqg: goto LyVjJ; txplT: if ($jtbl->max_length == null) { goto tYbrp; } goto kMtqh; A5AC7: $nullable = $jtbl->nullable == "\x4e\117" ? "\x20\x4e\117\124\40\x4e\x55\x4c\x4c" : ''; goto XCWXZ; ym0E0: $length = "\50" . $jtbl->max_length . "\x29"; goto yDCFw; XCWXZ: $default = $jtbl->default == null ? '' : "\40\x44\x45\106\101\125\114\124\x20" . $jtbl->default; goto S1Iy3; yDCFw: goto Ed1UE; goto ABxDD; YUmc0: FdL4t: goto nsbeQ; TAZpc: $extra .= "\40\x50\x52\x49\x4d\101\122\131\x20\113\105\x59"; goto GHZhz; FBD97: tYbrp: goto unFGl; GHZhz: JrwZm: goto F7OBZ; hMuux: bUbo8: goto w18Ao; xQWDp: if ($this->db->field_exists($jtbl->name, $table)) { goto bUbo8; } goto Rra3O; nH6Cf: array_push($add_column, "\x41\x44\104\40\140" . $jtbl->name . "\140\40" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto hMuux; w18Ao: foreach ($fields[$table]->columns as $ftbl) { goto GcL29; ODnGK: $edit_columns[$table][$jtbl->name]["\143\x6f\x6c\137\164\x79\x70\145"] = $jtbl->col_type; goto raPxW; DoI3Q: if (!($jtbl->comment != $ftbl->comment)) { goto MRwg1; } goto RIwf8; KLoYS: if (strtolower($jtbl->primary ?? '') == "\160\x72\151") { goto J5Mt5; } goto FaQjo; qPLor: K03AE: goto LyVkj; FaQjo: if (strtolower($jtbl->primary ?? '') == "\165\x6e\x69") { goto mKb6i; } goto rVo_X; VvE5r: if (!($jtbl->primary != $ftbl->primary)) { goto K03AE; } goto yvAkX; LyVkj: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto MG3LV; } goto RMGUy; b_EId: if (!($jtbl->nullable != $ftbl->nullable)) { goto oFKRe; } goto ilweo; xiWi0: $ftbl->default = str_replace("\x28\x29", '', $ftbl->default); goto F_dsg; z4N8L: dza3O: goto wKhgl; mmMMI: $ftbl->extra = strtoupper($ftbl->extra ?? ''); goto z4N8L; kHNGs: if (!($ftbl->extra != null)) { goto dza3O; } goto dCoId; ar3jj: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra ?? ''); goto Co8nZ; Co8nZ: $comment = $jtbl->comment == '' ? '' : "\40\103\117\115\x4d\105\x4e\124\40\x27" . $jtbl->comment . "\x27"; goto UcoeB; v0YAZ: goto MJlCH; goto TJKUE; gA7El: $jtbl->default = str_replace("\x28\51", '', $jtbl->default); goto LdHkT; dCoId: $ftbl->extra = str_replace("\x28\x29", '', $ftbl->extra); goto mmMMI; GcL29: if (!($jtbl->name == $ftbl->name)) { goto Bx9ft; } goto EBAu3; AQ4ly: array_push($modif_column, "\x41\x44\x44\40\125\x4e\x49\121\x55\105\40\x4b\x45\131\x20\140" . $jtbl->name . "\140\40\50\140" . $jtbl->name . "\140\51"); goto gwUzy; F_dsg: $ftbl->default = strtoupper($ftbl->default ?? ''); goto Fhe0m; TJKUE: mKb6i: goto AQ4ly; RMGUy: $nullable = $jtbl->nullable == "\x4e\117" ? "\x20\116\x4f\124\x20\x4e\x55\x4c\x4c" : ''; goto rp6hu; NZxqV: if (!($jtbl->default != $ftbl->default)) { goto ZbbSm; } goto A5iAW; A5iAW: $edit_columns[$table][$jtbl->name]["\x64\145\146\141\x75\x6c\164"] = $jtbl->default; goto aihkM; b2rfB: J5Mt5: goto W90KG; yvAkX: $edit_columns[$table][$jtbl->name]["\160\x72\x69\155\141\162\171"] = $jtbl->primary; goto KLoYS; UcoeB: array_push($modif_column, "\115\x4f\104\111\x46\x59\x20\x60" . $jtbl->name . "\140\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto zyro3; wKhgl: if (!($jtbl->extra != $ftbl->extra)) { goto xato8; } goto lSQZs; cdIQC: xato8: goto DoI3Q; ilweo: $edit_columns[$table][$jtbl->name]["\x6e\165\154\154\x61\x62\x6c\145"] = $jtbl->nullable; goto yKWxN; EBAu3: if (!($jtbl->col_type != $ftbl->col_type)) { goto GkQPu; } goto ODnGK; x_6he: SSWon: goto kHNGs; yKWxN: oFKRe: goto kSi4F; lSQZs: $edit_columns[$table][$jtbl->name]["\145\x78\164\x72\x61"] = $jtbl->extra; goto cdIQC; rVo_X: goto MJlCH; goto b2rfB; rp6hu: $default = $jtbl->default == null ? '' : "\x20\x44\105\106\101\125\x4c\124\x20" . $jtbl->default; goto ar3jj; OgrkZ: if (!($ftbl->default != null)) { goto pVU3M; } goto xiWi0; lYuJf: if (!($jtbl->extra != null)) { goto SSWon; } goto qMZrr; W90KG: array_push($modif_column, "\101\104\x44\40\120\x52\111\x4d\x41\x52\131\40\113\105\x59\x20\50\140" . $jtbl->name . "\x60\x29"); goto v0YAZ; RIwf8: $edit_columns[$table][$jtbl->name]["\143\157\155\x6d\x65\x6e\164"] = $jtbl->comment; goto zXDvT; Fhe0m: pVU3M: goto NZxqV; SUM_l: yX51t: goto oNMV2; UQAKX: $jtbl->extra = strtoupper($jtbl->extra ?? ''); goto x_6he; gwUzy: MJlCH: goto qPLor; zXDvT: MRwg1: goto VvE5r; udg9J: sDXn7: goto OgrkZ; aihkM: ZbbSm: goto lYuJf; vAAmE: Bx9ft: goto SUM_l; LdHkT: $jtbl->default = strtoupper($jtbl->default ?? ''); goto udg9J; raPxW: GkQPu: goto b_EId; kSi4F: if (!($jtbl->default != null)) { goto sDXn7; } goto gA7El; qMZrr: $jtbl->extra = str_replace("\x28\x29", '', $jtbl->extra); goto UQAKX; zyro3: MG3LV: goto vAAmE; oNMV2: } goto YUmc0; S1Iy3: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra ?? ''); goto WCvT3; gKBaK: } goto UrwAX; vTOpI: foreach ($json[$table]->columns as $column) { goto hphnE; M1eFF: $comment = $column->comment == '' ? '' : "\x20\103\x4f\115\x4d\x45\116\x54\40\x27" . $column->comment . "\x27"; goto YWXDH; blpDA: kVNmC: goto qtJIW; x41Rn: $default = $column->default == null ? '' : "\x20\x44\105\106\101\125\x4c\124\40" . $column->default; goto yQ7ys; nl1Wg: $length = ''; goto Jdk7Q; Gc2RW: if ($column->type == "\x69\156\164") { goto xleuA; } goto pHVah; yQ7ys: $extra = $column->extra == '' ? '' : "\40" . strtoupper($column->extra ?? ''); goto M1eFF; YWXDH: $script .= "\x60" . $column->name . "\140\40" . $column->type . $length . $nullable . $default . $extra . $comment . "\x2c\40"; goto gD5ki; gD5ki: $pri .= $column->primary != '' ? "\120\x52\111\x4d\x41\x52\x59\x20\113\x45\131\x20\x28\140" . $column->name . "\x60\x29" : ''; goto gMOSq; tkETS: $length = ''; goto M1RUO; hphnE: if ($column->max_length == null) { goto WMaE9; } goto Bupdk; qtJIW: SxJdz: goto vLl90; Dd3d9: $length = "\50" . ($column->max_length + 1) . "\51"; goto blpDA; Bupdk: if ($column->type != "\x6c\x6f\x6e\x67\x74\x65\170\x74" && $column->type != "\x6d\145\x64\151\165\x6d\164\145\x78\x74" && $column->type != "\x74\x65\x78\x74") { goto BkiGF; } goto tkETS; ogutR: WMaE9: goto nl1Wg; XKrhJ: BkiGF: goto Gc2RW; M1RUO: goto SxJdz; goto ogutR; YoV0t: goto kVNmC; goto ctUDS; Jdk7Q: goto SxJdz; goto XKrhJ; pHVah: $length = "\50" . $column->max_length . "\x29"; goto YoV0t; gMOSq: GOkeh: goto mTR31; vLl90: $nullable = $column->nullable == "\116\x4f" ? "\40\116\117\124\40\x4e\125\x4c\114" : ''; goto x41Rn; ctUDS: xleuA: goto Dd3d9; mTR31: } goto lwFeg; ygDTr: $pri = ''; goto vTOpI; ovxSQ: g2aSL: goto jOxeA; xIF1Q: $script_edit_column[$table] = "\x41\x4c\124\x45\x52\40\124\x41\102\x4c\x45\40\140" . $table . "\140\x20" . implode("\54\40", $modif_column) . "\73"; goto ovxSQ; FspTl: SkaaB: goto g6E3N; ureBT: } goto GaW1z; vAdQZ: $this->output_json($data); goto GTGE1; sMV5A: $script_edit_column = []; goto qfrnI; qK1ki: $json = json_decode($json); goto FW258; l86pg: foreach ($tabless as $table) { goto Asz13; X_9zj: GZw0H: goto PlwIq; CrOlk: $i = 0; goto mTkBv; F5x4C: $retval[$i]->primary = $query[$i]->column_key; goto X_9zj; gLaxK: goto MEGy2; goto zMnq0; zMnq0: LIcgM: goto AdxYj; Px516: $retval[$i]->type = $query[$i]->data_type; goto I3KhB; mSGJT: $retval[$i] = new stdClass(); goto Xdxo3; Gf57w: $retval = array(); goto CrOlk; brDQM: if (!(($query = $this->db->query($sql)) === FALSE)) { goto mubmX; } goto Vjqoq; Asz13: $sql = "\123\x45\x4c\x45\103\x54\x20\x60\143\157\154\165\155\x6e\x5f\x6e\141\x6d\145\140\54\40\x60\143\x6f\154\x75\x6d\x6e\137\164\171\160\x65\140\x2c\40\x60\x63\157\154\x6c\141\x74\x69\x6f\156\137\156\x61\x6d\145\x60\54\40\x60\144\x61\x74\141\137\x74\171\160\x65\140\x2c\x20\x60\143\150\141\162\x61\x63\x74\145\162\x5f\x6d\141\x78\151\155\165\155\x5f\x6c\x65\156\x67\x74\150\140\x2c\x20\x60\x6e\x75\x6d\145\162\151\x63\137\x70\162\x65\143\151\163\x69\157\156\140\54" . "\40\140\x63\x6f\154\x75\155\x6e\x5f\144\x65\x66\x61\165\x6c\164\x60\54\40\140\143\x6f\154\165\155\x6e\x5f\153\145\x79\x60\x2c\x20\140\143\x6f\154\x75\155\x6e\137\143\157\x6d\x6d\x65\156\164\x60\54\x20\x60\145\170\x74\x72\141\x60\x2c\x20\x60\x69\163\x5f\156\x75\x6c\x6c\141\142\154\x65\140\15\xa\11\11\x9\106\x52\x4f\x4d\x20\x60\151\156\146\157\x72\x6d\141\164\x69\157\156\x5f\x73\x63\x68\x65\x6d\141\x60\56\x60\143\x6f\154\165\x6d\x6e\x73\x60\x20\x57\x48\105\x52\105\x20\x74\141\x62\x6c\145\x5f\x73\143\150\145\155\x61\x20\x3d\40\42" . $this->db->database . "\x22\x20\101\116\104\x20\x74\x61\x62\154\145\137\156\x61\155\x65\40\x3d\40\42" . $table . "\42"; goto brDQM; Q2rEy: MEGy2: goto OOFyE; C21WS: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto ZUtaQ; Vjqoq: $fields = FALSE; goto AKPUp; mTkBv: $c = count($query); goto Q2rEy; PlwIq: $i++; goto gLaxK; ZUtaQ: $retval[$i]->default = $query[$i]->column_default; goto VP4An; TzDpR: PGTf_: goto YFosq; VP4An: $retval[$i]->comment = $query[$i]->column_comment; goto F0M08; VFB_c: $retval[$i]->col_type = $query[$i]->column_type; goto Px516; I3KhB: $retval[$i]->collation = $query[$i]->collation_name; goto C21WS; AKPUp: mubmX: goto vR2ZZ; OOFyE: if (!($i < $c)) { goto LIcgM; } goto mSGJT; aXsv1: $retval[$i]->nullable = $query[$i]->is_nullable; goto F5x4C; Xdxo3: $retval[$i]->name = $query[$i]->column_name; goto VFB_c; AdxYj: $fields[$table] = (object) ["\x74\141\x62\x6c\145\x5f\x6e\x61\x6d\145" => $table, "\x63\x6f\x6c\x75\x6d\156\x73" => $retval]; goto TzDpR; F0M08: $retval[$i]->extra = $query[$i]->extra; goto aXsv1; vR2ZZ: $query = $query->result_object(); goto Gf57w; YFosq: } goto cPJLz; GaW1z: axTnn: goto Yl5z0; CRzEO: $create_tables = []; goto KpzZ4; n_egp: $data = ["\146\x69\x65\x6c\144\x73" => $fields, "\143\x72\145\141\x74\145\x5f\164\x61\142\154\145\163" => $create_tables, "\143\157\x75\x6e\x74\137\164\x62\x6c" => count($create_tables), "\x61\x64\144\x5f\143\157\154\165\x6d\x6e\x73\137\x74\157\137\x74\x61\142\x6c\x65" => $add_columns, "\143\157\165\x6e\164\x5f\x63\x6f\154" => count($add_columns), "\x65\144\151\x74\137\143\x6f\154\x75\x6d\x6e\163" => $edit_columns, "\143\157\165\156\x74\x5f\155\x6f\144" => count($edit_columns), "\141\144\144\x5f\164\142\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\144\x64\137\143\x6f\154" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\x6f\x64\137\x63\157\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto vAdQZ; M8OUg: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto SwRFp; BQ8D3: $this->db->db_debug = FALSE; goto weTsG; FW258: $json = (array) $json; goto BtHfM; FEBaZ: $fields = []; goto l86pg; HoYAw: $tbl_ada = array_keys($fields); goto M8OUg; QNx8p: $edit_columns = []; goto sMV5A; BtHfM: $tbl_seharusnya = array_keys($json); goto HoYAw; VASvI: $script_create_column = []; goto QNx8p; CpViB: $add_columns = []; goto VASvI; GTGE1: } public function createTable() { goto YCqyz; ALmqn: sleep(1); goto JjD5p; RZU1n: $this->output_json($data); goto f3x0N; sTmx5: foreach ($scripts as $script) { $queries .= $script; JBl6P: } goto loQyS; Txf8m: $data["\x73\165\x63\x63\145\x73\x73"] = $this->runQuery($queries); goto cEZo1; loQyS: IxKx3: goto Txf8m; UgyEs: $queries = ''; goto sTmx5; cEZo1: $data["\x6d\x65\x73\163\141\x67\x65"] = "\125\x70\144\141\164\145\40\x6b\x6f\x6c\x6f\155"; goto RZU1n; Vrczz: str_replace("\45\x32\x42", "\53", $scripts); goto ALmqn; JjD5p: $scripts = json_decode($this->encryption->decrypt($scripts)); goto UgyEs; YCqyz: $scripts = $this->input->post("\x64\141\164\x61", true); goto Vrczz; f3x0N: } public function createColumn() { goto WrUMl; As2mq: $data["\x73\165\143\143\145\163\163"] = $this->runQuery($queries); goto qj1vE; LAVeH: UTVsk: goto As2mq; o9TaF: FAd3L: goto dphly; sLkrC: $this->updateUID(); goto LAVeH; jJwdu: sleep(1); goto a_OgB; m3wg3: $queries = ''; goto XwhLz; tu0np: str_replace("\45\x32\102", "\x2b", $scripts); goto jJwdu; WrUMl: $scripts = $this->input->post("\144\141\x74\141", true); goto tu0np; XwhLz: foreach ($scripts as $script) { $queries .= $script; nmlZC: } goto o9TaF; qUEdb: $this->output_json($data); goto dPCQK; a_OgB: $scripts = json_decode($this->encryption->decrypt($scripts)); goto m3wg3; qj1vE: $data["\x6d\x65\x73\163\x61\147\145"] = "\115\157\x64\151\146\x79\x20\153\x6f\154\x6f\155"; goto qUEdb; dphly: if (!(strpos("\x60\x75\151\144\x60", $queries) !== false)) { goto UTVsk; } goto sLkrC; dPCQK: } public function editColumn() { goto TpI3G; fW3Jk: $scripts = json_decode($this->encryption->decrypt($scripts)); goto Rt4Bk; nyxYa: $this->output_json($data); goto bhzwN; u2JVf: $data["\163\165\143\143\145\x73\163"] = $this->runQuery($queries); goto T25QX; W2Xa8: str_replace("\45\62\102", "\53", $scripts); goto rR2tp; TpI3G: $scripts = $this->input->post("\x64\x61\x74\x61", true); goto W2Xa8; T25QX: $data["\x6d\x65\163\163\x61\147\145"] = "\x55\160\144\141\x74\145\x20\163\145\154\145\x73\141\151"; goto nyxYa; mZbJd: foreach ($scripts as $script) { $queries .= $script; mmt2z: } goto r4lSk; r4lSk: gAep6: goto u2JVf; Rt4Bk: $queries = ''; goto mZbJd; rR2tp: sleep(1); goto fW3Jk; bhzwN: } function runQuery($script) { goto WFhyl; LHORc: VvlHs: goto nwwY_; Dz4Cg: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto i8r_6; XaGOi: return mysqli_connect_errno(); goto LHORc; nwwY_: $mysqli->multi_query($script); goto Ucmxw; i8r_6: if (!mysqli_connect_errno()) { goto VvlHs; } goto XaGOi; In9nx: $hostuser = $this->db->username; goto iGt3R; PHXK0: return true; goto M7JjJ; Ucmxw: $mysqli->close(); goto PHXK0; iGt3R: $hostpass = $this->db->password; goto D0B14; D0B14: $database = $this->db->database; goto Dz4Cg; WFhyl: $hostname = $this->db->hostname; goto In9nx; M7JjJ: } function updateUID() { goto LWqxZ; l10Rw: H0Ged: goto CNnjJ; CNnjJ: return $this->db->update_batch("\x6d\141\x73\164\145\x72\137\x73\x69\x73\167\x61", $input, "\x69\144\x5f\163\x69\163\x77\x61"); goto MIOhs; bPacd: $siswas = $this->db->get("\x6d\x61\x73\x74\x65\162\137\x73\151\163\167\x61")->result(); goto uDwAn; wEeQj: foreach ($siswas as $siswa) { $input[] = array("\151\x64\137\x73\x69\x73\167\141" => $siswa->id_siswa, "\165\151\144" => $this->uuid->v4()); dRlrv: } goto l10Rw; LWqxZ: $this->load->library("\x55\165\151\144", "\165\x75\x69\144"); goto bPacd; uDwAn: $input = array(); goto wEeQj; MIOhs: } function make_base() { } }
