<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\x53\105\x50\101\x54\x48") or exit("\x4e\157\40\144\151\162\x65\143\164\40\x73\x63\162\151\160\x74\x20\x61\143\x63\x65\163\163\x20\x61\x6c\154\157\167\145\144"); class Update extends CI_Controller { function __construct() { goto niyP2; CFv4R: $this->load->database(); goto uDK5k; uDK5k: $this->load->library("\145\156\143\x72\171\x70\x74\151\157\156"); goto oNalK; Z5z9a: $this->load->dbforge(); goto CFv4R; niyP2: parent::__construct(); goto rzkru; rzkru: include APPPATH . "\x63\x6f\x6e\x66\151\147\57\144\141\164\141\142\x61\163\x65\x2e\160\x68\160"; goto Z5z9a; oNalK: } public function output_json($data, $encode = true) { goto dT0va; bpAN5: $data = json_encode($data); goto mtvQu; mtvQu: RRqvP: goto rdPMM; rdPMM: $this->output->set_content_type("\141\x70\x70\x6c\x69\143\x61\x74\151\157\x6e\57\x6a\163\x6f\156")->set_output($data); goto PVTo6; dT0va: if (!$encode) { goto RRqvP; } goto bpAN5; PVTo6: } public function index() { goto GUKt3; iH5Zs: $this->load->view("\x69\x6e\163\164\141\x6c\154\x2f\x68\x65\x61\x64\145\x72", $data); goto s9L40; M98RD: $this->load->view("\151\156\163\164\x61\x6c\x6c\x2f\x66\x6f\157\x74\145\x72"); goto YZp_X; GUKt3: $json = file_get_contents("\x2e\57\141\x73\x73\x65\164\163\x2f\141\160\x70\57\144\142\57\144\141\x74\x61\x62\x61\163\x65\x2e\152\163\x6f\156"); goto U6cnO; s9L40: $this->load->view("\151\x6e\163\x74\x61\x6c\154\x2f\x75\160\x64\141\x74\x65"); goto M98RD; U6cnO: $json = json_decode($json); goto h2I21; h2I21: $json = (array) $json; goto xo1wD; xo1wD: $data["\x6a\163\157\x6e"] = $json; goto iH5Zs; YZp_X: } function object_to_array($data) { goto GGw1j; qPDPH: return $result; goto KbaDD; KbaDD: fy9x5: goto QwpTx; pDjjO: $result = []; goto FRRSZ; FRRSZ: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; PLcew: } goto mD1qX; GGw1j: if (!(is_array($data) || is_object($data))) { goto fy9x5; } goto pDjjO; QwpTx: return $data; goto qJ5kB; mD1qX: lgwg3: goto qPDPH; qJ5kB: } public function checkDatabase() { goto ygnD9; X3Csw: $full_tables = array_merge($tbl_baru, $tbl_ada); goto xicUQ; HaemF: $json = file_get_contents("\x2e\57\141\163\x73\x65\164\x73\57\x61\x70\x70\x2f\144\142\57\144\141\164\141\142\x61\x73\x65\x2e\x6a\x73\x6f\x6e"); goto U4ev0; ULDho: $json = (array) $json; goto ZbJ6r; XUurw: $fields = []; goto VNBf9; U4ev0: $json = json_decode($json); goto ULDho; RL639: $this->db->db_debug = FALSE; goto kHPvl; xicUQ: $full_tables = array_unique($full_tables); goto t6K1e; ZbJ6r: $tbl_baru = array_keys($json); goto aRKGn; bdRfZ: $this->output_json($data); goto BGZKO; YJRaG: foreach ($tabless as $table) { goto sZjnE; brgAl: sZuet: goto OrJDV; MO1Zd: vKc0X: goto hyg0_; AnEBD: PpuQx: goto HTr_e; hyg0_: $retval[$i] = new stdClass(); goto jAnIg; OrJDV: $i++; goto wbrOT; Y5yJc: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto vKc0X; } goto M8cR6; WCX_a: $datafld[$i]->auto_increment = true; goto KZEZk; gN7CD: $i = 0; goto Xoz1B; qaKME: iPIJg: goto wL1P7; bJLHw: $fields[$table] = $datafld; goto qaKME; rNwF5: $retval = array(); goto gN7CD; oDk5O: qVkQt: goto gxw45; GvQRs: $sql = "\x53\105\114\105\x43\124\x20\x60\x63\157\154\165\x6d\x6e\x5f\156\x61\x6d\x65\140\54\40\x60\x6e\165\x6d\x65\x72\x69\143\x5f\x70\x72\145\143\x69\x73\x69\x6f\156\x60\54\40\140\145\170\164\x72\141\x60\x2c\x20\140\151\x73\x5f\x6e\x75\154\x6c\x61\142\154\x65\140" . "\40\x46\122\117\x4d\40\140\x69\156\146\x6f\x72\155\141\x74\x69\x6f\x6e\x5f\163\143\x68\145\x6d\x61\140\x2e\x60\x63\x6f\154\165\x6d\156\x73\x60\40\x57\110\x45\x52\x45\40\x74\141\x62\154\145\137\163\x63\150\145\x6d\x61\x20\75\40\42" . $this->db->database . "\42\40\101\116\104\x20\x74\x61\x62\x6c\x65\x5f\156\141\x6d\x65\40\x3d\40\42" . $table . "\x22"; goto MBXtG; CRzqP: $currentDb = FALSE; goto NVi6f; Xoz1B: $c = count($query); goto oDk5O; reLAh: oF_G4: goto WCX_a; MBXtG: if (!(($query = $this->db->query($sql)) === FALSE)) { goto FwSwY; } goto CRzqP; M8cR6: if (!($query[$i]->extra != '')) { goto YJftk; } goto MftWf; HTr_e: $currentDb[$table] = $retval; goto bJLHw; sZjnE: $datafld = $this->db->field_data($table); goto GvQRs; XAxu_: $query = $query->result_object(); goto rNwF5; NVi6f: FwSwY: goto XAxu_; MftWf: if ($query[$i]->extra == "\x61\165\164\x6f\137\151\x6e\143\x72\145\155\x65\156\x74") { goto oF_G4; } goto P01Gp; wPrp7: YJftk: goto MO1Zd; P01Gp: $datafld[$i]->extra = $query[$i]->extra; goto cBw3A; wbrOT: goto qVkQt; goto AnEBD; xze19: $retval[$i]->extra = $query[$i]->extra; goto brgAl; jAnIg: $retval[$i]->name = $query[$i]->column_name; goto xze19; KZEZk: s27K3: goto wPrp7; cBw3A: goto s27K3; goto reLAh; gxw45: if (!($i < $c)) { goto PpuQx; } goto Y5yJc; wL1P7: } goto sAMki; aRKGn: $tbl_ada = array_keys($fields); goto X3Csw; hPxpO: $data = ["\144\142" => $fields, "\143\x72\x65\141\x74\x65" => $create_tables, "\155\157\x64\x69\146\x79" => $edit_columns, "\x61\144\x64" => $add_columns, "\143\x6f\165\156\x74\x73" => $counts, "\152\163\157\x6e" => $json, "\143\x75\x72\162\x65\x6e\x74" => $currentDb]; goto bdRfZ; fsvTE: foreach ($full_tables as $table) { goto Fpsok; oSKH_: ZptXW: goto hzRcn; iCV_2: VjUqp: goto o5mDH; Sh_ur: YvUO5: goto YgT3b; HV3rl: foreach ($json[$table] as $jtbl) { goto RJjFe; yL7SD: goto EsK3F; goto Ih9aX; ahuoD: $add_columns[$table][] = $jtbl; goto yL7SD; IhfFO: foreach ($fields[$table] as $ftbl) { goto y7Sy1; JPAz3: y92bf: goto fN1IN; qBHTu: eRqus: goto TvDT9; wMj8q: $edit_columns[$table][] = $jtbl; goto JPAz3; pEKCU: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto y92bf; } goto wMj8q; fN1IN: kKc2e: goto qBHTu; y7Sy1: if (!($jtbl->name == $ftbl->name)) { goto kKc2e; } goto pEKCU; TvDT9: } goto Y8OXw; RJjFe: if ($this->db->field_exists($jtbl->name, $table)) { goto yZUQK; } goto ahuoD; Y8OXw: AS01n: goto BPL7T; BPL7T: EsK3F: goto NtRgA; NtRgA: TjLEz: goto ADRbi; Ih9aX: yZUQK: goto IhfFO; ADRbi: } goto zv7m3; T06M0: goto i7yOI; goto iCV_2; o5mDH: if (!isset($json[$table])) { goto ZptXW; } goto HV3rl; zv7m3: PI8NI: goto oSKH_; hzRcn: i7yOI: goto Sh_ur; zUcsk: $create_tables[$table] = $json[$table]; goto T06M0; Fpsok: if ($this->db->table_exists($table)) { goto VjUqp; } goto zUcsk; YgT3b: } goto jRfRi; Pw9Cy: $create_tables = []; goto vXH8I; AkQbX: $edit_columns = []; goto fsvTE; t6K1e: sort($full_tables); goto Pw9Cy; kHPvl: $tabless = $this->db->list_tables(); goto XUurw; sAMki: xlwRU: goto HaemF; XJXGf: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto hPxpO; vXH8I: $add_columns = []; goto AkQbX; ygnD9: $db_debug = $this->db->db_debug; goto RL639; VNBf9: $currentDb = []; goto YJRaG; jRfRi: tS0_k: goto XJXGf; BGZKO: } public function updateDatabase() { goto wvnpR; V1KQT: KZkN1: goto Fzoqe; WBChq: $full_tables = array_unique($full_tables); goto QlNNB; MgXtZ: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); yVlKg: } goto CNIeO; kTk8t: $full_tables = array_merge($tbl_baru, $tbl_ada); goto WBChq; kXyTn: foreach ($full_tables as $table) { goto ntalt; cmn3N: x1plf: goto dzO5r; fsVCm: bT40H: goto cmn3N; n3xTA: cBAFY: goto pMb9g; MkWBr: $this->db->query("\101\x4c\x54\105\122\40\x54\x41\102\x4c\x45\40\40\x60" . $table . "\x60\40\105\116\107\x49\x4e\105\x20\x3d\x20\x49\156\156\157\x44\x42"); goto anwKj; anwKj: hYZ2w: goto TODZT; TODZT: goto bT40H; goto n3xTA; L9WNU: foreach ($json[$table] as $jtbl) { goto XIjgz; H5F0Y: nLbMs: goto XLlY9; RdEyY: $this->dbforge->add_column($table, $field); goto H5F0Y; vq1RD: sYCH4: goto Xz01U; g81w9: v2_X3: goto yyQQ8; XIjgz: if ($this->db->field_exists($jtbl->name, $table)) { goto v2_X3; } goto Miid_; mO3sL: $field = array($jtbl->name => array("\164\x79\160\x65" => $jtbl->type, "\143\x6f\156\163\164\x72\141\x69\156\x74" => $jtbl->max_length, "\x6e\x75\154\154" => false)); goto wl0QJ; rqcsU: qFy9r: goto NzS69; C4R16: goto nLbMs; goto ORHwi; jTakM: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\143\157\156\163\164\x72\141\151\156\164" => $jtbl->max_length, "\144\145\146\141\165\154\x74" => $jtbl->default)); goto RdEyY; ORHwi: FQgGI: goto jTakM; UTjox: $this->dbforge->add_column($table, $field); goto C4R16; Xz01U: i5BBv: goto rqcsU; yyQQ8: foreach ($fields[$table] as $ftbl) { goto tJrw8; hdwmp: $field = array($jtbl->name => array("\x74\x79\x70\145" => $jtbl->type, "\143\x6f\156\163\x74\162\141\x69\x6e\x74" => $jtbl->max_length, "\156\165\154\x6c" => false, "\141\x75\x74\x6f\137\151\156\143\x72\x65\155\x65\x6e\x74" => true)); goto ue2Xi; UwgEz: goto ce92t; goto FLD3S; E2S37: if ($jtbl->primary_key == 0) { goto YcUYv; } goto yi1Ew; EC4dT: fag9Z: goto UX_D3; ioTec: $field = array($jtbl->name => array("\x74\171\160\145" => $jtbl->type, "\143\157\156\163\164\x72\x61\151\x6e\x74" => $jtbl->max_length, "\x64\x65\x66\141\165\x6c\164" => $jtbl->default)); goto wvr1L; gJ8e2: if ($jtbl->default == "\x43\125\x52\x52\105\116\124\137\124\x49\x4d\x45\123\x54\x41\115\120") { goto GyU2z; } goto ioTec; t8A6J: LF_9E: goto EC4dT; uuZBr: GUOvC: goto SY1e0; tJrw8: if (!($jtbl->name == $ftbl->name)) { goto LF_9E; } goto rWsaw; PfxQ_: goto lSoei; goto o2MOC; IKee3: $field = array($jtbl->name => array("\x74\x79\x70\145" => $jtbl->type, "\143\157\156\x73\x74\162\x61\151\156\164" => $jtbl->max_length, "\156\165\154\154" => false)); goto UwgEz; VlIOq: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto lJ3EP; GOrme: GyU2z: goto VlIOq; FLD3S: P4xsO: goto hdwmp; I8jlv: jfc0n: goto t8A6J; ue2Xi: ce92t: goto CuvPr; yi1Ew: if ($jtbl->auto_increment == true) { goto P4xsO; } goto IKee3; lJ3EP: $field = array($jtbl->name . "\40\x64\141\164\145\164\151\x6d\145\40\144\145\x66\x61\165\x6c\x74\40\x63\165\x72\x72\x65\x6e\x74\137\164\151\155\x65\x73\164\x61\x6d\160" . $onUpdate); goto uuZBr; rWsaw: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto jfc0n; } goto E2S37; o2MOC: YcUYv: goto gJ8e2; CuvPr: $this->dbforge->add_key($jtbl->name, true); goto DqYS_; DqYS_: $this->dbforge->modify_column($table, $field); goto PfxQ_; wvr1L: goto GUOvC; goto GOrme; XL8tx: lSoei: goto I8jlv; SY1e0: $this->dbforge->modify_column($table, $field); goto XL8tx; UX_D3: } goto vq1RD; Miid_: if ($jtbl->primary_key == 0) { goto FQgGI; } goto mO3sL; XLlY9: goto i5BBv; goto g81w9; wl0QJ: $this->dbforge->add_key($jtbl->name, true); goto UTjox; NzS69: } goto bTpct; QHDsy: $this->dbforge->create_table($table, TRUE); goto MkWBr; ntalt: if ($this->db->table_exists($table)) { goto cBAFY; } goto ku2vq; xLFH4: foreach ($json[$table] as $tbl => $jtbl) { goto w347p; xOtwP: $this->dbforge->add_key($jtbl->name, true); goto xRFCG; ApaPn: $this->dbforge->add_field($field); goto t4PQ3; prtKY: uEih7: goto Uop4z; t4PQ3: if (!($jtbl->primary_key == 1)) { goto L0OAM; } goto xOtwP; w347p: $field = [$jtbl->name => ["\x74\171\x70\145" => $jtbl->type, "\x63\x6f\156\163\x74\x72\x61\151\156\164" => $jtbl->max_length, "\156\x75\x6c\x6c" => $jtbl->primary_key == 0]]; goto ApaPn; xRFCG: L0OAM: goto prtKY; Uop4z: } goto CkHt9; ku2vq: if (!isset($json[$table])) { goto hYZ2w; } goto xLFH4; CkHt9: BIDjr: goto QHDsy; bTpct: NBo98: goto vBlew; vBlew: aa2WE: goto fsVCm; pMb9g: if (!isset($json[$table])) { goto aa2WE; } goto L9WNU; dzO5r: } goto V1KQT; COM9R: $tbl_baru = array_keys($json); goto trdtx; oz3UM: $json = file_get_contents("\x2e\57\141\163\163\145\164\x73\57\141\x70\160\x2f\x64\142\57\144\141\164\x61\x62\x61\163\x65\56\152\163\157\x6e"); goto DY4Xo; CNIeO: O1_1I: goto oz3UM; wvnpR: $tabless = $this->db->list_tables(); goto g_D9S; Fzoqe: echo true; goto pOGdf; QlNNB: sort($full_tables); goto kXyTn; g_D9S: $fields = []; goto MgXtZ; trdtx: $tbl_ada = array_keys($fields); goto kTk8t; DY4Xo: $json = json_decode($json); goto JY95V; JY95V: $json = (array) $json; goto COM9R; pOGdf: } public function checkDb() { goto mcFtg; u5T_i: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto TVzCE; leCjN: $json = file_get_contents("\56\x2f\x61\x73\x73\145\164\163\57\141\160\160\x2f\x64\x62\57\144\x61\x74\x61\x62\141\163\145\56\x6a\x73\x6f\156"); goto fgZ38; inKK6: $tbl_seharusnya = array_keys($json); goto au2Lg; mcFtg: $db_debug = $this->db->db_debug; goto hJz8z; au2Lg: $tbl_ada = array_keys($fields); goto u5T_i; lnEo0: $this->db->db_debug = $db_debug; goto Z03h6; TVzCE: $full_tables = array_unique($full_tables); goto uoC4v; Vg3xm: $add_columns = []; goto X6Gd7; xxAr0: $tabless = $this->db->list_tables(); goto LI5DM; hJz8z: $this->db->db_debug = FALSE; goto xxAr0; uoC4v: sort($full_tables); goto AEfFN; uNemr: $this->output_json($data); goto Ta8Ow; pl_Qu: $edit_columns = []; goto uWh3v; B7kIL: sRR6E: goto leCjN; uWh3v: $script_edit_column = []; goto j1ZCE; xamH6: $json = (array) $json; goto inKK6; X6Gd7: $script_create_column = []; goto pl_Qu; j1ZCE: foreach ($full_tables as $table) { goto y40ww; CPNgY: foreach ($json[$table]->columns as $column) { goto sEqp7; oOu0u: O0xD9: goto RtKB4; q1Yhf: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto DGD7U; RtKB4: $length = ''; goto uvZ_Q; EHB7R: if ($column->type == "\x69\156\x74") { goto ciwn9; } goto axaKL; jtpey: $default = $column->default == null ? '' : "\x20\104\x45\106\101\x55\x4c\x54\40" . $column->default; goto q1Yhf; hdLAb: ciwn9: goto n71Cq; VMtl1: if ($column->type != "\154\x6f\156\147\x74\x65\170\x74" && $column->type != "\x6d\x65\144\151\x75\155\164\x65\170\x74" && $column->type != "\x74\x65\170\x74") { goto Le46N; } goto aM4oa; zPMGG: goto AHqaB; goto hdLAb; aM4oa: $length = ''; goto vyOPC; KHCql: $nullable = $column->nullable == "\x4e\x4f" ? "\40\x4e\x4f\x54\40\x4e\x55\114\x4c" : ''; goto jtpey; lN6_3: vWPrv: goto JTe6A; rXcHD: cRtlE: goto KHCql; uvZ_Q: goto cRtlE; goto Fx73q; Cu3L8: AHqaB: goto rXcHD; vyOPC: goto cRtlE; goto oOu0u; grJOB: $script .= "\140" . $column->name . "\x60\x20" . $column->type . $length . $nullable . $default . $extra . $comment . "\x2c\40"; goto oguEu; n71Cq: $length = "\x28" . ($column->max_length + 1) . "\51"; goto Cu3L8; axaKL: $length = "\x28" . $column->max_length . "\51"; goto zPMGG; Fx73q: Le46N: goto EHB7R; sEqp7: if ($column->max_length == null) { goto O0xD9; } goto VMtl1; DGD7U: $comment = $column->comment == '' ? '' : "\x20\x43\117\115\115\105\116\x54\x20\47" . $column->comment . "\47"; goto grJOB; oguEu: $pri .= $column->primary != '' ? "\x50\122\x49\115\x41\x52\131\40\113\x45\131\x20\50\140" . $column->name . "\x60\x29" : ''; goto lN6_3; JTe6A: } goto HTivX; hvJhN: LCVjn: goto ijnlU; H2EJA: $script_edit_column[$table] = "\x41\114\124\x45\122\x20\124\x41\102\114\105\40\x60" . $table . "\x60\x20" . implode("\x2c\x20", $modif_column) . "\x3b"; goto T83O0; Tlui0: $modif_column = []; goto CfiM6; BBhbP: if (!(count($modif_column) > 0)) { goto BX54E; } goto H2EJA; oQcFs: $script_create_table[$table] = $script; goto yT4bG; wRfrj: O310E: goto BBhbP; ijnlU: goto WkyYB; goto xjU4y; XkBjY: $script_create_column[$table] = "\101\x4c\124\105\x52\40\124\x41\102\114\105\x20\140" . $table . "\x60\40" . implode("\54\40", $add_column) . "\73"; goto wRfrj; T83O0: BX54E: goto hvJhN; fbZ21: $create_tables[] = $json[$table]; goto iAfTk; f_qec: if (!isset($json[$table])) { goto LCVjn; } goto ARerI; dKRn5: $pri = ''; goto CPNgY; nIqre: X_syF: goto iu3oh; U7VOE: $script .= $pri . "\x29\x20\x45\x4e\x47\111\116\105\x3d\x49\156\x6e\x6f\104\102\x20\x44\x45\x46\x41\125\114\x54\x20\x43\110\x41\122\123\105\124\x3d\x75\x74\146\x38\x6d\142\64\x3b"; goto oQcFs; sxw4k: if (!(count($add_column) > 0)) { goto O310E; } goto XkBjY; iAfTk: $script = "\103\x52\105\x41\124\105\40\x54\101\102\114\105\40\140" . $table . "\140\40\x28"; goto dKRn5; ARerI: $add_column = []; goto Tlui0; HTivX: ALST2: goto U7VOE; yT4bG: WkyYB: goto nIqre; mFX1U: rF8QB: goto sxw4k; xjU4y: bzePj: goto fbZ21; CfiM6: foreach ($json[$table]->columns as $jtbl) { goto BWMAr; xE1zT: if ($jtbl->max_length == null) { goto TP_PN; } goto ZKR59; pWdo1: WimWr: goto zAgfi; Y1JLE: $length = "\x28" . $jtbl->max_length . "\x29"; goto lDICx; lDICx: goto jjEfW; goto kyRB2; dpDuU: if (!(strtoupper($extra) == "\x20\101\x55\124\117\137\x49\x4e\103\x52\x45\115\x45\x4e\x54")) { goto vFBMe; } goto de2Th; XFOsi: array_push($add_column, "\101\x44\x44\40\x60" . $jtbl->name . "\x60\40" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto Y1PNF; vqS8R: vFBMe: goto EPWOr; dqd71: foreach ($fields[$table]->columns as $ftbl) { goto pseNP; d6hrQ: goto IVlt5; goto PxV1B; vBRZT: dqCpM: goto RfMtb; p5iz5: array_push($modif_column, "\115\117\x44\111\x46\131\40\x60" . $jtbl->name . "\140\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto crnPZ; zdZT7: $jtbl->default = str_replace("\x28\x29", '', $jtbl->default); goto a206Q; beZHW: idnDK: goto e82nB; Fbomo: if (!($jtbl->primary != $ftbl->primary)) { goto W0hG3; } goto CwqLx; nrueB: if (!($ftbl->extra != null)) { goto KgQE5; } goto ogvti; qaqwd: $jtbl->extra = strtoupper($jtbl->extra); goto PwbMu; CwqLx: $edit_columns[$table][$jtbl->name]["\160\x72\151\x6d\x61\x72\x79"] = $jtbl->primary; goto uisho; A5mYo: IVlt5: goto CoC1Y; x4pUB: if (!($jtbl->default != null)) { goto dqCpM; } goto zdZT7; X8YCC: array_push($modif_column, "\101\104\x44\x20\x55\116\x49\x51\125\x45\40\113\x45\131\40\140" . $jtbl->name . "\140\40\x28\x60" . $jtbl->name . "\140\51"); goto A5mYo; DwCJn: if (!($jtbl->extra != $ftbl->extra)) { goto eZioi; } goto GpAoB; a206Q: $jtbl->default = strtoupper($jtbl->default); goto vBRZT; YS34a: $edit_columns[$table][$jtbl->name]["\x63\157\x6c\x5f\x74\x79\160\145"] = $jtbl->col_type; goto Zb05E; C0m7I: if (!($jtbl->comment != $ftbl->comment)) { goto UMMaG; } goto WqgUO; CoC1Y: W0hG3: goto DbsTQ; RfMtb: if (!($ftbl->default != null)) { goto Mcner; } goto g3_x3; TOt1D: $default = $jtbl->default == null ? '' : "\x20\104\x45\x46\101\x55\114\x54\40" . $jtbl->default; goto U8_Rk; m_wdt: KgQE5: goto DwCJn; AupQY: if (!($jtbl->default != $ftbl->default)) { goto idnDK; } goto EJEad; Sj1In: q0Woa: goto Wgs6u; yyieF: if (!($jtbl->col_type != $ftbl->col_type)) { goto tkKiD; } goto YS34a; pseNP: if (!($jtbl->name == $ftbl->name)) { goto F2_SV; } goto yyieF; Zb05E: tkKiD: goto obhuF; bu0Qw: Mcner: goto AupQY; GpAoB: $edit_columns[$table][$jtbl->name]["\145\x78\164\162\x61"] = $jtbl->extra; goto tXLFM; g3_x3: $ftbl->default = str_replace("\x28\51", '', $ftbl->default); goto kowyR; kowyR: $ftbl->default = strtoupper($ftbl->default); goto bu0Qw; jvCuZ: $edit_columns[$table][$jtbl->name]["\156\x75\154\154\x61\142\154\145"] = $jtbl->nullable; goto x451d; uisho: if (strtolower($jtbl->primary) == "\160\x72\x69") { goto q0Woa; } goto neJYL; U8_Rk: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto DEj2N; E2NlL: UMMaG: goto Fbomo; xrHOL: $nullable = $jtbl->nullable == "\116\117" ? "\40\x4e\x4f\124\x20\x4e\x55\114\x4c" : ''; goto TOt1D; VReIT: F2_SV: goto P4nwn; PwbMu: xQfWg: goto nrueB; DbsTQ: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto MHtoa; } goto xrHOL; Wgs6u: array_push($modif_column, "\x41\104\104\x20\120\x52\x49\115\101\122\131\40\113\105\131\x20\50\x60" . $jtbl->name . "\140\51"); goto d6hrQ; Ju0Fi: goto IVlt5; goto Sj1In; neJYL: if (strtolower($jtbl->primary) == "\165\156\151") { goto O4krX; } goto Ju0Fi; obhuF: if (!($jtbl->nullable != $ftbl->nullable)) { goto aJ4sA; } goto jvCuZ; WqgUO: $edit_columns[$table][$jtbl->name]["\x63\157\155\x6d\x65\x6e\x74"] = $jtbl->comment; goto E2NlL; PxV1B: O4krX: goto X8YCC; tXLFM: eZioi: goto C0m7I; le43E: $jtbl->extra = str_replace("\x28\51", '', $jtbl->extra); goto qaqwd; DdmLZ: $ftbl->extra = strtoupper($ftbl->extra); goto m_wdt; DEj2N: $comment = $jtbl->comment == '' ? '' : "\40\103\117\x4d\x4d\105\116\124\x20\x27" . $jtbl->comment . "\x27"; goto p5iz5; e82nB: if (!($jtbl->extra != null)) { goto xQfWg; } goto le43E; crnPZ: MHtoa: goto VReIT; EJEad: $edit_columns[$table][$jtbl->name]["\144\145\x66\141\x75\x6c\x74"] = $jtbl->default; goto beZHW; P4nwn: gdMuq: goto G3TX_; x451d: aJ4sA: goto x4pUB; ogvti: $ftbl->extra = str_replace("\x28\51", '', $ftbl->extra); goto DdmLZ; G3TX_: } goto Ef3aL; zAgfi: if ($jtbl->type == "\151\156\164") { goto r7pBS; } goto Y1JLE; EPWOr: $comment = $jtbl->comment == '' ? '' : "\40\103\x4f\x4d\115\x45\116\124\40\x27" . $jtbl->comment . "\47"; goto XFOsi; Y1PNF: shf3h: goto dqd71; Ef3aL: dMkgy: goto L3H9d; y6enu: goto nE7uq; goto VuGQj; VuGQj: TP_PN: goto ZwKgc; kyRB2: r7pBS: goto JGTaJ; v3y4M: $add_columns[$table][] = $jtbl; goto xE1zT; ZKR59: if ($jtbl->type != "\x6c\x6f\156\147\x74\145\x78\x74" && $jtbl->type != "\155\145\144\151\x75\155\164\x65\170\x74" && $jtbl->type != "\x74\x65\x78\x74") { goto WimWr; } goto bnI8u; ZwKgc: $length = ''; goto pSI2M; nrxEy: $default = $jtbl->default == null ? '' : "\x20\104\x45\x46\x41\125\114\x54\x20" . $jtbl->default; goto sjXq7; scyDj: $nullable = $jtbl->nullable == "\x4e\117" ? "\x20\116\x4f\x54\40\116\x55\x4c\114" : ''; goto nrxEy; JGTaJ: $length = "\50" . ($jtbl->max_length + 1) . "\51"; goto VQMM6; eEtI9: nE7uq: goto scyDj; pSI2M: goto nE7uq; goto pWdo1; de2Th: $extra .= "\x20\x50\x52\x49\115\x41\122\131\x20\113\105\x59"; goto vqS8R; sjXq7: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto dpDuU; bnI8u: $length = ''; goto y6enu; BWMAr: if ($this->db->field_exists($jtbl->name, $table)) { goto shf3h; } goto v3y4M; L3H9d: kqC1l: goto FUqkT; VQMM6: jjEfW: goto eEtI9; FUqkT: } goto mFX1U; y40ww: if (!$this->db->table_exists($table)) { goto bzePj; } goto f_qec; iu3oh: } goto NuBS5; fgZ38: $json = json_decode($json); goto xamH6; AEfFN: $create_tables = []; goto fPr1K; Z03h6: $data = ["\x66\x69\145\154\144\163" => $fields, "\143\x72\145\141\164\145\137\x74\141\x62\154\x65\163" => $create_tables, "\x63\x6f\x75\x6e\164\x5f\x74\x62\x6c" => count($create_tables), "\x61\x64\144\x5f\143\157\154\165\155\x6e\163\x5f\164\x6f\x5f\164\x61\142\x6c\145" => $add_columns, "\143\157\165\156\164\137\143\157\154" => count($add_columns), "\x65\x64\151\164\137\x63\x6f\154\x75\155\156\x73" => $edit_columns, "\143\x6f\x75\156\164\137\155\157\144" => count($edit_columns), "\x61\144\x64\137\164\142\x6c" => $this->encryption->encrypt(json_encode($script_create_table)), "\x61\144\x64\x5f\143\x6f\154" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\157\144\x5f\x63\157\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto uNemr; mVreg: foreach ($tabless as $table) { goto pL0d4; gaWUu: $retval[$i]->comment = $query[$i]->column_comment; goto u6_0S; MDS7O: $i = 0; goto ePuqR; VumlO: goto s6Fyo; goto lpZ0E; pL0d4: $sql = "\x53\x45\114\105\103\124\x20\140\x63\157\x6c\x75\155\156\137\x6e\x61\155\x65\x60\x2c\x20\x60\143\157\154\x75\155\156\x5f\x74\x79\x70\x65\x60\x2c\40\x60\x63\157\154\154\x61\164\x69\x6f\x6e\x5f\x6e\141\x6d\x65\140\54\40\x60\x64\141\164\141\137\164\171\x70\x65\x60\x2c\40\140\x63\x68\x61\162\x61\143\x74\x65\x72\137\x6d\x61\x78\151\155\x75\155\x5f\154\x65\156\x67\164\150\140\54\x20\140\156\165\155\145\x72\x69\143\137\x70\162\x65\143\x69\x73\151\x6f\x6e\x60\54" . "\40\140\143\x6f\x6c\165\x6d\156\x5f\144\x65\146\x61\165\154\164\140\54\40\x60\143\157\154\165\x6d\x6e\137\x6b\x65\171\140\54\x20\x60\x63\157\x6c\165\x6d\x6e\137\x63\x6f\155\155\x65\x6e\164\x60\x2c\x20\x60\145\x78\x74\162\141\140\54\40\x60\x69\x73\137\x6e\x75\154\154\141\142\x6c\145\140\xd\xa\11\x9\x9\x46\x52\117\115\x20\x60\x69\x6e\146\157\162\155\x61\164\151\x6f\x6e\x5f\x73\143\x68\145\155\x61\x60\x2e\x60\x63\157\x6c\165\x6d\x6e\x73\140\40\x57\110\105\x52\105\40\164\x61\x62\x6c\145\137\163\x63\150\145\x6d\x61\x20\75\40\x22" . $this->db->database . "\42\40\x41\116\x44\x20\x74\141\142\x6c\x65\x5f\156\x61\x6d\145\x20\75\x20\x22" . $table . "\42"; goto BzrqQ; lpZ0E: pUfaw: goto omYqm; CFqXP: $i++; goto VumlO; ptRE_: $retval = array(); goto MDS7O; FxEC5: $retval[$i]->default = $query[$i]->column_default; goto gaWUu; fPVcI: if (!($i < $c)) { goto pUfaw; } goto VjViK; gzsqN: $retval[$i]->primary = $query[$i]->column_key; goto rMktW; rMktW: z1PoV: goto CFqXP; z9hxV: $retval[$i]->nullable = $query[$i]->is_nullable; goto gzsqN; omYqm: $fields[$table] = (object) ["\164\x61\142\154\x65\x5f\x6e\141\155\x65" => $table, "\143\157\x6c\x75\x6d\156\163" => $retval]; goto GFz0v; zW3CB: D9J_C: goto DG9Au; vntxD: s6Fyo: goto fPVcI; GFz0v: BGjG1: goto q1wkF; InVdV: $retval[$i]->type = $query[$i]->data_type; goto NEbvv; NEbvv: $retval[$i]->collation = $query[$i]->collation_name; goto d5yCp; o528n: $fields = FALSE; goto zW3CB; VjViK: $retval[$i] = new stdClass(); goto fAhyF; BzrqQ: if (!(($query = $this->db->query($sql)) === FALSE)) { goto D9J_C; } goto o528n; DG9Au: $query = $query->result_object(); goto ptRE_; u6_0S: $retval[$i]->extra = $query[$i]->extra; goto z9hxV; d5yCp: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto FxEC5; fAhyF: $retval[$i]->name = $query[$i]->column_name; goto IEuZ9; IEuZ9: $retval[$i]->col_type = $query[$i]->column_type; goto InVdV; ePuqR: $c = count($query); goto vntxD; q1wkF: } goto B7kIL; fPr1K: $script_create_table = []; goto Vg3xm; NuBS5: ZSJ6K: goto lnEo0; LI5DM: $fields = []; goto mVreg; Ta8Ow: } public function createTable() { goto RXGs8; WPRIZ: $this->output_json($data); goto fj6_S; qXZc3: aqTnc: goto k3AVF; yCtvm: $scripts = json_decode($this->encryption->decrypt($scripts)); goto FYLf7; auNkC: sleep(1); goto yCtvm; RXGs8: $scripts = $this->input->post("\x64\x61\164\x61", true); goto Cpygs; uYOS_: $data["\155\x65\163\163\141\x67\145"] = "\125\160\144\141\164\x65\40\x6b\x6f\154\157\155"; goto WPRIZ; Cpygs: str_replace("\x25\62\102", "\53", $scripts); goto auNkC; RkJCE: foreach ($scripts as $script) { $queries .= $script; fAQkY: } goto qXZc3; FYLf7: $queries = ''; goto RkJCE; k3AVF: $data["\163\165\143\143\145\x73\x73"] = $this->runQuery($queries); goto uYOS_; fj6_S: } public function createColumn() { goto gqhvP; Ud3y8: if (!(strpos("\x60\165\x69\144\x60", $queries) !== false)) { goto aAlzM; } goto eP9_W; hzasl: foreach ($scripts as $script) { $queries .= $script; dxOIe: } goto Sd2mR; fQrIg: $this->output_json($data); goto vjbDF; gQh7q: aAlzM: goto Im4mW; Im4mW: $data["\x73\165\143\x63\x65\163\x73"] = $this->runQuery($queries); goto F1mVV; RN1Zs: sleep(1); goto avMaV; EdzJe: str_replace("\x25\62\102", "\53", $scripts); goto RN1Zs; gqhvP: $scripts = $this->input->post("\144\x61\164\141", true); goto EdzJe; Aw5qp: $queries = ''; goto hzasl; Sd2mR: RSTUf: goto Ud3y8; F1mVV: $data["\155\145\x73\163\141\147\x65"] = "\x4d\x6f\x64\x69\x66\171\40\153\157\154\157\x6d"; goto fQrIg; avMaV: $scripts = json_decode($this->encryption->decrypt($scripts)); goto Aw5qp; eP9_W: $this->updateUID(); goto gQh7q; vjbDF: } public function editColumn() { goto vt36V; uMEO1: r04LH: goto t1p1F; IhmCi: $this->output_json($data); goto r5GQv; YciDf: foreach ($scripts as $script) { $queries .= $script; uDsu2: } goto uMEO1; HH_vr: str_replace("\45\x32\102", "\x2b", $scripts); goto Mf9BU; wBsMN: $queries = ''; goto YciDf; Mf9BU: sleep(1); goto LxZgg; XV_wV: $data["\155\145\x73\163\141\147\145"] = "\125\160\x64\141\164\145\x20\163\145\x6c\145\163\x61\x69"; goto IhmCi; LxZgg: $scripts = json_decode($this->encryption->decrypt($scripts)); goto wBsMN; vt36V: $scripts = $this->input->post("\144\x61\x74\x61", true); goto HH_vr; t1p1F: $data["\163\165\143\x63\x65\x73\x73"] = $this->runQuery($queries); goto XV_wV; r5GQv: } function runQuery($script) { goto A8NH5; WYM0N: $hostpass = $this->db->password; goto JRfIH; ySbBW: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto MWl8q; gbAIH: $hostuser = $this->db->username; goto WYM0N; DbcQp: return true; goto nekIn; ttMSe: HX4g1: goto za32O; za32O: $mysqli->multi_query($script); goto NDrSW; MWl8q: if (!mysqli_connect_errno()) { goto HX4g1; } goto vtAPP; JRfIH: $database = $this->db->database; goto ySbBW; vtAPP: return mysqli_connect_errno(); goto ttMSe; NDrSW: $mysqli->close(); goto DbcQp; A8NH5: $hostname = $this->db->hostname; goto gbAIH; nekIn: } function updateUID() { goto oeTVi; JfEXX: $siswas = $this->db->get("\155\x61\x73\x74\x65\x72\137\x73\x69\163\167\x61")->result(); goto md1Eq; Hoba4: JIujs: goto H99lr; md1Eq: $input = array(); goto fyjc4; H99lr: return $this->db->update_batch("\x6d\141\163\x74\x65\162\137\163\x69\163\167\x61", $input, "\151\x64\137\163\151\x73\x77\141"); goto di5co; fyjc4: foreach ($siswas as $siswa) { $input[] = array("\151\144\x5f\163\x69\163\167\x61" => $siswa->id_siswa, "\x75\151\x64" => $this->uuid->v4()); iUF5x: } goto Hoba4; oeTVi: $this->load->library("\x55\x75\x69\144", "\x75\x75\x69\144"); goto JfEXX; di5co: } function make_base() { } }
