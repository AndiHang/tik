<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\x53\x45\x50\101\x54\110") or exit("\116\157\40\x64\x69\x72\x65\x63\x74\x20\x73\x63\162\x69\x70\x74\x20\x61\x63\x63\145\163\x73\40\x61\154\x6c\157\167\145\x64"); class Update extends CI_Controller { function __construct() { goto DkDvX; PIx8r: $this->load->library("\x65\x6e\x63\162\x79\x70\164\151\x6f\156"); goto npQbB; DkDvX: parent::__construct(); goto h_6_0; ZnbY9: $this->load->database(); goto PIx8r; Jjjjd: $this->load->dbforge(); goto ZnbY9; h_6_0: include APPPATH . "\x63\157\x6e\x66\151\147\57\x64\x61\x74\x61\142\141\x73\145\56\x70\150\x70"; goto Jjjjd; npQbB: } public function output_json($data, $encode = true) { goto LUSY2; KVCQI: $this->output->set_content_type("\141\x70\x70\x6c\151\143\x61\x74\x69\x6f\156\57\152\x73\x6f\x6e")->set_output($data); goto AxQgt; bAeez: zwg_s: goto KVCQI; LUSY2: if (!$encode) { goto zwg_s; } goto fme7X; fme7X: $data = json_encode($data); goto bAeez; AxQgt: } public function index() { goto zQ2XS; lr1ma: $json = json_decode($json); goto vVu3a; RF44T: $data["\x6a\x73\x6f\x6e"] = $json; goto C1wyS; C1wyS: $this->load->view("\151\x6e\x73\164\141\154\x6c\57\150\145\x61\x64\145\162", $data); goto jKdfY; zQ2XS: $json = file_get_contents("\56\57\x61\x73\163\145\x74\163\x2f\x61\x70\x70\x2f\144\142\57\144\x61\x74\141\142\141\163\145\x2e\x6a\x73\157\156"); goto lr1ma; jKdfY: $this->load->view("\151\156\x73\x74\141\x6c\x6c\57\165\x70\144\x61\164\x65"); goto ZUvFw; vVu3a: $json = (array) $json; goto RF44T; ZUvFw: $this->load->view("\151\x6e\x73\x74\x61\154\154\57\x66\157\x6f\164\x65\x72"); goto j8ir9; j8ir9: } function object_to_array($data) { goto xChWG; F_h1y: $result = []; goto otFLh; tNIev: cTHu5: goto gp3Bv; gp3Bv: return $data; goto JUrOA; D3pAx: return $result; goto tNIev; LBw2Y: HYotY: goto D3pAx; xChWG: if (!(is_array($data) || is_object($data))) { goto cTHu5; } goto F_h1y; otFLh: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; hPNW9: } goto LBw2Y; JUrOA: } public function checkDatabase() { goto GcAjh; osCIM: $this->db->db_debug = FALSE; goto zXIw1; PV_0N: $json = json_decode($json); goto n5PNf; LHW4v: $create_tables = []; goto kewt8; J7AMZ: $fields = []; goto RLQcl; wD0Mg: $json = file_get_contents("\56\57\x61\163\163\145\x74\x73\x2f\x61\160\160\x2f\144\x62\x2f\x64\x61\x74\x61\142\141\163\x65\x2e\x6a\163\157\156"); goto PV_0N; YDM4Y: mLgxd: goto wD0Mg; kewt8: $add_columns = []; goto kZ6Lz; KG8Pd: foreach ($full_tables as $table) { goto Dxjna; rkYwd: bBKmW: goto o27q2; XivMA: foreach ($json[$table] as $jtbl) { goto DXqnQ; yPPFf: y8m8h: goto ZmsIz; mnsRu: Endco: goto dvjkt; q2Vbs: goto MSIs6; goto yPPFf; PTfAc: $add_columns[$table][] = $jtbl; goto q2Vbs; DXqnQ: if ($this->db->field_exists($jtbl->name, $table)) { goto y8m8h; } goto PTfAc; ZmsIz: foreach ($fields[$table] as $ftbl) { goto Srh2D; Srh2D: if (!($jtbl->name == $ftbl->name)) { goto RQvsh; } goto r6b0E; pg28C: PxW7I: goto Ja_uh; r6b0E: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto PxW7I; } goto q3MJc; a1dJU: x5w4Y: goto FnIVg; q3MJc: $edit_columns[$table][] = $jtbl; goto pg28C; Ja_uh: RQvsh: goto a1dJU; FnIVg: } goto p3rLI; p3rLI: R8q5f: goto p3GtW; p3GtW: MSIs6: goto mnsRu; dvjkt: } goto ZjDhp; fleCs: $create_tables[$table] = $json[$table]; goto yScWl; ZjDhp: NWgdW: goto iprjF; VMTYu: xADan: goto rkYwd; GAsNf: P5V1p: goto P0mvO; Dxjna: if ($this->db->table_exists($table)) { goto P5V1p; } goto fleCs; yScWl: goto xADan; goto GAsNf; iprjF: DZM3B: goto VMTYu; P0mvO: if (!isset($json[$table])) { goto DZM3B; } goto XivMA; o27q2: } goto XRy9N; uORSa: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto Yna66; RLQcl: $currentDb = []; goto qezzS; cjYQM: sort($full_tables); goto LHW4v; qezzS: foreach ($tabless as $table) { goto Jasfb; hXExU: VSqVE: goto Z0VZe; wMBNJ: $fields[$table] = $datafld; goto Yv92k; PCIPs: $retval[$i]->extra = $query[$i]->extra; goto JrlBb; QJ_M6: if (!($query[$i]->extra != '')) { goto qft5X; } goto DsMce; VFFaR: $retval = array(); goto ZpS7B; B5G6D: BUEuq: goto yj5Hi; sM7ne: $c = count($query); goto PQgT7; Na9CH: if (!(($query = $this->db->query($sql)) === FALSE)) { goto VSqVE; } goto R2qhz; Jasfb: $datafld = $this->db->field_data($table); goto OBO4b; ybC6S: Grffx: goto QY1o8; ADaEK: goto ej0EX; goto ybC6S; QY1o8: $currentDb[$table] = $retval; goto wMBNJ; JrlBb: rvf30: goto iV1Bf; iV1Bf: $i++; goto ADaEK; ZpS7B: $i = 0; goto sM7ne; TnKMV: X3qfV: goto IYMm8; IYMm8: $datafld[$i]->auto_increment = true; goto u4BBe; u4BBe: Bl_1N: goto WyX5s; v0FZy: $retval[$i]->name = $query[$i]->column_name; goto PCIPs; OBO4b: $sql = "\123\x45\x4c\105\x43\124\40\x60\143\157\x6c\165\x6d\156\137\156\x61\155\x65\140\x2c\x20\140\x6e\x75\x6d\x65\x72\151\x63\x5f\x70\162\145\143\151\x73\151\157\x6e\140\x2c\40\140\145\x78\164\162\x61\140\x2c\x20\140\x69\x73\x5f\156\165\154\154\x61\142\x6c\145\140" . "\x20\x46\x52\x4f\x4d\40\x60\x69\156\x66\x6f\162\x6d\x61\x74\x69\x6f\156\x5f\163\143\150\x65\155\141\140\x2e\x60\x63\157\x6c\165\x6d\156\163\x60\40\127\110\105\122\x45\x20\164\x61\x62\x6c\145\x5f\x73\143\150\x65\x6d\x61\x20\x3d\x20\x22" . $this->db->database . "\x22\40\101\x4e\104\x20\164\141\142\x6c\x65\137\156\x61\x6d\x65\x20\75\40\42" . $table . "\42"; goto Na9CH; Zu6h0: goto Bl_1N; goto TnKMV; Z0VZe: $query = $query->result_object(); goto VFFaR; ejcc8: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto BUEuq; } goto QJ_M6; WyX5s: qft5X: goto B5G6D; z3YTr: $datafld[$i]->extra = $query[$i]->extra; goto Zu6h0; R2qhz: $currentDb = FALSE; goto hXExU; DsMce: if ($query[$i]->extra == "\x61\165\164\x6f\x5f\151\x6e\x63\x72\x65\x6d\x65\156\x74") { goto X3qfV; } goto z3YTr; Yv92k: JoOLQ: goto dim9b; yj5Hi: $retval[$i] = new stdClass(); goto v0FZy; PQgT7: ej0EX: goto FyDsq; FyDsq: if (!($i < $c)) { goto Grffx; } goto ejcc8; dim9b: } goto YDM4Y; f5MYl: $full_tables = array_unique($full_tables); goto cjYQM; XRy9N: HwcO4: goto uORSa; Yna66: $data = ["\144\142" => $fields, "\143\x72\145\141\x74\145" => $create_tables, "\155\x6f\144\151\x66\x79" => $edit_columns, "\141\x64\144" => $add_columns, "\143\x6f\x75\156\x74\163" => $counts, "\x6a\163\157\156" => $json, "\143\x75\x72\x72\x65\156\x74" => $currentDb]; goto dpYgT; kZ6Lz: $edit_columns = []; goto KG8Pd; DFBGG: $full_tables = array_merge($tbl_baru, $tbl_ada); goto f5MYl; n5PNf: $json = (array) $json; goto s4EdB; zXIw1: $tabless = $this->db->list_tables(); goto J7AMZ; RfYpg: $tbl_ada = array_keys($fields); goto DFBGG; GcAjh: $db_debug = $this->db->db_debug; goto osCIM; s4EdB: $tbl_baru = array_keys($json); goto RfYpg; dpYgT: $this->output_json($data); goto FSQaX; FSQaX: } public function updateDatabase() { goto e9jQt; PtxlJ: sort($full_tables); goto YnUCL; t53Xo: $json = file_get_contents("\x2e\x2f\141\163\163\145\x74\x73\x2f\x61\x70\x70\x2f\x64\x62\57\x64\141\164\141\142\141\x73\145\56\x6a\x73\157\x6e"); goto ntrpM; AUSk1: cSoAl: goto t53Xo; Oyxe2: $json = (array) $json; goto wp0Yt; e9jQt: $tabless = $this->db->list_tables(); goto WmOim; wp0Yt: $tbl_baru = array_keys($json); goto qGosd; rXDgv: echo true; goto tzhIV; wSgTS: $full_tables = array_merge($tbl_baru, $tbl_ada); goto BF0yV; BF0yV: $full_tables = array_unique($full_tables); goto PtxlJ; HXBUo: XF12Y: goto rXDgv; CVgAl: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); tL36y: } goto AUSk1; ntrpM: $json = json_decode($json); goto Oyxe2; qGosd: $tbl_ada = array_keys($fields); goto wSgTS; YnUCL: foreach ($full_tables as $table) { goto BmY_T; inT9I: J5Xs4: goto TxLJi; BmY_T: if ($this->db->table_exists($table)) { goto Jj86m; } goto MLYOK; MLYOK: if (!isset($json[$table])) { goto J5Xs4; } goto HZLY3; HZLY3: foreach ($json[$table] as $tbl => $jtbl) { goto A04gd; Brj6u: $this->dbforge->add_field($field); goto gScNR; A04gd: $field = [$jtbl->name => ["\164\171\x70\145" => $jtbl->type, "\x63\x6f\x6e\163\x74\x72\141\x69\x6e\164" => $jtbl->max_length, "\x6e\165\154\x6c" => $jtbl->primary_key == 0]]; goto Brj6u; MoG4l: $this->dbforge->add_key($jtbl->name, true); goto n1neT; gScNR: if (!($jtbl->primary_key == 1)) { goto R1WmT; } goto MoG4l; n1neT: R1WmT: goto Xq2ns; Xq2ns: eKhNg: goto mR8lP; mR8lP: } goto iLPhc; ku6dK: foreach ($json[$table] as $jtbl) { goto WGHX7; ux9IP: $this->dbforge->add_key($jtbl->name, true); goto jJCdM; hQBkm: $this->dbforge->add_column($table, $field); goto hTxJv; wHzr_: $field = array($jtbl->name => array("\164\x79\x70\x65" => $jtbl->type, "\x63\157\156\163\164\x72\141\x69\156\x74" => $jtbl->max_length, "\144\x65\x66\141\x75\154\x74" => $jtbl->default)); goto hQBkm; q_a2H: goto x3K5X; goto B61SG; YgVKd: foreach ($fields[$table] as $ftbl) { goto fU31r; QylUJ: m3NDp: goto IlCwW; G9wBr: if ($jtbl->default == "\x43\125\x52\122\x45\116\x54\x5f\x54\111\115\x45\123\x54\x41\115\x50") { goto kg_bQ; } goto foeC3; T4_sY: goto m3NDp; goto inGbH; eG5IY: $this->dbforge->modify_column($table, $field); goto QylUJ; foeC3: $field = array($jtbl->name => array("\164\171\x70\145" => $jtbl->type, "\x63\157\156\x73\164\x72\141\151\x6e\164" => $jtbl->max_length, "\x64\x65\x66\141\x75\x6c\164" => $jtbl->default)); goto VQocL; IlCwW: KJgoK: goto lbY2g; glIwA: F37l_: goto eG5IY; ySsWw: goto bZj9D; goto gHAUa; XebBc: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto Ix2_T; fU31r: if (!($jtbl->name == $ftbl->name)) { goto SeAAO; } goto n98s7; MkOzA: $field = array($jtbl->name => array("\x74\x79\160\x65" => $jtbl->type, "\x63\x6f\x6e\163\164\162\x61\x69\x6e\164" => $jtbl->max_length, "\156\165\x6c\x6c" => false, "\141\165\164\x6f\x5f\x69\x6e\x63\162\x65\155\x65\156\164" => true)); goto Ie1Bt; xMQ_2: if ($jtbl->auto_increment == true) { goto siaiB; } goto DbJ7x; Ix2_T: $field = array($jtbl->name . "\40\144\141\164\145\x74\x69\x6d\145\x20\144\145\146\141\x75\154\x74\x20\143\x75\x72\162\145\x6e\164\x5f\164\151\x6d\145\x73\x74\141\x6d\x70" . $onUpdate); goto glIwA; SP6ED: if ($jtbl->primary_key == 0) { goto JvyxQ; } goto xMQ_2; VQocL: goto F37l_; goto Bu7cz; lbY2g: SeAAO: goto gf4Nl; Bu7cz: kg_bQ: goto XebBc; TspA8: $this->dbforge->add_key($jtbl->name, true); goto OciFX; inGbH: JvyxQ: goto G9wBr; gf4Nl: g0Pvl: goto sTjlB; OciFX: $this->dbforge->modify_column($table, $field); goto T4_sY; Ie1Bt: bZj9D: goto TspA8; n98s7: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto KJgoK; } goto SP6ED; gHAUa: siaiB: goto MkOzA; DbJ7x: $field = array($jtbl->name => array("\x74\x79\x70\145" => $jtbl->type, "\x63\x6f\x6e\163\x74\162\x61\151\x6e\164" => $jtbl->max_length, "\156\165\x6c\154" => false)); goto ySsWw; sTjlB: } goto Lupgl; jJCdM: $this->dbforge->add_column($table, $field); goto glAE8; hTxJv: HqUll: goto q_a2H; IHUZW: $field = array($jtbl->name => array("\x74\171\160\x65" => $jtbl->type, "\x63\x6f\x6e\x73\x74\x72\x61\151\x6e\x74" => $jtbl->max_length, "\156\x75\154\154" => false)); goto ux9IP; MZCTn: if ($jtbl->primary_key == 0) { goto PoWyy; } goto IHUZW; lumUe: PoWyy: goto wHzr_; WGHX7: if ($this->db->field_exists($jtbl->name, $table)) { goto iO0JF; } goto MZCTn; Lupgl: sNM_n: goto KwKJm; KwKJm: x3K5X: goto vLvSH; B61SG: iO0JF: goto YgVKd; vLvSH: wR597: goto b1rrX; glAE8: goto HqUll; goto lumUe; b1rrX: } goto D3_WX; cMUdW: tUgNa: goto LVF2u; D3_WX: P_mW7: goto cMUdW; iLPhc: rJca2: goto fhA0G; c2EdJ: if (!isset($json[$table])) { goto tUgNa; } goto ku6dK; fhA0G: $this->dbforge->create_table($table, TRUE); goto UEt7p; CXQxW: Jj86m: goto c2EdJ; pg6a2: wSyy8: goto NEab4; TxLJi: goto bT7XX; goto CXQxW; UEt7p: $this->db->query("\101\x4c\x54\105\122\40\124\x41\102\114\x45\x20\x20\140" . $table . "\x60\40\x45\x4e\x47\111\x4e\105\x20\x3d\x20\x49\x6e\x6e\157\104\x42"); goto inT9I; LVF2u: bT7XX: goto pg6a2; NEab4: } goto HXBUo; WmOim: $fields = []; goto CVgAl; tzhIV: } public function checkDb() { goto ChQaE; PJmaf: foreach ($full_tables as $table) { goto YGh3j; TW7dv: $script_edit_column[$table] = "\x41\x4c\x54\x45\122\x20\x54\101\102\x4c\x45\x20\x60" . $table . "\140\40" . implode("\54\40", $modif_column) . "\x3b"; goto kCy3H; Fa_Ol: $modif_column = []; goto LKwn2; LKwn2: foreach ($json[$table]->columns as $jtbl) { goto w7ALP; UWNVv: Z0Cjc: goto taIYO; KL7r8: $default = $jtbl->default == null ? '' : "\x20\104\x45\106\x41\125\114\x54\40" . $jtbl->default; goto fS5BI; eunvg: array_push($add_column, "\101\104\x44\40\140" . $jtbl->name . "\140\40" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto T8z01; Bfo6Q: $comment = $jtbl->comment == '' ? '' : "\40\x43\x4f\x4d\115\105\116\124\40\x27" . $jtbl->comment . "\47"; goto eunvg; N9boL: if (!(strtoupper($extra) == "\x20\x41\x55\124\117\137\x49\116\x43\x52\105\115\x45\x4e\x54")) { goto WkFLg; } goto PCTP8; w1Vbq: goto u1EEu; goto ANhc1; G39K5: $length = "\50" . $jtbl->max_length . "\51"; goto w1Vbq; gmA_V: xMg8H: goto xbqdj; si4MY: jLMq1: goto MHfaq; gJg0t: gsGJE: goto si4MY; SHdru: if ($jtbl->max_length == null) { goto Z0Cjc; } goto JHBFF; h_5Qg: xWbWC: goto t5rvU; t5rvU: $nullable = $jtbl->nullable == "\116\117" ? "\x20\116\117\124\40\116\x55\114\x4c" : ''; goto KL7r8; KWzKx: foreach ($fields[$table]->columns as $ftbl) { goto vmdV3; fg29j: if (!($jtbl->default != $ftbl->default)) { goto GZzqW; } goto wuv7l; a10uE: $ftbl->default = strtoupper($ftbl->default); goto xqS2E; Gi2vA: c7Ldn: goto xg1lP; ti3jX: $ftbl->extra = str_replace("\x28\x29", '', $ftbl->extra); goto g7urR; nwiXP: if (strtolower($jtbl->primary) == "\160\x72\151") { goto BJvSS; } goto vtMUc; wvuH0: if (!($ftbl->default != null)) { goto JRRfg; } goto RSlRy; xg1lP: array_push($modif_column, "\x41\104\104\x20\x55\116\111\121\125\x45\x20\x4b\x45\131\40\140" . $jtbl->name . "\140\40\x28\x60" . $jtbl->name . "\140\x29"); goto zQ0Aa; HrDIW: BJvSS: goto JVMsy; xWDEt: Ozd7R: goto T7fUn; wfYQD: $jtbl->default = str_replace("\x28\51", '', $jtbl->default); goto cw76A; y4jYH: $edit_columns[$table][$jtbl->name]["\x70\162\151\155\x61\162\x79"] = $jtbl->primary; goto nwiXP; T7fUn: W0GLF: goto wS162; U4Jwg: jO76u: goto lWOk2; qbPMf: $jtbl->extra = strtoupper($jtbl->extra); goto U4Jwg; zQ0Aa: dLOV0: goto GtiT_; TeWRR: uNkYg: goto RSrwW; uiKrQ: pICXk: goto wvuH0; RbILq: if (!($jtbl->col_type != $ftbl->col_type)) { goto KzP5e; } goto WgDMd; kILtw: if (!($jtbl->primary != $ftbl->primary)) { goto fz7E4; } goto y4jYH; E4KYd: KzP5e: goto HvjiN; mH3Jn: $edit_columns[$table][$jtbl->name]["\143\157\x6d\155\x65\x6e\x74"] = $jtbl->comment; goto CBBwE; g7urR: $ftbl->extra = strtoupper($ftbl->extra); goto Tzvvp; e8bzg: GZzqW: goto GVTwb; vtMUc: if (strtolower($jtbl->primary) == "\x75\x6e\x69") { goto c7Ldn; } goto XpMpc; wT17X: BKyDw: goto CToIZ; DFI8k: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto wmXNo; } goto Aln3B; GVTwb: if (!($jtbl->extra != null)) { goto jO76u; } goto dV1Jw; yE3Y0: $edit_columns[$table][$jtbl->name]["\x6e\x75\x6c\x6c\141\142\x6c\x65"] = $jtbl->nullable; goto wT17X; HvjiN: if (!($jtbl->nullable != $ftbl->nullable)) { goto BKyDw; } goto yE3Y0; lWOk2: if (!($ftbl->extra != null)) { goto mObdi; } goto ti3jX; SDEYM: wmXNo: goto xWDEt; vmdV3: if (!($jtbl->name == $ftbl->name)) { goto Ozd7R; } goto RbILq; CToIZ: if (!($jtbl->default != null)) { goto pICXk; } goto wfYQD; QqgSh: array_push($modif_column, "\115\x4f\104\x49\106\131\40\140" . $jtbl->name . "\140\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto SDEYM; cw76A: $jtbl->default = strtoupper($jtbl->default); goto uiKrQ; WgDMd: $edit_columns[$table][$jtbl->name]["\x63\157\x6c\x5f\x74\171\x70\x65"] = $jtbl->col_type; goto E4KYd; tlI8R: if (!($jtbl->extra != $ftbl->extra)) { goto uNkYg; } goto WY6IV; RSlRy: $ftbl->default = str_replace("\x28\x29", '', $ftbl->default); goto a10uE; JVMsy: array_push($modif_column, "\x41\104\104\40\120\x52\x49\x4d\101\122\x59\40\113\105\131\x20\50\140" . $jtbl->name . "\x60\51"); goto Fiidk; RnV4N: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto NogND; GtiT_: fz7E4: goto DFI8k; WY6IV: $edit_columns[$table][$jtbl->name]["\x65\170\164\162\x61"] = $jtbl->extra; goto TeWRR; dV1Jw: $jtbl->extra = str_replace("\x28\51", '', $jtbl->extra); goto qbPMf; RSrwW: if (!($jtbl->comment != $ftbl->comment)) { goto adJsc; } goto mH3Jn; Tzvvp: mObdi: goto tlI8R; Aln3B: $nullable = $jtbl->nullable == "\116\117" ? "\x20\x4e\117\x54\x20\116\125\x4c\114" : ''; goto L8fWx; CBBwE: adJsc: goto kILtw; wuv7l: $edit_columns[$table][$jtbl->name]["\144\145\x66\x61\x75\x6c\x74"] = $jtbl->default; goto e8bzg; NogND: $comment = $jtbl->comment == '' ? '' : "\40\x43\x4f\x4d\x4d\x45\x4e\x54\x20\47" . $jtbl->comment . "\47"; goto QqgSh; xqS2E: JRRfg: goto fg29j; XpMpc: goto dLOV0; goto HrDIW; L8fWx: $default = $jtbl->default == null ? '' : "\x20\x44\105\106\101\125\x4c\x54\x20" . $jtbl->default; goto RnV4N; Fiidk: goto dLOV0; goto Gi2vA; wS162: } goto gJg0t; T8z01: PTcho: goto KWzKx; TpnFh: $length = "\x28" . ($jtbl->max_length + 1) . "\51"; goto GhtBt; Ch0NG: $length = ''; goto JLdsy; fS5BI: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto N9boL; JLdsy: goto xWbWC; goto UWNVv; ANhc1: y13os: goto TpnFh; Jh2cQ: WkFLg: goto Bfo6Q; PCTP8: $extra .= "\x20\120\x52\111\x4d\x41\x52\131\x20\113\x45\131"; goto Jh2cQ; w7ALP: if ($this->db->field_exists($jtbl->name, $table)) { goto PTcho; } goto MbARJ; GhtBt: u1EEu: goto h_5Qg; xbqdj: if ($jtbl->type == "\x69\x6e\x74") { goto y13os; } goto G39K5; taIYO: $length = ''; goto N3MN3; JHBFF: if ($jtbl->type != "\x6c\x6f\x6e\147\x74\145\x78\164" && $jtbl->type != "\155\x65\144\151\x75\155\x74\x65\x78\164" && $jtbl->type != "\x74\x65\x78\x74") { goto xMg8H; } goto Ch0NG; N3MN3: goto xWbWC; goto gmA_V; MbARJ: $add_columns[$table][] = $jtbl; goto SHdru; MHfaq: } goto X_QqC; kCy3H: ldzX1: goto KgRZy; nNJzi: $script .= $pri . "\x29\x20\105\116\107\111\116\x45\x3d\x49\x6e\156\x6f\104\102\x20\104\105\x46\101\x55\x4c\124\x20\x43\110\101\x52\123\105\x54\75\x75\x74\x66\x38\155\x62\64\x3b"; goto U5SfS; dXr8A: goto S8aRu; goto O8LQI; AuSbJ: if (!(count($add_column) > 0)) { goto oMS7i; } goto pVmU6; L216m: if (!isset($json[$table])) { goto S7iB2; } goto ACuef; O8LQI: DJT7l: goto YuI9x; iyjCk: S8aRu: goto RmeBw; Az1Pv: oMS7i: goto uFdVI; ZunSa: $pri = ''; goto zHxMo; iJ75p: M3j0C: goto nNJzi; cAQ5C: $script = "\x43\x52\105\101\x54\x45\x20\124\101\x42\114\x45\40\140" . $table . "\x60\x20\50"; goto ZunSa; RmeBw: zlYvZ: goto A4vIF; YuI9x: $create_tables[] = $json[$table]; goto cAQ5C; U5SfS: $script_create_table[$table] = $script; goto iyjCk; X_QqC: vxUMy: goto AuSbJ; ACuef: $add_column = []; goto Fa_Ol; zHxMo: foreach ($json[$table]->columns as $column) { goto LR1Mt; ruWIB: C1uYP: goto KI4jr; LR1Mt: if ($column->max_length == null) { goto VwBwT; } goto IBfj1; Hjf8X: T8NID: goto aqlzH; U96Fa: $length = ''; goto lGgOI; pvq2l: $pri .= $column->primary != '' ? "\120\x52\111\x4d\x41\122\131\40\113\x45\131\40\50\140" . $column->name . "\140\51" : ''; goto mIcRj; ruxVe: VwBwT: goto U96Fa; mIcRj: hOb5Y: goto QJRer; P46ad: $nullable = $column->nullable == "\x4e\117" ? "\x20\116\117\124\40\116\125\114\x4c" : ''; goto hWjm7; KI4jr: xHDGO: goto P46ad; eQHiO: $length = ''; goto sfqsQ; Mm8X2: $script .= "\x60" . $column->name . "\140\40" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\x20"; goto pvq2l; IBfj1: if ($column->type != "\x6c\x6f\x6e\x67\x74\x65\x78\x74" && $column->type != "\x6d\145\x64\151\165\155\164\x65\170\164" && $column->type != "\x74\145\170\164") { goto T8NID; } goto eQHiO; aqlzH: if ($column->type == "\151\156\164") { goto nuqmz; } goto NtLB_; dJutA: $length = "\x28" . ($column->max_length + 1) . "\51"; goto ruWIB; MHR18: $comment = $column->comment == '' ? '' : "\x20\x43\x4f\x4d\115\x45\116\x54\40\x27" . $column->comment . "\x27"; goto Mm8X2; NtLB_: $length = "\x28" . $column->max_length . "\x29"; goto Pwk2A; daJAy: nuqmz: goto dJutA; Pwk2A: goto C1uYP; goto daJAy; GA2Gc: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto MHR18; sfqsQ: goto xHDGO; goto ruxVe; lGgOI: goto xHDGO; goto Hjf8X; hWjm7: $default = $column->default == null ? '' : "\40\x44\x45\106\x41\125\x4c\x54\x20" . $column->default; goto GA2Gc; QJRer: } goto iJ75p; YGh3j: if (!$this->db->table_exists($table)) { goto DJT7l; } goto L216m; uFdVI: if (!(count($modif_column) > 0)) { goto ldzX1; } goto TW7dv; KgRZy: S7iB2: goto dXr8A; pVmU6: $script_create_column[$table] = "\x41\114\x54\x45\x52\x20\x54\x41\x42\x4c\105\40\x60" . $table . "\140\x20" . implode("\x2c\40", $add_column) . "\73"; goto Az1Pv; A4vIF: } goto Ty_nu; wD4Vv: $edit_columns = []; goto jKdNa; jKdNa: $script_edit_column = []; goto PJmaf; nyY5B: $json = json_decode($json); goto IA28Q; BmGMh: $add_columns = []; goto KFRUw; jBP7d: $this->output_json($data); goto qN3mL; GHc25: $this->db->db_debug = $db_debug; goto O2mmH; Ql9I8: sort($full_tables); goto mSged; dCbbK: $tabless = $this->db->list_tables(); goto ByjGf; meFnp: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto nRPFx; TJd9h: foreach ($tabless as $table) { goto nJ0ne; OGUxn: $retval[$i]->primary = $query[$i]->column_key; goto ffztN; TZG3q: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto yp4Q6; nJ0ne: $sql = "\x53\105\x4c\105\103\x54\40\140\143\x6f\154\x75\x6d\156\137\x6e\141\x6d\145\140\54\x20\x60\x63\157\x6c\165\x6d\156\137\164\171\x70\x65\x60\x2c\x20\x60\x63\157\154\154\141\x74\x69\157\156\x5f\x6e\x61\x6d\145\140\x2c\40\x60\144\x61\x74\x61\x5f\x74\171\x70\145\140\x2c\x20\140\143\150\141\162\141\143\x74\145\x72\137\x6d\141\170\151\x6d\x75\x6d\137\x6c\145\x6e\x67\164\150\140\x2c\x20\x60\156\x75\155\x65\x72\x69\x63\x5f\x70\162\x65\143\x69\x73\151\157\156\x60\54" . "\x20\x60\x63\x6f\154\x75\155\x6e\137\144\x65\x66\141\165\x6c\x74\140\54\x20\140\143\157\154\x75\x6d\156\137\x6b\x65\x79\x60\54\x20\x60\x63\x6f\x6c\x75\155\156\137\x63\x6f\x6d\155\x65\x6e\x74\x60\54\40\x60\x65\170\x74\x72\141\x60\54\40\x60\151\x73\137\156\165\154\154\x61\x62\154\x65\x60\15\12\11\11\x9\106\x52\x4f\x4d\x20\x60\x69\x6e\x66\x6f\x72\x6d\x61\164\x69\157\x6e\x5f\163\143\x68\145\x6d\x61\140\56\x60\x63\x6f\154\x75\x6d\156\163\140\x20\x57\110\x45\122\x45\40\164\141\142\x6c\145\137\x73\143\x68\x65\155\x61\x20\x3d\x20\42" . $this->db->database . "\x22\40\x41\116\x44\40\164\141\142\154\145\x5f\x6e\x61\155\x65\40\75\40\x22" . $table . "\x22"; goto miVe_; wOPyB: inzrY: goto vMS10; a4bwG: $fields = FALSE; goto ejROX; miVe_: if (!(($query = $this->db->query($sql)) === FALSE)) { goto VVE32; } goto a4bwG; yfV7h: $retval[$i]->name = $query[$i]->column_name; goto KprYD; cEMze: $i = 0; goto y03gb; EnTI9: $retval = array(); goto cEMze; yp4Q6: $retval[$i]->default = $query[$i]->column_default; goto hXQQp; KprYD: $retval[$i]->col_type = $query[$i]->column_type; goto F0Oxk; XF0Pf: goto NMWUv; goto wOPyB; ekw5g: WXRAR: goto SkhNq; y03gb: $c = count($query); goto N8A_f; hXQQp: $retval[$i]->comment = $query[$i]->column_comment; goto rhbnS; VNkO1: if (!($i < $c)) { goto inzrY; } goto BE_g2; rhbnS: $retval[$i]->extra = $query[$i]->extra; goto Cnxpt; vMS10: $fields[$table] = (object) ["\164\141\142\154\x65\137\x6e\x61\155\145" => $table, "\x63\x6f\154\x75\x6d\x6e\163" => $retval]; goto ekw5g; BE_g2: $retval[$i] = new stdClass(); goto yfV7h; ejROX: VVE32: goto g8Tfb; ffztN: bzYEn: goto vVMRD; Cnxpt: $retval[$i]->nullable = $query[$i]->is_nullable; goto OGUxn; g8Tfb: $query = $query->result_object(); goto EnTI9; vVMRD: $i++; goto XF0Pf; F0Oxk: $retval[$i]->type = $query[$i]->data_type; goto LmILM; LmILM: $retval[$i]->collation = $query[$i]->collation_name; goto TZG3q; N8A_f: NMWUv: goto VNkO1; SkhNq: } goto m0nns; KFRUw: $script_create_column = []; goto wD4Vv; a0Hok: $tbl_seharusnya = array_keys($json); goto y8bai; kvZF4: $script_create_table = []; goto BmGMh; O2mmH: $data = ["\x66\x69\145\x6c\144\x73" => $fields, "\x63\x72\x65\141\x74\x65\x5f\164\141\x62\154\x65\x73" => $create_tables, "\143\157\165\156\x74\x5f\x74\x62\x6c" => count($create_tables), "\141\x64\x64\x5f\143\x6f\154\165\155\x6e\163\137\x74\x6f\137\164\x61\x62\154\x65" => $add_columns, "\143\x6f\165\156\x74\x5f\143\157\x6c" => count($add_columns), "\145\144\x69\x74\x5f\x63\157\154\165\155\156\163" => $edit_columns, "\143\x6f\165\x6e\x74\137\x6d\x6f\x64" => count($edit_columns), "\x61\x64\144\x5f\164\142\x6c" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\144\x64\x5f\143\x6f\154" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\157\144\x5f\143\157\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto jBP7d; m0nns: mmdIq: goto Km1BU; y8bai: $tbl_ada = array_keys($fields); goto meFnp; mSged: $create_tables = []; goto kvZF4; ByjGf: $fields = []; goto TJd9h; Km1BU: $json = file_get_contents("\56\x2f\x61\163\163\x65\164\163\57\141\x70\160\x2f\144\x62\57\144\x61\x74\141\142\x61\163\145\56\x6a\163\157\x6e"); goto nyY5B; Ty_nu: yaK9D: goto GHc25; nRPFx: $full_tables = array_unique($full_tables); goto Ql9I8; FBuxQ: $this->db->db_debug = FALSE; goto dCbbK; ChQaE: $db_debug = $this->db->db_debug; goto FBuxQ; IA28Q: $json = (array) $json; goto a0Hok; qN3mL: } public function createTable() { goto aXCb2; TVbPc: $scripts = json_decode($this->encryption->decrypt($scripts)); goto VMkAh; AJ7VK: $data["\x73\x75\143\143\145\163\163"] = $this->runQuery($queries); goto NOyXz; Be4RW: CA3kR: goto AJ7VK; NOyXz: $data["\155\145\163\163\141\147\x65"] = "\x55\160\x64\x61\x74\145\40\x6b\157\x6c\x6f\155"; goto dYA01; boRal: foreach ($scripts as $script) { $queries .= $script; rCaA4: } goto Be4RW; dYA01: $this->output_json($data); goto JohRM; l1yS2: sleep(1); goto TVbPc; FLCSb: str_replace("\45\62\x42", "\53", $scripts); goto l1yS2; VMkAh: $queries = ''; goto boRal; aXCb2: $scripts = $this->input->post("\x64\141\x74\x61", true); goto FLCSb; JohRM: } public function createColumn() { goto zHE9G; ZNUUU: if (!(strpos("\x60\x75\x69\x64\140", $queries) !== false)) { goto kJm4Y; } goto MIhqM; AcPo3: foreach ($scripts as $script) { $queries .= $script; ueeyE: } goto p9u9S; fujfL: $data["\x73\x75\x63\x63\x65\x73\x73"] = $this->runQuery($queries); goto QylLM; p9u9S: ODuLm: goto ZNUUU; zHE9G: $scripts = $this->input->post("\144\x61\164\x61", true); goto oPF3J; nc_js: sleep(1); goto ywXHM; MIhqM: $this->updateUID(); goto ilVmQ; ywXHM: $scripts = json_decode($this->encryption->decrypt($scripts)); goto ng_Hs; oPF3J: str_replace("\x25\62\x42", "\x2b", $scripts); goto nc_js; ng_Hs: $queries = ''; goto AcPo3; ilVmQ: kJm4Y: goto fujfL; QylLM: $data["\155\145\x73\163\141\x67\145"] = "\x4d\157\x64\151\x66\x79\x20\153\157\x6c\157\x6d"; goto HWACP; HWACP: $this->output_json($data); goto lN_wq; lN_wq: } public function editColumn() { goto y075A; qal5X: $queries = ''; goto ev6lK; FiJh1: $data["\x73\165\143\x63\145\163\163"] = $this->runQuery($queries); goto kKPIO; RNZAr: ZGN2I: goto FiJh1; uhk3X: $scripts = json_decode($this->encryption->decrypt($scripts)); goto qal5X; kuC3h: $this->output_json($data); goto ZGvnw; M_Au_: sleep(1); goto uhk3X; kKPIO: $data["\x6d\145\163\163\x61\x67\145"] = "\x55\160\x64\141\164\145\x20\163\x65\154\145\163\x61\151"; goto kuC3h; y075A: $scripts = $this->input->post("\144\141\164\x61", true); goto B5zX7; B5zX7: str_replace("\x25\x32\102", "\53", $scripts); goto M_Au_; ev6lK: foreach ($scripts as $script) { $queries .= $script; O8Kmy: } goto RNZAr; ZGvnw: } function runQuery($script) { goto sZOtN; moTvJ: return true; goto obkXG; vu9DN: $mysqli->multi_query($script); goto rWiwi; w1b2R: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto TnX8Y; sZOtN: $hostname = $this->db->hostname; goto X90nE; hSHjJ: jhGhv: goto vu9DN; DphRL: $database = $this->db->database; goto w1b2R; rWiwi: $mysqli->close(); goto moTvJ; X90nE: $hostuser = $this->db->username; goto w9I2m; ktbP1: return mysqli_connect_errno(); goto hSHjJ; TnX8Y: if (!mysqli_connect_errno()) { goto jhGhv; } goto ktbP1; w9I2m: $hostpass = $this->db->password; goto DphRL; obkXG: } function updateUID() { goto nlpcM; nlpcM: $this->load->library("\125\165\151\x64", "\165\x75\x69\144"); goto l0jaj; G0JrD: foreach ($siswas as $siswa) { $input[] = array("\151\x64\137\163\x69\x73\x77\141" => $siswa->id_siswa, "\x75\x69\144" => $this->uuid->v4()); o_kZx: } goto DnUkC; DnUkC: s08zP: goto eUWO9; Nuupj: $input = array(); goto G0JrD; l0jaj: $siswas = $this->db->get("\155\x61\163\164\145\x72\137\163\151\x73\x77\141")->result(); goto Nuupj; eUWO9: return $this->db->update_batch("\155\141\163\x74\145\162\x5f\163\x69\x73\x77\x61", $input, "\151\x64\x5f\x73\151\163\x77\141"); goto FYWak; FYWak: } function make_base() { } }
