<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\101\123\x45\120\x41\x54\x48") or exit("\116\x6f\x20\144\151\x72\145\143\x74\40\x73\143\x72\151\160\164\x20\x61\x63\x63\x65\163\163\x20\x61\154\x6c\x6f\167\145\144"); class Update extends CI_Controller { function __construct() { goto LtJ_b; CGvol: $this->load->dbforge(); goto cgD7j; pJCDC: $this->load->library("\145\156\143\x72\171\x70\x74\151\157\x6e"); goto tsxtY; LtJ_b: parent::__construct(); goto G7K8Y; G7K8Y: include APPPATH . "\143\157\156\x66\x69\x67\57\144\141\x74\x61\x62\141\x73\x65\x2e\x70\x68\160"; goto CGvol; cgD7j: $this->load->database(); goto pJCDC; tsxtY: } public function output_json($data, $encode = true) { goto iQ2ou; iQ2ou: if (!$encode) { goto BpGtL; } goto vwzJO; vwzJO: $data = json_encode($data); goto NWy8x; uxdii: $this->output->set_content_type("\141\x70\x70\154\151\x63\141\164\x69\157\x6e\x2f\152\x73\157\x6e")->set_output($data); goto WVBgO; NWy8x: BpGtL: goto uxdii; WVBgO: } public function index() { goto NbZOX; wphtD: $this->load->view("\x69\x6e\163\164\x61\x6c\154\x2f\x66\157\x6f\164\145\162"); goto dHjxm; oq0S4: $this->load->view("\151\156\163\x74\141\154\x6c\x2f\x68\x65\x61\x64\x65\162", $data); goto sK1G9; W556D: $json = (array) $json; goto zzgTL; RJaXs: $json = json_decode($json); goto W556D; zzgTL: $data["\152\x73\157\156"] = $json; goto oq0S4; sK1G9: $this->load->view("\x69\x6e\x73\164\x61\154\154\x2f\x75\x70\x64\x61\x74\145"); goto wphtD; NbZOX: $json = file_get_contents("\x2e\x2f\x61\x73\163\145\164\x73\57\x61\160\160\x2f\144\x62\57\144\x61\164\x61\142\x61\163\x65\x2e\152\163\x6f\156"); goto RJaXs; dHjxm: } function object_to_array($data) { goto rU4Lp; rU4Lp: if (!(is_array($data) || is_object($data))) { goto WP7wz; } goto Do30E; yaWZs: return $result; goto wRFma; wRFma: WP7wz: goto SZhgk; kVTuG: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; eF7P3: } goto Cdw00; SZhgk: return $data; goto laH0s; Cdw00: vhRc6: goto yaWZs; Do30E: $result = []; goto kVTuG; laH0s: } public function checkDatabase() { goto Y9NAY; ur83D: $json = json_decode($json); goto CmDXP; OZR_o: foreach ($tabless as $table) { goto Z9mNv; bgeLZ: $retval[$i] = new stdClass(); goto oVl80; NUfQu: ceOiG: goto uZ2Y6; TRHbF: $currentDb[$table] = $retval; goto S1HSg; YxuY_: goto O7nV5; goto NUfQu; NJgPf: XXCoD: goto e38df; A5Jdx: if (!($i < $c)) { goto q2j6B; } goto m8QQe; m8QQe: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto zuOXg; } goto nYM7Z; S1HSg: $fields[$table] = $datafld; goto CZ5wb; CZ5wb: ErfjG: goto GuXPP; oVl80: $retval[$i]->name = $query[$i]->column_name; goto EHkRl; O_qjh: rSSIA: goto A5Jdx; Z9mNv: $datafld = $this->db->field_data($table); goto o1CJp; nYM7Z: if (!($query[$i]->extra != '')) { goto XXCoD; } goto t_vvD; doXdb: $query = $query->result_object(); goto FqCFn; T3JYe: $datafld[$i]->extra = $query[$i]->extra; goto YxuY_; C1ISe: goto rSSIA; goto cG6Cx; VxsdD: oplOO: goto iKm0G; uZ2Y6: $datafld[$i]->auto_increment = true; goto JQbpV; EHkRl: $retval[$i]->extra = $query[$i]->extra; goto VxsdD; FqCFn: $retval = array(); goto g5fKp; d0Yr6: if (!(($query = $this->db->query($sql)) === FALSE)) { goto Mw3pO; } goto Y0ntD; GAR6y: Mw3pO: goto doXdb; JQbpV: O7nV5: goto NJgPf; o1CJp: $sql = "\123\x45\x4c\105\x43\124\x20\x60\143\x6f\154\165\x6d\x6e\137\156\141\x6d\145\140\x2c\x20\x60\156\165\155\x65\x72\x69\143\137\160\162\x65\143\151\x73\x69\157\x6e\140\54\40\x60\x65\x78\164\x72\x61\x60\54\x20\x60\151\163\x5f\156\165\x6c\x6c\x61\x62\154\x65\140" . "\x20\106\x52\117\115\40\x60\151\156\146\x6f\x72\155\x61\x74\x69\x6f\x6e\x5f\x73\x63\150\145\x6d\141\x60\x2e\140\x63\157\x6c\x75\155\156\163\x60\x20\x57\x48\x45\122\105\40\164\141\x62\154\145\x5f\163\143\x68\x65\x6d\141\40\75\40\x22" . $this->db->database . "\x22\40\x41\116\x44\40\x74\x61\142\x6c\145\x5f\156\141\155\145\x20\x3d\40\42" . $table . "\x22"; goto d0Yr6; iKm0G: $i++; goto C1ISe; t_vvD: if ($query[$i]->extra == "\141\165\164\x6f\137\151\x6e\x63\x72\x65\155\x65\x6e\x74") { goto ceOiG; } goto T3JYe; cG6Cx: q2j6B: goto TRHbF; g5fKp: $i = 0; goto wmaXk; Y0ntD: $currentDb = FALSE; goto GAR6y; e38df: zuOXg: goto bgeLZ; wmaXk: $c = count($query); goto O_qjh; GuXPP: } goto DkqQT; CmDXP: $json = (array) $json; goto aFpWx; aFpWx: $tbl_baru = array_keys($json); goto RGxnH; fP8wO: ZHt3v: goto RKJmb; RGxnH: $tbl_ada = array_keys($fields); goto GyOWV; Bf_KJ: $add_columns = []; goto SQ9wX; G_uhe: $create_tables = []; goto Bf_KJ; McjCq: sort($full_tables); goto G_uhe; SQ9wX: $edit_columns = []; goto QHNzF; GyOWV: $full_tables = array_merge($tbl_baru, $tbl_ada); goto S3lR7; qcHWf: $tabless = $this->db->list_tables(); goto G17ka; lQ78G: $this->output_json($data); goto a670Y; G17ka: $fields = []; goto J47h2; J47h2: $currentDb = []; goto OZR_o; uDsR0: $this->db->db_debug = FALSE; goto qcHWf; RKJmb: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto iPNF7; QHNzF: foreach ($full_tables as $table) { goto QcO2A; QcO2A: if ($this->db->table_exists($table)) { goto l1Wt6; } goto sVVE7; YmRuH: IPMAN: goto DmRhy; qlskN: l1Wt6: goto F1Kmr; mf7vV: goto y5g7G; goto qlskN; F1Kmr: if (!isset($json[$table])) { goto IPMAN; } goto WVj2H; WVj2H: foreach ($json[$table] as $jtbl) { goto vXZMQ; zNqnY: J4IiW: goto xGK2o; jsgeB: $add_columns[$table][] = $jtbl; goto AvQGO; OBEdc: rfmWB: goto rmlrh; xGK2o: foreach ($fields[$table] as $ftbl) { goto Ykgq9; ZvGx2: $edit_columns[$table][] = $jtbl; goto tDtzl; szSR1: f1WIS: goto evMCx; tDtzl: PMsqe: goto y87TW; Ykgq9: if (!($jtbl->name == $ftbl->name)) { goto SriQi; } goto xD4Y2; y87TW: SriQi: goto szSR1; xD4Y2: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto PMsqe; } goto ZvGx2; evMCx: } goto wHKIu; wHKIu: XzlXe: goto dH5bb; vXZMQ: if ($this->db->field_exists($jtbl->name, $table)) { goto J4IiW; } goto jsgeB; dH5bb: o8V4y: goto OBEdc; AvQGO: goto o8V4y; goto zNqnY; rmlrh: } goto LWQGh; DmRhy: y5g7G: goto b5FQK; LWQGh: PpSOm: goto YmRuH; b5FQK: lXhL2: goto Vky46; sVVE7: $create_tables[$table] = $json[$table]; goto mf7vV; Vky46: } goto fP8wO; vJpNB: $json = file_get_contents("\x2e\57\141\x73\x73\x65\164\163\57\x61\160\x70\x2f\144\x62\x2f\144\x61\164\141\142\141\163\x65\x2e\x6a\x73\x6f\156"); goto ur83D; DkqQT: GD8gB: goto vJpNB; S3lR7: $full_tables = array_unique($full_tables); goto McjCq; Y9NAY: $db_debug = $this->db->db_debug; goto uDsR0; iPNF7: $data = ["\144\142" => $fields, "\x63\x72\x65\x61\x74\145" => $create_tables, "\155\x6f\144\x69\x66\171" => $edit_columns, "\141\144\x64" => $add_columns, "\143\157\x75\x6e\164\163" => $counts, "\x6a\x73\157\x6e" => $json, "\x63\165\x72\162\145\156\164" => $currentDb]; goto lQ78G; a670Y: } public function updateDatabase() { goto Cx3pj; VCrTJ: FwpQ5: goto TOGJf; H75Sm: $full_tables = array_merge($tbl_baru, $tbl_ada); goto uruqj; pNiyu: sort($full_tables); goto CQzXy; uruqj: $full_tables = array_unique($full_tables); goto pNiyu; Cx3pj: $tabless = $this->db->list_tables(); goto RSiyj; zmzIl: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); CcTre: } goto Rh_0u; RSiyj: $fields = []; goto zmzIl; Rh_0u: TdhVl: goto rrx94; TOGJf: echo true; goto zjxfA; hb18E: $tbl_baru = array_keys($json); goto R5S34; rrx94: $json = file_get_contents("\x2e\57\x61\163\x73\x65\x74\x73\x2f\141\x70\x70\x2f\x64\142\x2f\144\x61\164\141\142\141\163\x65\x2e\152\x73\x6f\156"); goto vbpZN; CQzXy: foreach ($full_tables as $table) { goto PWoQn; xeAmM: knJ6Z: goto dMCBq; H1_cY: iZf9y: goto WJuKi; rWYCo: C8apc: goto GXhTP; lrk2A: if (!isset($json[$table])) { goto Smloq; } goto a60c9; UqMyB: if (!isset($json[$table])) { goto iZf9y; } goto cx7s6; xSwHm: $this->db->query("\101\114\x54\105\122\40\124\x41\102\x4c\105\x20\x20\x60" . $table . "\140\40\x45\116\107\111\x4e\x45\x20\x3d\x20\111\x6e\156\x6f\x44\x42"); goto H1_cY; WJuKi: goto Jj6gi; goto sanmu; GXhTP: $this->dbforge->create_table($table, TRUE); goto xSwHm; a60c9: foreach ($json[$table] as $jtbl) { goto upmyp; YvUzq: $field = array($jtbl->name => array("\x74\171\x70\145" => $jtbl->type, "\x63\157\156\x73\164\162\x61\151\x6e\x74" => $jtbl->max_length, "\144\145\146\x61\165\x6c\x74" => $jtbl->default)); goto G2kVb; CVTdf: $this->dbforge->add_key($jtbl->name, true); goto BSTxn; yYnmz: DzbmO: goto tARdu; ofo1a: goto xw8FR; goto rS818; BSTxn: $this->dbforge->add_column($table, $field); goto ofo1a; Cumy1: if ($jtbl->primary_key == 0) { goto FrwWl; } goto SuEHw; rpiYj: wefvZ: goto lE2te; ZfviF: VzR4T: goto rpiYj; g0QgE: xw8FR: goto i0Pqi; i0Pqi: goto VzR4T; goto yYnmz; SuEHw: $field = array($jtbl->name => array("\x74\171\x70\x65" => $jtbl->type, "\x63\x6f\156\x73\164\162\141\151\x6e\164" => $jtbl->max_length, "\x6e\165\x6c\154" => false)); goto CVTdf; Xb5zk: WLZra: goto ZfviF; tARdu: foreach ($fields[$table] as $ftbl) { goto Zrnnb; IqImt: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto YmRd6; } goto ri3n1; aaDHM: if ($jtbl->auto_increment == true) { goto Fnt_M; } goto esUfy; z9h43: goto MF7Uc; goto tAKHs; RGelD: $field = array($jtbl->name => array("\x74\171\160\145" => $jtbl->type, "\x63\x6f\x6e\x73\164\x72\x61\151\x6e\x74" => $jtbl->max_length, "\x64\145\146\x61\165\x6c\164" => $jtbl->default)); goto z9h43; S6ifi: $field = array($jtbl->name => array("\164\x79\160\x65" => $jtbl->type, "\x63\x6f\x6e\x73\x74\162\x61\151\156\x74" => $jtbl->max_length, "\x6e\165\154\x6c" => false, "\x61\165\164\x6f\x5f\x69\x6e\x63\162\x65\x6d\145\156\164" => true)); goto Ar32I; l5Dt_: $field = array($jtbl->name . "\40\144\x61\x74\x65\x74\x69\x6d\x65\x20\x64\145\x66\141\165\154\164\40\x63\x75\x72\x72\145\156\x74\x5f\164\x69\x6d\x65\x73\164\x61\x6d\160" . $onUpdate); goto Gd_T0; lhxkJ: RjTVm: goto Z79KU; ZY1Lr: YXPNZ: goto xNd2h; l0wh3: goto YXPNZ; goto lhxkJ; Gd_T0: MF7Uc: goto c1Lnn; JoLon: $this->dbforge->modify_column($table, $field); goto l0wh3; Zrnnb: if (!($jtbl->name == $ftbl->name)) { goto BIbyB; } goto IqImt; Z79KU: if ($jtbl->default == "\x43\125\122\x52\105\x4e\124\137\124\111\115\x45\123\x54\101\x4d\120") { goto oKSJT; } goto RGelD; cesAH: goto h8eFe; goto zRg3g; tAKHs: oKSJT: goto XjZ8y; c1Lnn: $this->dbforge->modify_column($table, $field); goto ZY1Lr; XjZ8y: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto l5Dt_; Ar32I: h8eFe: goto Kp8xU; xNd2h: YmRd6: goto JYwiN; Kp8xU: $this->dbforge->add_key($jtbl->name, true); goto JoLon; ri3n1: if ($jtbl->primary_key == 0) { goto RjTVm; } goto aaDHM; esUfy: $field = array($jtbl->name => array("\164\x79\x70\145" => $jtbl->type, "\x63\157\x6e\163\x74\x72\141\x69\x6e\x74" => $jtbl->max_length, "\x6e\165\x6c\154" => false)); goto cesAH; JYwiN: BIbyB: goto df1CZ; df1CZ: XCXiq: goto QqzsM; zRg3g: Fnt_M: goto S6ifi; QqzsM: } goto Xb5zk; rS818: FrwWl: goto YvUzq; G2kVb: $this->dbforge->add_column($table, $field); goto g0QgE; upmyp: if ($this->db->field_exists($jtbl->name, $table)) { goto DzbmO; } goto Cumy1; lE2te: } goto xeAmM; U1ra6: Jj6gi: goto KoQwo; KoQwo: tYs43: goto BQTt3; sanmu: sCPcC: goto lrk2A; dMCBq: Smloq: goto U1ra6; PWoQn: if ($this->db->table_exists($table)) { goto sCPcC; } goto UqMyB; cx7s6: foreach ($json[$table] as $tbl => $jtbl) { goto HmdI_; MZ8I5: if (!($jtbl->primary_key == 1)) { goto Dec02; } goto AtJQK; HmdI_: $field = [$jtbl->name => ["\x74\x79\x70\145" => $jtbl->type, "\143\x6f\156\x73\x74\x72\141\151\156\x74" => $jtbl->max_length, "\156\x75\154\x6c" => $jtbl->primary_key == 0]]; goto OddJk; AtJQK: $this->dbforge->add_key($jtbl->name, true); goto vq6bb; OddJk: $this->dbforge->add_field($field); goto MZ8I5; u4sHx: MdP9F: goto B0Igu; vq6bb: Dec02: goto u4sHx; B0Igu: } goto rWYCo; BQTt3: } goto VCrTJ; c4z51: $json = (array) $json; goto hb18E; R5S34: $tbl_ada = array_keys($fields); goto H75Sm; vbpZN: $json = json_decode($json); goto c4z51; zjxfA: } public function checkDb() { goto St3op; R8Iem: $script_edit_column = []; goto C_47T; yX_tU: $add_columns = []; goto LJT_l; WOIV3: $this->db->db_debug = FALSE; goto bIpkf; mSLg6: foreach ($tabless as $table) { goto G9XK8; i4_yW: $retval[$i]->name = $query[$i]->column_name; goto htLlf; G9XK8: $sql = "\123\105\x4c\x45\x43\x54\x20\x60\143\x6f\x6c\x75\155\x6e\x5f\x6e\x61\155\145\140\x2c\40\140\x63\x6f\x6c\165\x6d\156\137\x74\171\x70\x65\140\54\40\140\x63\157\154\154\141\164\x69\157\156\137\156\x61\x6d\x65\140\x2c\x20\x60\144\x61\164\141\x5f\x74\171\x70\x65\140\x2c\x20\140\143\x68\x61\x72\x61\x63\164\x65\162\x5f\x6d\141\170\151\155\165\x6d\x5f\x6c\x65\156\x67\x74\150\140\54\x20\x60\x6e\x75\155\x65\162\x69\x63\137\x70\162\x65\143\151\163\151\x6f\156\x60\x2c" . "\x20\140\143\157\x6c\x75\x6d\156\137\144\x65\146\x61\165\x6c\164\x60\54\40\x60\143\157\154\x75\x6d\156\x5f\153\145\171\140\x2c\40\140\143\x6f\154\x75\x6d\156\137\x63\157\155\x6d\145\156\164\140\x2c\40\x60\x65\x78\x74\x72\x61\x60\54\40\x60\x69\x73\137\x6e\165\154\x6c\x61\x62\154\145\140\15\12\x9\x9\x9\106\122\117\x4d\40\140\x69\x6e\x66\157\x72\155\141\x74\151\x6f\156\x5f\x73\143\x68\145\x6d\141\140\x2e\140\143\157\154\x75\155\156\163\x60\40\127\x48\x45\122\x45\x20\x74\141\142\x6c\x65\x5f\x73\x63\x68\x65\155\x61\x20\x3d\x20\42" . $this->db->database . "\42\x20\101\116\104\x20\x74\x61\x62\x6c\x65\137\x6e\141\x6d\145\40\75\x20\42" . $table . "\42"; goto yrBrU; wSfSX: kZ9So: goto X69Kn; ggd6L: $fields = FALSE; goto wSfSX; W5G6a: tTl0z: goto izwEz; zvXvT: $i++; goto dB5Xx; dB5Xx: goto DFFl9; goto cMrO8; k3Guh: if (!($i < $c)) { goto CTaTC; } goto x0NPE; cMrO8: CTaTC: goto GjOvk; azXW1: $retval[$i]->collation = $query[$i]->collation_name; goto Th9ZV; DHh3H: a1JaZ: goto zvXvT; e4u_E: $retval = array(); goto kG80M; yrBrU: if (!(($query = $this->db->query($sql)) === FALSE)) { goto kZ9So; } goto ggd6L; Sbg31: $retval[$i]->extra = $query[$i]->extra; goto eVCpq; eVCpq: $retval[$i]->nullable = $query[$i]->is_nullable; goto zHVqH; k8H9Q: $c = count($query); goto hnO3J; rxnvo: $retval[$i]->type = $query[$i]->data_type; goto azXW1; YUU0v: $retval[$i]->default = $query[$i]->column_default; goto yWZNw; yWZNw: $retval[$i]->comment = $query[$i]->column_comment; goto Sbg31; hnO3J: DFFl9: goto k3Guh; Th9ZV: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto YUU0v; kG80M: $i = 0; goto k8H9Q; zHVqH: $retval[$i]->primary = $query[$i]->column_key; goto DHh3H; GjOvk: $fields[$table] = (object) ["\x74\141\142\154\145\x5f\156\x61\x6d\x65" => $table, "\x63\157\154\165\x6d\x6e\163" => $retval]; goto W5G6a; htLlf: $retval[$i]->col_type = $query[$i]->column_type; goto rxnvo; x0NPE: $retval[$i] = new stdClass(); goto i4_yW; X69Kn: $query = $query->result_object(); goto e4u_E; izwEz: } goto FwXW1; NNC0V: $json = file_get_contents("\x2e\57\141\163\163\145\164\163\57\x61\x70\160\57\144\x62\x2f\x64\x61\x74\x61\x62\141\x73\145\x2e\x6a\x73\x6f\156"); goto v3mrF; FwXW1: qOAyH: goto NNC0V; jASKX: $fields = []; goto mSLg6; DpfEJ: P_Sb0: goto xaoo_; g89Si: $data = ["\146\x69\145\154\x64\163" => $fields, "\143\162\145\141\x74\x65\137\164\141\142\154\145\163" => $create_tables, "\143\x6f\165\x6e\x74\137\x74\142\x6c" => count($create_tables), "\x61\144\144\137\143\157\x6c\165\155\x6e\163\x5f\164\x6f\137\x74\x61\142\x6c\x65" => $add_columns, "\x63\157\x75\156\x74\x5f\143\x6f\x6c" => count($add_columns), "\145\x64\x69\164\137\143\x6f\154\x75\x6d\156\163" => $edit_columns, "\143\157\165\x6e\164\137\155\157\144" => count($edit_columns), "\x61\x64\144\137\x74\142\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\x61\x64\144\137\143\157\154" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\157\x64\137\x63\x6f\154" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto e1KM2; St3op: $db_debug = $this->db->db_debug; goto WOIV3; wwB6X: $edit_columns = []; goto R8Iem; lRlWr: $create_tables = []; goto qZn8Y; C_47T: foreach ($full_tables as $table) { goto NUHav; ifQ0j: if (!(count($add_column) > 0)) { goto enm1R; } goto xnGEm; BH0ly: RS08y: goto V_eUe; YSgAA: enm1R: goto BlEI7; CeOCt: hKWHR: goto V_nFn; l_aXA: Eftr9: goto CeOCt; IvUmG: $script = "\x43\x52\x45\x41\x54\x45\40\x54\x41\x42\x4c\x45\40\x60" . $table . "\x60\x20\x28"; goto a_q7_; BlEI7: if (!(count($modif_column) > 0)) { goto Eftr9; } goto CT0tC; erKHT: kM8rn: goto ifQ0j; Ztpdn: if (!isset($json[$table])) { goto hKWHR; } goto IBvF1; ROX3T: vgNV2: goto jvtm6; nUM1B: foreach ($json[$table]->columns as $jtbl) { goto F6cQf; lzGqr: $nullable = $jtbl->nullable == "\116\x4f" ? "\40\x4e\117\x54\40\x4e\x55\114\114" : ''; goto wDJmx; pdqGy: YRVPt: goto fNHPF; f_yxR: $comment = $jtbl->comment == '' ? '' : "\x20\103\117\x4d\115\105\116\x54\x20\47" . $jtbl->comment . "\47"; goto GB016; F6cQf: if ($this->db->field_exists($jtbl->name, $table)) { goto VDDTl; } goto Vs1OP; HlnQ3: if (!(strtoupper($extra) == "\x20\x41\125\124\117\137\x49\x4e\103\122\x45\115\x45\x4e\x54")) { goto T1693; } goto NXwEi; VmHMB: kMK4F: goto lzGqr; R1oYA: goto nTu0Y; goto pdqGy; fNHPF: $length = "\50" . ($jtbl->max_length + 1) . "\x29"; goto qDcDj; OFUbf: goto kMK4F; goto D5aJL; ZIvVb: ErwhP: goto u7YN_; bYiD9: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto HlnQ3; ljj43: $length = ''; goto IAAWw; IAAWw: goto kMK4F; goto ZIvVb; wDJmx: $default = $jtbl->default == null ? '' : "\x20\x44\105\106\x41\125\x4c\124\x20" . $jtbl->default; goto bYiD9; ohO28: if ($jtbl->type == "\151\x6e\x74") { goto YRVPt; } goto yvsPr; D5aJL: j3MO9: goto ohO28; BiFJK: pkEHz: goto INqFS; PJhXF: if ($jtbl->max_length == null) { goto ErwhP; } goto ePtIm; qhi3Q: VDDTl: goto kLy4B; GB016: array_push($add_column, "\101\x44\104\x20\x60" . $jtbl->name . "\140\40" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto qhi3Q; yvsPr: $length = "\50" . $jtbl->max_length . "\x29"; goto R1oYA; NXwEi: $extra .= "\x20\x50\x52\x49\x4d\x41\x52\131\x20\113\105\131"; goto DPIkC; ePtIm: if ($jtbl->type != "\x6c\x6f\x6e\147\x74\x65\170\x74" && $jtbl->type != "\155\x65\144\151\x75\x6d\x74\x65\x78\x74" && $jtbl->type != "\x74\145\170\x74") { goto j3MO9; } goto ljj43; kLy4B: foreach ($fields[$table]->columns as $ftbl) { goto DVi6Z; RMi5v: $ftbl->default = str_replace("\50\x29", '', $ftbl->default); goto Tj3LX; Yhg4V: KX86M: goto nyPbo; WJUD9: EXjJq: goto VULNq; qJkMZ: CJ_kW: goto HiuPQ; DVi6Z: if (!($jtbl->name == $ftbl->name)) { goto XNU_t; } goto I9WEZ; btaRD: DbMYN: goto cer8F; csLL8: Th8VK: goto y7Z9F; uCKu3: $comment = $jtbl->comment == '' ? '' : "\x20\x43\117\x4d\115\105\116\x54\40\x27" . $jtbl->comment . "\x27"; goto RXJrs; VULNq: if (!($jtbl->nullable != $ftbl->nullable)) { goto DbMYN; } goto vSA5n; Tj3LX: $ftbl->default = strtoupper($ftbl->default); goto Rt9aO; qZDSE: $edit_columns[$table][$jtbl->name]["\x63\157\154\x5f\164\x79\160\x65"] = $jtbl->col_type; goto WJUD9; vSA5n: $edit_columns[$table][$jtbl->name]["\156\165\x6c\154\x61\x62\154\145"] = $jtbl->nullable; goto btaRD; IMmU_: LrIjy: goto svIKL; I_8cT: nZ8Pq: goto LRG1D; BFKVx: $jtbl->default = strtoupper($jtbl->default); goto RY1a0; RXJrs: array_push($modif_column, "\115\x4f\x44\111\106\131\40\x60" . $jtbl->name . "\x60\40" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto I_8cT; b8A75: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto uCKu3; RHetf: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto nZ8Pq; } goto hxmRe; nyPbo: k5TxJ: goto RHetf; wnJ3A: if (!($ftbl->default != null)) { goto UOsUL; } goto RMi5v; HCdEa: $ftbl->extra = strtoupper($ftbl->extra); goto t_ILT; F2khp: $ftbl->extra = str_replace("\50\51", '', $ftbl->extra); goto HCdEa; t_ILT: FXodq: goto rzikE; m0dBZ: $edit_columns[$table][$jtbl->name]["\x70\162\151\x6d\141\x72\171"] = $jtbl->primary; goto qY93S; qY93S: if (strtolower($jtbl->primary) == "\x70\162\x69") { goto CJ_kW; } goto ZJYIT; llIG3: $edit_columns[$table][$jtbl->name]["\144\145\146\x61\x75\x6c\164"] = $jtbl->default; goto I8DHt; ZJYIT: if (strtolower($jtbl->primary) == "\165\x6e\x69") { goto uHmzl; } goto bNf7I; sICq3: if (!($jtbl->primary != $ftbl->primary)) { goto k5TxJ; } goto m0dBZ; rzikE: if (!($jtbl->extra != $ftbl->extra)) { goto LrIjy; } goto EFUgR; I8DHt: bq7Dq: goto Yr18n; c7ueV: tR31v: goto sS7fj; srZ8x: XIjhF: goto sICq3; y98MU: $edit_columns[$table][$jtbl->name]["\143\157\x6d\x6d\145\x6e\x74"] = $jtbl->comment; goto srZ8x; rLAR0: $default = $jtbl->default == null ? '' : "\40\104\105\x46\101\x55\114\124\x20" . $jtbl->default; goto b8A75; svIKL: if (!($jtbl->comment != $ftbl->comment)) { goto XIjhF; } goto y98MU; UmCuP: uHmzl: goto SsUce; HiuPQ: array_push($modif_column, "\x41\x44\104\x20\x50\122\111\x4d\101\122\131\40\x4b\105\x59\40\x28\x60" . $jtbl->name . "\x60\51"); goto rAS6V; I9WEZ: if (!($jtbl->col_type != $ftbl->col_type)) { goto EXjJq; } goto qZDSE; YW0H0: $jtbl->extra = str_replace("\x28\51", '', $jtbl->extra); goto Jhnm5; RY1a0: N0rd4: goto wnJ3A; hxmRe: $nullable = $jtbl->nullable == "\116\117" ? "\40\x4e\x4f\124\40\x4e\125\114\x4c" : ''; goto rLAR0; Yr18n: if (!($jtbl->extra != null)) { goto tR31v; } goto YW0H0; Jhnm5: $jtbl->extra = strtoupper($jtbl->extra); goto c7ueV; Rt9aO: UOsUL: goto jJYqI; op8kO: $jtbl->default = str_replace("\50\x29", '', $jtbl->default); goto BFKVx; EFUgR: $edit_columns[$table][$jtbl->name]["\145\170\x74\x72\141"] = $jtbl->extra; goto IMmU_; rAS6V: goto KX86M; goto UmCuP; cer8F: if (!($jtbl->default != null)) { goto N0rd4; } goto op8kO; bNf7I: goto KX86M; goto qJkMZ; LRG1D: XNU_t: goto csLL8; sS7fj: if (!($ftbl->extra != null)) { goto FXodq; } goto F2khp; SsUce: array_push($modif_column, "\101\x44\x44\40\x55\x4e\111\x51\x55\x45\40\113\x45\x59\40\x60" . $jtbl->name . "\140\x20\x28\x60" . $jtbl->name . "\x60\51"); goto Yhg4V; jJYqI: if (!($jtbl->default != $ftbl->default)) { goto bq7Dq; } goto llIG3; y7Z9F: } goto BiFJK; qDcDj: nTu0Y: goto VmHMB; INqFS: AuhDa: goto EIiiH; DPIkC: T1693: goto f_yxR; Vs1OP: $add_columns[$table][] = $jtbl; goto PJhXF; u7YN_: $length = ''; goto OFUbf; EIiiH: } goto erKHT; DPgtS: $modif_column = []; goto nUM1B; V_eUe: $create_tables[] = $json[$table]; goto IvUmG; jvtm6: $script .= $pri . "\51\40\105\x4e\107\111\x4e\x45\x3d\111\x6e\156\x6f\x44\102\x20\x44\x45\106\x41\125\114\x54\x20\x43\x48\x41\122\x53\105\x54\75\165\x74\x66\70\x6d\x62\64\x3b"; goto jxDxa; xnGEm: $script_create_column[$table] = "\101\x4c\x54\105\122\x20\x54\101\x42\114\105\40\x60" . $table . "\x60\x20" . implode("\54\40", $add_column) . "\73"; goto YSgAA; IBvF1: $add_column = []; goto DPgtS; a_q7_: $pri = ''; goto PrDiP; NUHav: if (!$this->db->table_exists($table)) { goto RS08y; } goto Ztpdn; jxDxa: $script_create_table[$table] = $script; goto GxWmc; jmUNk: vUawC: goto imdC1; PrDiP: foreach ($json[$table]->columns as $column) { goto EXrn5; xmqNV: $length = ''; goto KpoNl; om7Z_: $pri .= $column->primary != '' ? "\x50\122\x49\x4d\101\122\131\40\x4b\x45\131\x20\x28\140" . $column->name . "\140\x29" : ''; goto ugjD1; digmF: jp1U2: goto g5JSs; KIHUZ: JpJp4: goto j41t9; EXrn5: if ($column->max_length == null) { goto JpJp4; } goto ivGtc; BaQ27: $script .= "\140" . $column->name . "\140\x20" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\x20"; goto om7Z_; KpoNl: goto X38yn; goto KIHUZ; kGTQa: goto X38yn; goto OwvFh; j41t9: $length = ''; goto kGTQa; ugjD1: KthgG: goto yxQpy; ivGtc: if ($column->type != "\x6c\157\156\x67\164\145\x78\164" && $column->type != "\155\x65\x64\151\165\155\164\145\x78\164" && $column->type != "\164\145\170\x74") { goto fAii2; } goto xmqNV; nLZom: if ($column->type == "\x69\x6e\164") { goto Z3Ryu; } goto KFiqo; ChBFu: $comment = $column->comment == '' ? '' : "\40\103\117\115\x4d\x45\116\124\x20\47" . $column->comment . "\47"; goto BaQ27; OwvFh: fAii2: goto nLZom; KFiqo: $length = "\x28" . $column->max_length . "\x29"; goto EA8xJ; wChTe: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto ChBFu; uK2XF: $default = $column->default == null ? '' : "\x20\x44\x45\x46\101\125\114\x54\x20" . $column->default; goto wChTe; EA8xJ: goto jp1U2; goto GtP61; cXv56: $nullable = $column->nullable == "\116\x4f" ? "\x20\x4e\117\124\40\116\x55\x4c\114" : ''; goto uK2XF; ATOYj: $length = "\50" . ($column->max_length + 1) . "\x29"; goto digmF; g5JSs: X38yn: goto cXv56; GtP61: Z3Ryu: goto ATOYj; yxQpy: } goto ROX3T; GxWmc: kw3Y4: goto jmUNk; CT0tC: $script_edit_column[$table] = "\101\x4c\x54\105\x52\40\124\101\x42\x4c\x45\x20\x60" . $table . "\x60\40" . implode("\54\40", $modif_column) . "\x3b"; goto l_aXA; V_nFn: goto kw3Y4; goto BH0ly; imdC1: } goto DpfEJ; egFQq: $full_tables = array_unique($full_tables); goto JvBsa; grV0i: $tbl_seharusnya = array_keys($json); goto M8XUm; M8XUm: $tbl_ada = array_keys($fields); goto xEDy8; p1HTF: $json = (array) $json; goto grV0i; e1KM2: $this->output_json($data); goto M0NLR; bIpkf: $tabless = $this->db->list_tables(); goto jASKX; xEDy8: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto egFQq; qZn8Y: $script_create_table = []; goto yX_tU; LJT_l: $script_create_column = []; goto wwB6X; JvBsa: sort($full_tables); goto lRlWr; v3mrF: $json = json_decode($json); goto p1HTF; xaoo_: $this->db->db_debug = $db_debug; goto g89Si; M0NLR: } public function createTable() { goto QNrPq; LRESp: $scripts = json_decode($this->encryption->decrypt($scripts)); goto IWHW7; IWHW7: $queries = ''; goto H9aen; KP9EQ: str_replace("\45\62\102", "\53", $scripts); goto dUoJS; s56ME: $data["\x6d\145\x73\x73\x61\147\x65"] = "\125\160\x64\x61\164\x65\x20\x6b\157\154\157\155"; goto bSsip; dUoJS: sleep(1); goto LRESp; QNrPq: $scripts = $this->input->post("\x64\141\x74\x61", true); goto KP9EQ; en3rl: $data["\163\x75\x63\x63\145\163\163"] = $this->runQuery($queries); goto s56ME; NUfrN: S9qmp: goto en3rl; H9aen: foreach ($scripts as $script) { $queries .= $script; YPQuy: } goto NUfrN; bSsip: $this->output_json($data); goto cwt9x; cwt9x: } public function createColumn() { goto cK2UP; uTC1k: $this->updateUID(); goto mfZNx; TbG_E: $scripts = json_decode($this->encryption->decrypt($scripts)); goto toyHP; XYKOQ: $this->output_json($data); goto RnT6f; AUc37: if (!(strpos("\140\165\x69\x64\x60", $queries) !== false)) { goto lrHon; } goto uTC1k; Pqcvv: $data["\155\145\x73\163\x61\x67\145"] = "\x4d\x6f\x64\x69\146\171\40\x6b\x6f\154\x6f\x6d"; goto XYKOQ; EWVOr: foreach ($scripts as $script) { $queries .= $script; U75c9: } goto iPWVB; iPWVB: YKfGh: goto AUc37; YT1b7: sleep(1); goto TbG_E; WMuCz: $data["\163\165\143\x63\145\x73\163"] = $this->runQuery($queries); goto Pqcvv; lLR8b: str_replace("\x25\62\x42", "\x2b", $scripts); goto YT1b7; mfZNx: lrHon: goto WMuCz; toyHP: $queries = ''; goto EWVOr; cK2UP: $scripts = $this->input->post("\x64\x61\x74\x61", true); goto lLR8b; RnT6f: } public function editColumn() { goto wIfnR; LFolA: $this->output_json($data); goto VzLMA; lA84H: $data["\x73\x75\x63\x63\145\x73\x73"] = $this->runQuery($queries); goto k5vOp; BhE7F: $scripts = json_decode($this->encryption->decrypt($scripts)); goto DoH0f; Z8Cdr: sleep(1); goto BhE7F; ahUd6: str_replace("\x25\62\102", "\53", $scripts); goto Z8Cdr; k5vOp: $data["\x6d\145\x73\163\141\147\x65"] = "\x55\160\144\141\x74\145\40\x73\x65\154\145\163\141\x69"; goto LFolA; N0jAH: CgMkC: goto lA84H; DoH0f: $queries = ''; goto vkpB7; wIfnR: $scripts = $this->input->post("\144\x61\164\x61", true); goto ahUd6; vkpB7: foreach ($scripts as $script) { $queries .= $script; PGD52: } goto N0jAH; VzLMA: } function runQuery($script) { goto Qdq2v; RgIxz: $hostuser = $this->db->username; goto xIHIo; C6kP0: $mysqli->close(); goto yofd3; M8mSW: if (!mysqli_connect_errno()) { goto WQGpO; } goto EeTG2; xIHIo: $hostpass = $this->db->password; goto FJ3Cm; EeTG2: return mysqli_connect_errno(); goto aJ52K; x3uDC: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto M8mSW; aJ52K: WQGpO: goto RToO_; yofd3: return true; goto L1eaw; Qdq2v: $hostname = $this->db->hostname; goto RgIxz; FJ3Cm: $database = $this->db->database; goto x3uDC; RToO_: $mysqli->multi_query($script); goto C6kP0; L1eaw: } function updateUID() { goto jD4cZ; LvfAM: WCMmg: goto d2hP1; sCktE: $input = array(); goto D1HyS; jD4cZ: $this->load->library("\x55\165\x69\144", "\x75\165\151\144"); goto AngT1; D1HyS: foreach ($siswas as $siswa) { $input[] = array("\x69\x64\137\163\151\x73\x77\141" => $siswa->id_siswa, "\x75\151\144" => $this->uuid->v4()); Q14yY: } goto LvfAM; d2hP1: return $this->db->update_batch("\x6d\x61\163\164\145\x72\x5f\163\x69\x73\167\141", $input, "\x69\x64\x5f\163\x69\163\x77\141"); goto T90s3; AngT1: $siswas = $this->db->get("\155\141\163\x74\x65\162\x5f\163\x69\x73\x77\141")->result(); goto sCktE; T90s3: } function make_base() { } }
