<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\x45\x50\x41\x54\110") or exit("\116\157\40\x64\x69\162\x65\x63\x74\x20\163\x63\x72\151\x70\164\40\x61\143\x63\x65\163\x73\x20\141\x6c\154\x6f\167\145\144"); class Update extends CI_Controller { function __construct() { goto tuNhE; C82pZ: $this->load->database(); goto LMkon; LMkon: $this->load->library("\x65\156\143\x72\x79\x70\164\151\x6f\x6e"); goto im0sg; tuNhE: parent::__construct(); goto yLsBo; AOZ33: $this->load->dbforge(); goto C82pZ; yLsBo: include APPPATH . "\143\x6f\x6e\x66\x69\x67\x2f\144\141\x74\141\x62\x61\163\145\x2e\160\x68\x70"; goto AOZ33; im0sg: } public function output_json($data, $encode = true) { goto eWYFP; eWYFP: if (!$encode) { goto pvh37; } goto LJyFY; LJyFY: $data = json_encode($data); goto ANv0i; ZavA4: $this->output->set_content_type("\141\x70\x70\x6c\x69\x63\141\x74\x69\157\x6e\x2f\x6a\x73\157\x6e")->set_output($data); goto L5Jc7; ANv0i: pvh37: goto ZavA4; L5Jc7: } public function index() { goto Te3_B; txxIq: $this->load->view("\x69\x6e\x73\164\141\154\x6c\x2f\x66\157\x6f\164\145\x72"); goto H22ca; c5amX: $json = json_decode($json); goto SpTj6; Oosbs: $this->load->view("\151\x6e\x73\x74\141\154\x6c\x2f\x75\160\x64\x61\164\x65"); goto txxIq; Te3_B: $json = file_get_contents("\x2e\57\141\x73\163\x65\164\x73\x2f\x61\x70\160\x2f\x64\142\57\x64\141\x74\141\x62\x61\x73\x65\56\x6a\x73\157\x6e"); goto c5amX; SpTj6: $json = (array) $json; goto akVg2; Taehx: $this->load->view("\151\x6e\163\x74\x61\x6c\154\x2f\150\145\141\x64\145\162", $data); goto Oosbs; akVg2: $data["\152\163\157\x6e"] = $json; goto Taehx; H22ca: } function object_to_array($data) { goto mC6dd; RZ7WX: a9lZQ: goto HzdVA; mC6dd: if (!(is_array($data) || is_object($data))) { goto qVrGL; } goto Qa61V; Qa61V: $result = []; goto YkYDf; OBq_i: return $data; goto UEWe3; E7Ehz: qVrGL: goto OBq_i; HzdVA: return $result; goto E7Ehz; YkYDf: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; OZRVi: } goto RZ7WX; UEWe3: } public function checkDatabase() { goto rqQYk; a7hNd: $json = (array) $json; goto LGukX; xA__B: $add_columns = []; goto WQVXd; LGqrf: $data = ["\144\x62" => $fields, "\x63\162\145\x61\x74\x65" => $create_tables, "\155\x6f\144\151\146\171" => $edit_columns, "\141\x64\144" => $add_columns, "\143\157\x75\156\x74\163" => $counts, "\x6a\163\x6f\156" => $json, "\143\165\x72\162\145\x6e\164" => $currentDb]; goto jlo2u; WQVXd: $edit_columns = []; goto xOBno; jlo2u: $this->output_json($data); goto z9buD; rqQYk: $db_debug = $this->db->db_debug; goto FJ1gC; yIVxs: oA4_e: goto YYNpT; ivvEz: $full_tables = array_merge($tbl_baru, $tbl_ada); goto C89No; q7Hbp: $tbl_ada = array_keys($fields); goto ivvEz; FJ1gC: $this->db->db_debug = FALSE; goto a_xFN; xOBno: foreach ($full_tables as $table) { goto wjp3q; wjp3q: if ($this->db->table_exists($table)) { goto UpKL7; } goto Ge1RU; nfIFw: goto dS2MZ; goto wqgEH; wqgEH: UpKL7: goto SK934; JQHTE: foreach ($json[$table] as $jtbl) { goto I9jIF; I9jIF: if ($this->db->field_exists($jtbl->name, $table)) { goto R_W3U; } goto MK1wz; LbzKO: mQn0R: goto Ipxf3; Z4r6o: foreach ($fields[$table] as $ftbl) { goto l5oMW; fOVXs: $edit_columns[$table][] = $jtbl; goto tjFfS; ErV0k: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto QDQcT; } goto fOVXs; Nk44Y: IU9H9: goto IX3XR; tjFfS: QDQcT: goto iCiBB; iCiBB: WHHi8: goto Nk44Y; l5oMW: if (!($jtbl->name == $ftbl->name)) { goto WHHi8; } goto ErV0k; IX3XR: } goto daUDj; Ipxf3: ttJuC: goto x3Rif; PnoVi: R_W3U: goto Z4r6o; aywnW: goto mQn0R; goto PnoVi; MK1wz: $add_columns[$table][] = $jtbl; goto aywnW; daUDj: OrI1_: goto LbzKO; x3Rif: } goto WQXZC; SK934: if (!isset($json[$table])) { goto qOEWh; } goto JQHTE; Ge1RU: $create_tables[$table] = $json[$table]; goto nfIFw; WQXZC: tHaNX: goto B48Vt; B48Vt: qOEWh: goto WG7iv; WG7iv: dS2MZ: goto XAnlx; XAnlx: mEndS: goto IIpeT; IIpeT: } goto TkUNi; OGp2p: $fields = []; goto ysL2I; a_xFN: $tabless = $this->db->list_tables(); goto OGp2p; x4cXB: $json = json_decode($json); goto a7hNd; fi7S8: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto LGqrf; LGukX: $tbl_baru = array_keys($json); goto q7Hbp; mQ72i: foreach ($tabless as $table) { goto Y1Zjw; oQDTP: $query = $query->result_object(); goto rTyey; l22bA: $retval[$i]->name = $query[$i]->column_name; goto duKIN; L9dth: $i++; goto zoL_3; rTyey: $retval = array(); goto EVM6S; LcYwG: $retval[$i] = new stdClass(); goto l22bA; gsJjG: YEUIc: goto LcYwG; Wl4qn: $fields[$table] = $datafld; goto jz13R; U2ggz: $datafld[$i]->auto_increment = true; goto aQ3uP; duKIN: $retval[$i]->extra = $query[$i]->extra; goto Bhah7; sQcXt: goto bM8Lr; goto fWTWX; jJEG3: $sql = "\123\105\114\105\103\124\40\x60\x63\157\154\165\x6d\156\137\156\x61\155\145\x60\54\40\x60\156\x75\x6d\145\x72\x69\x63\x5f\160\162\x65\143\151\x73\151\157\x6e\x60\54\40\x60\145\x78\164\x72\x61\140\54\x20\x60\x69\x73\137\x6e\165\154\154\x61\142\154\x65\140" . "\40\106\x52\117\x4d\40\x60\x69\156\x66\157\162\x6d\141\164\x69\x6f\x6e\137\x73\143\x68\x65\x6d\141\x60\56\x60\x63\x6f\x6c\165\x6d\156\163\x60\40\127\x48\x45\122\105\x20\x74\x61\142\x6c\x65\137\x73\143\150\145\155\x61\40\75\40\42" . $this->db->database . "\42\40\101\x4e\x44\40\164\141\x62\x6c\145\x5f\156\x61\x6d\145\x20\x3d\x20\42" . $table . "\42"; goto CJvGA; iWku5: $datafld[$i]->extra = $query[$i]->extra; goto sQcXt; x6QKn: q0OHn: goto gsJjG; G_vlJ: if ($query[$i]->extra == "\141\165\164\157\x5f\x69\156\x63\162\x65\155\145\156\x74") { goto c57FP; } goto iWku5; FWjmO: $currentDb[$table] = $retval; goto Wl4qn; AD6vR: $c = count($query); goto wUwRu; jz13R: cZYTt: goto fpT6m; J4IYP: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto YEUIc; } goto j0gZu; Bhah7: k7AuC: goto L9dth; XIQUi: cA3ve: goto oQDTP; aQ3uP: bM8Lr: goto x6QKn; Y1Zjw: $datafld = $this->db->field_data($table); goto jJEG3; EVM6S: $i = 0; goto AD6vR; Sk1MO: if (!($i < $c)) { goto TwEKc; } goto J4IYP; wUwRu: wZNyN: goto Sk1MO; WxRzO: $currentDb = FALSE; goto XIQUi; fWTWX: c57FP: goto U2ggz; j0gZu: if (!($query[$i]->extra != '')) { goto q0OHn; } goto G_vlJ; zoL_3: goto wZNyN; goto V1ebt; V1ebt: TwEKc: goto FWjmO; CJvGA: if (!(($query = $this->db->query($sql)) === FALSE)) { goto cA3ve; } goto WxRzO; fpT6m: } goto yIVxs; GWvXx: sort($full_tables); goto RqRk5; C89No: $full_tables = array_unique($full_tables); goto GWvXx; RqRk5: $create_tables = []; goto xA__B; YYNpT: $json = file_get_contents("\56\57\x61\x73\163\145\x74\163\57\x61\x70\160\x2f\x64\142\x2f\144\x61\164\141\142\x61\163\x65\56\152\163\157\x6e"); goto x4cXB; TkUNi: JCEAy: goto fi7S8; ysL2I: $currentDb = []; goto mQ72i; z9buD: } public function updateDatabase() { goto zCCNf; BTLCA: cCXpk: goto i9c2Z; zCCNf: $tabless = $this->db->list_tables(); goto crPl2; crPl2: $fields = []; goto UPEKI; i9c2Z: echo true; goto d6rSo; N69Dg: sort($full_tables); goto ESh0X; Idb1h: $tbl_ada = array_keys($fields); goto a0Wuz; Lw49d: $json = file_get_contents("\56\57\141\x73\x73\145\164\163\57\x61\160\x70\x2f\x64\x62\57\144\141\x74\x61\x62\141\x73\145\56\x6a\x73\157\156"); goto dSPRk; ESh0X: foreach ($full_tables as $table) { goto DprlM; DprlM: if ($this->db->table_exists($table)) { goto mQctO; } goto hyZrA; aOuCS: zJywq: goto AHjCK; hrOse: foreach ($json[$table] as $tbl => $jtbl) { goto pC2ZL; Cjr0J: $this->dbforge->add_key($jtbl->name, true); goto O58_J; OikXE: zQz64: goto Zzq4w; DxS2y: if (!($jtbl->primary_key == 1)) { goto xN1Qa; } goto Cjr0J; pC2ZL: $field = [$jtbl->name => ["\164\171\160\145" => $jtbl->type, "\143\157\x6e\163\164\x72\141\x69\x6e\x74" => $jtbl->max_length, "\156\165\x6c\154" => $jtbl->primary_key == 0]]; goto TJkha; O58_J: xN1Qa: goto OikXE; TJkha: $this->dbforge->add_field($field); goto DxS2y; Zzq4w: } goto R72Lf; a1Re8: LG2Hd: goto isOdt; hyZrA: if (!isset($json[$table])) { goto SHkrU; } goto hrOse; eGIuG: $this->dbforge->create_table($table, TRUE); goto Th2UG; HWeIc: foreach ($json[$table] as $jtbl) { goto YyKDE; SP2mn: goto umB34; goto BHnon; ZvuxO: $field = array($jtbl->name => array("\x74\171\x70\145" => $jtbl->type, "\143\157\x6e\x73\x74\x72\x61\x69\156\164" => $jtbl->max_length, "\x6e\x75\x6c\154" => false)); goto xWWpo; wrAJu: PpnqP: goto yu9VO; xWWpo: $this->dbforge->add_key($jtbl->name, true); goto n3doU; UZOXS: foreach ($fields[$table] as $ftbl) { goto z9nv5; wvWAl: sX0nw: goto oIfH5; tlwNp: mCwyZ: goto oV7om; efMeX: $this->dbforge->modify_column($table, $field); goto R4hid; ui9Jj: vTyYH: goto qlojl; ulNB7: Wcg9M: goto efMeX; XQ1WQ: $this->dbforge->add_key($jtbl->name, true); goto h8nfA; dX0k0: if ($jtbl->auto_increment == true) { goto B1rX1; } goto SFpLZ; KuP84: $field = array($jtbl->name => array("\164\x79\160\145" => $jtbl->type, "\143\157\x6e\x73\x74\x72\x61\151\x6e\x74" => $jtbl->max_length, "\144\145\x66\141\x75\154\164" => $jtbl->default)); goto HYzFR; JZNwx: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\x63\157\x6e\x73\164\x72\x61\151\156\x74" => $jtbl->max_length, "\156\165\x6c\154" => false, "\141\x75\x74\x6f\x5f\151\x6e\x63\162\x65\155\145\x6e\x74" => true)); goto DPgUl; ruiBg: B1rX1: goto JZNwx; wGNJ_: goto MDds1; goto wvWAl; SFpLZ: $field = array($jtbl->name => array("\x74\171\160\145" => $jtbl->type, "\143\157\x6e\x73\x74\x72\141\x69\x6e\164" => $jtbl->max_length, "\156\x75\x6c\154" => false)); goto TQWO8; oV7om: l26X2: goto hF4cZ; oIfH5: if ($jtbl->default == "\103\125\x52\122\x45\116\124\137\x54\111\x4d\x45\x53\124\x41\x4d\120") { goto vTyYH; } goto KuP84; HYzFR: goto Wcg9M; goto ui9Jj; hF4cZ: wc44T: goto V2vWY; X2Ypk: if ($jtbl->primary_key == 0) { goto sX0nw; } goto dX0k0; TQWO8: goto BFQpj; goto ruiBg; h8nfA: $this->dbforge->modify_column($table, $field); goto wGNJ_; Zvv0r: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto mCwyZ; } goto X2Ypk; z9nv5: if (!($jtbl->name == $ftbl->name)) { goto l26X2; } goto Zvv0r; R4hid: MDds1: goto tlwNp; kEAon: $field = array($jtbl->name . "\40\144\x61\164\145\x74\x69\155\145\x20\x64\x65\x66\x61\165\154\164\40\143\x75\162\162\x65\156\x74\x5f\x74\x69\155\x65\163\x74\x61\155\160" . $onUpdate); goto ulNB7; DPgUl: BFQpj: goto XQ1WQ; qlojl: $onUpdate = isset($jtbl->extra) ? "\40" . strtolower($jtbl->extra) : ''; goto kEAon; V2vWY: } goto wrAJu; E1cf8: umB34: goto WQ4HZ; yu9VO: gjZc1: goto yDDYE; s7Sdl: if ($jtbl->primary_key == 0) { goto U1zfh; } goto ZvuxO; n3doU: $this->dbforge->add_column($table, $field); goto SP2mn; rGMk4: WHodT: goto UZOXS; yDDYE: hO2hR: goto p9N0z; WQ4HZ: goto gjZc1; goto rGMk4; kTpnk: $field = array($jtbl->name => array("\164\171\x70\145" => $jtbl->type, "\x63\x6f\156\163\164\x72\x61\x69\156\164" => $jtbl->max_length, "\x64\145\x66\x61\165\154\164" => $jtbl->default)); goto VRyTN; VRyTN: $this->dbforge->add_column($table, $field); goto E1cf8; BHnon: U1zfh: goto kTpnk; YyKDE: if ($this->db->field_exists($jtbl->name, $table)) { goto WHodT; } goto s7Sdl; p9N0z: } goto YakaP; R72Lf: sF5hK: goto eGIuG; PuhxW: goto WMCGy; goto yh1Dq; YakaP: M1kza: goto aOuCS; AHjCK: WMCGy: goto a1Re8; Th2UG: $this->db->query("\101\x4c\124\x45\x52\40\124\101\102\114\105\x20\x20\x60" . $table . "\140\x20\x45\116\107\111\116\x45\40\75\x20\x49\156\156\157\x44\x42"); goto H6l_6; BMknV: if (!isset($json[$table])) { goto zJywq; } goto HWeIc; yh1Dq: mQctO: goto BMknV; H6l_6: SHkrU: goto PuhxW; isOdt: } goto BTLCA; fIZuf: $full_tables = array_unique($full_tables); goto N69Dg; DgD4z: $tbl_baru = array_keys($json); goto Idb1h; RuSym: $json = (array) $json; goto DgD4z; UPEKI: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); rIiUB: } goto lEhb9; a0Wuz: $full_tables = array_merge($tbl_baru, $tbl_ada); goto fIZuf; lEhb9: d268a: goto Lw49d; dSPRk: $json = json_decode($json); goto RuSym; d6rSo: } public function checkDb() { goto yWmW2; yWmW2: $db_debug = $this->db->db_debug; goto u8aa3; wV4L5: $add_columns = []; goto Z5aFv; holxs: $fields = []; goto XIi0e; fIJr6: foreach ($full_tables as $table) { goto VJA9S; NuRtY: $script .= $pri . "\51\x20\105\116\x47\111\x4e\x45\x3d\111\x6e\x6e\157\x44\102\40\104\x45\x46\x41\125\x4c\x54\40\x43\110\x41\122\x53\105\x54\x3d\165\164\146\70\155\x62\64\73"; goto bp2y0; H1Ca1: if (!isset($json[$table])) { goto xCM5B; } goto je96E; azOBd: foreach ($json[$table]->columns as $column) { goto qNCZl; wGTcz: oYcxy: goto vWxzQ; Ykl9_: giGbs: goto XS1qs; agowX: $default = $column->default == null ? '' : "\x20\x44\105\106\101\125\x4c\x54\x20" . $column->default; goto jlyna; jlyna: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto PmUr0; qNCZl: if ($column->max_length == null) { goto giGbs; } goto jLKrg; hEdob: goto R2ekE; goto IVJPj; yN3Gl: R2ekE: goto mabit; zwRKt: $pri .= $column->primary != '' ? "\120\x52\111\115\101\122\x59\x20\x4b\x45\x59\x20\x28\x60" . $column->name . "\140\x29" : ''; goto BjyRl; mabit: eAj04: goto vJmYa; MBTt1: goto eAj04; goto wGTcz; IVJPj: T6xBZ: goto FIqVu; o0G2y: goto eAj04; goto Ykl9_; vJmYa: $nullable = $column->nullable == "\116\x4f" ? "\x20\x4e\x4f\124\40\116\125\114\114" : ''; goto agowX; MVpQs: $script .= "\140" . $column->name . "\140\40" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\x20"; goto zwRKt; vWxzQ: if ($column->type == "\151\156\x74") { goto T6xBZ; } goto Q2zlu; BjyRl: XuBMM: goto w4GJD; XS1qs: $length = ''; goto MBTt1; Q2zlu: $length = "\x28" . $column->max_length . "\x29"; goto hEdob; FIqVu: $length = "\x28" . ($column->max_length + 1) . "\x29"; goto yN3Gl; jLKrg: if ($column->type != "\x6c\157\x6e\x67\164\x65\x78\x74" && $column->type != "\155\145\144\x69\165\155\x74\145\170\164" && $column->type != "\x74\145\x78\164") { goto oYcxy; } goto P22Dw; PmUr0: $comment = $column->comment == '' ? '' : "\x20\103\x4f\x4d\115\x45\x4e\124\40\47" . $column->comment . "\47"; goto MVpQs; P22Dw: $length = ''; goto o0G2y; w4GJD: } goto esdAL; e1P48: iUHZo: goto OVor0; HmCvc: goto eLPQV; goto n42uq; EoXhi: $create_tables[] = $json[$table]; goto BTebz; esdAL: GQ7bQ: goto NuRtY; bp2y0: $script_create_table[$table] = $script; goto S8_Jx; XZkjn: if (!(count($add_column) > 0)) { goto rY7hk; } goto IlEqE; SitX1: $script_edit_column[$table] = "\101\114\124\105\122\x20\124\101\102\114\x45\40\140" . $table . "\140\40" . implode("\x2c\40", $modif_column) . "\x3b"; goto zsGwg; n42uq: PYzS_: goto EoXhi; SfOOf: xCM5B: goto HmCvc; BTebz: $script = "\x43\122\x45\x41\124\x45\x20\124\x41\102\x4c\105\40\x60" . $table . "\x60\40\x28"; goto jXjJ9; je96E: $add_column = []; goto I5LPH; DUJZX: if (!(count($modif_column) > 0)) { goto L9AFn; } goto SitX1; Jmlh3: rY7hk: goto DUJZX; jXjJ9: $pri = ''; goto azOBd; I5LPH: $modif_column = []; goto a1TFz; S8_Jx: eLPQV: goto e1P48; LwiN2: IFpin: goto XZkjn; IlEqE: $script_create_column[$table] = "\x41\x4c\124\105\x52\40\124\x41\102\114\105\x20\x60" . $table . "\x60\40" . implode("\54\40", $add_column) . "\x3b"; goto Jmlh3; zsGwg: L9AFn: goto SfOOf; VJA9S: if (!$this->db->table_exists($table)) { goto PYzS_; } goto H1Ca1; a1TFz: foreach ($json[$table]->columns as $jtbl) { goto l4C3c; dMicD: fGrrb: goto kR584; b7rrr: E2QhW: goto PhpKl; u1vLV: if ($jtbl->type != "\x6c\157\x6e\147\164\145\170\x74" && $jtbl->type != "\x6d\145\x64\x69\165\155\164\145\170\164" && $jtbl->type != "\164\145\170\x74") { goto weuGs; } goto JbvEa; INx36: ipYc_: goto zIt9i; kR584: foreach ($fields[$table]->columns as $ftbl) { goto kRkBR; U1erh: $default = $jtbl->default == null ? '' : "\x20\x44\105\x46\101\125\x4c\124\40" . $jtbl->default; goto CHzsw; c7gDg: QYM7O: goto ou1VM; iTy4M: BLWe2: goto Cjt33; H1NEv: PmpRx: goto CuSQ9; SFkPT: K2O_G: goto ffgkr; RAeDp: if (!($ftbl->extra != null)) { goto Vc4gR; } goto tPVtg; OD8lO: j5Yed: goto K17Qe; fC67p: $comment = $jtbl->comment == '' ? '' : "\40\103\117\115\115\x45\116\x54\x20\47" . $jtbl->comment . "\47"; goto JDBJ8; ZLDg_: $edit_columns[$table][$jtbl->name]["\145\170\164\x72\141"] = $jtbl->extra; goto qE8Vc; vSlI5: cq7Lf: goto aC1il; xldYB: M9W2t: goto InvOA; iu0dD: $jtbl->extra = str_replace("\50\51", '', $jtbl->extra); goto YBcv_; ffgkr: if (!($jtbl->nullable != $ftbl->nullable)) { goto bQGwY; } goto zbwJ9; qE8Vc: ij7Fk: goto xWo0t; YBcv_: $jtbl->extra = strtoupper($jtbl->extra); goto Vo4JQ; PdlWK: goto j5Yed; goto H1NEv; dAexQ: $ftbl->default = str_replace("\x28\51", '', $ftbl->default); goto bqcFG; T8Xvi: if (!($jtbl->col_type != $ftbl->col_type)) { goto K2O_G; } goto dqwIT; MyfB_: $jtbl->default = strtoupper($jtbl->default); goto AbnDY; rObqD: $ftbl->extra = strtoupper($ftbl->extra); goto m8RnF; gEe0f: if (strtolower($jtbl->primary) == "\160\162\x69") { goto pjsdj; } goto QL0RF; NLT7k: if (!($ftbl->default != null)) { goto M9W2t; } goto dAexQ; F54Tt: goto j5Yed; goto qao_z; xYIZZ: if (!($jtbl->extra != null)) { goto lTToY; } goto iu0dD; Tlc0L: Ta2ct: goto xYIZZ; K0rQa: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto BLWe2; } goto RGIkt; CuSQ9: array_push($modif_column, "\x41\104\104\40\x55\116\111\x51\x55\x45\x20\113\x45\131\40\140" . $jtbl->name . "\x60\40\x28\x60" . $jtbl->name . "\x60\51"); goto OD8lO; m8RnF: Vc4gR: goto HAJz2; Cjt33: y9_Yk: goto vSlI5; InvOA: if (!($jtbl->default != $ftbl->default)) { goto Ta2ct; } goto OEqY8; CHzsw: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto fC67p; HAJz2: if (!($jtbl->extra != $ftbl->extra)) { goto ij7Fk; } goto ZLDg_; OEqY8: $edit_columns[$table][$jtbl->name]["\144\145\x66\141\165\154\x74"] = $jtbl->default; goto Tlc0L; R3zE9: $jtbl->default = str_replace("\x28\51", '', $jtbl->default); goto MyfB_; QL0RF: if (strtolower($jtbl->primary) == "\165\156\151") { goto PmpRx; } goto F54Tt; Z9oJX: $edit_columns[$table][$jtbl->name]["\143\x6f\155\155\x65\156\x74"] = $jtbl->comment; goto c7gDg; xWo0t: if (!($jtbl->comment != $ftbl->comment)) { goto QYM7O; } goto Z9oJX; kRkBR: if (!($jtbl->name == $ftbl->name)) { goto y9_Yk; } goto T8Xvi; zbwJ9: $edit_columns[$table][$jtbl->name]["\x6e\165\154\154\141\x62\x6c\x65"] = $jtbl->nullable; goto SryrG; K17Qe: KZZ5P: goto K0rQa; tPVtg: $ftbl->extra = str_replace("\x28\51", '', $ftbl->extra); goto rObqD; bqcFG: $ftbl->default = strtoupper($ftbl->default); goto xldYB; AbnDY: vx3BI: goto NLT7k; qao_z: pjsdj: goto FOVJj; JDBJ8: array_push($modif_column, "\x4d\117\x44\x49\106\131\40\140" . $jtbl->name . "\140\40" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto iTy4M; ou1VM: if (!($jtbl->primary != $ftbl->primary)) { goto KZZ5P; } goto hR3gn; dqwIT: $edit_columns[$table][$jtbl->name]["\x63\x6f\x6c\x5f\164\x79\x70\x65"] = $jtbl->col_type; goto SFkPT; Vo4JQ: lTToY: goto RAeDp; FOVJj: array_push($modif_column, "\101\x44\104\40\x50\x52\111\115\101\122\131\40\113\105\131\x20\x28\x60" . $jtbl->name . "\140\x29"); goto PdlWK; qaEnC: if (!($jtbl->default != null)) { goto vx3BI; } goto R3zE9; hR3gn: $edit_columns[$table][$jtbl->name]["\x70\x72\151\155\141\x72\x79"] = $jtbl->primary; goto gEe0f; SryrG: bQGwY: goto qaEnC; RGIkt: $nullable = $jtbl->nullable == "\116\117" ? "\x20\x4e\x4f\x54\40\x4e\x55\x4c\114" : ''; goto U1erh; aC1il: } goto J6_Ys; JbvEa: $length = ''; goto Qnzhf; aAgWY: array_push($add_column, "\x41\104\x44\x20\x60" . $jtbl->name . "\140\x20" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto dMicD; P1hJ5: $extra .= "\40\x50\x52\111\115\x41\x52\131\x20\x4b\x45\x59"; goto INx36; hlS0K: EQ1AX: goto pdRnV; OQIqV: if ($jtbl->max_length == null) { goto E2QhW; } goto u1vLV; h2ygK: ysbPO: goto daM6v; HoOaS: $length = "\50" . $jtbl->max_length . "\51"; goto YTmIS; PhpKl: $length = ''; goto kMw3l; E7yxg: $default = $jtbl->default == null ? '' : "\40\x44\x45\x46\x41\x55\114\124\40" . $jtbl->default; goto xXThF; PnirC: if ($jtbl->type == "\151\x6e\164") { goto gd52d; } goto HoOaS; v3bhG: $length = "\x28" . ($jtbl->max_length + 1) . "\x29"; goto hlS0K; xXThF: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto eW5FH; YTmIS: goto EQ1AX; goto bjWD7; Qnzhf: goto IUqYE; goto b7rrr; bjWD7: gd52d: goto v3bhG; eW5FH: if (!(strtoupper($extra) == "\40\x41\x55\124\117\137\111\116\103\x52\x45\x4d\x45\x4e\124")) { goto ipYc_; } goto P1hJ5; rkVtM: $add_columns[$table][] = $jtbl; goto OQIqV; J6_Ys: p9UNv: goto h2ygK; l4C3c: if ($this->db->field_exists($jtbl->name, $table)) { goto fGrrb; } goto rkVtM; kMw3l: goto IUqYE; goto xWTrN; xWTrN: weuGs: goto PnirC; zIt9i: $comment = $jtbl->comment == '' ? '' : "\40\103\117\x4d\115\x45\x4e\124\x20\x27" . $jtbl->comment . "\47"; goto aAgWY; r7abp: $nullable = $jtbl->nullable == "\x4e\x4f" ? "\40\116\x4f\124\x20\116\125\x4c\114" : ''; goto E7yxg; pdRnV: IUqYE: goto r7abp; daM6v: } goto LwiN2; OVor0: } goto OXgSn; GVlaI: $tbl_ada = array_keys($fields); goto qLFzT; B0U4r: $json = (array) $json; goto ankPV; jPmDD: jwLEH: goto ybqu6; OXgSn: QcOzh: goto n2whH; M_3E1: $json = json_decode($json); goto B0U4r; Z5aFv: $script_create_column = []; goto yDeTy; iA23P: $script_edit_column = []; goto fIJr6; yDeTy: $edit_columns = []; goto iA23P; qLFzT: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto CcNsN; u8aa3: $this->db->db_debug = FALSE; goto dwcnl; sqkqI: $data = ["\x66\x69\145\x6c\144\x73" => $fields, "\143\x72\145\x61\164\x65\x5f\164\x61\x62\154\x65\x73" => $create_tables, "\x63\x6f\x75\x6e\164\x5f\x74\x62\154" => count($create_tables), "\141\144\x64\x5f\143\x6f\x6c\x75\155\x6e\163\137\164\157\137\x74\141\142\x6c\145" => $add_columns, "\143\157\165\156\164\137\143\x6f\154" => count($add_columns), "\145\x64\151\164\x5f\143\157\154\x75\x6d\156\x73" => $edit_columns, "\143\x6f\x75\x6e\164\137\x6d\x6f\144" => count($edit_columns), "\x61\144\144\x5f\164\142\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\x61\x64\144\137\x63\157\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\x6f\144\137\x63\x6f\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto hwyC2; DSuR0: $create_tables = []; goto FHwYF; n2whH: $this->db->db_debug = $db_debug; goto sqkqI; ybqu6: $json = file_get_contents("\x2e\57\x61\x73\x73\x65\x74\x73\x2f\x61\x70\x70\x2f\144\142\57\144\141\x74\x61\x62\141\x73\x65\56\x6a\163\x6f\156"); goto M_3E1; ankPV: $tbl_seharusnya = array_keys($json); goto GVlaI; hwyC2: $this->output_json($data); goto IILUz; dwcnl: $tabless = $this->db->list_tables(); goto holxs; CcNsN: $full_tables = array_unique($full_tables); goto CdT1M; FHwYF: $script_create_table = []; goto wV4L5; CdT1M: sort($full_tables); goto DSuR0; XIi0e: foreach ($tabless as $table) { goto eebS3; C4RNQ: if (!(($query = $this->db->query($sql)) === FALSE)) { goto wIc9o; } goto JAGdN; PJVAN: $fields[$table] = (object) ["\x74\141\x62\x6c\x65\137\156\x61\155\x65" => $table, "\x63\x6f\154\x75\155\x6e\163" => $retval]; goto yya79; GexLt: KKcS5: goto qsQ1H; az0fE: $retval[$i] = new stdClass(); goto r_Peb; p0A6a: wIc9o: goto TU9Md; Ytk7P: $c = count($query); goto GexLt; vP49b: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto sgMpz; q5CGt: $i++; goto PrKDJ; PrKDJ: goto KKcS5; goto FW62g; JAGdN: $fields = FALSE; goto p0A6a; eebS3: $sql = "\x53\x45\x4c\105\103\124\x20\140\143\157\x6c\165\155\156\137\x6e\x61\155\x65\140\54\40\140\143\157\154\x75\155\156\x5f\164\x79\160\145\140\54\40\x60\143\x6f\x6c\154\x61\x74\151\157\x6e\137\156\x61\x6d\145\x60\54\40\x60\144\x61\164\141\137\164\171\x70\x65\x60\x2c\x20\140\143\x68\x61\x72\x61\x63\164\x65\162\x5f\155\141\170\151\155\x75\155\x5f\x6c\x65\x6e\x67\x74\x68\x60\x2c\40\140\x6e\165\155\x65\162\151\x63\x5f\160\162\145\143\151\163\x69\x6f\156\x60\x2c" . "\x20\x60\143\x6f\x6c\x75\x6d\x6e\x5f\x64\x65\x66\141\x75\154\x74\x60\54\40\140\x63\x6f\154\165\155\x6e\137\x6b\145\x79\x60\x2c\40\x60\x63\157\154\165\x6d\x6e\x5f\x63\x6f\x6d\x6d\x65\156\164\140\54\40\x60\145\x78\x74\x72\141\140\x2c\40\140\x69\163\137\x6e\165\154\x6c\141\x62\154\x65\x60\xd\12\11\11\11\x46\x52\117\x4d\40\140\x69\156\x66\x6f\162\x6d\x61\x74\151\157\156\x5f\163\x63\x68\145\155\141\x60\x2e\140\x63\157\154\165\155\x6e\163\x60\x20\x57\110\x45\122\x45\x20\x74\141\142\x6c\145\137\x73\x63\150\145\155\x61\40\75\40\x22" . $this->db->database . "\x22\40\101\116\104\40\x74\141\142\154\145\137\x6e\141\155\145\x20\75\x20\x22" . $table . "\x22"; goto C4RNQ; sgMpz: $retval[$i]->default = $query[$i]->column_default; goto FFwGC; qsQ1H: if (!($i < $c)) { goto Ftm8b; } goto az0fE; yya79: hsZ1s: goto NaiO_; d_Hyi: N5Hxf: goto q5CGt; r_Peb: $retval[$i]->name = $query[$i]->column_name; goto ojTF2; vJ3bw: $retval = array(); goto zbWYn; FFwGC: $retval[$i]->comment = $query[$i]->column_comment; goto W2PXy; TU9Md: $query = $query->result_object(); goto vJ3bw; FW62g: Ftm8b: goto PJVAN; zbWYn: $i = 0; goto Ytk7P; h2AOr: $retval[$i]->primary = $query[$i]->column_key; goto d_Hyi; f58aa: $retval[$i]->type = $query[$i]->data_type; goto dMsGW; dMsGW: $retval[$i]->collation = $query[$i]->collation_name; goto vP49b; ojTF2: $retval[$i]->col_type = $query[$i]->column_type; goto f58aa; h8yXT: $retval[$i]->nullable = $query[$i]->is_nullable; goto h2AOr; W2PXy: $retval[$i]->extra = $query[$i]->extra; goto h8yXT; NaiO_: } goto jPmDD; IILUz: } public function createTable() { goto KoNUp; OgiAD: $queries = ''; goto XC4Ya; Jv_Mw: $scripts = json_decode($this->encryption->decrypt($scripts)); goto OgiAD; TGrlw: HlSId: goto XrVd6; MAMZ3: $this->output_json($data); goto c_kgj; KoNUp: $scripts = $this->input->post("\x64\x61\164\141", true); goto yyMJ8; UKBZ3: $data["\x6d\145\163\163\141\x67\x65"] = "\x55\x70\144\141\x74\145\40\153\x6f\x6c\x6f\155"; goto MAMZ3; XC4Ya: foreach ($scripts as $script) { $queries .= $script; adv6A: } goto TGrlw; yyMJ8: str_replace("\x25\62\102", "\53", $scripts); goto YKCOr; XrVd6: $data["\x73\x75\x63\143\x65\x73\163"] = $this->runQuery($queries); goto UKBZ3; YKCOr: sleep(1); goto Jv_Mw; c_kgj: } public function createColumn() { goto Q_8oK; EUrQp: sleep(1); goto pfT7j; uMstv: $this->updateUID(); goto g0GPH; Q_8oK: $scripts = $this->input->post("\144\x61\164\x61", true); goto JKFa5; Va0PI: foreach ($scripts as $script) { $queries .= $script; FXhyp: } goto WXNPa; DZtWh: if (!(strpos("\x60\x75\x69\x64\x60", $queries) !== false)) { goto gNf0n; } goto uMstv; GSe3g: $data["\155\x65\163\x73\x61\x67\x65"] = "\x4d\157\144\151\146\x79\40\153\x6f\x6c\157\x6d"; goto zwI8Z; WXNPa: XdxTk: goto DZtWh; g0GPH: gNf0n: goto fZg2y; fZg2y: $data["\163\x75\x63\143\x65\x73\x73"] = $this->runQuery($queries); goto GSe3g; zwI8Z: $this->output_json($data); goto x0Ilf; d3uuS: $queries = ''; goto Va0PI; JKFa5: str_replace("\x25\x32\102", "\x2b", $scripts); goto EUrQp; pfT7j: $scripts = json_decode($this->encryption->decrypt($scripts)); goto d3uuS; x0Ilf: } public function editColumn() { goto mMnnB; GV60E: $data["\163\x75\143\x63\145\x73\x73"] = $this->runQuery($queries); goto srsyl; srsyl: $data["\155\145\x73\x73\x61\147\145"] = "\x55\x70\x64\x61\164\x65\40\163\145\x6c\x65\163\141\151"; goto uF9_C; mMnnB: $scripts = $this->input->post("\144\x61\x74\x61", true); goto WCuzR; cs9R8: sleep(1); goto Umf4c; Umf4c: $scripts = json_decode($this->encryption->decrypt($scripts)); goto BNT6x; WCuzR: str_replace("\45\x32\102", "\53", $scripts); goto cs9R8; lDCht: foreach ($scripts as $script) { $queries .= $script; NbVkl: } goto kut2a; kut2a: BDtXE: goto GV60E; BNT6x: $queries = ''; goto lDCht; uF9_C: $this->output_json($data); goto lmlPn; lmlPn: } function runQuery($script) { goto zY2eP; a5LgD: return true; goto YAFJz; Dr25w: $hostpass = $this->db->password; goto UfUCS; zY2eP: $hostname = $this->db->hostname; goto Pj3Ot; H9nV3: Lx0wW: goto P5E0X; cUHvJ: return mysqli_connect_errno(); goto H9nV3; HSNhU: if (!mysqli_connect_errno()) { goto Lx0wW; } goto cUHvJ; Pj3Ot: $hostuser = $this->db->username; goto Dr25w; P5E0X: $mysqli->multi_query($script); goto t1sNk; UfUCS: $database = $this->db->database; goto MLK8d; t1sNk: $mysqli->close(); goto a5LgD; MLK8d: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto HSNhU; YAFJz: } function updateUID() { goto Mdjcq; dLTUi: $input = array(); goto ko3S0; ko3S0: foreach ($siswas as $siswa) { $input[] = array("\x69\144\137\163\151\x73\167\x61" => $siswa->id_siswa, "\x75\x69\x64" => $this->uuid->v4()); r5HiP: } goto A5QKh; Mdjcq: $this->load->library("\x55\165\x69\x64", "\165\x75\x69\x64"); goto PgMrO; UJ50w: return $this->db->update_batch("\155\x61\163\164\x65\162\137\163\151\163\167\141", $input, "\x69\144\137\x73\151\163\x77\x61"); goto Lm8UO; PgMrO: $siswas = $this->db->get("\155\x61\163\x74\x65\162\137\163\151\163\x77\141")->result(); goto dLTUi; A5QKh: dNBYH: goto UJ50w; Lm8UO: } function make_base() { } }
