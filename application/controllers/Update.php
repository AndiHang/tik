<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\105\120\101\x54\x48") or exit("\116\157\40\144\151\162\145\143\164\40\163\x63\x72\151\160\164\x20\141\x63\x63\145\163\x73\40\x61\x6c\154\157\167\145\144"); class Update extends CI_Controller { function __construct() { goto QJT3_; JRwcL: $this->load->library("\x65\x6e\143\x72\171\x70\x74\x69\157\x6e"); goto nescR; c6inR: $this->load->dbforge(); goto ETRUM; ETRUM: $this->load->database(); goto JRwcL; QJT3_: parent::__construct(); goto rfV5I; rfV5I: include APPPATH . "\x63\x6f\x6e\146\x69\x67\57\x64\x61\164\x61\x62\141\x73\x65\56\160\x68\x70"; goto c6inR; nescR: } public function output_json($data, $encode = true) { goto lqE5V; lqE5V: if (!$encode) { goto vKjTn; } goto Ejipj; DbtiO: vKjTn: goto Q_o2x; Q_o2x: $this->output->set_content_type("\x61\x70\x70\x6c\151\143\x61\164\x69\157\156\x2f\x6a\x73\x6f\x6e")->set_output($data); goto qAozA; Ejipj: $data = json_encode($data); goto DbtiO; qAozA: } public function index() { goto zrwNB; DtJdM: $data["\x6a\x73\157\156"] = $json; goto uDABl; uDABl: $this->load->view("\151\x6e\x73\x74\141\x6c\154\57\x68\x65\x61\144\x65\x72", $data); goto pvsbK; fprBZ: $json = json_decode($json); goto IGrhi; zrwNB: $json = file_get_contents("\56\57\x61\x73\x73\x65\164\x73\57\x61\160\x70\x2f\x64\x62\x2f\x64\x61\164\x61\142\141\163\145\56\152\x73\x6f\x6e"); goto fprBZ; mK1b8: $this->load->view("\x69\156\x73\164\x61\x6c\x6c\57\x66\x6f\157\x74\x65\x72"); goto DlmpU; IGrhi: $json = (array) $json; goto DtJdM; pvsbK: $this->load->view("\x69\156\163\164\x61\154\154\x2f\x75\x70\x64\x61\x74\145"); goto mK1b8; DlmpU: } function object_to_array($data) { goto R8Odk; R8Odk: if (!(is_array($data) || is_object($data))) { goto bs48x; } goto BL8gm; Lxpjd: xPPSf: goto MZ132; V1fwL: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; FCJDz: } goto Lxpjd; BL8gm: $result = []; goto V1fwL; PmGdW: return $data; goto kf8Vd; MZ132: return $result; goto oWXEW; oWXEW: bs48x: goto PmGdW; kf8Vd: } public function checkDatabase() { goto Vb65V; eGnb9: $fields = []; goto EAjsF; Qxrss: $full_tables = array_unique($full_tables); goto kok9J; bu4yK: $full_tables = array_merge($tbl_baru, $tbl_ada); goto Qxrss; N3FeH: $json = (array) $json; goto Qf1Dg; LRr7y: FG3Wj: goto T747L; upNCg: $json = json_decode($json); goto N3FeH; BF65l: $this->output_json($data); goto cdkDW; PeRYd: foreach ($tabless as $table) { goto PbY9P; ASit6: pUIDd: goto S9K3H; CVG0L: if (!($query[$i]->extra != '')) { goto yOsN_; } goto Adkbz; soMgC: $i++; goto ea9kF; aE2pK: $query = $query->result_object(); goto iAhME; Tc9xp: $retval[$i]->extra = $query[$i]->extra; goto GiHy7; he_xg: if (!($i < $c)) { goto aI0Oq; } goto uwNNK; q2xpR: $retval[$i] = new stdClass(); goto No8yW; yJvlW: aI0Oq: goto tfr6e; ea9kF: goto j0hzJ; goto yJvlW; gSAPU: ByZ9i: goto lF0x9; nvgYg: $c = count($query); goto oCQL3; No8yW: $retval[$i]->name = $query[$i]->column_name; goto Tc9xp; LZyk_: q3P4o: goto T6Uqd; kwISj: $i = 0; goto nvgYg; GiHy7: S1pGZ: goto soMgC; pQzYK: $sql = "\x53\105\x4c\105\103\x54\x20\140\143\157\x6c\x75\x6d\156\x5f\156\x61\x6d\x65\140\x2c\40\140\x6e\165\155\x65\x72\151\143\137\160\x72\145\143\151\x73\x69\157\156\140\x2c\x20\140\145\170\x74\162\x61\140\54\x20\140\151\x73\137\156\x75\x6c\154\x61\x62\x6c\145\140" . "\40\x46\122\x4f\x4d\x20\140\151\x6e\x66\157\x72\x6d\x61\164\x69\x6f\x6e\x5f\163\143\150\145\155\141\140\56\140\x63\x6f\154\165\x6d\156\163\x60\40\x57\110\x45\x52\x45\40\164\x61\142\x6c\145\x5f\x73\143\x68\x65\x6d\x61\x20\75\x20\42" . $this->db->database . "\42\x20\101\x4e\x44\x20\x74\141\142\154\x65\137\x6e\141\155\145\40\x3d\x20\x22" . $table . "\42"; goto Ng88z; S9K3H: yOsN_: goto I3RbB; PbY9P: $datafld = $this->db->field_data($table); goto pQzYK; I3RbB: IC7ia: goto q2xpR; uwNNK: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto IC7ia; } goto CVG0L; Q9fbm: $fields[$table] = $datafld; goto gSAPU; pv_Nk: goto pUIDd; goto LZyk_; uXpXV: IiI7o: goto aE2pK; tfr6e: $currentDb[$table] = $retval; goto Q9fbm; rwjN_: $currentDb = FALSE; goto uXpXV; iAhME: $retval = array(); goto kwISj; Adkbz: if ($query[$i]->extra == "\x61\x75\x74\157\137\x69\x6e\143\x72\x65\155\145\x6e\x74") { goto q3P4o; } goto okwOs; T6Uqd: $datafld[$i]->auto_increment = true; goto ASit6; Ng88z: if (!(($query = $this->db->query($sql)) === FALSE)) { goto IiI7o; } goto rwjN_; okwOs: $datafld[$i]->extra = $query[$i]->extra; goto pv_Nk; oCQL3: j0hzJ: goto he_xg; lF0x9: } goto RanJR; RanJR: xgVxM: goto ycigR; C2Z3S: $tabless = $this->db->list_tables(); goto eGnb9; v7905: $this->db->db_debug = FALSE; goto C2Z3S; pILu6: $tbl_ada = array_keys($fields); goto bu4yK; kok9J: sort($full_tables); goto fSpjN; Qf1Dg: $tbl_baru = array_keys($json); goto pILu6; T747L: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto nJZny; vozQE: $add_columns = []; goto VxhGn; ycigR: $json = file_get_contents("\x2e\57\141\x73\x73\145\164\x73\x2f\141\160\160\x2f\144\142\x2f\x64\141\x74\141\142\141\163\x65\x2e\152\x73\157\x6e"); goto upNCg; nJZny: $data = ["\x64\142" => $fields, "\143\162\145\x61\x74\x65" => $create_tables, "\x6d\x6f\144\x69\x66\x79" => $edit_columns, "\x61\x64\x64" => $add_columns, "\x63\x6f\165\x6e\164\163" => $counts, "\152\x73\157\156" => $json, "\143\x75\x72\x72\x65\x6e\164" => $currentDb]; goto BF65l; fSpjN: $create_tables = []; goto vozQE; VxhGn: $edit_columns = []; goto BiTea; EAjsF: $currentDb = []; goto PeRYd; Vb65V: $db_debug = $this->db->db_debug; goto v7905; BiTea: foreach ($full_tables as $table) { goto L15Nm; tQRFy: CM1c5: goto qhcna; EcNZi: if (!isset($json[$table])) { goto CM1c5; } goto gzaqL; gzaqL: foreach ($json[$table] as $jtbl) { goto U2e5D; RYf1L: foreach ($fields[$table] as $ftbl) { goto L_mht; deGba: P9z2_: goto smvoK; L_mht: if (!($jtbl->name == $ftbl->name)) { goto Lt692; } goto esvfR; smvoK: Lt692: goto u6o0P; u6o0P: YoFwA: goto s5zHV; uW2fN: $edit_columns[$table][] = $jtbl; goto deGba; esvfR: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto P9z2_; } goto uW2fN; s5zHV: } goto EfdhH; m9px6: R86kJ: goto eEUtu; U2e5D: if ($this->db->field_exists($jtbl->name, $table)) { goto u_GBY; } goto pyiN6; Hpxuo: kJ1GM: goto m9px6; pyiN6: $add_columns[$table][] = $jtbl; goto DyAx6; DyAx6: goto kJ1GM; goto syOoF; syOoF: u_GBY: goto RYf1L; EfdhH: YksoA: goto Hpxuo; eEUtu: } goto xNfro; qhcna: CjhGe: goto wIcRx; ol3wT: goto CjhGe; goto UhW4e; wIcRx: svRI9: goto BIQSS; GiSM3: $create_tables[$table] = $json[$table]; goto ol3wT; L15Nm: if ($this->db->table_exists($table)) { goto OzQnZ; } goto GiSM3; UhW4e: OzQnZ: goto EcNZi; xNfro: qdcak: goto tQRFy; BIQSS: } goto LRr7y; cdkDW: } public function updateDatabase() { goto VbA69; qWWUD: $tbl_baru = array_keys($json); goto COZlk; VOihh: $full_tables = array_merge($tbl_baru, $tbl_ada); goto uHASe; ts_Ju: $fields = []; goto wskFL; COZlk: $tbl_ada = array_keys($fields); goto VOihh; Gouo9: Q1nlK: goto X06pH; Na1og: foreach ($full_tables as $table) { goto aeIa1; GqJJb: if (!isset($json[$table])) { goto K5YDg; } goto Zyyj9; ZE6LA: A9NOd: goto UvJzt; Al26I: RCfWP: goto kG4yW; I51RE: if (!isset($json[$table])) { goto kOeqS; } goto upvAV; wmIsy: agpyf: goto GqJJb; njzBX: kOeqS: goto wzX_O; UvJzt: $this->dbforge->create_table($table, TRUE); goto O4KGX; Zyyj9: foreach ($json[$table] as $jtbl) { goto RISsl; lDrIz: $field = array($jtbl->name => array("\164\171\160\145" => $jtbl->type, "\143\157\x6e\163\x74\162\x61\151\x6e\x74" => $jtbl->max_length, "\144\145\146\x61\165\154\x74" => $jtbl->default)); goto EyiNO; bpepS: MbcAy: goto A0wP7; sn1Vr: $field = array($jtbl->name => array("\164\171\x70\x65" => $jtbl->type, "\x63\157\x6e\x73\164\162\141\151\156\164" => $jtbl->max_length, "\156\165\x6c\154" => false)); goto U0gON; kDu_o: hmHbK: goto bpepS; EyiNO: $this->dbforge->add_column($table, $field); goto TVu7s; mff7n: if ($jtbl->primary_key == 0) { goto LjYVf; } goto sn1Vr; YJRHj: LjYVf: goto lDrIz; U0gON: $this->dbforge->add_key($jtbl->name, true); goto ir18W; awEii: FYKwJ: goto dKUsb; dKUsb: foreach ($fields[$table] as $ftbl) { goto fsH0J; lsiJt: goto KG021; goto OjJI3; TJSun: if ($jtbl->primary_key == 0) { goto qLyZ5; } goto K8Mw1; wz5YL: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto EeFaC; StCC4: lKs0D: goto wz5YL; K8Mw1: if ($jtbl->auto_increment == true) { goto wzg02; } goto DcoOT; OGF6f: xwlwh: goto JfINX; LHsDg: BU0iM: goto Vw1Qf; EeFaC: $field = array($jtbl->name . "\40\144\x61\164\145\x74\151\155\145\40\144\145\x66\141\x75\154\x74\x20\143\x75\x72\x72\x65\x6e\164\137\164\x69\x6d\x65\163\164\141\155\x70" . $onUpdate); goto d5FHX; KrWh8: if ($jtbl->default == "\103\x55\122\122\x45\116\124\137\124\111\x4d\x45\123\124\x41\x4d\x50") { goto lKs0D; } goto JTsKu; tNywE: $this->dbforge->modify_column($table, $field); goto iZRfk; VguJk: KG021: goto SFt9C; AAf2W: $field = array($jtbl->name => array("\164\171\160\x65" => $jtbl->type, "\143\x6f\156\x73\164\x72\141\151\156\x74" => $jtbl->max_length, "\x6e\x75\154\x6c" => false, "\141\165\x74\157\137\x69\x6e\x63\x72\x65\155\x65\x6e\x74" => true)); goto VguJk; qOR3W: qLyZ5: goto KrWh8; lVVOz: goto MaPy1; goto qOR3W; OjJI3: wzg02: goto AAf2W; JfINX: BUDeC: goto LHsDg; SFt9C: $this->dbforge->add_key($jtbl->name, true); goto Wsdur; JTsKu: $field = array($jtbl->name => array("\164\x79\x70\x65" => $jtbl->type, "\x63\x6f\x6e\163\x74\x72\141\x69\x6e\x74" => $jtbl->max_length, "\x64\145\146\x61\165\154\x74" => $jtbl->default)); goto g_5qi; d5FHX: fu7Ln: goto tNywE; g_5qi: goto fu7Ln; goto StCC4; Wsdur: $this->dbforge->modify_column($table, $field); goto lVVOz; Zk_61: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto xwlwh; } goto TJSun; DcoOT: $field = array($jtbl->name => array("\164\171\x70\145" => $jtbl->type, "\143\157\156\x73\164\x72\x61\x69\156\164" => $jtbl->max_length, "\156\x75\x6c\x6c" => false)); goto lsiJt; iZRfk: MaPy1: goto OGF6f; fsH0J: if (!($jtbl->name == $ftbl->name)) { goto BUDeC; } goto Zk_61; Vw1Qf: } goto RifCX; RifCX: cKvK5: goto kDu_o; TVu7s: C7BXg: goto MMZNx; MMZNx: goto hmHbK; goto awEii; ir18W: $this->dbforge->add_column($table, $field); goto z3lAM; RISsl: if ($this->db->field_exists($jtbl->name, $table)) { goto FYKwJ; } goto mff7n; z3lAM: goto C7BXg; goto YJRHj; A0wP7: } goto Wx8Ex; HZHzJ: K5YDg: goto Al26I; kG4yW: ltTZF: goto FUdN7; Wx8Ex: t01eh: goto HZHzJ; O4KGX: $this->db->query("\x41\x4c\x54\105\x52\40\124\101\102\114\105\40\40\140" . $table . "\x60\x20\105\x4e\107\111\116\x45\x20\75\x20\x49\156\x6e\157\104\x42"); goto njzBX; wzX_O: goto RCfWP; goto wmIsy; upvAV: foreach ($json[$table] as $tbl => $jtbl) { goto XsorS; XjoHY: hN_CY: goto uVM25; c3ZTO: $this->dbforge->add_key($jtbl->name, true); goto pHq1Z; TdbkH: $this->dbforge->add_field($field); goto O1kPY; pHq1Z: xA7GE: goto XjoHY; XsorS: $field = [$jtbl->name => ["\164\x79\x70\x65" => $jtbl->type, "\x63\x6f\x6e\163\164\162\141\x69\x6e\164" => $jtbl->max_length, "\x6e\165\154\154" => $jtbl->primary_key == 0]]; goto TdbkH; O1kPY: if (!($jtbl->primary_key == 1)) { goto xA7GE; } goto c3ZTO; uVM25: } goto ZE6LA; aeIa1: if ($this->db->table_exists($table)) { goto agpyf; } goto I51RE; FUdN7: } goto HHgr1; VbA69: $tabless = $this->db->list_tables(); goto ts_Ju; wskFL: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); xvq4V: } goto Gouo9; uHASe: $full_tables = array_unique($full_tables); goto glFWL; HHgr1: elJ14: goto Iz_kF; X06pH: $json = file_get_contents("\x2e\x2f\141\163\x73\x65\x74\x73\57\x61\160\160\57\144\x62\x2f\144\x61\164\141\x62\x61\163\145\x2e\x6a\x73\157\x6e"); goto F5qui; uFev8: $json = (array) $json; goto qWWUD; Iz_kF: echo true; goto bm1Gc; glFWL: sort($full_tables); goto Na1og; F5qui: $json = json_decode($json); goto uFev8; bm1Gc: } public function checkDb() { goto AP0aB; Zedqk: $json = json_decode($json); goto I8Y6t; U7hwf: $this->output_json($data); goto NuWfp; acVo0: $edit_columns = []; goto pUBHq; oIgtF: $script_create_column = []; goto acVo0; AFgut: foreach ($tabless as $table) { goto LpmYB; Dq0mU: $i = 0; goto ByokJ; zIWM1: $retval[$i]->default = $query[$i]->column_default; goto YNHh5; fvStU: if (!($i < $c)) { goto cSnTi; } goto oU3GS; oPwVJ: $fields[$table] = (object) ["\164\x61\142\x6c\x65\x5f\x6e\x61\155\x65" => $table, "\143\x6f\154\165\x6d\156\163" => $retval]; goto HFjKK; D5ivq: $retval[$i]->nullable = $query[$i]->is_nullable; goto ldAph; uDVRq: $retval[$i]->extra = $query[$i]->extra; goto D5ivq; HFjKK: HL4Pd: goto pHOK0; dN0cT: $retval = array(); goto Dq0mU; mzua0: $retval[$i]->collation = $query[$i]->collation_name; goto TBY5N; bDMD5: goto VKUgQ; goto D7efw; oU3GS: $retval[$i] = new stdClass(); goto NWBDb; ldAph: $retval[$i]->primary = $query[$i]->column_key; goto GFvCi; nMQeN: if (!(($query = $this->db->query($sql)) === FALSE)) { goto geaCF; } goto rZL53; owmSM: $i++; goto bDMD5; rgLzr: VKUgQ: goto fvStU; LpmYB: $sql = "\123\105\114\105\x43\124\x20\x60\143\157\154\x75\155\x6e\x5f\156\x61\155\145\x60\x2c\40\x60\x63\157\154\x75\155\156\x5f\x74\171\x70\x65\140\x2c\40\140\x63\x6f\x6c\154\141\x74\x69\x6f\156\x5f\x6e\141\155\145\x60\54\x20\x60\x64\x61\x74\141\137\164\171\160\145\x60\54\x20\x60\x63\150\141\x72\141\x63\164\x65\162\x5f\x6d\x61\x78\151\x6d\165\155\137\154\145\x6e\x67\x74\150\140\x2c\40\x60\x6e\x75\x6d\x65\x72\151\x63\x5f\160\x72\145\143\x69\163\x69\157\156\140\x2c" . "\40\x60\x63\157\x6c\165\155\156\137\144\145\x66\x61\165\154\x74\x60\54\x20\140\143\x6f\x6c\165\x6d\156\137\153\x65\x79\x60\x2c\x20\140\x63\x6f\x6c\x75\x6d\156\137\143\157\x6d\155\145\156\164\x60\54\x20\x60\145\x78\x74\x72\x61\x60\x2c\x20\x60\151\x73\137\156\x75\x6c\x6c\x61\142\154\x65\140\15\xa\11\11\x9\x46\x52\117\x4d\x20\140\x69\x6e\x66\157\x72\x6d\141\x74\151\x6f\156\137\163\143\150\x65\x6d\x61\140\56\140\143\x6f\x6c\165\x6d\156\x73\140\40\x57\110\105\122\105\40\164\141\x62\x6c\145\x5f\163\x63\x68\145\155\141\40\x3d\x20\x22" . $this->db->database . "\42\x20\101\x4e\104\40\x74\141\x62\154\145\137\156\141\x6d\x65\40\x3d\40\x22" . $table . "\42"; goto nMQeN; bli5L: geaCF: goto EH9hL; ByokJ: $c = count($query); goto rgLzr; EH9hL: $query = $query->result_object(); goto dN0cT; GFvCi: LN9ST: goto owmSM; rZL53: $fields = FALSE; goto bli5L; XV60V: $retval[$i]->type = $query[$i]->data_type; goto mzua0; TBY5N: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto zIWM1; RoP8r: $retval[$i]->col_type = $query[$i]->column_type; goto XV60V; D7efw: cSnTi: goto oPwVJ; NWBDb: $retval[$i]->name = $query[$i]->column_name; goto RoP8r; YNHh5: $retval[$i]->comment = $query[$i]->column_comment; goto uDVRq; pHOK0: } goto qaDZc; cYGp7: $full_tables = array_unique($full_tables); goto Va_9s; xUQBw: $tabless = $this->db->list_tables(); goto HUUuH; TtXtv: $this->db->db_debug = FALSE; goto xUQBw; m7Pg8: $tbl_seharusnya = array_keys($json); goto YLfcO; qaDZc: rbpSs: goto vj7v1; pUBHq: $script_edit_column = []; goto n9Gnr; n9Gnr: foreach ($full_tables as $table) { goto dOeAZ; sqrKc: $script_create_table[$table] = $script; goto uyKtT; cmMAy: if (!(count($add_column) > 0)) { goto SCl3b; } goto S3uUM; V1erF: LZDBw: goto wIg5S; DjIhW: YCxKP: goto cmMAy; W1w9O: foreach ($json[$table]->columns as $jtbl) { goto CJU4G; R9_A4: $length = "\x28" . $jtbl->max_length . "\51"; goto qJPSi; CJU4G: if ($this->db->field_exists($jtbl->name, $table)) { goto LxSlc; } goto nYSi5; ByL0i: if (!(strtoupper($extra) == "\40\101\125\x54\117\x5f\111\x4e\103\x52\105\115\105\x4e\x54")) { goto ITrwO; } goto OJJl5; eRdDH: TEEuE: goto osXUA; uKal6: E8fzm: goto eRdDH; vaCMn: MErme: goto ypo1D; qJPSi: goto FfrC9; goto vaCMn; re5RJ: $default = $jtbl->default == null ? '' : "\40\104\105\x46\101\x55\x4c\x54\40" . $jtbl->default; goto f7Zu2; GsoAx: foreach ($fields[$table]->columns as $ftbl) { goto QI1lQ; IIv8y: array_push($modif_column, "\101\x44\104\40\120\x52\x49\x4d\x41\122\131\x20\113\105\131\40\50\140" . $jtbl->name . "\x60\51"); goto YwhvH; YwhvH: goto q3LHJ; goto nUwoG; NJzFl: wDGqR: goto ZpLtq; Pa2iX: $jtbl->extra = str_replace("\x28\x29", '', $jtbl->extra); goto BX5RW; Ox8s9: $default = $jtbl->default == null ? '' : "\x20\x44\105\106\101\x55\114\124\40" . $jtbl->default; goto EYX6D; O6v0K: $edit_columns[$table][$jtbl->name]["\160\x72\151\155\x61\162\x79"] = $jtbl->primary; goto bZ_ZO; MKO0o: Qha1p: goto dm8Iv; vaGn3: if (!($jtbl->nullable != $ftbl->nullable)) { goto XXaxk; } goto jVglW; mW3Sc: q3LHJ: goto jxWMy; psM2Y: if (!($jtbl->extra != null)) { goto Ev8pM; } goto Pa2iX; Tc_3H: mrfiY: goto CYxiG; gxfPs: psDhk: goto psM2Y; S1P8m: if (!($jtbl->comment != $ftbl->comment)) { goto mrfiY; } goto AtadI; jxWMy: a6in7: goto YtdWx; Qyp7_: $jtbl->default = strtoupper($jtbl->default); goto VM1Be; EYX6D: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto db5IX; QI1lQ: if (!($jtbl->name == $ftbl->name)) { goto Qha1p; } goto jcjCz; YtdWx: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto iDeyF; } goto R2HjD; K1lAC: rjJ8W: goto vaGn3; qiTsM: if (!($ftbl->extra != null)) { goto wDGqR; } goto zN2WT; hnHm1: $edit_columns[$table][$jtbl->name]["\x65\x78\164\x72\x61"] = $jtbl->extra; goto TuOSe; db5IX: $comment = $jtbl->comment == '' ? '' : "\40\103\x4f\115\x4d\x45\x4e\124\40\x27" . $jtbl->comment . "\47"; goto pIlU4; CINuf: if (!($jtbl->default != null)) { goto WWYKR; } goto rwckz; MxLtu: Ev8pM: goto qiTsM; xeon6: $edit_columns[$table][$jtbl->name]["\x63\157\154\137\x74\171\x70\145"] = $jtbl->col_type; goto K1lAC; S4mEP: array_push($modif_column, "\101\x44\104\x20\125\x4e\x49\121\x55\x45\40\x4b\x45\131\40\x60" . $jtbl->name . "\x60\40\x28\x60" . $jtbl->name . "\x60\51"); goto mW3Sc; HoNUU: $ftbl->default = str_replace("\50\51", '', $ftbl->default); goto weflh; zN2WT: $ftbl->extra = str_replace("\50\x29", '', $ftbl->extra); goto JZRXx; VM1Be: WWYKR: goto Viogu; BX5RW: $jtbl->extra = strtoupper($jtbl->extra); goto MxLtu; oTgQ7: iDeyF: goto MKO0o; qjupg: if (!($jtbl->default != $ftbl->default)) { goto psDhk; } goto o8bAK; JZRXx: $ftbl->extra = strtoupper($ftbl->extra); goto NJzFl; zBLmQ: GfyId: goto IIv8y; df7Ad: qUAb1: goto qjupg; Viogu: if (!($ftbl->default != null)) { goto qUAb1; } goto HoNUU; CYxiG: if (!($jtbl->primary != $ftbl->primary)) { goto a6in7; } goto O6v0K; jVglW: $edit_columns[$table][$jtbl->name]["\156\165\154\x6c\141\x62\154\x65"] = $jtbl->nullable; goto eFZ0b; bZ_ZO: if (strtolower($jtbl->primary) == "\160\x72\151") { goto GfyId; } goto Mv4H8; upxb0: goto q3LHJ; goto zBLmQ; ZpLtq: if (!($jtbl->extra != $ftbl->extra)) { goto c66ag; } goto hnHm1; rwckz: $jtbl->default = str_replace("\x28\51", '', $jtbl->default); goto Qyp7_; dm8Iv: kQj_X: goto xJ7lu; TuOSe: c66ag: goto S1P8m; nUwoG: UJY4n: goto S4mEP; pIlU4: array_push($modif_column, "\115\x4f\104\x49\106\131\x20\140" . $jtbl->name . "\x60\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto oTgQ7; Mv4H8: if (strtolower($jtbl->primary) == "\165\x6e\x69") { goto UJY4n; } goto upxb0; eFZ0b: XXaxk: goto CINuf; jcjCz: if (!($jtbl->col_type != $ftbl->col_type)) { goto rjJ8W; } goto xeon6; R2HjD: $nullable = $jtbl->nullable == "\x4e\117" ? "\x20\x4e\117\124\x20\x4e\125\114\x4c" : ''; goto Ox8s9; o8bAK: $edit_columns[$table][$jtbl->name]["\x64\x65\x66\x61\165\x6c\164"] = $jtbl->default; goto gxfPs; AtadI: $edit_columns[$table][$jtbl->name]["\143\x6f\x6d\x6d\x65\x6e\164"] = $jtbl->comment; goto Tc_3H; weflh: $ftbl->default = strtoupper($ftbl->default); goto df7Ad; xJ7lu: } goto uKal6; f0Y2M: if ($jtbl->max_length == null) { goto lFFbB; } goto BhVMU; V0deI: array_push($add_column, "\x41\x44\x44\40\140" . $jtbl->name . "\x60\x20" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto xYPJk; JnTsl: ig6ys: goto QCEOk; bgUz3: PJI8M: goto x3SiG; zn7vn: goto ig6ys; goto bgUz3; p33C5: $length = ''; goto JdQ6V; OJJl5: $extra .= "\x20\120\x52\111\115\x41\x52\131\x20\113\x45\131"; goto htq2H; TURNf: FfrC9: goto JnTsl; f7Zu2: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto ByL0i; ypo1D: $length = "\x28" . ($jtbl->max_length + 1) . "\51"; goto TURNf; ZvvQp: $comment = $jtbl->comment == '' ? '' : "\40\103\x4f\115\x4d\x45\x4e\x54\x20\47" . $jtbl->comment . "\x27"; goto V0deI; xYPJk: LxSlc: goto GsoAx; JdQ6V: goto ig6ys; goto M6YB0; nYSi5: $add_columns[$table][] = $jtbl; goto f0Y2M; htq2H: ITrwO: goto ZvvQp; QCEOk: $nullable = $jtbl->nullable == "\x4e\x4f" ? "\x20\x4e\117\x54\40\x4e\x55\x4c\x4c" : ''; goto re5RJ; BhVMU: if ($jtbl->type != "\154\x6f\156\x67\164\145\x78\164" && $jtbl->type != "\155\x65\144\x69\165\x6d\164\145\170\x74" && $jtbl->type != "\x74\x65\x78\x74") { goto PJI8M; } goto p33C5; M6YB0: lFFbB: goto mSBC0; mSBC0: $length = ''; goto zn7vn; x3SiG: if ($jtbl->type == "\151\x6e\x74") { goto MErme; } goto R9_A4; osXUA: } goto DjIhW; MnAVO: if (!(count($modif_column) > 0)) { goto QDRdS; } goto qtkEL; dOeAZ: if (!$this->db->table_exists($table)) { goto g3tGQ; } goto XEFXz; yy27H: foreach ($json[$table]->columns as $column) { goto gMiAc; Peeaa: goto Jk636; goto A1eJg; gMiAc: if ($column->max_length == null) { goto Wgvtz; } goto IDbzu; aSBPU: $pri .= $column->primary != '' ? "\120\x52\x49\x4d\x41\x52\x59\40\113\105\x59\40\50\140" . $column->name . "\140\51" : ''; goto zLgfA; zLgfA: GHuwu: goto Nvvv5; HVRwq: Wgvtz: goto eZ8Tl; IDbzu: if ($column->type != "\154\x6f\156\147\x74\x65\170\164" && $column->type != "\155\145\144\x69\x75\155\x74\145\170\x74" && $column->type != "\x74\x65\170\x74") { goto q0MIq; } goto FnMRZ; S59UQ: $default = $column->default == null ? '' : "\x20\x44\x45\x46\101\x55\114\124\40" . $column->default; goto fO31B; V_vNN: uhYBp: goto laKAE; fO31B: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto cP2ep; eZ8Tl: $length = ''; goto Peeaa; FnMRZ: $length = ''; goto YLAcS; YLAcS: goto Jk636; goto HVRwq; rwNiY: $length = "\x28" . ($column->max_length + 1) . "\51"; goto V_vNN; luY29: $script .= "\140" . $column->name . "\140\x20" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\40"; goto aSBPU; ni6lW: H8mqb: goto rwNiY; cP2ep: $comment = $column->comment == '' ? '' : "\40\103\117\x4d\115\105\116\x54\40\x27" . $column->comment . "\47"; goto luY29; X30ed: if ($column->type == "\x69\156\x74") { goto H8mqb; } goto Nhev_; rpkwX: $nullable = $column->nullable == "\116\x4f" ? "\x20\116\x4f\x54\40\116\125\x4c\114" : ''; goto S59UQ; A1eJg: q0MIq: goto X30ed; laKAE: Jk636: goto rpkwX; Nhev_: $length = "\50" . $column->max_length . "\51"; goto rULbU; rULbU: goto uhYBp; goto ni6lW; Nvvv5: } goto V1erF; yLwkc: $script = "\103\x52\x45\101\x54\x45\x20\x54\x41\x42\x4c\105\x20\x60" . $table . "\140\40\50"; goto StsmE; wIg5S: $script .= $pri . "\51\40\x45\116\107\111\x4e\x45\x3d\x49\156\x6e\x6f\104\x42\40\104\x45\x46\x41\125\x4c\x54\x20\103\110\x41\122\x53\x45\x54\75\x75\x74\146\70\155\142\x34\x3b"; goto sqrKc; zYAEm: t_Ftr: goto RSJ4B; sMPIB: g3tGQ: goto eIig4; RSJ4B: goto gzgRC; goto sMPIB; qtkEL: $script_edit_column[$table] = "\x41\114\124\x45\122\40\124\101\102\x4c\x45\40\x60" . $table . "\x60\x20" . implode("\54\40", $modif_column) . "\73"; goto Zv5Je; XEFXz: if (!isset($json[$table])) { goto t_Ftr; } goto LPDfF; Zv5Je: QDRdS: goto zYAEm; uyKtT: gzgRC: goto wva1L; LPDfF: $add_column = []; goto Qs7bV; Qs7bV: $modif_column = []; goto W1w9O; S3uUM: $script_create_column[$table] = "\x41\114\x54\x45\x52\x20\x54\x41\102\x4c\105\x20\140" . $table . "\140\40" . implode("\54\40", $add_column) . "\x3b"; goto XUp_u; eIig4: $create_tables[] = $json[$table]; goto yLwkc; wva1L: TKuLe: goto OXKGq; XUp_u: SCl3b: goto MnAVO; StsmE: $pri = ''; goto yy27H; OXKGq: } goto yxI20; I8Y6t: $json = (array) $json; goto m7Pg8; u3Aji: $add_columns = []; goto oIgtF; yxI20: qN10z: goto VDmUL; bypqn: $data = ["\146\x69\x65\x6c\x64\x73" => $fields, "\x63\x72\145\x61\x74\145\137\164\141\142\x6c\x65\163" => $create_tables, "\143\x6f\x75\x6e\164\137\x74\x62\x6c" => count($create_tables), "\141\x64\x64\137\x63\157\x6c\165\x6d\x6e\x73\x5f\164\157\137\164\141\142\154\x65" => $add_columns, "\x63\157\165\156\x74\x5f\143\157\x6c" => count($add_columns), "\145\144\151\x74\x5f\x63\x6f\x6c\x75\155\x6e\163" => $edit_columns, "\x63\x6f\165\x6e\164\137\x6d\157\144" => count($edit_columns), "\141\x64\x64\x5f\164\142\x6c" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\x64\144\x5f\x63\157\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\x6d\x6f\144\x5f\x63\157\154" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto U7hwf; vj7v1: $json = file_get_contents("\x2e\57\x61\163\x73\x65\164\x73\57\x61\160\x70\x2f\144\x62\x2f\144\x61\164\141\142\141\163\145\56\152\163\157\156"); goto Zedqk; HUUuH: $fields = []; goto AFgut; VDmUL: $this->db->db_debug = $db_debug; goto bypqn; Kvzt4: $create_tables = []; goto qkdyp; SGq_V: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto cYGp7; qkdyp: $script_create_table = []; goto u3Aji; AP0aB: $db_debug = $this->db->db_debug; goto TtXtv; YLfcO: $tbl_ada = array_keys($fields); goto SGq_V; Va_9s: sort($full_tables); goto Kvzt4; NuWfp: } public function createTable() { goto MwL09; CyCN4: $queries = ''; goto bUZ2I; sRCv9: $scripts = json_decode($this->encryption->decrypt($scripts)); goto CyCN4; FpK8p: sleep(1); goto sRCv9; MRdQL: $data["\155\145\163\163\x61\x67\145"] = "\x55\x70\144\x61\164\145\x20\153\157\x6c\157\x6d"; goto AgNip; zq2_o: str_replace("\x25\x32\x42", "\53", $scripts); goto FpK8p; xV834: $data["\x73\x75\x63\143\145\x73\163"] = $this->runQuery($queries); goto MRdQL; AgNip: $this->output_json($data); goto s0GIE; bUZ2I: foreach ($scripts as $script) { $queries .= $script; od2yM: } goto TJtid; TJtid: JLmaf: goto xV834; MwL09: $scripts = $this->input->post("\144\x61\x74\141", true); goto zq2_o; s0GIE: } public function createColumn() { goto QsSVl; WUoN7: $scripts = json_decode($this->encryption->decrypt($scripts)); goto iztFW; cij3H: kGx2M: goto ahL9C; wGQi1: $data["\x6d\x65\x73\x73\141\147\145"] = "\115\157\144\151\146\171\x20\153\157\154\157\x6d"; goto TZJjY; ubDq2: fnrO0: goto l0od1; QsSVl: $scripts = $this->input->post("\x64\x61\164\x61", true); goto f9wdN; BPfVU: $this->updateUID(); goto ubDq2; V4v0E: sleep(1); goto WUoN7; f9wdN: str_replace("\45\62\102", "\x2b", $scripts); goto V4v0E; TZJjY: $this->output_json($data); goto UqztM; lOnir: foreach ($scripts as $script) { $queries .= $script; KRTSZ: } goto cij3H; l0od1: $data["\x73\165\143\x63\x65\163\163"] = $this->runQuery($queries); goto wGQi1; ahL9C: if (!(strpos("\x60\x75\x69\144\x60", $queries) !== false)) { goto fnrO0; } goto BPfVU; iztFW: $queries = ''; goto lOnir; UqztM: } public function editColumn() { goto v3p8Q; HI3Jo: $queries = ''; goto nHPgI; twgJb: $data["\163\x75\x63\143\x65\163\x73"] = $this->runQuery($queries); goto uc1px; v3p8Q: $scripts = $this->input->post("\x64\141\x74\x61", true); goto mVo4D; xkB0_: $scripts = json_decode($this->encryption->decrypt($scripts)); goto HI3Jo; yMXvV: sleep(1); goto xkB0_; nHPgI: foreach ($scripts as $script) { $queries .= $script; yrMSl: } goto p2Ik5; d9MEk: $this->output_json($data); goto I6AQn; p2Ik5: u33hT: goto twgJb; uc1px: $data["\155\x65\163\163\x61\x67\145"] = "\x55\x70\x64\141\164\145\40\x73\x65\154\x65\163\141\151"; goto d9MEk; mVo4D: str_replace("\45\62\102", "\53", $scripts); goto yMXvV; I6AQn: } function runQuery($script) { goto AkR9W; eLjux: $mysqli->close(); goto e3cV1; viMew: return mysqli_connect_errno(); goto cwsdz; PbCp9: $mysqli->multi_query($script); goto eLjux; yQBP7: $hostpass = $this->db->password; goto r48NJ; r48NJ: $database = $this->db->database; goto BADur; FPj2d: if (!mysqli_connect_errno()) { goto cbPVj; } goto viMew; cwsdz: cbPVj: goto PbCp9; AkR9W: $hostname = $this->db->hostname; goto uKQQ_; BADur: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto FPj2d; e3cV1: return true; goto geaSc; uKQQ_: $hostuser = $this->db->username; goto yQBP7; geaSc: } function updateUID() { goto rhNuQ; MeUIn: $siswas = $this->db->get("\155\x61\x73\164\145\x72\137\x73\151\x73\167\141")->result(); goto D9jv3; rhNuQ: $this->load->library("\x55\165\151\144", "\165\165\x69\144"); goto MeUIn; NvrQZ: foreach ($siswas as $siswa) { $input[] = array("\151\x64\137\x73\x69\163\x77\x61" => $siswa->id_siswa, "\x75\151\144" => $this->uuid->v4()); HW5QB: } goto GpU9p; D9jv3: $input = array(); goto NvrQZ; jxLiN: return $this->db->update_batch("\155\x61\163\164\145\162\137\163\151\163\167\141", $input, "\x69\x64\137\x73\x69\x73\167\x61"); goto u6T3D; GpU9p: lHX5C: goto jxLiN; u6T3D: } function make_base() { } }
