<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\x45\x50\101\x54\x48") or exit("\116\157\x20\x64\x69\x72\145\143\x74\x20\x73\143\162\x69\x70\164\x20\141\143\143\x65\163\163\40\x61\154\154\x6f\167\x65\144"); class Update extends CI_Controller { function __construct() { goto i1dNP; usUY8: $this->load->database(); goto EGZ1i; eyB52: $this->load->dbforge(); goto usUY8; QfzhG: include APPPATH . "\x63\157\x6e\146\x69\147\57\x64\141\164\141\142\x61\x73\145\x2e\x70\x68\x70"; goto eyB52; EGZ1i: $this->load->library("\145\x6e\143\x72\171\x70\164\151\x6f\x6e"); goto XfwwJ; i1dNP: parent::__construct(); goto QfzhG; XfwwJ: } public function output_json($data, $encode = true) { goto DwWHx; DwWHx: if (!$encode) { goto Tr3Bs; } goto kt_Ny; rSg0n: $this->output->set_content_type("\141\160\160\154\x69\x63\141\164\151\x6f\156\x2f\x6a\x73\x6f\156")->set_output($data); goto ltnzF; kt_Ny: $data = json_encode($data); goto CUJKu; CUJKu: Tr3Bs: goto rSg0n; ltnzF: } public function index() { goto cTheT; UFs2v: $this->load->view("\151\156\x73\164\141\154\154\57\150\x65\x61\x64\145\162", $data); goto KZBfn; oD7zi: $json = (array) $json; goto IbSrA; IbSrA: $data["\x6a\x73\x6f\156"] = $json; goto UFs2v; cTheT: $json = file_get_contents("\x2e\57\141\163\x73\x65\x74\x73\57\141\x70\x70\x2f\144\x62\57\x64\141\x74\141\x62\x61\163\145\56\x6a\x73\x6f\x6e"); goto nODUk; KZBfn: $this->load->view("\151\x6e\x73\164\141\154\154\57\x75\160\x64\x61\164\x65"); goto XVtGq; nODUk: $json = json_decode($json); goto oD7zi; XVtGq: $this->load->view("\x69\156\163\164\x61\154\x6c\57\x66\157\x6f\164\x65\x72"); goto zz35y; zz35y: } function object_to_array($data) { goto UPiXu; nwWfe: $result = []; goto jnmDX; IBmsy: pof0N: goto CKvJI; BVuNC: GbPPT: goto DX20T; UPiXu: if (!(is_array($data) || is_object($data))) { goto pof0N; } goto nwWfe; jnmDX: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; GpEhu: } goto BVuNC; CKvJI: return $data; goto ng9hR; DX20T: return $result; goto IBmsy; ng9hR: } public function checkDatabase() { goto pnfgp; oRDeB: $full_tables = array_merge($tbl_baru, $tbl_ada); goto vNu8H; dYfNq: $currentDb = []; goto OB2zS; j1Fc8: $create_tables = []; goto TdPFP; TdPFP: $add_columns = []; goto SCXuk; yi10W: sort($full_tables); goto j1Fc8; fGvO9: $json = (array) $json; goto jVhND; pnfgp: $db_debug = $this->db->db_debug; goto bqk_d; IooKi: $fields = []; goto dYfNq; SCXuk: $edit_columns = []; goto pA9WI; OB2zS: foreach ($tabless as $table) { goto DaETs; rmefy: $currentDb = FALSE; goto cZK4i; ELyAj: $fields[$table] = $datafld; goto nXFLw; EUXvH: $datafld[$i]->auto_increment = true; goto u8RCc; cZK4i: lRf_K: goto QK_AN; wdcUS: $currentDb[$table] = $retval; goto ELyAj; ABSnE: fCeb3: goto yYXAs; P4Wra: if ($query[$i]->extra == "\x61\165\x74\157\x5f\151\x6e\143\x72\145\x6d\145\156\164") { goto lCg9k; } goto tdvdy; up67C: $retval[$i]->name = $query[$i]->column_name; goto LFELM; AzAdh: $i = 0; goto lvubm; tdvdy: $datafld[$i]->extra = $query[$i]->extra; goto pMn4K; cOM3T: $retval = array(); goto AzAdh; yYXAs: if (!($i < $c)) { goto QwSBX; } goto TQFY2; BaZaw: if (!($query[$i]->extra != '')) { goto zKu7i; } goto P4Wra; TQFY2: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto BQmYa; } goto BaZaw; nXFLw: mlmWF: goto bR8Ov; N6niR: if (!(($query = $this->db->query($sql)) === FALSE)) { goto lRf_K; } goto rmefy; g84Ld: YYf2W: goto W0gim; bERMK: $retval[$i] = new stdClass(); goto up67C; u8RCc: DdCHe: goto xcij_; APfsa: $sql = "\123\x45\114\105\x43\x54\40\140\x63\x6f\x6c\165\155\x6e\x5f\x6e\x61\x6d\x65\x60\54\40\140\156\x75\x6d\x65\162\151\143\x5f\x70\x72\145\x63\x69\163\x69\157\156\140\x2c\40\x60\x65\x78\x74\x72\x61\140\x2c\x20\x60\x69\163\137\156\x75\x6c\x6c\141\x62\x6c\x65\140" . "\x20\x46\122\117\115\40\140\151\156\146\157\162\x6d\141\x74\151\157\x6e\137\163\x63\x68\x65\155\x61\140\56\x60\x63\157\x6c\x75\x6d\156\163\x60\40\x57\x48\x45\122\x45\x20\x74\141\142\x6c\x65\137\163\x63\150\145\x6d\141\40\75\40\x22" . $this->db->database . "\42\40\101\116\104\x20\x74\141\x62\154\145\137\156\141\x6d\145\40\75\40\x22" . $table . "\42"; goto N6niR; LFELM: $retval[$i]->extra = $query[$i]->extra; goto g84Ld; As643: BQmYa: goto bERMK; DaETs: $datafld = $this->db->field_data($table); goto APfsa; uyq0S: goto fCeb3; goto HxoTg; NbRLy: lCg9k: goto EUXvH; QK_AN: $query = $query->result_object(); goto cOM3T; pMn4K: goto DdCHe; goto NbRLy; HxoTg: QwSBX: goto wdcUS; lvubm: $c = count($query); goto ABSnE; xcij_: zKu7i: goto As643; W0gim: $i++; goto uyq0S; bR8Ov: } goto Awfz5; u2yZu: $this->output_json($data); goto BJYER; jVhND: $tbl_baru = array_keys($json); goto LXTA5; Awfz5: NwNin: goto s4ey8; bCy1V: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto hoIxw; fmy9l: PaTe3: goto bCy1V; pA9WI: foreach ($full_tables as $table) { goto TPbBD; BJf04: YPuTM: goto WtCPo; hSqlY: goto bTSKy; goto Bdo4H; hDNjO: OA9xL: goto FLsT3; Bdo4H: cAqOx: goto o6323; TPbBD: if ($this->db->table_exists($table)) { goto cAqOx; } goto BF49M; BF49M: $create_tables[$table] = $json[$table]; goto hSqlY; PNDfs: bTSKy: goto BJf04; FLsT3: NJHlm: goto PNDfs; FCE09: foreach ($json[$table] as $jtbl) { goto lKwQs; lKwQs: if ($this->db->field_exists($jtbl->name, $table)) { goto Z3izf; } goto HrtHs; P6yIp: foreach ($fields[$table] as $ftbl) { goto LXDme; bvtfj: nEqH0: goto BBHb2; LXDme: if (!($jtbl->name == $ftbl->name)) { goto iViOA; } goto R1Tet; FciZc: $edit_columns[$table][] = $jtbl; goto bvtfj; BBHb2: iViOA: goto tUJCA; R1Tet: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto nEqH0; } goto FciZc; tUJCA: akLcR: goto j9Ges; j9Ges: } goto xS7Vd; TDlJX: Z3izf: goto P6yIp; JDZ1W: gyidI: goto A5Lop; A5Lop: GG_GT: goto WIwkg; D3B3k: goto gyidI; goto TDlJX; xS7Vd: oFncl: goto JDZ1W; HrtHs: $add_columns[$table][] = $jtbl; goto D3B3k; WIwkg: } goto hDNjO; o6323: if (!isset($json[$table])) { goto NJHlm; } goto FCE09; WtCPo: } goto fmy9l; bqk_d: $this->db->db_debug = FALSE; goto h7tir; h7tir: $tabless = $this->db->list_tables(); goto IooKi; hoIxw: $data = ["\x64\x62" => $fields, "\x63\x72\x65\x61\x74\145" => $create_tables, "\x6d\157\144\x69\146\171" => $edit_columns, "\141\144\x64" => $add_columns, "\143\157\x75\156\164\163" => $counts, "\x6a\163\x6f\x6e" => $json, "\143\x75\162\x72\145\156\x74" => $currentDb]; goto u2yZu; LXTA5: $tbl_ada = array_keys($fields); goto oRDeB; qY9HN: $json = json_decode($json); goto fGvO9; s4ey8: $json = file_get_contents("\56\x2f\141\163\163\x65\x74\163\x2f\x61\160\x70\57\144\142\57\144\141\x74\141\x62\x61\x73\x65\56\152\x73\157\156"); goto qY9HN; vNu8H: $full_tables = array_unique($full_tables); goto yi10W; BJYER: } public function updateDatabase() { goto WaOqm; NbhFC: $tbl_baru = array_keys($json); goto uuMUy; nkCll: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); O8i1v: } goto kQl2S; WaOqm: $tabless = $this->db->list_tables(); goto RcThD; Yf431: $json = json_decode($json); goto EeH1Z; sa46n: sort($full_tables); goto gvn6b; EeH1Z: $json = (array) $json; goto NbhFC; gvn6b: foreach ($full_tables as $table) { goto IECuN; IVOLs: Yu3Tk: goto zPcfS; QC18P: if (!isset($json[$table])) { goto E2pDP; } goto qF7AW; IECuN: if ($this->db->table_exists($table)) { goto imsUL; } goto ssxV8; nBPGU: kHmAD: goto XP2Xt; zPcfS: goto nFda0; goto Pq8Ih; x5BUa: nFda0: goto wpXZ7; zss6E: $this->dbforge->create_table($table, TRUE); goto GKm3O; wpXZ7: zGX86: goto ODYPt; XP2Xt: E2pDP: goto x5BUa; qF7AW: foreach ($json[$table] as $jtbl) { goto ovOv6; ovOv6: if ($this->db->field_exists($jtbl->name, $table)) { goto I0hd1; } goto HhXPP; aUPit: hsofe: goto W3PKV; W3PKV: ZM1bB: goto V37A8; y51Ka: zMYlm: goto yyJII; MvwN8: foreach ($fields[$table] as $ftbl) { goto W1bKa; qDVPd: Xhv1C: goto TlhJe; PtnkK: $field = array($jtbl->name . "\40\144\141\x74\x65\164\x69\155\145\40\x64\145\x66\x61\x75\x6c\164\x20\x63\x75\x72\x72\x65\156\x74\x5f\x74\151\155\x65\x73\x74\x61\155\x70" . $onUpdate); goto KZN2h; BE2S2: $onUpdate = isset($jtbl->extra) ? "\40" . strtolower($jtbl->extra) : ''; goto PtnkK; kG7gz: x74Xc: goto cM93r; mcZ3r: if ($jtbl->auto_increment == true) { goto Cp9l_; } goto QzIE3; TxMAv: $this->dbforge->modify_column($table, $field); goto NKdgg; NKdgg: goto nOj2W; goto wxC2A; C3QJg: goto UOiCF; goto D1xwF; b9Ob3: $this->dbforge->modify_column($table, $field); goto WZvdp; QzIE3: $field = array($jtbl->name => array("\x74\171\160\x65" => $jtbl->type, "\x63\x6f\156\x73\164\162\141\151\156\164" => $jtbl->max_length, "\156\x75\154\154" => false)); goto RjZqE; u17wZ: Cp9l_: goto fKCRe; IFfs_: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto LqptO; } goto KYJ4I; RjZqE: goto Xhv1C; goto u17wZ; VOopW: vH7Ed: goto kG7gz; TlhJe: $this->dbforge->add_key($jtbl->name, true); goto TxMAv; Bs4ds: $field = array($jtbl->name => array("\164\171\x70\x65" => $jtbl->type, "\x63\x6f\156\163\x74\162\x61\151\156\164" => $jtbl->max_length, "\144\145\146\x61\x75\x6c\164" => $jtbl->default)); goto C3QJg; fKCRe: $field = array($jtbl->name => array("\164\x79\x70\145" => $jtbl->type, "\x63\157\156\x73\164\x72\x61\151\156\164" => $jtbl->max_length, "\x6e\165\x6c\154" => false, "\141\165\164\157\x5f\x69\x6e\x63\x72\145\x6d\x65\x6e\164" => true)); goto qDVPd; OiezH: if ($jtbl->default == "\x43\x55\x52\122\105\x4e\124\137\x54\111\115\105\x53\x54\x41\x4d\x50") { goto S1b_t; } goto Bs4ds; D1xwF: S1b_t: goto BE2S2; wxC2A: M4UZC: goto OiezH; W1bKa: if (!($jtbl->name == $ftbl->name)) { goto vH7Ed; } goto IFfs_; WZvdp: nOj2W: goto DjTdo; KZN2h: UOiCF: goto b9Ob3; DjTdo: LqptO: goto VOopW; KYJ4I: if ($jtbl->primary_key == 0) { goto M4UZC; } goto mcZ3r; cM93r: } goto aUPit; yyJII: $field = array($jtbl->name => array("\164\x79\x70\145" => $jtbl->type, "\143\x6f\156\x73\x74\x72\141\x69\156\x74" => $jtbl->max_length, "\x64\x65\x66\141\x75\x6c\x74" => $jtbl->default)); goto JZA3s; QiD5P: I0hd1: goto MvwN8; fV6JV: goto OGAvE; goto y51Ka; Cu05z: goto ZM1bB; goto QiD5P; GdfZJ: $field = array($jtbl->name => array("\x74\x79\x70\145" => $jtbl->type, "\143\157\x6e\x73\164\x72\141\x69\x6e\x74" => $jtbl->max_length, "\156\x75\154\154" => false)); goto baChL; V37A8: vw4oc: goto VzwDK; QDd6k: OGAvE: goto Cu05z; HhXPP: if ($jtbl->primary_key == 0) { goto zMYlm; } goto GdfZJ; baChL: $this->dbforge->add_key($jtbl->name, true); goto Snn9F; JZA3s: $this->dbforge->add_column($table, $field); goto QDd6k; Snn9F: $this->dbforge->add_column($table, $field); goto fV6JV; VzwDK: } goto nBPGU; Pq8Ih: imsUL: goto QC18P; Qfepd: qh13h: goto zss6E; ssxV8: if (!isset($json[$table])) { goto Yu3Tk; } goto fOqc8; fOqc8: foreach ($json[$table] as $tbl => $jtbl) { goto BTCMM; si4lo: nzWpP: goto LU1wF; BTCMM: $field = [$jtbl->name => ["\164\171\x70\145" => $jtbl->type, "\143\x6f\x6e\x73\x74\x72\141\x69\156\x74" => $jtbl->max_length, "\156\165\x6c\x6c" => $jtbl->primary_key == 0]]; goto H3FHA; LU1wF: keVAz: goto pHw1n; kBplj: if (!($jtbl->primary_key == 1)) { goto nzWpP; } goto T0qlX; H3FHA: $this->dbforge->add_field($field); goto kBplj; T0qlX: $this->dbforge->add_key($jtbl->name, true); goto si4lo; pHw1n: } goto Qfepd; GKm3O: $this->db->query("\101\x4c\124\x45\122\x20\124\x41\x42\x4c\105\40\40\x60" . $table . "\140\40\x45\x4e\x47\x49\116\105\40\x3d\40\x49\156\x6e\157\104\102"); goto IVOLs; ODYPt: } goto neVmQ; kQl2S: wIJap: goto H7vDm; uYCgm: $full_tables = array_merge($tbl_baru, $tbl_ada); goto P7YnN; F7a3a: echo true; goto oFZpy; RcThD: $fields = []; goto nkCll; neVmQ: PaPRj: goto F7a3a; P7YnN: $full_tables = array_unique($full_tables); goto sa46n; H7vDm: $json = file_get_contents("\56\x2f\x61\x73\x73\x65\164\x73\57\141\x70\160\x2f\x64\x62\57\x64\141\164\141\x62\x61\x73\x65\56\152\163\x6f\x6e"); goto Yf431; uuMUy: $tbl_ada = array_keys($fields); goto uYCgm; oFZpy: } public function checkDb() { goto terpK; sBjhI: foreach ($full_tables as $table) { goto uR02V; Xhtyl: aoMJY: goto eEqgA; TEnIb: if (!isset($json[$table])) { goto kvk7x; } goto VMPpl; dUC8H: Gi1xk: goto RBFcp; RBFcp: F_b_b: goto ne2A3; y_2t8: foreach ($json[$table]->columns as $jtbl) { goto SdeIW; n1M7u: HcXVc: goto Mx8_t; oNkJZ: $nullable = $jtbl->nullable == "\116\117" ? "\40\x4e\117\x54\40\116\x55\x4c\x4c" : ''; goto h6kX0; dtYwE: $length = ''; goto FS0xo; Y2o4u: array_push($add_column, "\x41\104\x44\40\x60" . $jtbl->name . "\x60\x20" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto lKtef; lKtef: CBi4L: goto xiWHw; mtLx0: goto KXU2y; goto n1M7u; pu2bD: $comment = $jtbl->comment == '' ? '' : "\x20\x43\117\x4d\x4d\105\x4e\124\40\47" . $jtbl->comment . "\47"; goto Y2o4u; EprCs: byNnR: goto FC5hG; SjMXE: $extra .= "\40\120\122\x49\x4d\101\122\x59\40\113\105\131"; goto D0uJ5; FS0xo: goto L5yBj; goto RVY7d; tavTO: Wi8aN: goto JhX8y; FC5hG: if ($jtbl->type == "\151\x6e\164") { goto HcXVc; } goto JcPZi; lI1jn: if (!(strtoupper($extra) == "\x20\x41\125\124\117\x5f\111\x4e\103\122\105\x4d\105\x4e\x54")) { goto t7g50; } goto SjMXE; zQkXb: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto lI1jn; NZ5KS: Bov9q: goto tavTO; D0uJ5: t7g50: goto pu2bD; SdeIW: if ($this->db->field_exists($jtbl->name, $table)) { goto CBi4L; } goto zS0vg; tWjIm: if ($jtbl->max_length == null) { goto wCakP; } goto VlqFF; Mx8_t: $length = "\50" . ($jtbl->max_length + 1) . "\51"; goto J8kPd; DNOxn: $length = ''; goto zbMGL; RVY7d: wCakP: goto DNOxn; zbMGL: goto L5yBj; goto EprCs; xiWHw: foreach ($fields[$table]->columns as $ftbl) { goto NEFOy; PBhK9: if (strtolower($jtbl->primary) == "\x75\x6e\x69") { goto fgdYO; } goto J2Y9k; NEFOy: if (!($jtbl->name == $ftbl->name)) { goto awKop; } goto FyN8l; hxZwi: if (!($jtbl->default != $ftbl->default)) { goto c2tsy; } goto cvh1s; m6xd_: $ftbl->default = strtoupper($ftbl->default); goto BLEXq; dfFRs: f3Sxg: goto YyYQm; hc0X3: $edit_columns[$table][$jtbl->name]["\x70\162\x69\x6d\141\x72\x79"] = $jtbl->primary; goto eR0xL; uU9nM: FR6or: goto g6A7O; FyTgL: if (!($ftbl->default != null)) { goto Fhhjt; } goto s3mpe; sZqCN: if (!($jtbl->nullable != $ftbl->nullable)) { goto u_5an; } goto y002l; JgW_h: BDkAk: goto uU9nM; Y65uS: u_5an: goto GNuUm; J2Y9k: goto BDkAk; goto L5tQf; GZ1BG: array_push($modif_column, "\101\104\104\x20\120\122\x49\x4d\101\x52\131\40\x4b\105\x59\40\x28\x60" . $jtbl->name . "\x60\51"); goto DXSB0; GA2Og: $edit_columns[$table][$jtbl->name]["\x63\157\x6c\x5f\x74\171\160\x65"] = $jtbl->col_type; goto jAJl1; cvh1s: $edit_columns[$table][$jtbl->name]["\x64\145\146\x61\165\x6c\x74"] = $jtbl->default; goto A1S69; NL9db: $jtbl->default = str_replace("\50\51", '', $jtbl->default); goto laqIR; y002l: $edit_columns[$table][$jtbl->name]["\x6e\x75\x6c\154\141\142\154\x65"] = $jtbl->nullable; goto Y65uS; H7otc: hKvlw: goto AF4gf; A1S69: c2tsy: goto mMC2L; Fks43: array_push($modif_column, "\x4d\117\x44\111\106\131\40\x60" . $jtbl->name . "\x60\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto dfFRs; GNuUm: if (!($jtbl->default != null)) { goto g2b9b; } goto NL9db; IkKTt: Q93V1: goto PRXUV; laqIR: $jtbl->default = strtoupper($jtbl->default); goto kgPJv; QK5rG: fgdYO: goto PqNTq; DXSB0: goto BDkAk; goto QK5rG; mMC2L: if (!($jtbl->extra != null)) { goto lXK7v; } goto Ov72m; fVkde: x9CSf: goto fLP5Z; SyW6W: $edit_columns[$table][$jtbl->name]["\x63\x6f\x6d\155\x65\156\164"] = $jtbl->comment; goto fVkde; L5tQf: lb4sr: goto GZ1BG; F6kjQ: $nullable = $jtbl->nullable == "\x4e\117" ? "\x20\x4e\117\x54\40\116\125\x4c\114" : ''; goto D6WcB; BLEXq: Fhhjt: goto hxZwi; Ov72m: $jtbl->extra = str_replace("\50\x29", '', $jtbl->extra); goto TJE51; kgPJv: g2b9b: goto FyTgL; Uuv9v: bcmvo: goto Qhvk3; D6WcB: $default = $jtbl->default == null ? '' : "\x20\x44\x45\x46\101\x55\x4c\124\40" . $jtbl->default; goto Fquw6; eR0xL: if (strtolower($jtbl->primary) == "\160\x72\x69") { goto lb4sr; } goto PBhK9; mKSFO: $ftbl->extra = strtoupper($ftbl->extra); goto Uuv9v; YNzgb: if (!($ftbl->extra != null)) { goto bcmvo; } goto qjUYR; PqNTq: array_push($modif_column, "\101\x44\104\40\x55\116\x49\121\125\105\40\113\105\x59\40\140" . $jtbl->name . "\140\40\50\140" . $jtbl->name . "\140\x29"); goto JgW_h; Fquw6: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto zlb4B; s3mpe: $ftbl->default = str_replace("\50\51", '', $ftbl->default); goto m6xd_; f3h_7: lXK7v: goto YNzgb; rFJCi: $edit_columns[$table][$jtbl->name]["\145\170\164\x72\141"] = $jtbl->extra; goto H7otc; FyN8l: if (!($jtbl->col_type != $ftbl->col_type)) { goto F3x2Z; } goto GA2Og; YyYQm: awKop: goto IkKTt; Qhvk3: if (!($jtbl->extra != $ftbl->extra)) { goto hKvlw; } goto rFJCi; TJE51: $jtbl->extra = strtoupper($jtbl->extra); goto f3h_7; qjUYR: $ftbl->extra = str_replace("\50\x29", '', $ftbl->extra); goto mKSFO; fLP5Z: if (!($jtbl->primary != $ftbl->primary)) { goto FR6or; } goto hc0X3; jAJl1: F3x2Z: goto sZqCN; zlb4B: $comment = $jtbl->comment == '' ? '' : "\x20\x43\x4f\x4d\115\x45\116\x54\40\47" . $jtbl->comment . "\x27"; goto Fks43; AF4gf: if (!($jtbl->comment != $ftbl->comment)) { goto x9CSf; } goto SyW6W; g6A7O: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto f3Sxg; } goto F6kjQ; PRXUV: } goto NZ5KS; J8kPd: KXU2y: goto szfuN; h6kX0: $default = $jtbl->default == null ? '' : "\40\104\105\106\x41\x55\114\124\x20" . $jtbl->default; goto zQkXb; JcPZi: $length = "\50" . $jtbl->max_length . "\51"; goto mtLx0; zS0vg: $add_columns[$table][] = $jtbl; goto tWjIm; VlqFF: if ($jtbl->type != "\154\x6f\156\x67\164\145\170\x74" && $jtbl->type != "\x6d\x65\x64\151\x75\x6d\x74\x65\170\x74" && $jtbl->type != "\164\145\x78\164") { goto byNnR; } goto dtYwE; szfuN: L5yBj: goto oNkJZ; JhX8y: } goto i5dcW; eWOvO: $pri = ''; goto YpNBa; i5dcW: AUKq7: goto lif3T; lif3T: if (!(count($add_column) > 0)) { goto xoBDI; } goto yyQz9; yyQz9: $script_create_column[$table] = "\x41\114\124\105\122\40\124\x41\102\x4c\105\40\140" . $table . "\x60\40" . implode("\54\40", $add_column) . "\x3b"; goto lcLFg; twpzR: $script = "\x43\x52\x45\x41\124\105\40\x54\101\x42\x4c\105\40\x60" . $table . "\140\40\50"; goto eWOvO; zJboo: goto Gi1xk; goto nZp30; iTJ0U: $script_edit_column[$table] = "\x41\x4c\x54\105\x52\x20\124\x41\102\114\105\40\140" . $table . "\x60\x20" . implode("\54\x20", $modif_column) . "\73"; goto ab6kI; nZp30: Obvcc: goto ILAf8; eEqgA: $script .= $pri . "\x29\40\x45\x4e\x47\111\116\x45\x3d\111\156\156\157\104\x42\40\x44\x45\106\101\125\x4c\124\x20\x43\x48\101\122\x53\105\x54\x3d\x75\x74\x66\70\x6d\142\x34\x3b"; goto zbrhm; OsGMi: if (!(count($modif_column) > 0)) { goto nYHRw; } goto iTJ0U; zbrhm: $script_create_table[$table] = $script; goto dUC8H; ILAf8: $create_tables[] = $json[$table]; goto twpzR; MBrRH: $modif_column = []; goto y_2t8; WH2of: kvk7x: goto zJboo; YpNBa: foreach ($json[$table]->columns as $column) { goto xKG3H; LiU0q: if ($column->type != "\x6c\157\x6e\147\164\x65\x78\x74" && $column->type != "\155\145\144\x69\165\155\164\x65\170\x74" && $column->type != "\164\145\x78\x74") { goto oWgwz; } goto l6Kj0; IANLS: goto GMjN9; goto kIHLB; xKG3H: if ($column->max_length == null) { goto MRgb9; } goto LiU0q; dCH1Z: p9Hp7: goto FJv38; ziXLf: $pri .= $column->primary != '' ? "\x50\x52\x49\x4d\x41\x52\x59\40\x4b\x45\131\x20\50\140" . $column->name . "\x60\51" : ''; goto MR7Rg; umWzW: $nullable = $column->nullable == "\116\117" ? "\x20\x4e\117\124\x20\116\125\x4c\x4c" : ''; goto q9oDj; atyEO: MRgb9: goto p516b; p516b: $length = ''; goto IANLS; o47Qc: if ($column->type == "\151\156\x74") { goto p9Hp7; } goto PYFZ_; Sj_Du: goto P_MAF; goto dCH1Z; MR7Rg: PmMuR: goto HCgAY; m6Jf2: P_MAF: goto YVbDM; kIHLB: oWgwz: goto o47Qc; YVbDM: GMjN9: goto umWzW; Fqc5X: $comment = $column->comment == '' ? '' : "\40\103\117\x4d\x4d\x45\116\x54\40\47" . $column->comment . "\x27"; goto fTIqS; qetuM: $extra = $column->extra == '' ? '' : "\40" . strtoupper($column->extra); goto Fqc5X; l6Kj0: $length = ''; goto meVTk; q9oDj: $default = $column->default == null ? '' : "\x20\104\x45\106\x41\125\114\124\x20" . $column->default; goto qetuM; PYFZ_: $length = "\50" . $column->max_length . "\x29"; goto Sj_Du; FJv38: $length = "\x28" . ($column->max_length + 1) . "\x29"; goto m6Jf2; fTIqS: $script .= "\140" . $column->name . "\140\40" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\40"; goto ziXLf; meVTk: goto GMjN9; goto atyEO; HCgAY: } goto Xhtyl; ab6kI: nYHRw: goto WH2of; VMPpl: $add_column = []; goto MBrRH; uR02V: if (!$this->db->table_exists($table)) { goto Obvcc; } goto TEnIb; lcLFg: xoBDI: goto OsGMi; ne2A3: } goto qcLf8; cvEWg: $edit_columns = []; goto wvoS9; BzGpE: sort($full_tables); goto QPUTW; aGBg1: $this->db->db_debug = FALSE; goto QQVVF; BbKpy: $add_columns = []; goto VB9SF; JQsK2: inl8a: goto EHI0i; LFz7W: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto twYD5; yFRpC: $this->db->db_debug = $db_debug; goto HP800; hWxPv: $this->output_json($data); goto hSywX; LeOMd: $script_create_table = []; goto BbKpy; qcLf8: SEoLq: goto yFRpC; twYD5: $full_tables = array_unique($full_tables); goto BzGpE; y5CQk: $json = json_decode($json); goto OHyrh; VB9SF: $script_create_column = []; goto cvEWg; HP800: $data = ["\x66\151\145\154\144\x73" => $fields, "\143\x72\x65\x61\164\x65\x5f\x74\141\x62\x6c\145\163" => $create_tables, "\143\157\x75\156\x74\137\164\x62\x6c" => count($create_tables), "\141\144\144\x5f\x63\x6f\x6c\x75\155\156\163\137\x74\157\137\164\x61\142\x6c\x65" => $add_columns, "\143\x6f\165\156\x74\x5f\x63\157\x6c" => count($add_columns), "\145\x64\151\x74\137\143\x6f\154\165\155\x6e\x73" => $edit_columns, "\143\157\x75\156\164\x5f\155\157\144" => count($edit_columns), "\141\x64\144\137\x74\x62\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\x64\144\137\x63\x6f\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\x6f\144\137\x63\157\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto hWxPv; vzGUW: $tbl_ada = array_keys($fields); goto LFz7W; ElPRm: $tbl_seharusnya = array_keys($json); goto vzGUW; QQVVF: $tabless = $this->db->list_tables(); goto AFIel; EHI0i: $json = file_get_contents("\56\x2f\141\163\163\145\x74\x73\57\x61\160\x70\57\x64\x62\57\x64\141\x74\141\142\x61\x73\x65\56\x6a\163\157\156"); goto y5CQk; terpK: $db_debug = $this->db->db_debug; goto aGBg1; wvoS9: $script_edit_column = []; goto sBjhI; QPUTW: $create_tables = []; goto LeOMd; AFIel: $fields = []; goto mu_Kj; mu_Kj: foreach ($tabless as $table) { goto NCFXc; nZZI6: $retval[$i]->primary = $query[$i]->column_key; goto LR3wh; yd_Hj: $retval[$i]->extra = $query[$i]->extra; goto Noo8x; Anhpn: uOuyL: goto VbM2b; kRxLA: $fields = FALSE; goto Anhpn; SMBst: $i = 0; goto C9cEL; KztG2: goto hpje0; goto TxN4i; JpA3f: $retval[$i]->default = $query[$i]->column_default; goto zEzut; NCFXc: $sql = "\x53\x45\114\x45\x43\124\40\x60\143\157\x6c\165\x6d\x6e\137\x6e\141\155\x65\140\54\40\140\x63\x6f\x6c\165\x6d\x6e\137\164\x79\160\145\140\x2c\40\x60\x63\x6f\x6c\x6c\141\x74\x69\157\x6e\x5f\x6e\141\155\x65\x60\x2c\x20\x60\144\x61\164\141\137\x74\x79\x70\145\140\x2c\40\140\143\x68\141\x72\x61\x63\x74\x65\162\137\x6d\141\170\151\x6d\x75\x6d\137\x6c\x65\x6e\x67\x74\150\140\x2c\x20\140\156\x75\155\x65\162\x69\x63\137\160\162\x65\143\151\163\x69\157\156\x60\x2c" . "\x20\x60\x63\x6f\x6c\x75\155\x6e\137\x64\x65\x66\x61\165\154\164\140\x2c\40\x60\143\x6f\154\x75\x6d\x6e\137\153\x65\171\x60\x2c\40\x60\x63\x6f\154\165\155\156\x5f\x63\x6f\155\155\145\x6e\164\140\54\x20\140\x65\x78\x74\162\x61\x60\x2c\x20\140\x69\163\137\x6e\x75\154\154\x61\142\154\x65\x60\15\xa\11\x9\x9\106\122\117\x4d\40\140\x69\156\146\x6f\x72\155\x61\164\x69\157\156\137\163\x63\150\x65\x6d\x61\140\56\x60\143\x6f\154\x75\155\x6e\163\x60\x20\127\110\105\x52\x45\x20\164\x61\142\x6c\145\x5f\x73\x63\150\145\x6d\141\40\x3d\40\x22" . $this->db->database . "\42\40\x41\116\x44\40\x74\141\x62\154\145\137\156\x61\x6d\145\40\x3d\x20\x22" . $table . "\x22"; goto xHOLh; Flq_o: $retval = array(); goto SMBst; LR3wh: kUMGZ: goto Qugem; k2gnn: Mfc4G: goto YtNNa; EuwYE: $retval[$i]->type = $query[$i]->data_type; goto DiIjy; TxN4i: OWIk1: goto oluVX; Noo8x: $retval[$i]->nullable = $query[$i]->is_nullable; goto nZZI6; zEzut: $retval[$i]->comment = $query[$i]->column_comment; goto yd_Hj; DZcU_: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto JpA3f; zI0GA: $retval[$i]->col_type = $query[$i]->column_type; goto EuwYE; e3Teg: $retval[$i]->name = $query[$i]->column_name; goto zI0GA; C9cEL: $c = count($query); goto B2tiq; Qugem: $i++; goto KztG2; B2tiq: hpje0: goto qIAul; DiIjy: $retval[$i]->collation = $query[$i]->collation_name; goto DZcU_; VbM2b: $query = $query->result_object(); goto Flq_o; oluVX: $fields[$table] = (object) ["\164\141\x62\x6c\145\x5f\156\x61\155\145" => $table, "\x63\157\x6c\x75\155\156\163" => $retval]; goto k2gnn; jlM8L: $retval[$i] = new stdClass(); goto e3Teg; xHOLh: if (!(($query = $this->db->query($sql)) === FALSE)) { goto uOuyL; } goto kRxLA; qIAul: if (!($i < $c)) { goto OWIk1; } goto jlM8L; YtNNa: } goto JQsK2; OHyrh: $json = (array) $json; goto ElPRm; hSywX: } public function createTable() { goto SwzBy; VSVV1: foreach ($scripts as $script) { $queries .= $script; DDDJD: } goto scSPV; EV0Lj: $queries = ''; goto VSVV1; cxD7a: sleep(1); goto huk9A; scSPV: Fl_lo: goto rYLkP; huk9A: $scripts = json_decode($this->encryption->decrypt($scripts)); goto EV0Lj; WQM0s: $data["\x6d\x65\x73\x73\x61\x67\x65"] = "\125\x70\x64\x61\164\145\40\x6b\x6f\154\x6f\x6d"; goto vsvbe; xZ3B9: str_replace("\x25\62\102", "\53", $scripts); goto cxD7a; vsvbe: $this->output_json($data); goto PhbrD; SwzBy: $scripts = $this->input->post("\x64\141\164\141", true); goto xZ3B9; rYLkP: $data["\163\165\x63\x63\x65\163\x73"] = $this->runQuery($queries); goto WQM0s; PhbrD: } public function createColumn() { goto rSYNB; LltFP: foreach ($scripts as $script) { $queries .= $script; YXuRW: } goto SW4U_; SW4U_: Kggky: goto rD19N; ESuG2: $this->output_json($data); goto pHoAV; Ee2ei: $data["\x6d\145\163\163\x61\147\145"] = "\115\157\x64\x69\146\171\x20\153\157\x6c\157\x6d"; goto ESuG2; F9oDD: $scripts = json_decode($this->encryption->decrypt($scripts)); goto i4LR3; Xg6dH: str_replace("\45\62\102", "\53", $scripts); goto vqQTS; rSYNB: $scripts = $this->input->post("\x64\x61\164\x61", true); goto Xg6dH; i4LR3: $queries = ''; goto LltFP; rD19N: if (!(strpos("\140\x75\x69\x64\140", $queries) !== false)) { goto R_jCa; } goto WNOVQ; vqQTS: sleep(1); goto F9oDD; WNOVQ: $this->updateUID(); goto jGLKq; jGLKq: R_jCa: goto t4gF9; t4gF9: $data["\163\x75\x63\143\145\x73\x73"] = $this->runQuery($queries); goto Ee2ei; pHoAV: } public function editColumn() { goto qBNf5; n0UqG: $this->output_json($data); goto EePru; sP2DR: foreach ($scripts as $script) { $queries .= $script; T7olF: } goto JHD92; RB80N: $data["\x6d\x65\163\163\x61\x67\x65"] = "\125\x70\144\x61\x74\145\40\x73\145\x6c\x65\x73\x61\x69"; goto n0UqG; bXqfc: str_replace("\x25\x32\102", "\x2b", $scripts); goto kdfuU; OeQt9: $data["\x73\165\x63\143\145\x73\x73"] = $this->runQuery($queries); goto RB80N; qBNf5: $scripts = $this->input->post("\144\141\x74\x61", true); goto bXqfc; tbM3a: $queries = ''; goto sP2DR; JHD92: VOCCE: goto OeQt9; kdfuU: sleep(1); goto STu5Z; STu5Z: $scripts = json_decode($this->encryption->decrypt($scripts)); goto tbM3a; EePru: } function runQuery($script) { goto Nncdx; CIuw6: $database = $this->db->database; goto lKNQL; kdTf6: HxvZ1: goto SdjxM; lzpGi: $mysqli->close(); goto Ei7eL; GcS1r: if (!mysqli_connect_errno()) { goto HxvZ1; } goto n61x8; Ei7eL: return true; goto LXMw9; SdjxM: $mysqli->multi_query($script); goto lzpGi; Nncdx: $hostname = $this->db->hostname; goto QpC0a; n61x8: return mysqli_connect_errno(); goto kdTf6; LqyQG: $hostpass = $this->db->password; goto CIuw6; QpC0a: $hostuser = $this->db->username; goto LqyQG; lKNQL: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto GcS1r; LXMw9: } function updateUID() { goto qAwW7; OBkaj: $siswas = $this->db->get("\x6d\x61\163\164\x65\x72\137\x73\151\x73\x77\x61")->result(); goto FNc1_; KU4Ar: qQOw5: goto GForO; GForO: return $this->db->update_batch("\x6d\x61\x73\164\x65\162\137\x73\151\x73\167\x61", $input, "\151\144\137\x73\151\x73\x77\x61"); goto mp3Wp; WBtzb: foreach ($siswas as $siswa) { $input[] = array("\151\x64\137\x73\x69\x73\x77\141" => $siswa->id_siswa, "\x75\151\144" => $this->uuid->v4()); bWnXV: } goto KU4Ar; FNc1_: $input = array(); goto WBtzb; qAwW7: $this->load->library("\x55\x75\x69\x64", "\x75\165\x69\x64"); goto OBkaj; mp3Wp: } function make_base() { } }
