<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\x41\123\x45\x50\101\124\110") or exit("\x4e\157\x20\x64\151\x72\145\x63\x74\40\x73\x63\162\151\160\164\x20\141\143\x63\145\x73\163\40\141\x6c\x6c\157\x77\145\144"); class Update extends CI_Controller { function __construct() { goto jUZCF; A0dQ0: $this->load->dbforge(); goto eA41t; n2Dk1: $this->load->library("\x65\156\143\x72\x79\160\164\x69\x6f\x6e"); goto LufKa; eA41t: $this->load->database(); goto n2Dk1; j2G0H: include APPPATH . "\143\157\156\146\x69\147\57\x64\x61\x74\x61\x62\141\163\145\56\160\x68\x70"; goto A0dQ0; jUZCF: parent::__construct(); goto j2G0H; LufKa: } public function output_json($data, $encode = true) { goto DF0t4; IyLmk: $this->output->set_content_type("\x61\160\160\x6c\x69\x63\x61\164\151\x6f\156\x2f\x6a\x73\x6f\x6e")->set_output($data); goto qPB8X; RVQCn: $data = json_encode($data); goto Jy7ct; DF0t4: if (!$encode) { goto caqTk; } goto RVQCn; Jy7ct: caqTk: goto IyLmk; qPB8X: } public function index() { goto JusBd; tz6NR: $json = (array) $json; goto Cm1Br; Cm1Br: $data["\x6a\163\x6f\x6e"] = $json; goto nck5p; jrCm4: $this->load->view("\151\156\163\x74\141\x6c\x6c\57\146\x6f\x6f\164\145\162"); goto zOr64; Ww1Pd: $this->load->view("\x69\156\x73\164\x61\154\x6c\57\x75\x70\144\x61\x74\145"); goto jrCm4; JusBd: $json = file_get_contents("\56\x2f\x61\x73\163\x65\164\163\57\x61\x70\x70\x2f\144\142\57\x64\141\x74\x61\x62\x61\x73\145\x2e\152\163\x6f\156"); goto kZRNQ; kZRNQ: $json = json_decode($json); goto tz6NR; nck5p: $this->load->view("\151\x6e\x73\164\x61\x6c\154\57\x68\x65\141\x64\145\x72", $data); goto Ww1Pd; zOr64: } function object_to_array($data) { goto dR8bg; jxGsW: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; yCOFa: } goto OF2HM; dR8bg: if (!(is_array($data) || is_object($data))) { goto AQOQ7; } goto WtezL; WtezL: $result = []; goto jxGsW; HZHGe: AQOQ7: goto Zd3xv; Zd3xv: return $data; goto Auppk; OF2HM: sWp9f: goto CzW2T; CzW2T: return $result; goto HZHGe; Auppk: } public function checkDatabase() { goto COQJJ; g5Zkb: sort($full_tables); goto f4sFQ; LbPvR: $json = json_decode($json); goto B39Uk; ndNCW: $currentDb = []; goto V9aVt; JaVJT: $json = file_get_contents("\x2e\x2f\x61\x73\x73\145\x74\163\x2f\141\x70\160\57\x64\x62\57\x64\141\164\x61\142\141\x73\145\x2e\x6a\x73\x6f\x6e"); goto LbPvR; UPHei: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto GghkX; PbTqq: j1cP6: goto JaVJT; lEGlh: $tbl_baru = array_keys($json); goto Ypl4m; fCJDU: foreach ($full_tables as $table) { goto VVfl3; VVfl3: if ($this->db->table_exists($table)) { goto jq8kr; } goto Z2zJr; p3Bi3: goto P8bNw; goto kv9a5; kv9a5: jq8kr: goto IiYBV; Z2zJr: $create_tables[$table] = $json[$table]; goto p3Bi3; uLzJW: foreach ($json[$table] as $jtbl) { goto NEyJH; TZCnH: foreach ($fields[$table] as $ftbl) { goto p4nAC; mkP5r: $edit_columns[$table][] = $jtbl; goto Ge3yS; zdXup: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto nCd2U; } goto mkP5r; Ge3yS: nCd2U: goto UEiTn; UEiTn: HD6Dz: goto hxEXz; hxEXz: nKO_w: goto obFCs; p4nAC: if (!($jtbl->name == $ftbl->name)) { goto HD6Dz; } goto zdXup; obFCs: } goto hWqbL; KNfVJ: goto JkveZ; goto hsLFm; hsLFm: IGbje: goto TZCnH; NEyJH: if ($this->db->field_exists($jtbl->name, $table)) { goto IGbje; } goto xKoj9; OvL0D: bq1QN: goto qRW4u; xKoj9: $add_columns[$table][] = $jtbl; goto KNfVJ; YoVNz: JkveZ: goto OvL0D; hWqbL: kcL7A: goto YoVNz; qRW4u: } goto Ykvjy; IiYBV: if (!isset($json[$table])) { goto KHaQN; } goto uLzJW; jc6Rk: P8bNw: goto xxv_k; Ykvjy: v7lyQ: goto tXj7Z; xxv_k: u6jDQ: goto pw0tu; tXj7Z: KHaQN: goto jc6Rk; pw0tu: } goto rGZEz; Ypl4m: $tbl_ada = array_keys($fields); goto Q99Zh; rGZEz: L86LV: goto UPHei; f4sFQ: $create_tables = []; goto fEncv; Q99Zh: $full_tables = array_merge($tbl_baru, $tbl_ada); goto i6UzM; COQJJ: $db_debug = $this->db->db_debug; goto hPcsr; ifjrr: $tabless = $this->db->list_tables(); goto vaCJM; i6UzM: $full_tables = array_unique($full_tables); goto g5Zkb; GghkX: $data = ["\x64\142" => $fields, "\143\x72\x65\141\164\x65" => $create_tables, "\155\157\x64\x69\x66\171" => $edit_columns, "\x61\x64\144" => $add_columns, "\x63\x6f\x75\156\164\x73" => $counts, "\x6a\x73\157\156" => $json, "\x63\x75\162\162\x65\x6e\x74" => $currentDb]; goto Vih2S; B39Uk: $json = (array) $json; goto lEGlh; Vih2S: $this->output_json($data); goto P76RA; fEncv: $add_columns = []; goto c3mB_; c3mB_: $edit_columns = []; goto fCJDU; vaCJM: $fields = []; goto ndNCW; hPcsr: $this->db->db_debug = FALSE; goto ifjrr; V9aVt: foreach ($tabless as $table) { goto YTw7B; y7CKY: goto wE0Bb; goto NdWZ_; Y34b0: HhW2P: goto X9RPf; YTw7B: $datafld = $this->db->field_data($table); goto myxEK; lC712: if (!(($query = $this->db->query($sql)) === FALSE)) { goto HhW2P; } goto xCQL8; J3JAa: hRWke: goto It1Na; myxEK: $sql = "\x53\105\114\105\x43\124\40\x60\x63\x6f\154\165\x6d\x6e\x5f\156\141\x6d\x65\140\x2c\x20\140\x6e\165\155\145\x72\x69\143\137\x70\162\x65\143\x69\163\x69\157\x6e\140\54\40\140\x65\x78\x74\162\141\140\x2c\x20\140\151\163\137\x6e\x75\154\154\x61\142\x6c\145\140" . "\x20\106\122\117\115\40\140\x69\156\x66\x6f\162\155\141\164\x69\x6f\x6e\x5f\163\x63\150\x65\x6d\x61\x60\56\x60\143\x6f\154\165\155\x6e\x73\x60\x20\x57\110\x45\122\x45\40\164\141\142\154\145\137\163\143\150\145\x6d\141\x20\75\x20\42" . $this->db->database . "\42\x20\101\116\x44\40\x74\x61\x62\154\145\x5f\156\x61\x6d\x65\x20\x3d\x20\42" . $table . "\x22"; goto lC712; DZNmr: gp2GS: goto k7eHF; xCQL8: $currentDb = FALSE; goto Y34b0; SDAjV: xnEM8: goto J3JAa; k7eHF: $datafld[$i]->auto_increment = true; goto SDAjV; mKOWQ: $retval[$i]->extra = $query[$i]->extra; goto KOc3Y; I2ob3: $retval[$i]->name = $query[$i]->column_name; goto mKOWQ; fd3ow: goto xnEM8; goto DZNmr; It1Na: L3wwY: goto zTMr9; gF0e2: wE0Bb: goto P9RWL; KOc3Y: PA2a8: goto ErWZO; k8v5U: $datafld[$i]->extra = $query[$i]->extra; goto fd3ow; ZLvDX: $currentDb[$table] = $retval; goto eZJB0; iFmDr: if ($query[$i]->extra == "\141\x75\x74\157\x5f\151\x6e\x63\x72\x65\x6d\x65\x6e\164") { goto gp2GS; } goto k8v5U; weWyb: if (!($query[$i]->extra != '')) { goto hRWke; } goto iFmDr; qdWUE: $i = 0; goto BjKFH; o5TTb: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto L3wwY; } goto weWyb; BjKFH: $c = count($query); goto gF0e2; iIYsA: gwAhV: goto ya9DC; P9RWL: if (!($i < $c)) { goto wZ1gC; } goto o5TTb; NdWZ_: wZ1gC: goto ZLvDX; zTMr9: $retval[$i] = new stdClass(); goto I2ob3; ErWZO: $i++; goto y7CKY; eZJB0: $fields[$table] = $datafld; goto iIYsA; X9RPf: $query = $query->result_object(); goto XJLb7; XJLb7: $retval = array(); goto qdWUE; ya9DC: } goto PbTqq; P76RA: } public function updateDatabase() { goto AtGRA; vjPzt: foreach ($full_tables as $table) { goto z7fhh; b0vxY: H3K_p: goto RFNam; Eu5F0: $this->dbforge->create_table($table, TRUE); goto Zm24v; ZioBY: nYNZq: goto ksilC; ksilC: sqPmB: goto U0ia4; RFNam: goto mqCQz; goto QIUBW; WbsKW: foreach ($json[$table] as $jtbl) { goto Hr2R7; B3Pg0: $field = array($jtbl->name => array("\x74\171\160\x65" => $jtbl->type, "\143\157\x6e\x73\164\x72\x61\x69\x6e\164" => $jtbl->max_length, "\144\x65\x66\x61\x75\154\164" => $jtbl->default)); goto TRuey; vb6m4: goto DZOuH; goto tZbu3; Hr2R7: if ($this->db->field_exists($jtbl->name, $table)) { goto pZl50; } goto y7Tdl; TRuey: $this->dbforge->add_column($table, $field); goto CNoWe; yktlP: foreach ($fields[$table] as $ftbl) { goto bK0ES; JksKU: $field = array($jtbl->name => array("\x74\171\160\x65" => $jtbl->type, "\x63\157\156\x73\164\x72\141\x69\x6e\x74" => $jtbl->max_length, "\156\x75\x6c\154" => false, "\141\165\164\157\x5f\151\156\143\x72\145\x6d\x65\156\x74" => true)); goto KhPpr; TUj1C: UQVZF: goto Mv3RA; jik64: goto YRp3_; goto Rnc3s; qD67I: $onUpdate = isset($jtbl->extra) ? "\x20" . strtolower($jtbl->extra) : ''; goto Q3wGq; aBUtV: oPP0B: goto W6fua; W3xsq: wxEJp: goto qD67I; cx211: if ($jtbl->primary_key == 0) { goto UQVZF; } goto lYLzv; Rnc3s: GYGYl: goto JksKU; lkIws: $this->dbforge->add_key($jtbl->name, true); goto NZkos; kJtin: A2M0h: goto qrXIC; Flpha: XqaCp: goto gDI8Q; Q3wGq: $field = array($jtbl->name . "\x20\144\x61\164\145\164\151\x6d\145\x20\144\145\146\x61\x75\x6c\164\x20\143\x75\162\x72\145\x6e\164\137\x74\151\x6d\x65\163\x74\141\x6d\x70" . $onUpdate); goto aBUtV; bK0ES: if (!($jtbl->name == $ftbl->name)) { goto v6tkl; } goto o2aF8; gmEbX: q7Xjv: goto kJtin; IGYR7: goto q7Xjv; goto TUj1C; W6fua: $this->dbforge->modify_column($table, $field); goto gmEbX; cUfNo: $field = array($jtbl->name => array("\164\171\160\x65" => $jtbl->type, "\143\157\156\x73\164\162\141\151\156\164" => $jtbl->max_length, "\x6e\165\154\154" => false)); goto jik64; vm1rJ: goto oPP0B; goto W3xsq; qrXIC: v6tkl: goto Flpha; KhPpr: YRp3_: goto lkIws; o2aF8: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto A2M0h; } goto cx211; Mv3RA: if ($jtbl->default == "\x43\x55\122\x52\x45\116\x54\137\124\111\x4d\x45\123\124\101\x4d\x50") { goto wxEJp; } goto yLQEX; yLQEX: $field = array($jtbl->name => array("\x74\171\x70\x65" => $jtbl->type, "\x63\157\156\x73\164\162\x61\151\156\x74" => $jtbl->max_length, "\x64\x65\146\141\165\x6c\x74" => $jtbl->default)); goto vm1rJ; lYLzv: if ($jtbl->auto_increment == true) { goto GYGYl; } goto cUfNo; NZkos: $this->dbforge->modify_column($table, $field); goto IGYR7; gDI8Q: } goto hk9vw; Q07mr: oNTWI: goto B3Pg0; hk9vw: UmWYQ: goto hFnqW; OfKsD: dIrI6: goto jx7Tg; Pvq1p: $this->dbforge->add_key($jtbl->name, true); goto POkDE; uZCZW: $field = array($jtbl->name => array("\x74\171\160\x65" => $jtbl->type, "\143\x6f\x6e\163\x74\x72\x61\x69\156\164" => $jtbl->max_length, "\156\x75\x6c\154" => false)); goto Pvq1p; tZbu3: pZl50: goto yktlP; y7Tdl: if ($jtbl->primary_key == 0) { goto oNTWI; } goto uZCZW; yDUmt: goto DUG0R; goto Q07mr; CNoWe: DUG0R: goto vb6m4; hFnqW: DZOuH: goto OfKsD; POkDE: $this->dbforge->add_column($table, $field); goto yDUmt; jx7Tg: } goto ZioBY; U0ia4: mqCQz: goto oQyrG; Zm24v: $this->db->query("\101\114\124\105\x52\x20\x54\x41\x42\114\105\40\40\140" . $table . "\140\x20\105\x4e\x47\x49\116\105\x20\75\x20\111\x6e\x6e\157\x44\102"); goto b0vxY; oQyrG: MSw1R: goto qvAG_; z7fhh: if ($this->db->table_exists($table)) { goto zCqMi; } goto f_0dg; f_0dg: if (!isset($json[$table])) { goto H3K_p; } goto anFru; QIUBW: zCqMi: goto HbxCr; HbxCr: if (!isset($json[$table])) { goto sqPmB; } goto WbsKW; anFru: foreach ($json[$table] as $tbl => $jtbl) { goto l3UPr; AdjCQ: $this->dbforge->add_key($jtbl->name, true); goto gVf3Q; l3UPr: $field = [$jtbl->name => ["\164\171\160\145" => $jtbl->type, "\143\x6f\156\x73\164\162\x61\151\156\164" => $jtbl->max_length, "\x6e\165\x6c\x6c" => $jtbl->primary_key == 0]]; goto krftP; qqe0R: if (!($jtbl->primary_key == 1)) { goto zvQh6; } goto AdjCQ; v8Ozx: royNp: goto pPjWN; gVf3Q: zvQh6: goto v8Ozx; krftP: $this->dbforge->add_field($field); goto qqe0R; pPjWN: } goto j6aO6; j6aO6: aEysr: goto Eu5F0; qvAG_: } goto Y8AI7; hdUDA: $json = (array) $json; goto HRz5R; mIEKj: $full_tables = array_merge($tbl_baru, $tbl_ada); goto Qpt4N; IHrey: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); MeSSC: } goto EXKAl; XgWBE: $tbl_ada = array_keys($fields); goto mIEKj; fxUFS: $fields = []; goto IHrey; CasVw: sort($full_tables); goto vjPzt; EXKAl: sXuXt: goto r1ckY; n2BiG: $json = json_decode($json); goto hdUDA; IDxID: echo true; goto FQSRR; Qpt4N: $full_tables = array_unique($full_tables); goto CasVw; AtGRA: $tabless = $this->db->list_tables(); goto fxUFS; r1ckY: $json = file_get_contents("\56\57\141\x73\x73\145\x74\163\x2f\141\x70\x70\x2f\x64\142\x2f\144\x61\164\x61\142\x61\x73\x65\56\152\x73\157\156"); goto n2BiG; Y8AI7: tUE3O: goto IDxID; HRz5R: $tbl_baru = array_keys($json); goto XgWBE; FQSRR: } public function checkDb() { goto CBrH0; rHpe3: $script_edit_column = []; goto ML6Xx; zegv8: $script_create_column = []; goto mbWKy; lD0WS: $this->db->db_debug = FALSE; goto eSlxN; Gvfsu: RTNYV: goto RuqXl; J0c_1: $tbl_ada = array_keys($fields); goto m9Nrt; ML6Xx: foreach ($full_tables as $table) { goto AmdoL; GEOHE: if (!(count($modif_column) > 0)) { goto rRL_I; } goto hSYQ3; vG21i: $add_column = []; goto Nm9pK; tLAXy: if (!(count($add_column) > 0)) { goto zhNeO; } goto kw2Y7; AmdoL: if (!$this->db->table_exists($table)) { goto IscAh; } goto FxLBJ; pD0GH: goto lpjIE; goto rGXwt; hSYQ3: $script_edit_column[$table] = "\x41\x4c\x54\x45\x52\40\124\x41\x42\x4c\x45\40\140" . $table . "\x60\x20" . implode("\x2c\x20", $modif_column) . "\x3b"; goto YfiO6; ovzg6: $script = "\103\122\105\101\x54\x45\x20\124\x41\x42\114\105\x20\140" . $table . "\140\x20\50"; goto YT4M8; FxLBJ: if (!isset($json[$table])) { goto JsgGD; } goto vG21i; oYCRN: MzQ7S: goto tLAXy; bK0on: zhNeO: goto GEOHE; RI2px: JsgGD: goto pD0GH; QzxmB: lpjIE: goto hbbv5; Nm9pK: $modif_column = []; goto zwYvv; zwYvv: foreach ($json[$table]->columns as $jtbl) { goto Xfo1o; nj9gO: if ($jtbl->max_length == null) { goto UATgT; } goto OMbLQ; i04OE: Aofcv: goto VSIvp; H4h_k: goto M8L3x; goto i04OE; Abts7: if (!(strtoupper($extra) == "\x20\x41\x55\124\117\137\111\x4e\103\122\105\115\x45\x4e\x54")) { goto E1DkW; } goto mKyid; HudMc: WXsYP: goto vKFwS; MzrYO: array_push($add_column, "\x41\x44\104\40\x60" . $jtbl->name . "\x60\40" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto HudMc; isOfs: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto Abts7; cm4A3: $comment = $jtbl->comment == '' ? '' : "\40\103\x4f\115\x4d\105\116\124\x20\47" . $jtbl->comment . "\x27"; goto MzrYO; OMbLQ: if ($jtbl->type != "\154\157\x6e\x67\164\x65\170\164" && $jtbl->type != "\155\x65\144\x69\x75\x6d\x74\145\170\164" && $jtbl->type != "\x74\x65\170\164") { goto I9W9t; } goto E60cf; Y49qG: IRoWx: goto aoImn; jlZOu: if ($jtbl->type == "\151\156\164") { goto Aofcv; } goto RPlaN; Xy3bG: UATgT: goto w1JCe; RPlaN: $length = "\50" . $jtbl->max_length . "\51"; goto H4h_k; C71vT: PA2nT: goto XsjRl; dFNnI: E1DkW: goto cm4A3; mKyid: $extra .= "\40\120\122\x49\115\101\122\x59\40\x4b\x45\x59"; goto dFNnI; XsjRl: $nullable = $jtbl->nullable == "\x4e\x4f" ? "\40\116\x4f\x54\40\x4e\125\114\x4c" : ''; goto INTl2; ZqpXD: MNkhq: goto Y49qG; ywBOs: I9W9t: goto jlZOu; Mo61t: goto PA2nT; goto ywBOs; vKFwS: foreach ($fields[$table]->columns as $ftbl) { goto Bto7Z; BeVNP: $ftbl->default = str_replace("\x28\51", '', $ftbl->default); goto f9EM8; vAdi7: array_push($modif_column, "\101\104\104\x20\120\x52\111\115\x41\122\131\x20\x4b\105\x59\x20\x28\140" . $jtbl->name . "\140\51"); goto pngN5; F47kP: if (strtolower($jtbl->primary) == "\165\156\x69") { goto yM1mT; } goto mNrud; sxv08: MqEy3: goto DpRZP; qOTPt: $jtbl->extra = str_replace("\50\x29", '', $jtbl->extra); goto jDIwE; Bto7Z: if (!($jtbl->name == $ftbl->name)) { goto Wk3NI; } goto nxnv9; STD6s: wwdT3: goto QanXv; OKxbp: if (!($jtbl->default != $ftbl->default)) { goto QUMzi; } goto pp6yM; b9G_2: MXrA8: goto kypww; Wc_6U: $ftbl->extra = str_replace("\50\51", '', $ftbl->extra); goto hbYXq; TTKeE: $jtbl->default = str_replace("\50\51", '', $jtbl->default); goto s0S3w; nBejn: tWM3d: goto GULsa; ra3Ow: if (!($jtbl->extra != null)) { goto vzGHs; } goto qOTPt; LsfIL: J_yGj: goto vAdi7; WIKYR: $edit_columns[$table][$jtbl->name]["\160\162\x69\x6d\x61\x72\171"] = $jtbl->primary; goto AO0y4; kypww: if (!($ftbl->default != null)) { goto sQRoU; } goto BeVNP; mNrud: goto JtDGg; goto LsfIL; PQlkl: $nullable = $jtbl->nullable == "\116\x4f" ? "\40\x4e\x4f\x54\40\x4e\x55\114\x4c" : ''; goto ECB3S; Wk513: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto d8DNK; d8DNK: $comment = $jtbl->comment == '' ? '' : "\40\103\x4f\x4d\115\105\x4e\x54\x20\47" . $jtbl->comment . "\47"; goto RA108; AO0y4: if (strtolower($jtbl->primary) == "\x70\162\151") { goto J_yGj; } goto F47kP; sGsWs: if (!($jtbl->default != null)) { goto MXrA8; } goto TTKeE; RA108: array_push($modif_column, "\115\x4f\104\111\x46\131\40\x60" . $jtbl->name . "\x60\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto PGL5X; d3uRb: qG4wl: goto tnPTx; f9EM8: $ftbl->default = strtoupper($ftbl->default); goto tr4E7; VqA1m: if (!($jtbl->nullable != $ftbl->nullable)) { goto oJ6Aa; } goto g8ZZQ; tr4E7: sQRoU: goto OKxbp; jiJ3O: QUMzi: goto ra3Ow; QBaYo: Wk3NI: goto nBejn; vAmV5: tKLlC: goto VqA1m; Y4XWz: if (!($jtbl->extra != $ftbl->extra)) { goto MqEy3; } goto IB8W_; PGL5X: YzMf8: goto QBaYo; pngN5: goto JtDGg; goto Zp3bJ; suQzO: $edit_columns[$table][$jtbl->name]["\x63\x6f\154\x5f\x74\171\x70\x65"] = $jtbl->col_type; goto vAmV5; g8ZZQ: $edit_columns[$table][$jtbl->name]["\156\x75\154\x6c\141\x62\x6c\x65"] = $jtbl->nullable; goto IS3Nj; suVSO: array_push($modif_column, "\101\x44\x44\x20\125\116\x49\x51\x55\105\x20\113\x45\x59\40\140" . $jtbl->name . "\140\x20\x28\140" . $jtbl->name . "\140\x29"); goto lx7GF; yrD5l: if (!($ftbl->extra != null)) { goto QfZsm; } goto Wc_6U; ECB3S: $default = $jtbl->default == null ? '' : "\40\104\x45\106\x41\125\x4c\124\x20" . $jtbl->default; goto Wk513; P3PDI: vzGHs: goto yrD5l; Zp3bJ: yM1mT: goto suVSO; QanXv: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto YzMf8; } goto PQlkl; hbYXq: $ftbl->extra = strtoupper($ftbl->extra); goto i_J7I; IB8W_: $edit_columns[$table][$jtbl->name]["\x65\170\164\x72\x61"] = $jtbl->extra; goto sxv08; DpRZP: if (!($jtbl->comment != $ftbl->comment)) { goto qG4wl; } goto CNWRb; tnPTx: if (!($jtbl->primary != $ftbl->primary)) { goto wwdT3; } goto WIKYR; lx7GF: JtDGg: goto STD6s; s0S3w: $jtbl->default = strtoupper($jtbl->default); goto b9G_2; pp6yM: $edit_columns[$table][$jtbl->name]["\x64\x65\x66\141\x75\154\x74"] = $jtbl->default; goto jiJ3O; IS3Nj: oJ6Aa: goto sGsWs; CNWRb: $edit_columns[$table][$jtbl->name]["\x63\x6f\155\155\145\156\164"] = $jtbl->comment; goto d3uRb; i_J7I: QfZsm: goto Y4XWz; nxnv9: if (!($jtbl->col_type != $ftbl->col_type)) { goto tKLlC; } goto suQzO; jDIwE: $jtbl->extra = strtoupper($jtbl->extra); goto P3PDI; GULsa: } goto ZqpXD; Vs7aE: $add_columns[$table][] = $jtbl; goto nj9gO; x_RXg: M8L3x: goto C71vT; E60cf: $length = ''; goto hmxR9; w1JCe: $length = ''; goto Mo61t; VSIvp: $length = "\50" . ($jtbl->max_length + 1) . "\x29"; goto x_RXg; Xfo1o: if ($this->db->field_exists($jtbl->name, $table)) { goto WXsYP; } goto Vs7aE; hmxR9: goto PA2nT; goto Xy3bG; INTl2: $default = $jtbl->default == null ? '' : "\40\104\105\106\101\125\114\124\x20" . $jtbl->default; goto isOfs; aoImn: } goto oYCRN; tFYDQ: foreach ($json[$table]->columns as $column) { goto wRCZ7; wRCZ7: if ($column->max_length == null) { goto ZZWiM; } goto Hi_dM; vV_g8: yBFHo: goto zjQlV; cMcey: $length = ''; goto cEdvd; cEdvd: goto G75VI; goto vV_g8; Hi_dM: if ($column->type != "\154\157\156\147\x74\x65\170\164" && $column->type != "\x6d\x65\x64\151\x75\x6d\164\145\170\164" && $column->type != "\x74\145\x78\164") { goto yBFHo; } goto vIkKQ; FE2uj: woPtp: goto MWkbE; LP0at: $default = $column->default == null ? '' : "\x20\104\105\106\x41\125\114\124\x20" . $column->default; goto SlkIY; zjQlV: if ($column->type == "\x69\156\x74") { goto eQE3T; } goto EaGKa; qc4zt: $pri .= $column->primary != '' ? "\x50\x52\x49\115\101\122\131\40\x4b\x45\x59\x20\50\x60" . $column->name . "\140\51" : ''; goto e4JbC; FPfHz: $length = "\50" . ($column->max_length + 1) . "\51"; goto FE2uj; DKuDf: goto woPtp; goto ve9zV; ve9zV: eQE3T: goto FPfHz; EaGKa: $length = "\50" . $column->max_length . "\x29"; goto DKuDf; e4JbC: dVAq_: goto lALW9; TOYIE: goto G75VI; goto l1PHU; xatCf: $script .= "\x60" . $column->name . "\x60\40" . $column->type . $length . $nullable . $default . $extra . $comment . "\54\x20"; goto qc4zt; l1PHU: ZZWiM: goto cMcey; mZqrM: $comment = $column->comment == '' ? '' : "\40\103\117\115\x4d\x45\x4e\x54\x20\x27" . $column->comment . "\47"; goto xatCf; GB7ku: $nullable = $column->nullable == "\116\117" ? "\40\x4e\117\124\40\116\x55\x4c\114" : ''; goto LP0at; MWkbE: G75VI: goto GB7ku; vIkKQ: $length = ''; goto TOYIE; SlkIY: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto mZqrM; lALW9: } goto BNT1Q; kw2Y7: $script_create_column[$table] = "\x41\114\x54\x45\122\40\x54\x41\102\x4c\105\x20\140" . $table . "\x60\x20" . implode("\54\x20", $add_column) . "\x3b"; goto bK0on; eHeRA: $script .= $pri . "\51\x20\105\116\x47\111\116\105\75\x49\x6e\x6e\x6f\104\x42\x20\104\x45\x46\101\125\114\x54\40\103\110\101\122\x53\105\x54\x3d\x75\x74\x66\x38\155\x62\x34\x3b"; goto gDFBB; YfiO6: rRL_I: goto RI2px; OBIch: $create_tables[] = $json[$table]; goto ovzg6; hbbv5: GxBOH: goto VbVwS; BNT1Q: ruzw0: goto eHeRA; rGXwt: IscAh: goto OBIch; gDFBB: $script_create_table[$table] = $script; goto QzxmB; YT4M8: $pri = ''; goto tFYDQ; VbVwS: } goto pNwfy; yTCAk: $fields = []; goto bRnP7; ndWLg: $json = json_decode($json); goto WPrEw; pNwfy: seu5l: goto oRzXy; eSlxN: $tabless = $this->db->list_tables(); goto yTCAk; RuqXl: $json = file_get_contents("\x2e\x2f\141\x73\163\145\x74\x73\x2f\x61\160\x70\x2f\x64\142\57\x64\141\164\141\142\141\x73\145\56\152\163\157\x6e"); goto ndWLg; dchZu: sort($full_tables); goto tvVTk; mbWKy: $edit_columns = []; goto rHpe3; AZSQk: $add_columns = []; goto zegv8; nZJy5: $data = ["\x66\x69\x65\x6c\144\163" => $fields, "\143\162\x65\141\164\145\x5f\x74\x61\142\154\145\x73" => $create_tables, "\143\157\165\x6e\x74\x5f\164\142\154" => count($create_tables), "\x61\x64\144\137\x63\157\154\x75\155\x6e\163\137\x74\157\x5f\x74\141\142\x6c\145" => $add_columns, "\x63\157\x75\x6e\x74\137\x63\x6f\x6c" => count($add_columns), "\145\144\151\x74\x5f\143\x6f\154\x75\155\156\x73" => $edit_columns, "\x63\157\x75\156\x74\137\155\x6f\144" => count($edit_columns), "\141\144\144\x5f\164\142\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\141\x64\144\x5f\x63\157\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\157\x64\137\x63\157\154" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto X_QEh; mZvBK: $full_tables = array_unique($full_tables); goto dchZu; r5kiS: $script_create_table = []; goto AZSQk; CBrH0: $db_debug = $this->db->db_debug; goto lD0WS; X_QEh: $this->output_json($data); goto Xcr4X; oRzXy: $this->db->db_debug = $db_debug; goto nZJy5; tvVTk: $create_tables = []; goto r5kiS; W6MyT: $tbl_seharusnya = array_keys($json); goto J0c_1; WPrEw: $json = (array) $json; goto W6MyT; m9Nrt: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto mZvBK; bRnP7: foreach ($tabless as $table) { goto fU8_2; w75rH: $retval[$i] = new stdClass(); goto hD7yt; fU8_2: $sql = "\123\105\x4c\x45\103\124\40\x60\143\x6f\154\165\x6d\x6e\x5f\156\x61\155\145\x60\x2c\x20\140\143\x6f\x6c\x75\155\156\137\164\x79\x70\145\x60\54\x20\140\x63\157\154\x6c\x61\164\x69\x6f\156\x5f\x6e\x61\x6d\145\x60\54\x20\140\x64\x61\x74\141\x5f\164\171\160\145\x60\x2c\x20\140\x63\150\x61\x72\x61\143\x74\x65\x72\x5f\x6d\141\170\x69\155\x75\155\x5f\x6c\145\x6e\147\x74\x68\x60\x2c\x20\x60\156\x75\155\145\162\x69\143\x5f\x70\162\x65\143\151\163\151\157\156\x60\x2c" . "\x20\140\143\157\x6c\x75\x6d\x6e\x5f\144\145\x66\x61\x75\154\x74\x60\54\40\140\143\157\154\x75\155\x6e\x5f\153\x65\x79\140\x2c\x20\140\143\157\x6c\x75\155\x6e\137\143\157\x6d\x6d\x65\x6e\x74\x60\54\x20\x60\x65\x78\x74\x72\x61\140\54\x20\140\151\x73\x5f\x6e\x75\154\154\141\x62\x6c\x65\140\xd\12\11\11\x9\106\x52\117\115\x20\140\151\156\x66\x6f\x72\155\x61\x74\x69\157\x6e\x5f\163\x63\x68\145\x6d\x61\140\56\140\x63\x6f\x6c\165\155\156\163\140\x20\x57\x48\105\122\105\40\x74\x61\x62\154\145\137\x73\143\150\145\155\141\x20\x3d\x20\x22" . $this->db->database . "\42\x20\x41\x4e\104\x20\164\x61\x62\154\x65\x5f\156\141\x6d\x65\40\x3d\40\x22" . $table . "\42"; goto BVn7C; Wh_kk: $retval[$i]->collation = $query[$i]->collation_name; goto jnaWe; BVn7C: if (!(($query = $this->db->query($sql)) === FALSE)) { goto Ifloo; } goto F4GKa; LJdRh: $query = $query->result_object(); goto YFTvy; YFTvy: $retval = array(); goto u5__x; xwoaX: $retval[$i]->nullable = $query[$i]->is_nullable; goto wtgiU; jnaWe: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto T_38F; h3T2Y: Ifloo: goto LJdRh; nrYB8: $c = count($query); goto pbA20; orf4K: $retval[$i]->col_type = $query[$i]->column_type; goto zps2B; u5__x: $i = 0; goto nrYB8; wtgiU: $retval[$i]->primary = $query[$i]->column_key; goto mBiIZ; T_38F: $retval[$i]->default = $query[$i]->column_default; goto THH7X; OS7Px: goto Lrv2x; goto pW_qz; xPo_u: $i++; goto OS7Px; zps2B: $retval[$i]->type = $query[$i]->data_type; goto Wh_kk; hD7yt: $retval[$i]->name = $query[$i]->column_name; goto orf4K; wGi8x: $retval[$i]->extra = $query[$i]->extra; goto xwoaX; pW_qz: m8lHh: goto Ak21K; F4GKa: $fields = FALSE; goto h3T2Y; HBGR7: if (!($i < $c)) { goto m8lHh; } goto w75rH; pbA20: Lrv2x: goto HBGR7; yDMZ0: wr9jW: goto kn8ap; THH7X: $retval[$i]->comment = $query[$i]->column_comment; goto wGi8x; Ak21K: $fields[$table] = (object) ["\164\x61\x62\x6c\145\137\x6e\141\155\x65" => $table, "\143\157\154\x75\x6d\156\x73" => $retval]; goto yDMZ0; mBiIZ: wQo0q: goto xPo_u; kn8ap: } goto Gvfsu; Xcr4X: } public function createTable() { goto LyTGL; hJZ8K: foreach ($scripts as $script) { $queries .= $script; GPzIC: } goto mCGNF; J7BV1: str_replace("\x25\62\102", "\53", $scripts); goto cY4DH; RqnD6: $scripts = json_decode($this->encryption->decrypt($scripts)); goto KssdN; cY4DH: sleep(1); goto RqnD6; mCGNF: ravdp: goto R9tv2; LyTGL: $scripts = $this->input->post("\x64\x61\164\141", true); goto J7BV1; TpRWL: $data["\155\145\163\163\x61\147\145"] = "\x55\160\144\x61\x74\x65\x20\x6b\x6f\x6c\157\155"; goto ukoID; ukoID: $this->output_json($data); goto J0E7E; KssdN: $queries = ''; goto hJZ8K; R9tv2: $data["\x73\x75\x63\143\145\163\163"] = $this->runQuery($queries); goto TpRWL; J0E7E: } public function createColumn() { goto vbMwY; OcMxK: $this->output_json($data); goto rNWzq; SCqMG: foreach ($scripts as $script) { $queries .= $script; v6p6X: } goto fhIcm; x9UGO: $queries = ''; goto SCqMG; vbMwY: $scripts = $this->input->post("\144\x61\164\141", true); goto SxvWa; SxvWa: str_replace("\45\x32\x42", "\53", $scripts); goto FGQB0; WZNMg: $this->updateUID(); goto Fywbh; fhIcm: l1dV6: goto JfJpt; JhAls: $scripts = json_decode($this->encryption->decrypt($scripts)); goto x9UGO; Fywbh: O6JQp: goto qOFRg; JfJpt: if (!(strpos("\140\165\151\x64\x60", $queries) !== false)) { goto O6JQp; } goto WZNMg; qOFRg: $data["\163\x75\x63\x63\x65\x73\163"] = $this->runQuery($queries); goto sPDK6; FGQB0: sleep(1); goto JhAls; sPDK6: $data["\x6d\145\x73\x73\x61\x67\145"] = "\115\x6f\144\x69\146\171\40\153\157\154\x6f\x6d"; goto OcMxK; rNWzq: } public function editColumn() { goto qwKAw; bwym_: bewjj: goto Ay52i; zsbwl: str_replace("\x25\62\x42", "\53", $scripts); goto fsuu0; EMBs3: foreach ($scripts as $script) { $queries .= $script; JVw2k: } goto bwym_; u_V22: $data["\155\x65\x73\x73\141\147\145"] = "\125\x70\144\x61\164\x65\x20\163\x65\154\x65\x73\141\x69"; goto PqTJq; wVjGg: $scripts = json_decode($this->encryption->decrypt($scripts)); goto nqZ3r; qwKAw: $scripts = $this->input->post("\144\x61\x74\141", true); goto zsbwl; PqTJq: $this->output_json($data); goto ftA9D; Ay52i: $data["\163\165\143\143\x65\x73\x73"] = $this->runQuery($queries); goto u_V22; fsuu0: sleep(1); goto wVjGg; nqZ3r: $queries = ''; goto EMBs3; ftA9D: } function runQuery($script) { goto FAZ9g; KqDW7: return true; goto AXtgy; FAZ9g: $hostname = $this->db->hostname; goto SUngd; SUngd: $hostuser = $this->db->username; goto vGmlf; vGmlf: $hostpass = $this->db->password; goto xB8Qp; syFv5: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto CXErI; CXErI: if (!mysqli_connect_errno()) { goto Na9BG; } goto QEnDq; Tsbc2: $mysqli->multi_query($script); goto t7rtQ; zBvyP: Na9BG: goto Tsbc2; t7rtQ: $mysqli->close(); goto KqDW7; xB8Qp: $database = $this->db->database; goto syFv5; QEnDq: return mysqli_connect_errno(); goto zBvyP; AXtgy: } function updateUID() { goto VXcqi; Y_tWn: HodUe: goto DUsEN; VXcqi: $this->load->library("\125\165\x69\x64", "\x75\x75\151\144"); goto rfk4E; w_Jdk: foreach ($siswas as $siswa) { $input[] = array("\151\144\137\x73\151\163\167\x61" => $siswa->id_siswa, "\x75\151\x64" => $this->uuid->v4()); mv7Bt: } goto Y_tWn; DUsEN: return $this->db->update_batch("\155\x61\163\x74\x65\162\137\x73\151\x73\x77\x61", $input, "\x69\x64\x5f\163\151\x73\167\x61"); goto krCUd; rfk4E: $siswas = $this->db->get("\x6d\141\163\164\145\162\137\163\x69\163\x77\x61")->result(); goto qDwQc; qDwQc: $input = array(); goto w_Jdk; krCUd: } function make_base() { } }
